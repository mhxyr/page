(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function i(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(o){if(o.ep)return;o.ep=!0;const l=i(o);fetch(o.href,l)}})();/**
* @vue/shared v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**//*! #__NO_SIDE_EFFECTS__ */function makeMap(r){const e=Object.create(null);for(const i of r.split(","))e[i]=1;return i=>i in e}const EMPTY_OBJ={},EMPTY_ARR=[],NOOP=()=>{},NO=()=>!1,isOn=r=>r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&(r.charCodeAt(2)>122||r.charCodeAt(2)<97),isModelListener=r=>r.startsWith("onUpdate:"),extend=Object.assign,remove=(r,e)=>{const i=r.indexOf(e);i>-1&&r.splice(i,1)},hasOwnProperty$4=Object.prototype.hasOwnProperty,hasOwn$1=(r,e)=>hasOwnProperty$4.call(r,e),isArray$3=Array.isArray,isMap=r=>toTypeString$1(r)==="[object Map]",isSet=r=>toTypeString$1(r)==="[object Set]",isFunction$2=r=>typeof r=="function",isString$2=r=>typeof r=="string",isSymbol=r=>typeof r=="symbol",isObject$3=r=>r!==null&&typeof r=="object",isPromise$1=r=>(isObject$3(r)||isFunction$2(r))&&isFunction$2(r.then)&&isFunction$2(r.catch),objectToString$1=Object.prototype.toString,toTypeString$1=r=>objectToString$1.call(r),toRawType=r=>toTypeString$1(r).slice(8,-1),isPlainObject$2=r=>toTypeString$1(r)==="[object Object]",isIntegerKey=r=>isString$2(r)&&r!=="NaN"&&r[0]!=="-"&&""+parseInt(r,10)===r,isReservedProp=makeMap(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),cacheStringFunction=r=>{const e=Object.create(null);return i=>e[i]||(e[i]=r(i))},camelizeRE=/-(\w)/g,camelize=cacheStringFunction(r=>r.replace(camelizeRE,(e,i)=>i?i.toUpperCase():"")),hyphenateRE=/\B([A-Z])/g,hyphenate=cacheStringFunction(r=>r.replace(hyphenateRE,"-$1").toLowerCase()),capitalize$1=cacheStringFunction(r=>r.charAt(0).toUpperCase()+r.slice(1)),toHandlerKey=cacheStringFunction(r=>r?`on${capitalize$1(r)}`:""),hasChanged=(r,e)=>!Object.is(r,e),invokeArrayFns=(r,...e)=>{for(let i=0;i<r.length;i++)r[i](...e)},def=(r,e,i,n=!1)=>{Object.defineProperty(r,e,{configurable:!0,enumerable:!1,writable:n,value:i})},looseToNumber=r=>{const e=parseFloat(r);return isNaN(e)?r:e};let _globalThis$1;const getGlobalThis$1=()=>_globalThis$1||(_globalThis$1=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function normalizeStyle(r){if(isArray$3(r)){const e={};for(let i=0;i<r.length;i++){const n=r[i],o=isString$2(n)?parseStringStyle(n):normalizeStyle(n);if(o)for(const l in o)e[l]=o[l]}return e}else if(isString$2(r)||isObject$3(r))return r}const listDelimiterRE=/;(?![^(]*\))/g,propertyDelimiterRE=/:([^]+)/,styleCommentRE=/\/\*[^]*?\*\//g;function parseStringStyle(r){const e={};return r.replace(styleCommentRE,"").split(listDelimiterRE).forEach(i=>{if(i){const n=i.split(propertyDelimiterRE);n.length>1&&(e[n[0].trim()]=n[1].trim())}}),e}function normalizeClass(r){let e="";if(isString$2(r))e=r;else if(isArray$3(r))for(let i=0;i<r.length;i++){const n=normalizeClass(r[i]);n&&(e+=n+" ")}else if(isObject$3(r))for(const i in r)r[i]&&(e+=i+" ");return e.trim()}const specialBooleanAttrs="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",isSpecialBooleanAttr=makeMap(specialBooleanAttrs);function includeBooleanAttr(r){return!!r||r===""}const isRef$1=r=>!!(r&&r.__v_isRef===!0),toDisplayString$1=r=>isString$2(r)?r:r==null?"":isArray$3(r)||isObject$3(r)&&(r.toString===objectToString$1||!isFunction$2(r.toString))?isRef$1(r)?toDisplayString$1(r.value):JSON.stringify(r,replacer,2):String(r),replacer=(r,e)=>isRef$1(e)?replacer(r,e.value):isMap(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((i,[n,o],l)=>(i[stringifySymbol(n,l)+" =>"]=o,i),{})}:isSet(e)?{[`Set(${e.size})`]:[...e.values()].map(i=>stringifySymbol(i))}:isSymbol(e)?stringifySymbol(e):isObject$3(e)&&!isArray$3(e)&&!isPlainObject$2(e)?String(e):e,stringifySymbol=(r,e="")=>{var i;return isSymbol(r)?`Symbol(${(i=r.description)!=null?i:e})`:r};/**
* @vue/reactivity v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let activeEffectScope;class EffectScope{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=activeEffectScope,!e&&activeEffectScope&&(this.index=(activeEffectScope.scopes||(activeEffectScope.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let e,i;if(this.scopes)for(e=0,i=this.scopes.length;e<i;e++)this.scopes[e].pause();for(e=0,i=this.effects.length;e<i;e++)this.effects[e].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let e,i;if(this.scopes)for(e=0,i=this.scopes.length;e<i;e++)this.scopes[e].resume();for(e=0,i=this.effects.length;e<i;e++)this.effects[e].resume()}}run(e){if(this._active){const i=activeEffectScope;try{return activeEffectScope=this,e()}finally{activeEffectScope=i}}}on(){activeEffectScope=this}off(){activeEffectScope=this.parent}stop(e){if(this._active){this._active=!1;let i,n;for(i=0,n=this.effects.length;i<n;i++)this.effects[i].stop();for(this.effects.length=0,i=0,n=this.cleanups.length;i<n;i++)this.cleanups[i]();if(this.cleanups.length=0,this.scopes){for(i=0,n=this.scopes.length;i<n;i++)this.scopes[i].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!e){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.parent=void 0}}}function effectScope(r){return new EffectScope(r)}function getCurrentScope(){return activeEffectScope}let activeSub;const pausedQueueEffects=new WeakSet;class ReactiveEffect{constructor(e){this.fn=e,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,activeEffectScope&&activeEffectScope.active&&activeEffectScope.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,pausedQueueEffects.has(this)&&(pausedQueueEffects.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||batch(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,cleanupEffect(this),prepareDeps(this);const e=activeSub,i=shouldTrack;activeSub=this,shouldTrack=!0;try{return this.fn()}finally{cleanupDeps(this),activeSub=e,shouldTrack=i,this.flags&=-3}}stop(){if(this.flags&1){for(let e=this.deps;e;e=e.nextDep)removeSub(e);this.deps=this.depsTail=void 0,cleanupEffect(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?pausedQueueEffects.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){isDirty(this)&&this.run()}get dirty(){return isDirty(this)}}let batchDepth=0,batchedSub,batchedComputed;function batch(r,e=!1){if(r.flags|=8,e){r.next=batchedComputed,batchedComputed=r;return}r.next=batchedSub,batchedSub=r}function startBatch(){batchDepth++}function endBatch(){if(--batchDepth>0)return;if(batchedComputed){let e=batchedComputed;for(batchedComputed=void 0;e;){const i=e.next;e.next=void 0,e.flags&=-9,e=i}}let r;for(;batchedSub;){let e=batchedSub;for(batchedSub=void 0;e;){const i=e.next;if(e.next=void 0,e.flags&=-9,e.flags&1)try{e.trigger()}catch(n){r||(r=n)}e=i}}if(r)throw r}function prepareDeps(r){for(let e=r.deps;e;e=e.nextDep)e.version=-1,e.prevActiveLink=e.dep.activeLink,e.dep.activeLink=e}function cleanupDeps(r){let e,i=r.depsTail,n=i;for(;n;){const o=n.prevDep;n.version===-1?(n===i&&(i=o),removeSub(n),removeDep(n)):e=n,n.dep.activeLink=n.prevActiveLink,n.prevActiveLink=void 0,n=o}r.deps=e,r.depsTail=i}function isDirty(r){for(let e=r.deps;e;e=e.nextDep)if(e.dep.version!==e.version||e.dep.computed&&(refreshComputed(e.dep.computed)||e.dep.version!==e.version))return!0;return!!r._dirty}function refreshComputed(r){if(r.flags&4&&!(r.flags&16)||(r.flags&=-17,r.globalVersion===globalVersion))return;r.globalVersion=globalVersion;const e=r.dep;if(r.flags|=2,e.version>0&&!r.isSSR&&r.deps&&!isDirty(r)){r.flags&=-3;return}const i=activeSub,n=shouldTrack;activeSub=r,shouldTrack=!0;try{prepareDeps(r);const o=r.fn(r._value);(e.version===0||hasChanged(o,r._value))&&(r._value=o,e.version++)}catch(o){throw e.version++,o}finally{activeSub=i,shouldTrack=n,cleanupDeps(r),r.flags&=-3}}function removeSub(r,e=!1){const{dep:i,prevSub:n,nextSub:o}=r;if(n&&(n.nextSub=o,r.prevSub=void 0),o&&(o.prevSub=n,r.nextSub=void 0),i.subs===r&&(i.subs=n,!n&&i.computed)){i.computed.flags&=-5;for(let l=i.computed.deps;l;l=l.nextDep)removeSub(l,!0)}!e&&!--i.sc&&i.map&&i.map.delete(i.key)}function removeDep(r){const{prevDep:e,nextDep:i}=r;e&&(e.nextDep=i,r.prevDep=void 0),i&&(i.prevDep=e,r.nextDep=void 0)}let shouldTrack=!0;const trackStack=[];function pauseTracking(){trackStack.push(shouldTrack),shouldTrack=!1}function resetTracking(){const r=trackStack.pop();shouldTrack=r===void 0?!0:r}function cleanupEffect(r){const{cleanup:e}=r;if(r.cleanup=void 0,e){const i=activeSub;activeSub=void 0;try{e()}finally{activeSub=i}}}let globalVersion=0;class Link{constructor(e,i){this.sub=e,this.dep=i,this.version=i.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class Dep{constructor(e){this.computed=e,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0}track(e){if(!activeSub||!shouldTrack||activeSub===this.computed)return;let i=this.activeLink;if(i===void 0||i.sub!==activeSub)i=this.activeLink=new Link(activeSub,this),activeSub.deps?(i.prevDep=activeSub.depsTail,activeSub.depsTail.nextDep=i,activeSub.depsTail=i):activeSub.deps=activeSub.depsTail=i,addSub(i);else if(i.version===-1&&(i.version=this.version,i.nextDep)){const n=i.nextDep;n.prevDep=i.prevDep,i.prevDep&&(i.prevDep.nextDep=n),i.prevDep=activeSub.depsTail,i.nextDep=void 0,activeSub.depsTail.nextDep=i,activeSub.depsTail=i,activeSub.deps===i&&(activeSub.deps=n)}return i}trigger(e){this.version++,globalVersion++,this.notify(e)}notify(e){startBatch();try{for(let i=this.subs;i;i=i.prevSub)i.sub.notify()&&i.sub.dep.notify()}finally{endBatch()}}}function addSub(r){if(r.dep.sc++,r.sub.flags&4){const e=r.dep.computed;if(e&&!r.dep.subs){e.flags|=20;for(let n=e.deps;n;n=n.nextDep)addSub(n)}const i=r.dep.subs;i!==r&&(r.prevSub=i,i&&(i.nextSub=r)),r.dep.subs=r}}const targetMap=new WeakMap,ITERATE_KEY=Symbol(""),MAP_KEY_ITERATE_KEY=Symbol(""),ARRAY_ITERATE_KEY=Symbol("");function track(r,e,i){if(shouldTrack&&activeSub){let n=targetMap.get(r);n||targetMap.set(r,n=new Map);let o=n.get(i);o||(n.set(i,o=new Dep),o.map=n,o.key=i),o.track()}}function trigger(r,e,i,n,o,l){const d=targetMap.get(r);if(!d){globalVersion++;return}const u=f=>{f&&f.trigger()};if(startBatch(),e==="clear")d.forEach(u);else{const f=isArray$3(r),g=f&&isIntegerKey(i);if(f&&i==="length"){const _=Number(n);d.forEach((y,b)=>{(b==="length"||b===ARRAY_ITERATE_KEY||!isSymbol(b)&&b>=_)&&u(y)})}else switch((i!==void 0||d.has(void 0))&&u(d.get(i)),g&&u(d.get(ARRAY_ITERATE_KEY)),e){case"add":f?g&&u(d.get("length")):(u(d.get(ITERATE_KEY)),isMap(r)&&u(d.get(MAP_KEY_ITERATE_KEY)));break;case"delete":f||(u(d.get(ITERATE_KEY)),isMap(r)&&u(d.get(MAP_KEY_ITERATE_KEY)));break;case"set":isMap(r)&&u(d.get(ITERATE_KEY));break}}endBatch()}function reactiveReadArray(r){const e=toRaw(r);return e===r?e:(track(e,"iterate",ARRAY_ITERATE_KEY),isShallow(r)?e:e.map(toReactive))}function shallowReadArray(r){return track(r=toRaw(r),"iterate",ARRAY_ITERATE_KEY),r}const arrayInstrumentations={__proto__:null,[Symbol.iterator](){return iterator(this,Symbol.iterator,toReactive)},concat(...r){return reactiveReadArray(this).concat(...r.map(e=>isArray$3(e)?reactiveReadArray(e):e))},entries(){return iterator(this,"entries",r=>(r[1]=toReactive(r[1]),r))},every(r,e){return apply$1(this,"every",r,e,void 0,arguments)},filter(r,e){return apply$1(this,"filter",r,e,i=>i.map(toReactive),arguments)},find(r,e){return apply$1(this,"find",r,e,toReactive,arguments)},findIndex(r,e){return apply$1(this,"findIndex",r,e,void 0,arguments)},findLast(r,e){return apply$1(this,"findLast",r,e,toReactive,arguments)},findLastIndex(r,e){return apply$1(this,"findLastIndex",r,e,void 0,arguments)},forEach(r,e){return apply$1(this,"forEach",r,e,void 0,arguments)},includes(...r){return searchProxy(this,"includes",r)},indexOf(...r){return searchProxy(this,"indexOf",r)},join(r){return reactiveReadArray(this).join(r)},lastIndexOf(...r){return searchProxy(this,"lastIndexOf",r)},map(r,e){return apply$1(this,"map",r,e,void 0,arguments)},pop(){return noTracking(this,"pop")},push(...r){return noTracking(this,"push",r)},reduce(r,...e){return reduce(this,"reduce",r,e)},reduceRight(r,...e){return reduce(this,"reduceRight",r,e)},shift(){return noTracking(this,"shift")},some(r,e){return apply$1(this,"some",r,e,void 0,arguments)},splice(...r){return noTracking(this,"splice",r)},toReversed(){return reactiveReadArray(this).toReversed()},toSorted(r){return reactiveReadArray(this).toSorted(r)},toSpliced(...r){return reactiveReadArray(this).toSpliced(...r)},unshift(...r){return noTracking(this,"unshift",r)},values(){return iterator(this,"values",toReactive)}};function iterator(r,e,i){const n=shallowReadArray(r),o=n[e]();return n!==r&&!isShallow(r)&&(o._next=o.next,o.next=()=>{const l=o._next();return l.value&&(l.value=i(l.value)),l}),o}const arrayProto=Array.prototype;function apply$1(r,e,i,n,o,l){const d=shallowReadArray(r),u=d!==r&&!isShallow(r),f=d[e];if(f!==arrayProto[e]){const y=f.apply(r,l);return u?toReactive(y):y}let g=i;d!==r&&(u?g=function(y,b){return i.call(this,toReactive(y),b,r)}:i.length>2&&(g=function(y,b){return i.call(this,y,b,r)}));const _=f.call(d,g,n);return u&&o?o(_):_}function reduce(r,e,i,n){const o=shallowReadArray(r);let l=i;return o!==r&&(isShallow(r)?i.length>3&&(l=function(d,u,f){return i.call(this,d,u,f,r)}):l=function(d,u,f){return i.call(this,d,toReactive(u),f,r)}),o[e](l,...n)}function searchProxy(r,e,i){const n=toRaw(r);track(n,"iterate",ARRAY_ITERATE_KEY);const o=n[e](...i);return(o===-1||o===!1)&&isProxy(i[0])?(i[0]=toRaw(i[0]),n[e](...i)):o}function noTracking(r,e,i=[]){pauseTracking(),startBatch();const n=toRaw(r)[e].apply(r,i);return endBatch(),resetTracking(),n}const isNonTrackableKeys=makeMap("__proto__,__v_isRef,__isVue"),builtInSymbols=new Set(Object.getOwnPropertyNames(Symbol).filter(r=>r!=="arguments"&&r!=="caller").map(r=>Symbol[r]).filter(isSymbol));function hasOwnProperty$3(r){isSymbol(r)||(r=String(r));const e=toRaw(this);return track(e,"has",r),e.hasOwnProperty(r)}class BaseReactiveHandler{constructor(e=!1,i=!1){this._isReadonly=e,this._isShallow=i}get(e,i,n){if(i==="__v_skip")return e.__v_skip;const o=this._isReadonly,l=this._isShallow;if(i==="__v_isReactive")return!o;if(i==="__v_isReadonly")return o;if(i==="__v_isShallow")return l;if(i==="__v_raw")return n===(o?l?shallowReadonlyMap:readonlyMap:l?shallowReactiveMap:reactiveMap).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(n)?e:void 0;const d=isArray$3(e);if(!o){let f;if(d&&(f=arrayInstrumentations[i]))return f;if(i==="hasOwnProperty")return hasOwnProperty$3}const u=Reflect.get(e,i,isRef(e)?e:n);return(isSymbol(i)?builtInSymbols.has(i):isNonTrackableKeys(i))||(o||track(e,"get",i),l)?u:isRef(u)?d&&isIntegerKey(i)?u:u.value:isObject$3(u)?o?readonly(u):reactive(u):u}}class MutableReactiveHandler extends BaseReactiveHandler{constructor(e=!1){super(!1,e)}set(e,i,n,o){let l=e[i];if(!this._isShallow){const f=isReadonly(l);if(!isShallow(n)&&!isReadonly(n)&&(l=toRaw(l),n=toRaw(n)),!isArray$3(e)&&isRef(l)&&!isRef(n))return f?!1:(l.value=n,!0)}const d=isArray$3(e)&&isIntegerKey(i)?Number(i)<e.length:hasOwn$1(e,i),u=Reflect.set(e,i,n,isRef(e)?e:o);return e===toRaw(o)&&(d?hasChanged(n,l)&&trigger(e,"set",i,n):trigger(e,"add",i,n)),u}deleteProperty(e,i){const n=hasOwn$1(e,i);e[i];const o=Reflect.deleteProperty(e,i);return o&&n&&trigger(e,"delete",i,void 0),o}has(e,i){const n=Reflect.has(e,i);return(!isSymbol(i)||!builtInSymbols.has(i))&&track(e,"has",i),n}ownKeys(e){return track(e,"iterate",isArray$3(e)?"length":ITERATE_KEY),Reflect.ownKeys(e)}}class ReadonlyReactiveHandler extends BaseReactiveHandler{constructor(e=!1){super(!0,e)}set(e,i){return!0}deleteProperty(e,i){return!0}}const mutableHandlers=new MutableReactiveHandler,readonlyHandlers=new ReadonlyReactiveHandler,shallowReactiveHandlers=new MutableReactiveHandler(!0),shallowReadonlyHandlers=new ReadonlyReactiveHandler(!0),toShallow=r=>r,getProto=r=>Reflect.getPrototypeOf(r);function createIterableMethod(r,e,i){return function(...n){const o=this.__v_raw,l=toRaw(o),d=isMap(l),u=r==="entries"||r===Symbol.iterator&&d,f=r==="keys"&&d,g=o[r](...n),_=i?toShallow:e?toReadonly:toReactive;return!e&&track(l,"iterate",f?MAP_KEY_ITERATE_KEY:ITERATE_KEY),{next(){const{value:y,done:b}=g.next();return b?{value:y,done:b}:{value:u?[_(y[0]),_(y[1])]:_(y),done:b}},[Symbol.iterator](){return this}}}}function createReadonlyMethod(r){return function(...e){return r==="delete"?!1:r==="clear"?void 0:this}}function createInstrumentations(r,e){const i={get(o){const l=this.__v_raw,d=toRaw(l),u=toRaw(o);r||(hasChanged(o,u)&&track(d,"get",o),track(d,"get",u));const{has:f}=getProto(d),g=e?toShallow:r?toReadonly:toReactive;if(f.call(d,o))return g(l.get(o));if(f.call(d,u))return g(l.get(u));l!==d&&l.get(o)},get size(){const o=this.__v_raw;return!r&&track(toRaw(o),"iterate",ITERATE_KEY),Reflect.get(o,"size",o)},has(o){const l=this.__v_raw,d=toRaw(l),u=toRaw(o);return r||(hasChanged(o,u)&&track(d,"has",o),track(d,"has",u)),o===u?l.has(o):l.has(o)||l.has(u)},forEach(o,l){const d=this,u=d.__v_raw,f=toRaw(u),g=e?toShallow:r?toReadonly:toReactive;return!r&&track(f,"iterate",ITERATE_KEY),u.forEach((_,y)=>o.call(l,g(_),g(y),d))}};return extend(i,r?{add:createReadonlyMethod("add"),set:createReadonlyMethod("set"),delete:createReadonlyMethod("delete"),clear:createReadonlyMethod("clear")}:{add(o){!e&&!isShallow(o)&&!isReadonly(o)&&(o=toRaw(o));const l=toRaw(this);return getProto(l).has.call(l,o)||(l.add(o),trigger(l,"add",o,o)),this},set(o,l){!e&&!isShallow(l)&&!isReadonly(l)&&(l=toRaw(l));const d=toRaw(this),{has:u,get:f}=getProto(d);let g=u.call(d,o);g||(o=toRaw(o),g=u.call(d,o));const _=f.call(d,o);return d.set(o,l),g?hasChanged(l,_)&&trigger(d,"set",o,l):trigger(d,"add",o,l),this},delete(o){const l=toRaw(this),{has:d,get:u}=getProto(l);let f=d.call(l,o);f||(o=toRaw(o),f=d.call(l,o)),u&&u.call(l,o);const g=l.delete(o);return f&&trigger(l,"delete",o,void 0),g},clear(){const o=toRaw(this),l=o.size!==0,d=o.clear();return l&&trigger(o,"clear",void 0,void 0),d}}),["keys","values","entries",Symbol.iterator].forEach(o=>{i[o]=createIterableMethod(o,r,e)}),i}function createInstrumentationGetter(r,e){const i=createInstrumentations(r,e);return(n,o,l)=>o==="__v_isReactive"?!r:o==="__v_isReadonly"?r:o==="__v_raw"?n:Reflect.get(hasOwn$1(i,o)&&o in n?i:n,o,l)}const mutableCollectionHandlers={get:createInstrumentationGetter(!1,!1)},shallowCollectionHandlers={get:createInstrumentationGetter(!1,!0)},readonlyCollectionHandlers={get:createInstrumentationGetter(!0,!1)},shallowReadonlyCollectionHandlers={get:createInstrumentationGetter(!0,!0)},reactiveMap=new WeakMap,shallowReactiveMap=new WeakMap,readonlyMap=new WeakMap,shallowReadonlyMap=new WeakMap;function targetTypeMap(r){switch(r){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function getTargetType(r){return r.__v_skip||!Object.isExtensible(r)?0:targetTypeMap(toRawType(r))}function reactive(r){return isReadonly(r)?r:createReactiveObject(r,!1,mutableHandlers,mutableCollectionHandlers,reactiveMap)}function shallowReactive(r){return createReactiveObject(r,!1,shallowReactiveHandlers,shallowCollectionHandlers,shallowReactiveMap)}function readonly(r){return createReactiveObject(r,!0,readonlyHandlers,readonlyCollectionHandlers,readonlyMap)}function shallowReadonly(r){return createReactiveObject(r,!0,shallowReadonlyHandlers,shallowReadonlyCollectionHandlers,shallowReadonlyMap)}function createReactiveObject(r,e,i,n,o){if(!isObject$3(r)||r.__v_raw&&!(e&&r.__v_isReactive))return r;const l=o.get(r);if(l)return l;const d=getTargetType(r);if(d===0)return r;const u=new Proxy(r,d===2?n:i);return o.set(r,u),u}function isReactive(r){return isReadonly(r)?isReactive(r.__v_raw):!!(r&&r.__v_isReactive)}function isReadonly(r){return!!(r&&r.__v_isReadonly)}function isShallow(r){return!!(r&&r.__v_isShallow)}function isProxy(r){return r?!!r.__v_raw:!1}function toRaw(r){const e=r&&r.__v_raw;return e?toRaw(e):r}function markRaw(r){return!hasOwn$1(r,"__v_skip")&&Object.isExtensible(r)&&def(r,"__v_skip",!0),r}const toReactive=r=>isObject$3(r)?reactive(r):r,toReadonly=r=>isObject$3(r)?readonly(r):r;function isRef(r){return r?r.__v_isRef===!0:!1}function ref(r){return createRef(r,!1)}function shallowRef(r){return createRef(r,!0)}function createRef(r,e){return isRef(r)?r:new RefImpl(r,e)}class RefImpl{constructor(e,i){this.dep=new Dep,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=i?e:toRaw(e),this._value=i?e:toReactive(e),this.__v_isShallow=i}get value(){return this.dep.track(),this._value}set value(e){const i=this._rawValue,n=this.__v_isShallow||isShallow(e)||isReadonly(e);e=n?e:toRaw(e),hasChanged(e,i)&&(this._rawValue=e,this._value=n?e:toReactive(e),this.dep.trigger())}}function unref(r){return isRef(r)?r.value:r}const shallowUnwrapHandlers={get:(r,e,i)=>e==="__v_raw"?r:unref(Reflect.get(r,e,i)),set:(r,e,i,n)=>{const o=r[e];return isRef(o)&&!isRef(i)?(o.value=i,!0):Reflect.set(r,e,i,n)}};function proxyRefs(r){return isReactive(r)?r:new Proxy(r,shallowUnwrapHandlers)}class ComputedRefImpl{constructor(e,i,n){this.fn=e,this.setter=i,this._value=void 0,this.dep=new Dep(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=globalVersion-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!i,this.isSSR=n}notify(){if(this.flags|=16,!(this.flags&8)&&activeSub!==this)return batch(this,!0),!0}get value(){const e=this.dep.track();return refreshComputed(this),e&&(e.version=this.dep.version),this._value}set value(e){this.setter&&this.setter(e)}}function computed$1(r,e,i=!1){let n,o;return isFunction$2(r)?n=r:(n=r.get,o=r.set),new ComputedRefImpl(n,o,i)}const INITIAL_WATCHER_VALUE={},cleanupMap=new WeakMap;let activeWatcher;function onWatcherCleanup(r,e=!1,i=activeWatcher){if(i){let n=cleanupMap.get(i);n||cleanupMap.set(i,n=[]),n.push(r)}}function watch$1(r,e,i=EMPTY_OBJ){const{immediate:n,deep:o,once:l,scheduler:d,augmentJob:u,call:f}=i,g=P=>o?P:isShallow(P)||o===!1||o===0?traverse(P,1):traverse(P);let _,y,b,S,v=!1,A=!1;if(isRef(r)?(y=()=>r.value,v=isShallow(r)):isReactive(r)?(y=()=>g(r),v=!0):isArray$3(r)?(A=!0,v=r.some(P=>isReactive(P)||isShallow(P)),y=()=>r.map(P=>{if(isRef(P))return P.value;if(isReactive(P))return g(P);if(isFunction$2(P))return f?f(P,2):P()})):isFunction$2(r)?e?y=f?()=>f(r,2):r:y=()=>{if(b){pauseTracking();try{b()}finally{resetTracking()}}const P=activeWatcher;activeWatcher=_;try{return f?f(r,3,[S]):r(S)}finally{activeWatcher=P}}:y=NOOP,e&&o){const P=y,R=o===!0?1/0:o;y=()=>traverse(P(),R)}const x=getCurrentScope(),T=()=>{_.stop(),x&&x.active&&remove(x.effects,_)};if(l&&e){const P=e;e=(...R)=>{P(...R),T()}}let C=A?new Array(r.length).fill(INITIAL_WATCHER_VALUE):INITIAL_WATCHER_VALUE;const E=P=>{if(!(!(_.flags&1)||!_.dirty&&!P))if(e){const R=_.run();if(o||v||(A?R.some((L,w)=>hasChanged(L,C[w])):hasChanged(R,C))){b&&b();const L=activeWatcher;activeWatcher=_;try{const w=[R,C===INITIAL_WATCHER_VALUE?void 0:A&&C[0]===INITIAL_WATCHER_VALUE?[]:C,S];f?f(e,3,w):e(...w),C=R}finally{activeWatcher=L}}}else _.run()};return u&&u(E),_=new ReactiveEffect(y),_.scheduler=d?()=>d(E,!1):E,S=P=>onWatcherCleanup(P,!1,_),b=_.onStop=()=>{const P=cleanupMap.get(_);if(P){if(f)f(P,4);else for(const R of P)R();cleanupMap.delete(_)}},e?n?E(!0):C=_.run():d?d(E.bind(null,!0),!0):_.run(),T.pause=_.pause.bind(_),T.resume=_.resume.bind(_),T.stop=T,T}function traverse(r,e=1/0,i){if(e<=0||!isObject$3(r)||r.__v_skip||(i=i||new Set,i.has(r)))return r;if(i.add(r),e--,isRef(r))traverse(r.value,e,i);else if(isArray$3(r))for(let n=0;n<r.length;n++)traverse(r[n],e,i);else if(isSet(r)||isMap(r))r.forEach(n=>{traverse(n,e,i)});else if(isPlainObject$2(r)){for(const n in r)traverse(r[n],e,i);for(const n of Object.getOwnPropertySymbols(r))Object.prototype.propertyIsEnumerable.call(r,n)&&traverse(r[n],e,i)}return r}/**
* @vue/runtime-core v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const stack$1=[];let isWarning=!1;function warn$1$1(r,...e){if(isWarning)return;isWarning=!0,pauseTracking();const i=stack$1.length?stack$1[stack$1.length-1].component:null,n=i&&i.appContext.config.warnHandler,o=getComponentTrace();if(n)callWithErrorHandling(n,i,11,[r+e.map(l=>{var d,u;return(u=(d=l.toString)==null?void 0:d.call(l))!=null?u:JSON.stringify(l)}).join(""),i&&i.proxy,o.map(({vnode:l})=>`at <${formatComponentName(i,l.type)}>`).join(`
`),o]);else{const l=[`[Vue warn]: ${r}`,...e];o.length&&l.push(`
`,...formatTrace(o)),console.warn(...l)}resetTracking(),isWarning=!1}function getComponentTrace(){let r=stack$1[stack$1.length-1];if(!r)return[];const e=[];for(;r;){const i=e[0];i&&i.vnode===r?i.recurseCount++:e.push({vnode:r,recurseCount:0});const n=r.component&&r.component.parent;r=n&&n.vnode}return e}function formatTrace(r){const e=[];return r.forEach((i,n)=>{e.push(...n===0?[]:[`
`],...formatTraceEntry(i))}),e}function formatTraceEntry({vnode:r,recurseCount:e}){const i=e>0?`... (${e} recursive calls)`:"",n=r.component?r.component.parent==null:!1,o=` at <${formatComponentName(r.component,r.type,n)}`,l=">"+i;return r.props?[o,...formatProps(r.props),l]:[o+l]}function formatProps(r){const e=[],i=Object.keys(r);return i.slice(0,3).forEach(n=>{e.push(...formatProp(n,r[n]))}),i.length>3&&e.push(" ..."),e}function formatProp(r,e,i){return isString$2(e)?(e=JSON.stringify(e),i?e:[`${r}=${e}`]):typeof e=="number"||typeof e=="boolean"||e==null?i?e:[`${r}=${e}`]:isRef(e)?(e=formatProp(r,toRaw(e.value),!0),i?e:[`${r}=Ref<`,e,">"]):isFunction$2(e)?[`${r}=fn${e.name?`<${e.name}>`:""}`]:(e=toRaw(e),i?e:[`${r}=`,e])}function callWithErrorHandling(r,e,i,n){try{return n?r(...n):r()}catch(o){handleError(o,e,i)}}function callWithAsyncErrorHandling(r,e,i,n){if(isFunction$2(r)){const o=callWithErrorHandling(r,e,i,n);return o&&isPromise$1(o)&&o.catch(l=>{handleError(l,e,i)}),o}if(isArray$3(r)){const o=[];for(let l=0;l<r.length;l++)o.push(callWithAsyncErrorHandling(r[l],e,i,n));return o}}function handleError(r,e,i,n=!0){const o=e?e.vnode:null,{errorHandler:l,throwUnhandledErrorInProduction:d}=e&&e.appContext.config||EMPTY_OBJ;if(e){let u=e.parent;const f=e.proxy,g=`https://vuejs.org/error-reference/#runtime-${i}`;for(;u;){const _=u.ec;if(_){for(let y=0;y<_.length;y++)if(_[y](r,f,g)===!1)return}u=u.parent}if(l){pauseTracking(),callWithErrorHandling(l,null,10,[r,f,g]),resetTracking();return}}logError(r,i,o,n,d)}function logError(r,e,i,n=!0,o=!1){if(o)throw r;console.error(r)}const queue=[];let flushIndex=-1;const pendingPostFlushCbs=[];let activePostFlushCbs=null,postFlushIndex=0;const resolvedPromise=Promise.resolve();let currentFlushPromise=null;function nextTick(r){const e=currentFlushPromise||resolvedPromise;return r?e.then(this?r.bind(this):r):e}function findInsertionIndex$1(r){let e=flushIndex+1,i=queue.length;for(;e<i;){const n=e+i>>>1,o=queue[n],l=getId(o);l<r||l===r&&o.flags&2?e=n+1:i=n}return e}function queueJob(r){if(!(r.flags&1)){const e=getId(r),i=queue[queue.length-1];!i||!(r.flags&2)&&e>=getId(i)?queue.push(r):queue.splice(findInsertionIndex$1(e),0,r),r.flags|=1,queueFlush()}}function queueFlush(){currentFlushPromise||(currentFlushPromise=resolvedPromise.then(flushJobs))}function queuePostFlushCb(r){isArray$3(r)?pendingPostFlushCbs.push(...r):activePostFlushCbs&&r.id===-1?activePostFlushCbs.splice(postFlushIndex+1,0,r):r.flags&1||(pendingPostFlushCbs.push(r),r.flags|=1),queueFlush()}function flushPreFlushCbs(r,e,i=flushIndex+1){for(;i<queue.length;i++){const n=queue[i];if(n&&n.flags&2){if(r&&n.id!==r.uid)continue;queue.splice(i,1),i--,n.flags&4&&(n.flags&=-2),n(),n.flags&4||(n.flags&=-2)}}}function flushPostFlushCbs(r){if(pendingPostFlushCbs.length){const e=[...new Set(pendingPostFlushCbs)].sort((i,n)=>getId(i)-getId(n));if(pendingPostFlushCbs.length=0,activePostFlushCbs){activePostFlushCbs.push(...e);return}for(activePostFlushCbs=e,postFlushIndex=0;postFlushIndex<activePostFlushCbs.length;postFlushIndex++){const i=activePostFlushCbs[postFlushIndex];i.flags&4&&(i.flags&=-2),i.flags&8||i(),i.flags&=-2}activePostFlushCbs=null,postFlushIndex=0}}const getId=r=>r.id==null?r.flags&2?-1:1/0:r.id;function flushJobs(r){try{for(flushIndex=0;flushIndex<queue.length;flushIndex++){const e=queue[flushIndex];e&&!(e.flags&8)&&(e.flags&4&&(e.flags&=-2),callWithErrorHandling(e,e.i,e.i?15:14),e.flags&4||(e.flags&=-2))}}finally{for(;flushIndex<queue.length;flushIndex++){const e=queue[flushIndex];e&&(e.flags&=-2)}flushIndex=-1,queue.length=0,flushPostFlushCbs(),currentFlushPromise=null,(queue.length||pendingPostFlushCbs.length)&&flushJobs()}}let currentRenderingInstance=null,currentScopeId=null;function setCurrentRenderingInstance(r){const e=currentRenderingInstance;return currentRenderingInstance=r,currentScopeId=r&&r.type.__scopeId||null,e}function withCtx(r,e=currentRenderingInstance,i){if(!e||r._n)return r;const n=(...o)=>{n._d&&setBlockTracking(-1);const l=setCurrentRenderingInstance(e);let d;try{d=r(...o)}finally{setCurrentRenderingInstance(l),n._d&&setBlockTracking(1)}return d};return n._n=!0,n._c=!0,n._d=!0,n}function withDirectives(r,e){if(currentRenderingInstance===null)return r;const i=getComponentPublicInstance(currentRenderingInstance),n=r.dirs||(r.dirs=[]);for(let o=0;o<e.length;o++){let[l,d,u,f=EMPTY_OBJ]=e[o];l&&(isFunction$2(l)&&(l={mounted:l,updated:l}),l.deep&&traverse(d),n.push({dir:l,instance:i,value:d,oldValue:void 0,arg:u,modifiers:f}))}return r}function invokeDirectiveHook(r,e,i,n){const o=r.dirs,l=e&&e.dirs;for(let d=0;d<o.length;d++){const u=o[d];l&&(u.oldValue=l[d].value);let f=u.dir[n];f&&(pauseTracking(),callWithAsyncErrorHandling(f,i,8,[r.el,u,r,e]),resetTracking())}}const TeleportEndKey=Symbol("_vte"),isTeleport=r=>r.__isTeleport;function setTransitionHooks(r,e){r.shapeFlag&6&&r.component?(r.transition=e,setTransitionHooks(r.component.subTree,e)):r.shapeFlag&128?(r.ssContent.transition=e.clone(r.ssContent),r.ssFallback.transition=e.clone(r.ssFallback)):r.transition=e}/*! #__NO_SIDE_EFFECTS__ */function defineComponent(r,e){return isFunction$2(r)?extend({name:r.name},e,{setup:r}):r}function markAsyncBoundary(r){r.ids=[r.ids[0]+r.ids[2]+++"-",0,0]}function setRef(r,e,i,n,o=!1){if(isArray$3(r)){r.forEach((v,A)=>setRef(v,e&&(isArray$3(e)?e[A]:e),i,n,o));return}if(isAsyncWrapper(n)&&!o){n.shapeFlag&512&&n.type.__asyncResolved&&n.component.subTree.component&&setRef(r,e,i,n.component.subTree);return}const l=n.shapeFlag&4?getComponentPublicInstance(n.component):n.el,d=o?null:l,{i:u,r:f}=r,g=e&&e.r,_=u.refs===EMPTY_OBJ?u.refs={}:u.refs,y=u.setupState,b=toRaw(y),S=y===EMPTY_OBJ?()=>!1:v=>hasOwn$1(b,v);if(g!=null&&g!==f&&(isString$2(g)?(_[g]=null,S(g)&&(y[g]=null)):isRef(g)&&(g.value=null)),isFunction$2(f))callWithErrorHandling(f,u,12,[d,_]);else{const v=isString$2(f),A=isRef(f);if(v||A){const x=()=>{if(r.f){const T=v?S(f)?y[f]:_[f]:f.value;o?isArray$3(T)&&remove(T,l):isArray$3(T)?T.includes(l)||T.push(l):v?(_[f]=[l],S(f)&&(y[f]=_[f])):(f.value=[l],r.k&&(_[r.k]=f.value))}else v?(_[f]=d,S(f)&&(y[f]=d)):A&&(f.value=d,r.k&&(_[r.k]=d))};d?(x.id=-1,queuePostRenderEffect(x,i)):x()}}}getGlobalThis$1().requestIdleCallback;getGlobalThis$1().cancelIdleCallback;const isAsyncWrapper=r=>!!r.type.__asyncLoader,isKeepAlive=r=>r.type.__isKeepAlive;function onActivated(r,e){registerKeepAliveHook(r,"a",e)}function onDeactivated(r,e){registerKeepAliveHook(r,"da",e)}function registerKeepAliveHook(r,e,i=currentInstance){const n=r.__wdc||(r.__wdc=()=>{let o=i;for(;o;){if(o.isDeactivated)return;o=o.parent}return r()});if(injectHook(e,n,i),i){let o=i.parent;for(;o&&o.parent;)isKeepAlive(o.parent.vnode)&&injectToKeepAliveRoot(n,e,i,o),o=o.parent}}function injectToKeepAliveRoot(r,e,i,n){const o=injectHook(e,r,n,!0);onUnmounted(()=>{remove(n[e],o)},i)}function injectHook(r,e,i=currentInstance,n=!1){if(i){const o=i[r]||(i[r]=[]),l=e.__weh||(e.__weh=(...d)=>{pauseTracking();const u=setCurrentInstance(i),f=callWithAsyncErrorHandling(e,i,r,d);return u(),resetTracking(),f});return n?o.unshift(l):o.push(l),l}}const createHook=r=>(e,i=currentInstance)=>{(!isInSSRComponentSetup||r==="sp")&&injectHook(r,(...n)=>e(...n),i)},onBeforeMount=createHook("bm"),onMounted=createHook("m"),onBeforeUpdate=createHook("bu"),onUpdated=createHook("u"),onBeforeUnmount=createHook("bum"),onUnmounted=createHook("um"),onServerPrefetch=createHook("sp"),onRenderTriggered=createHook("rtg"),onRenderTracked=createHook("rtc");function onErrorCaptured(r,e=currentInstance){injectHook("ec",r,e)}const COMPONENTS="components";function resolveComponent(r,e){return resolveAsset(COMPONENTS,r,!0,e)||r}const NULL_DYNAMIC_COMPONENT=Symbol.for("v-ndc");function resolveAsset(r,e,i=!0,n=!1){const o=currentRenderingInstance||currentInstance;if(o){const l=o.type;{const u=getComponentName(l,!1);if(u&&(u===e||u===camelize(e)||u===capitalize$1(camelize(e))))return l}const d=resolve(o[r]||l[r],e)||resolve(o.appContext[r],e);return!d&&n?l:d}}function resolve(r,e){return r&&(r[e]||r[camelize(e)]||r[capitalize$1(camelize(e))])}const getPublicInstance=r=>r?isStatefulComponent(r)?getComponentPublicInstance(r):getPublicInstance(r.parent):null,publicPropertiesMap=extend(Object.create(null),{$:r=>r,$el:r=>r.vnode.el,$data:r=>r.data,$props:r=>r.props,$attrs:r=>r.attrs,$slots:r=>r.slots,$refs:r=>r.refs,$parent:r=>getPublicInstance(r.parent),$root:r=>getPublicInstance(r.root),$host:r=>r.ce,$emit:r=>r.emit,$options:r=>resolveMergedOptions(r),$forceUpdate:r=>r.f||(r.f=()=>{queueJob(r.update)}),$nextTick:r=>r.n||(r.n=nextTick.bind(r.proxy)),$watch:r=>instanceWatch.bind(r)}),hasSetupBinding=(r,e)=>r!==EMPTY_OBJ&&!r.__isScriptSetup&&hasOwn$1(r,e),PublicInstanceProxyHandlers={get({_:r},e){if(e==="__v_skip")return!0;const{ctx:i,setupState:n,data:o,props:l,accessCache:d,type:u,appContext:f}=r;let g;if(e[0]!=="$"){const S=d[e];if(S!==void 0)switch(S){case 1:return n[e];case 2:return o[e];case 4:return i[e];case 3:return l[e]}else{if(hasSetupBinding(n,e))return d[e]=1,n[e];if(o!==EMPTY_OBJ&&hasOwn$1(o,e))return d[e]=2,o[e];if((g=r.propsOptions[0])&&hasOwn$1(g,e))return d[e]=3,l[e];if(i!==EMPTY_OBJ&&hasOwn$1(i,e))return d[e]=4,i[e];shouldCacheAccess&&(d[e]=0)}}const _=publicPropertiesMap[e];let y,b;if(_)return e==="$attrs"&&track(r.attrs,"get",""),_(r);if((y=u.__cssModules)&&(y=y[e]))return y;if(i!==EMPTY_OBJ&&hasOwn$1(i,e))return d[e]=4,i[e];if(b=f.config.globalProperties,hasOwn$1(b,e))return b[e]},set({_:r},e,i){const{data:n,setupState:o,ctx:l}=r;return hasSetupBinding(o,e)?(o[e]=i,!0):n!==EMPTY_OBJ&&hasOwn$1(n,e)?(n[e]=i,!0):hasOwn$1(r.props,e)||e[0]==="$"&&e.slice(1)in r?!1:(l[e]=i,!0)},has({_:{data:r,setupState:e,accessCache:i,ctx:n,appContext:o,propsOptions:l}},d){let u;return!!i[d]||r!==EMPTY_OBJ&&hasOwn$1(r,d)||hasSetupBinding(e,d)||(u=l[0])&&hasOwn$1(u,d)||hasOwn$1(n,d)||hasOwn$1(publicPropertiesMap,d)||hasOwn$1(o.config.globalProperties,d)},defineProperty(r,e,i){return i.get!=null?r._.accessCache[e]=0:hasOwn$1(i,"value")&&this.set(r,e,i.value,null),Reflect.defineProperty(r,e,i)}};function normalizePropsOrEmits(r){return isArray$3(r)?r.reduce((e,i)=>(e[i]=null,e),{}):r}let shouldCacheAccess=!0;function applyOptions(r){const e=resolveMergedOptions(r),i=r.proxy,n=r.ctx;shouldCacheAccess=!1,e.beforeCreate&&callHook(e.beforeCreate,r,"bc");const{data:o,computed:l,methods:d,watch:u,provide:f,inject:g,created:_,beforeMount:y,mounted:b,beforeUpdate:S,updated:v,activated:A,deactivated:x,beforeDestroy:T,beforeUnmount:C,destroyed:E,unmounted:P,render:R,renderTracked:L,renderTriggered:w,errorCaptured:B,serverPrefetch:I,expose:D,inheritAttrs:O,components:N,directives:V,filters:H}=e;if(g&&resolveInjections(g,n,null),d)for(const G in d){const Y=d[G];isFunction$2(Y)&&(n[G]=Y.bind(i))}if(o){const G=o.call(i,i);isObject$3(G)&&(r.data=reactive(G))}if(shouldCacheAccess=!0,l)for(const G in l){const Y=l[G],Q=isFunction$2(Y)?Y.bind(i,i):isFunction$2(Y.get)?Y.get.bind(i,i):NOOP,q=!isFunction$2(Y)&&isFunction$2(Y.set)?Y.set.bind(i):NOOP,te=computed({get:Q,set:q});Object.defineProperty(n,G,{enumerable:!0,configurable:!0,get:()=>te.value,set:ue=>te.value=ue})}if(u)for(const G in u)createWatcher(u[G],n,i,G);if(f){const G=isFunction$2(f)?f.call(i):f;Reflect.ownKeys(G).forEach(Y=>{provide(Y,G[Y])})}_&&callHook(_,r,"c");function $(G,Y){isArray$3(Y)?Y.forEach(Q=>G(Q.bind(i))):Y&&G(Y.bind(i))}if($(onBeforeMount,y),$(onMounted,b),$(onBeforeUpdate,S),$(onUpdated,v),$(onActivated,A),$(onDeactivated,x),$(onErrorCaptured,B),$(onRenderTracked,L),$(onRenderTriggered,w),$(onBeforeUnmount,C),$(onUnmounted,P),$(onServerPrefetch,I),isArray$3(D))if(D.length){const G=r.exposed||(r.exposed={});D.forEach(Y=>{Object.defineProperty(G,Y,{get:()=>i[Y],set:Q=>i[Y]=Q})})}else r.exposed||(r.exposed={});R&&r.render===NOOP&&(r.render=R),O!=null&&(r.inheritAttrs=O),N&&(r.components=N),V&&(r.directives=V),I&&markAsyncBoundary(r)}function resolveInjections(r,e,i=NOOP){isArray$3(r)&&(r=normalizeInject(r));for(const n in r){const o=r[n];let l;isObject$3(o)?"default"in o?l=inject$1(o.from||n,o.default,!0):l=inject$1(o.from||n):l=inject$1(o),isRef(l)?Object.defineProperty(e,n,{enumerable:!0,configurable:!0,get:()=>l.value,set:d=>l.value=d}):e[n]=l}}function callHook(r,e,i){callWithAsyncErrorHandling(isArray$3(r)?r.map(n=>n.bind(e.proxy)):r.bind(e.proxy),e,i)}function createWatcher(r,e,i,n){let o=n.includes(".")?createPathGetter(i,n):()=>i[n];if(isString$2(r)){const l=e[r];isFunction$2(l)&&watch(o,l)}else if(isFunction$2(r))watch(o,r.bind(i));else if(isObject$3(r))if(isArray$3(r))r.forEach(l=>createWatcher(l,e,i,n));else{const l=isFunction$2(r.handler)?r.handler.bind(i):e[r.handler];isFunction$2(l)&&watch(o,l,r)}}function resolveMergedOptions(r){const e=r.type,{mixins:i,extends:n}=e,{mixins:o,optionsCache:l,config:{optionMergeStrategies:d}}=r.appContext,u=l.get(e);let f;return u?f=u:!o.length&&!i&&!n?f=e:(f={},o.length&&o.forEach(g=>mergeOptions$1(f,g,d,!0)),mergeOptions$1(f,e,d)),isObject$3(e)&&l.set(e,f),f}function mergeOptions$1(r,e,i,n=!1){const{mixins:o,extends:l}=e;l&&mergeOptions$1(r,l,i,!0),o&&o.forEach(d=>mergeOptions$1(r,d,i,!0));for(const d in e)if(!(n&&d==="expose")){const u=internalOptionMergeStrats[d]||i&&i[d];r[d]=u?u(r[d],e[d]):e[d]}return r}const internalOptionMergeStrats={data:mergeDataFn,props:mergeEmitsOrPropsOptions,emits:mergeEmitsOrPropsOptions,methods:mergeObjectOptions,computed:mergeObjectOptions,beforeCreate:mergeAsArray,created:mergeAsArray,beforeMount:mergeAsArray,mounted:mergeAsArray,beforeUpdate:mergeAsArray,updated:mergeAsArray,beforeDestroy:mergeAsArray,beforeUnmount:mergeAsArray,destroyed:mergeAsArray,unmounted:mergeAsArray,activated:mergeAsArray,deactivated:mergeAsArray,errorCaptured:mergeAsArray,serverPrefetch:mergeAsArray,components:mergeObjectOptions,directives:mergeObjectOptions,watch:mergeWatchOptions,provide:mergeDataFn,inject:mergeInject};function mergeDataFn(r,e){return e?r?function(){return extend(isFunction$2(r)?r.call(this,this):r,isFunction$2(e)?e.call(this,this):e)}:e:r}function mergeInject(r,e){return mergeObjectOptions(normalizeInject(r),normalizeInject(e))}function normalizeInject(r){if(isArray$3(r)){const e={};for(let i=0;i<r.length;i++)e[r[i]]=r[i];return e}return r}function mergeAsArray(r,e){return r?[...new Set([].concat(r,e))]:e}function mergeObjectOptions(r,e){return r?extend(Object.create(null),r,e):e}function mergeEmitsOrPropsOptions(r,e){return r?isArray$3(r)&&isArray$3(e)?[...new Set([...r,...e])]:extend(Object.create(null),normalizePropsOrEmits(r),normalizePropsOrEmits(e??{})):e}function mergeWatchOptions(r,e){if(!r)return e;if(!e)return r;const i=extend(Object.create(null),r);for(const n in e)i[n]=mergeAsArray(r[n],e[n]);return i}function createAppContext(){return{app:null,config:{isNativeTag:NO,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let uid$1=0;function createAppAPI(r,e){return function(n,o=null){isFunction$2(n)||(n=extend({},n)),o!=null&&!isObject$3(o)&&(o=null);const l=createAppContext(),d=new WeakSet,u=[];let f=!1;const g=l.app={_uid:uid$1++,_component:n,_props:o,_container:null,_context:l,_instance:null,version,get config(){return l.config},set config(_){},use(_,...y){return d.has(_)||(_&&isFunction$2(_.install)?(d.add(_),_.install(g,...y)):isFunction$2(_)&&(d.add(_),_(g,...y))),g},mixin(_){return l.mixins.includes(_)||l.mixins.push(_),g},component(_,y){return y?(l.components[_]=y,g):l.components[_]},directive(_,y){return y?(l.directives[_]=y,g):l.directives[_]},mount(_,y,b){if(!f){const S=g._ceVNode||createVNode(n,o);return S.appContext=l,b===!0?b="svg":b===!1&&(b=void 0),r(S,_,b),f=!0,g._container=_,_.__vue_app__=g,getComponentPublicInstance(S.component)}},onUnmount(_){u.push(_)},unmount(){f&&(callWithAsyncErrorHandling(u,g._instance,16),r(null,g._container),delete g._container.__vue_app__)},provide(_,y){return l.provides[_]=y,g},runWithContext(_){const y=currentApp;currentApp=g;try{return _()}finally{currentApp=y}}};return g}}let currentApp=null;function provide(r,e){if(currentInstance){let i=currentInstance.provides;const n=currentInstance.parent&&currentInstance.parent.provides;n===i&&(i=currentInstance.provides=Object.create(n)),i[r]=e}}function inject$1(r,e,i=!1){const n=currentInstance||currentRenderingInstance;if(n||currentApp){const o=currentApp?currentApp._context.provides:n?n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides:void 0;if(o&&r in o)return o[r];if(arguments.length>1)return i&&isFunction$2(e)?e.call(n&&n.proxy):e}}const internalObjectProto={},createInternalObject=()=>Object.create(internalObjectProto),isInternalObject=r=>Object.getPrototypeOf(r)===internalObjectProto;function initProps(r,e,i,n=!1){const o={},l=createInternalObject();r.propsDefaults=Object.create(null),setFullProps(r,e,o,l);for(const d in r.propsOptions[0])d in o||(o[d]=void 0);i?r.props=n?o:shallowReactive(o):r.type.props?r.props=o:r.props=l,r.attrs=l}function updateProps(r,e,i,n){const{props:o,attrs:l,vnode:{patchFlag:d}}=r,u=toRaw(o),[f]=r.propsOptions;let g=!1;if((n||d>0)&&!(d&16)){if(d&8){const _=r.vnode.dynamicProps;for(let y=0;y<_.length;y++){let b=_[y];if(isEmitListener(r.emitsOptions,b))continue;const S=e[b];if(f)if(hasOwn$1(l,b))S!==l[b]&&(l[b]=S,g=!0);else{const v=camelize(b);o[v]=resolvePropValue(f,u,v,S,r,!1)}else S!==l[b]&&(l[b]=S,g=!0)}}}else{setFullProps(r,e,o,l)&&(g=!0);let _;for(const y in u)(!e||!hasOwn$1(e,y)&&((_=hyphenate(y))===y||!hasOwn$1(e,_)))&&(f?i&&(i[y]!==void 0||i[_]!==void 0)&&(o[y]=resolvePropValue(f,u,y,void 0,r,!0)):delete o[y]);if(l!==u)for(const y in l)(!e||!hasOwn$1(e,y))&&(delete l[y],g=!0)}g&&trigger(r.attrs,"set","")}function setFullProps(r,e,i,n){const[o,l]=r.propsOptions;let d=!1,u;if(e)for(let f in e){if(isReservedProp(f))continue;const g=e[f];let _;o&&hasOwn$1(o,_=camelize(f))?!l||!l.includes(_)?i[_]=g:(u||(u={}))[_]=g:isEmitListener(r.emitsOptions,f)||(!(f in n)||g!==n[f])&&(n[f]=g,d=!0)}if(l){const f=toRaw(i),g=u||EMPTY_OBJ;for(let _=0;_<l.length;_++){const y=l[_];i[y]=resolvePropValue(o,f,y,g[y],r,!hasOwn$1(g,y))}}return d}function resolvePropValue(r,e,i,n,o,l){const d=r[i];if(d!=null){const u=hasOwn$1(d,"default");if(u&&n===void 0){const f=d.default;if(d.type!==Function&&!d.skipFactory&&isFunction$2(f)){const{propsDefaults:g}=o;if(i in g)n=g[i];else{const _=setCurrentInstance(o);n=g[i]=f.call(null,e),_()}}else n=f;o.ce&&o.ce._setProp(i,n)}d[0]&&(l&&!u?n=!1:d[1]&&(n===""||n===hyphenate(i))&&(n=!0))}return n}const mixinPropsCache=new WeakMap;function normalizePropsOptions(r,e,i=!1){const n=i?mixinPropsCache:e.propsCache,o=n.get(r);if(o)return o;const l=r.props,d={},u=[];let f=!1;if(!isFunction$2(r)){const _=y=>{f=!0;const[b,S]=normalizePropsOptions(y,e,!0);extend(d,b),S&&u.push(...S)};!i&&e.mixins.length&&e.mixins.forEach(_),r.extends&&_(r.extends),r.mixins&&r.mixins.forEach(_)}if(!l&&!f)return isObject$3(r)&&n.set(r,EMPTY_ARR),EMPTY_ARR;if(isArray$3(l))for(let _=0;_<l.length;_++){const y=camelize(l[_]);validatePropName(y)&&(d[y]=EMPTY_OBJ)}else if(l)for(const _ in l){const y=camelize(_);if(validatePropName(y)){const b=l[_],S=d[y]=isArray$3(b)||isFunction$2(b)?{type:b}:extend({},b),v=S.type;let A=!1,x=!0;if(isArray$3(v))for(let T=0;T<v.length;++T){const C=v[T],E=isFunction$2(C)&&C.name;if(E==="Boolean"){A=!0;break}else E==="String"&&(x=!1)}else A=isFunction$2(v)&&v.name==="Boolean";S[0]=A,S[1]=x,(A||hasOwn$1(S,"default"))&&u.push(y)}}const g=[d,u];return isObject$3(r)&&n.set(r,g),g}function validatePropName(r){return r[0]!=="$"&&!isReservedProp(r)}const isInternalKey=r=>r[0]==="_"||r==="$stable",normalizeSlotValue=r=>isArray$3(r)?r.map(normalizeVNode):[normalizeVNode(r)],normalizeSlot$1=(r,e,i)=>{if(e._n)return e;const n=withCtx((...o)=>normalizeSlotValue(e(...o)),i);return n._c=!1,n},normalizeObjectSlots=(r,e,i)=>{const n=r._ctx;for(const o in r){if(isInternalKey(o))continue;const l=r[o];if(isFunction$2(l))e[o]=normalizeSlot$1(o,l,n);else if(l!=null){const d=normalizeSlotValue(l);e[o]=()=>d}}},normalizeVNodeSlots=(r,e)=>{const i=normalizeSlotValue(e);r.slots.default=()=>i},assignSlots=(r,e,i)=>{for(const n in e)(i||n!=="_")&&(r[n]=e[n])},initSlots=(r,e,i)=>{const n=r.slots=createInternalObject();if(r.vnode.shapeFlag&32){const o=e._;o?(assignSlots(n,e,i),i&&def(n,"_",o,!0)):normalizeObjectSlots(e,n)}else e&&normalizeVNodeSlots(r,e)},updateSlots=(r,e,i)=>{const{vnode:n,slots:o}=r;let l=!0,d=EMPTY_OBJ;if(n.shapeFlag&32){const u=e._;u?i&&u===1?l=!1:assignSlots(o,e,i):(l=!e.$stable,normalizeObjectSlots(e,o)),d=e}else e&&(normalizeVNodeSlots(r,e),d={default:1});if(l)for(const u in o)!isInternalKey(u)&&d[u]==null&&delete o[u]},queuePostRenderEffect=queueEffectWithSuspense;function createRenderer(r){return baseCreateRenderer(r)}function baseCreateRenderer(r,e){const i=getGlobalThis$1();i.__VUE__=!0;const{insert:n,remove:o,patchProp:l,createElement:d,createText:u,createComment:f,setText:g,setElementText:_,parentNode:y,nextSibling:b,setScopeId:S=NOOP,insertStaticContent:v}=r,A=(j,W,K,ne=null,re=null,ae=null,z=void 0,U=null,X=!!W.dynamicChildren)=>{if(j===W)return;j&&!isSameVNodeType(j,W)&&(ne=ee(j),ue(j,re,ae,!0),j=null),W.patchFlag===-2&&(X=!1,W.dynamicChildren=null);const{type:se,ref:ge,shapeFlag:de}=W;switch(se){case Text$2:x(j,W,K,ne);break;case Comment:T(j,W,K,ne);break;case Static:j==null&&C(W,K,ne,z);break;case Fragment:N(j,W,K,ne,re,ae,z,U,X);break;default:de&1?R(j,W,K,ne,re,ae,z,U,X):de&6?V(j,W,K,ne,re,ae,z,U,X):(de&64||de&128)&&se.process(j,W,K,ne,re,ae,z,U,X,le)}ge!=null&&re&&setRef(ge,j&&j.ref,ae,W||j,!W)},x=(j,W,K,ne)=>{if(j==null)n(W.el=u(W.children),K,ne);else{const re=W.el=j.el;W.children!==j.children&&g(re,W.children)}},T=(j,W,K,ne)=>{j==null?n(W.el=f(W.children||""),K,ne):W.el=j.el},C=(j,W,K,ne)=>{[j.el,j.anchor]=v(j.children,W,K,ne,j.el,j.anchor)},E=({el:j,anchor:W},K,ne)=>{let re;for(;j&&j!==W;)re=b(j),n(j,K,ne),j=re;n(W,K,ne)},P=({el:j,anchor:W})=>{let K;for(;j&&j!==W;)K=b(j),o(j),j=K;o(W)},R=(j,W,K,ne,re,ae,z,U,X)=>{W.type==="svg"?z="svg":W.type==="math"&&(z="mathml"),j==null?L(W,K,ne,re,ae,z,U,X):I(j,W,re,ae,z,U,X)},L=(j,W,K,ne,re,ae,z,U)=>{let X,se;const{props:ge,shapeFlag:de,transition:Z,dirs:oe}=j;if(X=j.el=d(j.type,ae,ge&&ge.is,ge),de&8?_(X,j.children):de&16&&B(j.children,X,null,ne,re,resolveChildrenNamespace(j,ae),z,U),oe&&invokeDirectiveHook(j,null,ne,"created"),w(X,j,j.scopeId,z,ne),ge){for(const ye in ge)ye!=="value"&&!isReservedProp(ye)&&l(X,ye,null,ge[ye],ae,ne);"value"in ge&&l(X,"value",null,ge.value,ae),(se=ge.onVnodeBeforeMount)&&invokeVNodeHook(se,ne,j)}oe&&invokeDirectiveHook(j,null,ne,"beforeMount");const _e=needTransition(re,Z);_e&&Z.beforeEnter(X),n(X,W,K),((se=ge&&ge.onVnodeMounted)||_e||oe)&&queuePostRenderEffect(()=>{se&&invokeVNodeHook(se,ne,j),_e&&Z.enter(X),oe&&invokeDirectiveHook(j,null,ne,"mounted")},re)},w=(j,W,K,ne,re)=>{if(K&&S(j,K),ne)for(let ae=0;ae<ne.length;ae++)S(j,ne[ae]);if(re){let ae=re.subTree;if(W===ae||isSuspense(ae.type)&&(ae.ssContent===W||ae.ssFallback===W)){const z=re.vnode;w(j,z,z.scopeId,z.slotScopeIds,re.parent)}}},B=(j,W,K,ne,re,ae,z,U,X=0)=>{for(let se=X;se<j.length;se++){const ge=j[se]=U?cloneIfMounted(j[se]):normalizeVNode(j[se]);A(null,ge,W,K,ne,re,ae,z,U)}},I=(j,W,K,ne,re,ae,z)=>{const U=W.el=j.el;let{patchFlag:X,dynamicChildren:se,dirs:ge}=W;X|=j.patchFlag&16;const de=j.props||EMPTY_OBJ,Z=W.props||EMPTY_OBJ;let oe;if(K&&toggleRecurse(K,!1),(oe=Z.onVnodeBeforeUpdate)&&invokeVNodeHook(oe,K,W,j),ge&&invokeDirectiveHook(W,j,K,"beforeUpdate"),K&&toggleRecurse(K,!0),(de.innerHTML&&Z.innerHTML==null||de.textContent&&Z.textContent==null)&&_(U,""),se?D(j.dynamicChildren,se,U,K,ne,resolveChildrenNamespace(W,re),ae):z||Y(j,W,U,null,K,ne,resolveChildrenNamespace(W,re),ae,!1),X>0){if(X&16)O(U,de,Z,K,re);else if(X&2&&de.class!==Z.class&&l(U,"class",null,Z.class,re),X&4&&l(U,"style",de.style,Z.style,re),X&8){const _e=W.dynamicProps;for(let ye=0;ye<_e.length;ye++){const Se=_e[ye],Ae=de[Se],ve=Z[Se];(ve!==Ae||Se==="value")&&l(U,Se,Ae,ve,re,K)}}X&1&&j.children!==W.children&&_(U,W.children)}else!z&&se==null&&O(U,de,Z,K,re);((oe=Z.onVnodeUpdated)||ge)&&queuePostRenderEffect(()=>{oe&&invokeVNodeHook(oe,K,W,j),ge&&invokeDirectiveHook(W,j,K,"updated")},ne)},D=(j,W,K,ne,re,ae,z)=>{for(let U=0;U<W.length;U++){const X=j[U],se=W[U],ge=X.el&&(X.type===Fragment||!isSameVNodeType(X,se)||X.shapeFlag&70)?y(X.el):K;A(X,se,ge,null,ne,re,ae,z,!0)}},O=(j,W,K,ne,re)=>{if(W!==K){if(W!==EMPTY_OBJ)for(const ae in W)!isReservedProp(ae)&&!(ae in K)&&l(j,ae,W[ae],null,re,ne);for(const ae in K){if(isReservedProp(ae))continue;const z=K[ae],U=W[ae];z!==U&&ae!=="value"&&l(j,ae,U,z,re,ne)}"value"in K&&l(j,"value",W.value,K.value,re)}},N=(j,W,K,ne,re,ae,z,U,X)=>{const se=W.el=j?j.el:u(""),ge=W.anchor=j?j.anchor:u("");let{patchFlag:de,dynamicChildren:Z,slotScopeIds:oe}=W;oe&&(U=U?U.concat(oe):oe),j==null?(n(se,K,ne),n(ge,K,ne),B(W.children||[],K,ge,re,ae,z,U,X)):de>0&&de&64&&Z&&j.dynamicChildren?(D(j.dynamicChildren,Z,K,re,ae,z,U),(W.key!=null||re&&W===re.subTree)&&traverseStaticChildren(j,W,!0)):Y(j,W,K,ge,re,ae,z,U,X)},V=(j,W,K,ne,re,ae,z,U,X)=>{W.slotScopeIds=U,j==null?W.shapeFlag&512?re.ctx.activate(W,K,ne,z,X):H(W,K,ne,re,ae,z,X):F(j,W,X)},H=(j,W,K,ne,re,ae,z)=>{const U=j.component=createComponentInstance(j,ne,re);if(isKeepAlive(j)&&(U.ctx.renderer=le),setupComponent(U,!1,z),U.asyncDep){if(re&&re.registerDep(U,$,z),!j.el){const X=U.subTree=createVNode(Comment);T(null,X,W,K)}}else $(U,j,W,K,re,ae,z)},F=(j,W,K)=>{const ne=W.component=j.component;if(shouldUpdateComponent(j,W,K))if(ne.asyncDep&&!ne.asyncResolved){G(ne,W,K);return}else ne.next=W,ne.update();else W.el=j.el,ne.vnode=W},$=(j,W,K,ne,re,ae,z)=>{const U=()=>{if(j.isMounted){let{next:de,bu:Z,u:oe,parent:_e,vnode:ye}=j;{const Te=locateNonHydratedAsyncRoot(j);if(Te){de&&(de.el=ye.el,G(j,de,z)),Te.asyncDep.then(()=>{j.isUnmounted||U()});return}}let Se=de,Ae;toggleRecurse(j,!1),de?(de.el=ye.el,G(j,de,z)):de=ye,Z&&invokeArrayFns(Z),(Ae=de.props&&de.props.onVnodeBeforeUpdate)&&invokeVNodeHook(Ae,_e,de,ye),toggleRecurse(j,!0);const ve=renderComponentRoot(j),xe=j.subTree;j.subTree=ve,A(xe,ve,y(xe.el),ee(xe),j,re,ae),de.el=ve.el,Se===null&&updateHOCHostEl(j,ve.el),oe&&queuePostRenderEffect(oe,re),(Ae=de.props&&de.props.onVnodeUpdated)&&queuePostRenderEffect(()=>invokeVNodeHook(Ae,_e,de,ye),re)}else{let de;const{el:Z,props:oe}=W,{bm:_e,m:ye,parent:Se,root:Ae,type:ve}=j,xe=isAsyncWrapper(W);toggleRecurse(j,!1),_e&&invokeArrayFns(_e),!xe&&(de=oe&&oe.onVnodeBeforeMount)&&invokeVNodeHook(de,Se,W),toggleRecurse(j,!0);{Ae.ce&&Ae.ce._injectChildStyle(ve);const Te=j.subTree=renderComponentRoot(j);A(null,Te,K,ne,j,re,ae),W.el=Te.el}if(ye&&queuePostRenderEffect(ye,re),!xe&&(de=oe&&oe.onVnodeMounted)){const Te=W;queuePostRenderEffect(()=>invokeVNodeHook(de,Se,Te),re)}(W.shapeFlag&256||Se&&isAsyncWrapper(Se.vnode)&&Se.vnode.shapeFlag&256)&&j.a&&queuePostRenderEffect(j.a,re),j.isMounted=!0,W=K=ne=null}};j.scope.on();const X=j.effect=new ReactiveEffect(U);j.scope.off();const se=j.update=X.run.bind(X),ge=j.job=X.runIfDirty.bind(X);ge.i=j,ge.id=j.uid,X.scheduler=()=>queueJob(ge),toggleRecurse(j,!0),se()},G=(j,W,K)=>{W.component=j;const ne=j.vnode.props;j.vnode=W,j.next=null,updateProps(j,W.props,ne,K),updateSlots(j,W.children,K),pauseTracking(),flushPreFlushCbs(j),resetTracking()},Y=(j,W,K,ne,re,ae,z,U,X=!1)=>{const se=j&&j.children,ge=j?j.shapeFlag:0,de=W.children,{patchFlag:Z,shapeFlag:oe}=W;if(Z>0){if(Z&128){q(se,de,K,ne,re,ae,z,U,X);return}else if(Z&256){Q(se,de,K,ne,re,ae,z,U,X);return}}oe&8?(ge&16&&me(se,re,ae),de!==se&&_(K,de)):ge&16?oe&16?q(se,de,K,ne,re,ae,z,U,X):me(se,re,ae,!0):(ge&8&&_(K,""),oe&16&&B(de,K,ne,re,ae,z,U,X))},Q=(j,W,K,ne,re,ae,z,U,X)=>{j=j||EMPTY_ARR,W=W||EMPTY_ARR;const se=j.length,ge=W.length,de=Math.min(se,ge);let Z;for(Z=0;Z<de;Z++){const oe=W[Z]=X?cloneIfMounted(W[Z]):normalizeVNode(W[Z]);A(j[Z],oe,K,null,re,ae,z,U,X)}se>ge?me(j,re,ae,!0,!1,de):B(W,K,ne,re,ae,z,U,X,de)},q=(j,W,K,ne,re,ae,z,U,X)=>{let se=0;const ge=W.length;let de=j.length-1,Z=ge-1;for(;se<=de&&se<=Z;){const oe=j[se],_e=W[se]=X?cloneIfMounted(W[se]):normalizeVNode(W[se]);if(isSameVNodeType(oe,_e))A(oe,_e,K,null,re,ae,z,U,X);else break;se++}for(;se<=de&&se<=Z;){const oe=j[de],_e=W[Z]=X?cloneIfMounted(W[Z]):normalizeVNode(W[Z]);if(isSameVNodeType(oe,_e))A(oe,_e,K,null,re,ae,z,U,X);else break;de--,Z--}if(se>de){if(se<=Z){const oe=Z+1,_e=oe<ge?W[oe].el:ne;for(;se<=Z;)A(null,W[se]=X?cloneIfMounted(W[se]):normalizeVNode(W[se]),K,_e,re,ae,z,U,X),se++}}else if(se>Z)for(;se<=de;)ue(j[se],re,ae,!0),se++;else{const oe=se,_e=se,ye=new Map;for(se=_e;se<=Z;se++){const Ce=W[se]=X?cloneIfMounted(W[se]):normalizeVNode(W[se]);Ce.key!=null&&ye.set(Ce.key,se)}let Se,Ae=0;const ve=Z-_e+1;let xe=!1,Te=0;const Me=new Array(ve);for(se=0;se<ve;se++)Me[se]=0;for(se=oe;se<=de;se++){const Ce=j[se];if(Ae>=ve){ue(Ce,re,ae,!0);continue}let ke;if(Ce.key!=null)ke=ye.get(Ce.key);else for(Se=_e;Se<=Z;Se++)if(Me[Se-_e]===0&&isSameVNodeType(Ce,W[Se])){ke=Se;break}ke===void 0?ue(Ce,re,ae,!0):(Me[ke-_e]=se+1,ke>=Te?Te=ke:xe=!0,A(Ce,W[ke],K,null,re,ae,z,U,X),Ae++)}const Oe=xe?getSequence(Me):EMPTY_ARR;for(Se=Oe.length-1,se=ve-1;se>=0;se--){const Ce=_e+se,ke=W[Ce],Fe=Ce+1<ge?W[Ce+1].el:ne;Me[se]===0?A(null,ke,K,Fe,re,ae,z,U,X):xe&&(Se<0||se!==Oe[Se]?te(ke,K,Fe,2):Se--)}}},te=(j,W,K,ne,re=null)=>{const{el:ae,type:z,transition:U,children:X,shapeFlag:se}=j;if(se&6){te(j.component.subTree,W,K,ne);return}if(se&128){j.suspense.move(W,K,ne);return}if(se&64){z.move(j,W,K,le);return}if(z===Fragment){n(ae,W,K);for(let de=0;de<X.length;de++)te(X[de],W,K,ne);n(j.anchor,W,K);return}if(z===Static){E(j,W,K);return}if(ne!==2&&se&1&&U)if(ne===0)U.beforeEnter(ae),n(ae,W,K),queuePostRenderEffect(()=>U.enter(ae),re);else{const{leave:de,delayLeave:Z,afterLeave:oe}=U,_e=()=>n(ae,W,K),ye=()=>{de(ae,()=>{_e(),oe&&oe()})};Z?Z(ae,_e,ye):ye()}else n(ae,W,K)},ue=(j,W,K,ne=!1,re=!1)=>{const{type:ae,props:z,ref:U,children:X,dynamicChildren:se,shapeFlag:ge,patchFlag:de,dirs:Z,cacheIndex:oe}=j;if(de===-2&&(re=!1),U!=null&&setRef(U,null,K,j,!0),oe!=null&&(W.renderCache[oe]=void 0),ge&256){W.ctx.deactivate(j);return}const _e=ge&1&&Z,ye=!isAsyncWrapper(j);let Se;if(ye&&(Se=z&&z.onVnodeBeforeUnmount)&&invokeVNodeHook(Se,W,j),ge&6)pe(j.component,K,ne);else{if(ge&128){j.suspense.unmount(K,ne);return}_e&&invokeDirectiveHook(j,null,W,"beforeUnmount"),ge&64?j.type.remove(j,W,K,le,ne):se&&!se.hasOnce&&(ae!==Fragment||de>0&&de&64)?me(se,W,K,!1,!0):(ae===Fragment&&de&384||!re&&ge&16)&&me(X,W,K),ne&&he(j)}(ye&&(Se=z&&z.onVnodeUnmounted)||_e)&&queuePostRenderEffect(()=>{Se&&invokeVNodeHook(Se,W,j),_e&&invokeDirectiveHook(j,null,W,"unmounted")},K)},he=j=>{const{type:W,el:K,anchor:ne,transition:re}=j;if(W===Fragment){fe(K,ne);return}if(W===Static){P(j);return}const ae=()=>{o(K),re&&!re.persisted&&re.afterLeave&&re.afterLeave()};if(j.shapeFlag&1&&re&&!re.persisted){const{leave:z,delayLeave:U}=re,X=()=>z(K,ae);U?U(j.el,ae,X):X()}else ae()},fe=(j,W)=>{let K;for(;j!==W;)K=b(j),o(j),j=K;o(W)},pe=(j,W,K)=>{const{bum:ne,scope:re,job:ae,subTree:z,um:U,m:X,a:se}=j;invalidateMount(X),invalidateMount(se),ne&&invokeArrayFns(ne),re.stop(),ae&&(ae.flags|=8,ue(z,j,W,K)),U&&queuePostRenderEffect(U,W),queuePostRenderEffect(()=>{j.isUnmounted=!0},W),W&&W.pendingBranch&&!W.isUnmounted&&j.asyncDep&&!j.asyncResolved&&j.suspenseId===W.pendingId&&(W.deps--,W.deps===0&&W.resolve())},me=(j,W,K,ne=!1,re=!1,ae=0)=>{for(let z=ae;z<j.length;z++)ue(j[z],W,K,ne,re)},ee=j=>{if(j.shapeFlag&6)return ee(j.component.subTree);if(j.shapeFlag&128)return j.suspense.next();const W=b(j.anchor||j.el),K=W&&W[TeleportEndKey];return K?b(K):W};let J=!1;const ie=(j,W,K)=>{j==null?W._vnode&&ue(W._vnode,null,null,!0):A(W._vnode||null,j,W,null,null,null,K),W._vnode=j,J||(J=!0,flushPreFlushCbs(),flushPostFlushCbs(),J=!1)},le={p:A,um:ue,m:te,r:he,mt:H,mc:B,pc:Y,pbc:D,n:ee,o:r};return{render:ie,hydrate:void 0,createApp:createAppAPI(ie)}}function resolveChildrenNamespace({type:r,props:e},i){return i==="svg"&&r==="foreignObject"||i==="mathml"&&r==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:i}function toggleRecurse({effect:r,job:e},i){i?(r.flags|=32,e.flags|=4):(r.flags&=-33,e.flags&=-5)}function needTransition(r,e){return(!r||r&&!r.pendingBranch)&&e&&!e.persisted}function traverseStaticChildren(r,e,i=!1){const n=r.children,o=e.children;if(isArray$3(n)&&isArray$3(o))for(let l=0;l<n.length;l++){const d=n[l];let u=o[l];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=o[l]=cloneIfMounted(o[l]),u.el=d.el),!i&&u.patchFlag!==-2&&traverseStaticChildren(d,u)),u.type===Text$2&&(u.el=d.el)}}function getSequence(r){const e=r.slice(),i=[0];let n,o,l,d,u;const f=r.length;for(n=0;n<f;n++){const g=r[n];if(g!==0){if(o=i[i.length-1],r[o]<g){e[n]=o,i.push(n);continue}for(l=0,d=i.length-1;l<d;)u=l+d>>1,r[i[u]]<g?l=u+1:d=u;g<r[i[l]]&&(l>0&&(e[n]=i[l-1]),i[l]=n)}}for(l=i.length,d=i[l-1];l-- >0;)i[l]=d,d=e[d];return i}function locateNonHydratedAsyncRoot(r){const e=r.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:locateNonHydratedAsyncRoot(e)}function invalidateMount(r){if(r)for(let e=0;e<r.length;e++)r[e].flags|=8}const ssrContextKey=Symbol.for("v-scx"),useSSRContext=()=>inject$1(ssrContextKey);function watch(r,e,i){return doWatch(r,e,i)}function doWatch(r,e,i=EMPTY_OBJ){const{immediate:n,deep:o,flush:l,once:d}=i,u=extend({},i),f=e&&n||!e&&l!=="post";let g;if(isInSSRComponentSetup){if(l==="sync"){const S=useSSRContext();g=S.__watcherHandles||(S.__watcherHandles=[])}else if(!f){const S=()=>{};return S.stop=NOOP,S.resume=NOOP,S.pause=NOOP,S}}const _=currentInstance;u.call=(S,v,A)=>callWithAsyncErrorHandling(S,_,v,A);let y=!1;l==="post"?u.scheduler=S=>{queuePostRenderEffect(S,_&&_.suspense)}:l!=="sync"&&(y=!0,u.scheduler=(S,v)=>{v?S():queueJob(S)}),u.augmentJob=S=>{e&&(S.flags|=4),y&&(S.flags|=2,_&&(S.id=_.uid,S.i=_))};const b=watch$1(r,e,u);return isInSSRComponentSetup&&(g?g.push(b):f&&b()),b}function instanceWatch(r,e,i){const n=this.proxy,o=isString$2(r)?r.includes(".")?createPathGetter(n,r):()=>n[r]:r.bind(n,n);let l;isFunction$2(e)?l=e:(l=e.handler,i=e);const d=setCurrentInstance(this),u=doWatch(o,l.bind(n),i);return d(),u}function createPathGetter(r,e){const i=e.split(".");return()=>{let n=r;for(let o=0;o<i.length&&n;o++)n=n[i[o]];return n}}const getModelModifiers=(r,e)=>e==="modelValue"||e==="model-value"?r.modelModifiers:r[`${e}Modifiers`]||r[`${camelize(e)}Modifiers`]||r[`${hyphenate(e)}Modifiers`];function emit(r,e,...i){if(r.isUnmounted)return;const n=r.vnode.props||EMPTY_OBJ;let o=i;const l=e.startsWith("update:"),d=l&&getModelModifiers(n,e.slice(7));d&&(d.trim&&(o=i.map(_=>isString$2(_)?_.trim():_)),d.number&&(o=i.map(looseToNumber)));let u,f=n[u=toHandlerKey(e)]||n[u=toHandlerKey(camelize(e))];!f&&l&&(f=n[u=toHandlerKey(hyphenate(e))]),f&&callWithAsyncErrorHandling(f,r,6,o);const g=n[u+"Once"];if(g){if(!r.emitted)r.emitted={};else if(r.emitted[u])return;r.emitted[u]=!0,callWithAsyncErrorHandling(g,r,6,o)}}function normalizeEmitsOptions(r,e,i=!1){const n=e.emitsCache,o=n.get(r);if(o!==void 0)return o;const l=r.emits;let d={},u=!1;if(!isFunction$2(r)){const f=g=>{const _=normalizeEmitsOptions(g,e,!0);_&&(u=!0,extend(d,_))};!i&&e.mixins.length&&e.mixins.forEach(f),r.extends&&f(r.extends),r.mixins&&r.mixins.forEach(f)}return!l&&!u?(isObject$3(r)&&n.set(r,null),null):(isArray$3(l)?l.forEach(f=>d[f]=null):extend(d,l),isObject$3(r)&&n.set(r,d),d)}function isEmitListener(r,e){return!r||!isOn(e)?!1:(e=e.slice(2).replace(/Once$/,""),hasOwn$1(r,e[0].toLowerCase()+e.slice(1))||hasOwn$1(r,hyphenate(e))||hasOwn$1(r,e))}function markAttrsAccessed(){}function renderComponentRoot(r){const{type:e,vnode:i,proxy:n,withProxy:o,propsOptions:[l],slots:d,attrs:u,emit:f,render:g,renderCache:_,props:y,data:b,setupState:S,ctx:v,inheritAttrs:A}=r,x=setCurrentRenderingInstance(r);let T,C;try{if(i.shapeFlag&4){const P=o||n,R=P;T=normalizeVNode(g.call(R,P,_,y,S,b,v)),C=u}else{const P=e;T=normalizeVNode(P.length>1?P(y,{attrs:u,slots:d,emit:f}):P(y,null)),C=e.props?u:getFunctionalFallthrough(u)}}catch(P){blockStack.length=0,handleError(P,r,1),T=createVNode(Comment)}let E=T;if(C&&A!==!1){const P=Object.keys(C),{shapeFlag:R}=E;P.length&&R&7&&(l&&P.some(isModelListener)&&(C=filterModelListeners(C,l)),E=cloneVNode(E,C,!1,!0))}return i.dirs&&(E=cloneVNode(E,null,!1,!0),E.dirs=E.dirs?E.dirs.concat(i.dirs):i.dirs),i.transition&&setTransitionHooks(E,i.transition),T=E,setCurrentRenderingInstance(x),T}const getFunctionalFallthrough=r=>{let e;for(const i in r)(i==="class"||i==="style"||isOn(i))&&((e||(e={}))[i]=r[i]);return e},filterModelListeners=(r,e)=>{const i={};for(const n in r)(!isModelListener(n)||!(n.slice(9)in e))&&(i[n]=r[n]);return i};function shouldUpdateComponent(r,e,i){const{props:n,children:o,component:l}=r,{props:d,children:u,patchFlag:f}=e,g=l.emitsOptions;if(e.dirs||e.transition)return!0;if(i&&f>=0){if(f&1024)return!0;if(f&16)return n?hasPropsChanged(n,d,g):!!d;if(f&8){const _=e.dynamicProps;for(let y=0;y<_.length;y++){const b=_[y];if(d[b]!==n[b]&&!isEmitListener(g,b))return!0}}}else return(o||u)&&(!u||!u.$stable)?!0:n===d?!1:n?d?hasPropsChanged(n,d,g):!0:!!d;return!1}function hasPropsChanged(r,e,i){const n=Object.keys(e);if(n.length!==Object.keys(r).length)return!0;for(let o=0;o<n.length;o++){const l=n[o];if(e[l]!==r[l]&&!isEmitListener(i,l))return!0}return!1}function updateHOCHostEl({vnode:r,parent:e},i){for(;e;){const n=e.subTree;if(n.suspense&&n.suspense.activeBranch===r&&(n.el=r.el),n===r)(r=e.vnode).el=i,e=e.parent;else break}}const isSuspense=r=>r.__isSuspense;function queueEffectWithSuspense(r,e){e&&e.pendingBranch?isArray$3(r)?e.effects.push(...r):e.effects.push(r):queuePostFlushCb(r)}const Fragment=Symbol.for("v-fgt"),Text$2=Symbol.for("v-txt"),Comment=Symbol.for("v-cmt"),Static=Symbol.for("v-stc"),blockStack=[];let currentBlock=null;function openBlock(r=!1){blockStack.push(currentBlock=r?null:[])}function closeBlock(){blockStack.pop(),currentBlock=blockStack[blockStack.length-1]||null}let isBlockTreeEnabled=1;function setBlockTracking(r,e=!1){isBlockTreeEnabled+=r,r<0&&currentBlock&&e&&(currentBlock.hasOnce=!0)}function setupBlock(r){return r.dynamicChildren=isBlockTreeEnabled>0?currentBlock||EMPTY_ARR:null,closeBlock(),isBlockTreeEnabled>0&&currentBlock&&currentBlock.push(r),r}function createElementBlock(r,e,i,n,o,l){return setupBlock(createBaseVNode(r,e,i,n,o,l,!0))}function isVNode$1(r){return r?r.__v_isVNode===!0:!1}function isSameVNodeType(r,e){return r.type===e.type&&r.key===e.key}const normalizeKey=({key:r})=>r??null,normalizeRef=({ref:r,ref_key:e,ref_for:i})=>(typeof r=="number"&&(r=""+r),r!=null?isString$2(r)||isRef(r)||isFunction$2(r)?{i:currentRenderingInstance,r,k:e,f:!!i}:r:null);function createBaseVNode(r,e=null,i=null,n=0,o=null,l=r===Fragment?0:1,d=!1,u=!1){const f={__v_isVNode:!0,__v_skip:!0,type:r,props:e,key:e&&normalizeKey(e),ref:e&&normalizeRef(e),scopeId:currentScopeId,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:l,patchFlag:n,dynamicProps:o,dynamicChildren:null,appContext:null,ctx:currentRenderingInstance};return u?(normalizeChildren(f,i),l&128&&r.normalize(f)):i&&(f.shapeFlag|=isString$2(i)?8:16),isBlockTreeEnabled>0&&!d&&currentBlock&&(f.patchFlag>0||l&6)&&f.patchFlag!==32&&currentBlock.push(f),f}const createVNode=_createVNode;function _createVNode(r,e=null,i=null,n=0,o=null,l=!1){if((!r||r===NULL_DYNAMIC_COMPONENT)&&(r=Comment),isVNode$1(r)){const u=cloneVNode(r,e,!0);return i&&normalizeChildren(u,i),isBlockTreeEnabled>0&&!l&&currentBlock&&(u.shapeFlag&6?currentBlock[currentBlock.indexOf(r)]=u:currentBlock.push(u)),u.patchFlag=-2,u}if(isClassComponent(r)&&(r=r.__vccOpts),e){e=guardReactiveProps(e);let{class:u,style:f}=e;u&&!isString$2(u)&&(e.class=normalizeClass(u)),isObject$3(f)&&(isProxy(f)&&!isArray$3(f)&&(f=extend({},f)),e.style=normalizeStyle(f))}const d=isString$2(r)?1:isSuspense(r)?128:isTeleport(r)?64:isObject$3(r)?4:isFunction$2(r)?2:0;return createBaseVNode(r,e,i,n,o,d,l,!0)}function guardReactiveProps(r){return r?isProxy(r)||isInternalObject(r)?extend({},r):r:null}function cloneVNode(r,e,i=!1,n=!1){const{props:o,ref:l,patchFlag:d,children:u,transition:f}=r,g=e?mergeProps(o||{},e):o,_={__v_isVNode:!0,__v_skip:!0,type:r.type,props:g,key:g&&normalizeKey(g),ref:e&&e.ref?i&&l?isArray$3(l)?l.concat(normalizeRef(e)):[l,normalizeRef(e)]:normalizeRef(e):l,scopeId:r.scopeId,slotScopeIds:r.slotScopeIds,children:u,target:r.target,targetStart:r.targetStart,targetAnchor:r.targetAnchor,staticCount:r.staticCount,shapeFlag:r.shapeFlag,patchFlag:e&&r.type!==Fragment?d===-1?16:d|16:d,dynamicProps:r.dynamicProps,dynamicChildren:r.dynamicChildren,appContext:r.appContext,dirs:r.dirs,transition:f,component:r.component,suspense:r.suspense,ssContent:r.ssContent&&cloneVNode(r.ssContent),ssFallback:r.ssFallback&&cloneVNode(r.ssFallback),el:r.el,anchor:r.anchor,ctx:r.ctx,ce:r.ce};return f&&n&&setTransitionHooks(_,f.clone(_)),_}function createTextVNode(r=" ",e=0){return createVNode(Text$2,null,r,e)}function createStaticVNode(r,e){const i=createVNode(Static,null,r);return i.staticCount=e,i}function normalizeVNode(r){return r==null||typeof r=="boolean"?createVNode(Comment):isArray$3(r)?createVNode(Fragment,null,r.slice()):isVNode$1(r)?cloneIfMounted(r):createVNode(Text$2,null,String(r))}function cloneIfMounted(r){return r.el===null&&r.patchFlag!==-1||r.memo?r:cloneVNode(r)}function normalizeChildren(r,e){let i=0;const{shapeFlag:n}=r;if(e==null)e=null;else if(isArray$3(e))i=16;else if(typeof e=="object")if(n&65){const o=e.default;o&&(o._c&&(o._d=!1),normalizeChildren(r,o()),o._c&&(o._d=!0));return}else{i=32;const o=e._;!o&&!isInternalObject(e)?e._ctx=currentRenderingInstance:o===3&&currentRenderingInstance&&(currentRenderingInstance.slots._===1?e._=1:(e._=2,r.patchFlag|=1024))}else isFunction$2(e)?(e={default:e,_ctx:currentRenderingInstance},i=32):(e=String(e),n&64?(i=16,e=[createTextVNode(e)]):i=8);r.children=e,r.shapeFlag|=i}function mergeProps(...r){const e={};for(let i=0;i<r.length;i++){const n=r[i];for(const o in n)if(o==="class")e.class!==n.class&&(e.class=normalizeClass([e.class,n.class]));else if(o==="style")e.style=normalizeStyle([e.style,n.style]);else if(isOn(o)){const l=e[o],d=n[o];d&&l!==d&&!(isArray$3(l)&&l.includes(d))&&(e[o]=l?[].concat(l,d):d)}else o!==""&&(e[o]=n[o])}return e}function invokeVNodeHook(r,e,i,n=null){callWithAsyncErrorHandling(r,e,7,[i,n])}const emptyAppContext=createAppContext();let uid=0;function createComponentInstance(r,e,i){const n=r.type,o=(e?e.appContext:r.appContext)||emptyAppContext,l={uid:uid++,vnode:r,type:n,parent:e,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new EffectScope(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(o.provides),ids:e?e.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:normalizePropsOptions(n,o),emitsOptions:normalizeEmitsOptions(n,o),emit:null,emitted:null,propsDefaults:EMPTY_OBJ,inheritAttrs:n.inheritAttrs,ctx:EMPTY_OBJ,data:EMPTY_OBJ,props:EMPTY_OBJ,attrs:EMPTY_OBJ,slots:EMPTY_OBJ,refs:EMPTY_OBJ,setupState:EMPTY_OBJ,setupContext:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return l.ctx={_:l},l.root=e?e.root:l,l.emit=emit.bind(null,l),r.ce&&r.ce(l),l}let currentInstance=null;const getCurrentInstance=()=>currentInstance||currentRenderingInstance;let internalSetCurrentInstance,setInSSRSetupState;{const r=getGlobalThis$1(),e=(i,n)=>{let o;return(o=r[i])||(o=r[i]=[]),o.push(n),l=>{o.length>1?o.forEach(d=>d(l)):o[0](l)}};internalSetCurrentInstance=e("__VUE_INSTANCE_SETTERS__",i=>currentInstance=i),setInSSRSetupState=e("__VUE_SSR_SETTERS__",i=>isInSSRComponentSetup=i)}const setCurrentInstance=r=>{const e=currentInstance;return internalSetCurrentInstance(r),r.scope.on(),()=>{r.scope.off(),internalSetCurrentInstance(e)}},unsetCurrentInstance=()=>{currentInstance&&currentInstance.scope.off(),internalSetCurrentInstance(null)};function isStatefulComponent(r){return r.vnode.shapeFlag&4}let isInSSRComponentSetup=!1;function setupComponent(r,e=!1,i=!1){e&&setInSSRSetupState(e);const{props:n,children:o}=r.vnode,l=isStatefulComponent(r);initProps(r,n,l,e),initSlots(r,o,i);const d=l?setupStatefulComponent(r,e):void 0;return e&&setInSSRSetupState(!1),d}function setupStatefulComponent(r,e){const i=r.type;r.accessCache=Object.create(null),r.proxy=new Proxy(r.ctx,PublicInstanceProxyHandlers);const{setup:n}=i;if(n){pauseTracking();const o=r.setupContext=n.length>1?createSetupContext(r):null,l=setCurrentInstance(r),d=callWithErrorHandling(n,r,0,[r.props,o]),u=isPromise$1(d);if(resetTracking(),l(),(u||r.sp)&&!isAsyncWrapper(r)&&markAsyncBoundary(r),u){if(d.then(unsetCurrentInstance,unsetCurrentInstance),e)return d.then(f=>{handleSetupResult(r,f)}).catch(f=>{handleError(f,r,0)});r.asyncDep=d}else handleSetupResult(r,d)}else finishComponentSetup(r)}function handleSetupResult(r,e,i){isFunction$2(e)?r.type.__ssrInlineRender?r.ssrRender=e:r.render=e:isObject$3(e)&&(r.setupState=proxyRefs(e)),finishComponentSetup(r)}function finishComponentSetup(r,e,i){const n=r.type;r.render||(r.render=n.render||NOOP);{const o=setCurrentInstance(r);pauseTracking();try{applyOptions(r)}finally{resetTracking(),o()}}}const attrsProxyHandlers={get(r,e){return track(r,"get",""),r[e]}};function createSetupContext(r){const e=i=>{r.exposed=i||{}};return{attrs:new Proxy(r.attrs,attrsProxyHandlers),slots:r.slots,emit:r.emit,expose:e}}function getComponentPublicInstance(r){return r.exposed?r.exposeProxy||(r.exposeProxy=new Proxy(proxyRefs(markRaw(r.exposed)),{get(e,i){if(i in e)return e[i];if(i in publicPropertiesMap)return publicPropertiesMap[i](r)},has(e,i){return i in e||i in publicPropertiesMap}})):r.proxy}const classifyRE=/(?:^|[-_])(\w)/g,classify=r=>r.replace(classifyRE,e=>e.toUpperCase()).replace(/[-_]/g,"");function getComponentName(r,e=!0){return isFunction$2(r)?r.displayName||r.name:r.name||e&&r.__name}function formatComponentName(r,e,i=!1){let n=getComponentName(e);if(!n&&e.__file){const o=e.__file.match(/([^/\\]+)\.\w+$/);o&&(n=o[1])}if(!n&&r&&r.parent){const o=l=>{for(const d in l)if(l[d]===e)return d};n=o(r.components||r.parent.type.components)||o(r.appContext.components)}return n?classify(n):i?"App":"Anonymous"}function isClassComponent(r){return isFunction$2(r)&&"__vccOpts"in r}const computed=(r,e)=>computed$1(r,e,isInSSRComponentSetup);function h(r,e,i){const n=arguments.length;return n===2?isObject$3(e)&&!isArray$3(e)?isVNode$1(e)?createVNode(r,null,[e]):createVNode(r,e):createVNode(r,null,e):(n>3?i=Array.prototype.slice.call(arguments,2):n===3&&isVNode$1(i)&&(i=[i]),createVNode(r,e,i))}const version="3.5.13";/**
* @vue/runtime-dom v3.5.13
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let policy;const tt=typeof window<"u"&&window.trustedTypes;if(tt)try{policy=tt.createPolicy("vue",{createHTML:r=>r})}catch{}const unsafeToTrustedHTML=policy?r=>policy.createHTML(r):r=>r,svgNS="http://www.w3.org/2000/svg",mathmlNS="http://www.w3.org/1998/Math/MathML",doc=typeof document<"u"?document:null,templateContainer=doc&&doc.createElement("template"),nodeOps={insert:(r,e,i)=>{e.insertBefore(r,i||null)},remove:r=>{const e=r.parentNode;e&&e.removeChild(r)},createElement:(r,e,i,n)=>{const o=e==="svg"?doc.createElementNS(svgNS,r):e==="mathml"?doc.createElementNS(mathmlNS,r):i?doc.createElement(r,{is:i}):doc.createElement(r);return r==="select"&&n&&n.multiple!=null&&o.setAttribute("multiple",n.multiple),o},createText:r=>doc.createTextNode(r),createComment:r=>doc.createComment(r),setText:(r,e)=>{r.nodeValue=e},setElementText:(r,e)=>{r.textContent=e},parentNode:r=>r.parentNode,nextSibling:r=>r.nextSibling,querySelector:r=>doc.querySelector(r),setScopeId(r,e){r.setAttribute(e,"")},insertStaticContent(r,e,i,n,o,l){const d=i?i.previousSibling:e.lastChild;if(o&&(o===l||o.nextSibling))for(;e.insertBefore(o.cloneNode(!0),i),!(o===l||!(o=o.nextSibling)););else{templateContainer.innerHTML=unsafeToTrustedHTML(n==="svg"?`<svg>${r}</svg>`:n==="mathml"?`<math>${r}</math>`:r);const u=templateContainer.content;if(n==="svg"||n==="mathml"){const f=u.firstChild;for(;f.firstChild;)u.appendChild(f.firstChild);u.removeChild(f)}e.insertBefore(u,i)}return[d?d.nextSibling:e.firstChild,i?i.previousSibling:e.lastChild]}},vtcKey=Symbol("_vtc");function patchClass(r,e,i){const n=r[vtcKey];n&&(e=(e?[e,...n]:[...n]).join(" ")),e==null?r.removeAttribute("class"):i?r.setAttribute("class",e):r.className=e}const vShowOriginalDisplay=Symbol("_vod"),vShowHidden=Symbol("_vsh"),vShow={beforeMount(r,{value:e},{transition:i}){r[vShowOriginalDisplay]=r.style.display==="none"?"":r.style.display,i&&e?i.beforeEnter(r):setDisplay(r,e)},mounted(r,{value:e},{transition:i}){i&&e&&i.enter(r)},updated(r,{value:e,oldValue:i},{transition:n}){!e!=!i&&(n?e?(n.beforeEnter(r),setDisplay(r,!0),n.enter(r)):n.leave(r,()=>{setDisplay(r,!1)}):setDisplay(r,e))},beforeUnmount(r,{value:e}){setDisplay(r,e)}};function setDisplay(r,e){r.style.display=e?r[vShowOriginalDisplay]:"none",r[vShowHidden]=!e}const CSS_VAR_TEXT=Symbol(""),displayRE=/(^|;)\s*display\s*:/;function patchStyle(r,e,i){const n=r.style,o=isString$2(i);let l=!1;if(i&&!o){if(e)if(isString$2(e))for(const d of e.split(";")){const u=d.slice(0,d.indexOf(":")).trim();i[u]==null&&setStyle(n,u,"")}else for(const d in e)i[d]==null&&setStyle(n,d,"");for(const d in i)d==="display"&&(l=!0),setStyle(n,d,i[d])}else if(o){if(e!==i){const d=n[CSS_VAR_TEXT];d&&(i+=";"+d),n.cssText=i,l=displayRE.test(i)}}else e&&r.removeAttribute("style");vShowOriginalDisplay in r&&(r[vShowOriginalDisplay]=l?n.display:"",r[vShowHidden]&&(n.display="none"))}const importantRE=/\s*!important$/;function setStyle(r,e,i){if(isArray$3(i))i.forEach(n=>setStyle(r,e,n));else if(i==null&&(i=""),e.startsWith("--"))r.setProperty(e,i);else{const n=autoPrefix(r,e);importantRE.test(i)?r.setProperty(hyphenate(n),i.replace(importantRE,""),"important"):r[n]=i}}const prefixes$1=["Webkit","Moz","ms"],prefixCache={};function autoPrefix(r,e){const i=prefixCache[e];if(i)return i;let n=camelize(e);if(n!=="filter"&&n in r)return prefixCache[e]=n;n=capitalize$1(n);for(let o=0;o<prefixes$1.length;o++){const l=prefixes$1[o]+n;if(l in r)return prefixCache[e]=l}return e}const xlinkNS="http://www.w3.org/1999/xlink";function patchAttr(r,e,i,n,o,l=isSpecialBooleanAttr(e)){n&&e.startsWith("xlink:")?i==null?r.removeAttributeNS(xlinkNS,e.slice(6,e.length)):r.setAttributeNS(xlinkNS,e,i):i==null||l&&!includeBooleanAttr(i)?r.removeAttribute(e):r.setAttribute(e,l?"":isSymbol(i)?String(i):i)}function patchDOMProp(r,e,i,n,o){if(e==="innerHTML"||e==="textContent"){i!=null&&(r[e]=e==="innerHTML"?unsafeToTrustedHTML(i):i);return}const l=r.tagName;if(e==="value"&&l!=="PROGRESS"&&!l.includes("-")){const u=l==="OPTION"?r.getAttribute("value")||"":r.value,f=i==null?r.type==="checkbox"?"on":"":String(i);(u!==f||!("_value"in r))&&(r.value=f),i==null&&r.removeAttribute(e),r._value=i;return}let d=!1;if(i===""||i==null){const u=typeof r[e];u==="boolean"?i=includeBooleanAttr(i):i==null&&u==="string"?(i="",d=!0):u==="number"&&(i=0,d=!0)}try{r[e]=i}catch{}d&&r.removeAttribute(o||e)}function addEventListener(r,e,i,n){r.addEventListener(e,i,n)}function removeEventListener(r,e,i,n){r.removeEventListener(e,i,n)}const veiKey=Symbol("_vei");function patchEvent(r,e,i,n,o=null){const l=r[veiKey]||(r[veiKey]={}),d=l[e];if(n&&d)d.value=n;else{const[u,f]=parseName(e);if(n){const g=l[e]=createInvoker(n,o);addEventListener(r,u,g,f)}else d&&(removeEventListener(r,u,d,f),l[e]=void 0)}}const optionsModifierRE=/(?:Once|Passive|Capture)$/;function parseName(r){let e;if(optionsModifierRE.test(r)){e={};let n;for(;n=r.match(optionsModifierRE);)r=r.slice(0,r.length-n[0].length),e[n[0].toLowerCase()]=!0}return[r[2]===":"?r.slice(3):hyphenate(r.slice(2)),e]}let cachedNow=0;const p=Promise.resolve(),getNow=()=>cachedNow||(p.then(()=>cachedNow=0),cachedNow=Date.now());function createInvoker(r,e){const i=n=>{if(!n._vts)n._vts=Date.now();else if(n._vts<=i.attached)return;callWithAsyncErrorHandling(patchStopImmediatePropagation(n,i.value),e,5,[n])};return i.value=r,i.attached=getNow(),i}function patchStopImmediatePropagation(r,e){if(isArray$3(e)){const i=r.stopImmediatePropagation;return r.stopImmediatePropagation=()=>{i.call(r),r._stopped=!0},e.map(n=>o=>!o._stopped&&n&&n(o))}else return e}const isNativeOn=r=>r.charCodeAt(0)===111&&r.charCodeAt(1)===110&&r.charCodeAt(2)>96&&r.charCodeAt(2)<123,patchProp=(r,e,i,n,o,l)=>{const d=o==="svg";e==="class"?patchClass(r,n,d):e==="style"?patchStyle(r,i,n):isOn(e)?isModelListener(e)||patchEvent(r,e,i,n,l):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):shouldSetAsProp(r,e,n,d))?(patchDOMProp(r,e,n),!r.tagName.includes("-")&&(e==="value"||e==="checked"||e==="selected")&&patchAttr(r,e,n,d,l,e!=="value")):r._isVueCE&&(/[A-Z]/.test(e)||!isString$2(n))?patchDOMProp(r,camelize(e),n,l,e):(e==="true-value"?r._trueValue=n:e==="false-value"&&(r._falseValue=n),patchAttr(r,e,n,d))};function shouldSetAsProp(r,e,i,n){if(n)return!!(e==="innerHTML"||e==="textContent"||e in r&&isNativeOn(e)&&isFunction$2(i));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&r.tagName==="INPUT"||e==="type"&&r.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const o=r.tagName;if(o==="IMG"||o==="VIDEO"||o==="CANVAS"||o==="SOURCE")return!1}return isNativeOn(e)&&isString$2(i)?!1:e in r}const rendererOptions=extend({patchProp},nodeOps);let renderer;function ensureRenderer(){return renderer||(renderer=createRenderer(rendererOptions))}const createApp=(...r)=>{const e=ensureRenderer().createApp(...r),{mount:i}=e;return e.mount=n=>{const o=normalizeContainer(n);if(!o)return;const l=e._component;!isFunction$2(l)&&!l.render&&!l.template&&(l.template=o.innerHTML),o.nodeType===1&&(o.textContent="");const d=i(o,!1,resolveRootNamespace(o));return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),d},e};function resolveRootNamespace(r){if(r instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&r instanceof MathMLElement)return"mathml"}function normalizeContainer(r){return isString$2(r)?document.querySelector(r):r}const _imports_0$5=""+new URL("logo-D8wqlOEt.png",import.meta.url).href,_imports_1$3="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2050%2050'%20width='40px'%20height='40px'%3e%3cpath%20d='M%205%208%20A%202.0002%202.0002%200%201%200%205%2012%20L%2045%2012%20A%202.0002%202.0002%200%201%200%2045%208%20L%205%208%20z%20M%205%2023%20A%202.0002%202.0002%200%201%200%205%2027%20L%2045%2027%20A%202.0002%202.0002%200%201%200%2045%2023%20L%205%2023%20z%20M%205%2038%20A%202.0002%202.0002%200%201%200%205%2042%20L%2045%2042%20A%202.0002%202.0002%200%201%200%2045%2038%20L%205%2038%20z'%20fill='%23000'%3e%3c/path%3e%3c/svg%3e";/*!
  * shared v11.0.0-rc.1
  * (c) 2024 kazuya kawaguchi
  * Released under the MIT License.
  */const inBrowser=typeof window<"u",makeSymbol=(r,e=!1)=>e?Symbol.for(r):Symbol(r),generateFormatCacheKey=(r,e,i)=>friendlyJSONstringify({l:r,k:e,s:i}),friendlyJSONstringify=r=>JSON.stringify(r).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029").replace(/\u0027/g,"\\u0027"),isNumber$1=r=>typeof r=="number"&&isFinite(r),isDate$1=r=>toTypeString(r)==="[object Date]",isRegExp=r=>toTypeString(r)==="[object RegExp]",isEmptyObject=r=>isPlainObject$1(r)&&Object.keys(r).length===0,assign$1=Object.assign,_create=Object.create,create$2=(r=null)=>_create(r);let _globalThis;const getGlobalThis=()=>_globalThis||(_globalThis=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:create$2());function escapeHtml(r){return r.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}const hasOwnProperty$2=Object.prototype.hasOwnProperty;function hasOwn(r,e){return hasOwnProperty$2.call(r,e)}const isArray$2=Array.isArray,isFunction$1=r=>typeof r=="function",isString$1=r=>typeof r=="string",isBoolean$1=r=>typeof r=="boolean",isObject$2=r=>r!==null&&typeof r=="object",isPromise=r=>isObject$2(r)&&isFunction$1(r.then)&&isFunction$1(r.catch),objectToString=Object.prototype.toString,toTypeString=r=>objectToString.call(r),isPlainObject$1=r=>toTypeString(r)==="[object Object]",toDisplayString=r=>r==null?"":isArray$2(r)||isPlainObject$1(r)&&r.toString===objectToString?JSON.stringify(r,null,2):String(r);function join(r,e=""){return r.reduce((i,n,o)=>o===0?i+n:i+e+n,"")}function warn$1(r,e){typeof console<"u"&&(console.warn("[intlify] "+r),e&&console.warn(e.stack))}const isNotObjectOrIsArray=r=>!isObject$2(r)||isArray$2(r);function deepCopy(r,e){if(isNotObjectOrIsArray(r)||isNotObjectOrIsArray(e))throw new Error("Invalid value");const i=[{src:r,des:e}];for(;i.length;){const{src:n,des:o}=i.pop();Object.keys(n).forEach(l=>{l!=="__proto__"&&(isObject$2(n[l])&&!isObject$2(o[l])&&(o[l]=Array.isArray(n[l])?[]:create$2()),isNotObjectOrIsArray(o[l])||isNotObjectOrIsArray(n[l])?o[l]=n[l]:i.push({src:n[l],des:o[l]}))})}}/*!
  * message-compiler v11.0.0-rc.1
  * (c) 2024 kazuya kawaguchi
  * Released under the MIT License.
  */function createPosition(r,e,i){return{line:r,column:e,offset:i}}function createLocation(r,e,i){return{start:r,end:e}}const CompileErrorCodes={EXPECTED_TOKEN:1,INVALID_TOKEN_IN_PLACEHOLDER:2,UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER:3,UNKNOWN_ESCAPE_SEQUENCE:4,INVALID_UNICODE_ESCAPE_SEQUENCE:5,UNBALANCED_CLOSING_BRACE:6,UNTERMINATED_CLOSING_BRACE:7,EMPTY_PLACEHOLDER:8,NOT_ALLOW_NEST_PLACEHOLDER:9,INVALID_LINKED_FORMAT:10,MUST_HAVE_MESSAGES_IN_PLURAL:11,UNEXPECTED_EMPTY_LINKED_MODIFIER:12,UNEXPECTED_EMPTY_LINKED_KEY:13,UNEXPECTED_LEXICAL_ANALYSIS:14},COMPILE_ERROR_CODES_EXTEND_POINT=17;function createCompileError(r,e,i={}){const{domain:n,messages:o,args:l}=i,d=r,u=new SyntaxError(String(d));return u.code=r,e&&(u.location=e),u.domain=n,u}function defaultOnError(r){throw r}const CHAR_SP=" ",CHAR_CR="\r",CHAR_LF=`
`,CHAR_LS="\u2028",CHAR_PS="\u2029";function createScanner(r){const e=r;let i=0,n=1,o=1,l=0;const d=w=>e[w]===CHAR_CR&&e[w+1]===CHAR_LF,u=w=>e[w]===CHAR_LF,f=w=>e[w]===CHAR_PS,g=w=>e[w]===CHAR_LS,_=w=>d(w)||u(w)||f(w)||g(w),y=()=>i,b=()=>n,S=()=>o,v=()=>l,A=w=>d(w)||f(w)||g(w)?CHAR_LF:e[w],x=()=>A(i),T=()=>A(i+l);function C(){return l=0,_(i)&&(n++,o=0),d(i)&&i++,i++,o++,e[i]}function E(){return d(i+l)&&l++,l++,e[i+l]}function P(){i=0,n=1,o=1,l=0}function R(w=0){l=w}function L(){const w=i+l;for(;w!==i;)C();l=0}return{index:y,line:b,column:S,peekOffset:v,charAt:A,currentChar:x,currentPeek:T,next:C,peek:E,reset:P,resetPeek:R,skipToPeek:L}}const EOF$1=void 0,DOT=".",LITERAL_DELIMITER="'",ERROR_DOMAIN$3="tokenizer";function createTokenizer(r,e={}){const i=e.location!==!1,n=createScanner(r),o=()=>n.index(),l=()=>createPosition(n.line(),n.column(),n.index()),d=l(),u=o(),f={currentType:13,offset:u,startLoc:d,endLoc:d,lastType:13,lastOffset:u,lastStartLoc:d,lastEndLoc:d,braceNest:0,inLinked:!1,text:""},g=()=>f,{onError:_}=e;function y(z,U,X,...se){const ge=g();if(U.column+=X,U.offset+=X,_){const de=i?createLocation(ge.startLoc,U):null,Z=createCompileError(z,de,{domain:ERROR_DOMAIN$3,args:se});_(Z)}}function b(z,U,X){z.endLoc=l(),z.currentType=U;const se={type:U};return i&&(se.loc=createLocation(z.startLoc,z.endLoc)),X!=null&&(se.value=X),se}const S=z=>b(z,13);function v(z,U){return z.currentChar()===U?(z.next(),U):(y(CompileErrorCodes.EXPECTED_TOKEN,l(),0,U),"")}function A(z){let U="";for(;z.currentPeek()===CHAR_SP||z.currentPeek()===CHAR_LF;)U+=z.currentPeek(),z.peek();return U}function x(z){const U=A(z);return z.skipToPeek(),U}function T(z){if(z===EOF$1)return!1;const U=z.charCodeAt(0);return U>=97&&U<=122||U>=65&&U<=90||U===95}function C(z){if(z===EOF$1)return!1;const U=z.charCodeAt(0);return U>=48&&U<=57}function E(z,U){const{currentType:X}=U;if(X!==2)return!1;A(z);const se=T(z.currentPeek());return z.resetPeek(),se}function P(z,U){const{currentType:X}=U;if(X!==2)return!1;A(z);const se=z.currentPeek()==="-"?z.peek():z.currentPeek(),ge=C(se);return z.resetPeek(),ge}function R(z,U){const{currentType:X}=U;if(X!==2)return!1;A(z);const se=z.currentPeek()===LITERAL_DELIMITER;return z.resetPeek(),se}function L(z,U){const{currentType:X}=U;if(X!==7)return!1;A(z);const se=z.currentPeek()===".";return z.resetPeek(),se}function w(z,U){const{currentType:X}=U;if(X!==8)return!1;A(z);const se=T(z.currentPeek());return z.resetPeek(),se}function B(z,U){const{currentType:X}=U;if(!(X===7||X===11))return!1;A(z);const se=z.currentPeek()===":";return z.resetPeek(),se}function I(z,U){const{currentType:X}=U;if(X!==9)return!1;const se=()=>{const de=z.currentPeek();return de==="{"?T(z.peek()):de==="@"||de==="|"||de===":"||de==="."||de===CHAR_SP||!de?!1:de===CHAR_LF?(z.peek(),se()):O(z,!1)},ge=se();return z.resetPeek(),ge}function D(z){A(z);const U=z.currentPeek()==="|";return z.resetPeek(),U}function O(z,U=!0){const X=(ge=!1,de="")=>{const Z=z.currentPeek();return Z==="{"||Z==="@"||!Z?ge:Z==="|"?!(de===CHAR_SP||de===CHAR_LF):Z===CHAR_SP?(z.peek(),X(!0,CHAR_SP)):Z===CHAR_LF?(z.peek(),X(!0,CHAR_LF)):!0},se=X();return U&&z.resetPeek(),se}function N(z,U){const X=z.currentChar();return X===EOF$1?EOF$1:U(X)?(z.next(),X):null}function V(z){const U=z.charCodeAt(0);return U>=97&&U<=122||U>=65&&U<=90||U>=48&&U<=57||U===95||U===36}function H(z){return N(z,V)}function F(z){const U=z.charCodeAt(0);return U>=97&&U<=122||U>=65&&U<=90||U>=48&&U<=57||U===95||U===36||U===45}function $(z){return N(z,F)}function G(z){const U=z.charCodeAt(0);return U>=48&&U<=57}function Y(z){return N(z,G)}function Q(z){const U=z.charCodeAt(0);return U>=48&&U<=57||U>=65&&U<=70||U>=97&&U<=102}function q(z){return N(z,Q)}function te(z){let U="",X="";for(;U=Y(z);)X+=U;return X}function ue(z){let U="";for(;;){const X=z.currentChar();if(X==="{"||X==="}"||X==="@"||X==="|"||!X)break;if(X===CHAR_SP||X===CHAR_LF)if(O(z))U+=X,z.next();else{if(D(z))break;U+=X,z.next()}else U+=X,z.next()}return U}function he(z){x(z);let U="",X="";for(;U=$(z);)X+=U;return z.currentChar()===EOF$1&&y(CompileErrorCodes.UNTERMINATED_CLOSING_BRACE,l(),0),X}function fe(z){x(z);let U="";return z.currentChar()==="-"?(z.next(),U+=`-${te(z)}`):U+=te(z),z.currentChar()===EOF$1&&y(CompileErrorCodes.UNTERMINATED_CLOSING_BRACE,l(),0),U}function pe(z){return z!==LITERAL_DELIMITER&&z!==CHAR_LF}function me(z){x(z),v(z,"'");let U="",X="";for(;U=N(z,pe);)U==="\\"?X+=ee(z):X+=U;const se=z.currentChar();return se===CHAR_LF||se===EOF$1?(y(CompileErrorCodes.UNTERMINATED_SINGLE_QUOTE_IN_PLACEHOLDER,l(),0),se===CHAR_LF&&(z.next(),v(z,"'")),X):(v(z,"'"),X)}function ee(z){const U=z.currentChar();switch(U){case"\\":case"'":return z.next(),`\\${U}`;case"u":return J(z,U,4);case"U":return J(z,U,6);default:return y(CompileErrorCodes.UNKNOWN_ESCAPE_SEQUENCE,l(),0,U),""}}function J(z,U,X){v(z,U);let se="";for(let ge=0;ge<X;ge++){const de=q(z);if(!de){y(CompileErrorCodes.INVALID_UNICODE_ESCAPE_SEQUENCE,l(),0,`\\${U}${se}${z.currentChar()}`);break}se+=de}return`\\${U}${se}`}function ie(z){return z!=="{"&&z!=="}"&&z!==CHAR_SP&&z!==CHAR_LF}function le(z){x(z);let U="",X="";for(;U=N(z,ie);)X+=U;return X}function ce(z){let U="",X="";for(;U=H(z);)X+=U;return X}function j(z){const U=X=>{const se=z.currentChar();return se==="{"||se==="@"||se==="|"||se==="("||se===")"||!se||se===CHAR_SP?X:(X+=se,z.next(),U(X))};return U("")}function W(z){x(z);const U=v(z,"|");return x(z),U}function K(z,U){let X=null;switch(z.currentChar()){case"{":return U.braceNest>=1&&y(CompileErrorCodes.NOT_ALLOW_NEST_PLACEHOLDER,l(),0),z.next(),X=b(U,2,"{"),x(z),U.braceNest++,X;case"}":return U.braceNest>0&&U.currentType===2&&y(CompileErrorCodes.EMPTY_PLACEHOLDER,l(),0),z.next(),X=b(U,3,"}"),U.braceNest--,U.braceNest>0&&x(z),U.inLinked&&U.braceNest===0&&(U.inLinked=!1),X;case"@":return U.braceNest>0&&y(CompileErrorCodes.UNTERMINATED_CLOSING_BRACE,l(),0),X=ne(z,U)||S(U),U.braceNest=0,X;default:{let ge=!0,de=!0,Z=!0;if(D(z))return U.braceNest>0&&y(CompileErrorCodes.UNTERMINATED_CLOSING_BRACE,l(),0),X=b(U,1,W(z)),U.braceNest=0,U.inLinked=!1,X;if(U.braceNest>0&&(U.currentType===4||U.currentType===5||U.currentType===6))return y(CompileErrorCodes.UNTERMINATED_CLOSING_BRACE,l(),0),U.braceNest=0,re(z,U);if(ge=E(z,U))return X=b(U,4,he(z)),x(z),X;if(de=P(z,U))return X=b(U,5,fe(z)),x(z),X;if(Z=R(z,U))return X=b(U,6,me(z)),x(z),X;if(!ge&&!de&&!Z)return X=b(U,12,le(z)),y(CompileErrorCodes.INVALID_TOKEN_IN_PLACEHOLDER,l(),0,X.value),x(z),X;break}}return X}function ne(z,U){const{currentType:X}=U;let se=null;const ge=z.currentChar();switch((X===7||X===8||X===11||X===9)&&(ge===CHAR_LF||ge===CHAR_SP)&&y(CompileErrorCodes.INVALID_LINKED_FORMAT,l(),0),ge){case"@":return z.next(),se=b(U,7,"@"),U.inLinked=!0,se;case".":return x(z),z.next(),b(U,8,".");case":":return x(z),z.next(),b(U,9,":");default:return D(z)?(se=b(U,1,W(z)),U.braceNest=0,U.inLinked=!1,se):L(z,U)||B(z,U)?(x(z),ne(z,U)):w(z,U)?(x(z),b(U,11,ce(z))):I(z,U)?(x(z),ge==="{"?K(z,U)||se:b(U,10,j(z))):(X===7&&y(CompileErrorCodes.INVALID_LINKED_FORMAT,l(),0),U.braceNest=0,U.inLinked=!1,re(z,U))}}function re(z,U){let X={type:13};if(U.braceNest>0)return K(z,U)||S(U);if(U.inLinked)return ne(z,U)||S(U);switch(z.currentChar()){case"{":return K(z,U)||S(U);case"}":return y(CompileErrorCodes.UNBALANCED_CLOSING_BRACE,l(),0),z.next(),b(U,3,"}");case"@":return ne(z,U)||S(U);default:{if(D(z))return X=b(U,1,W(z)),U.braceNest=0,U.inLinked=!1,X;if(O(z))return b(U,0,ue(z));break}}return X}function ae(){const{currentType:z,offset:U,startLoc:X,endLoc:se}=f;return f.lastType=z,f.lastOffset=U,f.lastStartLoc=X,f.lastEndLoc=se,f.offset=o(),f.startLoc=l(),n.currentChar()===EOF$1?b(f,13):re(n,f)}return{nextToken:ae,currentOffset:o,currentPosition:l,context:g}}const ERROR_DOMAIN$2="parser",KNOWN_ESCAPES=/(?:\\\\|\\'|\\u([0-9a-fA-F]{4})|\\U([0-9a-fA-F]{6}))/g;function fromEscapeSequence(r,e,i){switch(r){case"\\\\":return"\\";case"\\'":return"'";default:{const n=parseInt(e||i,16);return n<=55295||n>=57344?String.fromCodePoint(n):""}}}function createParser(r={}){const e=r.location!==!1,{onError:i}=r;function n(T,C,E,P,...R){const L=T.currentPosition();if(L.offset+=P,L.column+=P,i){const w=e?createLocation(E,L):null,B=createCompileError(C,w,{domain:ERROR_DOMAIN$2,args:R});i(B)}}function o(T,C,E){const P={type:T};return e&&(P.start=C,P.end=C,P.loc={start:E,end:E}),P}function l(T,C,E,P){e&&(T.end=C,T.loc&&(T.loc.end=E))}function d(T,C){const E=T.context(),P=o(3,E.offset,E.startLoc);return P.value=C,l(P,T.currentOffset(),T.currentPosition()),P}function u(T,C){const E=T.context(),{lastOffset:P,lastStartLoc:R}=E,L=o(5,P,R);return L.index=parseInt(C,10),T.nextToken(),l(L,T.currentOffset(),T.currentPosition()),L}function f(T,C){const E=T.context(),{lastOffset:P,lastStartLoc:R}=E,L=o(4,P,R);return L.key=C,T.nextToken(),l(L,T.currentOffset(),T.currentPosition()),L}function g(T,C){const E=T.context(),{lastOffset:P,lastStartLoc:R}=E,L=o(9,P,R);return L.value=C.replace(KNOWN_ESCAPES,fromEscapeSequence),T.nextToken(),l(L,T.currentOffset(),T.currentPosition()),L}function _(T){const C=T.nextToken(),E=T.context(),{lastOffset:P,lastStartLoc:R}=E,L=o(8,P,R);return C.type!==11?(n(T,CompileErrorCodes.UNEXPECTED_EMPTY_LINKED_MODIFIER,E.lastStartLoc,0),L.value="",l(L,P,R),{nextConsumeToken:C,node:L}):(C.value==null&&n(T,CompileErrorCodes.UNEXPECTED_LEXICAL_ANALYSIS,E.lastStartLoc,0,getTokenCaption(C)),L.value=C.value||"",l(L,T.currentOffset(),T.currentPosition()),{node:L})}function y(T,C){const E=T.context(),P=o(7,E.offset,E.startLoc);return P.value=C,l(P,T.currentOffset(),T.currentPosition()),P}function b(T){const C=T.context(),E=o(6,C.offset,C.startLoc);let P=T.nextToken();if(P.type===8){const R=_(T);E.modifier=R.node,P=R.nextConsumeToken||T.nextToken()}switch(P.type!==9&&n(T,CompileErrorCodes.UNEXPECTED_LEXICAL_ANALYSIS,C.lastStartLoc,0,getTokenCaption(P)),P=T.nextToken(),P.type===2&&(P=T.nextToken()),P.type){case 10:P.value==null&&n(T,CompileErrorCodes.UNEXPECTED_LEXICAL_ANALYSIS,C.lastStartLoc,0,getTokenCaption(P)),E.key=y(T,P.value||"");break;case 4:P.value==null&&n(T,CompileErrorCodes.UNEXPECTED_LEXICAL_ANALYSIS,C.lastStartLoc,0,getTokenCaption(P)),E.key=f(T,P.value||"");break;case 5:P.value==null&&n(T,CompileErrorCodes.UNEXPECTED_LEXICAL_ANALYSIS,C.lastStartLoc,0,getTokenCaption(P)),E.key=u(T,P.value||"");break;case 6:P.value==null&&n(T,CompileErrorCodes.UNEXPECTED_LEXICAL_ANALYSIS,C.lastStartLoc,0,getTokenCaption(P)),E.key=g(T,P.value||"");break;default:{n(T,CompileErrorCodes.UNEXPECTED_EMPTY_LINKED_KEY,C.lastStartLoc,0);const R=T.context(),L=o(7,R.offset,R.startLoc);return L.value="",l(L,R.offset,R.startLoc),E.key=L,l(E,R.offset,R.startLoc),{nextConsumeToken:P,node:E}}}return l(E,T.currentOffset(),T.currentPosition()),{node:E}}function S(T){const C=T.context(),E=C.currentType===1?T.currentOffset():C.offset,P=C.currentType===1?C.endLoc:C.startLoc,R=o(2,E,P);R.items=[];let L=null;do{const I=L||T.nextToken();switch(L=null,I.type){case 0:I.value==null&&n(T,CompileErrorCodes.UNEXPECTED_LEXICAL_ANALYSIS,C.lastStartLoc,0,getTokenCaption(I)),R.items.push(d(T,I.value||""));break;case 5:I.value==null&&n(T,CompileErrorCodes.UNEXPECTED_LEXICAL_ANALYSIS,C.lastStartLoc,0,getTokenCaption(I)),R.items.push(u(T,I.value||""));break;case 4:I.value==null&&n(T,CompileErrorCodes.UNEXPECTED_LEXICAL_ANALYSIS,C.lastStartLoc,0,getTokenCaption(I)),R.items.push(f(T,I.value||""));break;case 6:I.value==null&&n(T,CompileErrorCodes.UNEXPECTED_LEXICAL_ANALYSIS,C.lastStartLoc,0,getTokenCaption(I)),R.items.push(g(T,I.value||""));break;case 7:{const D=b(T);R.items.push(D.node),L=D.nextConsumeToken||null;break}}}while(C.currentType!==13&&C.currentType!==1);const w=C.currentType===1?C.lastOffset:T.currentOffset(),B=C.currentType===1?C.lastEndLoc:T.currentPosition();return l(R,w,B),R}function v(T,C,E,P){const R=T.context();let L=P.items.length===0;const w=o(1,C,E);w.cases=[],w.cases.push(P);do{const B=S(T);L||(L=B.items.length===0),w.cases.push(B)}while(R.currentType!==13);return L&&n(T,CompileErrorCodes.MUST_HAVE_MESSAGES_IN_PLURAL,E,0),l(w,T.currentOffset(),T.currentPosition()),w}function A(T){const C=T.context(),{offset:E,startLoc:P}=C,R=S(T);return C.currentType===13?R:v(T,E,P,R)}function x(T){const C=createTokenizer(T,assign$1({},r)),E=C.context(),P=o(0,E.offset,E.startLoc);return e&&P.loc&&(P.loc.source=T),P.body=A(C),r.onCacheKey&&(P.cacheKey=r.onCacheKey(T)),E.currentType!==13&&n(C,CompileErrorCodes.UNEXPECTED_LEXICAL_ANALYSIS,E.lastStartLoc,0,T[E.offset]||""),l(P,C.currentOffset(),C.currentPosition()),P}return{parse:x}}function getTokenCaption(r){if(r.type===13)return"EOF";const e=(r.value||"").replace(/\r?\n/gu,"\\n");return e.length>10?e.slice(0,9)+"":e}function createTransformer(r,e={}){const i={ast:r,helpers:new Set};return{context:()=>i,helper:l=>(i.helpers.add(l),l)}}function traverseNodes(r,e){for(let i=0;i<r.length;i++)traverseNode(r[i],e)}function traverseNode(r,e){switch(r.type){case 1:traverseNodes(r.cases,e),e.helper("plural");break;case 2:traverseNodes(r.items,e);break;case 6:{traverseNode(r.key,e),e.helper("linked"),e.helper("type");break}case 5:e.helper("interpolate"),e.helper("list");break;case 4:e.helper("interpolate"),e.helper("named");break}}function transform$9(r,e={}){const i=createTransformer(r);i.helper("normalize"),r.body&&traverseNode(r.body,i);const n=i.context();r.helpers=Array.from(n.helpers)}function optimize(r){const e=r.body;return e.type===2?optimizeMessageNode(e):e.cases.forEach(i=>optimizeMessageNode(i)),r}function optimizeMessageNode(r){if(r.items.length===1){const e=r.items[0];(e.type===3||e.type===9)&&(r.static=e.value,delete e.value)}else{const e=[];for(let i=0;i<r.items.length;i++){const n=r.items[i];if(!(n.type===3||n.type===9)||n.value==null)break;e.push(n.value)}if(e.length===r.items.length){r.static=join(e);for(let i=0;i<r.items.length;i++){const n=r.items[i];(n.type===3||n.type===9)&&delete n.value}}}}function minify(r){switch(r.t=r.type,r.type){case 0:{const e=r;minify(e.body),e.b=e.body,delete e.body;break}case 1:{const e=r,i=e.cases;for(let n=0;n<i.length;n++)minify(i[n]);e.c=i,delete e.cases;break}case 2:{const e=r,i=e.items;for(let n=0;n<i.length;n++)minify(i[n]);e.i=i,delete e.items,e.static&&(e.s=e.static,delete e.static);break}case 3:case 9:case 8:case 7:{const e=r;e.value&&(e.v=e.value,delete e.value);break}case 6:{const e=r;minify(e.key),e.k=e.key,delete e.key,e.modifier&&(minify(e.modifier),e.m=e.modifier,delete e.modifier);break}case 5:{const e=r;e.i=e.index,delete e.index;break}case 4:{const e=r;e.k=e.key,delete e.key;break}}delete r.type}function createCodeGenerator(r,e){const{filename:i,breakLineCode:n,needIndent:o}=e,l=e.location!==!1,d={filename:i,code:"",column:1,line:1,offset:0,map:void 0,breakLineCode:n,needIndent:o,indentLevel:0};l&&r.loc&&(d.source=r.loc.source);const u=()=>d;function f(A,x){d.code+=A}function g(A,x=!0){const T=x?n:"";f(o?T+"  ".repeat(A):T)}function _(A=!0){const x=++d.indentLevel;A&&g(x)}function y(A=!0){const x=--d.indentLevel;A&&g(x)}function b(){g(d.indentLevel)}return{context:u,push:f,indent:_,deindent:y,newline:b,helper:A=>`_${A}`,needIndent:()=>d.needIndent}}function generateLinkedNode(r,e){const{helper:i}=r;r.push(`${i("linked")}(`),generateNode(r,e.key),e.modifier?(r.push(", "),generateNode(r,e.modifier),r.push(", _type")):r.push(", undefined, _type"),r.push(")")}function generateMessageNode(r,e){const{helper:i,needIndent:n}=r;r.push(`${i("normalize")}([`),r.indent(n());const o=e.items.length;for(let l=0;l<o&&(generateNode(r,e.items[l]),l!==o-1);l++)r.push(", ");r.deindent(n()),r.push("])")}function generatePluralNode(r,e){const{helper:i,needIndent:n}=r;if(e.cases.length>1){r.push(`${i("plural")}([`),r.indent(n());const o=e.cases.length;for(let l=0;l<o&&(generateNode(r,e.cases[l]),l!==o-1);l++)r.push(", ");r.deindent(n()),r.push("])")}}function generateResource(r,e){e.body?generateNode(r,e.body):r.push("null")}function generateNode(r,e){const{helper:i}=r;switch(e.type){case 0:generateResource(r,e);break;case 1:generatePluralNode(r,e);break;case 2:generateMessageNode(r,e);break;case 6:generateLinkedNode(r,e);break;case 8:r.push(JSON.stringify(e.value),e);break;case 7:r.push(JSON.stringify(e.value),e);break;case 5:r.push(`${i("interpolate")}(${i("list")}(${e.index}))`,e);break;case 4:r.push(`${i("interpolate")}(${i("named")}(${JSON.stringify(e.key)}))`,e);break;case 9:r.push(JSON.stringify(e.value),e);break;case 3:r.push(JSON.stringify(e.value),e);break}}const generate=(r,e={})=>{const i=isString$1(e.mode)?e.mode:"normal",n=isString$1(e.filename)?e.filename:"message.intl";e.sourceMap;const o=e.breakLineCode!=null?e.breakLineCode:i==="arrow"?";":`
`,l=e.needIndent?e.needIndent:i!=="arrow",d=r.helpers||[],u=createCodeGenerator(r,{filename:n,breakLineCode:o,needIndent:l});u.push(i==="normal"?"function __msg__ (ctx) {":"(ctx) => {"),u.indent(l),d.length>0&&(u.push(`const { ${join(d.map(_=>`${_}: _${_}`),", ")} } = ctx`),u.newline()),u.push("return "),generateNode(u,r),u.deindent(l),u.push("}"),delete r.helpers;const{code:f,map:g}=u.context();return{ast:r,code:f,map:g?g.toJSON():void 0}};function baseCompile$1(r,e={}){const i=assign$1({},e),n=!!i.jit,o=!!i.minify,l=i.optimize==null?!0:i.optimize,u=createParser(i).parse(r);return n?(l&&optimize(u),o&&minify(u),{ast:u,code:""}):(transform$9(u,i),generate(u,i))}/*!
  * core-base v11.0.0-rc.1
  * (c) 2024 kazuya kawaguchi
  * Released under the MIT License.
  */function initFeatureFlags$1(){typeof __INTLIFY_PROD_DEVTOOLS__!="boolean"&&(getGlobalThis().__INTLIFY_PROD_DEVTOOLS__=!1),typeof __INTLIFY_DROP_MESSAGE_COMPILER__!="boolean"&&(getGlobalThis().__INTLIFY_DROP_MESSAGE_COMPILER__=!1)}function format(r){return i=>formatParts(i,r)}function formatParts(r,e){const i=resolveBody(e);if(i==null)throw createUnhandleNodeError(0);if(resolveType(i)===1){const l=resolveCases(i);return r.plural(l.reduce((d,u)=>[...d,formatMessageParts(r,u)],[]))}else return formatMessageParts(r,i)}const PROPS_BODY=["b","body"];function resolveBody(r){return resolveProps(r,PROPS_BODY)}const PROPS_CASES=["c","cases"];function resolveCases(r){return resolveProps(r,PROPS_CASES,[])}function formatMessageParts(r,e){const i=resolveStatic(e);if(i!=null)return r.type==="text"?i:r.normalize([i]);{const n=resolveItems(e).reduce((o,l)=>[...o,formatMessagePart(r,l)],[]);return r.normalize(n)}}const PROPS_STATIC=["s","static"];function resolveStatic(r){return resolveProps(r,PROPS_STATIC)}const PROPS_ITEMS=["i","items"];function resolveItems(r){return resolveProps(r,PROPS_ITEMS,[])}function formatMessagePart(r,e){const i=resolveType(e);switch(i){case 3:return resolveValue$1(e,i);case 9:return resolveValue$1(e,i);case 4:{const n=e;if(hasOwn(n,"k")&&n.k)return r.interpolate(r.named(n.k));if(hasOwn(n,"key")&&n.key)return r.interpolate(r.named(n.key));throw createUnhandleNodeError(i)}case 5:{const n=e;if(hasOwn(n,"i")&&isNumber$1(n.i))return r.interpolate(r.list(n.i));if(hasOwn(n,"index")&&isNumber$1(n.index))return r.interpolate(r.list(n.index));throw createUnhandleNodeError(i)}case 6:{const n=e,o=resolveLinkedModifier(n),l=resolveLinkedKey(n);return r.linked(formatMessagePart(r,l),o?formatMessagePart(r,o):void 0,r.type)}case 7:return resolveValue$1(e,i);case 8:return resolveValue$1(e,i);default:throw new Error(`unhandled node on format message part: ${i}`)}}const PROPS_TYPE=["t","type"];function resolveType(r){return resolveProps(r,PROPS_TYPE)}const PROPS_VALUE=["v","value"];function resolveValue$1(r,e){const i=resolveProps(r,PROPS_VALUE);if(i)return i;throw createUnhandleNodeError(e)}const PROPS_MODIFIER=["m","modifier"];function resolveLinkedModifier(r){return resolveProps(r,PROPS_MODIFIER)}const PROPS_KEY=["k","key"];function resolveLinkedKey(r){const e=resolveProps(r,PROPS_KEY);if(e)return e;throw createUnhandleNodeError(6)}function resolveProps(r,e,i){for(let n=0;n<e.length;n++){const o=e[n];if(hasOwn(r,o)&&r[o]!=null)return r[o]}return i}function createUnhandleNodeError(r){return new Error(`unhandled node type: ${r}`)}const defaultOnCacheKey=r=>r;let compileCache=create$2();function isMessageAST(r){return isObject$2(r)&&resolveType(r)===0&&(hasOwn(r,"b")||hasOwn(r,"body"))}function baseCompile(r,e={}){let i=!1;const n=e.onError||defaultOnError;return e.onError=o=>{i=!0,n(o)},{...baseCompile$1(r,e),detectError:i}}function compile(r,e){if(!__INTLIFY_DROP_MESSAGE_COMPILER__&&isString$1(r)){isBoolean$1(e.warnHtmlMessage)&&e.warnHtmlMessage;const n=(e.onCacheKey||defaultOnCacheKey)(r),o=compileCache[n];if(o)return o;const{ast:l,detectError:d}=baseCompile(r,{...e,location:!1,jit:!0}),u=format(l);return d?u:compileCache[n]=u}else{const i=r.cacheKey;if(i){const n=compileCache[i];return n||(compileCache[i]=format(r))}else return format(r)}}let devtools=null;function setDevToolsHook(r){devtools=r}function initI18nDevTools(r,e,i){devtools&&devtools.emit("i18n:init",{timestamp:Date.now(),i18n:r,version:e,meta:i})}const translateDevTools=createDevToolsHook("function:translate");function createDevToolsHook(r){return e=>devtools&&devtools.emit(r,e)}const CoreErrorCodes={INVALID_ARGUMENT:COMPILE_ERROR_CODES_EXTEND_POINT,INVALID_DATE_ARGUMENT:18,INVALID_ISO_DATE_ARGUMENT:19,NOT_SUPPORT_LOCALE_PROMISE_VALUE:21,NOT_SUPPORT_LOCALE_ASYNC_FUNCTION:22,NOT_SUPPORT_LOCALE_TYPE:23},CORE_ERROR_CODES_EXTEND_POINT=24;function createCoreError(r){return createCompileError(r,null,void 0)}function getLocale(r,e){return e.locale!=null?resolveLocale(e.locale):resolveLocale(r.locale)}let _resolveLocale;function resolveLocale(r){if(isString$1(r))return r;if(isFunction$1(r)){if(r.resolvedOnce&&_resolveLocale!=null)return _resolveLocale;if(r.constructor.name==="Function"){const e=r();if(isPromise(e))throw createCoreError(CoreErrorCodes.NOT_SUPPORT_LOCALE_PROMISE_VALUE);return _resolveLocale=e}else throw createCoreError(CoreErrorCodes.NOT_SUPPORT_LOCALE_ASYNC_FUNCTION)}else throw createCoreError(CoreErrorCodes.NOT_SUPPORT_LOCALE_TYPE)}function fallbackWithSimple(r,e,i){return[...new Set([i,...isArray$2(e)?e:isObject$2(e)?Object.keys(e):isString$1(e)?[e]:[i]])]}function fallbackWithLocaleChain(r,e,i){const n=isString$1(i)?i:DEFAULT_LOCALE,o=r;o.__localeChainCache||(o.__localeChainCache=new Map);let l=o.__localeChainCache.get(n);if(!l){l=[];let d=[i];for(;isArray$2(d);)d=appendBlockToChain(l,d,e);const u=isArray$2(e)||!isPlainObject$1(e)?e:e.default?e.default:null;d=isString$1(u)?[u]:u,isArray$2(d)&&appendBlockToChain(l,d,!1),o.__localeChainCache.set(n,l)}return l}function appendBlockToChain(r,e,i){let n=!0;for(let o=0;o<e.length&&isBoolean$1(n);o++){const l=e[o];isString$1(l)&&(n=appendLocaleToChain(r,e[o],i))}return n}function appendLocaleToChain(r,e,i){let n;const o=e.split("-");do{const l=o.join("-");n=appendItemToChain(r,l,i),o.splice(-1,1)}while(o.length&&n===!0);return n}function appendItemToChain(r,e,i){let n=!1;if(!r.includes(e)&&(n=!0,e)){n=e[e.length-1]!=="!";const o=e.replace(/!/g,"");r.push(o),(isArray$2(i)||isPlainObject$1(i))&&i[o]&&(n=i[o])}return n}const pathStateMachine=[];pathStateMachine[0]={w:[0],i:[3,0],"[":[4],o:[7]};pathStateMachine[1]={w:[1],".":[2],"[":[4],o:[7]};pathStateMachine[2]={w:[2],i:[3,0],0:[3,0]};pathStateMachine[3]={i:[3,0],0:[3,0],w:[1,1],".":[2,1],"[":[4,1],o:[7,1]};pathStateMachine[4]={"'":[5,0],'"':[6,0],"[":[4,2],"]":[1,3],o:8,l:[4,0]};pathStateMachine[5]={"'":[4,0],o:8,l:[5,0]};pathStateMachine[6]={'"':[4,0],o:8,l:[6,0]};const literalValueRE=/^\s?(?:true|false|-?[\d.]+|'[^']*'|"[^"]*")\s?$/;function isLiteral(r){return literalValueRE.test(r)}function stripQuotes(r){const e=r.charCodeAt(0),i=r.charCodeAt(r.length-1);return e===i&&(e===34||e===39)?r.slice(1,-1):r}function getPathCharType(r){if(r==null)return"o";switch(r.charCodeAt(0)){case 91:case 93:case 46:case 34:case 39:return r;case 95:case 36:case 45:return"i";case 9:case 10:case 13:case 160:case 65279:case 8232:case 8233:return"w"}return"i"}function formatSubPath(r){const e=r.trim();return r.charAt(0)==="0"&&isNaN(parseInt(r))?!1:isLiteral(e)?stripQuotes(e):"*"+e}function parse$1(r){const e=[];let i=-1,n=0,o=0,l,d,u,f,g,_,y;const b=[];b[0]=()=>{d===void 0?d=u:d+=u},b[1]=()=>{d!==void 0&&(e.push(d),d=void 0)},b[2]=()=>{b[0](),o++},b[3]=()=>{if(o>0)o--,n=4,b[0]();else{if(o=0,d===void 0||(d=formatSubPath(d),d===!1))return!1;b[1]()}};function S(){const v=r[i+1];if(n===5&&v==="'"||n===6&&v==='"')return i++,u="\\"+v,b[0](),!0}for(;n!==null;)if(i++,l=r[i],!(l==="\\"&&S())){if(f=getPathCharType(l),y=pathStateMachine[n],g=y[f]||y.l||8,g===8||(n=g[0],g[1]!==void 0&&(_=b[g[1]],_&&(u=l,_()===!1))))return;if(n===7)return e}}const cache=new Map;function resolveWithKeyValue(r,e){return isObject$2(r)?r[e]:null}function resolveValue(r,e){if(!isObject$2(r))return null;let i=cache.get(e);if(i||(i=parse$1(e),i&&cache.set(e,i)),!i)return null;const n=i.length;let o=r,l=0;for(;l<n;){const d=o[i[l]];if(d===void 0||isFunction$1(o))return null;o=d,l++}return o}const VERSION$1="11.0.0-rc.1",NOT_REOSLVED=-1,DEFAULT_LOCALE="en-US",MISSING_RESOLVE_VALUE="",capitalize=r=>`${r.charAt(0).toLocaleUpperCase()}${r.substr(1)}`;function getDefaultLinkedModifiers(){return{upper:(r,e)=>e==="text"&&isString$1(r)?r.toUpperCase():e==="vnode"&&isObject$2(r)&&"__v_isVNode"in r?r.children.toUpperCase():r,lower:(r,e)=>e==="text"&&isString$1(r)?r.toLowerCase():e==="vnode"&&isObject$2(r)&&"__v_isVNode"in r?r.children.toLowerCase():r,capitalize:(r,e)=>e==="text"&&isString$1(r)?capitalize(r):e==="vnode"&&isObject$2(r)&&"__v_isVNode"in r?capitalize(r.children):r}}let _compiler;function registerMessageCompiler(r){_compiler=r}let _resolver;function registerMessageResolver(r){_resolver=r}let _fallbacker;function registerLocaleFallbacker(r){_fallbacker=r}let _additionalMeta=null;const setAdditionalMeta=r=>{_additionalMeta=r},getAdditionalMeta=()=>_additionalMeta;let _fallbackContext=null;const setFallbackContext=r=>{_fallbackContext=r},getFallbackContext=()=>_fallbackContext;let _cid=0;function createCoreContext(r={}){const e=isFunction$1(r.onWarn)?r.onWarn:warn$1,i=isString$1(r.version)?r.version:VERSION$1,n=isString$1(r.locale)||isFunction$1(r.locale)?r.locale:DEFAULT_LOCALE,o=isFunction$1(n)?DEFAULT_LOCALE:n,l=isArray$2(r.fallbackLocale)||isPlainObject$1(r.fallbackLocale)||isString$1(r.fallbackLocale)||r.fallbackLocale===!1?r.fallbackLocale:o,d=isPlainObject$1(r.messages)?r.messages:createResources(o),u=isPlainObject$1(r.datetimeFormats)?r.datetimeFormats:createResources(o),f=isPlainObject$1(r.numberFormats)?r.numberFormats:createResources(o),g=assign$1(create$2(),r.modifiers,getDefaultLinkedModifiers()),_=r.pluralRules||create$2(),y=isFunction$1(r.missing)?r.missing:null,b=isBoolean$1(r.missingWarn)||isRegExp(r.missingWarn)?r.missingWarn:!0,S=isBoolean$1(r.fallbackWarn)||isRegExp(r.fallbackWarn)?r.fallbackWarn:!0,v=!!r.fallbackFormat,A=!!r.unresolving,x=isFunction$1(r.postTranslation)?r.postTranslation:null,T=isPlainObject$1(r.processor)?r.processor:null,C=isBoolean$1(r.warnHtmlMessage)?r.warnHtmlMessage:!0,E=!!r.escapeParameter,P=isFunction$1(r.messageCompiler)?r.messageCompiler:_compiler,R=isFunction$1(r.messageResolver)?r.messageResolver:_resolver||resolveWithKeyValue,L=isFunction$1(r.localeFallbacker)?r.localeFallbacker:_fallbacker||fallbackWithSimple,w=isObject$2(r.fallbackContext)?r.fallbackContext:void 0,B=r,I=isObject$2(B.__datetimeFormatters)?B.__datetimeFormatters:new Map,D=isObject$2(B.__numberFormatters)?B.__numberFormatters:new Map,O=isObject$2(B.__meta)?B.__meta:{};_cid++;const N={version:i,cid:_cid,locale:n,fallbackLocale:l,messages:d,modifiers:g,pluralRules:_,missing:y,missingWarn:b,fallbackWarn:S,fallbackFormat:v,unresolving:A,postTranslation:x,processor:T,warnHtmlMessage:C,escapeParameter:E,messageCompiler:P,messageResolver:R,localeFallbacker:L,fallbackContext:w,onWarn:e,__meta:O};return N.datetimeFormats=u,N.numberFormats=f,N.__datetimeFormatters=I,N.__numberFormatters=D,__INTLIFY_PROD_DEVTOOLS__&&initI18nDevTools(N,i,O),N}const createResources=r=>({[r]:create$2()});function handleMissing(r,e,i,n,o){const{missing:l,onWarn:d}=r;if(l!==null){const u=l(r,i,e,o);return isString$1(u)?u:e}else return e}function updateFallbackLocale(r,e,i){const n=r;n.__localeChainCache=new Map,r.localeFallbacker(r,i,e)}function isAlmostSameLocale(r,e){return r===e?!1:r.split("-")[0]===e.split("-")[0]}function isImplicitFallback(r,e){const i=e.indexOf(r);if(i===-1)return!1;for(let n=i+1;n<e.length;n++)if(isAlmostSameLocale(r,e[n]))return!0;return!1}function datetime(r,...e){const{datetimeFormats:i,unresolving:n,fallbackLocale:o,onWarn:l,localeFallbacker:d}=r,{__datetimeFormatters:u}=r,[f,g,_,y]=parseDateTimeArgs(...e),b=isBoolean$1(_.missingWarn)?_.missingWarn:r.missingWarn;isBoolean$1(_.fallbackWarn)?_.fallbackWarn:r.fallbackWarn;const S=!!_.part,v=getLocale(r,_),A=d(r,o,v);if(!isString$1(f)||f==="")return new Intl.DateTimeFormat(v,y).format(g);let x={},T,C=null;const E="datetime format";for(let L=0;L<A.length&&(T=A[L],x=i[T]||{},C=x[f],!isPlainObject$1(C));L++)handleMissing(r,f,T,b,E);if(!isPlainObject$1(C)||!isString$1(T))return n?NOT_REOSLVED:f;let P=`${T}__${f}`;isEmptyObject(y)||(P=`${P}__${JSON.stringify(y)}`);let R=u.get(P);return R||(R=new Intl.DateTimeFormat(T,assign$1({},C,y)),u.set(P,R)),S?R.formatToParts(g):R.format(g)}const DATETIME_FORMAT_OPTIONS_KEYS=["localeMatcher","weekday","era","year","month","day","hour","minute","second","timeZoneName","formatMatcher","hour12","timeZone","dateStyle","timeStyle","calendar","dayPeriod","numberingSystem","hourCycle","fractionalSecondDigits"];function parseDateTimeArgs(...r){const[e,i,n,o]=r,l=create$2();let d=create$2(),u;if(isString$1(e)){const f=e.match(/(\d{4}-\d{2}-\d{2})(T|\s)?(.*)/);if(!f)throw createCoreError(CoreErrorCodes.INVALID_ISO_DATE_ARGUMENT);const g=f[3]?f[3].trim().startsWith("T")?`${f[1].trim()}${f[3].trim()}`:`${f[1].trim()}T${f[3].trim()}`:f[1].trim();u=new Date(g);try{u.toISOString()}catch{throw createCoreError(CoreErrorCodes.INVALID_ISO_DATE_ARGUMENT)}}else if(isDate$1(e)){if(isNaN(e.getTime()))throw createCoreError(CoreErrorCodes.INVALID_DATE_ARGUMENT);u=e}else if(isNumber$1(e))u=e;else throw createCoreError(CoreErrorCodes.INVALID_ARGUMENT);return isString$1(i)?l.key=i:isPlainObject$1(i)&&Object.keys(i).forEach(f=>{DATETIME_FORMAT_OPTIONS_KEYS.includes(f)?d[f]=i[f]:l[f]=i[f]}),isString$1(n)?l.locale=n:isPlainObject$1(n)&&(d=n),isPlainObject$1(o)&&(d=o),[l.key||"",u,l,d]}function clearDateTimeFormat(r,e,i){const n=r;for(const o in i){const l=`${e}__${o}`;n.__datetimeFormatters.has(l)&&n.__datetimeFormatters.delete(l)}}function number(r,...e){const{numberFormats:i,unresolving:n,fallbackLocale:o,onWarn:l,localeFallbacker:d}=r,{__numberFormatters:u}=r,[f,g,_,y]=parseNumberArgs(...e),b=isBoolean$1(_.missingWarn)?_.missingWarn:r.missingWarn;isBoolean$1(_.fallbackWarn)?_.fallbackWarn:r.fallbackWarn;const S=!!_.part,v=getLocale(r,_),A=d(r,o,v);if(!isString$1(f)||f==="")return new Intl.NumberFormat(v,y).format(g);let x={},T,C=null;const E="number format";for(let L=0;L<A.length&&(T=A[L],x=i[T]||{},C=x[f],!isPlainObject$1(C));L++)handleMissing(r,f,T,b,E);if(!isPlainObject$1(C)||!isString$1(T))return n?NOT_REOSLVED:f;let P=`${T}__${f}`;isEmptyObject(y)||(P=`${P}__${JSON.stringify(y)}`);let R=u.get(P);return R||(R=new Intl.NumberFormat(T,assign$1({},C,y)),u.set(P,R)),S?R.formatToParts(g):R.format(g)}const NUMBER_FORMAT_OPTIONS_KEYS=["localeMatcher","style","currency","currencyDisplay","currencySign","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits","compactDisplay","notation","signDisplay","unit","unitDisplay","roundingMode","roundingPriority","roundingIncrement","trailingZeroDisplay"];function parseNumberArgs(...r){const[e,i,n,o]=r,l=create$2();let d=create$2();if(!isNumber$1(e))throw createCoreError(CoreErrorCodes.INVALID_ARGUMENT);const u=e;return isString$1(i)?l.key=i:isPlainObject$1(i)&&Object.keys(i).forEach(f=>{NUMBER_FORMAT_OPTIONS_KEYS.includes(f)?d[f]=i[f]:l[f]=i[f]}),isString$1(n)?l.locale=n:isPlainObject$1(n)&&(d=n),isPlainObject$1(o)&&(d=o),[l.key||"",u,l,d]}function clearNumberFormat(r,e,i){const n=r;for(const o in i){const l=`${e}__${o}`;n.__numberFormatters.has(l)&&n.__numberFormatters.delete(l)}}const DEFAULT_MODIFIER=r=>r,DEFAULT_MESSAGE=r=>"",DEFAULT_MESSAGE_DATA_TYPE="text",DEFAULT_NORMALIZE=r=>r.length===0?"":join(r),DEFAULT_INTERPOLATE=toDisplayString;function pluralDefault(r,e){return r=Math.abs(r),e===2?r?r>1?1:0:1:r?Math.min(r,2):0}function getPluralIndex(r){const e=isNumber$1(r.pluralIndex)?r.pluralIndex:-1;return r.named&&(isNumber$1(r.named.count)||isNumber$1(r.named.n))?isNumber$1(r.named.count)?r.named.count:isNumber$1(r.named.n)?r.named.n:e:e}function normalizeNamed(r,e){e.count||(e.count=r),e.n||(e.n=r)}function createMessageContext(r={}){const e=r.locale,i=getPluralIndex(r),n=isObject$2(r.pluralRules)&&isString$1(e)&&isFunction$1(r.pluralRules[e])?r.pluralRules[e]:pluralDefault,o=isObject$2(r.pluralRules)&&isString$1(e)&&isFunction$1(r.pluralRules[e])?pluralDefault:void 0,l=T=>T[n(i,T.length,o)],d=r.list||[],u=T=>d[T],f=r.named||create$2();isNumber$1(r.pluralIndex)&&normalizeNamed(i,f);const g=T=>f[T];function _(T,C){const E=isFunction$1(r.messages)?r.messages(T,!!C):isObject$2(r.messages)?r.messages[T]:!1;return E||(r.parent?r.parent.message(T):DEFAULT_MESSAGE)}const y=T=>r.modifiers?r.modifiers[T]:DEFAULT_MODIFIER,b=isPlainObject$1(r.processor)&&isFunction$1(r.processor.normalize)?r.processor.normalize:DEFAULT_NORMALIZE,S=isPlainObject$1(r.processor)&&isFunction$1(r.processor.interpolate)?r.processor.interpolate:DEFAULT_INTERPOLATE,v=isPlainObject$1(r.processor)&&isString$1(r.processor.type)?r.processor.type:DEFAULT_MESSAGE_DATA_TYPE,x={list:u,named:g,plural:l,linked:(T,...C)=>{const[E,P]=C;let R="text",L="";C.length===1?isObject$2(E)?(L=E.modifier||L,R=E.type||R):isString$1(E)&&(L=E||L):C.length===2&&(isString$1(E)&&(L=E||L),isString$1(P)&&(R=P||R));const w=_(T,!0)(x),B=R==="vnode"&&isArray$2(w)&&L?w[0]:w;return L?y(L)(B,R):B},message:_,type:v,interpolate:S,normalize:b,values:assign$1(create$2(),d,f)};return x}const NOOP_MESSAGE_FUNCTION=()=>"",isMessageFunction=r=>isFunction$1(r);function translate$1(r,...e){const{fallbackFormat:i,postTranslation:n,unresolving:o,messageCompiler:l,fallbackLocale:d,messages:u}=r,[f,g]=parseTranslateArgs(...e),_=isBoolean$1(g.missingWarn)?g.missingWarn:r.missingWarn,y=isBoolean$1(g.fallbackWarn)?g.fallbackWarn:r.fallbackWarn,b=isBoolean$1(g.escapeParameter)?g.escapeParameter:r.escapeParameter,S=!!g.resolvedMessage,v=isString$1(g.default)||isBoolean$1(g.default)?isBoolean$1(g.default)?l?f:()=>f:g.default:i?l?f:()=>f:null,A=i||v!=null&&(isString$1(v)||isFunction$1(v)),x=getLocale(r,g);b&&escapeParams(g);let[T,C,E]=S?[f,x,u[x]||create$2()]:resolveMessageFormat(r,f,x,d,y,_),P=T,R=f;if(!S&&!(isString$1(P)||isMessageAST(P)||isMessageFunction(P))&&A&&(P=v,R=P),!S&&(!(isString$1(P)||isMessageAST(P)||isMessageFunction(P))||!isString$1(C)))return o?NOT_REOSLVED:f;let L=!1;const w=()=>{L=!0},B=isMessageFunction(P)?P:compileMessageFormat(r,f,C,P,R,w);if(L)return P;const I=getMessageContextOptions(r,C,E,g),D=createMessageContext(I),O=evaluateMessage(r,B,D),N=n?n(O,f):O;if(__INTLIFY_PROD_DEVTOOLS__){const V={timestamp:Date.now(),key:isString$1(f)?f:isMessageFunction(P)?P.key:"",locale:C||(isMessageFunction(P)?P.locale:""),format:isString$1(P)?P:isMessageFunction(P)?P.source:"",message:N};V.meta=assign$1({},r.__meta,getAdditionalMeta()||{}),translateDevTools(V)}return N}function escapeParams(r){isArray$2(r.list)?r.list=r.list.map(e=>isString$1(e)?escapeHtml(e):e):isObject$2(r.named)&&Object.keys(r.named).forEach(e=>{isString$1(r.named[e])&&(r.named[e]=escapeHtml(r.named[e]))})}function resolveMessageFormat(r,e,i,n,o,l){const{messages:d,onWarn:u,messageResolver:f,localeFallbacker:g}=r,_=g(r,n,i);let y=create$2(),b,S=null;const v="translate";for(let A=0;A<_.length&&(b=_[A],y=d[b]||create$2(),(S=f(y,e))===null&&(S=y[e]),!(isString$1(S)||isMessageAST(S)||isMessageFunction(S)));A++)if(!isImplicitFallback(b,_)){const x=handleMissing(r,e,b,l,v);x!==e&&(S=x)}return[S,b,y]}function compileMessageFormat(r,e,i,n,o,l){const{messageCompiler:d,warnHtmlMessage:u}=r;if(isMessageFunction(n)){const g=n;return g.locale=g.locale||i,g.key=g.key||e,g}if(d==null){const g=()=>n;return g.locale=i,g.key=e,g}const f=d(n,getCompileContext(r,i,o,n,u,l));return f.locale=i,f.key=e,f.source=n,f}function evaluateMessage(r,e,i){return e(i)}function parseTranslateArgs(...r){const[e,i,n]=r,o=create$2();if(!isString$1(e)&&!isNumber$1(e)&&!isMessageFunction(e)&&!isMessageAST(e))throw createCoreError(CoreErrorCodes.INVALID_ARGUMENT);const l=isNumber$1(e)?String(e):(isMessageFunction(e),e);return isNumber$1(i)?o.plural=i:isString$1(i)?o.default=i:isPlainObject$1(i)&&!isEmptyObject(i)?o.named=i:isArray$2(i)&&(o.list=i),isNumber$1(n)?o.plural=n:isString$1(n)?o.default=n:isPlainObject$1(n)&&assign$1(o,n),[l,o]}function getCompileContext(r,e,i,n,o,l){return{locale:e,key:i,warnHtmlMessage:o,onError:d=>{throw l&&l(d),d},onCacheKey:d=>generateFormatCacheKey(e,i,d)}}function getMessageContextOptions(r,e,i,n){const{modifiers:o,pluralRules:l,messageResolver:d,fallbackLocale:u,fallbackWarn:f,missingWarn:g,fallbackContext:_}=r,b={locale:e,modifiers:o,pluralRules:l,messages:(S,v)=>{let A=d(i,S);if(A==null&&(_||v)){const[,,x]=resolveMessageFormat(_||r,S,e,u,f,g);A=d(x,S)}if(isString$1(A)||isMessageAST(A)){let x=!1;const C=compileMessageFormat(r,S,e,A,S,()=>{x=!0});return x?NOOP_MESSAGE_FUNCTION:C}else return isMessageFunction(A)?A:NOOP_MESSAGE_FUNCTION}};return r.processor&&(b.processor=r.processor),n.list&&(b.list=n.list),n.named&&(b.named=n.named),isNumber$1(n.plural)&&(b.pluralIndex=n.plural),b}initFeatureFlags$1();/*!
  * vue-i18n v11.0.0-rc.1
  * (c) 2024 kazuya kawaguchi
  * Released under the MIT License.
  */const VERSION="11.0.0-rc.1";function initFeatureFlags(){typeof __VUE_I18N_FULL_INSTALL__!="boolean"&&(getGlobalThis().__VUE_I18N_FULL_INSTALL__=!0),typeof __VUE_I18N_LEGACY_API__!="boolean"&&(getGlobalThis().__VUE_I18N_LEGACY_API__=!0),typeof __INTLIFY_DROP_MESSAGE_COMPILER__!="boolean"&&(getGlobalThis().__INTLIFY_DROP_MESSAGE_COMPILER__=!1),typeof __INTLIFY_PROD_DEVTOOLS__!="boolean"&&(getGlobalThis().__INTLIFY_PROD_DEVTOOLS__=!1)}const I18nErrorCodes={UNEXPECTED_RETURN_TYPE:CORE_ERROR_CODES_EXTEND_POINT,INVALID_ARGUMENT:25,MUST_BE_CALL_SETUP_TOP:26,NOT_INSTALLED:27,REQUIRED_VALUE:28,INVALID_VALUE:29,NOT_INSTALLED_WITH_PROVIDE:31,UNEXPECTED_ERROR:32};function createI18nError(r,...e){return createCompileError(r,null,void 0)}const TranslateVNodeSymbol=makeSymbol("__translateVNode"),DatetimePartsSymbol=makeSymbol("__datetimeParts"),NumberPartsSymbol=makeSymbol("__numberParts"),SetPluralRulesSymbol=makeSymbol("__setPluralRules"),InejctWithOptionSymbol=makeSymbol("__injectWithOption"),DisposeSymbol=makeSymbol("__dispose");function handleFlatJson(r){if(!isObject$2(r))return r;for(const e in r)if(hasOwn(r,e))if(!e.includes("."))isObject$2(r[e])&&handleFlatJson(r[e]);else{const i=e.split("."),n=i.length-1;let o=r,l=!1;for(let d=0;d<n;d++){if(i[d]in o||(o[i[d]]=create$2()),!isObject$2(o[i[d]])){l=!0;break}o=o[i[d]]}l||(o[i[n]]=r[e],delete r[e]),isObject$2(o[i[n]])&&handleFlatJson(o[i[n]])}return r}function getLocaleMessages(r,e){const{messages:i,__i18n:n,messageResolver:o,flatJson:l}=e,d=isPlainObject$1(i)?i:isArray$2(n)?create$2():{[r]:create$2()};if(isArray$2(n)&&n.forEach(u=>{if("locale"in u&&"resource"in u){const{locale:f,resource:g}=u;f?(d[f]=d[f]||create$2(),deepCopy(g,d[f])):deepCopy(g,d)}else isString$1(u)&&deepCopy(JSON.parse(u),d)}),o==null&&l)for(const u in d)hasOwn(d,u)&&handleFlatJson(d[u]);return d}function getComponentOptions(r){return r.type}function adjustI18nResources(r,e,i){let n=isObject$2(e.messages)?e.messages:create$2();"__i18nGlobal"in i&&(n=getLocaleMessages(r.locale.value,{messages:n,__i18n:i.__i18nGlobal}));const o=Object.keys(n);o.length&&o.forEach(l=>{r.mergeLocaleMessage(l,n[l])});{if(isObject$2(e.datetimeFormats)){const l=Object.keys(e.datetimeFormats);l.length&&l.forEach(d=>{r.mergeDateTimeFormat(d,e.datetimeFormats[d])})}if(isObject$2(e.numberFormats)){const l=Object.keys(e.numberFormats);l.length&&l.forEach(d=>{r.mergeNumberFormat(d,e.numberFormats[d])})}}}function createTextNode(r){return createVNode(Text$2,null,r,0)}const DEVTOOLS_META="__INTLIFY_META__",NOOP_RETURN_ARRAY=()=>[],NOOP_RETURN_FALSE=()=>!1;let composerID=0;function defineCoreMissingHandler(r){return(e,i,n,o)=>r(i,n,getCurrentInstance()||void 0,o)}const getMetaInfo=()=>{const r=getCurrentInstance();let e=null;return r&&(e=getComponentOptions(r)[DEVTOOLS_META])?{[DEVTOOLS_META]:e}:null};function createComposer(r={}){const{__root:e,__injectWithOption:i}=r,n=e===void 0,o=r.flatJson,l=inBrowser?ref:shallowRef;let d=isBoolean$1(r.inheritLocale)?r.inheritLocale:!0;const u=l(e&&d?e.locale.value:isString$1(r.locale)?r.locale:DEFAULT_LOCALE),f=l(e&&d?e.fallbackLocale.value:isString$1(r.fallbackLocale)||isArray$2(r.fallbackLocale)||isPlainObject$1(r.fallbackLocale)||r.fallbackLocale===!1?r.fallbackLocale:u.value),g=l(getLocaleMessages(u.value,r)),_=l(isPlainObject$1(r.datetimeFormats)?r.datetimeFormats:{[u.value]:{}}),y=l(isPlainObject$1(r.numberFormats)?r.numberFormats:{[u.value]:{}});let b=e?e.missingWarn:isBoolean$1(r.missingWarn)||isRegExp(r.missingWarn)?r.missingWarn:!0,S=e?e.fallbackWarn:isBoolean$1(r.fallbackWarn)||isRegExp(r.fallbackWarn)?r.fallbackWarn:!0,v=e?e.fallbackRoot:isBoolean$1(r.fallbackRoot)?r.fallbackRoot:!0,A=!!r.fallbackFormat,x=isFunction$1(r.missing)?r.missing:null,T=isFunction$1(r.missing)?defineCoreMissingHandler(r.missing):null,C=isFunction$1(r.postTranslation)?r.postTranslation:null,E=e?e.warnHtmlMessage:isBoolean$1(r.warnHtmlMessage)?r.warnHtmlMessage:!0,P=!!r.escapeParameter;const R=e?e.modifiers:isPlainObject$1(r.modifiers)?r.modifiers:{};let L=r.pluralRules||e&&e.pluralRules,w;w=(()=>{n&&setFallbackContext(null);const Z={version:VERSION,locale:u.value,fallbackLocale:f.value,messages:g.value,modifiers:R,pluralRules:L,missing:T===null?void 0:T,missingWarn:b,fallbackWarn:S,fallbackFormat:A,unresolving:!0,postTranslation:C===null?void 0:C,warnHtmlMessage:E,escapeParameter:P,messageResolver:r.messageResolver,messageCompiler:r.messageCompiler,__meta:{framework:"vue"}};Z.datetimeFormats=_.value,Z.numberFormats=y.value,Z.__datetimeFormatters=isPlainObject$1(w)?w.__datetimeFormatters:void 0,Z.__numberFormatters=isPlainObject$1(w)?w.__numberFormatters:void 0;const oe=createCoreContext(Z);return n&&setFallbackContext(oe),oe})(),updateFallbackLocale(w,u.value,f.value);function I(){return[u.value,f.value,g.value,_.value,y.value]}const D=computed({get:()=>u.value,set:Z=>{u.value=Z,w.locale=u.value}}),O=computed({get:()=>f.value,set:Z=>{f.value=Z,w.fallbackLocale=f.value,updateFallbackLocale(w,u.value,Z)}}),N=computed(()=>g.value),V=computed(()=>_.value),H=computed(()=>y.value);function F(){return isFunction$1(C)?C:null}function $(Z){C=Z,w.postTranslation=Z}function G(){return x}function Y(Z){Z!==null&&(T=defineCoreMissingHandler(Z)),x=Z,w.missing=T}const Q=(Z,oe,_e,ye,Se,Ae)=>{I();let ve;try{__INTLIFY_PROD_DEVTOOLS__,n||(w.fallbackContext=e?getFallbackContext():void 0),ve=Z(w)}finally{__INTLIFY_PROD_DEVTOOLS__,n||(w.fallbackContext=void 0)}if(_e!=="translate exists"&&isNumber$1(ve)&&ve===NOT_REOSLVED||_e==="translate exists"&&!ve){const[xe,Te]=oe();return e&&v?ye(e):Se(xe)}else{if(Ae(ve))return ve;throw createI18nError(I18nErrorCodes.UNEXPECTED_RETURN_TYPE)}};function q(...Z){return Q(oe=>Reflect.apply(translate$1,null,[oe,...Z]),()=>parseTranslateArgs(...Z),"translate",oe=>Reflect.apply(oe.t,oe,[...Z]),oe=>oe,oe=>isString$1(oe))}function te(...Z){const[oe,_e,ye]=Z;if(ye&&!isObject$2(ye))throw createI18nError(I18nErrorCodes.INVALID_ARGUMENT);return q(oe,_e,assign$1({resolvedMessage:!0},ye||{}))}function ue(...Z){return Q(oe=>Reflect.apply(datetime,null,[oe,...Z]),()=>parseDateTimeArgs(...Z),"datetime format",oe=>Reflect.apply(oe.d,oe,[...Z]),()=>MISSING_RESOLVE_VALUE,oe=>isString$1(oe))}function he(...Z){return Q(oe=>Reflect.apply(number,null,[oe,...Z]),()=>parseNumberArgs(...Z),"number format",oe=>Reflect.apply(oe.n,oe,[...Z]),()=>MISSING_RESOLVE_VALUE,oe=>isString$1(oe))}function fe(Z){return Z.map(oe=>isString$1(oe)||isNumber$1(oe)||isBoolean$1(oe)?createTextNode(String(oe)):oe)}const me={normalize:fe,interpolate:Z=>Z,type:"vnode"};function ee(...Z){return Q(oe=>{let _e;const ye=oe;try{ye.processor=me,_e=Reflect.apply(translate$1,null,[ye,...Z])}finally{ye.processor=null}return _e},()=>parseTranslateArgs(...Z),"translate",oe=>oe[TranslateVNodeSymbol](...Z),oe=>[createTextNode(oe)],oe=>isArray$2(oe))}function J(...Z){return Q(oe=>Reflect.apply(number,null,[oe,...Z]),()=>parseNumberArgs(...Z),"number format",oe=>oe[NumberPartsSymbol](...Z),NOOP_RETURN_ARRAY,oe=>isString$1(oe)||isArray$2(oe))}function ie(...Z){return Q(oe=>Reflect.apply(datetime,null,[oe,...Z]),()=>parseDateTimeArgs(...Z),"datetime format",oe=>oe[DatetimePartsSymbol](...Z),NOOP_RETURN_ARRAY,oe=>isString$1(oe)||isArray$2(oe))}function le(Z){L=Z,w.pluralRules=L}function ce(Z,oe){return Q(()=>{if(!Z)return!1;const _e=isString$1(oe)?oe:u.value,ye=K(_e),Se=w.messageResolver(ye,Z);return isMessageAST(Se)||isMessageFunction(Se)||isString$1(Se)},()=>[Z],"translate exists",_e=>Reflect.apply(_e.te,_e,[Z,oe]),NOOP_RETURN_FALSE,_e=>isBoolean$1(_e))}function j(Z){let oe=null;const _e=fallbackWithLocaleChain(w,f.value,u.value);for(let ye=0;ye<_e.length;ye++){const Se=g.value[_e[ye]]||{},Ae=w.messageResolver(Se,Z);if(Ae!=null){oe=Ae;break}}return oe}function W(Z){const oe=j(Z);return oe??(e?e.tm(Z)||{}:{})}function K(Z){return g.value[Z]||{}}function ne(Z,oe){if(o){const _e={[Z]:oe};for(const ye in _e)hasOwn(_e,ye)&&handleFlatJson(_e[ye]);oe=_e[Z]}g.value[Z]=oe,w.messages=g.value}function re(Z,oe){g.value[Z]=g.value[Z]||{};const _e={[Z]:oe};if(o)for(const ye in _e)hasOwn(_e,ye)&&handleFlatJson(_e[ye]);oe=_e[Z],deepCopy(oe,g.value[Z]),w.messages=g.value}function ae(Z){return _.value[Z]||{}}function z(Z,oe){_.value[Z]=oe,w.datetimeFormats=_.value,clearDateTimeFormat(w,Z,oe)}function U(Z,oe){_.value[Z]=assign$1(_.value[Z]||{},oe),w.datetimeFormats=_.value,clearDateTimeFormat(w,Z,oe)}function X(Z){return y.value[Z]||{}}function se(Z,oe){y.value[Z]=oe,w.numberFormats=y.value,clearNumberFormat(w,Z,oe)}function ge(Z,oe){y.value[Z]=assign$1(y.value[Z]||{},oe),w.numberFormats=y.value,clearNumberFormat(w,Z,oe)}composerID++,e&&inBrowser&&(watch(e.locale,Z=>{d&&(u.value=Z,w.locale=Z,updateFallbackLocale(w,u.value,f.value))}),watch(e.fallbackLocale,Z=>{d&&(f.value=Z,w.fallbackLocale=Z,updateFallbackLocale(w,u.value,f.value))}));const de={id:composerID,locale:D,fallbackLocale:O,get inheritLocale(){return d},set inheritLocale(Z){d=Z,Z&&e&&(u.value=e.locale.value,f.value=e.fallbackLocale.value,updateFallbackLocale(w,u.value,f.value))},get availableLocales(){return Object.keys(g.value).sort()},messages:N,get modifiers(){return R},get pluralRules(){return L||{}},get isGlobal(){return n},get missingWarn(){return b},set missingWarn(Z){b=Z,w.missingWarn=b},get fallbackWarn(){return S},set fallbackWarn(Z){S=Z,w.fallbackWarn=S},get fallbackRoot(){return v},set fallbackRoot(Z){v=Z},get fallbackFormat(){return A},set fallbackFormat(Z){A=Z,w.fallbackFormat=A},get warnHtmlMessage(){return E},set warnHtmlMessage(Z){E=Z,w.warnHtmlMessage=Z},get escapeParameter(){return P},set escapeParameter(Z){P=Z,w.escapeParameter=Z},t:q,getLocaleMessage:K,setLocaleMessage:ne,mergeLocaleMessage:re,getPostTranslationHandler:F,setPostTranslationHandler:$,getMissingHandler:G,setMissingHandler:Y,[SetPluralRulesSymbol]:le};return de.datetimeFormats=V,de.numberFormats=H,de.rt=te,de.te=ce,de.tm=W,de.d=ue,de.n=he,de.getDateTimeFormat=ae,de.setDateTimeFormat=z,de.mergeDateTimeFormat=U,de.getNumberFormat=X,de.setNumberFormat=se,de.mergeNumberFormat=ge,de[InejctWithOptionSymbol]=i,de[TranslateVNodeSymbol]=ee,de[DatetimePartsSymbol]=ie,de[NumberPartsSymbol]=J,de}function convertComposerOptions(r){const e=isString$1(r.locale)?r.locale:DEFAULT_LOCALE,i=isString$1(r.fallbackLocale)||isArray$2(r.fallbackLocale)||isPlainObject$1(r.fallbackLocale)||r.fallbackLocale===!1?r.fallbackLocale:e,n=isFunction$1(r.missing)?r.missing:void 0,o=isBoolean$1(r.silentTranslationWarn)||isRegExp(r.silentTranslationWarn)?!r.silentTranslationWarn:!0,l=isBoolean$1(r.silentFallbackWarn)||isRegExp(r.silentFallbackWarn)?!r.silentFallbackWarn:!0,d=isBoolean$1(r.fallbackRoot)?r.fallbackRoot:!0,u=!!r.formatFallbackMessages,f=isPlainObject$1(r.modifiers)?r.modifiers:{},g=r.pluralizationRules,_=isFunction$1(r.postTranslation)?r.postTranslation:void 0,y=isString$1(r.warnHtmlInMessage)?r.warnHtmlInMessage!=="off":!0,b=!!r.escapeParameterHtml,S=isBoolean$1(r.sync)?r.sync:!0;let v=r.messages;if(isPlainObject$1(r.sharedMessages)){const R=r.sharedMessages;v=Object.keys(R).reduce((w,B)=>{const I=w[B]||(w[B]={});return assign$1(I,R[B]),w},v||{})}const{__i18n:A,__root:x,__injectWithOption:T}=r,C=r.datetimeFormats,E=r.numberFormats,P=r.flatJson;return{locale:e,fallbackLocale:i,messages:v,flatJson:P,datetimeFormats:C,numberFormats:E,missing:n,missingWarn:o,fallbackWarn:l,fallbackRoot:d,fallbackFormat:u,modifiers:f,pluralRules:g,postTranslation:_,warnHtmlMessage:y,escapeParameter:b,messageResolver:r.messageResolver,inheritLocale:S,__i18n:A,__root:x,__injectWithOption:T}}function createVueI18n(r={}){const e=createComposer(convertComposerOptions(r)),{__extender:i}=r,n={id:e.id,get locale(){return e.locale.value},set locale(o){e.locale.value=o},get fallbackLocale(){return e.fallbackLocale.value},set fallbackLocale(o){e.fallbackLocale.value=o},get messages(){return e.messages.value},get datetimeFormats(){return e.datetimeFormats.value},get numberFormats(){return e.numberFormats.value},get availableLocales(){return e.availableLocales},get missing(){return e.getMissingHandler()},set missing(o){e.setMissingHandler(o)},get silentTranslationWarn(){return isBoolean$1(e.missingWarn)?!e.missingWarn:e.missingWarn},set silentTranslationWarn(o){e.missingWarn=isBoolean$1(o)?!o:o},get silentFallbackWarn(){return isBoolean$1(e.fallbackWarn)?!e.fallbackWarn:e.fallbackWarn},set silentFallbackWarn(o){e.fallbackWarn=isBoolean$1(o)?!o:o},get modifiers(){return e.modifiers},get formatFallbackMessages(){return e.fallbackFormat},set formatFallbackMessages(o){e.fallbackFormat=o},get postTranslation(){return e.getPostTranslationHandler()},set postTranslation(o){e.setPostTranslationHandler(o)},get sync(){return e.inheritLocale},set sync(o){e.inheritLocale=o},get warnHtmlInMessage(){return e.warnHtmlMessage?"warn":"off"},set warnHtmlInMessage(o){e.warnHtmlMessage=o!=="off"},get escapeParameterHtml(){return e.escapeParameter},set escapeParameterHtml(o){e.escapeParameter=o},get pluralizationRules(){return e.pluralRules||{}},__composer:e,t(...o){return Reflect.apply(e.t,e,[...o])},rt(...o){return Reflect.apply(e.rt,e,[...o])},te(o,l){return e.te(o,l)},tm(o){return e.tm(o)},getLocaleMessage(o){return e.getLocaleMessage(o)},setLocaleMessage(o,l){e.setLocaleMessage(o,l)},mergeLocaleMessage(o,l){e.mergeLocaleMessage(o,l)},d(...o){return Reflect.apply(e.d,e,[...o])},getDateTimeFormat(o){return e.getDateTimeFormat(o)},setDateTimeFormat(o,l){e.setDateTimeFormat(o,l)},mergeDateTimeFormat(o,l){e.mergeDateTimeFormat(o,l)},n(...o){return Reflect.apply(e.n,e,[...o])},getNumberFormat(o){return e.getNumberFormat(o)},setNumberFormat(o,l){e.setNumberFormat(o,l)},mergeNumberFormat(o,l){e.mergeNumberFormat(o,l)}};return n.__extender=i,n}function defineMixin(r,e,i){return{beforeCreate(){const n=getCurrentInstance();if(!n)throw createI18nError(I18nErrorCodes.UNEXPECTED_ERROR);const o=this.$options;if(o.i18n){const l=o.i18n;if(o.__i18n&&(l.__i18n=o.__i18n),l.__root=e,this===this.$root)this.$i18n=mergeToGlobal(r,l);else{l.__injectWithOption=!0,l.__extender=i.__vueI18nExtend,this.$i18n=createVueI18n(l);const d=this.$i18n;d.__extender&&(d.__disposer=d.__extender(this.$i18n))}}else if(o.__i18n)if(this===this.$root)this.$i18n=mergeToGlobal(r,o);else{this.$i18n=createVueI18n({__i18n:o.__i18n,__injectWithOption:!0,__extender:i.__vueI18nExtend,__root:e});const l=this.$i18n;l.__extender&&(l.__disposer=l.__extender(this.$i18n))}else this.$i18n=r;o.__i18nGlobal&&adjustI18nResources(e,o,o),this.$t=(...l)=>this.$i18n.t(...l),this.$rt=(...l)=>this.$i18n.rt(...l),this.$te=(l,d)=>this.$i18n.te(l,d),this.$d=(...l)=>this.$i18n.d(...l),this.$n=(...l)=>this.$i18n.n(...l),this.$tm=l=>this.$i18n.tm(l),i.__setInstance(n,this.$i18n)},mounted(){},unmounted(){const n=getCurrentInstance();if(!n)throw createI18nError(I18nErrorCodes.UNEXPECTED_ERROR);const o=this.$i18n;delete this.$t,delete this.$rt,delete this.$te,delete this.$d,delete this.$n,delete this.$tm,o.__disposer&&(o.__disposer(),delete o.__disposer,delete o.__extender),i.__deleteInstance(n),delete this.$i18n}}}function mergeToGlobal(r,e){r.locale=e.locale||r.locale,r.fallbackLocale=e.fallbackLocale||r.fallbackLocale,r.missing=e.missing||r.missing,r.silentTranslationWarn=e.silentTranslationWarn||r.silentFallbackWarn,r.silentFallbackWarn=e.silentFallbackWarn||r.silentFallbackWarn,r.formatFallbackMessages=e.formatFallbackMessages||r.formatFallbackMessages,r.postTranslation=e.postTranslation||r.postTranslation,r.warnHtmlInMessage=e.warnHtmlInMessage||r.warnHtmlInMessage,r.escapeParameterHtml=e.escapeParameterHtml||r.escapeParameterHtml,r.sync=e.sync||r.sync,r.__composer[SetPluralRulesSymbol](e.pluralizationRules||r.pluralizationRules);const i=getLocaleMessages(r.locale,{messages:e.messages,__i18n:e.__i18n});return Object.keys(i).forEach(n=>r.mergeLocaleMessage(n,i[n])),e.datetimeFormats&&Object.keys(e.datetimeFormats).forEach(n=>r.mergeDateTimeFormat(n,e.datetimeFormats[n])),e.numberFormats&&Object.keys(e.numberFormats).forEach(n=>r.mergeNumberFormat(n,e.numberFormats[n])),r}const baseFormatProps={tag:{type:[String,Object]},locale:{type:String},scope:{type:String,validator:r=>r==="parent"||r==="global",default:"parent"},i18n:{type:Object}};function getInterpolateArg({slots:r},e){return e.length===1&&e[0]==="default"?(r.default?r.default():[]).reduce((n,o)=>[...n,...o.type===Fragment?o.children:[o]],[]):e.reduce((i,n)=>{const o=r[n];return o&&(i[n]=o()),i},create$2())}function getFragmentableTag(){return Fragment}const TranslationImpl=defineComponent({name:"i18n-t",props:assign$1({keypath:{type:String,required:!0},plural:{type:[Number,String],validator:r=>isNumber$1(r)||!isNaN(r)}},baseFormatProps),setup(r,e){const{slots:i,attrs:n}=e,o=r.i18n||useI18n({useScope:r.scope,__useComponent:!0});return()=>{const l=Object.keys(i).filter(y=>y!=="_"),d=create$2();r.locale&&(d.locale=r.locale),r.plural!==void 0&&(d.plural=isString$1(r.plural)?+r.plural:r.plural);const u=getInterpolateArg(e,l),f=o[TranslateVNodeSymbol](r.keypath,u,d),g=assign$1(create$2(),n),_=isString$1(r.tag)||isObject$2(r.tag)?r.tag:getFragmentableTag();return h(_,g,f)}}}),Translation=TranslationImpl;function isVNode(r){return isArray$2(r)&&!isString$1(r[0])}function renderFormatter(r,e,i,n){const{slots:o,attrs:l}=e;return()=>{const d={part:!0};let u=create$2();r.locale&&(d.locale=r.locale),isString$1(r.format)?d.key=r.format:isObject$2(r.format)&&(isString$1(r.format.key)&&(d.key=r.format.key),u=Object.keys(r.format).reduce((b,S)=>i.includes(S)?assign$1(create$2(),b,{[S]:r.format[S]}):b,create$2()));const f=n(r.value,d,u);let g=[d.key];isArray$2(f)?g=f.map((b,S)=>{const v=o[b.type],A=v?v({[b.type]:b.value,index:S,parts:f}):[b.value];return isVNode(A)&&(A[0].key=`${b.type}-${S}`),A}):isString$1(f)&&(g=[f]);const _=assign$1(create$2(),l),y=isString$1(r.tag)||isObject$2(r.tag)?r.tag:getFragmentableTag();return h(y,_,g)}}const NumberFormatImpl=defineComponent({name:"i18n-n",props:assign$1({value:{type:Number,required:!0},format:{type:[String,Object]}},baseFormatProps),setup(r,e){const i=r.i18n||useI18n({useScope:r.scope,__useComponent:!0});return renderFormatter(r,e,NUMBER_FORMAT_OPTIONS_KEYS,(...n)=>i[NumberPartsSymbol](...n))}}),NumberFormat=NumberFormatImpl;function getComposer$1(r,e){const i=r;if(r.mode==="composition")return i.__getInstance(e)||r.global;{const n=i.__getInstance(e);return n!=null?n.__composer:r.global.__composer}}function vTDirective(r){const e=d=>{const{instance:u,value:f}=d;if(!u||!u.$)throw createI18nError(I18nErrorCodes.UNEXPECTED_ERROR);const g=getComposer$1(r,u.$),_=parseValue(f);return[Reflect.apply(g.t,g,[...makeParams(_)]),g]};return{created:(d,u)=>{const[f,g]=e(u);inBrowser&&r.global===g&&(d.__i18nWatcher=watch(g.locale,()=>{u.instance&&u.instance.$forceUpdate()})),d.__composer=g,d.textContent=f},unmounted:d=>{inBrowser&&d.__i18nWatcher&&(d.__i18nWatcher(),d.__i18nWatcher=void 0,delete d.__i18nWatcher),d.__composer&&(d.__composer=void 0,delete d.__composer)},beforeUpdate:(d,{value:u})=>{if(d.__composer){const f=d.__composer,g=parseValue(u);d.textContent=Reflect.apply(f.t,f,[...makeParams(g)])}},getSSRProps:d=>{const[u]=e(d);return{textContent:u}}}}function parseValue(r){if(isString$1(r))return{path:r};if(isPlainObject$1(r)){if(!("path"in r))throw createI18nError(I18nErrorCodes.REQUIRED_VALUE,"path");return r}else throw createI18nError(I18nErrorCodes.INVALID_VALUE)}function makeParams(r){const{path:e,locale:i,args:n,choice:o,plural:l}=r,d={},u=n||{};return isString$1(i)&&(d.locale=i),isNumber$1(o)&&(d.plural=o),isNumber$1(l)&&(d.plural=l),[e,u,d]}function apply(r,e,...i){const n=isPlainObject$1(i[0])?i[0]:{};(isBoolean$1(n.globalInstall)?n.globalInstall:!0)&&([Translation.name,"I18nT"].forEach(l=>r.component(l,Translation)),[NumberFormat.name,"I18nN"].forEach(l=>r.component(l,NumberFormat)),[DatetimeFormat.name,"I18nD"].forEach(l=>r.component(l,DatetimeFormat))),r.directive("t",vTDirective(e))}const I18nInjectionKey=makeSymbol("global-vue-i18n");function createI18n(r={}){const e=__VUE_I18N_LEGACY_API__&&isBoolean$1(r.legacy)?r.legacy:__VUE_I18N_LEGACY_API__,i=isBoolean$1(r.globalInjection)?r.globalInjection:!0,n=new Map,[o,l]=createGlobal(r,e),d=makeSymbol("");function u(y){return n.get(y)||null}function f(y,b){n.set(y,b)}function g(y){n.delete(y)}const _={get mode(){return __VUE_I18N_LEGACY_API__&&e?"legacy":"composition"},async install(y,...b){if(y.__VUE_I18N_SYMBOL__=d,y.provide(y.__VUE_I18N_SYMBOL__,_),isPlainObject$1(b[0])){const A=b[0];_.__composerExtend=A.__composerExtend,_.__vueI18nExtend=A.__vueI18nExtend}let S=null;!e&&i&&(S=injectGlobalFields(y,_.global)),__VUE_I18N_FULL_INSTALL__&&apply(y,_,...b),__VUE_I18N_LEGACY_API__&&e&&y.mixin(defineMixin(l,l.__composer,_));const v=y.unmount;y.unmount=()=>{S&&S(),_.dispose(),v()}},get global(){return l},dispose(){o.stop()},__instances:n,__getInstance:u,__setInstance:f,__deleteInstance:g};return _}function useI18n(r={}){const e=getCurrentInstance();if(e==null)throw createI18nError(I18nErrorCodes.MUST_BE_CALL_SETUP_TOP);if(!e.isCE&&e.appContext.app!=null&&!e.appContext.app.__VUE_I18N_SYMBOL__)throw createI18nError(I18nErrorCodes.NOT_INSTALLED);const i=getI18nInstance(e),n=getGlobalComposer(i),o=getComponentOptions(e),l=getScope(r,o);if(l==="global")return adjustI18nResources(n,r,o),n;if(l==="parent"){let f=getComposer(i,e,r.__useComponent);return f==null&&(f=n),f}const d=i;let u=d.__getInstance(e);if(u==null){const f=assign$1({},r);"__i18n"in o&&(f.__i18n=o.__i18n),n&&(f.__root=n),u=createComposer(f),d.__composerExtend&&(u[DisposeSymbol]=d.__composerExtend(u)),setupLifeCycle(d,e,u),d.__setInstance(e,u)}return u}function createGlobal(r,e){const i=effectScope(),n=__VUE_I18N_LEGACY_API__&&e?i.run(()=>createVueI18n(r)):i.run(()=>createComposer(r));if(n==null)throw createI18nError(I18nErrorCodes.UNEXPECTED_ERROR);return[i,n]}function getI18nInstance(r){const e=inject$1(r.isCE?I18nInjectionKey:r.appContext.app.__VUE_I18N_SYMBOL__);if(!e)throw createI18nError(r.isCE?I18nErrorCodes.NOT_INSTALLED_WITH_PROVIDE:I18nErrorCodes.UNEXPECTED_ERROR);return e}function getScope(r,e){return isEmptyObject(r)?"__i18n"in e?"local":"global":r.useScope?r.useScope:"local"}function getGlobalComposer(r){return r.mode==="composition"?r.global:r.global.__composer}function getComposer(r,e,i=!1){let n=null;const o=e.root;let l=getParentComponentInstance(e,i);for(;l!=null;){const d=r;if(r.mode==="composition")n=d.__getInstance(l);else if(__VUE_I18N_LEGACY_API__){const u=d.__getInstance(l);u!=null&&(n=u.__composer,i&&n&&!n[InejctWithOptionSymbol]&&(n=null))}if(n!=null||o===l)break;l=l.parent}return n}function getParentComponentInstance(r,e=!1){return r==null?null:e&&r.vnode.ctx||r.parent}function setupLifeCycle(r,e,i){onMounted(()=>{},e),onUnmounted(()=>{const n=i;r.__deleteInstance(e);const o=n[DisposeSymbol];o&&(o(),delete n[DisposeSymbol])},e)}const globalExportProps=["locale","fallbackLocale","availableLocales"],globalExportMethods=["t","rt","d","n","tm","te"];function injectGlobalFields(r,e){const i=Object.create(null);return globalExportProps.forEach(o=>{const l=Object.getOwnPropertyDescriptor(e,o);if(!l)throw createI18nError(I18nErrorCodes.UNEXPECTED_ERROR);const d=isRef(l.value)?{get(){return l.value.value},set(u){l.value.value=u}}:{get(){return l.get&&l.get()}};Object.defineProperty(i,o,d)}),r.config.globalProperties.$i18n=i,globalExportMethods.forEach(o=>{const l=Object.getOwnPropertyDescriptor(e,o);if(!l||!l.value)throw createI18nError(I18nErrorCodes.UNEXPECTED_ERROR);Object.defineProperty(r.config.globalProperties,`$${o}`,l)}),()=>{delete r.config.globalProperties.$i18n,globalExportMethods.forEach(o=>{delete r.config.globalProperties[`$${o}`]})}}const DatetimeFormatImpl=defineComponent({name:"i18n-d",props:assign$1({value:{type:[Number,Date],required:!0},format:{type:[String,Object]}},baseFormatProps),setup(r,e){const i=r.i18n||useI18n({useScope:r.scope,__useComponent:!0});return renderFormatter(r,e,DATETIME_FORMAT_OPTIONS_KEYS,(...n)=>i[DatetimePartsSymbol](...n))}}),DatetimeFormat=DatetimeFormatImpl;initFeatureFlags();registerMessageCompiler(compile);registerMessageResolver(resolveValue);registerLocaleFallbacker(fallbackWithLocaleChain);if(__INTLIFY_PROD_DEVTOOLS__){const r=getGlobalThis();r.__INTLIFY__=!0,setDevToolsHook(r.__INTLIFY_DEVTOOLS_GLOBAL_HOOK__)}const _export_sfc=(r,e)=>{const i=r.__vccOpts||r;for(const[n,o]of e)i[n]=o;return i},_sfc_main$9={__name:"LoginButton",setup(r){ref(!1);const{locale:e}=useI18n(),i=n=>{e.value=n};return(n,o)=>(openBlock(),createElementBlock(Fragment,null,[createBaseVNode("button",{onClick:o[0]||(o[0]=l=>i("en")),class:"b22"},"English"),o[2]||(o[2]=createBaseVNode("span",null,"|",-1)),createBaseVNode("button",{onClick:o[1]||(o[1]=l=>i("zh")),class:"b22"},"")],64))}},LoginButton=_export_sfc(_sfc_main$9,[["__scopeId","data-v-e429c19e"]]);/*!
  * vue-router v4.5.0
  * (c) 2024 Eduardo San Martin Morote
  * @license MIT
  */const isBrowser$1=typeof document<"u";function isRouteComponent(r){return typeof r=="object"||"displayName"in r||"props"in r||"__vccOpts"in r}function isESModule(r){return r.__esModule||r[Symbol.toStringTag]==="Module"||r.default&&isRouteComponent(r.default)}const assign=Object.assign;function applyToParams(r,e){const i={};for(const n in e){const o=e[n];i[n]=isArray$1(o)?o.map(r):r(o)}return i}const noop$1=()=>{},isArray$1=Array.isArray,HASH_RE=/#/g,AMPERSAND_RE=/&/g,SLASH_RE=/\//g,EQUAL_RE=/=/g,IM_RE=/\?/g,PLUS_RE=/\+/g,ENC_BRACKET_OPEN_RE=/%5B/g,ENC_BRACKET_CLOSE_RE=/%5D/g,ENC_CARET_RE=/%5E/g,ENC_BACKTICK_RE=/%60/g,ENC_CURLY_OPEN_RE=/%7B/g,ENC_PIPE_RE=/%7C/g,ENC_CURLY_CLOSE_RE=/%7D/g,ENC_SPACE_RE=/%20/g;function commonEncode(r){return encodeURI(""+r).replace(ENC_PIPE_RE,"|").replace(ENC_BRACKET_OPEN_RE,"[").replace(ENC_BRACKET_CLOSE_RE,"]")}function encodeHash(r){return commonEncode(r).replace(ENC_CURLY_OPEN_RE,"{").replace(ENC_CURLY_CLOSE_RE,"}").replace(ENC_CARET_RE,"^")}function encodeQueryValue(r){return commonEncode(r).replace(PLUS_RE,"%2B").replace(ENC_SPACE_RE,"+").replace(HASH_RE,"%23").replace(AMPERSAND_RE,"%26").replace(ENC_BACKTICK_RE,"`").replace(ENC_CURLY_OPEN_RE,"{").replace(ENC_CURLY_CLOSE_RE,"}").replace(ENC_CARET_RE,"^")}function encodeQueryKey(r){return encodeQueryValue(r).replace(EQUAL_RE,"%3D")}function encodePath(r){return commonEncode(r).replace(HASH_RE,"%23").replace(IM_RE,"%3F")}function encodeParam(r){return r==null?"":encodePath(r).replace(SLASH_RE,"%2F")}function decode(r){try{return decodeURIComponent(""+r)}catch{}return""+r}const TRAILING_SLASH_RE=/\/$/,removeTrailingSlash=r=>r.replace(TRAILING_SLASH_RE,"");function parseURL(r,e,i="/"){let n,o={},l="",d="";const u=e.indexOf("#");let f=e.indexOf("?");return u<f&&u>=0&&(f=-1),f>-1&&(n=e.slice(0,f),l=e.slice(f+1,u>-1?u:e.length),o=r(l)),u>-1&&(n=n||e.slice(0,u),d=e.slice(u,e.length)),n=resolveRelativePath(n??e,i),{fullPath:n+(l&&"?")+l+d,path:n,query:o,hash:decode(d)}}function stringifyURL(r,e){const i=e.query?r(e.query):"";return e.path+(i&&"?")+i+(e.hash||"")}function stripBase(r,e){return!e||!r.toLowerCase().startsWith(e.toLowerCase())?r:r.slice(e.length)||"/"}function isSameRouteLocation(r,e,i){const n=e.matched.length-1,o=i.matched.length-1;return n>-1&&n===o&&isSameRouteRecord(e.matched[n],i.matched[o])&&isSameRouteLocationParams(e.params,i.params)&&r(e.query)===r(i.query)&&e.hash===i.hash}function isSameRouteRecord(r,e){return(r.aliasOf||r)===(e.aliasOf||e)}function isSameRouteLocationParams(r,e){if(Object.keys(r).length!==Object.keys(e).length)return!1;for(const i in r)if(!isSameRouteLocationParamsValue(r[i],e[i]))return!1;return!0}function isSameRouteLocationParamsValue(r,e){return isArray$1(r)?isEquivalentArray(r,e):isArray$1(e)?isEquivalentArray(e,r):r===e}function isEquivalentArray(r,e){return isArray$1(e)?r.length===e.length&&r.every((i,n)=>i===e[n]):r.length===1&&r[0]===e}function resolveRelativePath(r,e){if(r.startsWith("/"))return r;if(!r)return e;const i=e.split("/"),n=r.split("/"),o=n[n.length-1];(o===".."||o===".")&&n.push("");let l=i.length-1,d,u;for(d=0;d<n.length;d++)if(u=n[d],u!==".")if(u==="..")l>1&&l--;else break;return i.slice(0,l).join("/")+"/"+n.slice(d).join("/")}const START_LOCATION_NORMALIZED={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0};var NavigationType;(function(r){r.pop="pop",r.push="push"})(NavigationType||(NavigationType={}));var NavigationDirection;(function(r){r.back="back",r.forward="forward",r.unknown=""})(NavigationDirection||(NavigationDirection={}));function normalizeBase(r){if(!r)if(isBrowser$1){const e=document.querySelector("base");r=e&&e.getAttribute("href")||"/",r=r.replace(/^\w+:\/\/[^\/]+/,"")}else r="/";return r[0]!=="/"&&r[0]!=="#"&&(r="/"+r),removeTrailingSlash(r)}const BEFORE_HASH_RE=/^[^#]+#/;function createHref(r,e){return r.replace(BEFORE_HASH_RE,"#")+e}function getElementPosition(r,e){const i=document.documentElement.getBoundingClientRect(),n=r.getBoundingClientRect();return{behavior:e.behavior,left:n.left-i.left-(e.left||0),top:n.top-i.top-(e.top||0)}}const computeScrollPosition=()=>({left:window.scrollX,top:window.scrollY});function scrollToPosition(r){let e;if("el"in r){const i=r.el,n=typeof i=="string"&&i.startsWith("#"),o=typeof i=="string"?n?document.getElementById(i.slice(1)):document.querySelector(i):i;if(!o)return;e=getElementPosition(o,r)}else e=r;"scrollBehavior"in document.documentElement.style?window.scrollTo(e):window.scrollTo(e.left!=null?e.left:window.scrollX,e.top!=null?e.top:window.scrollY)}function getScrollKey(r,e){return(history.state?history.state.position-e:-1)+r}const scrollPositions=new Map;function saveScrollPosition(r,e){scrollPositions.set(r,e)}function getSavedScrollPosition(r){const e=scrollPositions.get(r);return scrollPositions.delete(r),e}let createBaseLocation=()=>location.protocol+"//"+location.host;function createCurrentLocation(r,e){const{pathname:i,search:n,hash:o}=e,l=r.indexOf("#");if(l>-1){let u=o.includes(r.slice(l))?r.slice(l).length:1,f=o.slice(u);return f[0]!=="/"&&(f="/"+f),stripBase(f,"")}return stripBase(i,r)+n+o}function useHistoryListeners(r,e,i,n){let o=[],l=[],d=null;const u=({state:b})=>{const S=createCurrentLocation(r,location),v=i.value,A=e.value;let x=0;if(b){if(i.value=S,e.value=b,d&&d===v){d=null;return}x=A?b.position-A.position:0}else n(S);o.forEach(T=>{T(i.value,v,{delta:x,type:NavigationType.pop,direction:x?x>0?NavigationDirection.forward:NavigationDirection.back:NavigationDirection.unknown})})};function f(){d=i.value}function g(b){o.push(b);const S=()=>{const v=o.indexOf(b);v>-1&&o.splice(v,1)};return l.push(S),S}function _(){const{history:b}=window;b.state&&b.replaceState(assign({},b.state,{scroll:computeScrollPosition()}),"")}function y(){for(const b of l)b();l=[],window.removeEventListener("popstate",u),window.removeEventListener("beforeunload",_)}return window.addEventListener("popstate",u),window.addEventListener("beforeunload",_,{passive:!0}),{pauseListeners:f,listen:g,destroy:y}}function buildState(r,e,i,n=!1,o=!1){return{back:r,current:e,forward:i,replaced:n,position:window.history.length,scroll:o?computeScrollPosition():null}}function useHistoryStateNavigation(r){const{history:e,location:i}=window,n={value:createCurrentLocation(r,i)},o={value:e.state};o.value||l(n.value,{back:null,current:n.value,forward:null,position:e.length-1,replaced:!0,scroll:null},!0);function l(f,g,_){const y=r.indexOf("#"),b=y>-1?(i.host&&document.querySelector("base")?r:r.slice(y))+f:createBaseLocation()+r+f;try{e[_?"replaceState":"pushState"](g,"",b),o.value=g}catch(S){console.error(S),i[_?"replace":"assign"](b)}}function d(f,g){const _=assign({},e.state,buildState(o.value.back,f,o.value.forward,!0),g,{position:o.value.position});l(f,_,!0),n.value=f}function u(f,g){const _=assign({},o.value,e.state,{forward:f,scroll:computeScrollPosition()});l(_.current,_,!0);const y=assign({},buildState(n.value,f,null),{position:_.position+1},g);l(f,y,!1),n.value=f}return{location:n,state:o,push:u,replace:d}}function createWebHistory(r){r=normalizeBase(r);const e=useHistoryStateNavigation(r),i=useHistoryListeners(r,e.state,e.location,e.replace);function n(l,d=!0){d||i.pauseListeners(),history.go(l)}const o=assign({location:"",base:r,go:n,createHref:createHref.bind(null,r)},e,i);return Object.defineProperty(o,"location",{enumerable:!0,get:()=>e.location.value}),Object.defineProperty(o,"state",{enumerable:!0,get:()=>e.state.value}),o}function createWebHashHistory(r){return r=location.host?r||location.pathname+location.search:"",r.includes("#")||(r+="#"),createWebHistory(r)}function isRouteLocation(r){return typeof r=="string"||r&&typeof r=="object"}function isRouteName(r){return typeof r=="string"||typeof r=="symbol"}const NavigationFailureSymbol=Symbol("");var NavigationFailureType;(function(r){r[r.aborted=4]="aborted",r[r.cancelled=8]="cancelled",r[r.duplicated=16]="duplicated"})(NavigationFailureType||(NavigationFailureType={}));function createRouterError(r,e){return assign(new Error,{type:r,[NavigationFailureSymbol]:!0},e)}function isNavigationFailure(r,e){return r instanceof Error&&NavigationFailureSymbol in r&&(e==null||!!(r.type&e))}const BASE_PARAM_PATTERN="[^/]+?",BASE_PATH_PARSER_OPTIONS={sensitive:!1,strict:!1,start:!0,end:!0},REGEX_CHARS_RE=/[.+*?^${}()[\]/\\]/g;function tokensToParser(r,e){const i=assign({},BASE_PATH_PARSER_OPTIONS,e),n=[];let o=i.start?"^":"";const l=[];for(const g of r){const _=g.length?[]:[90];i.strict&&!g.length&&(o+="/");for(let y=0;y<g.length;y++){const b=g[y];let S=40+(i.sensitive?.25:0);if(b.type===0)y||(o+="/"),o+=b.value.replace(REGEX_CHARS_RE,"\\$&"),S+=40;else if(b.type===1){const{value:v,repeatable:A,optional:x,regexp:T}=b;l.push({name:v,repeatable:A,optional:x});const C=T||BASE_PARAM_PATTERN;if(C!==BASE_PARAM_PATTERN){S+=10;try{new RegExp(`(${C})`)}catch(P){throw new Error(`Invalid custom RegExp for param "${v}" (${C}): `+P.message)}}let E=A?`((?:${C})(?:/(?:${C}))*)`:`(${C})`;y||(E=x&&g.length<2?`(?:/${E})`:"/"+E),x&&(E+="?"),o+=E,S+=20,x&&(S+=-8),A&&(S+=-20),C===".*"&&(S+=-50)}_.push(S)}n.push(_)}if(i.strict&&i.end){const g=n.length-1;n[g][n[g].length-1]+=.7000000000000001}i.strict||(o+="/?"),i.end?o+="$":i.strict&&!o.endsWith("/")&&(o+="(?:/|$)");const d=new RegExp(o,i.sensitive?"":"i");function u(g){const _=g.match(d),y={};if(!_)return null;for(let b=1;b<_.length;b++){const S=_[b]||"",v=l[b-1];y[v.name]=S&&v.repeatable?S.split("/"):S}return y}function f(g){let _="",y=!1;for(const b of r){(!y||!_.endsWith("/"))&&(_+="/"),y=!1;for(const S of b)if(S.type===0)_+=S.value;else if(S.type===1){const{value:v,repeatable:A,optional:x}=S,T=v in g?g[v]:"";if(isArray$1(T)&&!A)throw new Error(`Provided param "${v}" is an array but it is not repeatable (* or + modifiers)`);const C=isArray$1(T)?T.join("/"):T;if(!C)if(x)b.length<2&&(_.endsWith("/")?_=_.slice(0,-1):y=!0);else throw new Error(`Missing required param "${v}"`);_+=C}}return _||"/"}return{re:d,score:n,keys:l,parse:u,stringify:f}}function compareScoreArray(r,e){let i=0;for(;i<r.length&&i<e.length;){const n=e[i]-r[i];if(n)return n;i++}return r.length<e.length?r.length===1&&r[0]===80?-1:1:r.length>e.length?e.length===1&&e[0]===80?1:-1:0}function comparePathParserScore(r,e){let i=0;const n=r.score,o=e.score;for(;i<n.length&&i<o.length;){const l=compareScoreArray(n[i],o[i]);if(l)return l;i++}if(Math.abs(o.length-n.length)===1){if(isLastScoreNegative(n))return 1;if(isLastScoreNegative(o))return-1}return o.length-n.length}function isLastScoreNegative(r){const e=r[r.length-1];return r.length>0&&e[e.length-1]<0}const ROOT_TOKEN={type:0,value:""},VALID_PARAM_RE=/[a-zA-Z0-9_]/;function tokenizePath(r){if(!r)return[[]];if(r==="/")return[[ROOT_TOKEN]];if(!r.startsWith("/"))throw new Error(`Invalid path "${r}"`);function e(S){throw new Error(`ERR (${i})/"${g}": ${S}`)}let i=0,n=i;const o=[];let l;function d(){l&&o.push(l),l=[]}let u=0,f,g="",_="";function y(){g&&(i===0?l.push({type:0,value:g}):i===1||i===2||i===3?(l.length>1&&(f==="*"||f==="+")&&e(`A repeatable param (${g}) must be alone in its segment. eg: '/:ids+.`),l.push({type:1,value:g,regexp:_,repeatable:f==="*"||f==="+",optional:f==="*"||f==="?"})):e("Invalid state to consume buffer"),g="")}function b(){g+=f}for(;u<r.length;){if(f=r[u++],f==="\\"&&i!==2){n=i,i=4;continue}switch(i){case 0:f==="/"?(g&&y(),d()):f===":"?(y(),i=1):b();break;case 4:b(),i=n;break;case 1:f==="("?i=2:VALID_PARAM_RE.test(f)?b():(y(),i=0,f!=="*"&&f!=="?"&&f!=="+"&&u--);break;case 2:f===")"?_[_.length-1]=="\\"?_=_.slice(0,-1)+f:i=3:_+=f;break;case 3:y(),i=0,f!=="*"&&f!=="?"&&f!=="+"&&u--,_="";break;default:e("Unknown state");break}}return i===2&&e(`Unfinished custom RegExp for param "${g}"`),y(),d(),o}function createRouteRecordMatcher(r,e,i){const n=tokensToParser(tokenizePath(r.path),i),o=assign(n,{record:r,parent:e,children:[],alias:[]});return e&&!o.record.aliasOf==!e.record.aliasOf&&e.children.push(o),o}function createRouterMatcher(r,e){const i=[],n=new Map;e=mergeOptions({strict:!1,end:!0,sensitive:!1},e);function o(y){return n.get(y)}function l(y,b,S){const v=!S,A=normalizeRouteRecord(y);A.aliasOf=S&&S.record;const x=mergeOptions(e,y),T=[A];if("alias"in y){const P=typeof y.alias=="string"?[y.alias]:y.alias;for(const R of P)T.push(normalizeRouteRecord(assign({},A,{components:S?S.record.components:A.components,path:R,aliasOf:S?S.record:A})))}let C,E;for(const P of T){const{path:R}=P;if(b&&R[0]!=="/"){const L=b.record.path,w=L[L.length-1]==="/"?"":"/";P.path=b.record.path+(R&&w+R)}if(C=createRouteRecordMatcher(P,b,x),S?S.alias.push(C):(E=E||C,E!==C&&E.alias.push(C),v&&y.name&&!isAliasRecord(C)&&d(y.name)),isMatchable(C)&&f(C),A.children){const L=A.children;for(let w=0;w<L.length;w++)l(L[w],C,S&&S.children[w])}S=S||C}return E?()=>{d(E)}:noop$1}function d(y){if(isRouteName(y)){const b=n.get(y);b&&(n.delete(y),i.splice(i.indexOf(b),1),b.children.forEach(d),b.alias.forEach(d))}else{const b=i.indexOf(y);b>-1&&(i.splice(b,1),y.record.name&&n.delete(y.record.name),y.children.forEach(d),y.alias.forEach(d))}}function u(){return i}function f(y){const b=findInsertionIndex(y,i);i.splice(b,0,y),y.record.name&&!isAliasRecord(y)&&n.set(y.record.name,y)}function g(y,b){let S,v={},A,x;if("name"in y&&y.name){if(S=n.get(y.name),!S)throw createRouterError(1,{location:y});x=S.record.name,v=assign(paramsFromLocation(b.params,S.keys.filter(E=>!E.optional).concat(S.parent?S.parent.keys.filter(E=>E.optional):[]).map(E=>E.name)),y.params&&paramsFromLocation(y.params,S.keys.map(E=>E.name))),A=S.stringify(v)}else if(y.path!=null)A=y.path,S=i.find(E=>E.re.test(A)),S&&(v=S.parse(A),x=S.record.name);else{if(S=b.name?n.get(b.name):i.find(E=>E.re.test(b.path)),!S)throw createRouterError(1,{location:y,currentLocation:b});x=S.record.name,v=assign({},b.params,y.params),A=S.stringify(v)}const T=[];let C=S;for(;C;)T.unshift(C.record),C=C.parent;return{name:x,path:A,params:v,matched:T,meta:mergeMetaFields(T)}}r.forEach(y=>l(y));function _(){i.length=0,n.clear()}return{addRoute:l,resolve:g,removeRoute:d,clearRoutes:_,getRoutes:u,getRecordMatcher:o}}function paramsFromLocation(r,e){const i={};for(const n of e)n in r&&(i[n]=r[n]);return i}function normalizeRouteRecord(r){const e={path:r.path,redirect:r.redirect,name:r.name,meta:r.meta||{},aliasOf:r.aliasOf,beforeEnter:r.beforeEnter,props:normalizeRecordProps(r),children:r.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in r?r.components||null:r.component&&{default:r.component}};return Object.defineProperty(e,"mods",{value:{}}),e}function normalizeRecordProps(r){const e={},i=r.props||!1;if("component"in r)e.default=i;else for(const n in r.components)e[n]=typeof i=="object"?i[n]:i;return e}function isAliasRecord(r){for(;r;){if(r.record.aliasOf)return!0;r=r.parent}return!1}function mergeMetaFields(r){return r.reduce((e,i)=>assign(e,i.meta),{})}function mergeOptions(r,e){const i={};for(const n in r)i[n]=n in e?e[n]:r[n];return i}function findInsertionIndex(r,e){let i=0,n=e.length;for(;i!==n;){const l=i+n>>1;comparePathParserScore(r,e[l])<0?n=l:i=l+1}const o=getInsertionAncestor(r);return o&&(n=e.lastIndexOf(o,n-1)),n}function getInsertionAncestor(r){let e=r;for(;e=e.parent;)if(isMatchable(e)&&comparePathParserScore(r,e)===0)return e}function isMatchable({record:r}){return!!(r.name||r.components&&Object.keys(r.components).length||r.redirect)}function parseQuery(r){const e={};if(r===""||r==="?")return e;const n=(r[0]==="?"?r.slice(1):r).split("&");for(let o=0;o<n.length;++o){const l=n[o].replace(PLUS_RE," "),d=l.indexOf("="),u=decode(d<0?l:l.slice(0,d)),f=d<0?null:decode(l.slice(d+1));if(u in e){let g=e[u];isArray$1(g)||(g=e[u]=[g]),g.push(f)}else e[u]=f}return e}function stringifyQuery(r){let e="";for(let i in r){const n=r[i];if(i=encodeQueryKey(i),n==null){n!==void 0&&(e+=(e.length?"&":"")+i);continue}(isArray$1(n)?n.map(l=>l&&encodeQueryValue(l)):[n&&encodeQueryValue(n)]).forEach(l=>{l!==void 0&&(e+=(e.length?"&":"")+i,l!=null&&(e+="="+l))})}return e}function normalizeQuery(r){const e={};for(const i in r){const n=r[i];n!==void 0&&(e[i]=isArray$1(n)?n.map(o=>o==null?null:""+o):n==null?n:""+n)}return e}const matchedRouteKey=Symbol(""),viewDepthKey=Symbol(""),routerKey=Symbol(""),routeLocationKey=Symbol(""),routerViewLocationKey=Symbol("");function useCallbacks(){let r=[];function e(n){return r.push(n),()=>{const o=r.indexOf(n);o>-1&&r.splice(o,1)}}function i(){r=[]}return{add:e,list:()=>r.slice(),reset:i}}function guardToPromiseFn(r,e,i,n,o,l=d=>d()){const d=n&&(n.enterCallbacks[o]=n.enterCallbacks[o]||[]);return()=>new Promise((u,f)=>{const g=b=>{b===!1?f(createRouterError(4,{from:i,to:e})):b instanceof Error?f(b):isRouteLocation(b)?f(createRouterError(2,{from:e,to:b})):(d&&n.enterCallbacks[o]===d&&typeof b=="function"&&d.push(b),u())},_=l(()=>r.call(n&&n.instances[o],e,i,g));let y=Promise.resolve(_);r.length<3&&(y=y.then(g)),y.catch(b=>f(b))})}function extractComponentsGuards(r,e,i,n,o=l=>l()){const l=[];for(const d of r)for(const u in d.components){let f=d.components[u];if(!(e!=="beforeRouteEnter"&&!d.instances[u]))if(isRouteComponent(f)){const _=(f.__vccOpts||f)[e];_&&l.push(guardToPromiseFn(_,i,n,d,u,o))}else{let g=f();l.push(()=>g.then(_=>{if(!_)throw new Error(`Couldn't resolve component "${u}" at "${d.path}"`);const y=isESModule(_)?_.default:_;d.mods[u]=_,d.components[u]=y;const S=(y.__vccOpts||y)[e];return S&&guardToPromiseFn(S,i,n,d,u,o)()}))}}return l}function useLink(r){const e=inject$1(routerKey),i=inject$1(routeLocationKey),n=computed(()=>{const f=unref(r.to);return e.resolve(f)}),o=computed(()=>{const{matched:f}=n.value,{length:g}=f,_=f[g-1],y=i.matched;if(!_||!y.length)return-1;const b=y.findIndex(isSameRouteRecord.bind(null,_));if(b>-1)return b;const S=getOriginalPath(f[g-2]);return g>1&&getOriginalPath(_)===S&&y[y.length-1].path!==S?y.findIndex(isSameRouteRecord.bind(null,f[g-2])):b}),l=computed(()=>o.value>-1&&includesParams(i.params,n.value.params)),d=computed(()=>o.value>-1&&o.value===i.matched.length-1&&isSameRouteLocationParams(i.params,n.value.params));function u(f={}){if(guardEvent(f)){const g=e[unref(r.replace)?"replace":"push"](unref(r.to)).catch(noop$1);return r.viewTransition&&typeof document<"u"&&"startViewTransition"in document&&document.startViewTransition(()=>g),g}return Promise.resolve()}return{route:n,href:computed(()=>n.value.href),isActive:l,isExactActive:d,navigate:u}}function preferSingleVNode(r){return r.length===1?r[0]:r}const RouterLinkImpl=defineComponent({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink,setup(r,{slots:e}){const i=reactive(useLink(r)),{options:n}=inject$1(routerKey),o=computed(()=>({[getLinkClass(r.activeClass,n.linkActiveClass,"router-link-active")]:i.isActive,[getLinkClass(r.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:i.isExactActive}));return()=>{const l=e.default&&preferSingleVNode(e.default(i));return r.custom?l:h("a",{"aria-current":i.isExactActive?r.ariaCurrentValue:null,href:i.href,onClick:i.navigate,class:o.value},l)}}}),RouterLink=RouterLinkImpl;function guardEvent(r){if(!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)&&!r.defaultPrevented&&!(r.button!==void 0&&r.button!==0)){if(r.currentTarget&&r.currentTarget.getAttribute){const e=r.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(e))return}return r.preventDefault&&r.preventDefault(),!0}}function includesParams(r,e){for(const i in e){const n=e[i],o=r[i];if(typeof n=="string"){if(n!==o)return!1}else if(!isArray$1(o)||o.length!==n.length||n.some((l,d)=>l!==o[d]))return!1}return!0}function getOriginalPath(r){return r?r.aliasOf?r.aliasOf.path:r.path:""}const getLinkClass=(r,e,i)=>r??e??i,RouterViewImpl=defineComponent({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(r,{attrs:e,slots:i}){const n=inject$1(routerViewLocationKey),o=computed(()=>r.route||n.value),l=inject$1(viewDepthKey,0),d=computed(()=>{let g=unref(l);const{matched:_}=o.value;let y;for(;(y=_[g])&&!y.components;)g++;return g}),u=computed(()=>o.value.matched[d.value]);provide(viewDepthKey,computed(()=>d.value+1)),provide(matchedRouteKey,u),provide(routerViewLocationKey,o);const f=ref();return watch(()=>[f.value,u.value,r.name],([g,_,y],[b,S,v])=>{_&&(_.instances[y]=g,S&&S!==_&&g&&g===b&&(_.leaveGuards.size||(_.leaveGuards=S.leaveGuards),_.updateGuards.size||(_.updateGuards=S.updateGuards))),g&&_&&(!S||!isSameRouteRecord(_,S)||!b)&&(_.enterCallbacks[y]||[]).forEach(A=>A(g))},{flush:"post"}),()=>{const g=o.value,_=r.name,y=u.value,b=y&&y.components[_];if(!b)return normalizeSlot(i.default,{Component:b,route:g});const S=y.props[_],v=S?S===!0?g.params:typeof S=="function"?S(g):S:null,x=h(b,assign({},v,e,{onVnodeUnmounted:T=>{T.component.isUnmounted&&(y.instances[_]=null)},ref:f}));return normalizeSlot(i.default,{Component:x,route:g})||x}}});function normalizeSlot(r,e){if(!r)return null;const i=r(e);return i.length===1?i[0]:i}const RouterView=RouterViewImpl;function createRouter(r){const e=createRouterMatcher(r.routes,r),i=r.parseQuery||parseQuery,n=r.stringifyQuery||stringifyQuery,o=r.history,l=useCallbacks(),d=useCallbacks(),u=useCallbacks(),f=shallowRef(START_LOCATION_NORMALIZED);let g=START_LOCATION_NORMALIZED;isBrowser$1&&r.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const _=applyToParams.bind(null,ee=>""+ee),y=applyToParams.bind(null,encodeParam),b=applyToParams.bind(null,decode);function S(ee,J){let ie,le;return isRouteName(ee)?(ie=e.getRecordMatcher(ee),le=J):le=ee,e.addRoute(le,ie)}function v(ee){const J=e.getRecordMatcher(ee);J&&e.removeRoute(J)}function A(){return e.getRoutes().map(ee=>ee.record)}function x(ee){return!!e.getRecordMatcher(ee)}function T(ee,J){if(J=assign({},J||f.value),typeof ee=="string"){const K=parseURL(i,ee,J.path),ne=e.resolve({path:K.path},J),re=o.createHref(K.fullPath);return assign(K,ne,{params:b(ne.params),hash:decode(K.hash),redirectedFrom:void 0,href:re})}let ie;if(ee.path!=null)ie=assign({},ee,{path:parseURL(i,ee.path,J.path).path});else{const K=assign({},ee.params);for(const ne in K)K[ne]==null&&delete K[ne];ie=assign({},ee,{params:y(K)}),J.params=y(J.params)}const le=e.resolve(ie,J),ce=ee.hash||"";le.params=_(b(le.params));const j=stringifyURL(n,assign({},ee,{hash:encodeHash(ce),path:le.path})),W=o.createHref(j);return assign({fullPath:j,hash:ce,query:n===stringifyQuery?normalizeQuery(ee.query):ee.query||{}},le,{redirectedFrom:void 0,href:W})}function C(ee){return typeof ee=="string"?parseURL(i,ee,f.value.path):assign({},ee)}function E(ee,J){if(g!==ee)return createRouterError(8,{from:J,to:ee})}function P(ee){return w(ee)}function R(ee){return P(assign(C(ee),{replace:!0}))}function L(ee){const J=ee.matched[ee.matched.length-1];if(J&&J.redirect){const{redirect:ie}=J;let le=typeof ie=="function"?ie(ee):ie;return typeof le=="string"&&(le=le.includes("?")||le.includes("#")?le=C(le):{path:le},le.params={}),assign({query:ee.query,hash:ee.hash,params:le.path!=null?{}:ee.params},le)}}function w(ee,J){const ie=g=T(ee),le=f.value,ce=ee.state,j=ee.force,W=ee.replace===!0,K=L(ie);if(K)return w(assign(C(K),{state:typeof K=="object"?assign({},ce,K.state):ce,force:j,replace:W}),J||ie);const ne=ie;ne.redirectedFrom=J;let re;return!j&&isSameRouteLocation(n,le,ie)&&(re=createRouterError(16,{to:ne,from:le}),te(le,le,!0,!1)),(re?Promise.resolve(re):D(ne,le)).catch(ae=>isNavigationFailure(ae)?isNavigationFailure(ae,2)?ae:q(ae):Y(ae,ne,le)).then(ae=>{if(ae){if(isNavigationFailure(ae,2))return w(assign({replace:W},C(ae.to),{state:typeof ae.to=="object"?assign({},ce,ae.to.state):ce,force:j}),J||ne)}else ae=N(ne,le,!0,W,ce);return O(ne,le,ae),ae})}function B(ee,J){const ie=E(ee,J);return ie?Promise.reject(ie):Promise.resolve()}function I(ee){const J=fe.values().next().value;return J&&typeof J.runWithContext=="function"?J.runWithContext(ee):ee()}function D(ee,J){let ie;const[le,ce,j]=extractChangingRecords(ee,J);ie=extractComponentsGuards(le.reverse(),"beforeRouteLeave",ee,J);for(const K of le)K.leaveGuards.forEach(ne=>{ie.push(guardToPromiseFn(ne,ee,J))});const W=B.bind(null,ee,J);return ie.push(W),me(ie).then(()=>{ie=[];for(const K of l.list())ie.push(guardToPromiseFn(K,ee,J));return ie.push(W),me(ie)}).then(()=>{ie=extractComponentsGuards(ce,"beforeRouteUpdate",ee,J);for(const K of ce)K.updateGuards.forEach(ne=>{ie.push(guardToPromiseFn(ne,ee,J))});return ie.push(W),me(ie)}).then(()=>{ie=[];for(const K of j)if(K.beforeEnter)if(isArray$1(K.beforeEnter))for(const ne of K.beforeEnter)ie.push(guardToPromiseFn(ne,ee,J));else ie.push(guardToPromiseFn(K.beforeEnter,ee,J));return ie.push(W),me(ie)}).then(()=>(ee.matched.forEach(K=>K.enterCallbacks={}),ie=extractComponentsGuards(j,"beforeRouteEnter",ee,J,I),ie.push(W),me(ie))).then(()=>{ie=[];for(const K of d.list())ie.push(guardToPromiseFn(K,ee,J));return ie.push(W),me(ie)}).catch(K=>isNavigationFailure(K,8)?K:Promise.reject(K))}function O(ee,J,ie){u.list().forEach(le=>I(()=>le(ee,J,ie)))}function N(ee,J,ie,le,ce){const j=E(ee,J);if(j)return j;const W=J===START_LOCATION_NORMALIZED,K=isBrowser$1?history.state:{};ie&&(le||W?o.replace(ee.fullPath,assign({scroll:W&&K&&K.scroll},ce)):o.push(ee.fullPath,ce)),f.value=ee,te(ee,J,ie,W),q()}let V;function H(){V||(V=o.listen((ee,J,ie)=>{if(!pe.listening)return;const le=T(ee),ce=L(le);if(ce){w(assign(ce,{replace:!0,force:!0}),le).catch(noop$1);return}g=le;const j=f.value;isBrowser$1&&saveScrollPosition(getScrollKey(j.fullPath,ie.delta),computeScrollPosition()),D(le,j).catch(W=>isNavigationFailure(W,12)?W:isNavigationFailure(W,2)?(w(assign(C(W.to),{force:!0}),le).then(K=>{isNavigationFailure(K,20)&&!ie.delta&&ie.type===NavigationType.pop&&o.go(-1,!1)}).catch(noop$1),Promise.reject()):(ie.delta&&o.go(-ie.delta,!1),Y(W,le,j))).then(W=>{W=W||N(le,j,!1),W&&(ie.delta&&!isNavigationFailure(W,8)?o.go(-ie.delta,!1):ie.type===NavigationType.pop&&isNavigationFailure(W,20)&&o.go(-1,!1)),O(le,j,W)}).catch(noop$1)}))}let F=useCallbacks(),$=useCallbacks(),G;function Y(ee,J,ie){q(ee);const le=$.list();return le.length?le.forEach(ce=>ce(ee,J,ie)):console.error(ee),Promise.reject(ee)}function Q(){return G&&f.value!==START_LOCATION_NORMALIZED?Promise.resolve():new Promise((ee,J)=>{F.add([ee,J])})}function q(ee){return G||(G=!ee,H(),F.list().forEach(([J,ie])=>ee?ie(ee):J()),F.reset()),ee}function te(ee,J,ie,le){const{scrollBehavior:ce}=r;if(!isBrowser$1||!ce)return Promise.resolve();const j=!ie&&getSavedScrollPosition(getScrollKey(ee.fullPath,0))||(le||!ie)&&history.state&&history.state.scroll||null;return nextTick().then(()=>ce(ee,J,j)).then(W=>W&&scrollToPosition(W)).catch(W=>Y(W,ee,J))}const ue=ee=>o.go(ee);let he;const fe=new Set,pe={currentRoute:f,listening:!0,addRoute:S,removeRoute:v,clearRoutes:e.clearRoutes,hasRoute:x,getRoutes:A,resolve:T,options:r,push:P,replace:R,go:ue,back:()=>ue(-1),forward:()=>ue(1),beforeEach:l.add,beforeResolve:d.add,afterEach:u.add,onError:$.add,isReady:Q,install(ee){const J=this;ee.component("RouterLink",RouterLink),ee.component("RouterView",RouterView),ee.config.globalProperties.$router=J,Object.defineProperty(ee.config.globalProperties,"$route",{enumerable:!0,get:()=>unref(f)}),isBrowser$1&&!he&&f.value===START_LOCATION_NORMALIZED&&(he=!0,P(o.location).catch(ce=>{}));const ie={};for(const ce in START_LOCATION_NORMALIZED)Object.defineProperty(ie,ce,{get:()=>f.value[ce],enumerable:!0});ee.provide(routerKey,J),ee.provide(routeLocationKey,shallowReactive(ie)),ee.provide(routerViewLocationKey,f);const le=ee.unmount;fe.add(ee),ee.unmount=function(){fe.delete(ee),fe.size<1&&(g=START_LOCATION_NORMALIZED,V&&V(),V=null,f.value=START_LOCATION_NORMALIZED,he=!1,G=!1),le()}}};function me(ee){return ee.reduce((J,ie)=>J.then(()=>I(ie)),Promise.resolve())}return pe}function extractChangingRecords(r,e){const i=[],n=[],o=[],l=Math.max(e.matched.length,r.matched.length);for(let d=0;d<l;d++){const u=e.matched[d];u&&(r.matched.find(g=>isSameRouteRecord(g,u))?n.push(u):i.push(u));const f=r.matched[d];f&&(e.matched.find(g=>isSameRouteRecord(g,f))||o.push(f))}return[i,n,o]}function useRouter(){return inject$1(routerKey)}function useRoute(r){return inject$1(routeLocationKey)}const _hoisted_1$6={class:"header"},_hoisted_2$6={class:"logo"},_hoisted_3$6={class:"nav"},_hoisted_4$5={class:"nav_phone"},_hoisted_5$5={class:"phonebox"},_hoisted_6$5={class:"hghg"},_hoisted_7$5={class:"vbvbaaa"},_sfc_main$8={__name:"Header",setup(r){let e=ref(!1);const i=useRouter(),n=useRoute();onMounted(()=>{window.innerWidth<1200&&watch(()=>n.path,()=>{e.value=!1})});const o=()=>{i.push("/")},l=()=>{e.value=!e.value},{t:d,locale:u}=useI18n();return(f,g)=>{const _=resolveComponent("router-link");return openBlock(),createElementBlock("header",_hoisted_1$6,[createBaseVNode("div",_hoisted_2$6,[createBaseVNode("img",{onClick:o,src:_imports_0$5,alt:"Logo"}),createBaseVNode("h3",{onClick:o},toDisplayString$1(f.$t("honetitle3")),1)]),createBaseVNode("nav",_hoisted_3$6,[createVNode(_,{to:"/service"},{default:withCtx(()=>[createTextVNode(toDisplayString$1(f.$t("nav3")),1)]),_:1}),createVNode(_,{to:"/about"},{default:withCtx(()=>[createTextVNode(toDisplayString$1(f.$t("nav2")),1)]),_:1}),createVNode(_,{to:"/choose"},{default:withCtx(()=>[createTextVNode(toDisplayString$1(f.$t("nav4")),1)]),_:1}),createVNode(_,{to:"/manager"},{default:withCtx(()=>[createTextVNode(toDisplayString$1(f.$t("nav5")),1)]),_:1})]),createBaseVNode("div",{class:"nbmvcs",onClick:l},g[0]||(g[0]=[createBaseVNode("img",{src:_imports_1$3,alt:""},null,-1)])),withDirectives(createBaseVNode("div",_hoisted_4$5,[createBaseVNode("div",_hoisted_5$5,[createVNode(_,{to:"/service"},{default:withCtx(()=>[createTextVNode(toDisplayString$1(f.$t("nav3")),1)]),_:1}),createVNode(_,{to:"/about"},{default:withCtx(()=>[createTextVNode(toDisplayString$1(f.$t("nav2")),1)]),_:1}),createVNode(_,{to:"/choose"},{default:withCtx(()=>[createTextVNode(toDisplayString$1(f.$t("nav4")),1)]),_:1}),createVNode(_,{to:"/manager"},{default:withCtx(()=>[createTextVNode(toDisplayString$1(f.$t("nav5")),1)]),_:1})]),createBaseVNode("div",_hoisted_6$5,[createVNode(LoginButton)])],512),[[vShow,unref(e)]]),createBaseVNode("div",_hoisted_7$5,[createVNode(LoginButton)])])}}},Header=_export_sfc(_sfc_main$8,[["__scopeId","data-v-51d7711e"]]),_hoisted_1$5={class:"footer"},_hoisted_2$5={class:"ftitle"},_hoisted_3$5={class:"nav"},_sfc_main$7={__name:"footer",setup(r){const{t:e,locale:i}=useI18n();return(n,o)=>{const l=resolveComponent("router-link");return openBlock(),createElementBlock("footer",_hoisted_1$5,[createBaseVNode("div",_hoisted_2$5,"  2025"+toDisplayString$1(n.$t("honetitle3")),1),createBaseVNode("nav",_hoisted_3$5,[createVNode(l,{to:"/"},{default:withCtx(()=>[createTextVNode(toDisplayString$1(n.$t("nav1")),1)]),_:1}),createVNode(l,{to:"/about"},{default:withCtx(()=>[createTextVNode(toDisplayString$1(n.$t("nav2")),1)]),_:1}),createVNode(l,{to:"/service"},{default:withCtx(()=>[createTextVNode(toDisplayString$1(n.$t("nav3")),1)]),_:1}),createVNode(l,{to:"/choose"},{default:withCtx(()=>[createTextVNode(toDisplayString$1(n.$t("nav4")),1)]),_:1}),createVNode(l,{to:"/manager"},{default:withCtx(()=>[createTextVNode(toDisplayString$1(n.$t("nav5")),1)]),_:1})])])}}},Footer=_export_sfc(_sfc_main$7,[["__scopeId","data-v-67a196ee"]]),_sfc_main$6={__name:"App",setup(r){return(e,i)=>{const n=resolveComponent("router-view");return openBlock(),createElementBlock("div",null,[createVNode(Header,{class:"headerbox"}),createVNode(n),createVNode(Footer,{class:"Footerbox"})])}}},_imports_0$4="data:image/svg+xml,%3csvg%20data-v-7a837531=''%20viewBox='0%200%201024%201024'%20class='icon'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20fill='%23000000'%20winth='30'%20height='30'%3e%3cg%20data-v-7a837531=''%20id='SVGRepo_bgCarrier'%20stroke-width='0'%3e%3c/g%3e%3cg%20data-v-7a837531=''%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3c/g%3e%3cg%20data-v-7a837531=''%20id='SVGRepo_iconCarrier'%3e%3cpath%20data-v-7a837531=''%20d='M512%20192m-128%200a128%20128%200%201%200%20256%200%20128%20128%200%201%200-256%200Z'%20fill='%23fff'%3e%3c/path%3e%3cpath%20data-v-7a837531=''%20d='M110.021808%20743.473457a128%20128%200%201%200%20221.702503-128%20128%20128%200%201%200-221.702503%20128Z'%20fill='%23fff'%3e%3c/path%3e%3cpath%20data-v-7a837531=''%20d='M739.582127%20791.504295a128%20128%200%201%200%20128-221.702504%20128%20128%200%201%200-128%20221.702504Z'%20fill='%23fff'%3e%3c/path%3e%3cpath%20data-v-7a837531=''%20d='M181.7%20509.3c-4.2%200-8.4-0.4-12.7-1.3-34.7-7-57.1-40.7-50.2-75.3%209.1-45.2%2025.4-87.6%2048.6-125.8%2022.9-37.7%2051.9-70.7%2086.3-98.1%2034.3-27.3%2073.2-48.5%20115.6-62.9C412.2%20131.4%20457.8%20124%20505%20124c35.3%200%2064%2028.7%2064%2064s-28.7%2064-64%2064c-133.2%200-235.5%2080.8-260.7%20205.9-6.1%2030.4-32.8%2051.4-62.6%2051.4zM512%20913c-71.5%200-140.8-18.3-200.5-53.1-58.2-33.8-107.2-83.2-141.9-142.8-17.8-30.6-7.4-69.7%2023.1-87.5%2030.6-17.8%2069.7-7.4%2087.5%2023.1C329.2%20736.8%20413.6%20785%20512%20785c27.7%200%2054.9-4.1%2081-12.2%2033.8-10.5%2069.6%208.4%2080.1%2042.2%2010.5%2033.8-8.4%2069.6-42.2%2080.1C592.5%20907%20552.5%20913%20512%20913zM807.9%20738c-10.9%200-21.9-2.8-32-8.6-30.6-17.7-41-56.9-23.3-87.5C775%20603.3%20785%20563.2%20785%20512c0-72.9-28.4-141.5-80-193-25-25-25-65.5%200-90.5s65.5-25%2090.5%200c36.8%2036.8%2065.7%2079.7%2085.9%20127.4%2020.9%2049.5%2031.5%20102%2031.5%20156.1%200%2074-15.8%20135.7-49.6%20194.1-11.8%2020.5-33.3%2031.9-55.4%2031.9z'%20fill='%23fff'%3e%3c/path%3e%3c/g%3e%3c/svg%3e",_imports_1$2="data:image/svg+xml,%3csvg%20data-v-7a837531=''%20winth='30'%20height='30'%20viewBox='0%200%201024%201024'%20class='icon'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20fill='%23000000'%20stroke='%23000000'%3e%3cg%20data-v-7a837531=''%20id='SVGRepo_bgCarrier'%20stroke-width='0'%3e%3c/g%3e%3cg%20data-v-7a837531=''%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'%3e%3c/g%3e%3cg%20data-v-7a837531=''%20id='SVGRepo_iconCarrier'%3e%3cpath%20data-v-7a837531=''%20d='M523.9%20788.3H166.4V169c0-4.3%203.4-7.7%207.6-7.7h490.8c4.2%200%207.6%203.5%207.6%207.7v190h45.8V169c0-29.9-24-54.2-53.4-54.2H174c-29.5%200-53.4%2024.3-53.4%2054.2v689c0%2029.9%2024%2054.2%2053.4%2054.2h359.1c-5.9-11.6-9.3-24.8-9.3-38.7v-85.2z%20m-102.6%2096.2c-17%200-30.9-14-30.9-31.3s13.8-31.3%2030.9-31.3c17%200%2030.9%2014%2030.9%2031.3-0.1%2017.3-13.9%2031.3-30.9%2031.3z%20m442.9-479H607.9c-21.1%200-38.2%2017.4-38.2%2038.7v429.3c0%2021.3%2017.1%2038.7%2038.2%2038.7h256.3c21.1%200%2038.2-17.4%2038.2-38.7V444.2c0-21.4-17.1-38.7-38.2-38.7zM736.1%20888.9c-12.7%200-22.9-10.4-22.9-23.2%200-12.8%2010.3-23.2%2022.9-23.2%2012.6%200%2022.9%2010.4%2022.9%2023.2%200%2012.8-10.3%2023.2-22.9%2023.2z%20m120.5-69.7H615.5V451.9h241.1v367.3z'%20fill='%23FFF'%3e%3c/path%3e%3c/g%3e%3c/svg%3e",_imports_2$2="data:image/svg+xml,%3csvg%20width='30'%20height='30'%20viewBox='0%200%2024%2024'%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20fill='%23000000'%20data-v-7a837531=''%3e%3cg%20id='SVGRepo_bgCarrier'%20stroke-width='0'%20data-v-7a837531=''%3e%3c/g%3e%3cg%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'%20data-v-7a837531=''%3e%3c/g%3e%3cg%20id='SVGRepo_iconCarrier'%20data-v-7a837531=''%3e%3ctitle%20data-v-7a837531=''%3e/svg/ic-shuffle%3c/title%3e%3cdesc%20data-v-7a837531=''%3eCreated%20with%20Sketch.%3c/desc%3e%3cdefs%20data-v-7a837531=''%3e%3c/defs%3e%3cg%20id='Page-1'%20stroke='none'%20stroke-width='1'%20fill='none'%20fill-rule='evenodd'%20data-v-7a837531=''%3e%3cg%20id='ic-shuffle'%20stroke='%23ffffff'%20stroke-width='2'%20data-v-7a837531=''%3e%3cpath%20d='M2,17.9999998%20C2,19.1082887%202.89479504,19.9999998%204.0093689,19.9999998%20L5.9906311,19.9999998%20C6.8646376,19.9999998%207.8774291,19.4961382%208.39914483,18.7962726%20L10.5549209,15.9043651%20L11.0034256,15.3027099%20L10.5510882,14.7039309%20L9.28791415,13.0318115%20L8.48166843,11.9645484%20L7.68611114,13.0398025%20L5.78620656,15.607663%20C5.64814673,15.794261%205.23905036,15.9999998%205.00104344,15.9999998%20L3.99895656,15.9999998%20C2.8939935,15.9999998%202,16.8925469%202,17.9999998%20Z%20M17,7.99999982%20L17,9.00104326%20C17,10.4426117%2018.3902669,11.0239464%2019.4130188,10.0011945%20L22.0011947,7.41301865%20C22.7819993,6.6322141%2022.7833444,5.36913063%2022.0011947,4.58698098%20L19.4130188,1.99880509%20C18.393426,0.979212222%2017,1.5514083%2017,2.99895638%20L17,3.99999982%20L15.9989566,3.99999982%20C15.1354804,3.99999982%2014.1173241,4.51067434%2013.6048397,5.19673291%20L11.4612982,8.06627426%20L11.0137506,8.66540254%20L11.4619396,9.26405117%20L12.6968029,10.9134652%20L13.4938682,11.97811%20L14.2953367,10.916776%20L16.1921918,8.40489069%20C16.3390468,8.2104199%2016.7595316,7.99999982%2017,7.99999982%20Z%20M17.0007853,20%20C17.0004763,20.0002262%2017,20.0014156%2017,20.0066442%20L17,21.4736462%20C17,22.9303154%2018.4207045,23.510591%2019.4064778,22.4064533%20L22.0854405,19.4058206%20C22.8003941,18.6050206%2022.7640332,17.3498197%2022.0011947,16.5869812%20L19.4130188,13.9988053%20C18.3902669,12.9760534%2017,13.5573881%2017,14.9989566%20L17,16%20C16.760894,16%2016.3418715,15.789162%2016.1955096,15.5940128%20L8.40449038,5.20598718%20C7.88075638,4.50767518%206.86328205,4%205.9906311,4%20L4.0093689,4%20C2.89479504,4%202,4.89171112%202,6%20C2,7.1074529%202.8939935,8%203.99895656,8%20L5.00104344,8%20C5.23990997,8%205.65788701,8.21051601%205.80449038,8.40598718%20L13.5955096,18.7940128%20C14.1186685,19.4915579%2015.1311017,20%2015.9989566,20%20L17.0004762,20%20L17.0007853,20%20Z'%20id='Combined-Shape'%20data-v-7a837531=''%3e%3c/path%3e%3c/g%3e%3c/g%3e%3c/g%3e%3c/svg%3e",_imports_3$2="data:image/svg+xml,%3csvg%20width='30'%20height='30'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20data-v-7a837531=''%3e%3cg%20id='SVGRepo_bgCarrier'%20stroke-width='0'%20data-v-7a837531=''%3e%3c/g%3e%3cg%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'%20data-v-7a837531=''%3e%3c/g%3e%3cg%20id='SVGRepo_iconCarrier'%20data-v-7a837531=''%3e%3cpath%20d='M5%2019V6.2C5%205.0799%205%204.51984%205.21799%204.09202C5.40973%203.71569%205.71569%203.40973%206.09202%203.21799C6.51984%203%207.0799%203%208.2%203H15.8C16.9201%203%2017.4802%203%2017.908%203.21799C18.2843%203.40973%2018.5903%203.71569%2018.782%204.09202C19%204.51984%2019%205.0799%2019%206.2V17H7C5.89543%2017%205%2017.8954%205%2019ZM5%2019C5%2020.1046%205.89543%2021%207%2021H19M18%2017V21M14.5%208V7.91667C14.5%206.85812%2013.6419%206%2012.5833%206H11.5C10.3954%206%209.5%206.89543%209.5%208C9.5%209.10457%2010.3954%2010%2011.5%2010H12.5C13.6046%2010%2014.5%2010.8954%2014.5%2012C14.5%2013.1046%2013.6046%2014%2012.5%2014H11.4583C10.3768%2014%209.5%2013.1232%209.5%2012.0417V12'%20stroke='%23ffffff'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20data-v-7a837531=''%3e%3c/path%3e%3c/g%3e%3c/svg%3e",_imports_4$2="data:image/svg+xml,%3csvg%20width='30'%20height='30'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20data-v-7a837531=''%3e%3cg%20id='SVGRepo_bgCarrier'%20stroke-width='0'%20data-v-7a837531=''%3e%3c/g%3e%3cg%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'%20data-v-7a837531=''%3e%3c/g%3e%3cg%20id='SVGRepo_iconCarrier'%20data-v-7a837531=''%3e%3cpath%20opacity='0.4'%20d='M22%2015C22%2018.87%2018.87%2022%2015%2022L16.05%2020.25'%20stroke='%23ffffff'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'%20data-v-7a837531=''%3e%3c/path%3e%3cpath%20opacity='0.4'%20d='M2%209C2%205.13%205.13%202%209%202L7.95%203.75'%20stroke='%23ffffff'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'%20data-v-7a837531=''%3e%3c/path%3e%3cpath%20d='M13.6992%204.4502L17.6792%206.75018L21.6192%204.46021'%20stroke='%23ffffff'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'%20data-v-7a837531=''%3e%3c/path%3e%3cpath%20d='M17.6797%2010.8203V6.74023'%20stroke='%23ffffff'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'%20data-v-7a837531=''%3e%3c/path%3e%3cpath%20d='M16.7396%202.21L14.3396%203.53996C13.7996%203.83996%2013.3496%204.59995%2013.3496%205.21995V7.75999C13.3496%208.37999%2013.7896%209.13998%2014.3396%209.43998L16.7396%2010.77C17.2496%2011.06%2018.0896%2011.06%2018.6096%2010.77L21.0096%209.43998C21.5496%209.13998%2021.9996%208.37999%2021.9996%207.75999V5.21995C21.9996%204.59995%2021.5596%203.83996%2021.0096%203.53996L18.6096%202.21C18.0996%201.93%2017.2596%201.93%2016.7396%202.21Z'%20stroke='%23ffffff'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'%20data-v-7a837531=''%3e%3c/path%3e%3cpath%20d='M2.34961%2015.4502L6.31961%2017.7502L10.2696%2015.4602'%20stroke='%23ffffff'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'%20data-v-7a837531=''%3e%3c/path%3e%3cpath%20d='M6.32031%2021.8203V17.7402'%20stroke='%23ffffff'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'%20data-v-7a837531=''%3e%3c/path%3e%3cpath%20d='M5.39%2013.21L2.99001%2014.54C2.45001%2014.84%202%2015.5999%202%2016.2199V18.76C2%2019.38%202.44001%2020.14%202.99001%2020.44L5.39%2021.77C5.9%2022.06%206.73999%2022.06%207.25999%2021.77L9.66%2020.44C10.2%2020.14%2010.65%2019.38%2010.65%2018.76V16.2199C10.65%2015.5999%2010.21%2014.84%209.66%2014.54L7.25999%2013.21C6.73999%2012.93%205.9%2012.93%205.39%2013.21Z'%20stroke='%23ffffff'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'%20data-v-7a837531=''%3e%3c/path%3e%3c/g%3e%3c/svg%3e",_imports_5$2="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIEAAACMCAYAAABbPsqOAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAMLElEQVR4nO2dy8/dRhmHn9cnN9HcaKuqKmnCBkQjIRZ0gdh0BUIqiwhKWxHBAmjLAhawQWLFP8AGCcRtwS2oUlLKZQFS+wcgIVgUIZCgJL1IBbXJl9ICDd93/LIY+xzbZzwe+9g+43PmkUZf4mOPZ+b9+Z3x3CyqSqSEFP6t2f/bFpJYjoVb0FEEZVRViqHyswB/Al4FDgrhQst4wiKKYEmD4U5gDD5HRBFREBVJFJhjhNEmvnCIIljSYLBXRSQFY/xSEMmFcHfLOIMg2XQCQqFoJDFGrXK72ut6UBARAWbVn4pxhSqEKII2OJymGpf6wGhp6ZEogr4QSajzFIETRdAvkyzPSSY60i9RBJEoAhi31R7iG8Ih3xNDTPxUGbssa155FzhFEA2/HTT1gVirg9B7uCLdsdl1xRO4jN/kViL2h2qT5WazZ34sT9ch18nFEyPTxNVtraoiIprYfswvjgLYLmz2VFV7V2c0fhNaCCWCf+X2ahhGATRRLZ7pFVfVxuIxhCrAUeD3LMfLTw+VwIAR3ANEWvm7aW4CzwBfAv6BJV2LBmK1pVggAZ4D7sv+LyA7/trosm9YRSMCqpoWDl0CngD+WzwvbxPYBHAR2AfOgyRZCCuXo9P0gIfiAAxmwpixnZhh7ovAm8DDxfNEREVVkbJ9fwZcQEQCy9eG8SmMwJ8TQbP5hH8F3pMfrjYMrwAXIApgK1HEeAfeBfw0P1z0BGeAF7KTFlctCVzlozCdNkEzmgJ3AdeLIrgBnF7W/dUMTy2TETeqwGvAXflTfw9wql4Ake1DBLgDuDMfO/i6iIjfEgQtdpc9PUwCJ0vafEqJNj2MPnF/GDgJiGfDXoC/5YtP9soLKqiExQKLFLjcIuGRzfBZIM1XSbkDN3MRzD1OTrPII9PACMHHri1E8PpGszR9pBDGYq/ZG5D61Ukm2c8OmNhtZQZcx6xTPKiE941w/8fxaOV7TzQFftE9LTvLW0CCSFLpclFU/wAcwQhkKPZ8TmojAmti41xEg2X85RHAjLusjj7nG19cAh4t/dSxPGtGgL0EFvwkiClQY4CPiSSO8pUEeMgzriHRKIJBmUanW5vqwItdmJnk67L72v+jbm5gP7H3XB3sggBg3HzW3avPNMTqIBJFsOV42TeKIBJFEIkiiDDAK+KmqL4y7cqbSh9MXgR178uO9RSRCpMVgX+HzU6LwWum0yRFULeK2nVOvgx76LRNkck1DH0EUHcsjnjamZQIfAXg+i0KYZXJiKCtAFznRCGUmYQIugrAdW4UwpJJiKCKxagPAS8VwlPAxxuuiWQE/3bg0Qm0T3Uen3AG1QuYGdK3F68txhffGAwb8wRdPg1jMdglbPP4FmvzOQW8oyGOnWd0EdQZ3XbcYyudB8urqFcQ4BsrByfwNZIxGa06GKiH77j7Z5GpzPPbJKOIoGsP39DpihgGrw7W6eGLjMOgIuijhy8yPIOJoM8evsiwjPZ2sG4PX2Q4BhGBRwfPjzDr5IrhALjfcU1kIAZ/O7AY8+/AORFJSit0zErd3wJ3YrZkXenhG4t1xyqmRu+eoKGDJwHOURUAgCLZzpulD0+PWfiu3stt/hrM2GMHJ4Da/hs1PXyj77zexrjbKISxRXCvc5e0QBzurg09jz92MPYNWzLGAtDQmOR8gqFoMvS2CmEwEdQUWLCi8zXwNgohWKOMieOLL9Yt57ZNCDsvAotBv4LZ7Pu6iOxl/94Dftdw3WQJfnrZkFgM+X7gq8ns8LFU5bCZoJR1Ws1vvRv4I/De4vXb8Naws56g5kl+RiQ5nCpHQCUPqmkisyPHqUxVc8QzKXbaE1QQAJXZMbPjVHEZX5J3ZOVh8oYvsrOewEbWbU3Ntw9FZDs/BhZFsIplXuJWPfgrRBGUqX/S+9qUMECiCCKxYVhL8cnfzqbAgugJIlEEkVgd1LPlVUCRKAIbO9QegFgdRIgiiBBFECGKIEIUQYSRF6ROBpFl2AGiJ4iMLoLtHYqbMNETRKIIvGnfPtCpNCl6FcGkG4NOBsjWmlH2WdZjjx2kqGrtY9X3FE4Tn3eMqpoiKCRSnmgq2c/tphepyY01r1lW3/BI0+AP1tjVwZ8B5yQuLF/rcOwNcBm0/useqinwpC2+mnsj6L55PZxhiicrovTgP9k5viuWn8QhGjVp+41nXF3xs2+WzjmI1gYzt/5izfXiCpZLngfmIkkpfhFJMVvWnHfFX4lLsmvmJo2LuNTkiX1Xei1p+wJwUyR5k+RoihxSkkMqyewAswrpSMv4DkxeV8oy354nqYurbbDcG+BDiKRO28J8bRF05AKrexbtY/YibkuC2QKnuv/RTzqm7W7M0rMbwFuF8LWO8dn2Z3qVcbzwR/oWwVMjJDrSLw97iCAVVUVE5g0bRQM6J05CmRo3ETnlbhqrLg3f3BxJgE+snazIWJwHTnq9G+XVQanxUl8lpMCnh0x5pBc+h2l7ZFUBlWCvDn4AfKqxShBy1SjwL+DXlrO8Psi4Jpvu6Rwjjzbq8j3L/n4QuAcQRMR4gbr9N8jt+UouguPA683tgkpUG+wf3OSqsBC7gx09EpZjeQZUgYdzEYB5rZK2QoiETlUEJS+QArNia/805sNRE6PJJRQf2z7cR4BuwJtC2k21/giU65g3gR87u2GDw6vp2+Lcvu4ZErb9t1SBnwNXAIrVQc4l4NHSJ+aCxTeBQ4xMTZBlw/5l4Gx+OGE1RxeBR019oelU8xupopq1AT5DQQBgPEHd18cS4J/kH5c07kLC8g7RE1hZJk8LI5lXgE9i+g+WJ6hKaQTKsQvpBzDVxFnL75simw7s0zDU2nH9Trdl0VcSOi8DX6Zm3Gdh+y5fKt0weyx6wmy9YdWeMVKM+hvObRMW8V4eIb+DULJ5i7HpELhBNwE8QGmk1HG+NMW7Ev8Lo+S8R1bsrapTEcJ1vAQgRQMdkH9owymCxfFn6SaEa4Pnvidstk7A3hYITAwHwNuXHbZ11XGpOzTFdIBZ5vFJJSx4A3gM897skSwlS9NZAhdCnT1FpNh4LJ8ckHfYp70H2Aduq8Tjnjhjrs3r+MfYEo/gY8uVSSKuTZuHFoLFI+0Ds5YeYI7xAP/ukoTs7/eAGarfMqNxTS8CuUfQs5g2wrnSr+F4VGC1nK2DRbKcrDkaAQigyreBL3aoGu6l0lgMZRPsOrs6Rwzzi4bORCX+hO4COEo/Asj5Jq2EAAUhXC8f3ZwQGm3Ycj3FWni0M3IBdGkDzHDj0ya4UnPtE3i3EUrpeq1DGYzOaHMHalum5bTcopsHOEalO7RnvgN8fukRXHbL0yyC6XIvrX0I8XN7o4jAQwC30ZMAnAW6XlF/F3jcuE5Vy+tlgZIQZgQuhMFF4CGAt2G+jTysAPrh+5hZvJkQimmqMh0hDCoCDwGcwMxmmoIAcv4CnMFLCDlhC2HUPYssArjBBARgif8V4DCQuoVQzE+4QhhEBAML4Cgb8ACW+6SYBaqTF0LvIhhYANnTV3+vIekuhCLhCWHwnUosAtijvQD2MAJw3qsHGjtNehZCaXn6poTQmwhaCCDpIIA7mu41Jv5CyEOxPylHBFP+/2PDQuhFBC2qgEEEsIkuWUtvn0UI1isL/14I4RYbFMLaIvAwyn10qwJeZEQBZNPuW8fVkxBmbFAIa4nAwyjnMd8XbusBXgTe2fJejcl1/6gK/KopEg/jpJgh+i5thFvFk8fycL02DC0CeI6RBFD8f80Tcy2bd2+/vRlJW5mFZJuN7fmUdhFCPoBW6xGG8Aa2FUheVBNTSexJ4Ea2iqlwnk0E/XmAhjQJpoBlsbpKFvZPs8SVJtk0xOebtsqweBPNaenbQ/TiCSyJel5WBGC9MvvbTxXQYCTF1NdXUZ2DzlGdq+oc+CEtBVB3zJLmw8Dc3UYoRZrb5ET5cKOn606X+QQeY+HLLeXK4/V14+7XXPdoM+7ex3h92zg8z6/Mk6gP2XZ+97vu0zZPLoYbQLJqq/juDNnT8RI9NgLXbVV3uXffHmHs993hRNBY7KrAL/GYlNm2DuwqhBHE5yeEMad7db2fZ3XgcH2kmPXxtfH24fbaxNfXvT3juUpd1bDc2XXlusGmpHUVXUOCHqS0e1bJ+CnwtCu+PjPqE++GxHcVs2tcWpjQmy+b+6grznXSZuP/02ET02nrlJQAAAAASUVORK5CYII=",_imports_6$2=""+new URL("ht-B--TU9cs.png",import.meta.url).href,_imports_7$2=""+new URL("zj-Cd0qw3c6.png",import.meta.url).href,_imports_8$1=""+new URL("th-CDBoL7vv.png",import.meta.url).href,_imports_9$1=""+new URL("df-h6KSgNFk.png",import.meta.url).href,_imports_10=""+new URL("zx-1l_Qw4sY.png",import.meta.url).href,_imports_11=""+new URL("wd-BGY1Z7g0.png",import.meta.url).href,_imports_12=""+new URL("fx-BaT3UBw6.png",import.meta.url).href,_imports_13=""+new URL("yj-DH0mi9SF.png",import.meta.url).href,_imports_14=""+new URL("qk-BcI2fteo.png",import.meta.url).href,_imports_15=""+new URL("gl-BlGYRll2.png",import.meta.url).href,_imports_16=""+new URL("qz-CI2w7Jap.png",import.meta.url).href,_imports_17=""+new URL("ly-OUpVeVgF.png",import.meta.url).href,_imports_18=""+new URL("qm-CIv0Grkh.png",import.meta.url).href,_imports_19=""+new URL("tz-D4l8_2P0.png",import.meta.url).href,_imports_20=""+new URL("hj-RRlifxuz.png",import.meta.url).href,_imports_21=""+new URL("image114-DOx6jPJq.png",import.meta.url).href,_imports_22="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAG4AAAAvCAIAAACNPWhlAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAPAklEQVRoge1aaXBUV3Y+5963tdSLllZrbaQWDRL7IgHGRgLLltjKOHaIsR1P1Uxq4qqp/MgkP/JzpuI/qfk7ydRUUrZT48zYxsbG9hjwBgJsgcFGMqAFBoQkENpb6pbU23vv3pMf3ZIRiy3szszURN+Prla/+84977vn3Pud84REBAvIBNif2oG/HCxQmTEsUJkxLFCZMSxQmTEsUJkxLFCZMSxQmTEo398EEQAQACBiSvAjAM38mf4EAMTvP9efMzAj1Q4J656XgBAAmIL4p8iA9PTwR1jG7x6VRIQIJGVyemzq8sfSihERAgHesjYEEqUi7Oxgo1FYzdg92UytaCqK8d7xK6UEgJQdKSURcc7vNCWlZIwhIAEBpRyZg9kpUjPeeiMizvp569VvxfdN8Pj00PjRn7PuZpK3ejvnu2UnhauQfFW33Tub/qkvoVDoxo0b5eUVOTme1IDbaE2aZntHu2EYS4NLVFXt7e3t6empr69XVfVWs6OhsStXrhQUFFRWBEbHxmKxGCIjIEAESQSgKtzr9WZnZaUfIR5HRF3XJyORrkuXiouLS0tLp6enOecul2v+VHx3KhHRnBqMnPwFXW0GK8YAMJ1GCEASABCQGKEUUlh2EoUgxuesMWJkampgcMA2ba6woaHhtw+89dCWLStWrExRqKi8pLjE7U4/z/j4xMF33in1+11Ol+Fw9Pb27X/jjYICX3FJMUlCzlzZ2YZhKIpy/OSnodDoP/3jTz/44MOOzk5ALqS0LEvlCiLm5+c9tfevl1VXAYAQYv/+/b19fT/60d+NjI688sorP/7x34fDkf3799fV1+3Yvj3DUZkOH6AZsoAARHxi8OQvxaUPFWEC1wkQMLU1pdJKMpKASMg1IYHBXVKF4MTJk2+8dSDbyEaGQopYNPbx0eYTn7UAIUpBHLc3Nj7x+J6UD+3tHSPDIQT+y//4lWmaEkAQ/PrFl1TOhZB5eXl7n/yrNatX5eXkNj766Guvv97e3vHYnj179uyRtn32XNsbbx547pl9mzZuIKJUuKUSYn1NzWenPv/ww4+YoSoOh6rrhw4d5qq6csUKIYSizDfa5jGOgIiStjUSjiYFMgYkiYMUfUf5xFXmrQIAWzJAhogEEggkSBA2nxrQEkMMOQIAEOIdZzhRdDq6dHHwuWefdTpdnR2dnZcubdq0oaioCAHjsfj+tw5EwuHU2ImJiba21oqKRbt27UokE4mkiQgwsxuSJJfbXVkZAIDp6Whxccnzzz/v83o9Ho/CGBG5XS6GmOPx5OXlzc4fjyUOvvfezZv9fn9Z/83+/qFBTdUOHzpkWabDcPzud6+uW7u24ZGG2zaQ70ElAkMcG536hxd+29w5zLkqpAiWZP37P2/f8rcvWTYRSEAGacFDACSBmZGB5NF/k5evS82RVkJ3yxRD0/Lz8ktLSizLPn36dDKZLPf78/PzASCeSOTm5BgOR2pkV1dXX1/fzl27XC7XkSNHQuMTjGF6UyGSEjY/sKl27WoA6OzqeuPAW319vS/8688dDsdQOJzv8QACIsq5s9vC5gx13cjOdg4ODcXjiUBFINvpdiIRoJWIE5AQImNUpuQEMkxgdhRcABqgPU0OUryIbk29bXD6UyqJhKITA8R7ChHLtj05OVPRaHd3z8X2i13dVx9peLin73rf9RsMmWWbWYbD7XJLkkBUVuYv9Ze3t3esWrni8T2PxWJxRAQCQCACRPAVeFNmN26oTZjmyy//BoFfudr9ny+9+NOf/AQBpJThcGR8fByRud0uznk4PCGE7TCMuGlFYzG3y+XxeBRFmZ6OqZqa7XJNRiLhcLioqCgzVOIMOQwREFL+MwC8XWDMDgYAYCABMKWO5tB8C+LxWCgUutZ97cyZM6FwuLi4uKuj88L5dsu2B24OGJri9/sTyUQ8nsjOylq0yF9QUDAeCkWj02e+PDcWCqWFKgGBZIi1a9b4/f6UZVVVmZK+agpbCIGApmm2tLS0t7dXlJfv2NHkcbsdDkegoiIUmvjg6LGpyUhj06M5Obnj4+EzZ77Iyc1p2FZfWOA1DGM+PM6LyhQ/LOU3AiCA/JYbvr4vXQEQEN15m8fjefKJJ3bs2PHq/v1t5y/8zd69SxYvtizri7NfvH/4cFPjo9sbGxWFpx5GCCmlEFJyzl1OZ2w6RjMlFhAgIr8lDUlSWpwhcEynBufc5/OVFBcXFvoUrgCA1+vNdjqPHmu2bdubn69rmmlauqrm5Hhi0Zim6atWrcoslXBLCNJsdH2DRiAAmaoxCJAYAUmJUtKdAp1zpqmKaZpJy+zt7SkrKpyIRFpOt6xYXr17186smY0ybRVBkpgIh69d61UV1eXMJgJiKGwxMjJy5Wp3TU2NwzAgJbaBZh1lgJJI0/T6ui3r162dtTg4OPj2u++2fXV+S12dQ1cPHzrEVK2xoWHp0mDziU9ffe21G309TU1Nfr9/PpLoO+lKBACiuyX4nQMJADBF7N2DWdf13Tt3qKr28SdHL5y/OB2LOp3ZTz/99FweYWZKNjAweLX76tNP7StftAgAkEHStI4da77Y0bV7cjJFJRABAqYLHkCGCChJmmbyVoOWaRYVFv7g2WcfeHDzmbNnDUf2rt079+zc2XHpUtv5C8uqq4qKimzbnmfNc59U0tzt7xuAqdMcCUhKknDPclAI4S8pWbt6ZWdnV+eVqyojf2nZl+fObVi/Pi8vT1GUr6s8JCFsRDQ0dUmwstDnS/0sSfr9Zb19fQizBR+gJNNM2rYlbHs6GovHEyRlNBqLJxJSCF3XFUUpr6gor6gQQhw/fmL/wXcqy8u3PfRQMplMJk3GeE1NTf2Dm+fPzX1HZTrQ0rvmPccAoZQcCFDEk4WrsopW37WfZwvR1dHxybFj3T3Xp2PxvU8+sWRx4HRLy5sHDrScaqmtqWl6pNHlckKq1QSShKnqmiD41a//K10FIQohBvpvFvryjCxjxgGpKcrL//2b0pLSZCz521dft4UtpHz3/cPHjp/gnO3Zvbu2tgYAIpOT773/XvPxE5WBymee2tva2tp6/kI4MqWqqivbeV/MfIcEx7Qwhq8bELPXZk4ZRJISSEgTSmpdDT9zlay+Mypty+7p6705MODz+QqLi5dVL1teXa3r2oqqqp6enp6+Xocja2BwIGAENFXlDLfW1SfiyUXliwq9vsGhIZKpCgsBoXb92sqKcpcz/fDV1Uuf2fdUaHyiuLikbsuDo6OjnDFVUUzLsoXNOSso8AKAsO2+3j5dM554/PFNGzf6CnzT09MelzsvLz8YCCyvXnp/vMyzyTY4Ov7DFw5+1DGMXCcplhTpL/3Lnro1ASKJwGbPorQ1xhLh/omPf5YY6fE0vZBTWcf4XWKYiCzLklJyzhHxthIt1acRQiiqymbaTXOWI/1TetbUUqU0JgBImaqvZrs+cmbInIU3TTM1daobRES2ZQMDhSuYigcAvHdD61bcf1QSgWREPGlOxxNRIQUApIVm2mMAZMn4lOmrca97Njf44L02gtSTSSm5ohBRNBpVNY2ktG1bVVXGuWmaCuPCti0pVVW1bZtzZlm2bduKojDObcvmDHXDAKJEImHbQtNUIaQg6TAMIWQymUQATdMkSU3VTNMCRMuyAEBV1dQhb9vCtGxFUUBKrii2sDlwiTKRTHLGNE2bZz/jPqlEAGDAYXgq/ov/OVvkvijTvTWZihgiJEAJmKXazz1a2xCslcTudfolk+Ynx461X2zfvmP7yMhQV1dX/dat3VevXe+7XruhVuH81KlT69bXMMTR0ZFtW7deunxZ143ua93xeDw/P9cwjD9cvlxdVd3U1BSJRN557/fT0Vhtzfru7u7h4eF9+/a1nmsdGBriDCsqyhPJxNa6+paWU4zzC+cv6Ia+bNkyM2nFYtH+/n5d16uqqgYGB6qqq08ePxEMLi4tLf3o6MerVq18uH6rc36b5v2e4IBIhDCVwE/aIwARYBIAU001YADEABAEubJp26YqAP4N570QthAiuCTo95ddvnypuLikpLjkzOdfFBUXB4PBrq6uqurq5cuXn/ny7JlzX+qOLE1VWk6d2rRx47at9YD49sGD69fXLKuuBoBkIhmLRRdXBr3egt7e3s2bNxuGcXNw4Ol9+zxuV2tr68X2dilEOBzWdd3ldjHGBgcHOec7tjc1Hz9RVVVVVlbW9mJbRUWgPFDxwAObL1++pHBlaXBpliNrntzM9yUBIRFIAJbq7wNpoDBQGDAVmIJMR6Yj6MBUYBy4ogNLFR/foMgYY/FYvLWtrbe3r76urv/Gjebm5h07moaHB998801b2F+0ftn2VVtebm5wyeLOP3R1X7vGuYqcxWKxaHQagFo+++z06dNAUFjoq9uy5eznp0+fapmcnDx54vjw8HCO2x2LRicnp6QUlmXGk0lL2MjZ+YsXJiIR/yI/IgohQUopBJGUKIWwOi5e/PTTk0uWLK0oLz9y5Mjo6Og8KZp3VBIKspm0ABREASRnFPecoEvTJoEk2t92oBGAJ8cTCAQ0TYuEw5WBgMPhCI2NBQIV4XA4K9sRXLw4J9eTSMQ3rKuJxmIXLlx8YPOmsdGxU2fOMiRV1aqqq70FXgIyk0kSIhAoz3LobpfTl5/vdmYB0ldtrYqiFBQWRmOxrq5OxtHnzW9oeNiy7N6+6y6Xk3PmcBiaqiCC2+VyOBzBYLDcXx4aG3M7XUpZWcZfSBBjrLLMG0qApuiSzZ6dAECYqunSAwkAhaQ8lbwu/ZuN6pq+ds2awgJvrscVi8WLiopWrFjR39/v8/maHmmMxuMKMoemLwlUOhwOhyNrWVV1Xm7OyFiot7cnEKhAxOt9fZxxRCBEW4h169YFg8H+m/0jQyOqoj3+2J6Ojg5d16uqqw1DHxkebtzWYDiMiooAEoQnpwxdd2Znr1692u12OxyOhm0P5+bmIiBjTOHc5XKuXLnCN1MIfCvmJYaIKGma14fHoqalIpMIeMvOgHMjk4CIiAOU5ufk5rjn6cdfAL6dyvSr7bmKbN6gP8p70z8LZOY9+AJg4R9dMogFKjOGBSozhgUqM4YFKjOGBSozhgUqM4YFKjOGBSozhgUqMwa2UDZmCsrNUKzAY/x/aTn8nyFu2v8LvMIv+ITSbJAAAAAASUVORK5CYII=",_imports_23="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGcAAAAtCAIAAAA84OKkAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAPLUlEQVRoge2aeXRc1X3Hf/cts++bpNFII2kka7G12NiWNwzGEGyM05K2hHCCMQ0QaCElTZM2dU8PSZOcLBRCCEshp0nAFHMwTmyMwfEiGy8ylmQttkabJY2WmdGMNPubmbff/jGyLS/YRicnbc6Z75+jufN+v8/9bfc+IYwx5PU5RfxfG/BnqTy1+ShPbT7KU5uP8tTmozy1+ShPbT66WWoYID/YXRR1/T9jwKKEWUHOsrwgSQhApaC0KpoiSZJAfxoT/zTKxQS6OZ8+ixoGjCSMQ8nMEe/0RIiT5YwvwsUZbFSjCqtqcbV9+QKbUaVACGGQESAEf64QL56OEMIAgDECwAgh+GyPPosaYkWptT+849j5eBqcZnX3ZOTUUELIyICwiKTyYsO9TY4H15YuqygkEEZwA2gYY0CXNhIDYBkjhG5ybzEA4JsNhM8ljLGMgSQgmxVSHG/UqpQ0Cfh6yACAfPbZZy+shwuMcYaT3jk+/JP3zylp8m+/4Ilm2Jae8NIy3aNfKLt3haux0jSd4A63+7t9EafDUOEwEAgwwBUMLuyhzIpyfyDBiVinohAAIBRj2C5fTMLYoKFzay6uza269FMYA4JIip+YznAi1qsohPBcl3LfFyWc4QRAQCICABDgS/bMOWlfbiGWZDQQSHjHp4ss+uFA7KfvdSZYVFdiJskb7M8lapBzHLCI8VtHh59/37u0yv6Dh5dEGP7f3/YuKTX+ZOuSdQ0FelK8q7FkQ0NhU6V9xJ860DlWVqQvdxiusumikHci+fe/PNI6lFxQqCmyaBFA+1B4246eNCstrbAoafLqhbNJgmUAAET84cz4997tPdUfvKPJqaIvyw+EEELovSN9/7mnb3gqXmzTm7V0jisChAHwnJZ38UHpLM8JciCR+Zdft24/6Q/Ek33+6OGucbdNu6K2kCJv0CQvWYABIwQA2Due+OWHZ8udxu9/9ZYik3LnMV+c4zaucC0stcqAD/d0a1TTj21cXOOyNC9wfOeNE8+9e9bztLnMobnSc4QwxgiBQUsRNN1ydnxjvW6xx45BphDpn+ZHQ0lRlgHw7H4BxgAyxgQiZj8EBACcIPrj4umR8JoaM3yGP8Fo4mR/5KOeqdNDoVefXFdoVGJACGNAIMtYxDJNEGhO+zrQMd7SO6XQqQ/1R5Osom962K5GD6+u/NqGWiVFYIyvXzsuGYEAAcicKPzm4FA4KTy+qarIpJQkWU0Dibh4ludEWRRxlKf3dYWjaZblJbdNs+3BZRlJeOtQj3zVYIIxBsCyjN0W1c+fWPnzx5bdWl/KilKSE33+qMjKgSiT5cU56YaynPDpoH8wnJQBEGBAKCXAj97veGFvr4CUoURmcjp1LS/w1o1Nv/n2uhKb7miffyyaAsAIgJPkSJrf1Tr6+v5z/ngWAF000WTWHO0Nvv6HIIMQRQMWiFSWsGppu1ELKFd3rwNtTqwhAADUF2D2nAlUu81rFzmnkplOXzKQkpS0avuhUZFDapX04Rk/pVC++GFfksEaWr6t3vHIxsrdJwaGw+mqAt0VuyTJuOd8oMrtWFxqbnBZAHAompJBXrei4qFoenwmlWYFGV+qvQijU/3TrYN9P9jSXF1oBICxYORU77Q/mtm0zLO43KRTK3IbAgjNVmIAhIDlIBGOP7G+RKspqy40YQwj0/GdJ0aPnJ3qnWTKHVRDhdVl0V60bE1N4b995ZZvvNFBiESdRx9JYEbg7HajKMoURcANmsFldQ0Bgp2tvt+1he5aZNjQVPLGvs5XPhr6pHeGkQRMUh0jzJmRQIZXjUfSnWMJf4TpGEsdaJ8o1oHW6gCer3db4fLqlsiKX3vx4FgodUdjWTSV8k+FSgqsQClePzJ+xjsciiR7RqaaKhwGnToX8xRF+hPi3vbR+jJddZEVAGwGdZGF6ptM37fSZSS5eDqzwGkhEAZE5KYdBJgR0e9bOheU2zc3VzSWWVQU7Y+kfru37cRoav/ZdEmR4cdbbrm9zolzJDAgBH2jYYRYl9PYPRReXWMRRKHXHy8xkbfWuZQ0gW7UsOfWNUCAhiaSEtC0kuYFcU2t42/uWPKr/QPbW0afuadqZa1dqST/a/fwnk9939xUtXGpKxjlvv8/7W+3xtfUkAklC1B1oZblWiUE4umuoCgRTCjB9g36yl0OiqLPeP27Ws4+9cXGcrvhqdcPdo4nXA5jrvfJklxmUXzny8tX1RbmQgoQeMPiFJN+fs/ICo+5Y7BvTV2Jw6gGDICwKOFEVth1OrijI5UlIw6DwmUzirIQCoQe3dy8NpI5cu5gKq0MRDKChBUkYIxycfpBR0CQZB7omEi+fTKMWOr2WsfWDXUGDQBIgG6yG8xWJcRwgp6Wx4NxEtGrF3oA8K21jjcPjYq8tLLCDgAZvs1RoHpoXWWRSV3vAklq3PqLzmPnwgtdpVf9ODrnmym2Gp++p2Y8FBEIVZmzEAC6/NnBGXlgIlZsVCJS03JuZkGBrq7URgDIGCspotahtaopLGNEoP5gfPeJ0WXltlg0cteSyhNDY4Eo4zBqMGAEaHIm/rNdHbvapkMM1TURkwX28Y2N8VRWpVW67PrJGKtVayZiwjtHhxrLrA0lJpSbYQELJPnC3hGGk+0G2LTcIUuo7Xxy3+mgfqXColchkCiSyPV2ikQkQgBobvGZ08UxAAK9RlxaZWkb9L/08cADq9yIgOPeEMOzvCz4QkmKoiitjmUjg6E0SaIUk6l3mypdivbRuIK6xsA84Itv++sqo54+0OX7xy+txBjPJNnekSCTzLx1dPjsaHQmKbV0Bk0K7l/vN6lpiiLJWEbuHA7WlpgpAgBg+4Gxdt/MohLroB8HftcLEpFguIvmFpgNX2yuTnHUx52BpzY3PLi+iue5CC992BVRaY1AYCzwjSWmb91Xv8hlxDA7aYuyvK6p+MO2QH8w/vDa0m33L5uMZr+7o+d775z9fevkIrdZo1ZYjZRDT1jUyqUVtiqn8Yp8veBqLrMAF9vNEiFSYH5uV8dH7eMamu7wTRMK1ZG+2KlzraKUiYMhHM3+8N3uRo/VpRfvW10riVivURVYFBd+afYJEoY0L4TS0ss7T373oTVKCo2GE9sPD/aPRpdWmeMZzEqKagf1H1uXLSoyKikyl9SyLJ/2To4tL/UUmgBghklJSGU26sggKwlIBoKazR6EZaymibuXlLidRgnjzY2FKiRHUlmSVv7svY4IwzUvLGJ5rFOrlQiS6axBoxIlKZYVWoem3mwZmkkwTouq0lP8ZsvwJ33h495pGakiGeF0vz+ZJrQqwaKHqgK7XUt5Cg0EcVm9ntNDEQCgFQuKWna2bbmzrtCg7AlyjEg0lhcO+qOjgWRjmZlJS2dHwjYNXWxSiiy78Y6FMYY/H4i5neaGMisAzAljnJVw21Dw9KHAPYts6xuKOoann9/dOTnDPHPf4sIC/T/9d8ehM+MP3O5uLLbq1fRFM0ptGr1Re9YXqygwAkKYkDQKcmiS4Xm+dIEjFJ5x2kyzFQ9dGGBlWFBuIQF5faHqsiLgRYVC9ebJwOnRBAaxbXDmG6+FnthQ/dU76/rHIr86Mn6oe8RhUDy5ubZrMP6j7V3JdLqu1FJmN6SZyKalxV9ZXZGIZfVqRalD7bTqqAvj27UzFGOMAZrcpgKDrtcX++njaxOpDAlkr5/54Y4zX2ouefLeuhDDPf3KsXMTzLYHGisdBkmWX9zTw/DEumrjwtKCObmOAeB031SPX6h2GL/5l4u6z4f/eXt7ly/yzOaFt3hs/VNJi45sXlhgUlGiJOdWyViOJPnxmRQP5K6TI7d4TFazMZmV1lYatt69sN07emokxXK81aAWpNlpikSYQCiZSnSeZ2KhgS3rPXoN8akvluRBRsCLwuYVxQVms0NLm3VKLMlMlh+aiNzZ6H5qY1Wty9ZRGwn+tqOxxLnty/UHeqefeu0TDY2aq2zklZXmyn46J9YIhDHolfTWO+u+/etPi226R9ZWKmmSF3GTW1VsolUk4TaqaxzGU/3RDC8BQCDB7jo2XFdi2bKuOjd45/YEAGcx8dreHk4mv/UXFQ49/chLrcf7k2aj+lD3xAlvJMJIiOCaq+18MiVIUm4inoikf/x+z/H+eCDBiKxkUHuXVNrGwhk1RUQTqfJSe1coHWHSrx/0lppVGEs0QdSXmKpKC6ZiUuu5lOChXHYdgWgFJpbVFKyqdmy5rcysV1h1SpKY5bC6zvnq17UOs96gUQSi6T0nhpMZ9o7FRZFY4nDnhEmrWVJiIGdr5hxmF1y7FjVAuclxZZXlzqai53Z0TUxnHrq9ssKmeXJDXZrFWU4Kp7Pd4wmjTqtT0pEM+/K+gSlGfPbB8oYy25xnIAAkiMCw7CqP/p7lnmA07bCqNi0la9wWp00XZ/ju8djAJPtxR8CtlWSMATBCRDia7h2dIRSa9YtcxVaty6TQKYivb6gZCqW7xhkMuNio29zsGQlnWR6TgE0askaWAECv0az0qB7b5LEZFIBhVU3BLx5Vllp1Ro3yihghKaqy2JrDsvv44Au7+4EkX97fn0hmT59P3b/Kvb7JNZst1x1z0RXv3nNHN388+9Je785PBgsd9uUefVOZUac1BGYSB7snWgcif7e5ftMS5yv7vG2DoX+4b/GWtW4FSV0xF8oAXedDNE0tcptlGYVTLJ9l7SaNRqUEkKcSWe9EcigYL9BRdy+tUNMkAKTSnC/EAEU49GqjmqKViEQkAHASjqd5ThBpklRQSJARRQBBIJokNRQiSZRMC9OxTLFdrVJSGGbvX+Z4dOkSZW5tauub+HQiy6S5oXD2cNdYjdO07a8a1tQVAJbhupdr16AGuWM8oESW/eCU/9UPBnoCEZVGrVLSmUxWpUTrl1c3FhJH27wiqXv83oZNjcU0eVUd+DySMQDAH+Ni+AYBcs0FgiQnstLYVNyso8sdBoK4qVcC16aWO1FIGPr88f3t/gNdU33j0QzHOe0aT4GmyKhZVmu7rd5dbtPNvb662TvG/wfC+MY3qdfRtajlQjp39keSIMmpNI6l2SwvAIlUFGXW0Ca9mkQIsIznPPnzUpvNl891Y/9HEs7dc8/55IrZ4vq6BrW8bqj8+9D5KE9tPspTm4/y1OajPLX5KE9tPspTm4/y1OajPLX5KE9tPspTm4/y1OajPLX5iLr6v1ryuqH+F7bqd/EOGaMKAAAAAElFTkSuQmCC",_imports_24=""+new URL("image117-DuT_hU5d.png",import.meta.url).href,_imports_25=""+new URL("image118-CceRgO1W.png",import.meta.url).href,_imports_26="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGgAAAAuCAIAAABLf8uHAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAObElEQVRoge2ZfVCU173Hz3ne9u1Z9g0WZGGBheXNlRdFQMVoNCgmvZE40eTG+9LM7dWYzDi1007qdJobc29up9M2NTW9taZt2nHGSOLFVIlGm0YjCARBICigvLPZBfaNfX953s7949EtIqKXuS/tdL9/Leccfuecz/k9v3N+50CEEEjovy/s/3sAf6lKgFuiEuCWqAS4JSoBbolKgFuiEuCWqAS4JSoBbolKgFuiiEXq7mRjEEJwNy1DAEAolkMI/9dH92esxcCJcASOFwQBIQTFAgKHGAb+6jPchcGJPoU4zhcOui51+wZGI/4AhJgsVZu0sii7woJTJMIxCBZzOo7j/H6/XC6XSqUL1iKESJKc2+NcL55bghDieR4hRBDEPE9HCMVL5v5+UMnCQohhWJzAxR4x7OER7IEex7r9ox+cHTp1nh2wMojBwlGAACuXY0nUcFVpwQs7jE+sxShykUHxPH/+/Hmv1/vKK6/cN070+eefu93uXbt2MQzDcdzU1JRUKjUYDH8aAMsihMQ5OJzO24ODntnZ8vJyk8kkWuA4LhgMOp3O3NxcnucFQYAQkiQJIYzDCvj9kWhUq9XGV0hcABzH421YjsUx/N133934+Eav16fTaQsKCh6Kez44BABEyDtp7/nXXzoa/4gUuGHHZqCjp975UKJJKn31GxMXWtxNba1/7HId+Iey/V8npdT9RgVBEKeh0+m8Xm8sFotGoxiGKRQKEQRCqLPzmsmU63K5z549AyHs7u4uKCx4ed/LcSMnTrzPsowhPZ0XBJwgFHL5jZs3W65e/elbb4kWGhsbR0dHHQ7HwYMHm5ubR0dH1Wr1zp071Wp13IjD5Xr/xInnnttlMpliMYZhmIGBAY1GU1RUFOd46dKlosIin9/n8/nOnTtXUbHKbDbjOL44OPz111+f+zcEIOqevfHvvxo+3pS2bd2atw4W7XkuIJdEPmjBNZqqo9/P3V6rMmV6Oq5PfnoVJCmXVVjmbRMIobGxsba2tqGhoa6ursnJSZfLdeTIkY6OjpKSkqSkJACA0+n84IOGWIyx2+0TExNJKpVWqzXnm0VvEtXb21tUVGTMMl6+dGl8bNxisaSlprlczg0bNogj7eq6bjAYysvLs7KytFrt8uXLi4uLg8EghDAeHLRabVVVVUqKvr39i4aGhlOnTimVSqPRqNPpxAYYhoXD4Wg0Ojk5OT4+npeXu3379rh7LqL5HzNCyPZZ23jDufSa0rJ/e1lTXcqzLBcMBSDHYALjD/AEzNz9VNWR1yiF4qsTH3t7bs3zaQih3W7/2dtva7SaioqKtWvX7ty5Mzc3Nzs7W6QmCMKFCxeqq9c8+eST62vWy2Qy6+RkUpIqy5g9145UKqUoCgLg8cwWFRWtXLkKQKhQ0Hd7AenpyzAMCwaDt2/fttlsly9fPnny5NGjR1tbW8U2LMvabDa73c4wTEVFxb59+zIMhp3PPms2m+O9MAyj0WjOnDnT2dnpcDhwHJ+YmHgoNXD/pxq0z4ycvkjIJcXf/Ptkc667Z9jV2jnb/SUe9ZMz3K2j75MZaYbaddonakoOvtTz0vcmP/okqawAvzeamnJMK1asKDDnd1zrdDgcFy9epGl6+/btSqUSADA5aSUIMiMj+fDhw88//7xMJsMg5na7pqbsRmOmRCK5s6QYhuO4SqXWaDWXL19Wq9UajZog/vQFQQgjkbDb7YlGozqdrr29/dChQ2qNhiJJAEAkEhkaGjp58iSGYfte2ud0OQsLC+UKRWtbe36+OSMjQ/SSyclJm83m8XgsFksgEBgZGcnKynqULeVejxOQ54sb45+2G7Y9Zti8JmSdaXn1h20H3vT8/opEo8MIqu+nv73y8r9c/8lvKADSa8rTylc4O2/6bPZ5RtVqdWFR0dXW1vb2ths3boZCoa1bt8YDP8MwNetrCAJPT0/nWI5jOQWtwDBsdnZ27jcSiUQikYjAC+np6WvXrh0ZGfF4ZgVBiDfgOG7Llq0vvviiyWRas2aNISPD4/F83NQ0ODgIAAgGg36/32Kx1NfXq9Sq48ePz87Ozs7ODg8Px18LIIS5ubk0TWdlZW3btq2urg5i0Ol0jo+Px2KxxR8V7vE4Phz2X7spCzKq5bkYRd1q+SLa1Z+2ucqwqw6TyQkBpIZ9Xa/9LHJtAACgycnSrF052PRZxDoDMjPm2lHQij179gAAMjMzbTZbfX19vAoBkJ9vHh4e8fsDJSUlq6tWe33evLy8zs7OsbGxrq6ukpIS0ekcDodGoxZ4IVmrI0hyxYoVX37ZJwh83FQwGOQ4bnp6+syZs2azWSqRAAgHBgZu3Lz5nW9/OyUlJSUlpaOjQ0RsyMiAEObk5OzevZtlWY7jCIJACPX39/f39wMAent7r13rsKxY0dzSfPv27crKylWrVsnl8kcDx/JhlxsnSVwuBQDgOAYFIc1iWb67HiMJAAATDPf96D3RGJRLpVkGr9cbng0saBohFAqFIpHI/VV5ebkOx8y5c+fM+flOpzN9Wfq6mnUNJxv8Pp9Op8vJyYEQTk1NURTlcrkLCwtZjgsGg3a7zefzx40MDQ1VVFSQJFlXV3fr1q2xsTGdVrt///4bN27EHdNut/f19en1eofDcf369UgkfPHixUgkbDKZKiurvF6v1TqZnr7M7/dXVVUFAv6y0vK9e/Ze67zGcRzHcQ+iNh8cAABIKRYJAhdfWMSyDBMME3IpBIANhSFAHI/ugIlFIYFDYrH0Y95hMh45ZqanCwoKUpKTBwcH01LTqqqr3nzzTavVqlQqxRBTVlam1+slEgnDMCzLAgAYhiHunhIQQgUFBTKZLDU1NTMz88qVKyzLSiQSmqarq6vj3dlsNoSQXq835eTI5PL16x9jWZbneYlEyvM8SZLramrGRscMhgye53t7v9yyZSuGYVWVVYvMaAFwuJSSZqYyLBubDQCE5EolSSucLe19PwARhVTGIzYS4lzuWJYRAMC5vaGBcV1amjxFtaBphJBKrcYegPXxTZvUarXP53vqqadqa2tVKhUAID8/P95gx44dCoVi7r+UlJQ4Zhx3FgDCr/3N18TTFkKouro6JSUlDv3uAEBdXZ1en6JUJi04BpqmY7GYyWSiaXpoaOiZZ54xGjMfiuzOAO4JgQjZm7vO//OrhuLCDf/xBp4kvfrGOyPv/SfwhyUYRvKYG+Nky/SVb+y3/F29rbWz42+/k7yuovTt7yal6BYEF4lEEAAKuRwAgAC6m6KJPd7JpeLpwf+ZFkrvwNxd9FFuMe51Bwh1loKi2g0TDResl9rNz2+r+u5e88bqiUvtnl804hpl+et7ZXlZ6etXRpnYaHOH7yu7ZWUhfR+1eOYgl8vjyZB4U4BhGIZBjuMxDBMEQYzQYhoUT0vjP3Ac5ziOJElBEMT2EEKe58VZiQ3EcIZhGM/zOI6LXYgzF9vHcxUIIcdxYkKGBAQgQADAu1Vx3cnTH3YiuQccAkCiVWZuf9xzunnwx+8RGSnZa1ZmbNsQTJK4f/uJkKwyf70eI0k2HLG9/8nUj08mP7lWt33D/d4yNTXV29Or1qhzcnKsVqtCQSsUipmZaSQIJpNJpVY3nW0qKy+7PXS7cnVlNBq1fWXzeNwZmZnRWDTgD+hT9F6f1+/3r1y1qq2ttbqqOhQKpaWl2Ww2tVrd19fHxBh9qt7n82Zn5/i8XpbjMjIyenp6iouLMQzT6/UzMzNqtXpkZCQ5OdloNCKE7HY7RVGDg4MajUZCSaxWq0qj9vv9arUq4A9AhHTJyWnLlimVSqvVmmk02my2LKNxEbebH7kRAKkbqjK/94+M3dGx57Xr7/wuYJ/mIzGCwIDAcaGoa2D4yms/+eKbP1DpdUUH/klrzrvfqM/n++zyZx+f+7ixsdFut09PT/385+9MTU3lFxRotFqEwOmPPgoEAsPDw6c+/FAmlXI8d2toiCTJ613XtVotTuA9PT1NTU2hYNDn9R0+fBhCOD093djY6Ha73W63Z9ZDUeTV1taGhgaO520227Fjx7xe77Fjx5xOp8vlOn36dH9//9jYmMvlQgg5nc62trZfHj3qmJkpLi4WkNDc0tzT3d3S3NzX2+fz+ZpbW39/5kwoHB4cHPz1r34diURGRkZsNtsiPjffXSAAFEUV7HnWdOgbBBJufv8X5+v22n50PBwJgBlPy75DDbW7HccayVKj6e1v5W6qud+ieHOnpJVIQARBiPu6UqmMxqKRSES8ucBxHMeJui11LMeNTYwDCDAIIYRSmYxl2XAoxLKsTC6jKKq4uGj16srz58/jOG4yma5cuUJRFEEQBEFiAJPJZLFYTECCVqstLi6urKzs7u72+/0EQUxMTIjbscPhcDqdOI4paDoaizEMQ5KkVCqlaRpCiADief5bBw74AwGb1Qoh8Pl9n/7hDwSOW63WB2K7P8kHACBBwABmWF2eWlXqCvjJSSdvnUEAQIgxdociLdWws67uyCGdpWBBiwghl9sFIXzsscc2btzo8/loBV1fX+/3+0eHR9OWLaMokuf55ORkqUSy6Ykn5DJ5LBbTaDTpBgPHceOjowqazs7OLiwsDAVDBEFs3ryJpmme581mM0mSGo0mNTVVqVSSFFlbW+twOJS08umnn3Y5XevWr6NIiud5i8XC8zxBEOFwhONYg8FgtVpfeOEFl8vlcDhUKhWG4QZDekpKisFgkEgker1+zZpqluVpmi4rLXV7PLSSLi8rXyTbv3dXnTN98ZYcIDQ7MDY7OMJNOSGBS/KM+sJcqUEvHuQWv8j8s1IoFKIo6lGuPUR5vd6511P360HggHg5vuDWcmcz+osC9z+uB4OLC4H4W03iUSyuxR9r7uqv17EeqEcAl6C2kBLf3hKVALdEJcAtUQlwS1QC3BKVALdEJcAtUQlwS1QC3BKVALdEJcAtUf8FnIEPu7WGo1EAAAAASUVORK5CYII=",_imports_27=""+new URL("image120-D32RJFda.png",import.meta.url).href,_imports_28=""+new URL("image121-CyI9gBKR.png",import.meta.url).href,_imports_29=""+new URL("image122-BRvBI_xM.png",import.meta.url).href,_imports_30="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGoAAAArCAIAAAAfR4oJAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAOPElEQVRoge2ZeXDUx5XH3+v+zW9+c49GGiTEjZAEAiQNOgCvbTC3wa7d9RZ2fMVHwPFWjO2kEhcVbLOJwdnElThZr501W7vGOCFmzXI4YEQwBskEnVzC5haMRjO6RuiWZn4z8+u3f/ykQQYMAmVra2N9S39oRt2vuz/9+vXrJyQiGNbtiv1fT+D/t4bxDUnD+IakYXxD0jC+IWkY35A0jG9Iuh18w6liXLfpfcMEdd0yPuonN0wQAKRBttNhCRAIiAQEgAgEiERAAIDfzCh6S4smjhhVVf/xqo7ai0ITQlW1aFQACAASpKuv6aB9c2BLoq8Y+Qvqf8nsYL0PEYGgOypqz9c0v/W21N057lsPt1w4L9us45fer4wew5kEAESAeGXGgPFPQ9XAxd+q1UGC05vdkvGb4NMtEgADUAUd9DY3Hj/naWvqOnrUe/oLiEYFQMsfPx799Iqxi5dKZgtwBOB6x1gshowZpOsMEV8NaVqcNyLqvYTQGOOMMc75wF6aphGRJHF9X/qhIAIQXBcQ6kNpmoaIjDEAAkAiinePxWKapjFExhlDjgz1yQ8S4k3w6cMgiBjAvgtNvyz3P9Ab5eEQ5xKqIUDGAOj8mYs/fbX9889Hf2dlcrZH79gbCn22fz8QeTwes8kkrqKHAABIcP7CeRKUk51jslgAkDF28MCBI0eqUlNHZmROyc7OZozrCDjnVZWVTU2Nd8+Zk5iYpKMLhUJCEBF1dLQLEqkjU4UQQggAICCGDBG1WLSiolJRlBl5eQaDAQBUVVVVlXNuMpmOVlUWlxRbLLbklOTCgkJXUiIQKIoiXW/XbxlffLmHai+v+ezi+S52p4kEMyIhYF/cRJDMvaHufXu8Tqczc4qiKAAghPjTnqItf9icmTklvyDfarcRIiISAJAmYlGDQWpuai4uPhhVIy/84IdPr1hpsVgAoOiT3Zt//4GimL77vVVms7m1tVUIQURaLLZr546KyopgMPjY4982m83hsHrw4MH29rawGi4tPWw0mp5f9bwaUf11fs45AbW3tsU0zcDgd5s2SYrptXXrp06dCgClpYe3frTV7U5acu+yirLS3/7rWz3dXSNTR7319m8/3b+/rq72zjvvKsgvsNvtcDMfvBE+AtKv2nJ/6w+KzlY3aSDzkk5zLrOORCGAIxABIIqoUbYvvm/yC983Kkrc8yWJM6Bgc/28BfPy8gsAABgiQSgUOnXqVNqkSWdPn9q5Y1s0Gm1vb+sbkejcmdMGg5yaOmrZsmXhcBgAdEcwGKRvP/lkTm7uli0fJrtHLFi82GAwpKSkWK2WUKj33iVLk5NTiIg0YowhYLi3981f/NzrvTRn7vxXX1vHkMmyrI/SUN+wfetHXV1daZMmNTQ3cmRGRVm4ZOndc+/p7u39xevr3tvw7tPfWbnqxe8nuFy3jw8IGfCTze2ri04fawQwcCA6RvZi85gH5GOyiAkEIBCAyl1zJq9eoyS6SSPdKREAkQBJUYxfnvrSV+fv7GhramxChrIsHz1aPXv2rPT0iZxxk908c9Zs3fXaWlt9vlrG+KzZd3i9Xn0nhBBEgEhNkUhVVZVZMX+ya1d6ZmZGZqbJbCKAgL/uxLHjjz/xRGZmJgBk52QDQCQS+fd/e6c+EEhNHZmvbx4AAAghGuoDod5Qbm7utKlTd+7cFo6oBi7NnDmzoqLii2PH/+aOO7Zt37bpg00Zk7O+9cjDt4lPECHghdbuV4prSgIxNMh6eO5ixqNjp98RODK28QKgFCMw5udN/uGPzSOSSe8TvwoAkVAQJSenTJgwvqK8bMsffg+AK777zLrX1xmNSlnZn6k/tOtdTp6sjkZjBklasHChJy8vGAz23V1EyLC8tDQSi6149tn8wgLFqITD4ZLikosXLuzbW1R7yRtWI+t/9joAhsNhzpggEEIAgia+Engv1tQcOlTiciV4PJ4d27ad+eJLILLabTU1NR/v2OGvq0tJTh4/foIsKyaz6cbsboSPAXg7el759MzHZ7pAlkkHAgQEtcnpwfTciW2BUCgsFRZMemmNc1I6CXHdOz8Wi2VPn5ZfOEs2yv+xYQOi5PHkz5gxgzFWH6gTmp4u9q3w85KSSCQsBNY3NM53uU6fPh03yTmvr6/3XrpU6/PNmz/fYrEQ0TPPPBPw+48eqWpsaHBabBE1um3bR5UVVQUFhYvvXYSMEQIgXW4JKopitlhVVS3as7uluemJp57Kzs5+51/e6rjcSgB5+QWc886uzudefPFyMKhGVJvdMSMv76ZX8NcfXoRSb/OeU01MdgoSgAwA9QS5hRmi2QVYU8ETk9JXr3F7CoUgAGDXjoTAkJ09dx654cTxEyQIGFVWVVYeqUpPT7eaTIwhERAhAHR1dxcfKI6qEckgR1Q1pmlEAogRETBETQNBBskgSZLurfrCDEYjZ5wAgbNQqHff3qItW7dbLJZFSxbp93udz7d27atJ7pTnnvteKNRb6/N5ZuSNHj2muvpksCVIhBkZ6ePGjeec+f2BfXv3EmmIqGlaZWVlktttUpTbwgdQODrxjWVZ7x6p/zIYjTCOAAScgJgAo8tGWZPHP/RYsmcmASDSNa821H84540NjdFYtNZbKwQBxoLBZqczoburu6O9HZEhAAIBwM7t2wEEcgMBIVJEDXe0tzPG9fcMQ7RYrVOypuhruzJOH37SNEFEitlkkaUkl1OSJEJAQDUUtpjNAMLn82VlZa185llNxAK+wKaN/+mr9c4oKPjJa+scTmdXd9eJI0c+/GCTyWrJzfV48vKMshzuDSlG4w0c8GvxEUFakj0tyTZztGPrqebN1U2tqua2cn9XzCGRgYtxT61InDFTT0PjScwVeH2JDWlaLCtrSsHMmXar7b//awtnPDc3JyEh0aSYNC1GJIiEnvJOy5728OOP/fP69dFIWBNaeXn57k/2PLh8+fRp04mIc26xW4OtLSkpKUajEfqTW/0xNjACIIIgof+dAMZNmPDy2rUIKAQpipKRkaFp2md7P22sb1BMxq7Org/e28gNkkbCV1fncNgJ8ey5M51dnRUVZZcvtyx/8CGT6WuD4A0OLxEBAuWkujLd1r/LSq5v7U1z23ecbjrprZ+el508LY2QA/XlwNfZAOjL4J1OZ1KS25XoYogAmJyS4rQ73t2wwZM7Q5JkTZB+9nNzPC0tQY4QJSASTQ2NRbv/WF9be9fcuSkjU7VY7MD+fWVlZaWHDrndSbNmze5zCiIBGsEVhtQfp/VwI8tGm9Uen1M0Fv1w8+b339s4NTvb6/XW1fp83tqX164dM3asy+G8cPYMl3g0rJ47d35p5uRZs2Yrt3d4ERjpbIgUg5yXKuelOgFwosvUOSPFYVJAZ9c31eta0L+nSEQNh8PhsEokiHi4NwR2R05OrtVmIRIkhBB9h1GLafFeEufhzs7mpsasrKwFCxf2dPeUlx7u6uzo6LC53W7G2IAnKiGCAE0IDfsHpv7amj4CIiKiqqpFe4tqamre2fDuiepjv/nlr2JC3P+39z+5coViVCoryjUhbGb7vPkLp2bn3Hn33RmZmTdgdyN8AzXwLa1IXLFbKV6ngn7G/cvWm+kzByDZYDhw4MDh0nJf7SWT2UKAO3fuDPgDM2fPGjNmtCA9Zl3JLfo3BAEIOTeZlMTERKvNZrFaLVYLR+aw2RwORx9uTevp7tZiGhAFfL4DBz5raKjnnFNf5B1gFAEAGGfz7rnnvmXL6vz+3bt2Bxub3Snuf1z1vGyQ29vaTn7xBRHZE1zLH350ztw5gyk03LRkENM0ob9GkTE9z2AMhRAISAhAeuGPOOMAeFWURWDRmJbodo8bO37KlClLliwDBEFEmnAkOKtPHOsvUF3lv4wI9TVrmujs7AyFQj3dPWo4rN8y8WTw+PHjv/r5G4G6OqMsl5eVVVdX9/T0GgwGQUKQAARE0EC0tAS5JLlcLkmSrDZba0vLr994o+zwnx0ux8uvrHU4HLt37zp/+syFs2c548nJKRmTMyD+3r/NxAUAAAKBQFNzvcSNTqfD5Uqq9XlDvb0OR0Io3B1Ro0bFqIbDdrs9HOl1OZMSEpJstj6/QETOOJekaDR2pKoqEGhAvUyCoL/0OGcXay5InENfTUfHDZwxzjlnnDEmy8ZIJFJSUtLQ1BRRVX8gIMuyxCUdH2MsMTGxp6cHuSE7J2v+okUTJozb9P77nxcX93b31nl9JEiW5Y6OztWrX1JM5rVr/2nEiBEXa2p+8+abf9pblJE55UcvvbR02TJkzH/J+7uNG3u6u602u8fjGZkykuBGcWlQ+BDRH/AhYnNzoL2zLRJVgy2NimxqbWu5fLmJAACIM06oBVua/X5/Yf4dcXxckqZlZ997331Wm3XVCy9OTJt0rf0TJ46/bTWTEKNSR+nfjEhOWbB4SSQSnTApzWmz/8PyB1NTRz30yCMT09IAINGVUJo2aURKsqKYAICIxo0bt/anPzl16tTfP/CAyWzavmPHpPTMqVnTBGk7P96Zl19QWFAYEULENMlgqKyqumfu3EOHD1vttvWv/+ye+fNdiYm6889dsOBHa35cdrjU6XI+8uijEA/cN6ta4Q1OOBE1Nzc2NjZYbTZVVWPRqNPhaG4Jupwu5Njd02OQDJoWs9qsDrujPhAYP3682WyP9x3o9teOggBwTYOvOymDKcDdRpuvK8EOvt53E3y3XteF/nSCQD+t8YN55UrpZ3e9sQfUQeO/91U9r/pTfJJxg18xPrgiMyLSleiB+qQGv+qb4Oufjf7x2hZ9tV694AuDiLV/ZboRvuvqK+37bt5vEK+rdMv4hjVQ38j/zv7lNIxvSBrGNyQN4xuShvENScP4hqRhfEPSML4h6X8AA/Br508SSgwAAAAASUVORK5CYII=",_imports_31=""+new URL("image124-CJxHBIYm.png",import.meta.url).href,_imports_32=""+new URL("image125-Cp5vbu5W.png",import.meta.url).href,_imports_33="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGYAAAArCAIAAAAFe2qHAAAACXBIWXMAAA7EAAAOxAGVKw4bAAANkUlEQVRoge2aaXBb13XH773vPTzgYQcBEAQIECTABdwlUpQoS9ZirR6ncuN44qRNnaRTp0k7mcl0m/RDPjTTTtvJpNNxp2mmaePGiVMvmViS7ch2tEvUQlKiyXAnQYArCIIgARDA2+69/UCaImlZJN1tmvI/+HTn3IPzfu/ce889AKSUgh1tR+h/O4D/e9pBtm3tINu2dpBtWzvItq0dZNvWDrJtawfZtrWDbNvaQbZt7SDbtnaQbVvbQ4YxyWTz/8l7PKWUkP+uXgClgFBKCMGYfFzHYWX4k4bAbt1UxfjG7cHEfPLpJ1tZlvmEXwjA9GxyMbVUVlKk02oeYUYIBYAihMAyZUoJpghBhln3mimlGBMKACWEEJoT5cxSPrOUW1hcchXagn4XhHDVGGNCKE0kFs1mfT6vWMx6hKCKCQSAYdBay0doq8hkRf3Fxc7vfO/tpnr/b5zet8VZD9V8MvPDn15+9lOte3YFCaUMQg99ASOR6WxOCpUX5/ISVsns3ML93okKv2tvUzlY82g5Ubp4vQdSYNDzs3OLgo7X6vhsVuodnJiOJb/1R8+4nAXLllglbe398+nsrfbBLz139HJbz/GDDUajcLtjAAB4sLXaZjZsJf7NkVEKslnxjbdu/cMP3x2Nzu3bXb4asKri5SWGENw07zDGkqQSQJ12c6nP2T8yNRtfnE6kgr7C44cbENr4hju6wv2j40+Tvfe7wlab0W4zXrn5q5lYcm9z+boHQMzltt6mutKyksLo5Fw4Gjt+eHcmk2uo9Q+MTGH8wBIy8O3LHTaLxaTXSZLyQU8kkUhXVxZPzS5GxuPNDQHwX4UstZT9159c/pdXriQWMhoNu5y8GJPY3EJb+2A4GqeABEpcj+2pKnRaGPSxm+NYNHbh8n1BEOxWQ22VN5eXFJk4bSZWw1BKAViHTJTkxVSuKuAdi8bHxuOpbF7DIafD2LwrsMEtz3OFVnPA78KUFNqtV2/3V0RnzWatoNfXhXx2m3HVEkFos5iCfnd10DUUnvK5C2YT6dRi3igIz3/mUJHTshVeW0IWjsTPvXcvNpcSBE5RCYQgLylt7QM/+PGlvuHpbE6GEAgCV1/t/frvnt63u/Kj+bIsh8Ny8sjuG+0DeUk+uC/U3Tt2qWvg2MGa1uYqtB40BaCjO6zhUMBXaLcZs1nRXmAudtvbOoebaksf4hqCXF4SRVmUlRJPgc/r7OwZbW2yClpWUjDPPzDU8pzTbuodmlRUxWgSvB7nYy1VZ9+7SxGkYEsbGdjKiSnJKqaEZRGlkAIQT6Rf/MHbf/uP57sGplKZvKSokoznk9n3r/X+9Ytn+4cmPs6P2ah32s3xRIplWavFaLUY3UWWdy7dI5Ru2HbTmdzYWCwcid3qGEQs4nmupy/SNzQeKi+enEnmRXkjMYTGorFUJnuro39/c+XE9OLQyIzZZECIURR1rSUlcCGVut05ODuXmkukipyWXw1GjHr+lZ9du3S9O53KEUw2BbJ5liEEP8wbYrXoC2zGxjr/kQM1EKLoePytX96/1TEqSoBhmBt3h9+52BUodWn5hxyFeVHq6BooLS7Ys6sMY/LSa1dPHal/8lgTx63bBAkho+Fpj8uiUtzeNXL7Tp8oY4Tg3t0VmWzun370zp/9wTPFHvuGKY4CS2xurthlaWos/4vvvt66u1yjYTGhiroeGaWeIntjXWBxMXPkYB1RgbvI7nU7IIW/vNYdn08eP7zbWbDJCt3C9g8ABQATUuax/+nXzpw80iBoV3K9tany5JFdL79x9fs/vrS4mGMQunt/eG7+Ma+74GGOaFND+Uh09vWzNxtqyigggVK3t2ijpSTJXreN49i+kenm+mCBzTIVS9aF/G0d/YTir3zhlMdt3zBFVbBe4GsrSxGE8fiCntewLNM3ME4BUOR1yGRZ1mt5h1XvLy4QZXVqZv5m+5zFrKur8v3WZx5nWIZlNi+eNl+YkAJCqdUsfPMPzzx9qkXQ8hiTpZyYzUmEUKvF8MLvnPjSZw9zHAshTCykc7n8Q/3odFqL2dRcX/7U8ZaXXr1a7HI4CswPNXM4bJmlLMciHc9pdSwFqqvQXFtZMhadz4lKLifiNctHxRhTtXcwGonGAaSRiZnff/5ET2/kzV/cQQhKMl7rPJnOKhi3toScBRYxL7ocVpvF8JUvnCjzFQIAOZbdSmm2OTIKqCLj04cbDu2rgRDkJfmdi53f/MtX/urv3+jsHiGEajXcp47tqgv5JBkb9YKG5x7uh1JZVpOp7Egk1tIYWFrKXbreFY8vKopK1hfqiqwajQZA4PxC2mwU0hkxHInLsnxoX83fff+t7/3bu8Ph6VVq+byczcp7GiuefmqfQdCWB0syOfHooYbKoCeRyGD8IMswJjMzSYOe1+v4q7d7K8rcFotBVdVUJv/yz678+7kbkqxsSgNsqZSlQK/V7G0Oms0CAODard4//vZPEsksoPT2vfB3vvV5r8fJ8Vypz37tVn9tlddmMX7UB8ZkYTEzHUt29UcQRF987iiLmO/+87nb90b3NVUES13FrgKLWb9s3DMwdu5Ch8lkOHW0sbrC+6PXr4+GZ7/xtTMtfpe7yDo0Oo0xph/edzDGCDEdH4wOjc3kRRFQhmEApHB8cn58dt5kFB7EQIjLbuJYLp+XKQRWq/Hcex2ypDrtlt98cn93bySVzjrtm5caW6n+qSBonHbrcun07uUPsllZ4DlMwVBk9m9ePFtd4SWUDodjpSX244fqzGuiXJUkyVMzCcgwZ07sMZtWKsY///qnX3rtyoVL3X7fzJHW8r1N1cvj5WXer37ZYbeZGIRUFZeXuw+3Vgf8LgBARZm7osy91rPRIJx+or4y4C10mNfWN72D46+ebXM5rasjHMt88XPH7BYjr+V+7/PHRVF2F1qtJhMAoKbSV1Pp2wKKrSHT67WchhOllaPdZhEggJgQlQCjiW+o9e+pD+ZlZTaRfuJAqGXXg9KcEiDKMqBAw7M6nbamqoQSynIcITQvihzLajTcl587+ulTewwGgWUZWVZYlsEq0Qsao0ELACCUQAhe+NwTECGCCaFUUhQAEIKAQUhWVZZhWIZpbQpBCCAEiqKyLKNgVcNyFaVF33jhSQihKMoYY5ZlIYShCi/GZCmb12l5nuc+e+YgYiDGmGEYjDGEECGoEsJA5hF72ubIfG67y2kKR2OSrPIa9szJlq6+yd7BSY5jjj1e/9XnT1jMhuxSzigwpSVuvaBdnZjL589euONy2IxGwecpaP9ghGOYyqBHltXoZJzhUHN9xf2+sKpgDcuW+pxtHUOVZUVTsfnaqhJfsQMAkF4SR8NTsqyqhFotegRgYjE9MZUMBdx5SZlLpGpDvsR8Jp3J5UVpf0voyo2epsbgaGTm6IHGsYm5/uGJk0d2D4xM9w2OB0td2ZxYXeEdHJ2WZJnlmFCg+M79kdpQSTaTrwh6bt7ts1kM5QF3/8hEVdBr1Os+OTKzSTh9tPH9K93haKwq6Kmr9n/7T57t7BnT8ez+PSGL2QAAUDCprym1WdedgEs56ac/v7m/uSIvygdaa8LR2QKbMX63bz6Z9hY5rFbDdHzh4pXup040X7jYuVAbfPXNtlDAFV9IGwzCMrJUKnunaziXlcYmE44CU0t90GQW7t4fqgq4b3UORidmPUXW9q6R8cmZmUSmPOA5//79vuHJqViyuaHytfM3xyfnil12Dc8OjEx7iqx3741gAto6Bk4ebjj/XockkVd+fqNhcNxpN3M89+qbbWV+J2KYO50jLmfBI5BtqV926vCuA02V7feG55NpSmmowvvbzzz+zFP7iwqty1WbxWywWc30wyJu+YMQMhl0vJZHDNTxPMswEEBBy+v1AoFAlhUNxwgCj1XM85zJpPMUmpdyea/byjArqwIhyLMavcA31wfGJ+J6QRMq95b4nKUlLq2W1wsCQoyGY6oqSjyFdgigv9jhclgT86m5+VQimWqsKe3uH/e67dXl7hJvockkaDjEa1hZUTUaVtBpykoKeZ6LxRfDkVix2wERiozHsjk5uyQ+ggbc9J8/oqxkcvlUOjs0MmUyaD0eB8dyKxeyles0pQBACAEFdE3jTpTku53DZpMescjnsff0jyMEg36Xikl0PA4hbagpHR6LZbOioNM0hPyJuRRkkE7HWS2G5RI8lxOnZ5MEE6fDOjQ65St2mE1COBor87sj47PpdN5TZMssZV2Ftng8bbHoYrOpQGlhW3vfrrrATHzRZjZmsjmfxzE7u+BwmKdjyUKnJToxl8uJWq0m4C+ampm3Wozjk3F7gYVBUFJkBMH8QtbvdRY6Pvbo3BzZYGTm5fPX4/MplmEkWdJoeLR+b4QQAgjoRxqtFEIGQRVTDcsSiikAhAAGQYiAqmKEGEApQkhSVYHX7K8PPnty76Mj2eifUALoau+EUvrwQpRSsH6cYIKYT97B3xxZeik3NhkTRYXnOMhAhJjVTFqdCeFKd3hjyBBAAFeSDwII4PIlfM3gSnbazAaP0/aJH+N/UpsjwyqWFQkhhl/bRvl/rM1PTIggYlhKqaIoEEIIIbOFu+uvsbbSyKaUEAgAQlv9QeHXW5svzB1t0M5Pv9vWDrJtawfZtrWDbNvaQbZt7SDbtv4DbG9T9HUtIdQAAAAASUVORK5CYII=",_imports_34=""+new URL("image127-BbspAkPL.png",import.meta.url).href,_imports_35=""+new URL("image128-BXpsm8V9.png",import.meta.url).href,_imports_36=""+new URL("image129-yx52ZZ_G.png",import.meta.url).href,_imports_37="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGMAAAArCAIAAADjUqHDAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAN5ElEQVRoge2ZaXBU15XHz7lv6VW9SN1aurVLSC0MEiAWiS1ICcFICjhY2MDUMHZwuaZmHOZDyvNtFk/Nl8nE5UqqJmVsJ+WxR2MWQxw8BgUMWLIxNsLaWsKSjACh1t6SWlKv771773xoaMtsVtWkHE+s/7e33PPO/d1z7j3vXuScw6IWIPKnduD/jRZJLVSLpBaqRVIL1SKphWqR1EK1SGqhEgGAA+BdtznnnAPnFAARCEdEBHL3WxBvDBwAAO/39M9I4l3XnHOIMeafmhkdodHoHCqiIBJGLEm2JLcbrQYQ5ofhfSD/uUoEAATgwAEQGQv4hnirz//RJ9cHriWbLOY5NabHayTiYPLS0nW6dUWmskLJZgZEYAyAAxG+I7AwnmYIyCmd6+r58L9P4MC41WAEtz3bnetk5igo19lM8KYvOjw5C2rR5vWebd+Tc1xAEBjjgoAAwP8ICcg5x29xCt8mBZQOXP7s898ek2ZiyVtW5lev17vSdDoDogScMWBaJHS9u3vig9axK978R5Yue3KntCw/jgYTf47/h35qmnbr1q2srCxJkjjnmqbFf0gRMU5QFMX5HCmllNKHGCSECIKQaEIZo5o2/ynEp5p7mjzIoAicI8BEx9ULr/2nC/Vrn9prWlmIdgsSgQOlIiNAQGOi0VxYvqo4p7jX4bh85kz4iFKR/ZxoNX9paV43GGOxWExRlAeFiSzLOp0u7m5cTU1NR48e3bJly+OPPz42Nnbq1ClFUSVJjFszGA27frzLarXGX45EIpdbWi5fviyKIt7pLgJwzhnjoigyzjwez4YNGywWS7yJ1+ttampCAERUFKWkpCQcDoeCIcDbg0EIWbp0aXl5+YNJIcZGxlve/r1Z5Sv3/1iNhrvffpuqilUTqFkOblthD3L+QecsV+aIJlksSzdXlJHYx6fPpJ/4n8K/2A2ycG8oDQwMHD9+3OfzMcbipOYj0zStqGjJjh078/Ly4nei0egrr77S2Nh45cqVsbGxYDD46muvEkIy0jNUVZ2amkpOTv5+9ffnk3r/zJlf/upXTqfTbDarqsoYE8U4Vq6qSiAQqK2tLSkpSZDq7Oj495//3G63RyORUCj0kwMHvF7vrYFbgCAQolEqiuK+ffseSoryofMtvuvXVu/6Uerq0tP/+m+9n35cXFI8bU8SwepUVTUaG5wb4+HYyBf9Q5Oj6Z6Ssh11n1/ruXbybN6GLaQoDfndMTU5NXX+/Pmenh5VVRFxbm5udnbWZDKZzWZCCON808aNW7ZUJQLw5MmTlz+9rJN0gUDgrbcOOxwp0Uhk7dq1Tz65JxgMvv766+FQ+C6/FVU1m8w7d+4sKCiYnp5GJAIRgIDRaJybnT169GgoFJr/vqZqOllXsa7i+o3ro6OjFRUVq1evnpiYIIQwxhCQCGTZsmUPwgQAIhsYmzz7SU5mVub6lWCzxpAaBXFtXZ1YlE0M+iSXS4sozhSXOUr732mMnj+D0Rg47Bvrajqf/+Xs+WZb0RO366l5KsjPf/7552dmZiiliNjQ0PDee+95PJ6nnnrK5cqglKWnp+fm5sZf7u7ufvnll1VVPfh3B9PT041G49DQUHNzs98/2d7RHg6HJ/1+vcHAGEvYR0RJklJTnR5PcSymXOu/Fo1EEdFsNufl5a1ataqlpQUR5zehlBqMBovVAgBr164rLS3Nzs6+y23O+UNWFTEwMToyMeRetSbZmQYADpB101r41CVDZ7/oToW/ykLfJHnjjBLTzJ/3OakoEARBdOcuGafy2OU261/vRkQOHIDjnXLBbrdXVVUlvtHa2trY2Oh2u2tqahKAEurs7JyamorGYq2ftZrMpuLi4rS0NM65Xq+3WmySKOkNBnKP95qmMc5NJnN+ftrIyEhDQ4PFYtmzZ09JSYnBoFdV1WDQI345D6qaKgiC1+vt7+/fsWNHJBLp6GinlMmyJAhiOBwWiEAZzXC5XBkZ9ycVCs4RzpKSkpFIANztyvSnpE54eyItLVq6bf2TW2f6B754/YTTbhN0ot2ToU9JAUCUDYX5he3jo+kQtoHpvqa/7BJjgiAQImjzVp+EKisrn3322WPHjp0+fVqUxMcee8xmt8mybDQas7OzgsE5SRJDofD8oU6MvCRJ4XB4bGwcABhjPp+vrKwsOdlBCFFVlbEvF0eBCIQgAOj1+kuXLnV2doZCoWg0Ojs7g0iMRqPRaNTpdE888YSrru7+pDAYzZ3mWZpJ4AQAnXtrjFvLIRKNHTrx+dDNKQkmMTZhE/J/UmvZtNJmk0x5OQAAOnGu0HGjf6QQiO2hpSfnnFLK4r9H91N+fv6mTRv1el1vb6/dbq+rqwsEApzztra2IZ+PAxBCioqKJElKNEFERCSEaJo2ODjY19cbDocB4Ny5czabzel0IiAimf9FxlkkEqupqfH7/UePHl23bl1VVRWl9D9+/evZmZmnn346MzNTluXcnJwHdUQkhEgMEVi8uyOhidDcCIlGNf+YqqqMaRTYFGqDgVFHYIgRg6xkyrokAB4KBZGADPEC5GGVFOecUaqqyvyJY77eeuvwxxcvzs3NhUKhhoYGk8mo08lutyscDiPgwZ/9bCYwMzw8nJGRkVhJ46Gampq6a9eu/Pz8F154wW63Z2dnT08HfL4hDvzehKWUudxul8t1/PhxT3Fxfn6+0WhYs3p1X1/f9u3bNU1zuVwFBQUPJKW32YeS9KN0zg1UAjJ4+HSg8UNXhptxTC8qTtWMaHPaipdMXxue+ezqiBiq/pd/MK1yQEwRu4c9yWZLfDfiwf9/hBBJkgghD4opAMjMzExxOGRZFiUxKyubEKQaraisVFX1/LnztwYGuru77XZbWVlZPLIEgYiioGna0NBQX1+f3+9XYko0GmWMXb/+RW5uNnBQNW3+wMiyrCixixc/Gh8dC4VCXVevnm5s3L59u9lslmXZ5/MdOnSorq7u4MGD86u8r5AyOO2BVL06M5YeCUto0camdar2yLZtptxMTDKiZEhbUrT9758TQbh54t3Rj8+xsAoAsbHx/uDEyqofSiDes/TFK0B2ZySpIAiEEFnWiaKYmKoIIQmf9u/fX1NbW1tTwxjbuvUHlNKGhganw2m3248ePvLab36zu76+uro6kYCaRimlsVjM6/W2ftba09vDEYLBYHd3t8vlMhiM0VjMYDTML7g1TdPrdV2dXlEUy8vLr3Z3B4PBlStX+sfHETEzM9Nisbx78t1NmzY9qKQSDVmpfE3eDa+3oKtHX7ZCU6PjQvTGxHUDD4g6Oc2oZ5SNfNGrRxwaH+YcJc4hFr360YUbTqx6dAPCfaJpYmKira2NUso5j0ajfX19nPOJ8fE/NP7BnelGQqiqFXuKi4uL47AMBoNep2OMjY6OHjlypLa2llLa0dGRm5trNJmCwWB6enpycnLCPiIiERRFicViNputoKCgpKSEUhrPoGAwODnpdzoddw2eKIoVlZWbN29uampq72jfXb+7rKzs1KlTnHNPcUl9/e5/+ud/PHf2XOnyUkmW7u4SgAgmk+cHVYOd3r73ztocjoLCJbFZ/82+LmVMlJKs5UsK5qYCLZ82mwQMsYCpOEsnCuHmT7znPsytKBc8BZxzQMCv0urr63vxxReHh4fjM9TU9HQ0GvV2e3/x4i8kSZJlWVGV5/7mbwsKCmRZBoBLn1x653fvjIyMuFwul8t15coVRVGaPvhAWV+5d9++C+cvvPnGm0lJSc8884xOpwMADsAonRgfb25utlqtiIgEgQNlzNvlnZudu3nzZl5e3ldKMABN1UpKSqqrq0+ePLmibMXePXubm5o7vZ3AUW/Qbdq44afP/TTTnUkpleC+pACyly4tr65qP34y42xT4frKtE3rFE7DBuSinJSdI80E16Uki6KACGaGcizWcux3cpSt2/kjNOr5vbkHoNfrk5OTOWeiKCFiPgASwhgFQE1TAVAQhBSHI7HwD9y41dzUXF9fX1NTU1hY+NJLL2Vn52x/dNu27dtKl5cVFhS88sqhcDiUmOl0smyzWt1ud2VlZW5urqZpgiggoKqqSPDWwC1EdLlcer0+4ZLNZsvNy7Xb7ZIk1dfXG43GvILcN//rzenpwNo1awghmVlZBw4cYIzpDfp7ewTxvQQA0PwTF157Y7Slvay01POXe6QsF0q3k5wDQ0DgwGKK8v7F1sNvD0xObH52v7vuURDFeDLcZXR2dvbGjRuMUUJuGyGIlDG4M4UJgpCRkZGamhqHNTIy2tba+sgjS7OyszVNa29vn5qaXLFiRWpqOiE4OTnZ1dVVuGSJ687aRxnr6+0dHBz0eDwpKSmUUYEIAEApBcTA1HT/9f6UlJSioqIELJ/PN3BzoHBJYVpaGmOMEEIpbWtr8/v9GRkZy5cvf9BE/hVS8YUrPDw+eLKx/cz7aDeVbajM3rpZSrITRCaCBsp0T29PY1P4Ule6aMrZtyOl9odolP+IO8Jx7xOXnH+N7W9+MwsTFSECQGB2tLPr4u/fvdV/w2m1pZrtOQFGlVhEVUZ5MGISUytKy6q+Zy32gGz4Jr38NujO9k5i01LTYuP+maHxUMfVwbYu98CsyLnZ4TBUrxLWLBEyU4nFQm6fU3D8buwLx5XYCPsysG4rFI4FQ6hRwkEQJbQmgUH+U3j4bRE+pHSO6075/R06hrmvvv5kFOMnf9+AL99uLZ4hL1Rfn32LimsxphaqRVIL1SKphWqR1EK1SGqhWiS1UC2SWqgWSS1U/wsTNqTb06VF0AAAAABJRU5ErkJggg==",_imports_38=""+new URL("image131-BDrSeyRx.png",import.meta.url).href,_imports_39=""+new URL("image132-CAUhUMru.png",import.meta.url).href,_imports_40=""+new URL("image133-Ch35QMlM.png",import.meta.url).href,_imports_41=""+new URL("image134-Zopytuub.png",import.meta.url).href,_imports_42=""+new URL("image135-Bl9rSUPS.png",import.meta.url).href,_imports_43=""+new URL("image136-ZaMw-6ZS.png",import.meta.url).href,_imports_44=""+new URL("image137-CBsqHz9J.png",import.meta.url).href,_imports_45="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGkAAAAoCAIAAABy5EOkAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAPNklEQVRoge2aWW9d13XH19rTme5I8l7ycjapgdRgyYM8JQ6cxE6DDC9JEfSpj/0c+Q4FiqJFWyRBH1qkgGMkTWs3jgfZcWRNlCVKFMWZujPvfOaz9+4D5ToRLKdlKXWA/rhP+x6svfdvr3X2WgsHtdbwWAcS+Z9ewP9hPWZ3cD1md3A9ZndwPWZ3cD1md3A9ZndwPWZ3cD1md3DRH/7wh/cNye2ad/l6UKtqgzIn5bXabqXMDE64EXuet72luYA49je3mWmgEDIKve1d4sdBGMh2h6VTyg/8ShWUppYpe12/UiOWRQj6m1uy22bZLCCqKHS3dhI/4Ok0SJns1qLegDg2EhJp1Wx3LCEIIQDQabe7PdcLYiTYaLuUUs4oALiuGwShYRhhHN/e3L2zXW61OrlcllECAOu7tZX1u81Oj1BKOev1PMsUAHC30fOjJGVxAGx2+hoop6Tt+s2Om7KNctu1GKWUAEAQRo12nxAiOP1PsNM6WN/p/M0/9Jeu1leW3K3t1PjEYGWt//ovUhMlWizGm9v9H/2EFkdlt+3+xd+DksbifNBpVH76erY86HrN4N33+amTuHpn8Hd/Czrm8/N7750P3ztvnligodf687/eu7KUefEZwg2116z++B97A3fo5CL4bvONNztrW/bxWWYY/TD48OrtqeKw4Gyn3Lx67ZOAiGsbNcM0fv7RsuvHRyaGAWB9u1xr9610+uLyRrneUko3mp1yvT05Vrjb7Pzm6koQq72+v3a35irc3tqZGcsTyn72/ifbtfaxqSKl5J2Pb9iZTMY2/vWjm1dubZ0+On1lvdprVMbHCgCwWa4vb9wdL46Ygn0uu98bVWHYe+83yfKt3A9eJtD1P14f3LxJvdBc2WR9DwC054vbq0ajEducXFuS/Q6cOQ5ZFt69w+KUM5x3l5ejesspbzu/eguzBn7llcGla3m3zRiTVy/xi1e0sPsrK/mnzmEQidWtfi4NAEBRNStholWSAICKoT5AjWSnE797bWs8lzWHhzfXmjOxXG8nA6+88MToTCHbDXUvIb2NZrMfPbs4P5y2Bl709oXrW7XO6m41NZQ7e+Zovxt8srK9Xm47EPVcX8S66w78IOwM3OFcptHzz3Da8aKNWiuM1V67Mzlk31i6c2R+llKyulPJptNpWzwoZu9/38kgiPs9UW+XcoWp176eOrEYodRUaQIAEFCtaExUrGUSZjW2G96bb1HX5SoGm5mFUU6pWr3j16tIuOr21OY2VOvsyByhJLj0Mc/bqWw6eOdDAKWRpCKZW95WFy9HH5431supSOH+ESJRRrrRGbxxfskpFk4sLnDTkYQjoZmRESebun57EwBiFPWQrdS8qbHCdDGftq3SSPbVF8/kM45WWK029pq9kXz2tXOLp58YY0aq3o+3Wv3R0mg2m2l5cScBJlhKkO16JzecH5+dvFnuzI3li2NjHyxvrpRbfhSdOjJNCT6I3e/5HRpi6CsvBis74UcrnaUVevJ49uQpTRG1QkAASKgGTLSgBNErpPIzxwfXlvOOsBUoQqA0TnJ5/dv3+1qaC2fjGOD8O7TfgYUT0Hejm8vOCwsiSnmXb8heW1EQKmQ3Nts//icPe/Zq1S4WCWoA0Ixstvq/+KB8u9xeODGfMkTbjbRURKmhrP3CZKG+uX57Y5Mws9YLkjjJOgZB3K21NndrXhBOT00tHJlqDwYfX/iEUlw8Mnvq6GyjGzS7XsSt3FAxZZpdP6mtVoaHRhij19Zr09Mlatm//e2N187OHZmb/dmHKxt31772zLGMbTwI3P3sNII8NpH9sz92P7kOy6vRxevt0oihkXhINAUAUxH0VUSIRhYKU7z6Zf3Gb8Kfv0/SAEixMEqLRfz1L+PStHzmJVVeER+8l7aH+MR0f7uqatXaBLei4dRWpbu+kS6Na0PikYLzvW/wfhW6vwp5IhEAABX6kSo9MTFcmrxx7ebTuUWmGaiEQsK1nC3mnXB4c/tukpm0TTNSA6IVAHAubMdu9IKl1Y1z55566qmT7b1Wt9O7ubuHlKVTqX69IlPayAwNO0OVWq1c777w1PG9ED+6vjnX6UWarmzWyrV6oVAYLebvlv0jE4UvAHd/zGrXr//49Z0P3sOX5sUPnvNKot/YskyQloqauwBh2NoEn3Ni0CTmEfCxafadVzsyzq1XEQNimuboiLnbzkhqvnzGLhTpWtPKZrhJ+xfeNaMskXnPpGim2XsXMPEGjtlamDG/9FL6+ZdpaRqAkXu9xGA+Hby0UPr2U7MpQf/l1l2fUqSRBINLaRKYnZ32MXv+0k6GYkEY7VakJIzmU2eOTlogrgSDv1q6CgDPFSdfOTpfmpi4UXFHc2yrG69VonGHTQ2Zm22924pGHbF2e+3Li+OvnJ3/+pPT33l2ZunWFiE4mhU5i3L6BxK4349Zxm1hRq+/T5YrTqSS7Yg8PYNPnuh+tER/8ib/4Fa3s6vn55zJ6Xh706MGMEM8eco5d877518CRxsARkdDkTXSRXthPrp9x7My6dlj2BoEl1eHv/Va8ZsvJ0S7/Ff963cyzzxptIxw0gDOwXT6ZtonOgMIAKjAgtDhmLXpl59Z+OmFm7hR0SSMtNSxR+LYyTnzM6O/vrocusZzJxeu3lqJ1v2Z0dFOJ95t+EOWbbL0u5c3BsenQoxXG50xyxzLmoNuB1g8m7c4wcB1LcYJ6t2trRefPTs7WQCAiQx/+/wlL0wMVAYmXwwO7stRkBKjOGIApUiUYTnPPuu8+jKdmhbDI1wLFyCeGc99+4/EsXnFWJi28scXSSYn8nk9lOFnTrDxSWkJmXHE6VP8xHEiWDKSM194QabSBJj1tRf50aM8PyyHsyBsPj2mUzlj8ZgxN4kaEiAwM2bNTTPGtUZGWGkkxyjNOqbNDZHIqWFnbmTENtn4kMM5S9vCMrFUyJyaHjUNrNSrG3sdL4gX5ydn06nn5sc6vcFuv9Fwu6OW+OqpmazJtYSJQvqJsRwiKq1nS0PFrMkYnZ8eMzgliCYXyOhQPsspWpyOjQx9MTu8v+eutR64EPhaA7FscGwgCEmi+14Yh1owM5VGxlQSx1FgmA4QAnGiAhe5gaYpVQKeR5ChY0MSJ0FADBOUhiAijgmMAYBKEuWHhFOdSEIZWgZokEGgEJhhIKLSEMeJEGz/houljmNJiOaUxUoJhgQJAARxrBEtxhKlBp7raRCEZy1DS8U57fvRII406BTnWcsEgDBKNMB+shbEUiNyglJKg38WfGGccEaV0lJJg/P/IrvDlAZ44AV/0Cf/F+nzM+b/ljSAlv3N1ajVyjxxjGdzEIaJ2xu0OumJaZqytVLQd7Xf81fXcLKEGuJ6JfPEnE7nwLSRUtfv6V5AWq1OZZsRojVDlTCGqjg2sngSAHQUQRShVK21NRXH+SNHqGkDIhgc/tAL/hB1+Oyk64eXLrrv/5tb3UsWTuUWj8uVO3Kr0qGc/en3U8eP6naP/OUbsVtVW+ukMApEQv2umplV40fpd1+FmVG5s7v31sVctRJsLHEULOIKlTRRf+ubsHhS+X77/Hl19Wo+Scjmjo5kPH9EGWkp8uJ7XyNTfyCxOEQdPjsF4C3filc+SaEVX7wWud3mjcvZhYXSuRfZeEEDBG5ftWqqt8MadyGKEGJjrxwZJNaO4YccwE6lZbEgdjdGSGIJO2l0QDBlZ+jcNADI0G+u3dIrS2lTWJGbIO2XV5iRwXLAX16EyRHARxT+h88ObcNkwpaam8KLFUkCM/BFktBuR+3UyEK2Hbmh6omkb5JQyIHUPjNlP2knQW8oiTiAurNBggE4VLFQtqtMs9DzAsmEpU0AYCI1NZtUy35rjwozoqJLmDM8ZAxRyFmPDBw8jP5d0O8HA5c2IyzXEvBj1814CB+tej96K9qqAIKwTYszY+ARhkwnEIdgc94PHWoKyhGAgJUQRQmN6oOwvhcL1TYSNGxgJgAw2y48/bxZmg97SkOKKifX46Ths+9+A6dmDn07X6CH4Hehp4mKTVuGfWKCQUmUzsSm6bQtdXoGCMkgDyIJQUSlFDoCpSEhtg8EEsIVALBnTtvDjG1VHDZCMr2QK5+wjE5RsAAACWFZBw2hOcORDEFi13pSBny4QPgDex4PQ4fPjljcGMoio0nbZUnC4gQNoUcynKV0fggBpBsohUI4BtVKxooonbY1FwGTpgoZABDtXrmZ2i6TQkoFsdn2CpEyRAwDb3+KpN3U9TLSOO62QOmAq1hGfLeaLo0T9hAyhwft9NAtGk6a5jNJEsUyTsIQByEzLSOTVZwSBQBAhJCm5dmp0HZUHKs4lkSEhuUTDlQAQLK1071wRXW70kCSSxlMZLVBpCLNvf0pdL0ulm9bPd8st/l6VUdBUKlE6zsQy0Pfzhfo8E8pcb1mt8ENLiYmZbHQrrTsM2fDsWw8aOSJpgBipMDm51xMWDRgnp+ggLFJpdPG/KLIDQHA3pXLgYF6stTbvMmz3DOYFJxAQhstAQqAMD822gHohHkSXBkXtHIj4ofwaL9LeggxizR9+ixWfel12Nx468Ky+dILeq8emZ39RhYxTfurz/OnF0Tgtt9+sxP25r7/J5HmJF+k6TQAJI5pvfI8tlH1+qpgB3O8R4ktbSuT3i8/pGO7R2fRZJZI60SrLIk2tq2RDNJHWpwcfk2mldIy0es7sduhhbxf2bOOH1eValJp2l96FoUAAJ1I0Bpl0rt10/O9sXPPaY1ACFICAH69BoKIXhJWazRtK5MFCEwTZjnWWAEAZKcdbm+jaXDTAUCJKmo2eXHULJWAPLq64jDZ7Ru6d/SJ1Eoio1ppYAyjSEuFpnFf/qWiSCnFTPMzE3hvPVoBKgWEAH5W7mpE1ABaa60Q8TNSUgIi3OuPo9aACKC1RgTQ+HCKZVRKHRY+BYCAoGF/5UAAlVYUCWiUoBUQAkAxukdZA2iuCdEAWoKSQBloAgoAE6BEaYhRM6QUQAHESqNShBCmEIjWREpADURr1EoxVEi0BASgIBXVQDRqoiTRAEj04TgjIuLvnD3bHzoU0/sL1ADw6bHvs7znDAifIgUFAIDkP6551EDIPZck95wMP/3tk0YAsu9YBAD3PRAQUN+7IBA0kn0L+/tBBCQI+hA3eF+z56H0oD6/o/Tp6O/Oh5/9d//K7rPz+U88ePwR6KH27/6f6/H3KAfXY3YH12N2B9e/AxaW18E1C46/AAAAAElFTkSuQmCC",_imports_46=""+new URL("image139-BbCGHqGb.png",import.meta.url).href,_imports_47="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGYAAAAuCAIAAABVtvs0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAMFElEQVRoge1aWXMc13U+d+nu2+vs2IbAgOAi0RJpcQntqBzblVJenDzZ/yM/K3lMKttLVKpUykpZLjuWSalEUCBAEBwMgBnMdPf03vfe4weJNmPnhaDBgar0vXbVqa+/Pvec754+BBHhW7wK6KIJfPPwrWSvDL5oAv8fZKymI5Q189okWFs0mz/GhZNMFkky/OLzn/9nnUWDd+9vvPdj5nWAXKDTcLEkQ61H+08+/+jfTve3oYyLvADDHtz9gBpi0dT+gAv09QAACEnieO/LR1kSlkV6+Pzp6fEhhYvV0y+KZAggqwJl1WoG165uCWGZluk3PDewgSrUFaBaNMevcSEOpi6T3Z3t09FB4Lirbfe9Wzez8X5d4vUbb/W6zScPPwnjubD9zcvX3e76oskuVLIqjZPZEKvkdHf7s4cPZqenJicbK52WbYAqmUHC6fHsVz8fHk3nSeo6bnLl6qWb97jfc71lr728KNpkQe4fpwePtz/5aLT9v1CEREnDNKN5yhk1GZFlRqk2PBEnGRLDtESRpU3XIYSkhaqt1vLmd77z/gf9Kzepab956ovJsmSy/5uP/unpw1/adeRSxRg1iTDqVHAXFKZZyk2OOdR5Lkxtm1TLjJWaABES86zaT5JkPr//E7F+9V2gb7ocL0QyOdn5bTbeo1j3BpubWxuPHzxIi4q6jdbSqmV7ODpO56HJwfeM1f46ZZxPTrM0Y8x4+7334lx+/mi7mo23P3vQG1wX1pv2H4vomHUVHh+ilL4frF27vnn/L1e2roJhEm5ceffmjfd/sHr5ClArq6nbXnnn/R9dv/s9t9HV1HI7y/079965e6fpCJfL8dFhWZZvnv4isoxQy2vGmSryqsjKcHhItC6rXFby8GDPz5JocpiXSa61FtXu7lOGajKdlGWqKjcZD2klZTmvEhkMBGcL4L+I8o8Y7X/+3//6j0++/KLXcNqBlcazeTjRSrYaLUJomubUcsz2ymQ85hSbnsjjSBa5bVutVkcpNZtOXce5/dO/v3T7x4yxN0x/IVlGgv612z/8SSXJ0bPtPIvbgS0soyqk65hFllNSe45peCKaAUNJsTYNomt0XPd0NouSrLO08tb3f9i/cevN6wWLMxmgq3L87Itff/jPh3sPA8FcQ3GCthCcUkRSaaKFi6pmqEDVFLCuVSFxHKam1/nB3/509e33Tb8LQN4884VJBgCo68mTB7/4j3+Q2aTf9as8Aa0pZYQw1/MI52kao6xBSUYZN92jKAtLcudHf3ftex8wK1gU7UW6f0KN7uB6c2n15Gk0mSW6zhkQhaQo5cBuuMKcTSNZZMLklFJJVa55a3l9eevdBeoFC79jEtN75873j57tTOMQpARASq1aAREB89ySDJM8zosKEZCrkjib9952u6uL5bzwazkJllaBGYSZwg5MS5iWW5QqRzfLTN5cb7ktQ5WqKPJKKc2CoMUNa7GMFy4ZHD5/jpR7jfZSbzlotBy/Rw1BRZBQa1mXpkxlfJxMjuIwnMVplYS6yqhtLpDw4iVr99Y237oloGo2fNMN0AjQdA3DcQwhdV0Wc+p4raAnoshL8/bKgNIFZ9kiO+bX0LLI51DERRrLWpUaNTFNbltYFQhZrdC0DEJ92xG2ZVo2My0gC/AWv8cFkOwFEDUgaC0RKGhNtETKNBCgnBLC2EJ1egnnJRmiyuPZ5Oh5t9PNy9owbcdvcGErWeoiyWcjyrntt5hoADNBFtHJAWWYxRFo9Bs9p7sGhq1kqbIZUXUlleU1uWh8lV/J9CSfT7SUre4SGLbp+FpDOB7Njg9MogkhyIXfXWu0lwj98+t8XrVMy+rk2ae/+fjDzf6lLGftlcuDW3/BhR1OhsPtX6qjbaCG3d4Y3Pwru7dRzKcPP/53IuenJyMDjc7yxt2/+RnrbRXh5GT743J+XEnS7L+zfP2e5foA6tP/+VDOdlSerQ+uuoPv9t++jUqP9h49/K9/8SBnFHizv3Hnr/1Wh53DC56XZIRAXU4ZTo/2Q4N3pdsxmQEA8Wz85fanIjlGtGBcLl29bxOiwCjALrNQEguA5JUCQACsi/hw91E62TXs4DQDe/lKz/VBFifPd4xwWxfZ8/npqrvUhzsENNMlq+a0mjCKwvOZrs7pz9R5SYagiyxu+HY2iYRNsaqwqgEAsUJSS6UANWqopQYAbjnt/iC3eRrZTFPLaWnDY4BZloTR1ASldT2djJN43lsFANps+Ok4wzxVzIpOJypPiWFRghwUkbllGUxXBDSiPo9XOzfJNJqmA9SSmmrCmGVRRgDAdd1Woy2zGUFmBrYtDACoZVXNZ7pKSV0SwgAV4Y5SWiF1mh2WKwmmMAPKuEYkCJZpTzVVijCpfSC6rpghGDNszxesSQkqyhHhnMr0udUyhUpbQXOwcumuqqmUvFLaBpAVAAjODKKQqTqZHHtLl1BWdXSC5dSCqsy16Xeoygl1LTfwO5cc3pvGaat7tbu8TCnRteK2v3njjkoz022A7StEBoCUmV7b9wWqWjodwg1yPj32vDqmqorT0b5lELfRzfMyiWetpb7wGtHJcDY+xHIia2BWI+isdlbWa1mdPP2sLuaWZVYVul6ztXaZO14WR0l4JCw2n8dO0Gv21gkhIMuT0TPPUCglNey0gqC7bFh2NB6mJ/sWQQCtmbDaa363T89hoPZakiFKVdeUc0qNP32mtSKEEMoQUauaUEYp00pprRGlRkIppZQyyhEAdIUypsxE6qJGYIwSglojagJEo2LMAEIAEQA06q/NA2FaKUIpIQTqoq5KQzgaNQAQygk9lwHk2SWL4+nBs72iKJaWlvprA8pf496HKhrtnIx2kVC3c6U/uPpHzxVAEqdco8GZ4dhf7QEVUg+HoyuDPiAm4WR357GmRtDqbW1dfjk0AiH40iwSEeG1juzZa1mdxGV47DiWzTCbHWbRVCsEymxhWLYzGx1QyhurlwjQZDISfpMZYn46Eo4nKwmg7WYznEam8Jorl/I8f/zlTqfdMCjI5KSOxHR0YHHmNDvxdIqUeN1ePYtGwyET5lp/NZmFjudQOwgPdmHQL/P0ycNf2w3Xdg2ZnaQTUuY5I6SSsiplq7dKdWWaTGmllJ4eHzNTNPublu2fbah7dslkWSbTU5JxZZmneVEW+WQ6W93Ymh2Og8Dfe/zFxmCwN36e50WRpkGzbTluOo8c29GESlXTIU+zavPGLcp5WdVFBZ2lvuMIzOJotH+0t4OqCtqdqpbctKbHB7KqARGQjZ/NqzQbxlFjdYBlBQB1XYezyeaVjSgK83k4KudVKblhoFaIpEzjODzd2rw0O52YljU+HrvNbq3Upeu3gJzl5J79PyZlvNnuLq1vNjqdWmvm+Mx2Gp1lhTzLM257dtCcTmZhGBtuUGusqzpodrjlmLZnCjfPi0pqy+8AYZRSjVBrEofx4XA0fH5Y1koBDeO5JEz4zXmSzbOScNP1W0cnE6R8nhV5WeZlAQCEEsMwABGBzsJ4Op0ZtqepSbkB3Jwn8ySZl0UVzeKyKMG0mGVHs0if1bSdPcsMIZCwWTivpWaWzyy7xRwufL+3oot0NN7zWsnGW98timI8nbhBq9PpGpaNhB4ePK2LMmgve9Q0hQ0ArucvrfZ3dna1LAPHFkEnK2tqUMp4mFQVJHZz2fN9xngUznLFHWKJZs9wGl3XAgBhe/1rN3772SMhbMsJVlbXbL+hlZ4cH0ZJ0u0uWcLdGx7rUgVcTE5PKrTWt67Rs25Gnr38y7rMoylqxTmjjBFuAWGUUS3LOpv/6pNf3L53320tKVmn0Uy4gWGaQAkhLI+ngJpbNmGm5biEUESsymIezigBIQQFXeUJN40onE1PJ2sbW0J43DIQSJUnWtdQS2qYzOAEuAg6ACjrMpyMUUnhuo7nAyGAkM/juq5sP8BaVmVKUVeqHj7dX7963W8tc8M4Wy17PV+GCL+/yBECQAAQEHRdhtNxu7cGX9kirV8smyAAAdQvBl7kT6LBCyeBQEiZJUWRN1rdl3Zl8aWACEhemp0hak0o/UPYF3Hg646JVZ7lefZ/A74yzsHKfhURkbz2Tg5qDQQB/myjMkQEQPJ6y8oXaMT4TcFF2ZX9BuFbyV4Z30r2yvgdruSv2H0EWbYAAAAASUVORK5CYII=",_imports_48=""+new URL("image141-1cD1k0PC.png",import.meta.url).href,_imports_49=""+new URL("image142-B41Sc4pH.png",import.meta.url).href,_imports_50="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAF0AAAAxCAIAAAA3JTK1AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAN10lEQVRoge1ayW9cyXn/vqq3dr/e2WzuEkVSi7U5GFvjsR07ysSODccY5JBL4EMOyTmX/A85JacckkOAADnFCQLDSBCNExgZZeIZyZZntMxQI1IUd4rsfXv9lqr6cmiy2SSb3aRMI5lAHxrd1dWv633fr769HhIRvKYjxP63Gfg/Sq9x6U2vcelNr3HpTa9x6U2fe1yIJAGceVT93OOiFC2tvcSzXvakuCgggM6eEOx/pbN4tQUkOLDtBKDagz7qoEitbxcJzxgZ7YTXIalCpXn/8ZqQbJddAsC98d5V7dnddySg9nh3quuq/V8RkKS6PJuZmcoS8m75StVmsdw8P5nVOe/DmRBnn5qeGBfAuuvdf7zhCaUUMUTOUUnqCKkUChEamgYMFZEIQ8MwEBQQI6RdEDoA7eKyC5+SKpbQLkwOAQMiCoUgQsZgM1/9+aM1w9LHhhJSgK4xrvVQcOxSls62KID2LNub75KlzQPh8Vp2UlwAgAi8QPkyzCSsbDICpCRpn74o6BwFUdw23vri9KPPtnfKtVTM/PqXZu9+uBCGwDRQEpGBJEIEDgwQpJIADBGRgBCVElICAQJAKOTCynbLk4ahVRtu3DE3t6vFkhuE4dRoejSb7CULdY8q9x8W/+6HqtYEzoDQunpRn51svf8LKlUVMuBo37yU/ZMf6LbRx/ZOgQsAIFLGMX/rjfNPnucL1SBqicmRaDbl1Bo+SPXFSyMr68XpyXES8q1rk/d/+fy737y8vJ7PZVNbhbKl6y/WSxO5pG3pO+VmImqaJnNsa36psL5T22eIs3OjmUq99fNHL4DQ4KxSac5N54ZSacvQ+rsRAlCe7374MWzuJH/7LZCSEL18ufHgSXR8GCdzDFC6fu3OXef2143rl/osdYp4RACM4fhI/Nx4uuWFYSCFr67PDCei5o25kamxBNMgNxy7MTviekI3uMb5tbmcFOLKdCZiGpens2PDiUzKnp5Izk0NzU2l47Y5notPDDuM7YvLGHOilmnqzzfKIeHVK+NbpdbDZ1umwS1TP5azDi4tDzxPDSVrTbe8tFZd3WourfofPqzPL9VfbNWW1pukyLbDZwv9HfXp9AUAIrapaxowuHllOB2zIyZffVlPJxyNESNIJ23L0FqeAEAGTOPcD4WmoSI0TU3XuBJS42CbmqkzRcgYGhpngHveoE1IAK1AosaScSuUtF1ohqG0zWN2ce+vBEBCqiDUJ8adr95qzS+oRsMeHSalEBE45yPDxni2NL+E5Xp/MU+HCyksV5uuFxo6j0etqG3Ump7G0XX9pusRULMRqCwxRgQKQQERIyQCAOKIk7m4bWDgC0BQbfdLAEiEBwIKAQGqWERrua2F5bwUYTRi0G5E77nNuP+hFITCnsiZ5yfL/3xHbe7wZIwQQCpZqiS//3b8jRtV9o84KA88BS4IoEhtbLuPnm0OpyK2pVebweOFfCpu7RQ3XM83TePpi6IiGY/pz5a2G374ydJWzQ2fvtgplt2ltWKp7mZiESKoNEPTYPVGoIgKZZfUPpehCD9Z3BAK3n7zomlpEduMO3YoxLOl7Vw2OTma6eN2O9kAN01SkhjTLk3zXBYBEJn36YLwPGYZyBljAxzIqe1IKAp9GSp68mzbtvTtgttoBoEQrVZYbqxIhQ/mN75/++pHn26YtnHnvxYViXsfrSqA/y40FJHGq0gglEIkRbC4ApKIZDuIAwIFofzZx8vIjDevjzVrYa3hKaAwEPc+Xrt5ZWpyNNOfPQQAxNAPTJ0Z6ZhafUnlOiEAA+Z7ejoZNF2ua0qp/uucFhfUdT49kfID+f5Hy9uF+vnxxMhQFICePi/mstFsKrr+snTxfPbFyvbvXr740w8Wb1w5v/B8x7T0ZytVjWMQhACAuLfHBIgAe36XAAkwCCkWYYrYi/XSVC6+XaoPJaO6aYRSnohFjXtPl1SrxQJhTI4DkFICQGlpx3vyNCyUSUh1hnbUlsfzxMJa6db1iW99dfaDh2uWweMRIzcUM7g+nIluFetSkcZ4yw0mRhKjmejMeAolLKwWOSIgMiQA3E9/cReP7hyEI+oca25YKLfmptL5Uss0DNNou+eedCB/Ic6DxRVQyshlZLUOUgERAaFtapm0e+cudxwcZEenrRuJiJY3q//xs0Xb0n/jyohtoJIEDBNJO2Jpz1ZKy5s1pUBIYoShoofzW6PDsSsXhruLnwGbhaQAhFBSAiILJQgFqI5F5YAzRiIEEIoNpYXvheUKaJpiTHHdW9nSxkbQ0EgpNqieOiUuRLalzUwkVzYrz1YKjm1M5eKOY+kaazZczpkIZMI2opbOOZq6xrkqN/2Pn66O5GIAxADaWfs+U71GCgAQGEPPC3YKDSCydWT9BOmqvQgRADWNhBLbJXAcNnuezUyxmUnhtsJ6E0wdAc/YvxAwINI4ZDORrUK9VPEcW4860g2CxdVS05O2BaRwfulltSUXVwp+S8YSkXyh8vizrX0n0qUtSD10h4gQ4MJ4ytIw7piBCKSU5bo7Tqlj+Oq4J0BkTDMIkdsmG8/KraJc2SApFCMjbmupGIQKGcMBGntKXBhCK5DzL0pEUKoHnids07AsjqCqjXCj0DI1cH3xb+8vVureew+W625Qa0EroMLzPEPWLQR1vXf7B0RgQDpjUyPJ8WxCKmFb7N7DzVotSCei/bUfARRDMvQwCCBipr/3LdopgVJAAAwJCR2nSsR1Bn3V79S4EIKUVKz6iEikgKDh+g23LSr6JH2GCmi70EQGO6UWMGgFLWyrwJ5JU3c3Yjey7otmcP7NW3OWpmmMaRwB+OTIUBDgzER6bio9kEMEgjC0Lk+b1+akAOvKrGnbvu+DlDwakUKYv/MVuPcE+Bn73V0ZiAgBEZGxtrvAtkdoNw7a1C6Yd//U7ecOqMrhT8751ZmxC1NZRe12FFq6NjOR/vKNc8lYpA9Le0NUQtgXpyOXZgr/8K/NXzxBXXfnn1c/+AiRNxeXZbkO7KAx96JT5i+dHe5MUFcy0mEOYbdrQIeDCA4KRowh2+eKljcKjaYnZOhE7NlzuX5sdW4hiVtWbHQ4b+pBvhACBKub/vp2dSi181d/n/r973hLa31iW5tOicvR5fYgoP1v/ajLgI69OF+uPXq6mck4pq59svCy7np+INOJyOhIKmqaAxhEYpxV7z1qfLbg/uR97QfvbP7FXzd+/FNseK33Pox9+xvpb39j/UfvnmV91JvogJCdu/UBaFAWQ5V668H8y6996XwsYggiBfzWtTHb0o/oZY+FiEApYU9kU+/czhcr5nA2/ptv8JD8fCHxvbetS9OFH7+r/JAGZc6/Ai4HRT/Ech+NOIlOuX64urHddGOmqXOmIUPGmKUbx3JycHk9l45f+0Jlboo7UXtqwro6R8uR6Js3oek33/1PJDrjeHRAoLZn6SsiHbEZ7J48sGyHUQQFhsGdiL22WR5KJkQYrm1Xcynn+Ny9q63FOTct0DgAQCpFMUcCKE2r/Ojfq/90h0gZ57KGaeGgePSq+oIAdASUg74G4Bi1oYE6gxzBMg0Ebpp87WWDIHphLHVs9OxWWyWlVODLwPNTt7/CotHiT+56n3w2+md/zGwTANhQsviXfztQvlfC5ZAW9DKoHuh0hgN6tESkAJmh65yxuGNX6q1UPDKUcZSSDBkcLW26+nVKEgqqvf+gfu+XLF8kXRMbO6xWa8xMoWVwhTQzifUW0Rn3GfaY6JxzQG9HeqRchiO/HVpzP4+RBIauW6YmlYpGDNsyhpIRkqJQaWRT8b7HAQAE5Hnxi+dTf/BdqtbA0Gvv3Q8XVuO/d5sPJbhCiln5P/8bkGcbj7oU5NCJDPS0jF53P/bi9jxBEMqUY2hI8ZjFGWVSkVorePDpxuzk8HA60fNPnZXR0JhjsGgkenmmPenniyRU5Ms39KHU7nmgxs+6z3A8ynQg6ewa9bKaw8t0NSKlkk23NTHqhKFMx61m05ubHFJKluuebhxz6thlWWibNJIFy+rMKEMn00DOGYAGoAGSxDPWl/269ahcPWP2wUb1oRzn4Lq7toSEcceobHmrW/lYVMuXsVb3IrZx89L4ZC7du/VNB24okYmgFboehCHqGugGOZGwXEUA0JnyQ+G6YFuHFzlIp+0zHE/HpbE9nU5HQRDooElyjZ8byzxezFcbfjxugVLIoO7628X69dmx3urXmSPQDcOMx/I//JeN+484ARh6WHfDSk3euYumwSxDCBmWy/zKhWMPFwDgFLgQ7mnFoKRzUGujB2rtvi5ROyfSdY0hapzpnKMgy9JdN/T9sLeyAOyfkyAAYuLqJf8Ll8P5BWIIgAiom4YKQpKSeQGPO5k/fMe6PEtAeDwwJ8WFgCRRKxBeqAbVXKcmJVUg2pk5EUGzFbpe2PKF54eeJ/wwaAWq6YlASFPv5RAP7oR1biz3p38kyhWGu8f3BAgIxBhDpjkRHndYNHI2542EEI+Yt66NhQMC/6sQKTWWiyEiAEqpqrXm6FA0FbNiUT2MglIkBFkmqzc9M3n4KBbbT0t0z2jcGs3SaLbLvPZ+OjFLJ37OAzGTdL7ztcsDreQViACilsYZB0RkmE3GkrEIAgKQAtYeEKmo1as+IiaFwCMWhseMT0ineP5F07R04leuvwcRZyzm2PvNvU6+cyjmdRhjODGaBlBn+0wcfv6fgycvCC3jmFL7Ven/AS6/FvrcP4/5a6LXuPSm17j0pte49Kb/AdURCDVri81vAAAAAElFTkSuQmCC",_imports_51=""+new URL("image144-R1p7h-7F.png",import.meta.url).href,_imports_52="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGYAAAAqCAIAAADOJ7kiAAAACXBIWXMAAA7EAAAOxAGVKw4bAAALU0lEQVRoge2Za1AT1x7Az+7mCRsC5AUJbyFESHhGgtALA0Uo4lWKnc5Qmbb2dmqL0T6un3Q6VfuhTlu9rY5Oq3asnbFKR6/tRaAqFqcWASmPlvAmCSThJRIgu3ltkt37Ya/Rq723k+p9Tn4fMmfPnPzP//zOYzdZiKIoECQQ4P90Av97BJUFTFBZwASVBUxQWcAElQVMUFnABJUFTFBZwASVBUxQWcAElQUMw1/CMGxlZSU8PBxFUX+lw+FYWFiIiIgICwv79ye3sLAwMzNLkqRUGi2RSOhKn8/ncrm4XC4MBzbfOI5PTU1FR0dHRkY+SlbI3r176dKFCxcOHDhgNluKi4voGqfT+eWZL/fs3gPD8Jo1ax6lm9/AzZs3T5061dbW1tnZ2dPTw+Vy4+PjAQAGg+Hs2bNyuTwkJCSggGNjYx988IFEIklKSnqUxO5NlMFgmJjQNzScwzCMrpmfnz//5/MGg2F4ePhR+vgNYBh28OBBDoej1WrfeustiUSya9euAd0AAMBms33zzTckSQYa0+VyWSwW/+h+M4z7L0Qiodvt7ujoKC8vBwCYzWazyVxaWkoQBN1gcnLyxx9/tNvt0dHRBQUFKIoSBNHX15ecnKzT6RwOR0VFxeLine7u7pUVm1QqRUNRgUCQkJjg8Xi6u7vNZjNJkvHx8QUFBQCAhYWF4eFhkUg0ODjo8/kUCoVKpaK3m8lkGh0d3blzZ3Z2NgBAIpGYTKaFhQWz2dzY2GixWJqbm8rLn5JKo00mU39/P4ZhYWFha9euFQqFXq+3t7eXz+dPTU0tWZd4YWH5+ZrIyEgYgmEEhmCIHovRaOzp7XG73CwWq7i4WCwWDwwMwDCcnp4OAHC73UNDQyiKpqSkPKDs3sa8cePG1NSUWq3u7e3btGmjx+Npa2ubnZ3Nyc1ZWlrauHHj0NDQoUOHpqenYRj+S2Oj0WBQq9V2u33Hjh1j42Md7TdZHLZAIDh06E8//fQTm83W6QY/O/kZwkA0Gs25c+fOnz9PEASGYY2NjTKZLCYmpuvWLa1Wa7VanU7n+Ph469WrcXFxMpkMAABB0MWLF41Go1gsjouLCw0N1Wg0MbExc3NzTU1N42PjCQkJaelpOI4fOXJkaGiIwWDc6uqymC1p6WkQBL3++uvff//98vKy3W5vbb06NzdXWFg4Ozfb2notL0+jSE01Go2HP/5Yb9Azmcyent6OjpuFhYVNTZdOnjy5efNmGIaNRuPu3btlMplCoXhA2d+doBRFrVu37vr163a7HcfxiYmJsrIyBEEgCAIAfPHFF3q9vra2duvWrU9XV59raNDpdB6PZ2Ji4mZ7e01NTc3TNd99990PP/xQW1v7wgsvlJWVWZesc3NzAAA2m11bW/vmm29u3749MiLy64tfkySJY7jJZFIq019++eVnn3120Wrt7OykMxEIBFqtdnp6+u23366vr79w/jyPx+OH8VNSUqqrqyVRkt9v2hgbG0sQhFKp1Gq1Wq22qqqq7Xqb0WikFymCIHSqubm5zc1N9DRAANBjuXDhgs/n2/XHXdu2bXvnnXe6u7tv3bqVnZ3d3t4+MDAAANDr9ePj4yqV6lc2JgAgMzMzPJzf1tamVCr7+/uPHj16+vRpJpN5586d9vb2oqLfqdVqBoNRXV197NixwcHBmJgYFotVVVVVXlHhdrt7+3rlcnlRURGTyVSplImJCRRF+Xy+DRs2dHV1HTlyxGazjY6OiiVikiQBRYWHh1dUPBUVFUWSZHh4uP+ggWG4uro6Nja2v79fr9efOnXqUlPTtm3b8vPzRSIRm80Wi8RsNjsxMRGG4WvXrp0+ffrOnTtTU1N2u52iKBiGi4qK6G2+alWSw2Gn/6+nAAXDML1zrYuLra2tJEmyWCyDwdDe3v7GG2/k5OS0tLSoVKqhoaGcnJyEhIRfV8bj8crKylpaWhAEoSgqPj7e6/XCMGy1Wq1Wa3x8HIPBAACEhoZKJBKr1erz+ZhMZm6ums1m22y2lZWVGFksk8mkh40gCAAAQZCLFy82NDRER0tTU+U4htswm18Nl8sFAJAkCcMwvQRoQkJCnnjiiezsbJvN1tnZ+e6773744Ydnz571+XwURXl9PgCAxWI5duyoyWTOyckRCARjo6PU3dsCl8uFIZgkSQAgCELoSggABIYwDMMxzOF0jo+PEwRB+01KSgoJCamrqzt+/PjOnTvHxsaqqqro/H9FGYIg69evr6+vDwkJSU9Ppw9jiqJQFOVwOBhm97e02+1sNhuCIAiCaEcQBDGZLJfL8bfQDAaCIAwGY3JysqHhXF5e3jPPPCMUihobG1taWsDdQfjf19z/4mZkZESv1z/55JMoiqIoumHDhr6+vjNnzuA4TmulPy9fvmw0Grdv12ZlZa2srHR1dJB3g/hIHwnIB8JSAFAUFcLlUhRVWFhYX19Pr8qIiAgul8tgMIqLiz/66KMbN26YzaaysnUP+wIPP/1DEKRUKhkMxrfffltZWUn35/F6xWKxSqlsa2tbXFwEALS3tw8PD69evZpedHQzFEVXKxRdXV0zMzMAAL1ePzg4yGQy5+dvWyyWgrUFiYlJPB7v2rVWBEEQBAEQBejt8hB8Pv+TTz45fvw4fcliscbGxvh8Poqi9L7j8XgAgMnJSRTllZSUREZGDg8Pz87P07MIAAAUBCjo/pgURUEAYrJYbA4nIyvLYDBwuVyFQrF69epPP/3UbDYDACQSiVqt3rd/n1gsEQqFv6js3ipzuVwYhlEUxePx8vPzm1taCgsLvV6v0+nEMYzBYLz22mu79+zZunXrqlWrrly5Ul5ekZ2d4/EQNpvN6/UCANhs9qZNm7q6Ouvq6jIzM2dnZ5eWlgAAqalyqVS2b9++NXl5Op1u/vbt2/Pzs7OzHo/HZrORJAUAIEnS4bC73S46GYlEsr5y/eHDhy9fuZySnGIwGHQDuvcOvMdkMhEYHhkZ2bd3744dO3Jzc5ubm1999VUAgMGgHxoa6u3pSUlOxnGcINz0ZBAEgeM4RVEsFmtmZubQwUNikfgPL72k1Wo3b95cWFg4MjKC4/iLL74IAGAymSUlJZ9//vmW57ZA0IOyaO49ZKAompGRkZ6ezmAw4uLi8jUa+n7B5/OVSmVSUlJUVFRGRgaPxwsNDa2srKyrq4uKikIQRCqVqtVqPp8PQZBAIMjOzhYJRWH8MLVaPT1tkUiiKisr09LS2Gw2m83Oz89/bssWRWqqSqWKiIhISUnJzc1lsVgIgohEoszMTP9DhjxFrspQ8fl8NBRNTU195ZVXSkpLmEwmj8eLiYmJjIxUKBQqpVImlQIAEhISampqSktK09LSpDJZVFRUXl4e/RuLw+EkJyerVCoURePj4wUCgVwul8vlSqVSKBSyWKzk5JTnn39eLpfTpxBBEF999dX+/ftFItEvO6Pu4vF4XC4XXfZ6vQRB0GWCIPxliqJwHF9aWvLXkCTpdDrpI9mPz+cjCGJgQFdSUvr+++/TlTabbXFx0e12URRFf4VewiRJ0nHcbvf9HdGVGIZZrVZ6mfhxOp3Ly8tut5uiKLfbbbVaMQwjSZJOlU7J4/H4x+J0Ov1jWV5e9g/T4XBYrVYct98f/OTJEzU1Nf6vPwz0eN+Wz8/PnzhxgsPhCIXCK1eu2O2O/fv3ZWZmPsYu/nVcvXr1559/vnTp0oEDBzQazT9q9piVud3u/v5+nU7ncrlkUllWVlZMbAx9i/gvh6Ko5ubmqcmprOwsjUbzi48XNI9ZGQCAJEkcx71eL4qiLBbr8Qb/l4JhmNfrjYiI+OfNHr+y/3uC/8oGTFBZwASVBUxQWcAElQVMUFnABJUFTFBZwASVBUxQWcAElQVMUFnA/BVJe8nbXkDg+AAAAABJRU5ErkJggg==",_imports_53="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGkAAAAqCAIAAAA/LOKvAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAMaklEQVRoge2a328cVZbHz7m3qrqr+oe73W67nTj+mbRjbAiO4w120MRZmNGiZZESzbzs7DNCQkL8CTyRFUI7EuJhsjuBzD6wAl7C7uAIFBxnEnA2CXZij39gxyHt2N127P7ldnVXV9W9Zx86gPNjRytrd9Aafx9K55ZKt+t+6tw6P6qRiGBHWxL7sW/g/7F22G1dO+y2rh12W9cOu61rh93WtcNu6/rfYUdAP5jwU0kYlceeLYMoSVdICVICCJSgSsYA5XcXEAAhEH435sQAUZDGFU3RAAARHzvzdtLD7Gwpxxfm5tfuSkRBLkoCKbgEzWUcmECSCAJBIkgGEoEQAUgRpAgIaMYTza1hr99nBBljyLY5vgfYEVCuXPjs6oVVx/QF/RIJiLiUDFAwJhElgEQAhgQkiRAQABBAE8RKwusyhbO9sT2MmC8QAPgJsSNJsuiWzHJRC+pKUJeMAEghAGRlBlJhQABECuO6qpEj0HFRkJRSqJwZ0lzO3llOBhXdQMXr8Spez4+2rL+IHvI7sG1L1TQyNFshFwERpAAAcpAAGQMAV0hHBLz+hnCNTljKFQqWmTDALOctad/LpHOBmpI/5LiuIjXY1tt2MztEAAmAmpq3yzbaDgMGpAjighggYxwlaIAqU5m0gh7s3NOqRiiVT9/O38qWCtIur9uyZJqO7ZArfrQ1/aX0gN9JQMG4zfnKRrbkgo0SSHJJ3JWGVDghY7zKH/D6vODRba9mMtQYYMC3NJc0NwpquSyJOY5DrgBZSVZ+Kn4HBOAC2hxWiuuWQJuRxpgHuRdZuDq0sWGm87kVUfJaeR3VZSpNrC7oqMZ21S+urnKzXOVK5F4gwkqGR9s88X6AHQIyIkGULK27kunA20L1B2r2NNbtitTVzq0lv7o1+W1uOZfJeBR1qZR3zGJtdbRVs+5YWeY67WB4beQSXIURw23tcwAPseNAipBEcrVsSokBC/ye+p+3djfFdn+7umSt5VRVdVWWdouyJFacNJDMqXLp2/LdUk4h1sIMw0FO4HCSj1QXU1NTiUSCMQZAsVh9R0cHIk5PT+fz+e7ubl3XJyYmvF7v3r17JyYmkktJrnCPx9PW1tbQ0MAYA4B8Pj82NmaaJuc8GAzub99fHakGgPHxcUVR4vG4oihF0xwdG1tfX+ec616968mucCi0lEzOzs22t7f7ff6bN2+apklE4XB43769kUgNIhLR5OQkEXV0dCiKAgB37tz5+uuvNzY2wuHwM4cP19bVPcqOv/HGG5uGlDHXry3cunLvtoNSU5TGWINu+JbM/Fdz42evDd/KpFZK60XXsW3HdR2XqOQ6mfWcZZUYYAsLtEojEo5U1UbDviqPx7PZ9c6cOfP73//rrl316+vrZ8+ezefznZ2dp0+fPnPmTE1NTVNz0/vvvZ9KJp966sCpU6f+eOmSYRhzc3MXLlyoq6uLxWKIuLCw8NZbbyWTKUVRRkZG5ufn4/F4oVB4++23r169+vTTT1dVVa2urp78x5MzM7Mej+fm+M1r16/vrq+fnpl55513WpqbOVfefPPN1dXV6urI0NDQtWvXOju7/H5/JpM5efLk5cuXjxw54vf7k8nkb397anp6hnOezWYb9uyJRqOPsnvglUQADBlHhkKAJFX3LDvm+1+dOzN6/rOFiW/M1WQxVygVhWWBFILIlU6xZBZLRXAlk0LljP33pVgmm8nlsl2dXTU10YmJiaWlJUkyn8/PfjP78ccfj46O5vP5TC4HJFOplKLwZ599Nh6Pf/rp4OjYqBACABzHWVxcbGpqGhgYsG17cHAwkUjcuDE6NTU1MjJy/fp1InKFWFi4G4lUv/i3L8ZisQ8//HBqerpcLqdSqWKxZFnW4uJiKBTqfOKJ5ZXlyT9Nlq0yAFz5zyvj4+NjN26cP38eANLp9NDQF6nU0qFDvcePH29paXnsin5gd7+IZ4wx4ILAEdZGae7O/OTS7asLM9PZJVsFARIcG1yBjgRHgJAgCYQEKdGVCjKGjAAkbCp1v5OhG16vd3lleXh4uFAodHR0MGThcLi395Cu66d/d3pxcdGjqoCoqmoikRgcHLx8+fL+/e379u2r7NnKcWJi/JNPPlleXu7u7lZVdXT0xqGeQ/F4/NKlS+l0Wtd1TdNCodDEnyauX7/+V729jU1NiOjxejRNQwRVVSzLGrlyZWZ6prGxMRgMOo7z+WefDwwc6+zsPHfuXD6f37Vr10svvVQu2//8L6fOnz+/trb2WHYP5SggFFRUjduuj3liWiC/vAKuXeJSagAoUCAKYAIQgUgSIrDKdzYiBiQJiEjK+w/iwTceIjLGmpubQ6FQMpkcHho60t8vJXV2dR09+rN/+s1vZmZmnjl8GICEENFotL29vbu7OxqNdnR0VKghoqqqsVis++nunoM9++L7bs/fHr44HIvFCoWNoaGhE8dPtLa1VX5ISjk+Pv7KK690PflkIpEgokoByRirqqr662MDi4t3b94cvzU/77rOyMhIT88hc2NjdnZ2dHT02LFjr7322nPPPffFF198+oc/OI7z8ssva5r259gRgGAAgGS5fq4/UbOnJH3frN1dtjYsVwBDtIm7UgEmORMMCACQGIAEKZkiHZeICJEQAB/O7XK5XD6ftywrEPBbljU1PU0A+Xxe09S+vv6/mZoeGx2zymUAsG27vr6+v78/EokoisI5r8zgOE65XI7H4wPHBjjjpml++eWX1ZHqY8eOWSXrvdPvDZ4bPHHiRKlUsiyrt7e3u7v73LlzR/qPlMvlfC5ftspEtLFhmqZpGIaqqgsLiXv3Vi4OD8fj8f7+vlKplE6nP/jgg8bGxps3b0RrovF4/MKFC6v/E79DQAJ0yJVEzbv3/PL5v8Osdeb8R3e/GWWGSo6jOaAiZworOq7gRARAwIkAJaHiaDZxAoaEj+nhNTY2Hjhw4OLFi5qm9vT09Pf1+Xy+1tYWzrnf7z9+/Hg6nW5qahJCdnZ2+nw+n8/n8TxQERuGcfjw4YaGBq/XCwC5ZI5x9qtf/uoXz//CdmzHdlLLqWKxePDgwba2ttra2ldfffXdd9+dnJyMxWJ9fX11tbWGbvT09BQKhQ8/+shx3Ndffz0ardG83r//9a/7nnmGiHw+39Wr1zKZzPz87avXrquK8rOjR1944QVVVR9lh5u/bbtEM4XU7748d+rCvzfGdv3D0RefbT949tr5fxv6j9zGus7V/Y1tzY2NU7fnppfvCiaBAAm4IJejpqkDRuPzWkPb3r1NXfv3RvdUBYKbQ9HKyoppmiQl49zj8USjUcZYOp1GwGhtVEq5trbGOa/ESsZYxek236tlWWtra36/PxQKAUDFTaqqqgKBAABks9lCoRAIBNbX1/1+fyQSEUIkEglD9xk+PZvNViZMpZZd16ls/0gkgojpdDoSifh8PgAoFAqVYS6XKxaLjLFAIBCJRB7L7kG/Q+QExJE0vpJZGxz+fH1t9U7+nlrlr2bs5719h586NPPtnFk0pcpB4yABJXCXGANkDKRgAAyQEOmRgFv3uBSptra2YjDGvrfr6+sfvRIAvF5vQ0PD90Nd1zcPw+FwOByuGJUznPPW1taKHQwGK0ZLS/ND01aoVRQIBCpPonL889rETkjHtbO5XMEsqT7/BtjjYjUxO2I5riXsYDh4u7xx9+vLS6mlNEpFNwgBkFAieMDVULMpjfK2LFabG3vWTDJKZBiAbBs3kH9gJxxnNZuZTSQymazXq5cYFjmUwOYITFGyXI6tLti2I4EwoCJqlZqLAASCl8BH5JYpZWaSzNfgqw55dELwV4ceDU/bRpv8TlFckhpXqlRPTDE8oFgoQZIHABlaSK4rVK4hAhDhZnci8NlQRRgCpiuqpqqMM+Coaur3IXJb6gd2nPPdNbW9ZdtApSu3spC+lzXzJdtiQjJJaAMiAqKQgsEDO1EglFXweXjEpzf5I+11Dbt2N9TEYr5gENlPgx0gaIraUrfbYGqTUb3siWTyuWLJkiTIFaoAFZiUEoAIkDGGcL9TIoCKXsYYq9KN2nBNbThcUxfzhYKM8+3dSnkwN0bgXjVYHZYq84cCZqnoukKQBCk9AjmAlIQIRITIgCqdZgIC5AwYah7Nq+u6bvgDAb7dwcFD+V2ljCIC23Uq21MSVb61cgnsfh+Y7lO73xUmIGQCgCEwQM6QMca2c3j9Xrjzv88ta5u3xf9PtcNu69pht3XtsNu6dthtXTvstq4ddlvXfwHJZClthWwfPAAAAABJRU5ErkJggg==",_imports_54="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGsAAAAuCAIAAACgSHCEAAAACXBIWXMAAA7EAAAOxAGVKw4bAAALBElEQVRoge2Z2XMcRx3Hf93TMzt734d2V9rViSxbiY0tJ07i2LkgcTjCHagCCiiK44GqFPwBeaAoiuKRoniBUAESSOEkJCGO4wPr8iHLXsmWZFnH6ljtarWS1ntqd47u5kGOAynHOFmngNJ+Hmd2vj396enf9PQizjnUqQH8376B/3vqBmulbrBW6gZrpW6wVuoGa6VusFbqBmulbrBWtrrB2j/JtpBBDlCuKOWK+q8HKWXXcjmNsg8du4UMIgBNo0OxseODsdw7HgUBa5T/Y2D4WlH5cLFbyCAAWM2yx+s91n/mp7/8zWBsuqIDQsjpsHEs//aPhydmlz5EpvDss8/e6fv83wVj5LRbygo7/PqxN4+dXFnPO93uoMfhdDnePHnm5MCg2+dpCvg+UObWMggAAsahoH95Ldd/bjh2ZT4WX13l9mjYo+rwytH+4cmEzRdqC7tvf25uOYMAIIuCyWa7PDV3NbEeXynF4muJ+LTTE7gwuXhhcnEumQk0BJuDLgHdVtpWNAgATocts5YfvbpQVHipqE4vJKaWVjVi2qjqyeTyXGLZ5/d0hL2343BrvUluYBaFh/btjjY1SAJGGDMGs1MTd7UGv//0Y20+w9TIued+/+L5ifnbidqiBgHg7s7o3p07iChwqjNdMRLY1uT5zuce/Ml3n97dFR2fGH/uz6/MJtf+Y87tzmLKARDcXmW4k3D4qBoVBVymwsDwpXxxA7BAEOpsDjmM2GI2W+yu+dVibGIGCYZtrU0Wo3SLHHLrZjTG5+YWl1ZWOSaAuIyhpSkc8HkQ+mhlMg6p5UwivaIqiiig7Z3tdpvtjreyt7sj4rUvLKQYcZax4eWTQ70Dg0QycGJKF9F61XhsNBFpm35qf7fb+L6ibmWwUKqeOnth9PKYz+v2et2U6otzc7HYyOc/82TwAy6aPihXJmeP956xe91mCc9MXVVV/cD999zxUfPZpF2dLQuJtGbyWo2yESsGrio6rVQqsij7fT5JNibXyivXNtzG9x2/9zW4WlTfODZ4qq//iUcfONCzy2QycM4XmoK9A2ezhbIG2StTcQBAGKKN4Y5IAABW1nOXL08oioKBh0PBzs6O+aX01OwcAADGdpulozXqd1gBYCKeWE6tdLS3jk/NaboCusqpLgq4IeDvaGsxGOXesxeuzqd+/MRDHpctFPDrnKmULiRS+UK+e1unLJF8sZRKZ8LBwLVCZWohtaOtKeCxr2bz8dl4oVD0+nydne2CIMzMpxLpjEhLgQZ/W1v7zEJyfPyqLGIDwc2Rpmgk8vlP3N8aCRpdbp/FbCJAMFY0raiqBRWy2ZJSzm8P2zzmDz6LVZ32DV956a3Bu9vDn3r4fovJuHncuq3TYrPZ7c6xqdTzf3mtu3sHADvee+573/hKS9gzM5d89Y0j3V2dLqetUCqrHJ8dGT964tSe3d1mk3loZKx/KPbFTx1qCbpPDg6dPjP8zDM/Wi8UKuXS6OglkdOe3TtNZouiUyNAqaLNLabm06XGptC9PTtL5TLV2cWxq5cvjba3NMsSyWRzg+eGHzm4f2Zx+Q+H3/rh17/gsNvfONanKxtOu215fdrfEKoCf/6Vt5qbw3YoF0oboUj76djEq68defTgAz6r0eUsM6rv7W7d1RkRiEAEjBECQJxzxjnlXFP0jXJRkojDfKuZevNziqINDl1KZje+f999N/QBgCAIzY1hAFAYypXVbds7CJF/9rNfHNi/v7nRo1R1Vad779nT1RrRORgI5DeqCoOu7q5IpGlycu7wq2++9PcTP/jGZ/LFamptzRdwNfn2FIql+GLSRPhjDx+QRCLLBgRw987uU+cnfv7rFy5e6n78wJ7ujmhF1TWdrq5nKeMAoOp6rlDQqF6uKum1vKrqxQrtPz3c2RE99OTj1UpFNknT82unhy9v33XX4z335PJFjOBacaPMxF379u0IOyUOhAgYY1l6j4R3ioVE7FYZOINblo+br2Yo1dcyaaSrAa/nvRcghBECLFYpii+txCamfeFoIOBBACCIa4XKa0dPvt13rlTeEBEgBIIgm812n8fR07Ojq2vHqf5z+YpCiIyx1Wo2+O0Wl91qNhstRrPHabNZTBIRAKBnZ+cPv/WlrpaGE31nfvqr3x85O6EBpsSkcIEjfL2XmGAkABI4FjlgkxG7vN4zQ7G/vHpURaLZZHCZjU6L/PdX/nb0zJjVHTQQAEzSK5m33/7H4PnLCqUY38ZiDuFbLwduHiFgbLfIrFLMpBL/fub6fiQRRVXTL16ePNE70Nwe7WgOAAcmYC4QUTZZ7HYiCACAMUdAOAedU4NBDPj8uWypqqmMAtckEwIA4IxhAIyB8XfbcJqkT+zrfubbn/vaV57KbrA/vX4itV7QgTDBcL07FAREMBYoY4ARR2AW0dNfePLjPXt6hy7++rk/j88uRwO2737tsz6r/NuXjvzu8PFMiQGAUSBuh8NssmB0Z9bCN5/FkkG6956ekcn5UwPnHj+4W3z3DMrkNxAWdF33elyPPbhv7MrVeDy+ki1b/VZgzGq2PHT/vl2dUVkSAYDpKmJUwEhEAmWwvJTye1wGQgQEwK8bwwACZ5S+u1dcKperiuZ1OaKNfrfPXVTx8y+8kMmscc7FzRkAgAniwBgwDpwzHRBXGGz/WHOowd0d2/bci4cHhkdaI0888uDejpbwyydHT/Sdbm6JahprDPkO3rerM+gxGES4E9x8HCSRPLzvri9++tGpmfgf/vrWSmFD1bmq0dlk5sWXj8QTaaprhCndrcGvHjogI/2Fl15eL1UI5ohpAuKyJBVKGyVVA6oTrrGqWi2Xzwycv3Jp9KlDD/vMZqqUBFahmzvsnHOqULUK72y4axo90Tt4+vyooumMsdWl2faQN+x3BR2G7OpyamWVAeSLRQDmsFoJ5pirmNF0Zm18YkoWxV1d7UaCuK7Ozi9Nx+fCDYHtLSEDrcigWwjnalkWQBRJvrhRVfXaDd78GUQAAafpy4f220zicGxkdX09HGpgOp1PLHEGLodJ0TeCXrtFIqEGzycP3neyt39oZNxsthoIvhAbKeZy+Vy2pa1FQgho9eLwxauTsJzOH9zfc+jRe00GyeOytUQDTOcgIYyQ22Y1iPhGvTYZTVjAx0/1JZdX88VibjX5zS9/NuR1aGqgJRJ67Y0jY5Gm9Vy2KRx0Ws0mkQTcDoNRMkpkdCQ2eWWiorK2aOP+PTv1Srmvv282FJjP5B95YPee7S3r6QWB66OXJqYnpzBn9+7ZKbudNRpEt/6rJV+uLqYyq+s5TacCIWZZDgacDV5nsaQsJZKtrY1mo5wvlsauTBlNFr/fn1hKcqoZDAajQQz4vIVicSm1RkRBlJDdYve4nXaLGSGYmUuuXyvs3rmNYNA0PZlaJgSHQ6HNRjmHbKE4l0gVcmVgakODLxppMkpE0fSF5EoikeCMuT3uSGPIZbOks4WF5GprU8BpMS4mk+l0hmMhEAiEA15V1Rbm54u5rGSxh4Mhr8exsJSeic877A5AzGo0RhqDsmz4aA0CAAdQNZ1ShhASyWYNA86BMYYFvPnc6DqljBFCOOeUUgAQBIEImHNOGWds81rhRiZljDMg5HoN2fzBe74UKeOqqiKAf+0kB1BVlVImSeLmy4pzYJxjhBACzkHVVISQJIo3kjVVFQghhAAAY5xSyjkHBBjjzYQa+c8G69yarbu7daeoG6yVusFaqRuslbrBWqkbrJW6wVqpG6yVusFaqRuslbrBWqkbrJV/AsHfLH+2FDxIAAAAAElFTkSuQmCC",_imports_55=""+new URL("image148-uMMVBac-.png",import.meta.url).href,_imports_56="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGMAAAAlCAIAAADZWMCzAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAOE0lEQVRoge2Z2VdbV5aHz3Dv1Sx0JSEQMhBmiSlMHgvHI8HVFZtUbKfbwS4PXe28xX9B11pdT9VvPTxUnHTSobJWjJOueKhyXI4HbMAGwmRAxsxYEqPATELS1R3O6QcRTGKvWCHdq4fF7/Hq3n32+c4+++x9BCmlYEMxCP1PO/B/RhukYtUGqVi1QSpWbZCKVRukYtUGqVgVE6nVmmsdxdf/m3otJlIQwnUP8FO+/V8l5qVvEEIikYgsywzDajTqHzuAJElLgQBGyGAwYIxXnwuCEAqFVCqVRqNB6L8sCVAA/ptW5uWkpqanLl+67PP5tmzZ+vOfH1CrY4UlCEJ7e3tjY+PTp0/NZnNVVZXL5QIAhELhtvbW5ubmuadzZt78xsE3nE7numHJsjw6Ojo8PGyxWHKcOUaDcX12XqqXk1pcXLx3757b7QYA7N69K0ZSoijeb2x8//z5vv6+4HLQsclRUlLicrlkWb5x48aFC5/1D/SHQ+GUlJTNW7dECa5PoVDozu07NZ/+IdflOnfuvYKCwnWb+mG9nBSgIBwOC4IQDodjT8/hcLi5ubm5udlisVRVVe3bu7ewsBAAMDs7e+vWzYedDzmOe+utt8rLyzMzMn7KBCCELMdwLAshxDiG6axXMZkmlBBCGOZH+LG8vDwyOqooisvlOnPmjMvlin4uiuLMzExgOVBRsf/dd9/dtGkTxvinZH2dTldZeSAzM8toNKampq7bzksV0+QhgNE88r2YIoqyHAgolGq0WrVKtfqcUiqEhWAwxDCs0Wg0GAwIIVmSGMxEhIgkiRBCvd5gsVhYlo2+H4WlKIogCJIkqViO06jxmuRFKZVlGQAQ/YRQIoTCKrUaY+xISrJarRAh9rtrSSkVBEESJU7FqVXq51N91E9BEDiO0+m1P3wYvJwUhJBBmCgKohDBb12ndKCvv6GhYWBwIBQMJackb9uxo6S4WG8wRITIg/v3G+obxn0+SMnwwOBHH/6b2cwTQjHCk5OTY94xDOFAX//53//ekeTYu39fot0OAPCMPrlXf29wcHBhfsFms5WWlm7fvp23mAEAsiy3trQ87HwYx/OvV1Y+nZ35prnF6/MeO3YsNe2V7s6u5pYWa7x1z+7dVpst6qD3iaelpaW7u3txcTEuzrh1y9YdO8vNZvPqGo+OPmlt+cbd+2h+bs7M83l5eSVlpekZmQyDX0AhxpiilDIIEUoIoQAAQGjd3bqPP/ro4cMuCCGCKBhcrqu7e/jw4bffPkoIuXPn9rVr1+bnFzDGvjHf1KVL0ZAhikIIFSWRYViP50lNTU1yckpiUpLFYnnU++jD8x82NT0QIyLEmCjKX65fP378+LHqahNvkkTx9q3bX3zxhd1ujwhCQ319W3t7XFzcztdes9vtjQ0N758/73S6sjIzo6S6Oh/++8cfP2h6EAwGEcJEUerv1f/ice+vTp5MtNspoV1dXR9+8EFra5sYiXAcJ4ritWtfOXOdvzp5cs+ePao1++NHkgIAIkwJBYAAAPoeP7544UJLS0tiov21nTs1Wm1HR4fb7f7i88/zcnPz8vOdTufc3EJnZ8f42NgmR3Jefp5er8cYAwqWlhbbOjr809MWs2XX7t08z/M8Pz42/mnNp3fu3LZYLPv37TebzY/7+tra2movXkxPT6+ofB0AEAyFgqGQ1+v95JNPEACbN5clJ6ckJtolSQosLy8uLgaDy7KsAAAW5xdqay9+df26yWSqqHg9Pj7e6/E+aHpw5fKVlJTUvzl2LLAcuHvnbl1dnYnnDx58IzMza2J8or6hvre3t6u7e8eOHeskBSGEABBCIAQYYUmS7tXXN96/b+bNZ86c+as3fsFx3NDA4G9/+w/9ff03b90q2Vx2qKqqoLDwH3/3u4nx8dxc13vnzsXb4qNhNTE2/ve/+c3ExERJScl7597T6nRqtfqrP/25oaGBwUx19Ym3fvlLtVY9OvLkX/71n+/evddQX19aVqY3GiilLMuEBUGtVp08dWrnzp1anc5oNIaDIZZlWZbFGBNCAACtra0NDfcwgocPH64+cVyv109PTqF/QnV1dTdv3qw8UCmEw8PDQ6FQuLLywOkzZ2wJCREhUl7+s76B/tLNm7Va7Qs5xHacUQoBgAhhBs89nevp7pmfX9i2bduu13bZbDZAQVHRq9u2bevtfTwwMKBIssFo5HkeQgQR4lQqW3y8xWqNWgotBxmMIaVqjYbnea1OJ4tiV1fX/Px8Rkb6gQOVCfZEAEFBQX5ZaVnzg6aBwcGp6akMgx4jRAnlef7E8RNVb76p0+lWDAIAACCUQoQIIaFgqKOjw+/3O53OXbt2bXJsAhAYdPrt27c3NTV5vd7JyUmz2cywrCwrfv/0mM+XkJBgjDNu3bH91eIiTqVa20j8yJgCgAJKCMEYQ4Rm/H6f18tgLEbEnkc9Y+NjiqJQQpYWlxRZ9k9Pz8/Pa/U6SilGmBBCCBFFcQ1ziiAEAEiSFD1JlwOBaf80pRRB3OPu8Tx5QgiBGPv9fkrp1PT07OxMWloawlhWFJPJVFRUtIoJRH2jFCEEKMUIBQOBaf80IZRSMDIyEgwFGcwoijI9PSXLUmBpyef1vZKaVlhY8PXXN1qamymle/fuLSwqykjPsMZbf4DDy0kphAAAKV2pqsJhISJGAAC9vY8+OD+nVqslSYEAzM7OYIQQRitcKIQAAvot7GcTAxAhiNDq0i0GAgvzCwpRxifGPnj/PMMwCEFCwdzcnKwokiSFgmFKKaUEYwQh+N6aQwAhBIQQCihCSJKkSCRCCPV4PDU1NRzHYYwIoYHAkizJRCFCWNDoNHv37ZuYnKiru9vW1t7d3ZOenp6Xl7d9x45du14z8fw6SRFCIAAIQUVRAKEAUAAhgDAhMdHldKk1GlGMcCqVGBE5jnM4klZGghQgusKIfqdOoVFeEFJCAQAIIoQQooDn+fyCAq1Go0TjF0IEkU6vS0t7BQIYhQIofa5PIM8sU0oBoAqBlFgslpzsbIvVSgnBDEMJhQjqdLq0tFQIQEpq6q9/fXbrlu0PHtx3u90jIyODAwOtbW2zszOHjxwxmUzrIfWsnKMAYaQ36AwGPSVKdnbOyVOnTHEmWZEYhlVkRavTqDUanV4PAAAAPoulNaBg9KKHEkVRojOOi4uLt8ZjzNhsCWffPRsXFydLMmYwwphjOQqoWqWSJJnSZzH6HUEURU8IVYjCcaxarVYIcSQlvVP9TlZWNqUEYQwBZDgWAMAyGACAEEq0J1osluLS4jHfWPfDh//x5R+7unsuXLhQXl4eKylCCIRwtcMIh8JLgQCAACIoSZLVanM4NlEKZmdnVWr1ptTk6GuBpaWhwaHsnOwfvhWIzopSQAmBCAIA1FqNLcGmELK4uIgRXs39kih5PB6z2WwwGGRJBs/v5DUW4YrHkDeZHA6HSq2em5tjGdayJvUMDQ7GGeMMCTZZkiYnJzHGSQ6H1Wq1Wqw5zpxwRPD5xh/39wuC8ELPX0Cqvr7e6/UWFxebTCZCyJWrVyfGxzHGPG/mVCq9nstx5hiMBndPz5XLl48cPWLm+Wn/zJ07txsbGvfs2XP8xAlOxRFKCSHRwFq7X1Z3zypQjHFZWdmVq1e9Xu/F2otv//XR+MTEYCBwt67u669vlZaWHKt+R8WpCKWyogAAwHebREoJhAAAihCCCDEq1avFRQmJicMjw5cuXTKaTHZ7YjgstLW1ffnlH7MyMk//7ZnpqemamhqOZQ+9WZWbm6dWq1mWowpVFJljWVGWYyLl9Xpra2tbW1sz0jNMvElRlM7OzoXAUmZmxs6d5VqtFgK4v6LC7XZf/8v12ou1TzxP4kym8bFx9yM3pbS8/GcIr3SIETEiiqIoSQCsJUUkWZIVWaYkygwjXFRaUnmg8rPPLlz4vHZoZCjJ4fD7/Z2dHcFgqLCoEEEYjUJRkhSiKISsdRhCSAEQRVGIRKI/FJcU7923t7a29sqf/zQ+MWl32CNCpL2j3e/3W6xWAIEgRoZHRh496n30uNeZm2vm+VAo1NzUNL8wv3///oRv+6GXkNJoNAX5BT6fb2hoKCyEAaAYM5u3bDl65EjZ5s3RLZmenv53Z8+yHNfU1NTY2KhQquI4h8NRWVlZceBA9GzSaDRpaWmTU1OJiYnRnjYqlmOTU1JmZ2fNZvPKBofAZrNVHz8OIKy7W9fc0gIhZBjGYjYfPfr2wYMH9QaDJEk2my0rKzs5OVm7kgdXhBnGGh+f43Smpafp9XoAAM+bq6urWZa9devWN+3fqHpUlJL4eNvp06crKip43syy3MlTp65evdL3+LHnxg2OZQghWq3+0KFD1dXVdrv9haTg944SRVFmZ2Z9Yz632z0/P08pNRqNTqezoKAwLs649rXR0dHe3t6hoWFZlux2e1ZWVnZ2tslkim4rURQHBwYnJieSkpKysrO5b2EJgtDT456be5qQkJCfn796kyPL8tjYWE+P2+PxCELYaDRmZmXm5+fHW+MhhISQwcHBqakplUpVWFi4toyWZdnr9Q4ODvI873K5DAYDAIAQMjU11d/f39PTLQgRrVabn5/vcrksFkt0xGAw6PP5+vv7PR6PLMsMgzMyspzOnOTkZI7jYiIVFSEkFArJskwpxRhrNRpmTVxERSmNRMRQKAQhUKlUqueqW0KIoihoTem0OjdKCYSIee6SRBRFQRAUWWZYVqPRrA1GRVGirj5/TUYIkSQZY/S9qy5ZlpeXlxVFYRhGp9M9P1wkEhEEIXrno9FoXtjuvYTUhp7Xxj+jsWqDVKzaIBWrNkjFqg1Sseo/ASYx6+9ioqKkAAAAAElFTkSuQmCC",_imports_57="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGoAAAAtCAIAAADJHmkUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAALTklEQVRoge2aa3Bc1X3A/+dx7927K+1qV6vVe/VaWZawHn4hC4ONbRyDbVLimZik/ZCZJKTPT+23znQGvmdK07SlpKUBSmmZTknqFjLEGAwOyDYI6y1ZsmRhSavVc1f7vo9z/v2wRpPYC2a6LnVs/T7eOXPO//zuefzPuZcgImzyv4X+fwfw282mvoLY1FcQm/oKYlNfQWzqK4hNfQWxqa8gNvUVBL91EcRUyrYsQQgCkNyjoiKVcfZ/HNtvAbfQNzq2IGxzoH9lcHiJ0pw7ImxjT0/w+LF2TbvXDX6RvpmZ+N/8be/xYy39Q+HT78wqnCJIACJtMjwe5Yr2+LEWSu/p6f+5nV9eWv/RX58ZGlxGQiQSKW1b2kJKIQVSGV5I/OSF3jfevCrlVxntHUf+0bcQiT/7l2/39q5w1aJALIMaWc452SiAyCYmU8/+6IyVzR473qo57tExmEff0tL6s3/13nvnFk1LUVSFUW3Hdh8QwSgBIIBAKCgq46BJtMILyZWVTHWN66sP/U4gj77Z2ZVLnywbglAmUTJdoydOdD76qAUEAIFSkkqbvRemrl2NMs7Wk7Gp6dlAeUhRvsQmfteRp8+mKYSEXJpCCAAFj0f3ePSNArFYdnxs7ew7U5pDN03b7XLt2tWoKF9h1HcMefQR+Cy9+xxsW6YSsBa1VYdpGlYqLe7ZG+s8Sz4SkIgSAVEKRISb3SChkjBCOAAjt5B9V5Nvx0SgIAhIAESKlN6sjyAQCQwIEqT3rry8k9fncz28tyFrMqCCqxgI3LirEqA574ggBZFSQJ4Rek+QR19dfWDPQ6nIYkpRgAKMDUcnLseQCkBApC5d8/s1xiUASgmcoz+gbqSEV6aXRkajTgfp7q5x6vrY2PKVqTXKpGFaCMShqj6vXlXpqqv3csaSSeP8+dmUIaQEXcWdO6rKyty5ej79dO3SQJgyKhArK4o776vU9Ttxb8qjz6EpAOTN/x6ZXTBUVdg2Q0mBCAAQNgb8zm89eZ+qaLbNVE0cfKTh0MGtqnq9b+cvzDz3XH/ArzY2Hq2qVE+fnn713waKvUqpz8EpTcRtS2BllfbE462PHdm6upb5u78/H1nNCIFFTvH97+z+9rd3AUAmY576r9F/erlPczhsmxzcX9sQ9P6avo2R/gXLBt6qwJcHv6Ce/MnanvuD8dXMc//QuzBvKQ4GVORmq21J3cFsC21bErAO7W/4gx/srq/3EXK9AdOAeMJ0aUzaFBGzhrkWTQbrq37vd3eU+/XwQvLUqbH+wcXwfN/WlnKHgyaSdjyR9XrUpRX7/XOzJ0/uZIzMh9fOfTDDuIMyWF+ysmmJEgBASBgcmBu/vBiNWZRgVbW7s6OiLlgKAEvLydHRiNerK6oyOhQxLevQoS2lpc6x8dXR0aVkwqys1uuC/tXllNentLdXW5a8PLE8Mhpej5kEoazc3dVRUVdfQgi5Nhe7Oh1zFytS4uSVaCabDtaWdHZU+/1FX1af260d/3obMPGT5wZmIzHgCMgB0BJgWcSypK6RRw8Hf/+p+0Ohsg13AMAoVRTGFUaAAABlhDJSVVG8f2+Tz8cBIBKOj06sTE3FV9fS1dUuhVOHyrs6SvsHY1PT6yPDSx2d5dPTiZGRyL6Ht6oqefONKco5pVQKOHVq5LV/77Ms6ve5pbR+eXq6pq745ImOB/fWT0yu/fjHF11uXuYvWolkq6tcXV21v+qdfv1nk8l101eqaxqaJouuZHbu9ra3V2cy1sWL4Y8/mVMVaph2JDJ1ulL/kz/uad1a0T8QfumnIy4XeL1aJiMXl9azpnX4QOh73+v2evUbRH3uUcGh86NH2wihPz81bpgMqAQAW4jSkuJSr6up0VNW7m5u/g13ORABkQBBACAAlNKl5dTZ98f8ZWp0TXx0KRyPp5tD7rJSnZDrm3pVuUvdrZ19N3z6zOW2+8qGx1YlKvfvrkiuG0IYSJBSev7CzE9f6k+lrT/6wz1bQn7Ltt89e/WlV4bTcbOywmlaYj6SwrDc+njZ14921NYWTUwu/vPLg4tL6e9/d8e29opkwnz1lcGZ2WiwwYkITqdy6GB9V1c552CY4j9eH/3FW+PbtpU1h/yZlDm/EC8tVU88sa2i0jkfTj7/woVfvj27c3fNgf2hL6sPAJxO7bHHWkPN5ZYBQAQCIKDKeXm5q6RE0zTlZneEMQSCyBCuX8UonF2bT/zjix/pHDJZTJvGgz213/id1vr60oXIOgJIQE1jR480v/XmzMDQ4tDQ3McfzTQ2lO/aWfPB+1MAkgJQChc/unptPvXwQzWHHwm5izWJqGnK6z+bGp+I9vXNV1WXImIg4Nq/r7G7u5pz8p+nBmdnk83NnmNHtwYCLtvG5cX1T4bDlGiEgGXZV66uDQ5HYmsxjZKF+YRtk8VwyrIEZYxwUVPrfuRwk67zlrhx5uzYpUvJxaXkzYpucVB1OtX2beW/dqhAAEIp3CwuRyyaBOSEWeyzvVgIEfDrhw40+TwaYaTEqzQ1lNU3+DSNbyTklGHHtqqmBvfstcS/vDI4ObF44OEtLc1l756ZAABACYDplCAALhcvcqkAQAlxF2sKR9Nm6WwuHFJUpPp8zlwakMyaEpmqkuJilVKqquByMSYpIzyTsX/xxsTL/9rv8WnbO8rKvHoyzYbG123kEgkQAAKqynVdYYxoGnM4creaeZKzW5/z6W/kxXmspVNmOmMSinNziYvnr6IQPh8PBDy5n4+ElOUB/fjR1spKJyGEMaIodMM+IZDreUmJ9tD+2ldeHf/gQlhzqF2dAVVhEhFILs0kLS0Bzq4Mj8xPXom0bKkEgIGB+eXVdGUlbW3xG6YAAoSQjTfd2FCqqvNTV1c+vDCzb29oPhx94/QkUk4pJJPGe+dmpqdjTx3c8YOn7geE9Rf7AKavxwIAJLcEIQBBREACJP+AuQ3XJL0fTrz22qQh7GgsMzW5WllTcvKbO1xONZk00hlzdTWZTmd1B3M6b0zcpIB4NBNdNVNpS1HY/oeaXnixP7Js9+wO9PSEACCbNFdXUomUYVniwKEtH/dF3np7/Oln3m5tqTEs2XfpU2+J+sTjoa7OirPvzcTXMuuluiVErvID+0N9feF33o3/8Ie9p34+nk6Z84txwlGA5XDw2qDbtq1fnZsxs+Z6MjM2Fl1fMbPpFKK0DDO+aiSSVq4eREgmjdhawsjaN/edPf300wXqy2TtaCzrcPLqquIjX2s5caLtwQcaVZURQlwupX1b+b599VtCflW78VVRSgJles8Ddd3dtTVVXrdHr6lx9/QEjxwOdXVWUUocDqWtrWLfvvqmRp/HrTU3+bc0+3WXhigUFbd3Vj/5zfaDB5rdbgfnpK7Os/eBYFtbwOVUAaCoWLuvrbyro7q21l1T69m1s8ZVTIeGVpqbix870hoMljQ1lXo8GhASrPX27Knfs6e2u7sqGPTputLYWLrngZpQg48QQggpLta6uqp278qTu5DC/+8zTRFPZIWQlBCnU3U4OGPXj3S2LSxLMEZUlefZoyVmDRsBOCeqwhHANGwhkHOqqixXs2VLhdON+W6aIpkyTFMAoFPXXC4l15YQ0jQFIURVWW61sS0YHp7TnbzI5ZSIcwvLzz9/fmzY+NM/2/Hkye0AYGTtZNqybenUuaZxIZFRUBRm22jbkjDiUNlnHbSFkIrKObvxiuA26LszMbLimWfeuXxlxVOiANpLq9mFsPHg3vK/+POv+f3O29XKXasPET/88NNL/XPR1ZSwbadLbd5auXN7dTDovY2t3LX6AMC2RSZjWaZAAM6I7lRV9TZ/Ubib9X0F3KMfGG8Xm/oKYlNfQWzqK4hNfQWxqa8gNvUVxKa+gvgfrVkidzBYbjcAAAAASUVORK5CYII=",_imports_58="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGkAAAAvCAIAAABv4XMcAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAN8ElEQVRoge2aWVBc15nHv3Pu7Y2lF/ZuBAgJhFjEJiQkhGgQXuUEybLLstDisSeqjJyJ7cw8zUzVlGcSLyk5iZ1kknFqkliy/TCOBluSZS2AQJaQEAhoCZqlmwZ6YW2ahm56vfeeMw+NMBY45Wo/xK7q/9s93znf+e7v7OdeRCmFiMIS/lsH8B1WhF34irALXxF24SvCLnxF2IWvCLvwFWEXviLswleEXfiKsAtfEXbhK8IufEXYha8Iu/DFrk7igkHz6Nii3ycRiTWpGoVCsdLq9/lGhk2quLgUdQrCX0Jvtdh0Xd0zUzMiqWhj9sbCoqLY2Ng1ayWCMDE+7nS5gFKFQpGeng4AXvfCnHmE8/gxwyZlb5IpFJRShNBSSGZzkOMwwvHx8YlJiSu9+bxem208Vi5PTk7yeb1Wq4WjBFMASgihCINIJElJSZHLFWsGYx4b83i9AKBSKdVqzTdi53Yu/Pm3794bGcQMW1m1+/jxHygVymXr3JT9tyff2lmjPXTkCHufnck4/Mn/NXR1dfr9nqTERJ8v8JePFtSpmkcee/TRRx9fTdDr8Z587U3rzGSQ57cUFLz8yispyckzHZ2G/3k34JrjgGTUH93y1CGxVBbK77A73v75L8btU1KptG5f3aH6+pXebGPWX751snRH+bG/e85qMf/0Z/8555oXAZIwFGPqD/IcZRRKVXl5+ZP7nw6107Ls01NvvPb6xNQkwpCVlfXGGz8Xi8Xhs+MEfnLcajQaBIqm7XaNRnN4RayCEDSbR3Mc+RQoAACFzo6OX7/9zvDwsFqtfu6F4yWlJYsu17lPzl689NnA0KDBaDp+/HhiQsLKKkYMw7dvti/yAZ6C1xvo7etLSUpy3m6f03UQEQKemK9c2vTQ48vseC44PjpmHLfIomSOWceDAQf81tHR9MwMSkggEBg1DE85ZqMk0h//6Ed5+fk6XXdDwxnj4JBe3z8wYPjJK6/k5GxeLtt+q13X1TXnmgeMp6ft+v7+kuLi8NkBooCBUkAUzdpnPzj9wTqNRltdvWQllBAi3L+p7+/Tnzx5Ut+nT0lJ+YcXX9TWVEskYgBQazQ84RsaPm44c4bB+MSJE3K5/D4I7uL5T3lCElRxdsfC9MR0Z2d3fmzM9J2bjJRlMWL4oLe/b8FkiklKRggDAALAgClgAAyrvhFQRBFGGGMAwIBYwAgYhmFz8rbs0mqLtpbl5uW9/rPXTRZLU2OTRqN5+aWXQxMRFciN5lYSDMZKZW6ff9658HFDw9dnt9ZaQYFSkMmkcbFyEMiQYejU6dNGo3GpAKGYUowQAPL5fB++d6qvr08sEWlrtNoabQgcAKjiE5588kB+zmafe/HMmTM9PT3LH0ZsNltra2vZjvKDzzxDuGAgyHV1dd+8cJZwXMaBenlWLuEJs+CcvN0uBAMro0Jf8Q4I0LIJI6AUgAJQRIAijGLl8vKK3bV7HqI8HwwErrW0Dg0NhTLf7enR6boqtFUP1dayCAlBvrOj02wxfxN2iALJzct99tDBGJGY8HxbW9sHH37ocDgAACEkIKAIAYDJMNR282aQ46NiYrTV1RKJZKWbnLy83E25EpF4Yd514cJni4uLAEAB2q5e8/h8h47UV1Vr45QKQGAaHTOOT2uqHl7/5EFlbikRsQwmEzeu+exzKwgRShHQkI8H2VEKobZBFBBGCFFKicALoQwxsbHZWVnA8xijqalJu90eSm+6fHHe4647cODpgwcV8mgAOj093X6rPXx2CAElNCEx8dn6+j17asSICXj9Zz/+5Pz585zAs2IRAQBKgdL26zccTgdBSC6Xb8za+IAflhWlpaXLpFEMYq/fuBGKOOjzNV1pVKUk7KjYkZaRtmePFgi36HaNC0JsVVX85s0JpaVRifEIg8dksN1pp4Tcj5RQCpQCoNUf9ujSYFl6oJRQIECEJXY8x83POykAIUKUTBolkwKA0+64ffv2hk1ZhUVFBcUlefl5mEVer6f1aksgEFhVxddjBwAIMCE0JVV97IXny0pKWUpdzvlTp063trYiQCzDUIESgY4MGQWBUAwxsbHRUdGr/cTFq6RSKULI6XDMzEwDQNftDtOIaXe1ViKRxCoUldVVsWIxAzBgsZg9XoZl1TvLY7M2s0jCBH2Wpiu8zxdqTgSIAkUICFnV7zBCgOiKDhlaxVjR0mxuNBhaPr8GGHMcX1hUnJ2dDQA3blw3W23VtQ8plApZlKymeo+EYQlP+vX6jo6Ob8COBUQoIFRQUnz4ucOZGWkYqHnM8uf3TnX39PBCaK0gfJADBKHpD+M1XIlYEYsxQogSKggCAHz6yacSiXTfvv0AgDDOzsnJ3bwZIzo+Pt3dddfvD8gSkuOLy9ioGATU1dszbzEDAEIIIUqQQGD1kAV8f5QCpQhjAIFSCAjCQL/+Xk9P8+XL//2b39zR9VCJqKBgy6H6w2pNasDna25sjFYoqnZrRawIACqrq1M1aoRhbs55raU1XHYYIbw0+7Iids+jjxysfzYxToUp7em888f337PPOQlQjLEmI40FhAnyLHrW7Oc+rzcY5BFCUrFMpYyzT03e1fUUlpVsyMwMZdBoUqtrahDCPE90Op3NagWEEnZUMokJDAVwzo40NRGeB0AUA6C1lwvMIsyEpkJACCgQSiHI8xfOn/vlyTd/+h//frnxis/n25Jf8C//+m+Vu3czDKPv7e3X91VptWnr0kPNoUlL37m7Eij4Az6dTmez2cJhhxFiELPcurKo6LoDTz3+2GMKWRQX4Hr69AueRUopRWj7ropYWTQGtOBesFqtq11NTky6/V6BkoKCArVa3dLUPL/oemTv48xyJ+X4ZLEkU6NhGWwwGnr1egBIKCiMKShkRWJGCFpaL/pm7QAghNYnBLDqRwaMEKKIEEKX1lwElLKIKdiyZUfFLp/f5/H7CCGpas3WraVSiQQA2m/fstgslrGRd//wu1+9/Yt33nnr97//tcUyEgwEBF4wjYw0NTWFww4AEANoxZSclKJ+9uixsq1lIoYRCKX3bflFRYWFhZQIi+7Ftra2B5zMzswMGYd9wQAVhCfq9iIEjZcaNRlp5du2LeeZ6+8LdnfkpKdhnrgXFm60tc3YZxipJG13LRsdTSgIFtN0r04ik0rFMkyBEziXx/NARZ5Fr9frkSsVLMsijBmEAYDBeEflrkNHjj39TD0QYDDuvdfb3NgEAJM2W8etWzKJdGZq8vOW5tampmtNTdeamqanp1QKJQbscrna2tpcLtdfZ7fW3nhpfkErn7M25xx+/pjdYdcbBzm8ZJUrFAePHhkbt46MjbU0X62qqipe3lhSerWxubdfL3B8TU11bW3tYK/eZDId/cHfK5RLJzzO65m91ho7b88u3tGu0zs9rp47XaPDo0mJSSnbyo2aDG5hEXt95qtN6h2V5Tt36QcMQiA4ODRosVhWHq06Ozt4EAoKtohYFoAyDEZL+FiFUrlv//7rLS263ruTExP/+9FH28vL9T264X7DoUP12ysqKL2/70QUALo7u9/705/8lIyOjvb29u7ateuvsGNeffXVB5K8Hk/zZ5cZiXTv9773BT2M1akaBLRfr3e5F7du3VpRUcGybLJGLY+JGR0eHh012e2zKUnJSqXCNb9w5dKl998/bRufqNxd+cMXf5iVnf3BH/44Yja//M8/UalUAEAB3Ibhe7/7L1XWxo0HnjIZh602i9fr3ZC9Mb+gQBordxiNwUF9gHqCc251RcW6gkKTYdhqNs+7F5zzCyqVKloqdczaz587e/7cxxWVu/fW1UVHR8/Z7RfOnZ93e1gRq62pzsvLUyqVYrG4o/02Fww45xw8H+zq7PL6/Cde+vHW7dsz1q/PyFyfkbk+Y31mRkZmcnLS9dbPXW63P+iXKxQVO3euuQZ+db9DiJVIJauOxGKJZG9d3cTE1JmGBpFIFOp6MpnskSf2KhNUFy9c0Ol63nrztRS1OsjxFus4Rejo88/tfWJvTk7O6PCwfqC/tHybRrN0USEEgjZdj19EVdrqrKLCkrLSu/q7FOObN2/uqa3dkJmZuqty+vNG6hYEn8/Q3lb+wol//KeXUhvWtV5tvnLh3FDv3eSkRAAqUKHm4Ye/X7c/Pj50ZMZiiSRaxkgkDBABABiW1dbs6ezs+vTcWTFmWi43er2+J/btz9ywgWUffP3Udeu27yyfPneO8ry+p9tkGNqUm/dV7NDqf8j8fn935x2xWFxWvn11AZvVqtfrNamp+fn5y23CcdzkxMTgQP/UhM3v92PMxsiV6enpm3I3x6lUGOOpyYle3b3UjPTc3NwQdIHjHYYh3+xUfH5RTEKCaXi4v7+fUioWi8u2bUtISAg6neNdnTTgBYqY1HUZJVsFQZiamhzo67NazG6Xm2HZuLj49ZkZOXn5KlVcyO2803mr7Ybf78MIbykp3rAhCwAoIQaDse/ePZZlCCGCIBQWF2dv2vSleQkAAIggDAwMGgb7KaVRUVFFJaVqzVfeSq3BjlIq8DwgtLpZQlae5zHGDMM8YOI4LhgIcDyHERaLJSKxaDmPIAiCILAs+8UQoFTgBUCAGRYBJZTyPB9KZ0UijDEspwBFgBiRKFSO57hAMMAFghQhiVgskUoY5os4KSUcx4X2KwzLLgdACOE4bmkbCCAKVbGWBEEQlur9koevxe5vIEphVRf49uvbcef+HQQH3xZ2301F2IWvCLvwFWEXviLswleEXfiKsAtfEXbhK8IufEXYha8Iu/AVYRe+/h8jlr7W1ne82gAAAABJRU5ErkJggg==",_hoisted_1$4={class:"banner_1"},_hoisted_2$4={class:"title_1"},_hoisted_3$4={class:"txt_1"},_hoisted_4$4={class:"txt_2"},_hoisted_5$4={class:"txt_3"},_hoisted_6$4={class:"banner_2"},_hoisted_7$4={class:"b2t"},_hoisted_8$4={class:"tt1"},_hoisted_9$3={class:"tt2"},_hoisted_10$3={class:"b2b"},_hoisted_11$3={class:"b5dom"},_hoisted_12$3={class:"b5dom"},_hoisted_13$3={class:"b5dom"},_hoisted_14$3={class:"b5dom"},_hoisted_15$3={class:"b5dom"},_hoisted_16$3={class:"bppt"},_hoisted_17$3={class:"ppt1"},_hoisted_18$3={class:"nvnvxcxc"},_hoisted_19$3={class:"ppt2"},_hoisted_20$3={class:"about_title_2"},_hoisted_21$3={class:"rightbox"},_hoisted_22$3={class:"rb_2"},_hoisted_23$3={class:"rbtxt_1 animated-number"},_hoisted_24$3={class:"rbtxt_2"},_hoisted_25$3={class:"rightbox"},_hoisted_26$3={class:"rb_2"},_hoisted_27$3={class:"rbtxt_1 animated-number"},_hoisted_28$3={class:"rbtxt_2"},_hoisted_29$3={class:"rightbox"},_hoisted_30$3={class:"rb_2"},_hoisted_31$3={class:"rbtxt_1 animated-number"},_hoisted_32$3={class:"rbtxt_2"},_hoisted_33$3={class:"rightbox"},_hoisted_34$2={class:"rb_2"},_hoisted_35$2={class:"rbtxt_1 animated-number"},_hoisted_36$2={class:"rbtxt_2"},_hoisted_37$2={class:"ppt3"},_hoisted_38$2={class:"ppy1"},_hoisted_39$2={class:"ppy2"},_hoisted_40$2={class:"ppy2"},_hoisted_41$2={class:"ppy2"},_hoisted_42$2={class:"banner_3"},_hoisted_43$2={class:"b3t"},_hoisted_44$2={class:"tt1"},_hoisted_45$2={class:"hzppt"},_hoisted_46$2={class:"pptban3"},_hoisted_47$2={class:"imgbox3"},_hoisted_48$2={class:"ht"},_hoisted_49$2={class:"ht"},_hoisted_50$2={class:"ht"},_hoisted_51$2={class:"ht"},_hoisted_52$2={class:"ht"},_hoisted_53$2={class:"ht"},_hoisted_54$2={class:"txtbox3"},_hoisted_55$2={class:"pptban3"},_hoisted_56$2={class:"imgbox3"},_hoisted_57$2={class:"ht"},_hoisted_58$2={class:"ht"},_hoisted_59$2={class:"ht"},_hoisted_60$2={class:"ht"},_hoisted_61$2={class:"ht"},_hoisted_62$2={class:"txtbox3"},_hoisted_63$2={class:"pptban3"},_hoisted_64$2={class:"imgbox3"},_hoisted_65$2={class:"ht"},_hoisted_66$2={class:"ht"},_hoisted_67$2={class:"ht"},_hoisted_68$2={class:"ht"},_hoisted_69$2={class:"txtbox3"},_hoisted_70$2={class:"banner_4"},_sfc_main$5={__name:"Home",setup(r){const{t:e,locale:i}=useI18n(),n=ref([{value:1,target:1e4,isCompleted:!1,interval:10,steps:100},{value:1,target:50,isCompleted:!1,interval:70,steps:10},{value:1,target:1e5,isCompleted:!1,interval:10,steps:100},{value:1,target:10,isCompleted:!1,interval:100,steps:10}]);return onMounted(()=>{n.value.forEach(o=>{let l=o.target/o.steps,d=setInterval(()=>{o.value<o.target?o.value=Math.min(o.value+l,o.target):(clearInterval(d),o.isCompleted=!0)},o.interval)})}),(o,l)=>(openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",_hoisted_1$4,[createBaseVNode("div",_hoisted_2$4,[createBaseVNode("div",_hoisted_3$4,toDisplayString$1(o.$t("honetitle1")),1),createBaseVNode("div",_hoisted_4$4,toDisplayString$1(o.$t("honetitle2")),1),createBaseVNode("div",_hoisted_5$4,toDisplayString$1(o.$t("honetitle3")),1)])]),createBaseVNode("div",_hoisted_6$4,[createBaseVNode("div",_hoisted_7$4,[createBaseVNode("div",_hoisted_8$4,toDisplayString$1(o.$t("h2")),1),createBaseVNode("div",_hoisted_9$3,toDisplayString$1(o.$t("h21")),1)]),createBaseVNode("div",_hoisted_10$3,[createBaseVNode("div",_hoisted_11$3,[l[0]||(l[0]=createBaseVNode("div",{class:"fdfdfzz"},[createBaseVNode("img",{src:_imports_0$4,alt:""})],-1)),createBaseVNode("span",null,toDisplayString$1(o.$t("tb1")),1)]),createBaseVNode("div",_hoisted_12$3,[l[1]||(l[1]=createBaseVNode("div",{class:"fdfdfzz"},[createBaseVNode("img",{src:_imports_1$2,alt:""})],-1)),l[2]||(l[2]=createTextVNode()),createBaseVNode("span",null,toDisplayString$1(o.$t("tb2")),1)]),createBaseVNode("div",_hoisted_13$3,[l[3]||(l[3]=createBaseVNode("div",{class:"fdfdfzz"},[createBaseVNode("img",{src:_imports_2$2,alt:""})],-1)),l[4]||(l[4]=createTextVNode()),createBaseVNode("span",null,toDisplayString$1(o.$t("tb3")),1)]),createBaseVNode("div",_hoisted_14$3,[l[5]||(l[5]=createBaseVNode("div",{class:"fdfdfzz"},[createBaseVNode("img",{src:_imports_3$2,alt:""})],-1)),l[6]||(l[6]=createTextVNode()),createBaseVNode("span",null,toDisplayString$1(o.$t("tb4")),1)]),createBaseVNode("div",_hoisted_15$3,[l[7]||(l[7]=createBaseVNode("div",{class:"fdfdfzz"},[createBaseVNode("img",{src:_imports_4$2,alt:""})],-1)),l[8]||(l[8]=createTextVNode()),createBaseVNode("span",null,toDisplayString$1(o.$t("tb5")),1)])]),createBaseVNode("div",_hoisted_16$3,[createBaseVNode("div",_hoisted_17$3,[createBaseVNode("h2",null,toDisplayString$1(o.$t("xc")),1),createBaseVNode("div",_hoisted_18$3,toDisplayString$1(o.$t("about_t1")),1)]),createBaseVNode("div",_hoisted_19$3,[createBaseVNode("div",_hoisted_20$3,[createBaseVNode("div",_hoisted_21$3,[l[9]||(l[9]=createBaseVNode("div",{class:"rb_1"},[createBaseVNode("img",{src:_imports_5$2,alt:""})],-1)),createBaseVNode("div",_hoisted_22$3,[createBaseVNode("div",_hoisted_23$3,toDisplayString$1(n.value[0].value)+toDisplayString$1(n.value[0].isCompleted?"+":""),1),createBaseVNode("div",_hoisted_24$3,toDisplayString$1(o.$t("ppt1")),1)])]),createBaseVNode("div",_hoisted_25$3,[l[10]||(l[10]=createBaseVNode("div",{class:"rb_1"},[createBaseVNode("img",{src:_imports_5$2,alt:""})],-1)),createBaseVNode("div",_hoisted_26$3,[createBaseVNode("div",_hoisted_27$3,toDisplayString$1(n.value[1].value)+toDisplayString$1(n.value[1].isCompleted?"+":""),1),createBaseVNode("div",_hoisted_28$3,toDisplayString$1(o.$t("ppt2")),1)])]),createBaseVNode("div",_hoisted_29$3,[l[11]||(l[11]=createBaseVNode("div",{class:"rb_1"},[createBaseVNode("img",{src:_imports_5$2,alt:""})],-1)),createBaseVNode("div",_hoisted_30$3,[createBaseVNode("div",_hoisted_31$3,toDisplayString$1(n.value[2].value)+toDisplayString$1(n.value[2].isCompleted?"+":""),1),createBaseVNode("div",_hoisted_32$3,toDisplayString$1(o.$t("ppt3")),1)])]),createBaseVNode("div",_hoisted_33$3,[l[12]||(l[12]=createBaseVNode("div",{class:"rb_1"},[createBaseVNode("img",{src:_imports_5$2,alt:""})],-1)),createBaseVNode("div",_hoisted_34$2,[createBaseVNode("div",_hoisted_35$2,toDisplayString$1(n.value[3].value)+toDisplayString$1(n.value[3].isCompleted?"years+":""),1),createBaseVNode("div",_hoisted_36$2,toDisplayString$1(o.$t("ppt4")),1)])])])]),createBaseVNode("div",_hoisted_37$2,[createBaseVNode("div",_hoisted_38$2,toDisplayString$1(o.$t("pptzt1")),1),createBaseVNode("div",_hoisted_39$2,toDisplayString$1(o.$t("pptzt2")),1),createBaseVNode("div",_hoisted_40$2,toDisplayString$1(o.$t("pptzt3")),1),createBaseVNode("div",_hoisted_41$2,toDisplayString$1(o.$t("pptzt4")),1)])])]),createBaseVNode("div",_hoisted_42$2,[createBaseVNode("div",_hoisted_43$2,[createBaseVNode("div",_hoisted_44$2,toDisplayString$1(o.$t("hz0")),1),createBaseVNode("div",_hoisted_45$2,[createBaseVNode("div",_hoisted_46$2,[createBaseVNode("div",_hoisted_47$2,[createBaseVNode("div",_hoisted_48$2,[l[13]||(l[13]=createBaseVNode("img",{src:_imports_6$2,alt:""},null,-1)),createBaseVNode("span",null,toDisplayString$1(o.$t("hz1")),1)]),createBaseVNode("div",_hoisted_49$2,[l[14]||(l[14]=createBaseVNode("img",{src:_imports_7$2,alt:""},null,-1)),createBaseVNode("span",null,toDisplayString$1(o.$t("hz2")),1)]),createBaseVNode("div",_hoisted_50$2,[l[15]||(l[15]=createBaseVNode("img",{src:_imports_8$1,alt:""},null,-1)),createBaseVNode("span",null,toDisplayString$1(o.$t("hz3")),1)]),createBaseVNode("div",_hoisted_51$2,[l[16]||(l[16]=createBaseVNode("img",{src:_imports_9$1,alt:""},null,-1)),createBaseVNode("span",null,toDisplayString$1(o.$t("hz4")),1)]),createBaseVNode("div",_hoisted_52$2,[l[17]||(l[17]=createBaseVNode("img",{src:_imports_10,alt:""},null,-1)),createBaseVNode("span",null,toDisplayString$1(o.$t("hz5")),1)]),createBaseVNode("div",_hoisted_53$2,[l[18]||(l[18]=createBaseVNode("img",{src:_imports_11,alt:""},null,-1)),createBaseVNode("span",null,toDisplayString$1(o.$t("hz6")),1)])]),createBaseVNode("div",_hoisted_54$2,toDisplayString$1(o.$t("hzb1")),1)]),createBaseVNode("div",_hoisted_55$2,[createBaseVNode("div",_hoisted_56$2,[createBaseVNode("div",_hoisted_57$2,[l[19]||(l[19]=createBaseVNode("img",{src:_imports_12,alt:""},null,-1)),createBaseVNode("span",null,toDisplayString$1(o.$t("hz7")),1)]),createBaseVNode("div",_hoisted_58$2,[l[20]||(l[20]=createBaseVNode("img",{src:_imports_13,alt:""},null,-1)),createBaseVNode("span",null,toDisplayString$1(o.$t("hz8")),1)]),createBaseVNode("div",_hoisted_59$2,[l[21]||(l[21]=createBaseVNode("img",{src:_imports_14,alt:""},null,-1)),createBaseVNode("span",null,toDisplayString$1(o.$t("hz9")),1)]),createBaseVNode("div",_hoisted_60$2,[l[22]||(l[22]=createBaseVNode("img",{src:_imports_15,alt:""},null,-1)),createBaseVNode("span",null,toDisplayString$1(o.$t("hz10")),1)]),createBaseVNode("div",_hoisted_61$2,[l[23]||(l[23]=createBaseVNode("img",{src:_imports_16,alt:""},null,-1)),createBaseVNode("span",null,toDisplayString$1(o.$t("hz11")),1)])]),createBaseVNode("div",_hoisted_62$2,toDisplayString$1(o.$t("hzb2")),1)]),createBaseVNode("div",_hoisted_63$2,[createBaseVNode("div",_hoisted_64$2,[createBaseVNode("div",_hoisted_65$2,[l[24]||(l[24]=createBaseVNode("img",{src:_imports_17,alt:""},null,-1)),createBaseVNode("span",null,toDisplayString$1(o.$t("hz12")),1)]),createBaseVNode("div",_hoisted_66$2,[l[25]||(l[25]=createBaseVNode("img",{src:_imports_18,alt:""},null,-1)),createBaseVNode("span",null,toDisplayString$1(o.$t("hz13")),1)]),createBaseVNode("div",_hoisted_67$2,[l[26]||(l[26]=createBaseVNode("img",{src:_imports_19,alt:""},null,-1)),createBaseVNode("span",null,toDisplayString$1(o.$t("hz14")),1)]),createBaseVNode("div",_hoisted_68$2,[l[27]||(l[27]=createBaseVNode("img",{src:_imports_20,alt:""},null,-1)),createBaseVNode("span",null,toDisplayString$1(o.$t("hz15")),1)])]),createBaseVNode("div",_hoisted_69$2,toDisplayString$1(o.$t("hzb3"))+" "+toDisplayString$1(o.$t("hzb4")),1)])])])]),createBaseVNode("div",_hoisted_70$2,[createBaseVNode("h2",null,toDisplayString$1(o.$t("qswl")),1),l[28]||(l[28]=createStaticVNode('<div class="qsbox" data-v-61a45be5><img src="'+_imports_21+'" alt="" data-v-61a45be5><img src="'+_imports_22+'" alt="" data-v-61a45be5><img src="'+_imports_23+'" alt="" data-v-61a45be5><img src="'+_imports_24+'" alt="" data-v-61a45be5><img src="'+_imports_25+'" alt="" data-v-61a45be5><img src="'+_imports_26+'" alt="" data-v-61a45be5><img src="'+_imports_27+'" alt="" data-v-61a45be5><img src="'+_imports_28+'" alt="" data-v-61a45be5><img src="'+_imports_29+'" alt="" data-v-61a45be5><img src="'+_imports_30+'" alt="" data-v-61a45be5><img src="'+_imports_31+'" alt="" data-v-61a45be5><img src="'+_imports_32+'" alt="" data-v-61a45be5><img src="'+_imports_33+'" alt="" data-v-61a45be5><img src="'+_imports_34+'" alt="" data-v-61a45be5><img src="'+_imports_35+'" alt="" data-v-61a45be5><img src="'+_imports_36+'" alt="" data-v-61a45be5><img src="'+_imports_37+'" alt="" data-v-61a45be5><img src="'+_imports_38+'" alt="" data-v-61a45be5><img src="'+_imports_39+'" alt="" data-v-61a45be5><img src="'+_imports_40+'" alt="" data-v-61a45be5><img src="'+_imports_41+'" alt="" data-v-61a45be5><img src="'+_imports_42+'" alt="" data-v-61a45be5><img src="'+_imports_43+'" alt="" data-v-61a45be5><img src="'+_imports_44+'" alt="" data-v-61a45be5><img src="'+_imports_45+'" alt="" data-v-61a45be5><img src="'+_imports_46+'" alt="" data-v-61a45be5><img src="'+_imports_47+'" alt="" data-v-61a45be5><img src="'+_imports_48+'" alt="" data-v-61a45be5><img src="'+_imports_49+'" alt="" data-v-61a45be5><img src="'+_imports_50+'" alt="" data-v-61a45be5><img src="'+_imports_51+'" alt="" data-v-61a45be5><img src="'+_imports_52+'" alt="" data-v-61a45be5><img src="'+_imports_53+'" alt="" data-v-61a45be5><img src="'+_imports_54+'" alt="" data-v-61a45be5><img src="'+_imports_55+'" alt="" data-v-61a45be5><img src="'+_imports_56+'" alt="" data-v-61a45be5><img src="'+_imports_57+'" alt="" data-v-61a45be5><img src="'+_imports_58+'" alt="" data-v-61a45be5></div>',1))])],64))}},Home=_export_sfc(_sfc_main$5,[["__scopeId","data-v-61a45be5"]]),_imports_0$3="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIEAAACMCAYAAABbPsqOAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAMyElEQVR4nO2dy6slRx3HP7+6986MSSYzmcQQYjKjiJIEJAtFxI3gwo0gg3li0IWaxI0L3QiCf4ILxfiKAR+MRkxioguFiOBO8LGI+AAfmUkCUZK5N4+J8eae0z8X1X1Pnzpd3dXn9POc+kAzc7urq6urvudXv3q2qCqROST3f03/rptJUnBusBlt+k7AwHEFIMCfgReASe4469w32AIvQqIlmMP9Becz5ziwB0iiarKrIoIICbALvLlGfIMhWgI/boH9CzBJogadXVVVUlGcAq6riGOQbPedgAHh+gIupxJVAfvr99y/VXA+8yuyMIMTRrQEdVCvANKrfKDD1DRGFEFDqM1Lr0KGTBRBDUqsQMYo83OUiY40SxRBJIogpcu6fHB+Q50m4uASP2K6zsvSZmmVCGLBrwelfSC+6kCIAlhXFsq1yBKUFf7gersGhu9H1We+FZVndk5hXgS+wo8FP27cUVCcv9V4LmY3RwGsF0XlKduMbALEEMh3HDoj8WNocucHtIDiREcBlOD2HFf3JA+SuTIWTYdHiy5mYYCjwB+YjZefbCVpw6aqxaTOv33zEvAk8Dng3/jLdk4EbiADPAXcnN2gutnNxrJf/fAmaCkikuROnAPuB153Aoo5vGOee4AD4BZVTHpEAaxwvXuEWdmpwZbpJeBOJ6AWzTF8DDirIIMxbAMgpJCHZw0cBBX7g/87cFN22nUMHwHOqkYBrCWKqGKAdwA/zE7nLcENwIU0kL3obwptJOPyCcpJZ0hfC1zMi2AXOJnV/e4Lj+0lI+WItfUvAtdmv/rrgRM+AUTWj7SsrwauycYOvkzgqGGqoOz4aSspHC9JdZA56vQwhsT9IeBKQAIdewH+kVUHe6qzDqDCqkAg9SwfBe4ITHikHz4FPBgiBBFezkQwzTuEnsAK3As81FBCI+1ihVDRvyMy6ycIEcErwInm0rhxVHXPt8Gewsmyp4nMhpLLscn/VROp2jC2gIvAlPlVzBPg1g6efx8Bgqsz0fSJ5dOysfwPMImmi1hTxIgK/BE4ghVIW+yFBKrjnfoSK/EorHfvAtt3L0i6hN0ezOrpcw3mZxFBAhvDJIgxUGRyP1rmZ6XXbg+Mq00CfYLIkoyjm7WN/QnG8earEdin2ljXq3dCSBM0bQk2QQDQ7Xv6ntVYGmJ1EIkiWHOCyjeKIBJFEIkiiLBeW9i5TaZNaamszDqIwNde9q2niDiMWQShnSWbLIagmU5jFUHIIlo3jBSEiTBOxzBEAL5zcQptAWMTQagAyq5FITiMSQR1BVAWJgohx1hEsKwAysJGIaSMRQQubqHeDjybOx4Fbqu4J5IyhtZBVSfQAWAUZvP4hBvEfpLmZezHKPL35uOLLQb6tQQhc+Rc3AI7RzqPb+6KHk7fOgG8pSKOjacPEfgKveh81Vz9D1eslxDgqwXny7Z12zi6FEHoL76OZbii7OKm764SSlc+wbI9fJEO6MISrNLDF+mAtkXQRA9fpGXaFEGTPXyRFunSMVy1hy/SEm2JoKqD5/vYdXL5YwK8p+SeSEt00Too+tzsGVU1+c2w0pW6vwWuwW7Jmt3bRyth1bGKUdGGJSjr4DHAmcQRAIAmKun1F5x7usz8sj6KOv0Xo6LrsYPjgPdzs4mqGJEiYbYthDqFu3ZC6FoEN1KWiX0Z/0U2aui587GDEVSsrS8AHRq9jCIGfHO4L6oKei2F0KYIijJsyJNYQgt47YQwqELp0UL4fABfi2CthDAoEfSEW6BfwG72fRG7+9du+u/vKu4bLWOYXtYmbkG+G/jiwSQ5djBJdvLhLju2/U7gT8C7nPsH6+CEssmWoOiX/GSS6M5kmhwxRiQ7RDCv70+uYHGqmi+eUbHpliCPAOwfTI9tGYPJ/TySRJgmSd5HGH3B54kimMfYDSfnnVQRhTXuNt7k6sDHQiNluN0azRBFMI+3uM0aKyGKIBJ9Ah/5X/50zb8CFi1BJIogEqsDL8maVwF5oggKyPsDmyCFKIIC8h0FBR8UXzuiTxCJIohEEUQYmAg2of4dIm06hqMdcp0myZAnwzbOoCxBpB+6FsEoLcO604sliHX/sIjVQSBLdCPrWAxf0yIYvTdVZKXaMFy6ukAay+uuu40TsXkqqlowj6vhp9n46uR2AmiSIMbMbktFoDXjspMTPdvopSdfDYml1jOXoOvq4K/A4Wup6twhdkZn0dc6fJM8fyLi/7qH2Lge9sTnogDbW+ZgmiRMpso0PVSVY0e2/4tfCEXxPSyg7jvm3jUBfhkY17IM4ruI7gslwHkjksxZAQFjdypJgFtL4nDj+xigIiRKmsFpOaXiSIBHPPEVZfaXdrbN68eObL82zaYTCWxvm6kIB8B1Je/oxvc4oMZIIs4bGCMJVkz3lLxrE3QmAq04XN4O3CZCYozYw/4qpsDVwF8q4nevHQEuGJnFJSJT4EfADouUpe1rwE0ivHH5m7ZfOnpka//oztb+lpEJ8BXgjZrxbQPnJEvb7F1303S7VqwqL+vkM8CW5/wckjpC09I9ggUEHmNx+/jIsLlT4WGfXwIggoaJwAaeEucfjI2XFE6UubMi6GHBBzRZDHBHI0mLdMEtwJUh7ZlDEVR5JGqD/Bj4xCopi3TCp7ErqAHSZXWzwyWrDr4LfLyqSkh9g8wReQX4RUGooA8yrkjfPZ1dvGMRvvfOHMD3A9cDoiB2l7jFwIedX7Y8n89EcAXwcqUIFqOrF7xR+uycHGJ3cHF+lIlABAXulFw36QSQ+kKIDBlXBI4VSICtvLd/EvvhqFFRNfdjbuvcBozHmAdA5/LCmrO7YL6OuQT8oKwbdmiEFGoWpqmJQmObcKQ6OzLSauBx0t5UKRg1OwfcrflPzA2U0AJRj4O0LKO1BjPH/jngdHbasOhR3APcLZBkffKR8SNCNjbzSXICAGsJMhEU7Uj+H9KPS6bDvyIDmjIQLcEMdSp8ABFRmZXrI9gBt6lzq+RFAP5dSN+HrSZOF1zvCymakuCSCqCxreZy8Q1QCgs8B3we+9ngIgTmLUHG0F9uDziRffOwTAROgTXW9M3F+yjj7Uo/zLmijBmOvV9kl+UE8EHSaYI+U57NHgr5BYidHiXYUdUL4ckfDHM5ZxjP3v4XgZNVAsgKOhVAgu3/+E1ZxLmS/7XUF8KNwPmAW4bCQs5llsAnhKGIYQJcFSKA9HpeAAvz+PJtZ6fEXwXuXUIIpxm+ELybdeerg7L5c30K4gD7ZfQ6Aphiv5h+qeazJsBDwP1rJARv4ZPNq/Rc9BV420Jw8/0A2FpCACeB15Z4fvaEB4Etga+HtC4zIYhwGusjnPHEOxTm8tnnMffRBOpbAC7fBD67pI/gOotDaXEVlmtVs6lqImNT5OM3LC+AozQjgIwHqCGENE2ZEC66lxpMV11Ky7DOnMEmXsI73z/FAPssJ4BjtDPZ4wFgIvCNqqohtQZZ1XAV8CL2Y5+HyaY6Dzqny7kDbQvA7Q5tkm8Bn8ksQplZyNKcvsMprFXLM7gmeVciqBLA5TQnAG+GrjgY9m3gPgEVsV31PjE4Qthi4ELoQgRVArgM+23kVgXQEN/BzuLVNA1rIYSul6HB/Msfx85mGoMAMv4G3ECAEDKGLoQ2RRAigF3GIQA3/uexS9ySMiHk32fIQmhLBG0K4Cj9WAD3OQnpesKxC6ENEbQpgB3mm4Fdm86lhJBniELoYqcSVwB71BfAHosrjNvIoKDOQefvVYQwYb4MehFCkyIIFUDdwaA97JL1qmd1SZAQcsPaC0vA0jww2OXuvQqhKRGEVgFtCaCPHjd3dG5BCIU3FQthnx6F0IQIqgrlZparAp6hewEsE1cTQtiiRyGsKoKqQrkFuzq2rgV4BnhrzWdVkZppX+8OCvw8NJ6Fu2ck2DGZZXyEfSeuTixc046hK4Cn6E4A+b+Lwp9Pt4pZ3EjKbuWhFO8mVlQoIb/SZYSQjaCWWYTGrUHRCqTge52/8xFdCeyqXcV0GC5gheyqFqAsTYLNYElUTTaeJ5DtJKYsjqqWxReatrlh8SrSZYBVaWnUQjRlCdxE/RNHAIU3NV8FlBWSYuvrp43I1BiZGpFpusnV96gvAN85974dYFrmI+RJ9HDK3/GSZzVqDZa1BFWqnCaqxl2t5DhE2bmmfYAmnMe6cTRmEVQVY0SB9wK/L3lOY9agvbGDgiS6M3xTATxLs07gql71Ms9u1CJ03d5tTwQV2Z5mxs8Im5RZN1+WFULb4gsSgnSsg9aqA7WNrsKMzwngbEm8ZfGHsopTueyzQ+J5GjjjVg2qisx2dt0puG9Q1UGVk/IRyY23HwaUw3NP0L4AfPcXPafJZ4c8823ABZGsCamAZlv7KjZvOhEAwP8BLx8Z2JkRoKgAAAAASUVORK5CYII=",_imports_0$2=""+new URL("of2-K8oP6cAL.jpg",import.meta.url).href,_imports_1$1=""+new URL("office1-BCig7Gvm.webp",import.meta.url).href,_imports_2$1=""+new URL("of3-CsdFTyUd.jpg",import.meta.url).href,_hoisted_1$3={class:"about_banner_1"},_hoisted_2$3={class:"about_title_1"},_hoisted_3$3={class:"txt_2 animated-text"},_hoisted_4$3={class:"about_title_2"},_hoisted_5$3={class:"rightbox"},_hoisted_6$3={class:"rb_2"},_hoisted_7$3={class:"rbtxt_1 animated-number"},_hoisted_8$3={class:"rbtxt_2"},_hoisted_9$2={class:"rightbox"},_hoisted_10$2={class:"rb_2"},_hoisted_11$2={class:"rbtxt_1 animated-number"},_hoisted_12$2={class:"rbtxt_2"},_hoisted_13$2={class:"rightbox"},_hoisted_14$2={class:"rb_2"},_hoisted_15$2={class:"rbtxt_1 animated-number"},_hoisted_16$2={class:"rbtxt_2"},_hoisted_17$2={class:"rightbox"},_hoisted_18$2={class:"rb_2"},_hoisted_19$2={class:"rbtxt_1 animated-number"},_hoisted_20$2={class:"rbtxt_2"},_hoisted_21$2={class:"about_banner_2"},_hoisted_22$2={class:"abbbox"},_hoisted_23$2={class:"abb_1"},_hoisted_24$2={class:"abb_1txt1"},_hoisted_25$2={class:"abb_1txt2"},_hoisted_26$2={class:"abbbox"},_hoisted_27$2={class:"abb_1"},_hoisted_28$2={class:"abb_1txt1"},_hoisted_29$2={class:"abb_1txt2"},_hoisted_30$2={class:"abbbox"},_hoisted_31$2={class:"abb_1"},_hoisted_32$2={class:"abb_1txt1"},_hoisted_33$2={class:"abb_1txt2"},_sfc_main$4={__name:"About",setup(r){const{t:e,locale:i}=useI18n(),n=ref([{value:1,target:1e4,isCompleted:!1,interval:10,steps:100},{value:1,target:50,isCompleted:!1,interval:70,steps:10},{value:1,target:1e5,isCompleted:!1,interval:10,steps:100},{value:1,target:10,isCompleted:!1,interval:100,steps:10}]);return onMounted(()=>{n.value.forEach(o=>{let l=o.target/o.steps,d=setInterval(()=>{o.value<o.target?o.value=Math.min(o.value+l,o.target):(clearInterval(d),o.isCompleted=!0)},o.interval)})}),(o,l)=>(openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",_hoisted_1$3,[createBaseVNode("div",_hoisted_2$3,[createBaseVNode("div",_hoisted_3$3,toDisplayString$1(o.$t("about_t1")),1)]),createBaseVNode("div",_hoisted_4$3,[createBaseVNode("div",_hoisted_5$3,[l[0]||(l[0]=createBaseVNode("div",{class:"rb_1"},[createBaseVNode("img",{src:_imports_0$3,alt:""})],-1)),createBaseVNode("div",_hoisted_6$3,[createBaseVNode("div",_hoisted_7$3,toDisplayString$1(n.value[0].value)+toDisplayString$1(n.value[0].isCompleted?"+":""),1),createBaseVNode("div",_hoisted_8$3,toDisplayString$1(o.$t("ppt1")),1)])]),createBaseVNode("div",_hoisted_9$2,[l[1]||(l[1]=createBaseVNode("div",{class:"rb_1"},[createBaseVNode("img",{src:_imports_0$3,alt:""})],-1)),createBaseVNode("div",_hoisted_10$2,[createBaseVNode("div",_hoisted_11$2,toDisplayString$1(n.value[1].value)+toDisplayString$1(n.value[1].isCompleted?"+":""),1),createBaseVNode("div",_hoisted_12$2,toDisplayString$1(o.$t("ppt2")),1)])]),createBaseVNode("div",_hoisted_13$2,[l[2]||(l[2]=createBaseVNode("div",{class:"rb_1"},[createBaseVNode("img",{src:_imports_0$3,alt:""})],-1)),createBaseVNode("div",_hoisted_14$2,[createBaseVNode("div",_hoisted_15$2,toDisplayString$1(n.value[2].value)+toDisplayString$1(n.value[2].isCompleted?"+":""),1),createBaseVNode("div",_hoisted_16$2,toDisplayString$1(o.$t("ppt3")),1)])]),createBaseVNode("div",_hoisted_17$2,[l[3]||(l[3]=createBaseVNode("div",{class:"rb_1"},[createBaseVNode("img",{src:_imports_0$3,alt:""})],-1)),createBaseVNode("div",_hoisted_18$2,[createBaseVNode("div",_hoisted_19$2,toDisplayString$1(n.value[3].value)+toDisplayString$1(n.value[3].isCompleted?"years+":""),1),createBaseVNode("div",_hoisted_20$2,toDisplayString$1(o.$t("ppt4")),1)])])])]),createBaseVNode("div",_hoisted_21$2,[createBaseVNode("h2",null,toDisplayString$1(o.$t("about_Us")),1),createBaseVNode("div",_hoisted_22$2,[createBaseVNode("div",_hoisted_23$2,[createBaseVNode("div",_hoisted_24$2,toDisplayString$1(o.$t("abouttitle1")),1),createBaseVNode("div",_hoisted_25$2,toDisplayString$1(o.$t("abouttitle2")),1)]),l[4]||(l[4]=createBaseVNode("div",{class:"abb_2"},[createBaseVNode("img",{src:_imports_0$2,alt:""})],-1))]),createBaseVNode("div",_hoisted_26$2,[l[5]||(l[5]=createBaseVNode("div",{class:"abb_2"},[createBaseVNode("img",{src:_imports_1$1,alt:""})],-1)),createBaseVNode("div",_hoisted_27$2,[createBaseVNode("div",_hoisted_28$2,toDisplayString$1(o.$t("abouttitle3")),1),createBaseVNode("div",_hoisted_29$2,toDisplayString$1(o.$t("abouttitle4")),1)])]),createBaseVNode("div",_hoisted_30$2,[createBaseVNode("div",_hoisted_31$2,[createBaseVNode("div",_hoisted_32$2,toDisplayString$1(o.$t("abouttitle5")),1),createBaseVNode("div",_hoisted_33$2,toDisplayString$1(o.$t("abouttitle6")),1)]),l[6]||(l[6]=createBaseVNode("div",{class:"abb_2"},[createBaseVNode("img",{src:_imports_2$1,alt:""})],-1))])])],64))}},About=_export_sfc(_sfc_main$4,[["__scopeId","data-v-3cb6e201"]]),_imports_0$1="data:image/svg+xml,%3csvg%20version='1.1'%20id='_x32_'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20width='30'%20height='30'%20viewBox='0%200%20512%20512'%20xml:space='preserve'%20fill='%23fff'%20data-v-7a837531=''%3e%3cg%20id='SVGRepo_bgCarrier'%20stroke-width='0'%20data-v-7a837531=''%3e%3c/g%3e%3cg%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'%20data-v-7a837531=''%3e%3c/g%3e%3cg%20id='SVGRepo_iconCarrier'%20data-v-7a837531=''%3e%3cg%20data-v-7a837531=''%3e%3cpolygon%20class='st0'%20points='204.344,155.188%20249.469,200.297%20409.344,40.422%20268.031,40.422%20316.063,88.453%20249.469,155.031%20204.953,110.516%2041.906,264.969%2063.906,288.219%20'%20data-v-7a837531=''%3e%3c/polygon%3e%3cpolygon%20class='st0'%20points='512,102.313%20276.031,330.281%20212.656,266.906%200,471.578%20512,471.578%20'%20data-v-7a837531=''%3e%3c/polygon%3e%3c/g%3e%3c/g%3e%3c/svg%3e",_imports_1="data:image/svg+xml,%3csvg%20fill='%23fff'%20width='30'%20height='30'%20viewBox='0%200%201000%201000'%20xmlns='http://www.w3.org/2000/svg'%20data-v-7a837531=''%3e%3cg%20id='SVGRepo_bgCarrier'%20stroke-width='0'%20data-v-7a837531=''%3e%3c/g%3e%3cg%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'%20data-v-7a837531=''%3e%3c/g%3e%3cg%20id='SVGRepo_iconCarrier'%20data-v-7a837531=''%3e%3cpath%20d='M408%20242q0%2038%2027%2064.5t65%2026.5%2065-26.5%2027-64.5-27-65-65-27-65%2027-27%2065zM58%20559q20%2019%2047%2024.5t53-5%2041.5-33.5%2015.5-51-15.5-51-41-34-53-5.5T58%20429q-27%2027-27%2065t27%2065zm442-171q-29%200-55-11-10-4-18%202l-45%2030q-5%204-7.5%2010t-.5%2012l107%20385q3%2010%2011%2013.5t16.5%200T519%20816l107-385q2-6-.5-12t-7.5-10l-45-30q-8-6-18-2-26%2011-55%2011zM328%20526l-57%2011q-8%202-11%209-11%2028-32%2050t-49%2033q-6%203-8%209l-11%2058q-1%205%201.5%209.5t6.5%206.5l233%20117q9%205%2016.5-1.5T422%20812l-76-275q-2-6-7-9t-11-2zm614%2033q-20%2019-47%2024.5t-53-5-41.5-33.5-15.5-51%2015.5-51%2041-34%2053-5.5T942%20429q27%2027%2027%2065t-27%2065zm-270-33l57%2011q8%202%2011%209%2011%2028%2032%2049.5t48%2033.5q8%203%209%2011l11%2058q1%204-1%207.5t-5%205.5L599%20829q-9%205-16.5-1.5T578%20812l76-275q2-6%207-9t11-2z'%20data-v-7a837531=''%3e%3c/path%3e%3c/g%3e%3c/svg%3e",_imports_2="data:image/svg+xml,%3csvg%20fill='%23fff'%20width='30'%20height='30'%20viewBox='0%200%2024%2024'%20xmlns='http://www.w3.org/2000/svg'%20data-v-7a837531=''%3e%3cg%20id='SVGRepo_bgCarrier'%20stroke-width='0'%20data-v-7a837531=''%3e%3c/g%3e%3cg%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'%20data-v-7a837531=''%3e%3c/g%3e%3cg%20id='SVGRepo_iconCarrier'%20data-v-7a837531=''%3e%3cpath%20d='M11,3a1,1,0,0,0-1-1H3A1,1,0,0,0,2,3V22h9ZM9,18H4V16H9Zm0-4H4V12H9Zm0-4H4V8H9ZM9,6H4V4H9ZM21,8H14a1,1,0,0,0-1,1V22h9V9A1,1,0,0,0,21,8ZM17,20H15V18h2Zm0-4H15V14h2Zm0-4H15V10h2Zm3,8H18V18h2Zm0-4H18V14h2Zm0-4H18V10h2Z'%20data-v-7a837531=''%3e%3c/path%3e%3c/g%3e%3c/svg%3e",_imports_3$1="data:image/svg+xml,%3csvg%20width='30'%20height='30'%20viewBox='0%200%2024%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20data-v-7a837531=''%3e%3cg%20id='SVGRepo_bgCarrier'%20stroke-width='0'%20data-v-7a837531=''%3e%3c/g%3e%3cg%20id='SVGRepo_tracerCarrier'%20stroke-linecap='round'%20stroke-linejoin='round'%20data-v-7a837531=''%3e%3c/g%3e%3cg%20id='SVGRepo_iconCarrier'%20data-v-7a837531=''%3e%3cpath%20d='M5%206H19M5%2010H15M5%2014H19M5%2018H15'%20stroke='%23ffffff'%20stroke-width='2'%20stroke-linecap='round'%20stroke-linejoin='round'%20data-v-7a837531=''%3e%3c/path%3e%3c/g%3e%3c/svg%3e",_imports_4$1=""+new URL("logoppt-COJLVGXz.png",import.meta.url).href,_imports_5$1=""+new URL("tz1-CQos0cmg.png",import.meta.url).href,_imports_6$1=""+new URL("tz2-DMKzuzuI.png",import.meta.url).href,_imports_7$1=""+new URL("tz3--nKkpLSQ.png",import.meta.url).href,_imports_8=""+new URL("tz4-0XMgFwWP.png",import.meta.url).href,_imports_9=""+new URL("tz5-BzHyPWbb.png",import.meta.url).href,_hoisted_1$2={class:"banner_1"},_hoisted_2$2={class:"title_1"},_hoisted_3$2={class:"txt_3"},_hoisted_4$2={class:"txt_1"},_hoisted_5$2={class:"b1dom"},_hoisted_6$2={class:"dombox1 xcxc"},_hoisted_7$2={class:"zx11"},_hoisted_8$2={class:"solution"},_hoisted_9$1={class:"dombox2 xcxc"},_hoisted_10$1={class:"zx11"},_hoisted_11$1={class:"solution"},_hoisted_12$1={class:"dombox3 xcxc"},_hoisted_13$1={class:"zx11"},_hoisted_14$1={class:"solution"},_hoisted_15$1={class:"dombox4 xcxc"},_hoisted_16$1={class:"zx11"},_hoisted_17$1={class:"solution"},_hoisted_18$1={class:"b1imgbox"},_hoisted_19$1={class:"tzt1"},_hoisted_20$1={class:"tzt2"},_hoisted_21$1={class:"tzsy"},_hoisted_22$1={class:"sybox"},_hoisted_23$1={class:"sybox"},_hoisted_24$1={class:"sybox"},_hoisted_25$1={class:"sybox"},_hoisted_26$1={class:"sybox"},_hoisted_27$1={class:"yazxz"},_hoisted_28$1={class:"pppa"},_hoisted_29$1={class:"banner_2"},_hoisted_30$1={class:"ba1 bbbz1"},_hoisted_31$1={class:"bat1"},_hoisted_32$1={class:"babox1 wid1"},_hoisted_33$1={class:"bacard",style:{width:"59%"}},_hoisted_34$1={class:"card1"},_hoisted_35$1={class:"card2"},_hoisted_36$1={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_37$1={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_38$1={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_39$1={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_40$1={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_41$1={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_42$1={style:{padding:"6px 0",color:"#2f5597"}},_hoisted_43$1={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_44$1={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_45$1={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_46$1={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_47$1={style:{padding:"6px 0",color:"#2f5597"}},_hoisted_48$1={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_49$1={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_50$1={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_51$1={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_52$1={class:"bacard",style:{width:"24%"}},_hoisted_53$1={class:"card1"},_hoisted_54$1={class:"card2"},_hoisted_55$1={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_56$1={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_57$1={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_58$1={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_59$1={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_60$1={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_61$1={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_62$1={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_63$1={class:"bacard",style:{width:"14%"}},_hoisted_64$1={class:"card1"},_hoisted_65$1={class:"card2"},_hoisted_66$1={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_67$1={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_68$1={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_69$1={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_70$1={class:"ba1 bbbz2"},_hoisted_71$1={class:"bat1"},_hoisted_72$1={class:"babox1"},_hoisted_73$1={class:"bacard"},_hoisted_74$1={class:"card1"},_hoisted_75$1={class:"card2"},_hoisted_76={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_77={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_78={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_79={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_80={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_81={class:"bacard"},_hoisted_82={class:"card1"},_hoisted_83={class:"card2"},_hoisted_84={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_85={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_86={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_87={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_88={class:"bacard"},_hoisted_89={class:"card1"},_hoisted_90={class:"card2"},_hoisted_91={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_92={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_93={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_94={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_95={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_96={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_97={class:"ba1 bbbz3"},_hoisted_98={class:"bat1"},_hoisted_99={class:"babox1 wid4"},_hoisted_100={class:"bacard",style:{width:"17%"}},_hoisted_101={class:"card1"},_hoisted_102={class:"card2"},_hoisted_103={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_104={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_105={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_106={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_107={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_108={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_109={class:"bacard",style:{width:"35%"}},_hoisted_110={class:"card1"},_hoisted_111={class:"card2"},_hoisted_112={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_113={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_114={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_115={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_116={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_117={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_118={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_119={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_120={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_121={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_122={class:"bacard",style:{width:"17%"}},_hoisted_123={class:"card1"},_hoisted_124={class:"card2"},_hoisted_125={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_126={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_127={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_128={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_129={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_130={class:"bacard",style:{width:"25%"}},_hoisted_131={class:"card1"},_hoisted_132={class:"card2"},_hoisted_133={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_134={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_135={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_136={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_137={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_138={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_hoisted_139={style:{padding:"3px 0",color:"#2f5597"}},_hoisted_140={style:{padding:"3px 0",color:"#333","font-size":"14px"}},_sfc_main$3={__name:"Choose",setup(r){const{t:e,locale:i}=useI18n();return(n,o)=>(openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",_hoisted_1$2,[createBaseVNode("div",_hoisted_2$2,[createBaseVNode("div",_hoisted_3$2,toDisplayString$1(n.$t("choosein1")),1),createBaseVNode("div",_hoisted_4$2,toDisplayString$1(n.$t("choosein2")),1)]),createBaseVNode("div",_hoisted_5$2,[createBaseVNode("div",_hoisted_6$2,[o[0]||(o[0]=createBaseVNode("img",{class:"qw11",src:_imports_0$1,alt:""},null,-1)),o[1]||(o[1]=createBaseVNode("div",{class:"as11"},"",-1)),createBaseVNode("div",_hoisted_7$2,toDisplayString$1(n.$t("choosein3")),1),createBaseVNode("div",_hoisted_8$2,toDisplayString$1(n.$t("choosein3_1")),1)]),createBaseVNode("div",_hoisted_9$1,[o[2]||(o[2]=createBaseVNode("img",{class:"qw11",src:_imports_1,alt:""},null,-1)),o[3]||(o[3]=createBaseVNode("div",{class:"as11"},"",-1)),createBaseVNode("div",_hoisted_10$1,toDisplayString$1(n.$t("choosein4")),1),createBaseVNode("div",_hoisted_11$1,toDisplayString$1(n.$t("choosein4_1")),1)]),createBaseVNode("div",_hoisted_12$1,[o[4]||(o[4]=createBaseVNode("img",{class:"qw11",src:_imports_2,alt:""},null,-1)),o[5]||(o[5]=createBaseVNode("div",{class:"as11"},"",-1)),createBaseVNode("div",_hoisted_13$1,toDisplayString$1(n.$t("choosein5")),1),createBaseVNode("div",_hoisted_14$1,toDisplayString$1(n.$t("choosein5_1")),1)]),createBaseVNode("div",_hoisted_15$1,[o[6]||(o[6]=createBaseVNode("img",{class:"qw11",src:_imports_3$1,alt:""},null,-1)),o[7]||(o[7]=createBaseVNode("div",{class:"as11"},"",-1)),createBaseVNode("div",_hoisted_16$1,toDisplayString$1(n.$t("choosein6")),1),createBaseVNode("div",_hoisted_17$1,toDisplayString$1(n.$t("choosein6_1")),1)])]),createBaseVNode("div",_hoisted_18$1,[createBaseVNode("div",_hoisted_19$1,[createBaseVNode("div",null,toDisplayString$1(n.$t("choosein7")),1),o[8]||(o[8]=createBaseVNode("img",{src:_imports_4$1,alt:""},null,-1))]),createBaseVNode("div",_hoisted_20$1,toDisplayString$1(n.$t("choosein8")),1),createBaseVNode("div",_hoisted_21$1,[createBaseVNode("div",_hoisted_22$1,[o[9]||(o[9]=createBaseVNode("img",{src:_imports_5$1,alt:""},null,-1)),createBaseVNode("h4",null,toDisplayString$1(n.$t("choosein9")),1)]),createBaseVNode("div",_hoisted_23$1,[o[10]||(o[10]=createBaseVNode("img",{src:_imports_6$1,alt:""},null,-1)),createBaseVNode("h4",null,toDisplayString$1(n.$t("choosein10")),1)]),createBaseVNode("div",_hoisted_24$1,[o[11]||(o[11]=createBaseVNode("img",{src:_imports_7$1,alt:""},null,-1)),createBaseVNode("h4",null,toDisplayString$1(n.$t("choosein11")),1)]),createBaseVNode("div",_hoisted_25$1,[o[12]||(o[12]=createBaseVNode("img",{src:_imports_8,alt:""},null,-1)),createBaseVNode("h4",null,toDisplayString$1(n.$t("choosein12")),1)]),createBaseVNode("div",_hoisted_26$1,[o[13]||(o[13]=createBaseVNode("img",{src:_imports_9,alt:""},null,-1)),createBaseVNode("h4",null,toDisplayString$1(n.$t("choosein13")),1)])])])]),createBaseVNode("div",_hoisted_27$1,[createBaseVNode("div",_hoisted_28$1,toDisplayString$1(n.$t("choosein14")),1)]),createBaseVNode("div",_hoisted_29$1,[createBaseVNode("div",_hoisted_30$1,[createBaseVNode("div",_hoisted_31$1,toDisplayString$1(n.$t("choosein14")),1),createBaseVNode("div",_hoisted_32$1,[createBaseVNode("div",_hoisted_33$1,[createBaseVNode("div",_hoisted_34$1,toDisplayString$1(n.$t("bbox1")),1),createBaseVNode("div",_hoisted_35$1,[createBaseVNode("div",_hoisted_36$1,toDisplayString$1(n.$t("bbox2")),1),createBaseVNode("div",_hoisted_37$1,toDisplayString$1(n.$t("bbox3")),1),createBaseVNode("div",_hoisted_38$1,toDisplayString$1(n.$t("bbox4")),1),createBaseVNode("div",_hoisted_39$1,toDisplayString$1(n.$t("bbox5")),1),createBaseVNode("div",_hoisted_40$1,toDisplayString$1(n.$t("bboxlj")),1),createBaseVNode("div",_hoisted_41$1,toDisplayString$1(n.$t("bbox6")),1),createBaseVNode("div",_hoisted_42$1,toDisplayString$1(n.$t("bbox7")),1),createBaseVNode("div",_hoisted_43$1,toDisplayString$1(n.$t("bbox8")),1),createBaseVNode("div",_hoisted_44$1,toDisplayString$1(n.$t("bbox9")),1),createBaseVNode("div",_hoisted_45$1,toDisplayString$1(n.$t("bboxlj")),1),createBaseVNode("div",_hoisted_46$1,toDisplayString$1(n.$t("bbox10")),1),createBaseVNode("div",_hoisted_47$1,toDisplayString$1(n.$t("bbox11")),1),createBaseVNode("div",_hoisted_48$1,toDisplayString$1(n.$t("bbox12")),1),createBaseVNode("div",_hoisted_49$1,toDisplayString$1(n.$t("bbox13")),1),createBaseVNode("div",_hoisted_50$1,toDisplayString$1(n.$t("bboxlj")),1),createBaseVNode("div",_hoisted_51$1,toDisplayString$1(n.$t("bbox14")),1)])]),createBaseVNode("div",_hoisted_52$1,[createBaseVNode("div",_hoisted_53$1,toDisplayString$1(n.$t("bbox15")),1),createBaseVNode("div",_hoisted_54$1,[createBaseVNode("div",_hoisted_55$1,toDisplayString$1(n.$t("bbox16")),1),createBaseVNode("div",_hoisted_56$1,toDisplayString$1(n.$t("bbox17")),1),createBaseVNode("div",_hoisted_57$1,toDisplayString$1(n.$t("bboxlj")),1),createBaseVNode("div",_hoisted_58$1,toDisplayString$1(n.$t("bbox18")),1),createBaseVNode("div",_hoisted_59$1,toDisplayString$1(n.$t("bbox19")),1),createBaseVNode("div",_hoisted_60$1,toDisplayString$1(n.$t("bbox20")),1),createBaseVNode("div",_hoisted_61$1,toDisplayString$1(n.$t("bboxlj")),1),createBaseVNode("div",_hoisted_62$1,toDisplayString$1(n.$t("bbox21")),1)])]),createBaseVNode("div",_hoisted_63$1,[createBaseVNode("div",_hoisted_64$1,toDisplayString$1(n.$t("bbox22")),1),createBaseVNode("div",_hoisted_65$1,[createBaseVNode("div",_hoisted_66$1,toDisplayString$1(n.$t("bbox23")),1),createBaseVNode("div",_hoisted_67$1,toDisplayString$1(n.$t("bbox24")),1),createBaseVNode("div",_hoisted_68$1,toDisplayString$1(n.$t("bboxlj")),1),createBaseVNode("div",_hoisted_69$1,toDisplayString$1(n.$t("bbox25")),1)])])])]),createBaseVNode("div",_hoisted_70$1,[createBaseVNode("div",_hoisted_71$1,toDisplayString$1(n.$t("choosein15")),1),createBaseVNode("div",_hoisted_72$1,[createBaseVNode("div",_hoisted_73$1,[createBaseVNode("div",_hoisted_74$1,toDisplayString$1(n.$t("bbox2_1")),1),createBaseVNode("div",_hoisted_75$1,[createBaseVNode("div",_hoisted_76,toDisplayString$1(n.$t("bbox2_2")),1),createBaseVNode("div",_hoisted_77,toDisplayString$1(n.$t("bbox2_3")),1),createBaseVNode("div",_hoisted_78,toDisplayString$1(n.$t("bbox2_4")),1),createBaseVNode("div",_hoisted_79,toDisplayString$1(n.$t("bbox2_5")),1),createBaseVNode("div",_hoisted_80,toDisplayString$1(n.$t("bbox2_6")),1)])]),createBaseVNode("div",_hoisted_81,[createBaseVNode("div",_hoisted_82,toDisplayString$1(n.$t("bbox2_7")),1),createBaseVNode("div",_hoisted_83,[createBaseVNode("div",_hoisted_84,toDisplayString$1(n.$t("bbox2_8")),1),createBaseVNode("div",_hoisted_85,toDisplayString$1(n.$t("bbox2_9")),1),createBaseVNode("div",_hoisted_86,toDisplayString$1(n.$t("bbox2_10")),1),createBaseVNode("div",_hoisted_87,toDisplayString$1(n.$t("bbox2_11")),1)])]),createBaseVNode("div",_hoisted_88,[createBaseVNode("div",_hoisted_89,toDisplayString$1(n.$t("bbox2_12")),1),createBaseVNode("div",_hoisted_90,[createBaseVNode("div",_hoisted_91,toDisplayString$1(n.$t("bbox2_13")),1),createBaseVNode("div",_hoisted_92,toDisplayString$1(n.$t("bbox2_15")),1),createBaseVNode("div",_hoisted_93,toDisplayString$1(n.$t("bbox2_16")),1),createBaseVNode("div",_hoisted_94,toDisplayString$1(n.$t("bbox2_17")),1),createBaseVNode("div",_hoisted_95,toDisplayString$1(n.$t("bbox2_18")),1),createBaseVNode("div",_hoisted_96,toDisplayString$1(n.$t("bbox2_19")),1)])])])]),createBaseVNode("div",_hoisted_97,[createBaseVNode("div",_hoisted_98,toDisplayString$1(n.$t("choosein16")),1),createBaseVNode("div",_hoisted_99,[createBaseVNode("div",_hoisted_100,[createBaseVNode("div",_hoisted_101,toDisplayString$1(n.$t("bbox3_1")),1),createBaseVNode("div",_hoisted_102,[createBaseVNode("div",_hoisted_103,toDisplayString$1(n.$t("bbox3_2")),1),createBaseVNode("div",_hoisted_104,toDisplayString$1(n.$t("bbox3_3")),1),createBaseVNode("div",_hoisted_105,toDisplayString$1(n.$t("bbox3_4")),1),createBaseVNode("div",_hoisted_106,toDisplayString$1(n.$t("bbox3_5")),1),createBaseVNode("div",_hoisted_107,toDisplayString$1(n.$t("bbox3_6")),1),createBaseVNode("div",_hoisted_108,toDisplayString$1(n.$t("bbox3_7")),1)])]),createBaseVNode("div",_hoisted_109,[createBaseVNode("div",_hoisted_110,toDisplayString$1(n.$t("bbox3_8")),1),createBaseVNode("div",_hoisted_111,[createBaseVNode("div",_hoisted_112,toDisplayString$1(n.$t("bbox3_9")),1),createBaseVNode("div",_hoisted_113,toDisplayString$1(n.$t("bbox3_10")),1),createBaseVNode("div",_hoisted_114,toDisplayString$1(n.$t("bbox3_11")),1),createBaseVNode("div",_hoisted_115,toDisplayString$1(n.$t("bbox3_12")),1),createBaseVNode("div",_hoisted_116,toDisplayString$1(n.$t("bbox3_13")),1),createBaseVNode("div",_hoisted_117,toDisplayString$1(n.$t("bbox3_14")),1),createBaseVNode("div",_hoisted_118,toDisplayString$1(n.$t("bbox3_15")),1),createBaseVNode("div",_hoisted_119,toDisplayString$1(n.$t("bbox3_16")),1),createBaseVNode("div",_hoisted_120,toDisplayString$1(n.$t("bbox3_17")),1),createBaseVNode("div",_hoisted_121,toDisplayString$1(n.$t("bbox3_18")),1)])]),createBaseVNode("div",_hoisted_122,[createBaseVNode("div",_hoisted_123,toDisplayString$1(n.$t("bbox3_19")),1),createBaseVNode("div",_hoisted_124,[createBaseVNode("div",_hoisted_125,toDisplayString$1(n.$t("bbox3_20")),1),createBaseVNode("div",_hoisted_126,toDisplayString$1(n.$t("bbox3_21")),1),createBaseVNode("div",_hoisted_127,toDisplayString$1(n.$t("bbox3_22")),1),createBaseVNode("div",_hoisted_128,toDisplayString$1(n.$t("bbox3_23")),1),createBaseVNode("div",_hoisted_129,toDisplayString$1(n.$t("bbox3_24")),1)])]),createBaseVNode("div",_hoisted_130,[createBaseVNode("div",_hoisted_131,toDisplayString$1(n.$t("bbox3_25")),1),createBaseVNode("div",_hoisted_132,[createBaseVNode("div",_hoisted_133,toDisplayString$1(n.$t("bbox3_26")),1),createBaseVNode("div",_hoisted_134,toDisplayString$1(n.$t("bbox3_27")),1),createBaseVNode("div",_hoisted_135,toDisplayString$1(n.$t("bbox3_28")),1),createBaseVNode("div",_hoisted_136,toDisplayString$1(n.$t("bbox3_29")),1),createBaseVNode("div",_hoisted_137,toDisplayString$1(n.$t("bbox3_30")),1),createBaseVNode("div",_hoisted_138,toDisplayString$1(n.$t("bbox3_31")),1),createBaseVNode("div",_hoisted_139,toDisplayString$1(n.$t("bbox3_32")),1),createBaseVNode("div",_hoisted_140,toDisplayString$1(n.$t("bbox3_33")),1)])])])])])],64))}},Choose=_export_sfc(_sfc_main$3,[["__scopeId","data-v-fa94e907"]]),_imports_3=""+new URL("d1-B9DwKaB4.png",import.meta.url).href,_imports_4=""+new URL("d2-CRcvtxv8.png",import.meta.url).href,_imports_5=""+new URL("d3-Ko8GDPn_.png",import.meta.url).href,_imports_6=""+new URL("d4-DEsKZAix.png",import.meta.url).href,_imports_7=""+new URL("d5-DzELU86R.png",import.meta.url).href,arrayParser=r=>r;var RenderModeEnum;(function(r){r["desktop-browser"]="desktop-browser",r["mobile-browser"]="mobile-browser",r.node="node",r.worker="worker",r.miniApp="miniApp",r.wx="wx",r.tt="tt",r.harmony="harmony",r["desktop-miniApp"]="desktop-miniApp",r.lynx="lynx"})(RenderModeEnum||(RenderModeEnum={}));var ComponentTypeEnum;(function(r){r.cartesianAxis="cartesianAxis",r.cartesianBandAxis="cartesianAxis-band",r.cartesianLinearAxis="cartesianAxis-linear",r.cartesianTimeAxis="cartesianAxis-time",r.cartesianLogAxis="cartesianAxis-log",r.cartesianSymlogAxis="cartesianAxis-symlog",r.polarAxis="polarAxis",r.polarBandAxis="polarAxis-band",r.polarLinearAxis="polarAxis-linear",r.crosshair="crosshair",r.cartesianCrosshair="cartesianCrosshair",r.polarCrosshair="polarCrosshair",r.dataZoom="dataZoom",r.geoCoordinate="geoCoordinate",r.indicator="indicator",r.discreteLegend="discreteLegend",r.continuousLegend="continuousLegend",r.colorLegend="colorLegend",r.sizeLegend="sizeLegend",r.mapLabel="mapLabel",r.markLine="markLine",r.markArea="markArea",r.markPoint="markPoint",r.polarMarkLine="polarMarkLine",r.polarMarkArea="polarMarkArea",r.polarMarkPoint="polarMarkPoint",r.geoMarkPoint="geoMarkPoint",r.tooltip="tooltip",r.title="title",r.player="player",r.scrollBar="scrollBar",r.label="label",r.totalLabel="totalLabel",r.brush="brush",r.poptip="poptip",r.customMark="customMark"})(ComponentTypeEnum||(ComponentTypeEnum={}));function getDefaultExportFromCjs(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var eventemitter3={exports:{}},hasRequiredEventemitter3;function requireEventemitter3(){return hasRequiredEventemitter3||(hasRequiredEventemitter3=1,function(r){var e=Object.prototype.hasOwnProperty,i="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(i=!1));function o(f,g,_){this.fn=f,this.context=g,this.once=_||!1}function l(f,g,_,y,b){if(typeof _!="function")throw new TypeError("The listener must be a function");var S=new o(_,y||f,b),v=i?i+g:g;return f._events[v]?f._events[v].fn?f._events[v]=[f._events[v],S]:f._events[v].push(S):(f._events[v]=S,f._eventsCount++),f}function d(f,g){--f._eventsCount===0?f._events=new n:delete f._events[g]}function u(){this._events=new n,this._eventsCount=0}u.prototype.eventNames=function(){var g=[],_,y;if(this._eventsCount===0)return g;for(y in _=this._events)e.call(_,y)&&g.push(i?y.slice(1):y);return Object.getOwnPropertySymbols?g.concat(Object.getOwnPropertySymbols(_)):g},u.prototype.listeners=function(g){var _=i?i+g:g,y=this._events[_];if(!y)return[];if(y.fn)return[y.fn];for(var b=0,S=y.length,v=new Array(S);b<S;b++)v[b]=y[b].fn;return v},u.prototype.listenerCount=function(g){var _=i?i+g:g,y=this._events[_];return y?y.fn?1:y.length:0},u.prototype.emit=function(g,_,y,b,S,v){var A=i?i+g:g;if(!this._events[A])return!1;var x=this._events[A],T=arguments.length,C,E;if(x.fn){switch(x.once&&this.removeListener(g,x.fn,void 0,!0),T){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,_),!0;case 3:return x.fn.call(x.context,_,y),!0;case 4:return x.fn.call(x.context,_,y,b),!0;case 5:return x.fn.call(x.context,_,y,b,S),!0;case 6:return x.fn.call(x.context,_,y,b,S,v),!0}for(E=1,C=new Array(T-1);E<T;E++)C[E-1]=arguments[E];x.fn.apply(x.context,C)}else{var P=x.length,R;for(E=0;E<P;E++)switch(x[E].once&&this.removeListener(g,x[E].fn,void 0,!0),T){case 1:x[E].fn.call(x[E].context);break;case 2:x[E].fn.call(x[E].context,_);break;case 3:x[E].fn.call(x[E].context,_,y);break;case 4:x[E].fn.call(x[E].context,_,y,b);break;default:if(!C)for(R=1,C=new Array(T-1);R<T;R++)C[R-1]=arguments[R];x[E].fn.apply(x[E].context,C)}}return!0},u.prototype.on=function(g,_,y){return l(this,g,_,y,!1)},u.prototype.once=function(g,_,y){return l(this,g,_,y,!0)},u.prototype.removeListener=function(g,_,y,b){var S=i?i+g:g;if(!this._events[S])return this;if(!_)return d(this,S),this;var v=this._events[S];if(v.fn)v.fn===_&&(!b||v.once)&&(!y||v.context===y)&&d(this,S);else{for(var A=0,x=[],T=v.length;A<T;A++)(v[A].fn!==_||b&&!v[A].once||y&&v[A].context!==y)&&x.push(v[A]);x.length?this._events[S]=x.length===1?x[0]:x:d(this,S)}return this},u.prototype.removeAllListeners=function(g){var _;return g?(_=i?i+g:g,this._events[_]&&d(this,_)):(this._events=new n,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=i,u.EventEmitter=u,r.exports=u}(eventemitter3)),eventemitter3.exports}var eventemitter3Exports=requireEventemitter3();const EventEmitter=getDefaultExportFromCjs(eventemitter3Exports),isType=(r,e)=>Object.prototype.toString.call(r)===`[object ${e}]`,isBoolean=(r,e=!1)=>e?typeof r=="boolean":r===!0||r===!1||isType(r,"Boolean"),isFunction=r=>typeof r=="function",isNil=r=>r==null,isValid=r=>r!=null,isObject$1=r=>{const e=typeof r;return r!==null&&e==="object"||e==="function"},isObjectLike=r=>typeof r=="object"&&r!==null,isPlainObject=function(r){if(!isObjectLike(r)||!isType(r,"Object"))return!1;if(Object.getPrototypeOf(r)===null)return!0;let e=r;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(r)===e},isUndefined=r=>r===void 0,isString=(r,e=!1)=>{const i=typeof r;return e?i==="string":i==="string"||isType(r,"String")},isArray=r=>Array.isArray?Array.isArray(r):isType(r,"Array"),isArrayLike=function(r){return r!==null&&typeof r!="function"&&Number.isFinite(r.length)},isDate=r=>isType(r,"Date"),isNumber=(r,e=!1)=>{const i=typeof r;return e?i==="number":i==="number"||isType(r,"Number")},isNumeric=r=>typeof r=="string"&&!isNaN(Number(r))&&!isNaN(parseFloat(r)),isValidNumber=r=>isNumber(r)&&Number.isFinite(r),isValidUrl=r=>new RegExp(/^(http(s)?:\/\/)\w+[^\s]+(\.[^\s]+){1,}$/).test(r),isBase64=r=>new RegExp(/^data:image\/(?:gif|png|jpeg|bmp|webp|svg\+xml)(?:;charset=utf-8)?;base64,(?:[A-Za-z0-9]|[+/])+={0,2}/g).test(r),getType=r=>({}).toString.call(r).replace(/^\[object /,"").replace(/]$/,""),objectProto=Object.prototype,isPrototype=function(r){const e=r&&r.constructor;return r===(typeof e=="function"&&e.prototype||objectProto)},hasOwnProperty$1=Object.prototype.hasOwnProperty;function isEmpty(r){if(isNil(r))return!0;if(isArrayLike(r))return!r.length;const e=getType(r);if(e==="Map"||e==="Set")return!r.size;if(isPrototype(r))return!Object.keys(r).length;for(const i in r)if(hasOwnProperty$1.call(r,i))return!1;return!0}const get=(r,e,i)=>{const n=isString(e)?e.split("."):e;for(let o=0;o<n.length;o++)r=r?r[n[o]]:void 0;return r===void 0?i:r},hasOwnProperty=Object.prototype.hasOwnProperty,has=(r,e)=>r!=null&&hasOwnProperty.call(r,e);function cloneDeep(r,e,i){let n;if(!isValid(r)||typeof r!="object"||e&&e(r))return r;const o=isArray(r),l=r.length;n=o?new Array(l):typeof r=="object"?{}:isBoolean(r)||isNumber(r)||isString(r)?r:isDate(r)?new Date(+r):void 0;const d=o?void 0:Object.keys(Object(r));let u=-1;if(n)for(;++u<(d||r).length;){const f=d?d[u]:u,g=r[f];i&&i.includes(f.toString())?n[f]=g:n[f]=cloneDeep(g,e,i)}return n}function baseMerge(r,e,i=!1,n=!1){if(e){if(r===e)return;if(isValid(e)&&typeof e=="object"){const o=Object(e),l=[];for(const f in o)l.push(f);let{length:d}=l,u=-1;for(;d--;){const f=l[++u];!isValid(o[f])||typeof o[f]!="object"||n&&isArray(r[f])?assignMergeValue(r,f,o[f]):baseMergeDeep(r,e,f,i,n)}}}}function baseMergeDeep(r,e,i,n=!1,o=!1){const l=r[i],d=e[i];let u=e[i],f=!0;if(isArray(d)){if(n)u=[];else if(isArray(l))u=l;else if(isArrayLike(l)){u=new Array(l.length);let g=-1;const _=l.length;for(;++g<_;)u[g]=l[g]}}else isPlainObject(d)?(u=l??{},typeof l!="function"&&typeof l=="object"||(u={})):f=!1;f&&baseMerge(u,d,n,o),assignMergeValue(r,i,u)}function assignMergeValue(r,e,i){(i!==void 0&&!eq(r[e],i)||i===void 0&&!(e in r))&&(r[e]=i)}function eq(r,e){return r===e||Number.isNaN(r)&&Number.isNaN(e)}function merge$1(r,...e){let i=-1;const n=e.length;for(;++i<n;)baseMerge(r,e[i],!0);return r}function pickWithout(r,e){if(!r||!isPlainObject(r))return r;const i={};return Object.keys(r).forEach(n=>{const o=r[n];let l=!1;e.forEach(d=>{(isString(d)&&d===n||d instanceof RegExp&&n.match(d))&&(l=!0)}),l||(i[n]=o)}),i}function objToString(r){return Object.prototype.toString.call(r)}function objectKeys(r){return Object.keys(r)}function isEqual(r,e,i){if(r===e)return!0;if(typeof r!=typeof e||r==null||e==null)return!1;if(Number.isNaN(r)&&Number.isNaN(e))return!0;if(objToString(r)!==objToString(e)||isFunction(r)||typeof r!="object")return!1;if(isArray(r)){if(r.length!==e.length)return!1;for(let l=r.length-1;l>=0;l--)if(!isEqual(r[l],e[l]))return!1;return!0}if(!isPlainObject(r))return!1;const n=objectKeys(r),o=objectKeys(e);if(n.length!==o.length)return!1;n.sort(),o.sort();for(let l=n.length-1;l>=0;l--)if(n[l]!=o[l])return!1;for(let l=n.length-1;l>=0;l--){const d=n[l];if(!isEqual(r[d],e[d]))return!1}return!0}function keys(r){if(!r)return[];if(Object.keys)return Object.keys(r);const e=[];for(const i in r)r.hasOwnProperty(i)&&e.push(i);return e}function defaults(r,e,i){const n=keys(e);for(let o=0;o<n.length;o++){const l=n[o];(i?e[l]!=null:r[l]==null)&&(r[l]=e[l])}return r}function mixin(r,e,i=!0){if(r="prototype"in r?r.prototype:r,e="prototype"in e?e.prototype:e,Object.getOwnPropertyNames){const n=Object.getOwnPropertyNames(e);for(let o=0;o<n.length;o++){const l=n[o];l!=="constructor"&&(i?e[l]!=null:r[l]==null)&&(r[l]=e[l])}}else defaults(r,e,i)}function array(r){return isValid(r)?isArray(r)?r:[r]:[]}function last(r){if(isArrayLike(r))return r[r.length-1]}const maxInArray=(r,e)=>{var i;if(r.length===0)return;let n=r[0];for(let o=1;o<r.length;o++){const l=r[o];((i=e==null?void 0:e(l,n))!==null&&i!==void 0?i:l-n)>0&&(n=l)}return n},minInArray=(r,e)=>{var i;if(r.length===0)return;let n=r[0];for(let o=1;o<r.length;o++){const l=r[o];((i=e==null?void 0:e(l,n))!==null&&i!==void 0?i:l-n)<0&&(n=l)}return n};function arrayEqual(r,e){if(!isArray(r)||!isArray(e)||r.length!==e.length)return!1;for(let i=0;i<r.length;i++)if(r[i]!==e[i])return!1;return!0}function uniqArray(r){return r&&isArray(r)?Array.from(new Set(array(r))):r}function shuffleArray(r,e=Math.random){let i,n,o=r.length;for(;o;)i=Math.floor(e()*o),n=r[--o],r[o]=r[i],r[i]=n;return r}function flattenArray(r){if(!isArray(r))return[r];const e=[];for(const i of r)e.push(...flattenArray(i));return e}function range(r,e,i){isValid(e)||(e=r,r=0),isValid(i)||(i=1);let n=-1;const o=0|Math.max(0,Math.ceil((e-r)/i)),l=new Array(o);for(;++n<o;)l[n]=r+n*i;return l}function ascending$1(r,e){return r<e?-1:r>e?1:r>=e?0:NaN}function toNumber(r){return Number(r)}function quantileSorted(r,e,i=toNumber){const n=r.length;if(!n)return;if(n<2)return i(r[0],0,r);const o=(n-1)*e,l=Math.floor(o),d=i(r[l],l,r);return d+(i(r[l+1],l+1,r)-d)*(o-l)}const hasConsole=typeof console<"u";function log$1(r,e,i){const n=[e].concat([].slice.call(i));hasConsole&&console[r].apply(console,n)}var LoggerLevel;(function(r){r[r.None=0]="None",r[r.Error=1]="Error",r[r.Warn=2]="Warn",r[r.Info=3]="Info",r[r.Debug=4]="Debug"})(LoggerLevel||(LoggerLevel={}));class Logger{static getInstance(e,i){return Logger._instance&&isNumber(e)?Logger._instance.level(e):Logger._instance||(Logger._instance=new Logger(e,i)),Logger._instance}static setInstance(e){return Logger._instance=e}static setInstanceLevel(e){Logger._instance?Logger._instance.level(e):Logger._instance=new Logger(e)}static clearInstance(){Logger._instance=null}constructor(e=LoggerLevel.None,i){this._onErrorHandler=[],this._level=e,this._method=i}addErrorHandler(e){this._onErrorHandler.find(i=>i===e)||this._onErrorHandler.push(e)}removeErrorHandler(e){const i=this._onErrorHandler.findIndex(n=>n===e);i<0||this._onErrorHandler.splice(i,1)}callErrorHandler(...e){this._onErrorHandler.forEach(i=>i(...e))}canLogInfo(){return this._level>=LoggerLevel.Info}canLogDebug(){return this._level>=LoggerLevel.Debug}canLogError(){return this._level>=LoggerLevel.Error}canLogWarn(){return this._level>=LoggerLevel.Warn}level(e){return arguments.length?(this._level=+e,this):this._level}error(...e){var i;return this._level>=LoggerLevel.Error&&(this._onErrorHandler.length?this.callErrorHandler(...e):log$1((i=this._method)!==null&&i!==void 0?i:"error","ERROR",e)),this}warn(...e){return this._level>=LoggerLevel.Warn&&log$1(this._method||"warn","WARN",e),this}info(...e){return this._level>=LoggerLevel.Info&&log$1(this._method||"log","INFO",e),this}debug(...e){return this._level>=LoggerLevel.Debug&&log$1(this._method||"log","DEBUG",e),this}}Logger._instance=null;function bisect(r,e,i=0,n){for(isNil(n)&&(n=r.length);i<n;){const o=i+n>>>1;ascending$1(r[o],e)>0?n=o:i=o+1}return i}const binaryFuzzySearch=(r,e)=>binaryFuzzySearchInNumberRange(0,r.length,i=>e(r[i])),binaryFuzzySearchInNumberRange=(r,e,i)=>{let n=r,o=e;for(;n<o;){const l=Math.floor((n+o)/2);i(l)>=0?o=l:n=l+1}return n},median$1=(r,e)=>{let i=r;return i=r.sort(ascending$1),quantileSorted(i,.5)},DEFAULT_ABSOLUTE_TOLERATE=1e-10,DEFAULT_RELATIVE_TOLERATE=1e-10;function isNumberClose(r,e,i=DEFAULT_RELATIVE_TOLERATE,n=DEFAULT_ABSOLUTE_TOLERATE){const o=n,l=i*Math.max(r,e);return Math.abs(r-e)<=Math.max(o,l)}function isGreater(r,e,i,n){return r>e&&!isNumberClose(r,e,i,n)}function isLess(r,e,i,n){return r<e&&!isNumberClose(r,e,i,n)}const memoize=r=>{let e=null,i=null;return(...n)=>(e&&n.every((o,l)=>o===e[l])||(e=n,i=r(...n)),i)},clamp=function(r,e,i){return r<e?e:r>i?i:r},clampRange=(r,e,i)=>{let[n,o]=r;o<n&&(n=r[1],o=r[0]);const l=o-n;return l>=i-e?[e,i]:(n=Math.min(Math.max(n,e),i-l),[n,n+l])};function clamper(r,e){let i;return r>e&&(i=r,r=e,e=i),n=>Math.max(r,Math.min(e,n))}let hasRaf=!1;try{hasRaf=typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"}catch{hasRaf=!1}function debounce(r,e,i){let n,o,l,d,u,f,g=0,_=!1,y=!1,b=!0;const S=!e&&e!==0&&hasRaf;if(typeof r!="function")throw new TypeError("Expected a function");function v(P){const R=n,L=o;return n=o=void 0,g=P,d=r.apply(L,R),d}function A(P,R){return S?(cancelAnimationFrame(u),requestAnimationFrame(P)):setTimeout(P,R)}function x(P){const R=P-f;return f===void 0||R>=e||R<0||y&&P-g>=l}function T(){const P=Date.now();if(x(P))return C(P);u=A(T,function(R){const L=R-g,w=e-(R-f);return y?Math.min(w,l-L):w}(P))}function C(P){return u=void 0,b&&n?v(P):(n=o=void 0,d)}function E(...P){const R=Date.now(),L=x(R);if(n=P,o=this,f=R,L){if(u===void 0)return function(w){return g=w,u=A(T,e),_?v(w):d}(f);if(y)return u=A(T,e),v(f)}return u===void 0&&(u=A(T,e)),d}return e=+e||0,isObject$1(i)&&(_=!!i.leading,y="maxWait"in i,y&&(l=Math.max(isValidNumber(i.maxWait)?i.maxWait:0,e)),b="trailing"in i?!!i.trailing:b),E.cancel=function(){u!==void 0&&function(P){if(S)return cancelAnimationFrame(P);clearTimeout(P)}(u),g=0,n=f=o=u=void 0},E.flush=function(){return u===void 0?d:C(Date.now())},E.pending=function(){return u!==void 0},E}hasRaf=!1;function throttle(r,e,i){let n=!0,o=!0;if(typeof r!="function")throw new TypeError("Expected a function");return isObject$1(i)&&(n="leading"in i?!!i.leading:n,o="trailing"in i?!!i.trailing:o),debounce(r,e,{leading:n,trailing:o,maxWait:e})}function interpolateNumber(r,e){return i=>r*(1-i)+e*i}function interpolateNumberRound(r,e){return function(i){return Math.round(r*(1-i)+e*i)}}function interpolateDate(r,e){const i=r.valueOf(),n=e.valueOf(),o=new Date;return l=>(o.setTime(i*(1-l)+n*l),o)}const reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function zero$1(r){return function(){return r}}function one(r){return function(e){return r(e)+""}}function interpolateString(r,e){let i,n,o,l=reA.lastIndex=reB.lastIndex=0,d=-1;const u=[],f=[];for(r+="",e+="";(i=reA.exec(r))&&(n=reB.exec(e));)(o=n.index)>l&&(o=e.slice(l,o),u[d]?u[d]+=o:u[++d]=o),(i=i[0])===(n=n[0])?u[d]?u[d]+=n:u[++d]=n:(u[++d]=null,f.push({i:d,x:interpolateNumber(i,n)})),l=reB.lastIndex;return l<e.length&&(o=e.slice(l),u[d]?u[d]+=o:u[++d]=o),u.length<2?f[0]?one(f[0].x):zero$1(e):(e=f.length,function(g){for(let _,y=0;y<e;++y)u[(_=f[y]).i]=_.x(g);return u.join("")})}function toValidNumber$1(r){if(isValidNumber(r))return r;const e=+r;return isValidNumber(e)?e:0}function seedRandom(r){return parseFloat("0."+Math.sin(r).toString().substring(6))}const epsilon$1=1e-12,pi$1=Math.PI,halfPi$2=pi$1/2,tau$1=2*pi$1,pi2=2*Math.PI,abs$1=Math.abs,atan2$1=Math.atan2,cos$1=Math.cos,max$1=Math.max,min$1=Math.min,sin$1=Math.sin,sqrt$3=Math.sqrt,pow$1=Math.pow;function acos$1(r){return r>1?0:r<-1?pi$1:Math.acos(r)}function asin$1(r){return r>=1?halfPi$2:r<=-1?-halfPi$2:Math.asin(r)}function pointAt(r,e,i,n,o){let l=i,d=n;return typeof r=="number"&&typeof i=="number"&&(l=(1-o)*r+o*i),typeof e=="number"&&typeof n=="number"&&(d=(1-o)*e+o*n),{x:l,y:d}}function crossProduct(r,e){return r[0]*e[1]-r[1]*e[0]}function fuzzyEqualVec(r,e){return abs$1(r[0]-e[0])+abs$1(r[1]-e[1])<1e-12}function fixPrecision$1(r,e=10){return Math.round(r*e)/e}function getDecimalPlaces(r){const e=r.toString().split(/[eE]/),i=(e[0].split(".")[1]||"").length-(+e[1]||0);return i>0?i:0}function precisionAdd(r,e){return fixPrecision$1(r+e,10**Math.max(getDecimalPlaces(r),getDecimalPlaces(e)))}function precisionSub(r,e){return fixPrecision$1(r-e,10**Math.max(getDecimalPlaces(r),getDecimalPlaces(e)))}class Point{constructor(e=0,i=0,n,o){this.x=0,this.y=0,this.x=e,this.y=i,this.x1=n,this.y1=o}clone(){return new Point(this.x,this.y)}copyFrom(e){return this.x=e.x,this.y=e.y,this.x1=e.x1,this.y1=e.y1,this.defined=e.defined,this.context=e.context,this}set(e,i){return this.x=e,this.y=i,this}add(e){return isNumber(e)?(this.x+=e,void(this.y+=e)):(this.x+=e.x,this.y+=e.y,this)}sub(e){return isNumber(e)?(this.x-=e,void(this.y-=e)):(this.x-=e.x,this.y-=e.y,this)}multi(e){throw new Error("")}div(e){throw new Error("")}}class PointService{static distancePP(e,i){return sqrt$3(pow$1(e.x-i.x,2)+pow$1(e.y-i.y,2))}static distanceNN(e,i,n,o){return sqrt$3(pow$1(e-n,2)+pow$1(i-o,2))}static distancePN(e,i,n){return sqrt$3(pow$1(i-e.x,2)+pow$1(n-e.y,2))}static pointAtPP(e,i,n){return new Point((i.x-e.x)*n+e.x,(i.y-e.y)*n+e.y)}}function degreeToRadian(r){return r*(Math.PI/180)}function radianToDegree(r){return 180*r/Math.PI}const clampRadian=(r=0)=>{if(r<0)for(;r<-tau$1;)r+=tau$1;else if(r>0)for(;r>tau$1;)r-=tau$1;return r},clampAngleByRadian=clampRadian;function polarToCartesian(r,e,i){return e?{x:r.x+e*Math.cos(i),y:r.y+e*Math.sin(i)}:{x:r.x,y:r.y}}function cartesianToPolar(r,e={x:0,y:0},i=0,n=2*Math.PI){const{x:o,y:l}=r,{x:d,y:u}=e;let f=o-d,g=l-u;const _=Math.sqrt(f*f+g*g);if(_===0)return{radius:0,angle:0};f/=_,g/=_;let y=Math.atan2(g,f);if(y<i)for(;y<=i;)y+=2*Math.PI;if(y>n)for(;y>=n;)y-=2*Math.PI;return{radius:_,angle:y}}function getAngleByPoint(r,e){return Math.atan2(e.y-r.y,e.x-r.x)}function normalizeAngle(r){for(;r<0;)r+=2*Math.PI;for(;r>=2*Math.PI;)r-=2*Math.PI;return r}function findBoundaryAngles(r,e){const i=Math.abs(e-r);if(i>=2*Math.PI||2*Math.PI-i<1e-6)return[0,Math.PI/2,Math.PI,1.5*Math.PI];const n=normalizeAngle(Math.min(r,e)),o=n+i,l=[n,o];let d=Math.floor(n/Math.PI)*Math.PI/2;for(;d<o;)d>n&&l.push(d),d+=Math.PI/2;return l}function calculateMaxRadius(r,e,i,n){const{x:o,y:l}=e,d=findBoundaryAngles(i,n),{width:u,height:f}=r,g=[];return d.forEach(_=>{const y=Math.sin(_),b=Math.cos(_);y===1?g.push(f-l):y===-1?g.push(l):b===1?g.push(u-o):b===-1?g.push(o):(y>0?g.push(Math.abs((f-l)/y)):g.push(Math.abs(l/y)),b>0?g.push(Math.abs((u-o)/b)):g.push(Math.abs(o/b)))}),Math.min.apply(null,g)}function computeQuadrant(r){return(r=normalizeAngle(r))>0&&r<=Math.PI/2?2:r>Math.PI/2&&r<=Math.PI?3:r>Math.PI&&r<=3*Math.PI/2?4:1}function sub(r,e,i){r[0]=e[0]-i[0],r[1]=e[1]-i[1]}function isIntersect$1(r,e,i,n){let o=r[0],l=e[0],d=i[0],u=n[0];return l<o&&([o,l]=[l,o]),u<d&&([u,d]=[d,u]),!(l<d||u<o)&&(o=r[1],l=e[1],d=i[1],u=n[1],l<o&&([o,l]=[l,o]),u<d&&([u,d]=[d,u]),!(l<d||u<o))}function getIntersectPoint(r,e,i,n){if(!isIntersect$1(r,e,i,n))return!1;const o=[0,0],l=[0,0],d=[0,0];if(sub(o,e,r),sub(l,n,i),fuzzyEqualVec(o,l))return!0;sub(d,i,r);const u=crossProduct(d,l)/crossProduct(o,l);return u>=0&&u<=1&&[r[0]+o[0]*u,r[1]+o[1]*u]}function getRectIntersect(r,e,i){if(r===null)return e;if(e===null)return r;const{x11:n,x12:o,y11:l,y12:d,x21:u,x22:f,y21:g,y22:_}=formatTwoBBox(r,e,i);return n>=f||o<=u||l>=_||d<=g?{x1:0,y1:0,x2:0,y2:0}:{x1:Math.max(n,u),y1:Math.max(l,g),x2:Math.min(o,f),y2:Math.min(d,_)}}var InnerBBox;(function(r){r[r.NONE=0]="NONE",r[r.BBOX1=1]="BBOX1",r[r.BBOX2=2]="BBOX2"})(InnerBBox||(InnerBBox={}));const formatTwoBBox=(r,e,i)=>{let n=r.x1,o=r.x2,l=r.y1,d=r.y2,u=e.x1,f=e.x2,g=e.y1,_=e.y2;return i&&(n>o&&([n,o]=[o,n]),l>d&&([l,d]=[d,l]),u>f&&([u,f]=[f,u]),g>_&&([g,_]=[_,g])),{x11:n,x12:o,y11:l,y12:d,x21:u,x22:f,y21:g,y22:_}};function rectInsideAnotherRect(r,e,i){if(!r||!e)return InnerBBox.NONE;const{x11:n,x12:o,y11:l,y12:d,x21:u,x22:f,y21:g,y22:_}=formatTwoBBox(r,e,i);return n>u&&o<f&&l>g&&d<_?InnerBBox.BBOX1:u>n&&f<o&&g>l&&_<d?InnerBBox.BBOX2:InnerBBox.NONE}function isRectIntersect(r,e,i){if(r&&e){if(!i)return!(r.x1>e.x2||r.x2<e.x1||r.y1>e.y2||r.y2<e.y1);const{x11:n,x12:o,y11:l,y12:d,x21:u,x22:f,y21:g,y22:_}=formatTwoBBox(r,e,!0);return!(n>f||o<u||l>_||d<g)}return!0}function pointInRect(r,e,i){if(!e)return!0;if(!i)return r.x>=e.x1&&r.x<=e.x2&&r.y>=e.y1&&r.y<=e.y2;let n=e.x1,o=e.x2,l=e.y1,d=e.y2;return n>o&&([n,o]=[o,n]),l>d&&([l,d]=[d,l]),r.x>=n&&r.x<=o&&r.y>=l&&r.y<=d}function getProjectionRadius(r,e){return Math.abs(e[0]*r[0]+e[1]*r[1])}function rotatePoint({x:r,y:e},i,n={x:0,y:0}){return{x:(r-n.x)*Math.cos(i)-(e-n.y)*Math.sin(i)+n.x,y:(r-n.x)*Math.sin(i)+(e-n.y)*Math.cos(i)+n.y}}function getCenterPoint(r){return{x:(r.x1+r.x2)/2,y:(r.y1+r.y2)/2}}function toRect$1(r,e){const i=e?degreeToRadian(r.angle):r.angle,n=getCenterPoint(r);return[rotatePoint({x:r.x1,y:r.y1},i,n),rotatePoint({x:r.x2,y:r.y1},i,n),rotatePoint({x:r.x2,y:r.y2},i,n),rotatePoint({x:r.x1,y:r.y2},i,n)]}function isRotateAABBIntersect(r,e,i=!1){const n=toRect$1(r,i),o=toRect$1(e,i),l=(x,T)=>[T.x-x.x,T.y-x.y],d=l(getCenterPoint(r),getCenterPoint(e)),u=l(n[0],n[1]),f=l(n[1],n[2]),g=l(o[0],o[1]),_=l(o[1],o[2]),y=i?degreeToRadian(r.angle):r.angle;let b=i?degreeToRadian(90-r.angle):r.angle+halfPi$2;const S=i?degreeToRadian(e.angle):e.angle;let v=i?degreeToRadian(90-e.angle):e.angle+halfPi$2;b>pi2&&(b-=pi2),v>pi2&&(v-=pi2);const A=(x,T,C,E)=>{const P=[Math.cos(T),Math.sin(T)];return x+(getProjectionRadius(P,C)+getProjectionRadius(P,E))/2>getProjectionRadius(P,d)};return A((r.x2-r.x1)/2,y,g,_)&&A((r.y2-r.y1)/2,b,g,_)&&A((e.x2-e.x1)/2,S,u,f)&&A((e.y2-e.y1)/2,v,u,f)}let x1$1,y1$1,x2,y2;function getAABBFromPoints(r){return x1$1=1/0,y1$1=1/0,x2=-1/0,y2=-1/0,r.forEach(e=>{x1$1>e.x&&(x1$1=e.x),x2<e.x&&(x2=e.x),y1$1>e.y&&(y1$1=e.y),y2<e.y&&(y2=e.y)}),{x1:x1$1,y1:y1$1,x2,y2}}const EPSILON=1e-8;function lineIntersectPolygon(r,e,i,n,o){for(let l=0,d=o[o.length-1];l<o.length;l++){const u=o[l];if(isIntersect$1([r,e],[i,n],[u.x,u.y],[d.x,d.y]))return!0;d=u}return!1}function polygonContainPoint(r,e,i){let n=0,o=r[0];if(!o)return!1;for(let d=1;d<r.length;d++){const u=r[d];n+=isPointInLine(o.x,o.y,u.x,u.y,e,i),o=u}const l=r[0];return isAroundEqual(o.x,l.x)&&isAroundEqual(o.y,l.y)||(n+=isPointInLine(o.x,o.y,l.x,l.y,e,i)),n!==0}function isPointInLine(r,e,i,n,o,l){if(l>e&&l>n||l<e&&l<n||n===e)return 0;const d=(l-e)/(n-e);let u=n<e?1:-1;d!==1&&d!==0||(u=n<e?.5:-.5);const f=d*(i-r)+r;return f===o?1/0:f>o?u:0}function isAroundEqual(r,e){return Math.abs(r-e)<EPSILON}function polygonIntersectPolygon(r,e){for(let i=0;i<e.length;i++)if(polygonContainPoint(r,e[i].x,e[i].y)||i>0&&lineIntersectPolygon(e[i-1].x,e[i-1].y,e[i].x,e[i].y,r))return!0;return!1}const eastAsianCharacterInfo=r=>{let e=r.charCodeAt(0),i=r.length===2?r.charCodeAt(1):0,n=e;return 55296<=e&&e<=56319&&56320<=i&&i<=57343&&(e&=1023,i&=1023,n=e<<10|i,n+=65536),n===12288||65281<=n&&n<=65376||65504<=n&&n<=65510?"F":n===8361||65377<=n&&n<=65470||65474<=n&&n<=65479||65482<=n&&n<=65487||65490<=n&&n<=65495||65498<=n&&n<=65500||65512<=n&&n<=65518?"H":4352<=n&&n<=4447||4515<=n&&n<=4519||4602<=n&&n<=4607||9001<=n&&n<=9002||11904<=n&&n<=11929||11931<=n&&n<=12019||12032<=n&&n<=12245||12272<=n&&n<=12283||12289<=n&&n<=12350||12353<=n&&n<=12438||12441<=n&&n<=12543||12549<=n&&n<=12589||12593<=n&&n<=12686||12688<=n&&n<=12730||12736<=n&&n<=12771||12784<=n&&n<=12830||12832<=n&&n<=12871||12880<=n&&n<=13054||13056<=n&&n<=19903||19968<=n&&n<=42124||42128<=n&&n<=42182||43360<=n&&n<=43388||44032<=n&&n<=55203||55216<=n&&n<=55238||55243<=n&&n<=55291||63744<=n&&n<=64255||65040<=n&&n<=65049||65072<=n&&n<=65106||65108<=n&&n<=65126||65128<=n&&n<=65131||110592<=n&&n<=110593||127488<=n&&n<=127490||127504<=n&&n<=127546||127552<=n&&n<=127560||127568<=n&&n<=127569||131072<=n&&n<=194367||177984<=n&&n<=196605||196608<=n&&n<=262141?"W":32<=n&&n<=126||162<=n&&n<=163||165<=n&&n<=166||n===172||n===175||10214<=n&&n<=10221||10629<=n&&n<=10630?"Na":n===161||n===164||167<=n&&n<=168||n===170||173<=n&&n<=174||176<=n&&n<=180||182<=n&&n<=186||188<=n&&n<=191||n===198||n===208||215<=n&&n<=216||222<=n&&n<=225||n===230||232<=n&&n<=234||236<=n&&n<=237||n===240||242<=n&&n<=243||247<=n&&n<=250||n===252||n===254||n===257||n===273||n===275||n===283||294<=n&&n<=295||n===299||305<=n&&n<=307||n===312||319<=n&&n<=322||n===324||328<=n&&n<=331||n===333||338<=n&&n<=339||358<=n&&n<=359||n===363||n===462||n===464||n===466||n===468||n===470||n===472||n===474||n===476||n===593||n===609||n===708||n===711||713<=n&&n<=715||n===717||n===720||728<=n&&n<=731||n===733||n===735||768<=n&&n<=879||913<=n&&n<=929||931<=n&&n<=937||945<=n&&n<=961||963<=n&&n<=969||n===1025||1040<=n&&n<=1103||n===1105||n===8208||8211<=n&&n<=8214||8216<=n&&n<=8217||8220<=n&&n<=8221||8224<=n&&n<=8226||8228<=n&&n<=8231||n===8240||8242<=n&&n<=8243||n===8245||n===8251||n===8254||n===8308||n===8319||8321<=n&&n<=8324||n===8364||n===8451||n===8453||n===8457||n===8467||n===8470||8481<=n&&n<=8482||n===8486||n===8491||8531<=n&&n<=8532||8539<=n&&n<=8542||8544<=n&&n<=8555||8560<=n&&n<=8569||n===8585||8592<=n&&n<=8601||8632<=n&&n<=8633||n===8658||n===8660||n===8679||n===8704||8706<=n&&n<=8707||8711<=n&&n<=8712||n===8715||n===8719||n===8721||n===8725||n===8730||8733<=n&&n<=8736||n===8739||n===8741||8743<=n&&n<=8748||n===8750||8756<=n&&n<=8759||8764<=n&&n<=8765||n===8776||n===8780||n===8786||8800<=n&&n<=8801||8804<=n&&n<=8807||8810<=n&&n<=8811||8814<=n&&n<=8815||8834<=n&&n<=8835||8838<=n&&n<=8839||n===8853||n===8857||n===8869||n===8895||n===8978||9312<=n&&n<=9449||9451<=n&&n<=9547||9552<=n&&n<=9587||9600<=n&&n<=9615||9618<=n&&n<=9621||9632<=n&&n<=9633||9635<=n&&n<=9641||9650<=n&&n<=9651||9654<=n&&n<=9655||9660<=n&&n<=9661||9664<=n&&n<=9665||9670<=n&&n<=9672||n===9675||9678<=n&&n<=9681||9698<=n&&n<=9701||n===9711||9733<=n&&n<=9734||n===9737||9742<=n&&n<=9743||9748<=n&&n<=9749||n===9756||n===9758||n===9792||n===9794||9824<=n&&n<=9825||9827<=n&&n<=9829||9831<=n&&n<=9834||9836<=n&&n<=9837||n===9839||9886<=n&&n<=9887||9918<=n&&n<=9919||9924<=n&&n<=9933||9935<=n&&n<=9953||n===9955||9960<=n&&n<=9983||n===10045||n===10071||10102<=n&&n<=10111||11093<=n&&n<=11097||12872<=n&&n<=12879||57344<=n&&n<=63743||65024<=n&&n<=65039||n===65533||127232<=n&&n<=127242||127248<=n&&n<=127277||127280<=n&&n<=127337||127344<=n&&n<=127386||917760<=n&&n<=917999||983040<=n&&n<=1048573||1048576<=n&&n<=1114109?"A":"N"};function getContextFont(r,e={},i){i||(i=1);const{fontStyle:n=e.fontStyle,fontVariant:o=e.fontVariant,fontWeight:l=e.fontWeight,fontSize:d=e.fontSize,fontFamily:u=e.fontFamily}=r;return(n?n+" ":"")+(o?o+" ":"")+(l?l+" ":"")+d*i+"px "+(u||"sans-serif")}class TextMeasure{constructor(e,i){this._numberCharSize=null,this._fullCharSize=null,this._letterCharSize=null,this._specialCharSizeMap={},this._canvas=null,this._context=null,this._contextSaved=!1,this._notSupportCanvas=!1,this._notSupportVRender=!1,this._userSpec={},this.specialCharSet=`-/: .,@%'"~`,this._option=e,this._userSpec=i??{},this.textSpec=this._initSpec(),isValid(e.specialCharSet)&&(this.specialCharSet=e.specialCharSet),this._standardMethod=isValid(e.getTextBounds)?this.fullMeasure.bind(this):this.measureWithNaiveCanvas.bind(this)}initContext(){if(this._notSupportCanvas)return!1;if(isNil(this._canvas)&&(isValid(this._option.getCanvasForMeasure)&&(this._canvas=this._option.getCanvasForMeasure()),isNil(this._canvas)&&typeof window<"u"&&window.document!==void 0&&globalThis&&isValid(globalThis.document)&&(this._canvas=globalThis.document.createElement("canvas"))),isNil(this._context)&&isValid(this._canvas)){const e=this._canvas.getContext("2d");isValid(e)&&(e.save(),e.font=getContextFont(this.textSpec),this._contextSaved=!0,this._context=e)}return!isNil(this._context)||(this._notSupportCanvas=!0,!1)}_initSpec(){var e,i,n;const{defaultFontParams:o={}}=this._option,{fontStyle:l=o.fontStyle,fontVariant:d=o.fontVariant,fontWeight:u=(e=o.fontWeight)!==null&&e!==void 0?e:"normal",fontSize:f=(i=o.fontSize)!==null&&i!==void 0?i:12,fontFamily:g=(n=o.fontFamily)!==null&&n!==void 0?n:"sans-serif",align:_,textAlign:y=_??"center",baseline:b,textBaseline:S=b??"middle",ellipsis:v,limit:A}=this._userSpec;let{lineHeight:x=f}=this._userSpec;if(isString(x)&&x[x.length-1]==="%"){const T=Number.parseFloat(x.substring(0,x.length-1))/100;x=f*T}return{fontStyle:l,fontVariant:d,fontFamily:g,fontSize:f,fontWeight:u,textAlign:y,textBaseline:S,ellipsis:v,limit:A,lineHeight:x}}measure(e,i){switch(i){case"vrender":case"canopus":return this.fullMeasure(e);case"canvas":return this.measureWithNaiveCanvas(e);case"simple":return this.quickMeasureWithoutCanvas(e);default:return this.quickMeasure(e)}}fullMeasure(e){if(isNil(e))return{width:0,height:0};if(isNil(this._option.getTextBounds)||!this._notSupportVRender)return this.measureWithNaiveCanvas(e);const{fontFamily:i,fontSize:n,fontWeight:o,textAlign:l,textBaseline:d,ellipsis:u,limit:f,lineHeight:g}=this.textSpec;let _;try{const y=this._option.getTextBounds({text:e,fontFamily:i,fontSize:n,fontWeight:o,textAlign:l,textBaseline:d,ellipsis:!!u,maxLineWidth:f||1/0,lineHeight:g});_={width:y.width(),height:y.height()}}catch{this._notSupportVRender=!0,_=this.measureWithNaiveCanvas(e)}return _}measureWithNaiveCanvas(e){return this._measureReduce(e,this._measureWithNaiveCanvas.bind(this))}_measureWithNaiveCanvas(e){var i;if(!this.initContext())return this._quickMeasureWithoutCanvas(e);const n=this._context.measureText(e),{fontSize:o,lineHeight:l}=this.textSpec;return{width:n.width,height:(i=l)!==null&&i!==void 0?i:o,fontBoundingBoxAscent:n.fontBoundingBoxAscent,fontBoundingBoxDescent:n.fontBoundingBoxDescent}}quickMeasure(e){return this._measureReduce(e,this._quickMeasure.bind(this))}_quickMeasure(e){const i={width:0,height:0};for(let n=0;n<e.length;n++){const o=e[n];let l=this._measureSpecialChar(o);isNil(l)&&TextMeasure.NUMBERS_CHAR_SET.includes(o)&&(l=this._measureNumberChar()),isNil(l)&&["F","W"].includes(eastAsianCharacterInfo(o))&&(l=this._measureFullSizeChar()),isNil(l)&&(l=this._measureLetterChar()),i.width+=l.width,i.height=Math.max(i.height,l.height),!isNil(l.fontBoundingBoxAscent)&&(i.fontBoundingBoxAscent=l.fontBoundingBoxAscent),!isNil(l.fontBoundingBoxDescent)&&(i.fontBoundingBoxDescent=l.fontBoundingBoxDescent)}return i}quickMeasureWithoutCanvas(e){return this._measureReduce(e,this._quickMeasureWithoutCanvas.bind(this))}_quickMeasureWithoutCanvas(e){var i;const n={width:0,height:0},{fontSize:o,lineHeight:l}=this.textSpec;for(let d=0;d<e.length;d++){const u=e[d],f=["F","W"].includes(eastAsianCharacterInfo(u))?1:.53;n.width+=f*o}return n.height=(i=l)!==null&&i!==void 0?i:o,n}_measureReduce(e,i){var n;const{fontSize:o,lineHeight:l}=this.textSpec,d={width:0,height:0};if(isNil(e))return d;if(isArray(e)){const u=e.filter(isValid).map(f=>f.toString());return u.length===0?d:u.length===1?i(u[0]):{width:u.reduce((f,g)=>Math.max(f,i(g).width),0),height:u.length*(((n=l)!==null&&n!==void 0?n:o)+1)+1}}return i(e.toString())}_measureNumberChar(){if(isNil(this._numberCharSize)){const e=this._standardMethod(TextMeasure.NUMBERS_CHAR_SET);this._numberCharSize={width:e.width/TextMeasure.NUMBERS_CHAR_SET.length,height:e.height,fontBoundingBoxAscent:e.fontBoundingBoxAscent,fontBoundingBoxDescent:e.fontBoundingBoxDescent}}return this._numberCharSize}_measureFullSizeChar(){return isNil(this._fullCharSize)&&(this._fullCharSize=this._standardMethod(TextMeasure.FULL_SIZE_CHAR)),this._fullCharSize}_measureLetterChar(){if(isNil(this._letterCharSize)){const e=this._standardMethod(TextMeasure.ALPHABET_CHAR_SET);this._letterCharSize={width:e.width/TextMeasure.ALPHABET_CHAR_SET.length,height:e.height,fontBoundingBoxAscent:e.fontBoundingBoxAscent,fontBoundingBoxDescent:e.fontBoundingBoxDescent}}return this._letterCharSize}_measureSpecialChar(e){return isValid(this._specialCharSizeMap[e])?this._specialCharSizeMap[e]:this.specialCharSet.includes(e)?(this._specialCharSizeMap[e]=this._standardMethod(e),this._specialCharSizeMap[e]):null}release(){isValid(this._canvas)&&(this._canvas=null),isValid(this._context)&&(this._contextSaved&&(this._context.restore(),this._contextSaved=!1),this._context=null)}}TextMeasure.ALPHABET_CHAR_SET="abcdefghijklmnopqrstuvwxyz",TextMeasure.NUMBERS_CHAR_SET="0123456789",TextMeasure.FULL_SIZE_CHAR="";const calculateAnchorOfBounds=(r,e)=>{const{x1:i,x2:n,y1:o,y2:l}=r,d=Math.abs(n-i),u=Math.abs(l-o);let f=(i+n)/2,g=(o+l)/2,_=0,y=0;switch(e){case"top":case"inside-top":y=-.5;break;case"bottom":case"inside-bottom":y=.5;break;case"left":case"inside-left":_=-.5;break;case"right":case"inside-right":_=.5;break;case"top-right":_=.5,y=-.5;break;case"top-left":_=-.5,y=-.5;break;case"bottom-right":_=.5,y=.5;break;case"bottom-left":_=-.5,y=.5}return f+=_*d,g+=y*u,{x:f,y:g}};function transformBoundsWithMatrix(r,e,i){const{x1:n,y1:o,x2:l,y2:d}=e;return i.onlyTranslate()?(r!==e&&r.setValue(e.x1,e.y1,e.x2,e.y2),r.translate(i.e,i.f),e):(r.clear(),r.add(i.a*n+i.c*o+i.e,i.b*n+i.d*o+i.f),r.add(i.a*l+i.c*o+i.e,i.b*l+i.d*o+i.f),r.add(i.a*l+i.c*d+i.e,i.b*l+i.d*d+i.f),r.add(i.a*n+i.c*d+i.e,i.b*n+i.d*d+i.f),e)}class Bounds{constructor(e){e?this.setValue(e.x1,e.y1,e.x2,e.y2):this.clear()}clone(){return new Bounds(this)}clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this}empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE}equals(e){return this.x1===e.x1&&this.y1===e.y1&&this.x2===e.x2&&this.y2===e.y2}setValue(e=0,i=0,n=0,o=0){return this.x1=e,this.y1=i,this.x2=n,this.y2=o,this}set(e=0,i=0,n=0,o=0){return n<e?(this.x2=e,this.x1=n):(this.x1=e,this.x2=n),o<i?(this.y2=i,this.y1=o):(this.y1=i,this.y2=o),this}add(e=0,i=0){return e<this.x1&&(this.x1=e),i<this.y1&&(this.y1=i),e>this.x2&&(this.x2=e),i>this.y2&&(this.y2=i),this}expand(e=0){return isArray(e)?(this.y1-=e[0],this.x2+=e[1],this.y2+=e[2],this.x1-=e[3]):(this.x1-=e,this.y1-=e,this.x2+=e,this.y2+=e),this}round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this}translate(e=0,i=0){return this.x1+=e,this.x2+=e,this.y1+=i,this.y2+=i,this}rotate(e=0,i=0,n=0){const o=this.rotatedPoints(e,i,n);return this.clear().add(o[0],o[1]).add(o[2],o[3]).add(o[4],o[5]).add(o[6],o[7])}scale(e=0,i=0,n=0,o=0){const l=this.scalePoints(e,i,n,o);return this.clear().add(l[0],l[1]).add(l[2],l[3])}union(e){return e.x1<this.x1&&(this.x1=e.x1),e.y1<this.y1&&(this.y1=e.y1),e.x2>this.x2&&(this.x2=e.x2),e.y2>this.y2&&(this.y2=e.y2),this}intersect(e){return e.x1>this.x1&&(this.x1=e.x1),e.y1>this.y1&&(this.y1=e.y1),e.x2<this.x2&&(this.x2=e.x2),e.y2<this.y2&&(this.y2=e.y2),this}encloses(e){return e&&this.x1<=e.x1&&this.x2>=e.x2&&this.y1<=e.y1&&this.y2>=e.y2}alignsWith(e){return e&&(this.x1===e.x1||this.x2===e.x2||this.y1===e.y1||this.y2===e.y2)}intersects(e){return e&&!(this.x2<e.x1||this.x1>e.x2||this.y2<e.y1||this.y1>e.y2)}contains(e=0,i=0){return!(e<this.x1||e>this.x2||i<this.y1||i>this.y2)}containsPoint(e){return!(e.x<this.x1||e.x>this.x2||e.y<this.y1||e.y>this.y2)}width(){return this.empty()?0:this.x2-this.x1}height(){return this.empty()?0:this.y2-this.y1}scaleX(e=0){return this.x1*=e,this.x2*=e,this}scaleY(e=0){return this.y1*=e,this.y2*=e,this}transformWithMatrix(e){return transformBoundsWithMatrix(this,this,e),this}copy(e){return this.x1=e.x1,this.y1=e.y1,this.x2=e.x2,this.y2=e.y2,this}rotatedPoints(e,i,n){const{x1:o,y1:l,x2:d,y2:u}=this,f=Math.cos(e),g=Math.sin(e),_=i-i*f+n*g,y=n-i*g-n*f;return[f*o-g*l+_,g*o+f*l+y,f*o-g*u+_,g*o+f*u+y,f*d-g*l+_,g*d+f*l+y,f*d-g*u+_,g*d+f*u+y]}scalePoints(e,i,n,o){const{x1:l,y1:d,x2:u,y2:f}=this;return[e*l+(1-e)*n,i*d+(1-i)*o,e*u+(1-e)*n,i*f+(1-i)*o]}}class AABBBounds extends Bounds{}class OBBBounds extends Bounds{constructor(e,i=0){var n;super(e),e&&(this.angle=(n=e.angle)!==null&&n!==void 0?n:i)}intersects(e){return isRotateAABBIntersect(this,e)}setValue(e=0,i=0,n=0,o=0,l=0){return super.setValue(e,i,n,o),this.angle=l,this}clone(){return new OBBBounds(this)}}class Matrix{constructor(e=1,i=0,n=0,o=1,l=0,d=0){this.a=e,this.b=i,this.c=n,this.d=o,this.e=l,this.f=d}equalToMatrix(e){return!(this.e!==e.e||this.f!==e.f||this.a!==e.a||this.d!==e.d||this.b!==e.b||this.c!==e.c)}equalTo(e,i,n,o,l,d){return!(this.e!==l||this.f!==d||this.a!==e||this.d!==o||this.b!==i||this.c!==n)}setValue(e,i,n,o,l,d){return this.a=e,this.b=i,this.c=n,this.d=o,this.e=l,this.f=d,this}reset(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}getInverse(){const e=this.a,i=this.b,n=this.c,o=this.d,l=this.e,d=this.f,u=new Matrix,f=e*o-i*n;return u.a=o/f,u.b=-i/f,u.c=-n/f,u.d=e/f,u.e=(n*d-o*l)/f,u.f=-(e*d-i*l)/f,u}rotate(e){const i=Math.cos(e),n=Math.sin(e),o=this.a*i+this.c*n,l=this.b*i+this.d*n,d=this.a*-n+this.c*i,u=this.b*-n+this.d*i;return this.a=o,this.b=l,this.c=d,this.d=u,this}rotateByCenter(e,i,n){const o=Math.cos(e),l=Math.sin(e),d=(1-o)*i+l*n,u=(1-o)*n-l*i,f=o*this.a-l*this.b,g=l*this.a+o*this.b,_=o*this.c-l*this.d,y=l*this.c+o*this.d,b=o*this.e-l*this.f+d,S=l*this.e+o*this.f+u;return this.a=f,this.b=g,this.c=_,this.d=y,this.e=b,this.f=S,this}scale(e,i){return this.a*=e,this.b*=e,this.c*=i,this.d*=i,this}setScale(e,i){return this.b=this.b/this.a*e,this.c=this.c/this.d*i,this.a=e,this.d=i,this}transform(e,i,n,o,l,d){return this.multiply(e,i,n,o,l,d),this}translate(e,i){return this.e+=this.a*e+this.c*i,this.f+=this.b*e+this.d*i,this}transpose(){const{a:e,b:i,c:n,d:o,e:l,f:d}=this;return this.a=i,this.b=e,this.c=o,this.d=n,this.e=d,this.f=l,this}multiply(e,i,n,o,l,d){const u=this.a,f=this.b,g=this.c,_=this.d,y=u*e+g*i,b=f*e+_*i,S=u*n+g*o,v=f*n+_*o,A=u*l+g*d+this.e,x=f*l+_*d+this.f;return this.a=y,this.b=b,this.c=S,this.d=v,this.e=A,this.f=x,this}interpolate(e,i){const n=new Matrix;return n.a=this.a+(e.a-this.a)*i,n.b=this.b+(e.b-this.b)*i,n.c=this.c+(e.c-this.c)*i,n.d=this.d+(e.d-this.d)*i,n.e=this.e+(e.e-this.e)*i,n.f=this.f+(e.f-this.f)*i,n}transformPoint(e,i){const{a:n,b:o,c:l,d,e:u,f}=this,g=n*d-o*l,_=d/g,y=-o/g,b=-l/g,S=n/g,v=(l*f-d*u)/g,A=-(n*f-o*u)/g,{x,y:T}=e;i.x=x*_+T*b+v,i.y=x*y+T*S+A}onlyTranslate(e=1){return this.a===e&&this.b===0&&this.c===0&&this.d===e}clone(){return new Matrix(this.a,this.b,this.c,this.d,this.e,this.f)}toTransformAttrs(){const e=this.a,i=this.b,n=this.c,o=this.d,l=e*o-i*n,d={x:this.e,y:this.f,rotateDeg:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(e!==0||i!==0){const u=Math.sqrt(e*e+i*i);d.rotateDeg=i>0?Math.acos(e/u):-Math.acos(e/u),d.scaleX=u,d.scaleY=l/u,d.skewX=(e*n+i*o)/l,d.skewY=0}else if(n!==0||o!==0){const u=Math.sqrt(n*n+o*o);d.rotateDeg=Math.PI/2-(o>0?Math.acos(-n/u):-Math.acos(n/u)),d.scaleX=l/u,d.scaleY=u,d.skewX=0,d.skewY=(e*n+i*o)/l}return d.rotateDeg=radianToDegree(d.rotateDeg),d}}function normalTransform(r,e,i,n,o,l,d,u){const f=e.a,g=e.b,_=e.c,y=e.d,b=e.e,S=e.f,v=cos$1(d),A=sin$1(d);let x,T;u?(x=u[0],T=u[1]):(x=i,T=n);const C=x-i,E=T-n,P=f*v+_*A,R=g*v+y*A,L=_*v-f*A,w=y*v-g*A;r.a=o*P,r.b=o*R,r.c=l*L,r.d=l*w,r.e=b+f*x+_*T-P*C-L*E,r.f=S+g*x+y*T-R*C-w*E}class LRU{constructor(){this.CLEAN_THRESHOLD=1e3,this.L_TIME=1e3,this.R_COUNT=1,this.R_TIMESTAMP_MAX_SIZE=20}clearCache(e,i){const{CLEAN_THRESHOLD:n=this.CLEAN_THRESHOLD,L_TIME:o=this.L_TIME,R_COUNT:l=this.R_COUNT}=i;if(e.size<n)return 0;let d=0;const u=g=>{d++,e.delete(g)},f=Date.now();return e.forEach((g,_)=>{if(g.timestamp.length<l)return u(_);let y=0;for(;f-g.timestamp[g.timestamp.length-1-y]<o&&(y++,!(y>=l)););if(y<l)return u(_);for(;f-g.timestamp[0]>o;)g.timestamp.shift()}),d}addLimitedTimestamp(e,i,n){const{R_TIMESTAMP_MAX_SIZE:o=this.R_TIMESTAMP_MAX_SIZE}=n;e.timestamp.length>o&&e.timestamp.shift(),e.timestamp.push(i)}clearTimeStamp(e,i){const{L_TIME:n=this.L_TIME}=i,o=Date.now();e.forEach(l=>{for(;o-l.timestamp[0]>n;)l.timestamp.shift()})}clearItemTimestamp(e,i){const{L_TIME:n=this.L_TIME}=i,o=Date.now();for(;o-e.timestamp[0]>n;)e.timestamp.shift()}}function hslToRgb(r,e,i){e/=100,i/=100;const n=(1-Math.abs(2*i-1))*e,o=n*(1-Math.abs(r/60%2-1)),l=i-n/2;let d=0,u=0,f=0;return 0<=r&&r<60?(d=n,u=o,f=0):60<=r&&r<120?(d=o,u=n,f=0):120<=r&&r<180?(d=0,u=n,f=o):180<=r&&r<240?(d=0,u=o,f=n):240<=r&&r<300?(d=o,u=0,f=n):300<=r&&r<360&&(d=n,u=0,f=o),d=Math.round(255*(d+l)),u=Math.round(255*(u+l)),f=Math.round(255*(f+l)),{r:d,g:u,b:f}}function rgbToHsl(r,e,i){r/=255,e/=255,i/=255;const n=Math.min(r,e,i),o=Math.max(r,e,i),l=o-n;let d=0,u=0,f=0;return d=l===0?0:o===r?(e-i)/l%6:o===e?(i-r)/l+2:(r-e)/l+4,d=Math.round(60*d),d<0&&(d+=360),f=(o+n)/2,u=l===0?0:l/(1-Math.abs(2*f-1)),u=+(100*u).toFixed(1),f=+(100*f).toFixed(1),{h:d,s:u,l:f}}const REG_HEX=/^#([0-9a-f]{3,8})$/,DEFAULT_COLORS_OPACITY={transparent:4294967040},DEFAULT_COLORS={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function hex(r){return((r=Math.max(0,Math.min(255,Math.round(r)||0)))<16?"0":"")+r.toString(16)}function rgb(r){return isNumber(r)?new RGB(r>>16,r>>8&255,255&r,1):isArray(r)?new RGB(r[0],r[1],r[2]):new RGB(255,255,255)}function rgba(r){return isNumber(r)?new RGB(r>>>24,r>>>16&255,r>>>8&255,255&r):isArray(r)?new RGB(r[0],r[1],r[2],r[3]):new RGB(255,255,255,1)}function SRGBToLinear(r){return r<.04045?.0773993808*r:Math.pow(.9478672986*r+.0521327014,2.4)}function LinearToSRGB(r){return r<.0031308?12.92*r:1.055*Math.pow(r,.41666)-.055}const setHex=(r,e)=>{const i=REG_HEX.exec(r);if(e||i){const n=parseInt(i[1],16),o=i[1].length;return o===3?new RGB((n>>8&15)+((n>>8&15)<<4),(n>>4&15)+((n>>4&15)<<4),(15&n)+((15&n)<<4),1):o===6?rgb(n):o===8?new RGB(n>>24&255,n>>16&255,n>>8&255,(255&n)/255):null}};class Color{static Brighter(e,i=1){return i===1?e:new Color(e).brighter(i).toRGBA()}static SetOpacity(e,i=1){return i===1?e:new Color(e).setOpacity(i).toRGBA()}static getColorBrightness(e,i="hsl"){const n=e instanceof Color?e:new Color(e);switch(i){case"hsv":default:return n.getHSVBrightness();case"hsl":return n.getHSLBrightness();case"lum":return n.getLuminance();case"lum2":return n.getLuminance2();case"lum3":return n.getLuminance3();case"wcag":return n.getLuminanceWCAG()}}static parseColorString(e){if(isValid(DEFAULT_COLORS_OPACITY[e]))return rgba(DEFAULT_COLORS_OPACITY[e]);if(isValid(DEFAULT_COLORS[e]))return rgb(DEFAULT_COLORS[e]);const i=`${e}`.trim().toLowerCase(),n=setHex(i);if(n!==void 0)return n;if(/^(rgb|RGB|rgba|RGBA)/.test(i)){const o=i.replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(",");return new RGB(parseInt(o[0],10),parseInt(o[1],10),parseInt(o[2],10),parseFloat(o[3]))}if(/^(hsl|HSL|hsla|HSLA)/.test(i)){const o=i.replace(/(?:\(|\)|hsla|HSLA|hsl|HSL)*/g,"").split(","),l=hslToRgb(parseInt(o[0],10),parseInt(o[1],10),parseInt(o[2],10));return new RGB(l.r,l.g,l.b,parseFloat(o[3]))}}constructor(e){const i=Color.parseColorString(e);i?this.color=i:(console.warn(`Warn: ${e}Color`),this.color=new RGB(255,255,255))}toRGBA(){return this.color.formatRgb()}toString(){return this.color.formatRgb()}toHex(){return this.color.formatHex()}toHsl(){return this.color.formatHsl()}brighter(e){const{r:i,g:n,b:o}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(i*e))),this.color.g=Math.max(0,Math.min(255,Math.floor(n*e))),this.color.b=Math.max(0,Math.min(255,Math.floor(o*e))),this}add(e){const{r:i,g:n,b:o}=this.color;return this.color.r+=Math.min(255,i+e.color.r),this.color.g+=Math.min(255,n+e.color.g),this.color.b+=Math.min(255,o+e.color.b),this}sub(e){return this.color.r=Math.max(0,this.color.r-e.color.r),this.color.g=Math.max(0,this.color.g-e.color.g),this.color.b=Math.max(0,this.color.b-e.color.b),this}multiply(e){const{r:i,g:n,b:o}=this.color;return this.color.r=Math.max(0,Math.min(255,Math.floor(i*e.color.r))),this.color.g=Math.max(0,Math.min(255,Math.floor(n*e.color.g))),this.color.b=Math.max(0,Math.min(255,Math.floor(o*e.color.b))),this}getHSVBrightness(){return Math.max(this.color.r,this.color.g,this.color.b)/255}getHSLBrightness(){return .5*(Math.max(this.color.r,this.color.g,this.color.b)/255+Math.min(this.color.r,this.color.g,this.color.b)/255)}setHsl(e,i,n){const o=this.color.opacity,l=rgbToHsl(this.color.r,this.color.g,this.color.b),d=hslToRgb(isNil(e)?l.h:clamp(e,0,360),isNil(i)?l.s:i>=0&&i<=1?100*i:i,isNil(n)?l.l:n<=1&&n>=0?100*n:n);return this.color=new RGB(d.r,d.g,d.b,o),this}setRGB(e,i,n){return!isNil(e)&&(this.color.r=e),!isNil(i)&&(this.color.g=i),!isNil(n)&&(this.color.b=n),this}setHex(e){const i=`${e}`.trim().toLowerCase(),n=setHex(i,!0);return n??this}setColorName(e){const i=DEFAULT_COLORS[e.toLowerCase()];return i!==void 0?this.setHex(i):console.warn("THREE.Color: Unknown color "+e),this}setScalar(e){return this.color.r=e,this.color.g=e,this.color.b=e,this}setOpacity(e=1){return this.color.opacity=e,this}getLuminance(){return(.2126*this.color.r+.7152*this.color.g+.0722*this.color.b)/255}getLuminance2(){return(.2627*this.color.r+.678*this.color.g+.0593*this.color.b)/255}getLuminance3(){return(.299*this.color.r+.587*this.color.g+.114*this.color.b)/255}getLuminanceWCAG(){const e=this.color.r/255,i=this.color.g/255,n=this.color.b/255;let o,l,d;return o=e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4),l=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4),d=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4),.2126*o+.7152*l+.0722*d}clone(){return new Color(this.color.toString())}copyGammaToLinear(e,i=2){return this.color.r=Math.pow(e.color.r,i),this.color.g=Math.pow(e.color.g,i),this.color.b=Math.pow(e.color.b,i),this}copyLinearToGamma(e,i=2){const n=i>0?1/i:1;return this.color.r=Math.pow(e.color.r,n),this.color.g=Math.pow(e.color.g,n),this.color.b=Math.pow(e.color.b,n),this}convertGammaToLinear(e){return this.copyGammaToLinear(this,e),this}convertLinearToGamma(e){return this.copyLinearToGamma(this,e),this}copySRGBToLinear(e){return this.color.r=SRGBToLinear(e.color.r),this.color.g=SRGBToLinear(e.color.g),this.color.b=SRGBToLinear(e.color.b),this}copyLinearToSRGB(e){return this.color.r=LinearToSRGB(e.color.r),this.color.g=LinearToSRGB(e.color.g),this.color.b=LinearToSRGB(e.color.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}}class RGB{constructor(e,i,n,o){this.r=isNaN(+e)?255:Math.max(0,Math.min(255,+e)),this.g=isNaN(+i)?255:Math.max(0,Math.min(255,+i)),this.b=isNaN(+n)?255:Math.max(0,Math.min(255,+n)),isValid(o)?this.opacity=isNaN(+o)?1:Math.max(0,Math.min(1,+o)):this.opacity=1}formatHex(){return`#${hex(this.r)+hex(this.g)+hex(this.b)+(this.opacity===1?"":hex(255*this.opacity))}`}formatRgb(){const e=this.opacity;return`${e===1?"rgb(":"rgba("}${this.r},${this.g},${this.b}${e===1?")":`,${e})`}`}formatHsl(){const e=this.opacity,{h:i,s:n,l:o}=rgbToHsl(this.r,this.g,this.b);return`${e===1?"hsl(":"hsla("}${i},${n}%,${o}%${e===1?")":`,${e})`}`}toString(){return this.formatHex()}}function hexToRgb(r){let e="",i="",n="";const o=r[0]==="#"?1:0;for(let l=o;l<r.length;l++)r[l]!=="#"&&(l<o+2?e+=r[l]:l<o+4?i+=r[l]:l<o+6&&(n+=r[l]));return[parseInt(e,16),parseInt(i,16),parseInt(n,16)]}function rgbToHex(r,e,i){return Number((1<<24)+(r<<16)+(e<<8)+i).toString(16).slice(1)}function interpolateRgb$1(r,e){const i=r.r,n=e.r,o=r.g,l=e.g,d=r.b,u=e.b,f=r.opacity,g=e.opacity;return _=>{const y=Math.round(i*(1-_)+n*_),b=Math.round(o*(1-_)+l*_),S=Math.round(d*(1-_)+u*_);return new RGB(y,b,S,f*(1-_)+g*_)}}const ColorUtil=Object.freeze(Object.defineProperty({__proto__:null,Color,DEFAULT_COLORS,RGB,hexToRgb,hslToRgb,interpolateRgb:interpolateRgb$1,rgbToHex,rgbToHsl},Symbol.toStringTag,{value:"Module"}));function normalizePadding$1(r){if(isValidNumber(r))return[r,r,r,r];if(isArray(r)){const e=r.length;if(e===1){const i=r[0];return[i,i,i,i]}if(e===2){const[i,n]=r;return[i,n,i,n]}if(e===3){const[i,n,o]=r;return[i,n,o,n]}if(e===4)return r}if(isObject$1(r)){const{top:e=0,right:i=0,bottom:n=0,left:o=0}=r;return[e,i,n,o]}return[0,0,0,0]}function getContainerSize(r,e=0,i=0){if(!r)return{width:e,height:i};let n;try{n=window==null?void 0:window.getComputedStyle}catch{n=()=>({})}const o=n(r);if(/^(\d*\.?\d+)(px)$/.exec(o.width)){const l=parseFloat(o.width)-parseFloat(o.paddingLeft)-parseFloat(o.paddingRight)||r.clientWidth-1,d=parseFloat(o.height)-parseFloat(o.paddingTop)-parseFloat(o.paddingBottom)||r.clientHeight-1;return{width:l<=0?e:l,height:d<=0?i:d}}return{width:e,height:i}}function getElementAbsolutePosition(r){const{x:e,y:i}=r.getBoundingClientRect();return{x:e,y:i}}const styleStringToObject=(r="")=>{const e={};return r.split(";").forEach(i=>{if(i){const n=i.split(":");if(n.length===2){const o=n[0].trim(),l=n[1].trim();o&&l&&(e[o]=l)}}}),e},lowerCamelCaseToMiddle=r=>r.replace(/([A-Z])/g,"-$1").toLowerCase();var earthRadius=63710088e-1,factors={centimeters:earthRadius*100,centimetres:earthRadius*100,degrees:earthRadius/111325,feet:earthRadius*3.28084,inches:earthRadius*39.37,kilometers:earthRadius/1e3,kilometres:earthRadius/1e3,meters:earthRadius,metres:earthRadius,miles:earthRadius/1609.344,millimeters:earthRadius*1e3,millimetres:earthRadius*1e3,nauticalmiles:earthRadius/1852,radians:1,yards:earthRadius*1.0936};function feature$2(r,e,i){i===void 0&&(i={});var n={type:"Feature"};return(i.id===0||i.id)&&(n.id=i.id),i.bbox&&(n.bbox=i.bbox),n.properties=e||{},n.geometry=r,n}function featureCollection(r,e){e===void 0&&(e={});var i={type:"FeatureCollection"};return e.id&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.features=r,i}function lengthToRadians(r,e){e===void 0&&(e="kilometers");var i=factors[e];if(!i)throw new Error(e+" units is invalid");return r/i}function isObject(r){return!!r&&r.constructor===Object}function getGeom(r){return r.type==="Feature"?r.geometry:r}function isPointInPolygon(r,e){if(!r||!e)return!1;const i=getGeom(e),n=i.type,o=e.bbox;let l=i.coordinates;if(o&&pointInRect(r,{x1:o[0],x2:o[1],y1:o[1],y2:o[3]},!0)===!0)return!1;n==="Polygon"&&(l=[l]);let d=!1;for(let u=0;u<l.length;++u)for(let f=0;f<l[u].length;++f)if(polygonContainPoint(l[u][f].map(g=>({x:g[0],y:g[1]})),r.x,r.y))return d=!0,d;return d}function destination(r,e,i,n={}){const o=degreeToRadian(r[0]),l=degreeToRadian(r[1]),d=degreeToRadian(i),u=lengthToRadians(e,n.units),f=Math.asin(Math.sin(l)*Math.cos(u)+Math.cos(l)*Math.sin(u)*Math.cos(d)),g=o+Math.atan2(Math.sin(d)*Math.sin(u)*Math.cos(l),Math.cos(u)-Math.sin(l)*Math.sin(f));return{x:radianToDegree(g),y:radianToDegree(f)}}class TimeUtil{static getInstance(){return TimeUtil.instance||(TimeUtil.instance=new TimeUtil),TimeUtil.instance}constructor(){this.locale_shortWeekdays=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],this.locale_periods=["AM","PM"],this.locale_weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],this.locale_shortMonths=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],this.numberRe=/^\s*\d+/,this.pads={"-":"",_:" ",0:"0"},this.requoteRe=/[\\^$*+?|[\]().{}]/g,this.locale_months=["January","February","March","April","May","June","July","August","September","October","November","December"],this.formatShortWeekday=e=>this.locale_shortWeekdays[e.getDay()],this.formatWeekday=e=>this.locale_weekdays[e.getDay()],this.formatShortMonth=e=>this.locale_shortMonths[e.getMonth()],this.formatMonth=e=>this.locale_months[e.getMonth()],this.formatDayOfMonth=(e,i)=>this.pad(e.getDate(),i,2),this.formatHour24=(e,i)=>this.pad(e.getHours(),i,2),this.formatHour12=(e,i)=>this.pad(e.getHours()%12||12,i,2),this.formatMilliseconds=(e,i)=>this.pad(e.getMilliseconds(),i,3),this.formatMonthNumber=(e,i)=>this.pad(e.getMonth()+1,i,2),this.formatMinutes=(e,i)=>this.pad(e.getMinutes(),i,2),this.formatPeriod=e=>this.locale_periods[+(e.getHours()>=12)],this.formatSeconds=(e,i)=>this.pad(e.getSeconds(),i,2),this.formatFullYear=(e,i)=>this.pad(e.getFullYear()%1e4,i,4),this.formatUTCShortWeekday=e=>this.locale_shortWeekdays[e.getUTCDay()],this.formatUTCWeekday=e=>this.locale_weekdays[e.getUTCDay()],this.formatUTCShortMonth=e=>this.locale_shortMonths[e.getUTCMonth()],this.formatUTCMonth=e=>this.locale_months[e.getUTCMonth()],this.formatUTCDayOfMonth=(e,i)=>this.pad(e.getUTCDate(),i,2),this.formatUTCHour24=(e,i)=>this.pad(e.getUTCHours(),i,2),this.formatUTCHour12=(e,i)=>this.pad(e.getUTCHours()%12||12,i,2),this.formatUTCMilliseconds=(e,i)=>this.pad(e.getUTCMilliseconds(),i,3),this.formatUTCMonthNumber=(e,i)=>this.pad(e.getUTCMonth()+1,i,2),this.formatUTCMinutes=(e,i)=>this.pad(e.getUTCMinutes(),i,2),this.formatUTCPeriod=e=>this.locale_periods[+(e.getUTCHours()>=12)],this.formatUTCSeconds=(e,i)=>this.pad(e.getUTCSeconds(),i,2),this.formatUTCFullYear=(e,i)=>this.pad(e.getUTCFullYear()%1e4,i,4),this.formats={a:this.formatShortWeekday,A:this.formatWeekday,b:this.formatShortMonth,B:this.formatMonth,d:this.formatDayOfMonth,e:this.formatDayOfMonth,H:this.formatHour24,I:this.formatHour12,L:this.formatMilliseconds,m:this.formatMonthNumber,M:this.formatMinutes,p:this.formatPeriod,S:this.formatSeconds,Y:this.formatFullYear},this.utcFormats={a:this.formatUTCShortWeekday,A:this.formatUTCWeekday,b:this.formatUTCShortMonth,B:this.formatUTCMonth,d:this.formatUTCDayOfMonth,e:this.formatUTCDayOfMonth,H:this.formatUTCHour24,I:this.formatUTCHour12,L:this.formatUTCMilliseconds,m:this.formatUTCMonthNumber,M:this.formatUTCMinutes,p:this.formatUTCPeriod,S:this.formatUTCSeconds,Y:this.formatUTCFullYear},this.parseShortWeekday=(e,i,n)=>{const o=this.shortWeekdayRe.exec(i.slice(n));return o?(e.w=this.shortWeekdayLookup.get(o[0].toLowerCase()),n+o[0].length):-1},this.parseWeekday=(e,i,n)=>{const o=this.weekdayRe.exec(i.slice(n));return o?(e.w=this.weekdayLookup.get(o[0].toLowerCase()),n+o[0].length):-1},this.parseShortMonth=(e,i,n)=>{const o=this.shortMonthRe.exec(i.slice(n));return o?(e.m=this.shortMonthLookup.get(o[0].toLowerCase()),n+o[0].length):-1},this.parseMonth=(e,i,n)=>{const o=this.monthRe.exec(i.slice(n));return o?(e.m=this.monthLookup.get(o[0].toLowerCase()),n+o[0].length):-1},this.parseDayOfMonth=(e,i,n)=>{const o=this.numberRe.exec(i.slice(n,n+2));return o?(e.d=+o[0],n+o[0].length):-1},this.parseHour24=(e,i,n)=>{const o=this.numberRe.exec(i.slice(n,n+2));return o?(e.H=+o[0],n+o[0].length):-1},this.parseMilliseconds=(e,i,n)=>{const o=this.numberRe.exec(i.slice(n,n+3));return o?(e.L=+o[0],n+o[0].length):-1},this.parseMonthNumber=(e,i,n)=>{const o=this.numberRe.exec(i.slice(n,n+2));return o?(e.m=o-1,n+o[0].length):-1},this.parseMinutes=(e,i,n)=>{const o=this.numberRe.exec(i.slice(n,n+2));return o?(e.M=+o[0],n+o[0].length):-1},this.parsePeriod=(e,i,n)=>{const o=this.periodRe.exec(i.slice(n));return o?(e.p=this.periodLookup.get(o[0].toLowerCase()),n+o[0].length):-1},this.parseSeconds=(e,i,n)=>{const o=this.numberRe.exec(i.slice(n,n+2));return o?(e.S=+o[0],n+o[0].length):-1},this.parseFullYear=(e,i,n)=>{const o=this.numberRe.exec(i.slice(n,n+4));return o?(e.y=+o[0],n+o[0].length):-1},this.parses={a:this.parseShortWeekday,A:this.parseWeekday,b:this.parseShortMonth,B:this.parseMonth,d:this.parseDayOfMonth,e:this.parseDayOfMonth,H:this.parseHour24,I:this.parseHour24,L:this.parseMilliseconds,m:this.parseMonthNumber,M:this.parseMinutes,p:this.parsePeriod,S:this.parseSeconds,Y:this.parseFullYear},this.timeFormat=(e,i)=>this.newFormat(e,this.formats)(new Date(this.getFullTimeStamp(i))),this.timeUTCFormat=(e,i)=>this.newFormat(e,this.utcFormats)(new Date(this.getFullTimeStamp(i))),this.timeParse=(e,i)=>this.newParse(e,!1)(i+""),this.requoteF=this.requote.bind(this),this.periodRe=this.formatRe(this.locale_periods),this.periodLookup=this.formatLookup(this.locale_periods),this.weekdayRe=this.formatRe(this.locale_weekdays),this.weekdayLookup=this.formatLookup(this.locale_weekdays),this.shortWeekdayRe=this.formatRe(this.locale_shortWeekdays),this.shortWeekdayLookup=this.formatLookup(this.locale_shortWeekdays),this.monthRe=this.formatRe(this.locale_months),this.monthLookup=this.formatLookup(this.locale_months),this.shortMonthRe=this.formatRe(this.locale_shortMonths),this.shortMonthLookup=this.formatLookup(this.locale_shortMonths)}requote(e){return e.replace(this.requoteRe,"\\$&")}localDate(e){if(0<=e.y&&e.y<100){const i=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return i.setFullYear(e.y),i}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}utcDate(e){if(0<=e.y&&e.y<100){const i=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return i.setUTCFullYear(e.y),i}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}newDate(e,i,n){return{y:e,m:i,d:n,H:0,M:0,S:0,L:0}}formatRe(e){return new RegExp("^(?:"+e.map(this.requoteF).join("|")+")","i")}formatLookup(e){return new Map(e.map((i,n)=>[i.toLowerCase(),n]))}pad(e,i,n){const o=e<0?"-":"",l=(o?-e:e)+"",d=l.length;return o+(d<n?new Array(n-d+1).join(i)+l:l)}parseSpecifier(e,i,n,o){let l=0;const d=i.length,u=n.length;let f,g;for(;l<d;){if(o>=u)return-1;if(f=i.charCodeAt(l++),f===37){if(f=i.charAt(l++),g=this.parses[f in this.pads?i.charAt(l++):f],!g||(o=g(e,n,o))<0)return-1}else if(f!==n.charCodeAt(o++))return-1}return o}newParse(e,i){const n=this;return function(o){const l=n.newDate(1900,void 0,1);return n.parseSpecifier(l,e,o+="",0)!==o.length?null:"Q"in l?new Date(l.Q):"s"in l?new Date(1e3*l.s+("L"in l?l.L:0)):(i&&!("Z"in l)&&(l.Z=0),"p"in l&&(l.H=l.H%12+12*l.p),l.m===void 0&&(l.m="q"in l?l.q:0),"Z"in l?(l.H+=l.Z/100|0,l.M+=l.Z%100,n.utcDate(l)):n.localDate(l))}}newFormat(e,i){const n=this;return function(o){const l=[];let d=-1,u=0;const f=e.length;let g,_,y;for(o instanceof Date||(o=new Date(+o));++d<f;)e.charCodeAt(d)===37&&(l.push(e.slice(u,d)),(_=n.pads[g=e.charAt(++d)])?g=e.charAt(++d):_=g==="e"?" ":"0",y=i[g],g=y(o,_),l.push(g),u=d+1);return l.push(e.slice(u,d)),l.join("")}}getFullTimeStamp(e){const i=parseInt(e+"",10);return String(i).length===10?1e3*i:i}}function formatDecimal(r){return Math.abs(r=Math.round(r))>=1e21?r.toLocaleString("en").replace(/,/g,""):r.toString(10)}function formatDecimalParts(r,e){const i=e?r.toExponential(e-1):r.toExponential(),n=i.indexOf("e");if(n<0)return null;const o=i.slice(0,n);return[o.length>1?o[0]+o.slice(2):o,+i.slice(n+1)]}function formatGroup(r,e){return function(i,n){let o=i.length;const l=[];let d=0,u=r[0],f=0;for(;o>0&&u>0&&(f+u+1>n&&(u=Math.max(1,n-f)),l.push(i.substring(o-=u,o+u)),!((f+=u+1)>n));)u=r[d=(d+1)%r.length];return l.reverse().join(e)}}let prefixExponent;function formatPrefixAuto(r,e){const i=formatDecimalParts(r,e);if(!i)return r+"";const n=i[0],o=i[1],l=o-(prefixExponent=3*Math.max(-8,Math.min(8,Math.floor(o/3))))+1,d=n.length;return l===d?n:l>d?n+new Array(l-d+1).join("0"):l>0?n.slice(0,l)+"."+n.slice(l):"0."+new Array(1-l).join("0")+formatDecimalParts(r,Math.max(0,e+l-1))[0]}function formatRounded(r,e){const i=formatDecimalParts(r,e);if(!i)return r+"";const n=i[0],o=i[1];return o<0?"0."+new Array(-o).join("0")+n:n.length>o+1?n.slice(0,o+1)+"."+n.slice(o+1):n+new Array(o-n.length+2).join("0")}function formatTrim(r){const e=r.length;let i,n=-1;e:for(let o=1;o<e;++o)switch(r[o]){case".":n=i=o;break;case"0":n===0&&(n=o),i=o;break;default:if(!+r[o])break e;n>0&&(n=0)}return n>0?r.slice(0,n)+r.slice(i+1):r}class FormatSpecifier{constructor(e={}){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}toString(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,0|this.width))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type}}const numberSpecifierReg=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function formatSpecifier(r){let e;if(e=numberSpecifierReg.exec(r))return new FormatSpecifier({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]});Logger.getInstance().error("invalid format: "+r)}const prefixes=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];class NumberUtil{constructor(){this.locale={thousands:",",grouping:[3],currency:["$",""]},this.group=this.locale.grouping===void 0||this.locale.thousands===void 0?e=>e:formatGroup([...this.locale.grouping].map(Number),`${this.locale.thousands}`),this.currencyPrefix=this.locale.currency===void 0?"":this.locale.currency[0]+"",this.currencySuffix=this.locale.currency===void 0?"":this.locale.currency[1]+"",this.decimal=this.locale.decimal===void 0?".":this.locale.decimal+"",this.numerals=this.locale.numerals===void 0?e=>e:formatNumerals([...this.locale.numerals].map(String)),this.percent=this.locale.percent===void 0?"%":this.locale.percent+"",this.minus=this.locale.minus===void 0?"":this.locale.minus+"",this.nan=this.locale.nan===void 0?"NaN":this.locale.nan+"",this.formatter=e=>this.newFormat(e),this.format=(e,i)=>this.formatter(e)(i),this.formatPrefix=(e,i)=>this._formatPrefix(e,i)}static getInstance(){return NumberUtil.instance||(NumberUtil.instance=new NumberUtil),NumberUtil.instance}newFormat(e){const i=formatSpecifier(e);let n=i.fill,o=i.align;const l=i.sign,d=i.symbol;let u=i.zero;const f=i.width;let g=i.comma,_=i.precision,y=i.trim,b=i.type;b==="n"?(g=!0,b="g"):formatTypes[b]||(_===void 0&&(_=12),y=!0,b="g"),(u||n==="0"&&o==="=")&&(u=!0,n="0",o="=");const S=d==="$"?this.currencyPrefix:d==="#"&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",v=d==="$"?this.currencySuffix:/[%p]/.test(b)?this.percent:"",A=formatTypes[b],x=/[defgprstz%]/.test(b);_=_===void 0?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,_)):Math.max(0,Math.min(20,_));const{nan:T,minus:C,decimal:E,group:P,numerals:R}=this;function L(w){let B,I,D,O=S,N=v,V=w;if(b==="c")N=A(V)+N,V="";else{V=+V;let $=V<0||1/V<0;if(V=isNaN(V)?T:A(Math.abs(V),_),y&&(V=formatTrim(V)),$&&+V==0&&l!=="+"&&($=!1),O=($?l==="("?l:C:l==="-"||l==="("?"":l)+O,N=(b==="s"?prefixes[8+prefixExponent/3]:"")+N+($&&l==="("?")":""),x){for(B=-1,I=V.length;++B<I;)if(D=V.charCodeAt(B),48>D||D>57){N=(D===46?E+V.slice(B+1):V.slice(B))+N,V=V.slice(0,B);break}}}g&&!u&&(V=P(V,1/0));let H=O.length+V.length+N.length,F=H<f?new Array(f-H+1).join(n):"";switch(g&&u&&(V=P(F+V,F.length?f-N.length:1/0),F=""),o){case"<":V=O+V+N+F;break;case"=":V=O+F+V+N;break;case"^":V=F.slice(0,H=F.length>>1)+O+V+N+F.slice(H);break;default:V=F+O+V+N}return R(V)}return L.toString=function(){return e+""},L}_formatPrefix(e,i){const n=formatSpecifier(e);n.type="f";const o=this.newFormat(n.toString()),l=3*Math.max(-8,Math.min(8,Math.floor(exponent(i)/3))),d=Math.pow(10,-l),u=prefixes[8+l/3];return function(f){return o(d*f)+u}}}const formatTypes={"%":(r,e)=>(100*r).toFixed(e),b:r=>Math.round(r).toString(2),c:r=>r+"",d:formatDecimal,f:(r,e)=>r.toFixed(e),e:(r,e)=>r.toExponential(e),g:(r,e)=>r.toPrecision(e),o:r=>Math.round(r).toString(8),p:(r,e)=>formatRounded(100*r,e),r:formatRounded,s:formatPrefixAuto,X:r=>Math.round(r).toString(16).toUpperCase(),x:r=>Math.round(r).toString(16),t:(r,e)=>Number.isInteger(r)?r.toFixed(2):Math.floor(r*Math.pow(10,e))/Math.pow(10,e)+"",z:(r,e)=>r%1==0?r+"":r.toFixed(e)};function exponent(r){const e=formatDecimalParts(Math.abs(r));return e?e[1]:NaN}function formatNumerals(r){return function(e){return e.replace(/[0-9]/g,i=>r[+i])}}const filter=(r,e)=>{const{callback:i}=e;return i&&(r=r.filter(i)),r};function adder(){return new Adder}function Adder(){this.reset()}Adder.prototype={constructor:Adder,reset:function(){this.s=this.t=0},add:function(r){add(temp$1,r,this.t),add(this,temp$1.s,this.s),this.s?this.t+=temp$1.t:this.s=temp$1.t},valueOf:function(){return this.s}};var temp$1=new Adder;function add(r,e,i){var n=r.s=e+i,o=n-e,l=n-o;r.t=e-l+(i-o)}var epsilon=1e-6,epsilon2=1e-12,pi=Math.PI,halfPi$1=pi/2,quarterPi=pi/4,tau=pi*2,degrees=180/pi,radians=pi/180,abs=Math.abs,atan=Math.atan,atan2=Math.atan2,cos=Math.cos,exp=Math.exp,log=Math.log,pow=Math.pow,sin=Math.sin,sign$1=Math.sign||function(r){return r>0?1:r<0?-1:0},sqrt$2=Math.sqrt,tan=Math.tan;function acos(r){return r>1?0:r<-1?pi:Math.acos(r)}function asin(r){return r>1?halfPi$1:r<-1?-halfPi$1:Math.asin(r)}function noop(){}function streamGeometry(r,e){r&&streamGeometryType.hasOwnProperty(r.type)&&streamGeometryType[r.type](r,e)}var streamObjectType={Feature:function(r,e){streamGeometry(r.geometry,e)},FeatureCollection:function(r,e){for(var i=r.features,n=-1,o=i.length;++n<o;)streamGeometry(i[n].geometry,e)}},streamGeometryType={Sphere:function(r,e){e.sphere()},Point:function(r,e){r=r.coordinates,e.point(r[0],r[1],r[2])},MultiPoint:function(r,e){for(var i=r.coordinates,n=-1,o=i.length;++n<o;)r=i[n],e.point(r[0],r[1],r[2])},LineString:function(r,e){streamLine(r.coordinates,e,0)},MultiLineString:function(r,e){for(var i=r.coordinates,n=-1,o=i.length;++n<o;)streamLine(i[n],e,0)},Polygon:function(r,e){streamPolygon(r.coordinates,e)},MultiPolygon:function(r,e){for(var i=r.coordinates,n=-1,o=i.length;++n<o;)streamPolygon(i[n],e)},GeometryCollection:function(r,e){for(var i=r.geometries,n=-1,o=i.length;++n<o;)streamGeometry(i[n],e)}};function streamLine(r,e,i){var n=-1,o=r.length-i,l;for(e.lineStart();++n<o;)l=r[n],e.point(l[0],l[1],l[2]);e.lineEnd()}function streamPolygon(r,e){var i=-1,n=r.length;for(e.polygonStart();++i<n;)streamLine(r[i],e,1);e.polygonEnd()}function geoStream(r,e){r&&streamObjectType.hasOwnProperty(r.type)?streamObjectType[r.type](r,e):streamGeometry(r,e)}function spherical(r){return[atan2(r[1],r[0]),asin(r[2])]}function cartesian(r){var e=r[0],i=r[1],n=cos(i);return[n*cos(e),n*sin(e),sin(i)]}function cartesianDot(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]}function cartesianCross(r,e){return[r[1]*e[2]-r[2]*e[1],r[2]*e[0]-r[0]*e[2],r[0]*e[1]-r[1]*e[0]]}function cartesianAddInPlace(r,e){r[0]+=e[0],r[1]+=e[1],r[2]+=e[2]}function cartesianScale(r,e){return[r[0]*e,r[1]*e,r[2]*e]}function cartesianNormalizeInPlace(r){var e=sqrt$2(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);r[0]/=e,r[1]/=e,r[2]/=e}function compose(r,e){function i(n,o){return n=r(n,o),e(n[0],n[1])}return r.invert&&e.invert&&(i.invert=function(n,o){return n=e.invert(n,o),n&&r.invert(n[0],n[1])}),i}function rotationIdentity(r,e){return[abs(r)>pi?r+Math.round(-r/tau)*tau:r,e]}rotationIdentity.invert=rotationIdentity;function rotateRadians(r,e,i){return(r%=tau)?e||i?compose(rotationLambda(r),rotationPhiGamma(e,i)):rotationLambda(r):e||i?rotationPhiGamma(e,i):rotationIdentity}function forwardRotationLambda(r){return function(e,i){return e+=r,[e>pi?e-tau:e<-pi?e+tau:e,i]}}function rotationLambda(r){var e=forwardRotationLambda(r);return e.invert=forwardRotationLambda(-r),e}function rotationPhiGamma(r,e){var i=cos(r),n=sin(r),o=cos(e),l=sin(e);function d(u,f){var g=cos(f),_=cos(u)*g,y=sin(u)*g,b=sin(f),S=b*i+_*n;return[atan2(y*o-S*l,_*i-b*n),asin(S*o+y*l)]}return d.invert=function(u,f){var g=cos(f),_=cos(u)*g,y=sin(u)*g,b=sin(f),S=b*o-y*l;return[atan2(y*o+b*l,_*i+S*n),asin(S*i-_*n)]},d}function rotation(r){r=rotateRadians(r[0]*radians,r[1]*radians,r.length>2?r[2]*radians:0);function e(i){return i=r(i[0]*radians,i[1]*radians),i[0]*=degrees,i[1]*=degrees,i}return e.invert=function(i){return i=r.invert(i[0]*radians,i[1]*radians),i[0]*=degrees,i[1]*=degrees,i},e}function circleStream(r,e,i,n,o,l){if(i){var d=cos(e),u=sin(e),f=n*i;o==null?(o=e+n*tau,l=e-f/2):(o=circleRadius(d,o),l=circleRadius(d,l),(n>0?o<l:o>l)&&(o+=n*tau));for(var g,_=o;n>0?_>l:_<l;_-=f)g=spherical([d,-u*cos(_),-u*sin(_)]),r.point(g[0],g[1])}}function circleRadius(r,e){e=cartesian(e),e[0]-=r,cartesianNormalizeInPlace(e);var i=acos(-e[1]);return((-e[2]<0?-i:i)+tau-epsilon)%tau}function clipBuffer(){var r=[],e;return{point:function(i,n,o){e.push([i,n,o])},lineStart:function(){r.push(e=[])},lineEnd:noop,rejoin:function(){r.length>1&&r.push(r.pop().concat(r.shift()))},result:function(){var i=r;return r=[],e=null,i}}}function pointEqual(r,e){return abs(r[0]-e[0])<epsilon&&abs(r[1]-e[1])<epsilon}function Intersection(r,e,i,n){this.x=r,this.z=e,this.o=i,this.e=n,this.v=!1,this.n=this.p=null}function clipRejoin(r,e,i,n,o){var l=[],d=[],u,f;if(r.forEach(function(v){if(!((A=v.length-1)<=0)){var A,x=v[0],T=v[A],C;if(pointEqual(x,T)){if(!x[2]&&!T[2]){for(o.lineStart(),u=0;u<A;++u)o.point((x=v[u])[0],x[1]);o.lineEnd();return}T[0]+=2*epsilon}l.push(C=new Intersection(x,v,null,!0)),d.push(C.o=new Intersection(x,null,C,!1)),l.push(C=new Intersection(T,v,null,!1)),d.push(C.o=new Intersection(T,null,C,!0))}}),!!l.length){for(d.sort(e),link$1(l),link$1(d),u=0,f=d.length;u<f;++u)d[u].e=i=!i;for(var g=l[0],_,y;;){for(var b=g,S=!0;b.v;)if((b=b.n)===g)return;_=b.z,o.lineStart();do{if(b.v=b.o.v=!0,b.e){if(S)for(u=0,f=_.length;u<f;++u)o.point((y=_[u])[0],y[1]);else n(b.x,b.n.x,1,o);b=b.n}else{if(S)for(_=b.p.z,u=_.length-1;u>=0;--u)o.point((y=_[u])[0],y[1]);else n(b.x,b.p.x,-1,o);b=b.p}b=b.o,_=b.z,S=!S}while(!b.v);o.lineEnd()}}}function link$1(r){if(e=r.length){for(var e,i=0,n=r[0],o;++i<e;)n.n=o=r[i],o.p=n,n=o;n.n=o=r[0],o.p=n}}var sum$2=adder();function longitude(r){return abs(r[0])<=pi?r[0]:sign$1(r[0])*((abs(r[0])+pi)%tau-pi)}function polygonContains(r,e){var i=longitude(e),n=e[1],o=sin(n),l=[sin(i),-cos(i),0],d=0,u=0;sum$2.reset(),o===1?n=halfPi$1+epsilon:o===-1&&(n=-halfPi$1-epsilon);for(var f=0,g=r.length;f<g;++f)if(y=(_=r[f]).length)for(var _,y,b=_[y-1],S=longitude(b),v=b[1]/2+quarterPi,A=sin(v),x=cos(v),T=0;T<y;++T,S=E,A=R,x=L,b=C){var C=_[T],E=longitude(C),P=C[1]/2+quarterPi,R=sin(P),L=cos(P),w=E-S,B=w>=0?1:-1,I=B*w,D=I>pi,O=A*R;if(sum$2.add(atan2(O*B*sin(I),x*L+O*cos(I))),d+=D?w+B*tau:w,D^S>=i^E>=i){var N=cartesianCross(cartesian(b),cartesian(C));cartesianNormalizeInPlace(N);var V=cartesianCross(l,N);cartesianNormalizeInPlace(V);var H=(D^w>=0?-1:1)*asin(V[2]);(n>H||n===H&&(N[0]||N[1]))&&(u+=D^w>=0?1:-1)}}return(d<-1e-6||d<epsilon&&sum$2<-1e-6)^u&1}function ascending(r,e){return r<e?-1:r>e?1:r>=e?0:NaN}function bisector(r){return r.length===1&&(r=ascendingComparator(r)),{left:function(e,i,n,o){for(n==null&&(n=0),o==null&&(o=e.length);n<o;){var l=n+o>>>1;r(e[l],i)<0?n=l+1:o=l}return n},right:function(e,i,n,o){for(n==null&&(n=0),o==null&&(o=e.length);n<o;){var l=n+o>>>1;r(e[l],i)>0?o=l:n=l+1}return n}}}function ascendingComparator(r){return function(e,i){return ascending(r(e),i)}}bisector(ascending);function merge(r){for(var e=r.length,i,n=-1,o=0,l,d;++n<e;)o+=r[n].length;for(l=new Array(o);--e>=0;)for(d=r[e],i=d.length;--i>=0;)l[--o]=d[i];return l}function clip(r,e,i,n){return function(o){var l=e(o),d=clipBuffer(),u=e(d),f=!1,g,_,y,b={point:S,lineStart:A,lineEnd:x,polygonStart:function(){b.point=T,b.lineStart=C,b.lineEnd=E,_=[],g=[]},polygonEnd:function(){b.point=S,b.lineStart=A,b.lineEnd=x,_=merge(_);var P=polygonContains(g,n);_.length?(f||(o.polygonStart(),f=!0),clipRejoin(_,compareIntersection,P,i,o)):P&&(f||(o.polygonStart(),f=!0),o.lineStart(),i(null,null,1,o),o.lineEnd()),f&&(o.polygonEnd(),f=!1),_=g=null},sphere:function(){o.polygonStart(),o.lineStart(),i(null,null,1,o),o.lineEnd(),o.polygonEnd()}};function S(P,R){r(P,R)&&o.point(P,R)}function v(P,R){l.point(P,R)}function A(){b.point=v,l.lineStart()}function x(){b.point=S,l.lineEnd()}function T(P,R){y.push([P,R]),u.point(P,R)}function C(){u.lineStart(),y=[]}function E(){T(y[0][0],y[0][1]),u.lineEnd();var P=u.clean(),R=d.result(),L,w=R.length,B,I,D;if(y.pop(),g.push(y),y=null,!!w){if(P&1){if(I=R[0],(B=I.length-1)>0){for(f||(o.polygonStart(),f=!0),o.lineStart(),L=0;L<B;++L)o.point((D=I[L])[0],D[1]);o.lineEnd()}return}w>1&&P&2&&R.push(R.pop().concat(R.shift())),_.push(R.filter(validSegment))}}return b}}function validSegment(r){return r.length>1}function compareIntersection(r,e){return((r=r.x)[0]<0?r[1]-halfPi$1-epsilon:halfPi$1-r[1])-((e=e.x)[0]<0?e[1]-halfPi$1-epsilon:halfPi$1-e[1])}const clipAntimeridian=clip(function(){return!0},clipAntimeridianLine,clipAntimeridianInterpolate,[-pi,-halfPi$1]);function clipAntimeridianLine(r){var e=NaN,i=NaN,n=NaN,o;return{lineStart:function(){r.lineStart(),o=1},point:function(l,d){var u=l>0?pi:-pi,f=abs(l-e);abs(f-pi)<epsilon?(r.point(e,i=(i+d)/2>0?halfPi$1:-halfPi$1),r.point(n,i),r.lineEnd(),r.lineStart(),r.point(u,i),r.point(l,i),o=0):n!==u&&f>=pi&&(abs(e-n)<epsilon&&(e-=n*epsilon),abs(l-u)<epsilon&&(l-=u*epsilon),i=clipAntimeridianIntersect(e,i,l,d),r.point(n,i),r.lineEnd(),r.lineStart(),r.point(u,i),o=0),r.point(e=l,i=d),n=u},lineEnd:function(){r.lineEnd(),e=i=NaN},clean:function(){return 2-o}}}function clipAntimeridianIntersect(r,e,i,n){var o,l,d=sin(r-i);return abs(d)>epsilon?atan((sin(e)*(l=cos(n))*sin(i)-sin(n)*(o=cos(e))*sin(r))/(o*l*d)):(e+n)/2}function clipAntimeridianInterpolate(r,e,i,n){var o;if(r==null)o=i*halfPi$1,n.point(-pi,o),n.point(0,o),n.point(pi,o),n.point(pi,0),n.point(pi,-o),n.point(0,-o),n.point(-pi,-o),n.point(-pi,0),n.point(-pi,o);else if(abs(r[0]-e[0])>epsilon){var l=r[0]<e[0]?pi:-pi;o=i*l/2,n.point(-l,o),n.point(0,o),n.point(l,o)}else n.point(e[0],e[1])}function clipCircle(r){var e=cos(r),i=6*radians,n=e>0,o=abs(e)>epsilon;function l(_,y,b,S){circleStream(S,r,i,b,_,y)}function d(_,y){return cos(_)*cos(y)>e}function u(_){var y,b,S,v,A;return{lineStart:function(){v=S=!1,A=1},point:function(x,T){var C=[x,T],E,P=d(x,T),R=n?P?0:g(x,T):P?g(x+(x<0?pi:-pi),T):0;if(!y&&(v=S=P)&&_.lineStart(),P!==S&&(E=f(y,C),(!E||pointEqual(y,E)||pointEqual(C,E))&&(C[2]=1)),P!==S)A=0,P?(_.lineStart(),E=f(C,y),_.point(E[0],E[1])):(E=f(y,C),_.point(E[0],E[1],2),_.lineEnd()),y=E;else if(o&&y&&n^P){var L;!(R&b)&&(L=f(C,y,!0))&&(A=0,n?(_.lineStart(),_.point(L[0][0],L[0][1]),_.point(L[1][0],L[1][1]),_.lineEnd()):(_.point(L[1][0],L[1][1]),_.lineEnd(),_.lineStart(),_.point(L[0][0],L[0][1],3)))}P&&(!y||!pointEqual(y,C))&&_.point(C[0],C[1]),y=C,S=P,b=R},lineEnd:function(){S&&_.lineEnd(),y=null},clean:function(){return A|(v&&S)<<1}}}function f(_,y,b){var S=cartesian(_),v=cartesian(y),A=[1,0,0],x=cartesianCross(S,v),T=cartesianDot(x,x),C=x[0],E=T-C*C;if(!E)return!b&&_;var P=e*T/E,R=-e*C/E,L=cartesianCross(A,x),w=cartesianScale(A,P),B=cartesianScale(x,R);cartesianAddInPlace(w,B);var I=L,D=cartesianDot(w,I),O=cartesianDot(I,I),N=D*D-O*(cartesianDot(w,w)-1);if(!(N<0)){var V=sqrt$2(N),H=cartesianScale(I,(-D-V)/O);if(cartesianAddInPlace(H,w),H=spherical(H),!b)return H;var F=_[0],$=y[0],G=_[1],Y=y[1],Q;$<F&&(Q=F,F=$,$=Q);var q=$-F,te=abs(q-pi)<epsilon,ue=te||q<epsilon;if(!te&&Y<G&&(Q=G,G=Y,Y=Q),ue?te?G+Y>0^H[1]<(abs(H[0]-F)<epsilon?G:Y):G<=H[1]&&H[1]<=Y:q>pi^(F<=H[0]&&H[0]<=$)){var he=cartesianScale(I,(-D+V)/O);return cartesianAddInPlace(he,w),[H,spherical(he)]}}}function g(_,y){var b=n?r:pi-r,S=0;return _<-b?S|=1:_>b&&(S|=2),y<-b?S|=4:y>b&&(S|=8),S}return clip(d,u,l,n?[0,-r]:[-pi,r-pi])}function clipLine(r,e,i,n,o,l){var d=r[0],u=r[1],f=e[0],g=e[1],_=0,y=1,b=f-d,S=g-u,v;if(v=i-d,!(!b&&v>0)){if(v/=b,b<0){if(v<_)return;v<y&&(y=v)}else if(b>0){if(v>y)return;v>_&&(_=v)}if(v=o-d,!(!b&&v<0)){if(v/=b,b<0){if(v>y)return;v>_&&(_=v)}else if(b>0){if(v<_)return;v<y&&(y=v)}if(v=n-u,!(!S&&v>0)){if(v/=S,S<0){if(v<_)return;v<y&&(y=v)}else if(S>0){if(v>y)return;v>_&&(_=v)}if(v=l-u,!(!S&&v<0)){if(v/=S,S<0){if(v>y)return;v>_&&(_=v)}else if(S>0){if(v<_)return;v<y&&(y=v)}return _>0&&(r[0]=d+_*b,r[1]=u+_*S),y<1&&(e[0]=d+y*b,e[1]=u+y*S),!0}}}}}var clipMax=1e9,clipMin=-1e9;function clipRectangle(r,e,i,n){function o(g,_){return r<=g&&g<=i&&e<=_&&_<=n}function l(g,_,y,b){var S=0,v=0;if(g==null||(S=d(g,y))!==(v=d(_,y))||f(g,_)<0^y>0)do b.point(S===0||S===3?r:i,S>1?n:e);while((S=(S+y+4)%4)!==v);else b.point(_[0],_[1])}function d(g,_){return abs(g[0]-r)<epsilon?_>0?0:3:abs(g[0]-i)<epsilon?_>0?2:1:abs(g[1]-e)<epsilon?_>0?1:0:_>0?3:2}function u(g,_){return f(g.x,_.x)}function f(g,_){var y=d(g,1),b=d(_,1);return y!==b?y-b:y===0?_[1]-g[1]:y===1?g[0]-_[0]:y===2?g[1]-_[1]:_[0]-g[0]}return function(g){var _=g,y=clipBuffer(),b,S,v,A,x,T,C,E,P,R,L,w={point:B,lineStart:N,lineEnd:V,polygonStart:D,polygonEnd:O};function B(F,$){o(F,$)&&_.point(F,$)}function I(){for(var F=0,$=0,G=S.length;$<G;++$)for(var Y=S[$],Q=1,q=Y.length,te=Y[0],ue,he,fe=te[0],pe=te[1];Q<q;++Q)ue=fe,he=pe,te=Y[Q],fe=te[0],pe=te[1],he<=n?pe>n&&(fe-ue)*(n-he)>(pe-he)*(r-ue)&&++F:pe<=n&&(fe-ue)*(n-he)<(pe-he)*(r-ue)&&--F;return F}function D(){_=y,b=[],S=[],L=!0}function O(){var F=I(),$=L&&F,G=(b=merge(b)).length;($||G)&&(g.polygonStart(),$&&(g.lineStart(),l(null,null,1,g),g.lineEnd()),G&&clipRejoin(b,u,F,l,g),g.polygonEnd()),_=g,b=S=v=null}function N(){w.point=H,S&&S.push(v=[]),R=!0,P=!1,C=E=NaN}function V(){b&&(H(A,x),T&&P&&y.rejoin(),b.push(y.result())),w.point=B,P&&_.lineEnd()}function H(F,$){var G=o(F,$);if(S&&v.push([F,$]),R)A=F,x=$,T=G,R=!1,G&&(_.lineStart(),_.point(F,$));else if(G&&P)_.point(F,$);else{var Y=[C=Math.max(clipMin,Math.min(clipMax,C)),E=Math.max(clipMin,Math.min(clipMax,E))],Q=[F=Math.max(clipMin,Math.min(clipMax,F)),$=Math.max(clipMin,Math.min(clipMax,$))];clipLine(Y,Q,r,e,i,n)?(P||(_.lineStart(),_.point(Y[0],Y[1])),_.point(Q[0],Q[1]),G||_.lineEnd(),L=!1):G&&(_.lineStart(),_.point(F,$),L=!1)}C=F,E=$,P=G}return w}}function identity$3(r){return r}var areaSum=adder(),areaRingSum=adder(),x00$2,y00$2,x0$3,y0$3,areaStream={point:noop,lineStart:noop,lineEnd:noop,polygonStart:function(){areaStream.lineStart=areaRingStart,areaStream.lineEnd=areaRingEnd},polygonEnd:function(){areaStream.lineStart=areaStream.lineEnd=areaStream.point=noop,areaSum.add(abs(areaRingSum)),areaRingSum.reset()},result:function(){var r=areaSum/2;return areaSum.reset(),r}};function areaRingStart(){areaStream.point=areaPointFirst}function areaPointFirst(r,e){areaStream.point=areaPoint,x00$2=x0$3=r,y00$2=y0$3=e}function areaPoint(r,e){areaRingSum.add(y0$3*r-x0$3*e),x0$3=r,y0$3=e}function areaRingEnd(){areaPoint(x00$2,y00$2)}var x0$2=1/0,y0$2=x0$2,x1=-x0$2,y1=x1,boundsStream={point:boundsPoint,lineStart:noop,lineEnd:noop,polygonStart:noop,polygonEnd:noop,result:function(){var r=[[x0$2,y0$2],[x1,y1]];return x1=y1=-(y0$2=x0$2=1/0),r}};function boundsPoint(r,e){r<x0$2&&(x0$2=r),r>x1&&(x1=r),e<y0$2&&(y0$2=e),e>y1&&(y1=e)}var X0=0,Y0=0,Z0=0,X1=0,Y1=0,Z1=0,X2=0,Y2=0,Z2=0,x00$1,y00$1,x0$1,y0$1,centroidStream={point:centroidPoint,lineStart:centroidLineStart,lineEnd:centroidLineEnd,polygonStart:function(){centroidStream.lineStart=centroidRingStart,centroidStream.lineEnd=centroidRingEnd},polygonEnd:function(){centroidStream.point=centroidPoint,centroidStream.lineStart=centroidLineStart,centroidStream.lineEnd=centroidLineEnd},result:function(){var r=Z2?[X2/Z2,Y2/Z2]:Z1?[X1/Z1,Y1/Z1]:Z0?[X0/Z0,Y0/Z0]:[NaN,NaN];return X0=Y0=Z0=X1=Y1=Z1=X2=Y2=Z2=0,r}};function centroidPoint(r,e){X0+=r,Y0+=e,++Z0}function centroidLineStart(){centroidStream.point=centroidPointFirstLine}function centroidPointFirstLine(r,e){centroidStream.point=centroidPointLine,centroidPoint(x0$1=r,y0$1=e)}function centroidPointLine(r,e){var i=r-x0$1,n=e-y0$1,o=sqrt$2(i*i+n*n);X1+=o*(x0$1+r)/2,Y1+=o*(y0$1+e)/2,Z1+=o,centroidPoint(x0$1=r,y0$1=e)}function centroidLineEnd(){centroidStream.point=centroidPoint}function centroidRingStart(){centroidStream.point=centroidPointFirstRing}function centroidRingEnd(){centroidPointRing(x00$1,y00$1)}function centroidPointFirstRing(r,e){centroidStream.point=centroidPointRing,centroidPoint(x00$1=x0$1=r,y00$1=y0$1=e)}function centroidPointRing(r,e){var i=r-x0$1,n=e-y0$1,o=sqrt$2(i*i+n*n);X1+=o*(x0$1+r)/2,Y1+=o*(y0$1+e)/2,Z1+=o,o=y0$1*r-x0$1*e,X2+=o*(x0$1+r),Y2+=o*(y0$1+e),Z2+=o*3,centroidPoint(x0$1=r,y0$1=e)}function PathContext(r){this._context=r}PathContext.prototype={_radius:4.5,pointRadius:function(r){return this._radius=r,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(r,e){switch(this._point){case 0:{this._context.moveTo(r,e),this._point=1;break}case 1:{this._context.lineTo(r,e);break}default:{this._context.moveTo(r+this._radius,e),this._context.arc(r,e,this._radius,0,tau);break}}},result:noop};var lengthSum=adder(),lengthRing,x00,y00,x0,y0,lengthStream={point:noop,lineStart:function(){lengthStream.point=lengthPointFirst},lineEnd:function(){lengthRing&&lengthPoint(x00,y00),lengthStream.point=noop},polygonStart:function(){lengthRing=!0},polygonEnd:function(){lengthRing=null},result:function(){var r=+lengthSum;return lengthSum.reset(),r}};function lengthPointFirst(r,e){lengthStream.point=lengthPoint,x00=x0=r,y00=y0=e}function lengthPoint(r,e){x0-=r,y0-=e,lengthSum.add(sqrt$2(x0*x0+y0*y0)),x0=r,y0=e}function PathString(){this._string=[]}PathString.prototype={_radius:4.5,_circle:circle$3(4.5),pointRadius:function(r){return(r=+r)!==this._radius&&(this._radius=r,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(r,e){switch(this._point){case 0:{this._string.push("M",r,",",e),this._point=1;break}case 1:{this._string.push("L",r,",",e);break}default:{this._circle==null&&(this._circle=circle$3(this._radius)),this._string.push("M",r,",",e,this._circle);break}}},result:function(){if(this._string.length){var r=this._string.join("");return this._string=[],r}else return null}};function circle$3(r){return"m0,"+r+"a"+r+","+r+" 0 1,1 0,"+-2*r+"a"+r+","+r+" 0 1,1 0,"+2*r+"z"}function geoPath(r,e){var i=4.5,n,o;function l(d){return d&&(typeof i=="function"&&o.pointRadius(+i.apply(this,arguments)),geoStream(d,n(o))),o.result()}return l.area=function(d){return geoStream(d,n(areaStream)),areaStream.result()},l.measure=function(d){return geoStream(d,n(lengthStream)),lengthStream.result()},l.bounds=function(d){return geoStream(d,n(boundsStream)),boundsStream.result()},l.centroid=function(d){return geoStream(d,n(centroidStream)),centroidStream.result()},l.projection=function(d){return arguments.length?(n=d==null?(r=null,identity$3):(r=d).stream,l):r},l.context=function(d){return arguments.length?(o=d==null?(e=null,new PathString):new PathContext(e=d),typeof i!="function"&&o.pointRadius(i),l):e},l.pointRadius=function(d){return arguments.length?(i=typeof d=="function"?d:(o.pointRadius(+d),+d),l):i},l.projection(r).context(e)}function transformer(r){return function(e){var i=new TransformStream;for(var n in r)i[n]=r[n];return i.stream=e,i}}function TransformStream(){}TransformStream.prototype={constructor:TransformStream,point:function(r,e){this.stream.point(r,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function fit(r,e,i){var n=r.clipExtent&&r.clipExtent();return r.scale(150).translate([0,0]),n!=null&&r.clipExtent(null),geoStream(i,r.stream(boundsStream)),e(boundsStream.result()),n!=null&&r.clipExtent(n),r}function fitExtent(r,e,i){return fit(r,function(n){var o=e[1][0]-e[0][0],l=e[1][1]-e[0][1],d=Math.min(o/(n[1][0]-n[0][0]),l/(n[1][1]-n[0][1])),u=+e[0][0]+(o-d*(n[1][0]+n[0][0]))/2,f=+e[0][1]+(l-d*(n[1][1]+n[0][1]))/2;r.scale(150*d).translate([u,f])},i)}function fitSize(r,e,i){return fitExtent(r,[[0,0],e],i)}function fitWidth(r,e,i){return fit(r,function(n){var o=+e,l=o/(n[1][0]-n[0][0]),d=(o-l*(n[1][0]+n[0][0]))/2,u=-l*n[0][1];r.scale(150*l).translate([d,u])},i)}function fitHeight(r,e,i){return fit(r,function(n){var o=+e,l=o/(n[1][1]-n[0][1]),d=-l*n[0][0],u=(o-l*(n[1][1]+n[0][1]))/2;r.scale(150*l).translate([d,u])},i)}var maxDepth=16,cosMinDistance=cos(30*radians);function resample(r,e){return+e?resample$1(r,e):resampleNone(r)}function resampleNone(r){return transformer({point:function(e,i){e=r(e,i),this.stream.point(e[0],e[1])}})}function resample$1(r,e){function i(n,o,l,d,u,f,g,_,y,b,S,v,A,x){var T=g-n,C=_-o,E=T*T+C*C;if(E>4*e&&A--){var P=d+b,R=u+S,L=f+v,w=sqrt$2(P*P+R*R+L*L),B=asin(L/=w),I=abs(abs(L)-1)<epsilon||abs(l-y)<epsilon?(l+y)/2:atan2(R,P),D=r(I,B),O=D[0],N=D[1],V=O-n,H=N-o,F=C*V-T*H;(F*F/E>e||abs((T*V+C*H)/E-.5)>.3||d*b+u*S+f*v<cosMinDistance)&&(i(n,o,l,d,u,f,O,N,I,P/=w,R/=w,L,A,x),x.point(O,N),i(O,N,I,P,R,L,g,_,y,b,S,v,A,x))}}return function(n){var o,l,d,u,f,g,_,y,b,S,v,A,x={point:T,lineStart:C,lineEnd:P,polygonStart:function(){n.polygonStart(),x.lineStart=R},polygonEnd:function(){n.polygonEnd(),x.lineStart=C}};function T(B,I){B=r(B,I),n.point(B[0],B[1])}function C(){y=NaN,x.point=E,n.lineStart()}function E(B,I){var D=cartesian([B,I]),O=r(B,I);i(y,b,_,S,v,A,y=O[0],b=O[1],_=B,S=D[0],v=D[1],A=D[2],maxDepth,n),n.point(y,b)}function P(){x.point=T,n.lineEnd()}function R(){C(),x.point=L,x.lineEnd=w}function L(B,I){E(o=B,I),l=y,d=b,u=S,f=v,g=A,x.point=E}function w(){i(y,b,_,S,v,A,l,d,o,u,f,g,maxDepth,n),x.lineEnd=P,P()}return x}}var transformRadians=transformer({point:function(r,e){this.stream.point(r*radians,e*radians)}});function transformRotate(r){return transformer({point:function(e,i){var n=r(e,i);return this.stream.point(n[0],n[1])}})}function scaleTranslate(r,e,i,n,o){function l(d,u){return d*=n,u*=o,[e+r*d,i-r*u]}return l.invert=function(d,u){return[(d-e)/r*n,(i-u)/r*o]},l}function scaleTranslateRotate(r,e,i,n,o,l){var d=cos(l),u=sin(l),f=d*r,g=u*r,_=d/r,y=u/r,b=(u*i-d*e)/r,S=(u*e+d*i)/r;function v(A,x){return A*=n,x*=o,[f*A-g*x+e,i-g*A-f*x]}return v.invert=function(A,x){return[n*(_*A-y*x+b),o*(S-y*A-_*x)]},v}function projection$1(r){return projectionMutator(function(){return r})()}function projectionMutator(r){var e,i=150,n=480,o=250,l=0,d=0,u=0,f=0,g=0,_,y=0,b=1,S=1,v=null,A=clipAntimeridian,x=null,T,C,E,P=identity$3,R=.5,L,w,B,I,D;function O(F){return B(F[0]*radians,F[1]*radians)}function N(F){return F=B.invert(F[0],F[1]),F&&[F[0]*degrees,F[1]*degrees]}O.stream=function(F){return I&&D===F?I:I=transformRadians(transformRotate(_)(A(L(P(D=F)))))},O.preclip=function(F){return arguments.length?(A=F,v=void 0,H()):A},O.postclip=function(F){return arguments.length?(P=F,x=T=C=E=null,H()):P},O.clipAngle=function(F){return arguments.length?(A=+F?clipCircle(v=F*radians):(v=null,clipAntimeridian),H()):v*degrees},O.clipExtent=function(F){return arguments.length?(P=F==null?(x=T=C=E=null,identity$3):clipRectangle(x=+F[0][0],T=+F[0][1],C=+F[1][0],E=+F[1][1]),H()):x==null?null:[[x,T],[C,E]]},O.scale=function(F){return arguments.length?(i=+F,V()):i},O.translate=function(F){return arguments.length?(n=+F[0],o=+F[1],V()):[n,o]},O.center=function(F){return arguments.length?(l=F[0]%360*radians,d=F[1]%360*radians,V()):[l*degrees,d*degrees]},O.rotate=function(F){return arguments.length?(u=F[0]%360*radians,f=F[1]%360*radians,g=F.length>2?F[2]%360*radians:0,V()):[u*degrees,f*degrees,g*degrees]},O.angle=function(F){return arguments.length?(y=F%360*radians,V()):y*degrees},O.reflectX=function(F){return arguments.length?(b=F?-1:1,V()):b<0},O.reflectY=function(F){return arguments.length?(S=F?-1:1,V()):S<0},O.precision=function(F){return arguments.length?(L=resample(w,R=F*F),H()):sqrt$2(R)},O.fitExtent=function(F,$){return fitExtent(O,F,$)},O.fitSize=function(F,$){return fitSize(O,F,$)},O.fitWidth=function(F,$){return fitWidth(O,F,$)},O.fitHeight=function(F,$){return fitHeight(O,F,$)};function V(){var F=scaleTranslateRotate(i,0,0,b,S,y).apply(null,e(l,d)),$=(y?scaleTranslateRotate:scaleTranslate)(i,n-F[0],o-F[1],b,S,y);return _=rotateRadians(u,f,g),w=compose(e,$),B=compose(_,w),L=resample(w,R),H()}function H(){return I=D=null,O}return function(){return e=r.apply(this,arguments),O.invert=e.invert&&N,V()}}function conicProjection(r){var e=0,i=pi/3,n=projectionMutator(r),o=n(e,i);return o.parallels=function(l){return arguments.length?n(e=l[0]*radians,i=l[1]*radians):[e*degrees,i*degrees]},o}function cylindricalEqualAreaRaw(r){var e=cos(r);function i(n,o){return[n*e,sin(o)/e]}return i.invert=function(n,o){return[n/e,asin(o*e)]},i}function conicEqualAreaRaw(r,e){var i=sin(r),n=(i+sin(e))/2;if(abs(n)<epsilon)return cylindricalEqualAreaRaw(r);var o=1+i*(2*n-i),l=sqrt$2(o)/n;function d(u,f){var g=sqrt$2(o-2*n*sin(f))/n;return[g*sin(u*=n),l-g*cos(u)]}return d.invert=function(u,f){var g=l-f,_=atan2(u,abs(g))*sign$1(g);return g*n<0&&(_-=pi*sign$1(u)*sign$1(g)),[_/n,asin((o-(u*u+g*g)*n*n)/(2*n))]},d}function geoConicEqualArea(){return conicProjection(conicEqualAreaRaw).scale(155.424).center([0,33.6442])}function geoAlbers(){return geoConicEqualArea().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function multiplex(r){var e=r.length;return{point:function(i,n){for(var o=-1;++o<e;)r[o].point(i,n)},sphere:function(){for(var i=-1;++i<e;)r[i].sphere()},lineStart:function(){for(var i=-1;++i<e;)r[i].lineStart()},lineEnd:function(){for(var i=-1;++i<e;)r[i].lineEnd()},polygonStart:function(){for(var i=-1;++i<e;)r[i].polygonStart()},polygonEnd:function(){for(var i=-1;++i<e;)r[i].polygonEnd()}}}function geoAlbersUsa(){var r,e,i=geoAlbers(),n,o=geoConicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l,d=geoConicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u,f,g={point:function(b,S){f=[b,S]}};function _(b){var S=b[0],v=b[1];return f=null,n.point(S,v),f||(l.point(S,v),f)||(u.point(S,v),f)}_.invert=function(b){var S=i.scale(),v=i.translate(),A=(b[0]-v[0])/S,x=(b[1]-v[1])/S;return(x>=.12&&x<.234&&A>=-.425&&A<-.214?o:x>=.166&&x<.234&&A>=-.214&&A<-.115?d:i).invert(b)},_.stream=function(b){return r&&e===b?r:r=multiplex([i.stream(e=b),o.stream(b),d.stream(b)])},_.precision=function(b){return arguments.length?(i.precision(b),o.precision(b),d.precision(b),y()):i.precision()},_.scale=function(b){return arguments.length?(i.scale(b),o.scale(b*.35),d.scale(b),_.translate(i.translate())):i.scale()},_.translate=function(b){if(!arguments.length)return i.translate();var S=i.scale(),v=+b[0],A=+b[1];return n=i.translate(b).clipExtent([[v-.455*S,A-.238*S],[v+.455*S,A+.238*S]]).stream(g),l=o.translate([v-.307*S,A+.201*S]).clipExtent([[v-.425*S+epsilon,A+.12*S+epsilon],[v-.214*S-epsilon,A+.234*S-epsilon]]).stream(g),u=d.translate([v-.205*S,A+.212*S]).clipExtent([[v-.214*S+epsilon,A+.166*S+epsilon],[v-.115*S-epsilon,A+.234*S-epsilon]]).stream(g),y()},_.fitExtent=function(b,S){return fitExtent(_,b,S)},_.fitSize=function(b,S){return fitSize(_,b,S)},_.fitWidth=function(b,S){return fitWidth(_,b,S)},_.fitHeight=function(b,S){return fitHeight(_,b,S)};function y(){return r=e=null,_}return _.scale(1070)}function azimuthalRaw(r){return function(e,i){var n=cos(e),o=cos(i),l=r(n*o);return[l*o*sin(e),l*sin(i)]}}function azimuthalInvert(r){return function(e,i){var n=sqrt$2(e*e+i*i),o=r(n),l=sin(o),d=cos(o);return[atan2(e*l,n*d),asin(n&&i*l/n)]}}var azimuthalEqualAreaRaw=azimuthalRaw(function(r){return sqrt$2(2/(1+r))});azimuthalEqualAreaRaw.invert=azimuthalInvert(function(r){return 2*asin(r/2)});function geoAzimuthalEqualArea(){return projection$1(azimuthalEqualAreaRaw).scale(124.75).clipAngle(180-.001)}var azimuthalEquidistantRaw=azimuthalRaw(function(r){return(r=acos(r))&&r/sin(r)});azimuthalEquidistantRaw.invert=azimuthalInvert(function(r){return r});function geoAzimuthalEquidistant(){return projection$1(azimuthalEquidistantRaw).scale(79.4188).clipAngle(180-.001)}function mercatorRaw(r,e){return[r,log(tan((halfPi$1+e)/2))]}mercatorRaw.invert=function(r,e){return[r,2*atan(exp(e))-halfPi$1]};function geoMercator(){return mercatorProjection(mercatorRaw).scale(961/tau)}function mercatorProjection(r){var e=projection$1(r),i=e.center,n=e.scale,o=e.translate,l=e.clipExtent,d=null,u,f,g;e.scale=function(y){return arguments.length?(n(y),_()):n()},e.translate=function(y){return arguments.length?(o(y),_()):o()},e.center=function(y){return arguments.length?(i(y),_()):i()},e.clipExtent=function(y){return arguments.length?(y==null?d=u=f=g=null:(d=+y[0][0],u=+y[0][1],f=+y[1][0],g=+y[1][1]),_()):d==null?null:[[d,u],[f,g]]};function _(){var y=pi*n(),b=e(rotation(e.rotate()).invert([0,0]));return l(d==null?[[b[0]-y,b[1]-y],[b[0]+y,b[1]+y]]:r===mercatorRaw?[[Math.max(b[0]-y,d),u],[Math.min(b[0]+y,f),g]]:[[d,Math.max(b[1]-y,u)],[f,Math.min(b[1]+y,g)]])}return _()}function tany(r){return tan((halfPi$1+r)/2)}function conicConformalRaw(r,e){var i=cos(r),n=r===e?sin(r):log(i/cos(e))/log(tany(e)/tany(r)),o=i*pow(tany(r),n)/n;if(!n)return mercatorRaw;function l(d,u){o>0?u<-halfPi$1+epsilon&&(u=-halfPi$1+epsilon):u>halfPi$1-epsilon&&(u=halfPi$1-epsilon);var f=o/pow(tany(u),n);return[f*sin(n*d),o-f*cos(n*d)]}return l.invert=function(d,u){var f=o-u,g=sign$1(n)*sqrt$2(d*d+f*f),_=atan2(d,abs(f))*sign$1(f);return f*n<0&&(_-=pi*sign$1(d)*sign$1(f)),[_/n,2*atan(pow(o/g,1/n))-halfPi$1]},l}function geoConicConformal(){return conicProjection(conicConformalRaw).scale(109.5).parallels([30,30])}function equirectangularRaw(r,e){return[r,e]}equirectangularRaw.invert=equirectangularRaw;function geoEquirectangular(){return projection$1(equirectangularRaw).scale(152.63)}function conicEquidistantRaw(r,e){var i=cos(r),n=r===e?sin(r):(i-cos(e))/(e-r),o=i/n+r;if(abs(n)<epsilon)return equirectangularRaw;function l(d,u){var f=o-u,g=n*d;return[f*sin(g),o-f*cos(g)]}return l.invert=function(d,u){var f=o-u,g=atan2(d,abs(f))*sign$1(f);return f*n<0&&(g-=pi*sign$1(d)*sign$1(f)),[g/n,o-sign$1(n)*sqrt$2(d*d+f*f)]},l}function geoConicEquidistant(){return conicProjection(conicEquidistantRaw).scale(131.154).center([0,13.9389])}var A1=1.340264,A2=-.081106,A3=893e-6,A4=.003796,M=sqrt$2(3)/2,iterations=12;function equalEarthRaw(r,e){var i=asin(M*sin(e)),n=i*i,o=n*n*n;return[r*cos(i)/(M*(A1+3*A2*n+o*(7*A3+9*A4*n))),i*(A1+A2*n+o*(A3+A4*n))]}equalEarthRaw.invert=function(r,e){for(var i=e,n=i*i,o=n*n*n,l=0,d,u,f;l<iterations&&(u=i*(A1+A2*n+o*(A3+A4*n))-e,f=A1+3*A2*n+o*(7*A3+9*A4*n),i-=d=u/f,n=i*i,o=n*n*n,!(abs(d)<epsilon2));++l);return[M*r*(A1+3*A2*n+o*(7*A3+9*A4*n))/cos(i),asin(sin(i)/M)]};function geoEqualEarth(){return projection$1(equalEarthRaw).scale(177.158)}function gnomonicRaw(r,e){var i=cos(e),n=cos(r)*i;return[i*sin(r)/n,sin(e)/n]}gnomonicRaw.invert=azimuthalInvert(atan);function geoGnomonic(){return projection$1(gnomonicRaw).scale(144.049).clipAngle(60)}function geoIdentity(){var r=1,e=0,i=0,n=1,o=1,l=0,d,u,f=null,g,_,y,b=1,S=1,v=transformer({point:function(P,R){var L=E([P,R]);this.stream.point(L[0],L[1])}}),A=identity$3,x,T;function C(){return b=r*n,S=r*o,x=T=null,E}function E(P){var R=P[0]*b,L=P[1]*S;if(l){var w=L*d-R*u;R=R*d+L*u,L=w}return[R+e,L+i]}return E.invert=function(P){var R=P[0]-e,L=P[1]-i;if(l){var w=L*d+R*u;R=R*d-L*u,L=w}return[R/b,L/S]},E.stream=function(P){return x&&T===P?x:x=v(A(T=P))},E.postclip=function(P){return arguments.length?(A=P,f=g=_=y=null,C()):A},E.clipExtent=function(P){return arguments.length?(A=P==null?(f=g=_=y=null,identity$3):clipRectangle(f=+P[0][0],g=+P[0][1],_=+P[1][0],y=+P[1][1]),C()):f==null?null:[[f,g],[_,y]]},E.scale=function(P){return arguments.length?(r=+P,C()):r},E.translate=function(P){return arguments.length?(e=+P[0],i=+P[1],C()):[e,i]},E.angle=function(P){return arguments.length?(l=P%360*radians,u=sin(l),d=cos(l),C()):l*degrees},E.reflectX=function(P){return arguments.length?(n=P?-1:1,C()):n<0},E.reflectY=function(P){return arguments.length?(o=P?-1:1,C()):o<0},E.fitExtent=function(P,R){return fitExtent(E,P,R)},E.fitSize=function(P,R){return fitSize(E,P,R)},E.fitWidth=function(P,R){return fitWidth(E,P,R)},E.fitHeight=function(P,R){return fitHeight(E,P,R)},E}function naturalEarth1Raw(r,e){var i=e*e,n=i*i;return[r*(.8707-.131979*i+n*(-.013791+n*(.003971*i-.001529*n))),e*(1.007226+i*(.015085+n*(-.044475+.028874*i-.005916*n)))]}naturalEarth1Raw.invert=function(r,e){var i=e,n=25,o;do{var l=i*i,d=l*l;i-=o=(i*(1.007226+l*(.015085+d*(-.044475+.028874*l-.005916*d)))-e)/(1.007226+l*(.015085*3+d*(-.044475*7+.028874*9*l-.005916*11*d)))}while(abs(o)>epsilon&&--n>0);return[r/(.8707+(l=i*i)*(-.131979+l*(-.013791+l*l*l*(.003971-.001529*l)))),i]};function geoNaturalEarth1(){return projection$1(naturalEarth1Raw).scale(175.295)}function orthographicRaw(r,e){return[cos(e)*sin(r),sin(e)]}orthographicRaw.invert=azimuthalInvert(asin);function geoOrthographic(){return projection$1(orthographicRaw).scale(249.5).clipAngle(90+epsilon)}function stereographicRaw(r,e){var i=cos(e),n=1+cos(r)*i;return[i*sin(r)/n,sin(e)/n]}stereographicRaw.invert=azimuthalInvert(function(r){return 2*atan(r)});function geoStereographic(){return projection$1(stereographicRaw).scale(250).clipAngle(142)}function transverseMercatorRaw(r,e){return[log(tan((halfPi$1+e)/2)),-r]}transverseMercatorRaw.invert=function(r,e){return[-e,2*atan(exp(r))-halfPi$1]};function geoTransverseMercator(){var r=mercatorProjection(transverseMercatorRaw),e=r.center,i=r.rotate;return r.center=function(n){return arguments.length?e([-n[1],n[0]]):(n=e(),[n[1],-n[0]])},r.rotate=function(n){return arguments.length?i([n[0],n[1],n.length>2?n[2]+90:90]):(n=i(),[n[0],n[1],n[2]-90])},i([0,0,90]).scale(159.155)}function identity$2(r){return r}function transform$8(r){if(r==null)return identity$2;var e,i,n=r.scale[0],o=r.scale[1],l=r.translate[0],d=r.translate[1];return function(u,f){f||(e=i=0);var g=2,_=u.length,y=new Array(_);for(y[0]=(e+=u[0])*n+l,y[1]=(i+=u[1])*o+d;g<_;)y[g]=u[g],++g;return y}}function reverse(r,e){for(var i,n=r.length,o=n-e;o<--n;)i=r[o],r[o++]=r[n],r[n]=i}function feature(r,e){return typeof e=="string"&&(e=r.objects[e]),e.type==="GeometryCollection"?{type:"FeatureCollection",features:e.geometries.map(function(i){return feature$1(r,i)})}:feature$1(r,e)}function feature$1(r,e){var i=e.id,n=e.bbox,o=e.properties==null?{}:e.properties,l=object(r,e);return i==null&&n==null?{type:"Feature",properties:o,geometry:l}:n==null?{type:"Feature",id:i,properties:o,geometry:l}:{type:"Feature",id:i,bbox:n,properties:o,geometry:l}}function object(r,e){var i=transform$8(r.transform),n=r.arcs;function o(_,y){y.length&&y.pop();for(var b=n[_<0?~_:_],S=0,v=b.length;S<v;++S)y.push(i(b[S],S));_<0&&reverse(y,v)}function l(_){return i(_)}function d(_){for(var y=[],b=0,S=_.length;b<S;++b)o(_[b],y);return y.length<2&&y.push(y[0]),y}function u(_){for(var y=d(_);y.length<4;)y.push(y[0]);return y}function f(_){return _.map(u)}function g(_){var y=_.type,b;switch(y){case"GeometryCollection":return{type:y,geometries:_.geometries.map(g)};case"Point":b=l(_.coordinates);break;case"MultiPoint":b=_.coordinates.map(l);break;case"LineString":b=d(_.arcs);break;case"MultiLineString":b=_.arcs.map(d);break;case"Polygon":b=f(_.arcs);break;case"MultiPolygon":b=_.arcs.map(f);break;default:return null}return{type:y,coordinates:b}}return g(e)}var simplifyGeojson={exports:{}},line$1,hasRequiredLine;function requireLine(){if(hasRequiredLine)return line$1;hasRequiredLine=1;var r=function(e,i){this.p1=e,this.p2=i};return r.prototype.rise=function(){return this.p2[1]-this.p1[1]},r.prototype.run=function(){return this.p2[0]-this.p1[0]},r.prototype.slope=function(){return this.rise()/this.run()},r.prototype.yIntercept=function(){return this.p1[1]-this.p1[0]*this.slope(this.p1,this.p2)},r.prototype.isVertical=function(){return!isFinite(this.slope())},r.prototype.isHorizontal=function(){return this.p1[1]==this.p2[1]},r.prototype._perpendicularDistanceHorizontal=function(e){return Math.abs(this.p1[1]-e[1])},r.prototype._perpendicularDistanceVertical=function(e){return Math.abs(this.p1[0]-e[0])},r.prototype._perpendicularDistanceHasSlope=function(e){var i=this.slope(),n=this.yIntercept();return Math.abs(i*e[0]-e[1]+n)/Math.sqrt(Math.pow(i,2)+1)},r.prototype.perpendicularDistance=function(e){return this.isVertical()?this._perpendicularDistanceVertical(e):this.isHorizontal()?this._perpendicularDistanceHorizontal(e):this._perpendicularDistanceHasSlope(e)},line$1=r,line$1}var lib,hasRequiredLib;function requireLib(){if(hasRequiredLib)return lib;hasRequiredLib=1;var r=requireLine(),e=function(i,n){for(var o=0,l=0,d=1;d<=i.length-2;d++){var u=new r(i[0],i[i.length-1]).perpendicularDistance(i[d]);u>o&&(l=d,o=u)}if(o>n)var f=e(i.slice(0,l),n),g=e(i.slice(l,i.length),n),_=f.concat(g);else i.length>1?_=[i[0],i[i.length-1]]:_=[i[0]];return _};return lib=e,lib}var hasRequiredSimplifyGeojson;function requireSimplifyGeojson(){return hasRequiredSimplifyGeojson||(hasRequiredSimplifyGeojson=1,function(r){var e=requireLib();r.exports=function(o,l,d){return d||(o=JSON.parse(JSON.stringify(o))),o.features?n(o,l):o.type&&o.type==="Feature"?i(o,l):new Error("FeatureCollection or individual Feature required")},r.exports.simplify=function(o,l){return e(o,l)};function i(o,l){var d=o.geometry,u=d.type;if(u==="LineString")d.coordinates=r.exports.simplify(d.coordinates,l);else if(u==="Polygon"||u==="MultiLineString")for(var f=0;f<d.coordinates.length;f++)d.coordinates[f]=r.exports.simplify(d.coordinates[f],l);else if(u==="MultiPolygon")for(var g=0;g<d.coordinates.length;g++)for(var _=0;_<d.coordinates[g].length;_++)d.coordinates[g][_]=r.exports.simplify(d.coordinates[g][_],l);return o}function n(o,l){for(var d=0;d<o.features.length;d++)o.features[d]=i(o.features[d],l);return o}}(simplifyGeojson)),simplifyGeojson.exports}var simplifyGeojsonExports=requireSimplifyGeojson();const geoSimplify=getDefaultExportFromCjs(simplifyGeojsonExports),mergeDeepImmer=function(r,...e){return mergeOption(cloneDeep(r),...e)};function _mergeOptionDeep(r,e,i){const n=e[i];if(n===void 0)r[i]=null;else if(isObject$1(n)){isObject$1(r[i])||(r[i]={});for(const o in n)_mergeOptionDeep(r[i],n,o)}else r[i]=n}function _mergeOptionBase(r,e){if(isObject$1(e)&&r!==e)for(const i in e)_mergeOptionDeep(r,e,i)}function mergeOption(r,...e){r||(r={});let i=-1;const n=e.length;for(;++i<n;)_mergeOptionBase(r,e[i]);return r}const DEFAULT_SIMPLIFY_OPTIONS={tolerance:.01},simplify=(r,e)=>{const i=mergeDeepImmer(DEFAULT_SIMPLIFY_OPTIONS,e),{tolerance:n}=i;return geoSimplify(r,n)};var DATAVIEW_TYPE;(function(r){r.DSV="dsv",r.TREE="tree",r.GEO="geo",r.BYTE="bytejson",r.HEX="hex",r.GRAPH="graph",r.TABLE="table",r.GEO_GRATICULE="geo-graticule"})(DATAVIEW_TYPE||(DATAVIEW_TYPE={}));const fold=(r,e)=>{const{fields:i,key:n,value:o,retains:l}=e,d=[];for(let u=0;u<r.length;u++)i.forEach(f=>{const g={};if(g[n]=f,g[o]=r[u][f],l)l.forEach(_=>{g[_]=r[u][_]});else for(const _ in r[u])i.indexOf(_)===-1&&(g[_]=r[u][_]);d.push(g)});return d},fields=(r,e)=>{var i,n;if(!(e!=null&&e.fields)||r.length===0)return r;const o=e.fields,l=r[0],d={},u=[];for(const f in o)if(Object.prototype.hasOwnProperty.call(o,f)){const g=o[f];if(!g.type){let y=l;f in l||(y=(i=r.find(b=>f in b))!==null&&i!==void 0?i:l),g.type=typeof y[f]=="number"?"linear":"ordinal"}let _;if(typeof g.sortIndex=="number"&&(_={key:f,type:g.type,index:g.sortIndex,sortIndex:{},sortIndexCount:0,sortReverse:g.sortReverse===!0},u.push(_)),((n=g.domain)===null||n===void 0?void 0:n.length)>0)if(g.type==="ordinal"){g._domainCache={},d[f]=g;const y={};g.domain.forEach((b,S)=>{y[b]=S,g._domainCache[b]=S}),_&&(_.sortIndex=y,_.sortIndexCount=g.domain.length)}else g.domain.length>=2&&(d[f]=g)}return Object.keys(d).length>0&&(r=r.filter(f=>{for(const g in d){const _=d[g];if(_.type==="ordinal"){if(!(f[g]in _._domainCache))return!1}else if(_.domain[0]>f[g]||_.domain[1]<f[g])return!1}return!0})),u.sort((f,g)=>f.index-g.index),r.sort((f,g)=>sortData(f,g,u)),r};function sortData(r,e,i){for(let n=0;n<i.length;n++){const o=i[n];let l=0;if(o.type==="ordinal"?(o.sortIndex[e[o.key]]===void 0&&(o.sortIndex[e[o.key]]=o.sortIndexCount++),o.sortIndex[r[o.key]]===void 0&&(o.sortIndex[r[o.key]]=o.sortIndexCount++),l=o.sortIndex[r[o.key]]-o.sortIndex[e[o.key]]):o.type==="linear"&&(l=r[o.key]-e[o.key]),o.sortReverse&&(l=-l),l!==0)return l}return 0}var EOL={},EOF={},QUOTE=34,NEWLINE=10,RETURN=13;function objectConverter(r){return new Function("d","return {"+r.map(function(e,i){return JSON.stringify(e)+": d["+i+'] || ""'}).join(",")+"}")}function customConverter(r,e){var i=objectConverter(r);return function(n,o){return e(i(n),o,r)}}function inferColumns(r){var e=Object.create(null),i=[];return r.forEach(function(n){for(var o in n)o in e||i.push(e[o]=o)}),i}function pad(r,e){var i=r+"",n=i.length;return n<e?new Array(e-n+1).join(0)+i:i}function formatYear(r){return r<0?"-"+pad(-r,6):r>9999?"+"+pad(r,6):pad(r,4)}function formatDate(r){var e=r.getUTCHours(),i=r.getUTCMinutes(),n=r.getUTCSeconds(),o=r.getUTCMilliseconds();return isNaN(r)?"Invalid Date":formatYear(r.getUTCFullYear())+"-"+pad(r.getUTCMonth()+1,2)+"-"+pad(r.getUTCDate(),2)+(o?"T"+pad(e,2)+":"+pad(i,2)+":"+pad(n,2)+"."+pad(o,3)+"Z":n?"T"+pad(e,2)+":"+pad(i,2)+":"+pad(n,2)+"Z":i||e?"T"+pad(e,2)+":"+pad(i,2)+"Z":"")}function dsvFormat(r){var e=new RegExp('["'+r+`
\r]`),i=r.charCodeAt(0);function n(y,b){var S,v,A=o(y,function(x,T){if(S)return S(x,T-1);v=x,S=b?customConverter(x,b):objectConverter(x)});return A.columns=v||[],A}function o(y,b){var S=[],v=y.length,A=0,x=0,T,C=v<=0,E=!1;y.charCodeAt(v-1)===NEWLINE&&--v,y.charCodeAt(v-1)===RETURN&&--v;function P(){if(C)return EOF;if(E)return E=!1,EOL;var L,w=A,B;if(y.charCodeAt(w)===QUOTE){for(;A++<v&&y.charCodeAt(A)!==QUOTE||y.charCodeAt(++A)===QUOTE;);return(L=A)>=v?C=!0:(B=y.charCodeAt(A++))===NEWLINE?E=!0:B===RETURN&&(E=!0,y.charCodeAt(A)===NEWLINE&&++A),y.slice(w+1,L-1).replace(/""/g,'"')}for(;A<v;){if((B=y.charCodeAt(L=A++))===NEWLINE)E=!0;else if(B===RETURN)E=!0,y.charCodeAt(A)===NEWLINE&&++A;else if(B!==i)continue;return y.slice(w,L)}return C=!0,y.slice(w,v)}for(;(T=P())!==EOF;){for(var R=[];T!==EOL&&T!==EOF;)R.push(T),T=P();b&&(R=b(R,x++))==null||S.push(R)}return S}function l(y,b){return y.map(function(S){return b.map(function(v){return _(S[v])}).join(r)})}function d(y,b){return b==null&&(b=inferColumns(y)),[b.map(_).join(r)].concat(l(y,b)).join(`
`)}function u(y,b){return b==null&&(b=inferColumns(y)),l(y,b).join(`
`)}function f(y){return y.map(g).join(`
`)}function g(y){return y.map(_).join(r)}function _(y){return y==null?"":y instanceof Date?formatDate(y):e.test(y+="")?'"'+y.replace(/"/g,'""')+'"':y}return{parse:n,parseRows:o,format:d,formatBody:u,formatRows:f,formatRow:g,formatValue:_}}var csv=dsvFormat(","),csvParse=csv.parse,tsv=dsvFormat("	"),tsvParse=tsv.parse;const DEFAULT_DSV_PARSER_OPTIONS={delimiter:","},dsvParser=(r,e={},i)=>{i.type=DATAVIEW_TYPE.DSV;const n=mergeDeepImmer(DEFAULT_DSV_PARSER_OPTIONS,e),{delimiter:o}=n;if(!isString(o))throw new TypeError("Invalid delimiter: must be a string!");return dsvFormat(o).parse(r)},csvParser=(r,e={},i)=>(i.type=DATAVIEW_TYPE.DSV,csvParse(r)),tsvParser=(r,e={},i)=>(i.type=DATAVIEW_TYPE.DSV,tsvParse(r));function clone(r){if(!r)throw new Error("geojson is required");switch(r.type){case"Feature":return cloneFeature(r);case"FeatureCollection":return cloneFeatureCollection(r);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return cloneGeometry(r);default:throw new Error("unknown GeoJSON type")}}function cloneFeature(r){var e={type:"Feature"};return Object.keys(r).forEach(function(i){switch(i){case"type":case"properties":case"geometry":return;default:e[i]=r[i]}}),e.properties=cloneProperties(r.properties),e.geometry=cloneGeometry(r.geometry),e}function cloneProperties(r){var e={};return r&&Object.keys(r).forEach(function(i){var n=r[i];typeof n=="object"?n===null?e[i]=null:Array.isArray(n)?e[i]=n.map(function(o){return o}):e[i]=cloneProperties(n):e[i]=n}),e}function cloneFeatureCollection(r){var e={type:"FeatureCollection"};return Object.keys(r).forEach(function(i){switch(i){case"type":case"features":return;default:e[i]=r[i]}}),e.features=r.features.map(function(i){return cloneFeature(i)}),e}function cloneGeometry(r){var e={type:r.type};return r.bbox&&(e.bbox=r.bbox),r.type==="GeometryCollection"?(e.geometries=r.geometries.map(function(i){return cloneGeometry(i)}),e):(e.coordinates=deepSlice(r.coordinates),e)}function deepSlice(r){var e=r;return typeof e[0]!="object"?e.slice():e.map(function(i){return deepSlice(i)})}function getCoords(r){if(Array.isArray(r))return r;if(r.type==="Feature"){if(r.geometry!==null)return r.geometry.coordinates}else if(r.coordinates)return r.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function booleanClockwise(r){for(var e=getCoords(r),i=0,n=1,o,l;n<e.length;)o=l||e[0],l=e[n],i+=(l[0]-o[0])*(l[1]+o[1]),n++;return i>0}function featureEach(r,e){if(r.type==="Feature")e(r,0);else if(r.type==="FeatureCollection")for(var i=0;i<r.features.length&&e(r.features[i],i)!==!1;i++);}function geomEach(r,e){var i,n,o,l,d,u,f,g,_,y,b=0,S=r.type==="FeatureCollection",v=r.type==="Feature",A=S?r.features.length:1;for(i=0;i<A;i++){for(u=S?r.features[i].geometry:v?r.geometry:r,g=S?r.features[i].properties:v?r.properties:{},_=S?r.features[i].bbox:v?r.bbox:void 0,y=S?r.features[i].id:v?r.id:void 0,f=u?u.type==="GeometryCollection":!1,d=f?u.geometries.length:1,o=0;o<d;o++){if(l=f?u.geometries[o]:u,l===null){if(e(null,b,g,_,y)===!1)return!1;continue}switch(l.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(l,b,g,_,y)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<l.geometries.length;n++)if(e(l.geometries[n],b,g,_,y)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}b++}}function flattenEach(r,e){geomEach(r,function(i,n,o,l,d){var u=i===null?null:i.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return e(feature$2(i,o,{bbox:l,id:d}),n,0)===!1?!1:void 0}var f;switch(u){case"MultiPoint":f="Point";break;case"MultiLineString":f="LineString";break;case"MultiPolygon":f="Polygon";break}for(var g=0;g<i.coordinates.length;g++){var _=i.coordinates[g],y={type:f,coordinates:_};if(e(feature$2(y,o),n,g)===!1)return!1}})}function rewind(r,e){if(e=e||{},!isObject(e))throw new Error("options is invalid");var i=e.reverse||!1,n=e.mutate||!1;if(!r)throw new Error("<geojson> is required");if(typeof i!="boolean")throw new Error("<reverse> must be a boolean");if(typeof n!="boolean")throw new Error("<mutate> must be a boolean");n===!1&&(r=clone(r));var o=[];switch(r.type){case"GeometryCollection":return geomEach(r,function(l){rewindFeature(l,i)}),r;case"FeatureCollection":return featureEach(r,function(l){featureEach(rewindFeature(l,i),function(d){o.push(d)})}),featureCollection(o)}return rewindFeature(r,i)}function rewindFeature(r,e){var i=r.type==="Feature"?r.geometry.type:r.type;switch(i){case"GeometryCollection":return geomEach(r,function(n){rewindFeature(n,e)}),r;case"LineString":return rewindLineString(getCoords(r),e),r;case"Polygon":return rewindPolygon(getCoords(r),e),r;case"MultiLineString":return getCoords(r).forEach(function(n){rewindLineString(n,e)}),r;case"MultiPolygon":return getCoords(r).forEach(function(n){rewindPolygon(n,e)}),r;case"Point":case"MultiPoint":return r}}function rewindLineString(r,e){booleanClockwise(r)===e&&r.reverse()}function rewindPolygon(r,e){booleanClockwise(r[0])!==e&&r[0].reverse();for(var i=1;i<r.length;i++)booleanClockwise(r[i])===e&&r[i].reverse()}function flatten$1(r){if(!r)throw new Error("geojson is required");var e=[];return flattenEach(r,function(i){e.push(i)}),featureCollection(e)}const geoPathInstance=geoPath(),DEFAULT_GEOJSON_OPTIONS={centroid:!1,name:!1,bbox:!1,rewind:!1},MultiToSingle=r=>{if(r.geometry.type.startsWith("Multi")){const e=flatten$1(r).features[0];return Object.assign(Object.assign({},e),e.properties)}return Object.assign(Object.assign({},r),r.properties)},flattenFeature=r=>{const e=[];return r.forEach(i=>{i.type==="FeatureCollection"?i.features.forEach(n=>{e.push(MultiToSingle(n))}):e.push(MultiToSingle(i))}),e},geoJSONParser=(r,e={},i)=>{i.type=DATAVIEW_TYPE.GEO;const n=mergeDeepImmer(DEFAULT_GEOJSON_OPTIONS,e),{centroid:o,name:l,bbox:d,rewind:u}=n;if(Array.isArray(r))return flattenFeature(r);let f=r.features;return u&&(f=rewind(r,{reverse:!isObject$1(u)||u.reverse}).features),f.forEach(g=>{if(o){const _=geoPathInstance.centroid(g);g.centroidX=_[0],g.centroidY=_[1]}if(l&&(g.name=g.properties.name),d){const _=geoPathInstance.bounds(g);g.bbox=_}}),r.features=f,r},DEFAULT_TOPOJSON_OPTIONS={},topoJSONParser=(r,e,i)=>{i.type=DATAVIEW_TYPE.GEO;const n=mergeDeepImmer(DEFAULT_GEOJSON_OPTIONS,DEFAULT_TOPOJSON_OPTIONS,e),{object:o}=n;if(!isString(o))throw new TypeError("Invalid object: must be a string!");const l=feature(r,r.objects[o]);return geoJSONParser(l,n,i)},dataViewParser=(r,e,i)=>{const n=!isBoolean(e==null?void 0:e.dependencyUpdate)||(e==null?void 0:e.dependencyUpdate);if(!r||!isArray(r))throw new TypeError("Invalid data: must be DataView array!");return isArray(i.rawData)&&i.rawData.forEach(o=>{o.target&&(o.target.removeListener("change",i.reRunAllTransform),o.target.removeListener("markRunning",i.markRunning))}),n&&r.forEach(o=>{o.target.addListener("change",i.reRunAllTransform),o.target.addListener("markRunning",i.markRunning)}),r};let idIndex=0;const maxId=1e8;function getUUID(r="dataset"){return idIndex>maxId&&(idIndex=0),r+"_"+idIndex++}class DataSet{constructor(e){var i;let n;this.options=e,this.isDataSet=!0,this.transformMap={},this.parserMap={},this.dataViewMap={},this.target=new EventEmitter,n=e!=null&&e.name?e.name:getUUID("dataset"),this.name=n,this._logger=(i=e==null?void 0:e.logger)!==null&&i!==void 0?i:Logger.getInstance()}setLogger(e){this._logger=e}getDataView(e){return this.dataViewMap[e]}setDataView(e,i){var n;this.dataViewMap[e]&&((n=this._logger)===null||n===void 0||n.error(`Error: dataView ${e} `)),this.dataViewMap[e]=i}removeDataView(e){this.dataViewMap[e]=null,delete this.dataViewMap[e]}registerParser(e,i){var n;this.parserMap[e]&&((n=this._logger)===null||n===void 0||n.warn(`Warn: transform ${e} `)),this.parserMap[e]=i}removeParser(e){this.parserMap[e]=null,delete this.parserMap[e]}getParser(e){return this.parserMap[e]||this.parserMap.default}registerTransform(e,i){var n;this.transformMap[e]&&((n=this._logger)===null||n===void 0||n.warn(`Warn: transform ${e} `)),this.transformMap[e]=i}removeTransform(e){this.transformMap[e]=null,delete this.transformMap[e]}getTransform(e){return this.transformMap[e]}multipleDataViewAddListener(e,i,n){this._callMap||(this._callMap=new Map);let o=this._callMap.get(n);o||(o=()=>{e.some(l=>l.isRunning)||n()}),e.forEach(l=>{l.target.addListener(i,o)}),this._callMap.set(n,o)}allDataViewAddListener(e,i){this.multipleDataViewAddListener(Object.values(this.dataViewMap),e,i)}multipleDataViewRemoveListener(e,i,n){if(this._callMap){const o=this._callMap.get(n);o&&e.forEach(l=>{l.target.removeListener(i,o)}),this._callMap.delete(n)}}multipleDataViewUpdateInParse(e){e.forEach(i=>{var n;return(n=this.getDataView(i.name))===null||n===void 0?void 0:n.markRunning()}),e.forEach(i=>{var n;return(n=this.getDataView(i.name))===null||n===void 0?void 0:n.parseNewData(i.data,i.options)})}multipleDataViewUpdateInRawData(e){e.forEach(i=>{var n;return(n=this.getDataView(i.name))===null||n===void 0?void 0:n.markRunning()}),e.forEach(i=>{var n;return(n=this.getDataView(i.name))===null||n===void 0?void 0:n.updateRawData(i.data,i.options)})}destroy(){this.transformMap=null,this.parserMap=null,this.dataViewMap=null,this._callMap=null,this.target.removeAllListeners()}}const DataViewDiffRank="_data-view-diff-rank";class DataView{constructor(e,i){let n;this.dataSet=e,this.options=i,this.isDataView=!0,this.target=new EventEmitter,this.parseOption=null,this.transformsArr=[],this.isRunning=!1,this.rawData={},this.history=!1,this.parserData={},this.latestData={},this._fields=null,this.reRunAllTransform=(o={pushHistory:!0,emitMessage:!0})=>(this.isRunning=!0,this.resetTransformData(),this.transformsArr.forEach(l=>{this.executeTransform(l,{pushHistory:o.pushHistory,emitMessage:!1}),this.isLastTransform(l)&&this.diffLastData()}),this.isRunning=!1,o.emitMessage!==!1&&this.target.emit("change",[]),this),this.markRunning=()=>{this.isRunning=!0,this.target.emit("markRunning",[])},n=i!=null&&i.name?i.name:getUUID("dataview"),this.name=n,i!=null&&i.history&&(this.history=i.history,this.historyData=[]),this.dataSet.setDataView(n,this),this.setFields(i==null?void 0:i.fields)}parse(e,i,n=!1){var o;this.isRunning=!0,n&&this.target.emit("beforeParse",[]),i&&(this.parseOption=i);const l=this.cloneParseData(e,i);if(i!=null&&i.type){const d=((o=this.dataSet.getParser(i.type))!==null&&o!==void 0?o:this.dataSet.getParser("bytejson"))(l,i.options,this);this.rawData=l,this.parserData=d,this.history&&this.historyData.push(l,d),this.latestData=d}else this.parserData=l,this.rawData=l,this.history&&this.historyData.push(l),this.latestData=l;return this.isRunning=!1,n&&this.target.emit("afterParse",[]),this}transform(e,i=!0){if(this.isRunning=!0,e&&e.type){let n=!0;if(e.type==="fields"){this._fields=e.options.fields;const o=this.transformsArr.findIndex(l=>l.type===e.type);o>=0&&(n=!1,this.transformsArr[o].options.fields=this._fields)}if(n&&this.transformsArr.push(e),i){const o=this.isLastTransform(e);this.executeTransform(e),o&&this.diffLastData()}}return this.sortTransform(),this.isRunning=!1,this}isLastTransform(e){return this.transformsArr[this.transformsArr.length-1]===e}sortTransform(){this.transformsArr.length>=2&&this.transformsArr.sort((e,i)=>{var n,o;return((n=e.level)!==null&&n!==void 0?n:0)-((o=i.level)!==null&&o!==void 0?o:0)})}executeTransform(e,i={pushHistory:!0,emitMessage:!0}){const{pushHistory:n,emitMessage:o}=i,l=this.dataSet.getTransform(e.type)(this.latestData,e.options);this.history&&n!==!1&&this.historyData.push(l),this.latestData=l,o!==!1&&this.target.emit("change",[])}resetTransformData(){this.latestData=this.parserData,this.history&&(this.historyData.length=0,this.historyData.push(this.rawData,this.parserData))}enableDiff(e){this._diffData=!0,this._diffKeys=e,this._diffMap=new Map,this._diffRank=0}disableDiff(){this._diffData=!1,this._diffMap=null,this._diffRank=null}resetDiff(){this._diffMap=new Map,this._diffRank=0}diffLastData(){var e;if(!this._diffData||!this.latestData.forEach||!(!((e=this._diffKeys)===null||e===void 0)&&e.length))return;const i=this._diffRank+1;if(this._diffRank===0)this.latestData.forEach(n=>{n[DataViewDiffRank]=i,this._diffMap.set(this._diffKeys.reduce((o,l)=>o+n[l],""),n)}),this.latestDataAUD={add:Array.from(this.latestData),del:[],update:[]};else{let n;this.latestDataAUD={add:[],del:[],update:[]},this.latestData.forEach(o=>{o[DataViewDiffRank]=i,n=this._diffKeys.reduce((l,d)=>l+o[d],""),this._diffMap.get(n)?this.latestDataAUD.update.push(o):this.latestDataAUD.add.push(o),this._diffMap.set(n,o)}),this._diffMap.forEach((o,l)=>{o[DataViewDiffRank]<i&&(this.latestDataAUD.del.push(o),this._diffMap.delete(l))})}this._diffRank=i}cloneParseData(e,i){let n=!1;return e instanceof DataView||(i==null?void 0:i.clone)!==!0||(n=!0),n?cloneDeep(e):e}parseNewData(e,i){this.parse(e,i||this.parseOption),this.reRunAllTransform()}updateRawData(e,i){const n=this.cloneParseData(e,i);this.rawData=n,this.parserData=n,this.latestData=n,this.reRunAllTransform()}getFields(){var e;return this._fields?this._fields:((e=this.parseOption)===null||e===void 0?void 0:e.type)==="dataview"&&this.rawData.length===1&&this.rawData[0].getFields?this.rawData[0].getFields():null}setFields(e,i=!1){this._fields=e&&i?merge$1({},this._fields,e):e;const n=this.transformsArr.find(o=>o.type==="fields");!isNil(this._fields)&&isNil(n)?(this.dataSet.registerTransform("fields",fields),this.transform({type:"fields",options:{fields:this._fields}},!1)):n&&(n.options.fields=this._fields)}destroy(){this.dataSet.removeDataView(this.name),this._diffMap=null,this._diffRank=null,this.latestData=null,this.rawData=null,this.parserData=null,this.transformsArr=null,this.target=null}}class Generator{static GenAutoIncrementId(){return Generator.auto_increment_id++}}Generator.auto_increment_id=0;class ContainerModule{constructor(e){this.id=Generator.GenAutoIncrementId(),this.registry=e}}const NAMED_TAG="named",INJECT_TAG="inject",MULTI_INJECT_TAG="multi_inject",TAGGED="inversify:tagged",PARAM_TYPES="inversify:paramtypes";class Metadata{constructor(e,i){this.key=e,this.value=i}toString(){return this.key===NAMED_TAG?`named: ${String(this.value).toString()} `:`tagged: { key:${this.key.toString()}, value: ${String(this.value)} }`}}const Reflect$1=function(r){var e;return function(i){const n=typeof Symbol=="function",o=n&&Symbol.toPrimitive!==void 0?Symbol.toPrimitive:"@@toPrimitive",l=Object.getPrototypeOf(Function),d=Map,u=new WeakMap;function f(F,$,G,Y){if(!L(G))throw new TypeError;return T(F,$,G,Y)}function g(F,$,G){if(!L($))throw new TypeError;return E(G)||(G=O(G)),S(F,$,G)}function _(F,$,G){if(!L($))throw new TypeError;return E(G)||(G=O(G)),v(F,$,G)}function y(F,$,G){if(!L($))throw new TypeError;return E(G)||(G=O(G)),A(F,$,G)}function b(F,$,G){let Y=u.get(F);if(E(Y)){if(!G)return;Y=new d,u.set(F,Y)}let Q=Y.get($);if(E(Q)){if(!G)return;Q=new d,Y.set($,Q)}return Q}function S(F,$,G){if(v(F,$,G))return!0;const Y=H($);return!P(Y)&&S(F,Y,G)}function v(F,$,G){const Y=b($,G,!1);return!E(Y)&&I(Y.has(F))}function A(F,$,G){if(v(F,$,G))return x(F,$,G);const Y=H($);return P(Y)?void 0:A(F,Y,G)}function x(F,$,G){const Y=b($,G,!1);if(!E(Y))return Y.get(F)}function T(F,$,G,Y){b(G,Y,!0).set(F,$)}function C(F){if(F===null)return 1;switch(typeof F){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return F===null?1:6;default:return 6}}function E(F){return F===void 0}function P(F){return F===null}function R(F){return typeof F=="symbol"}function L(F){return typeof F=="object"?F!==null:typeof F=="function"}function w(F,$){switch(C(F)){case 0:case 1:case 2:case 3:case 4:case 5:return F}const G="string",Y=V(F,o);if(Y!==void 0){const Q=Y.call(F,G);if(L(Q))throw new TypeError;return Q}return B(F)}function B(F,$){{const G=F.toString;if(N(G)){const Q=G.call(F);if(!L(Q))return Q}const Y=F.valueOf;if(N(Y)){const Q=Y.call(F);if(!L(Q))return Q}}throw new TypeError}function I(F){return!!F}function D(F){return""+F}function O(F){const $=w(F);return R($)?$:D($)}function N(F){return typeof F=="function"}function V(F,$){const G=F[$];if(G!=null){if(!N(G))throw new TypeError;return G}}function H(F){const $=Object.getPrototypeOf(F);if(typeof F!="function"||F===l||$!==l)return $;const G=F.prototype,Y=G&&Object.getPrototypeOf(G);if(Y==null||Y===Object.prototype)return $;const Q=Y.constructor;return typeof Q!="function"||Q===F?$:Q}i("defineMetadata",f),i("hasMetadata",g),i("hasOwnMetadata",_),i("getMetadata",y)}((e=r,function(i,n){typeof e[i]!="function"&&Object.defineProperty(e,i,{configurable:!0,writable:!0,value:n})})),r}({});function _tagParameterOrProperty(r,e,i,n){const o=[n];let l={};Reflect$1.hasOwnMetadata(r,e)&&(l=Reflect$1.getMetadata(r,e));let d=l[i];d===void 0&&(d=[]),d.push(...o),l[i]=d,Reflect$1.defineMetadata(r,l,e)}function tagParameter(r,e,i,n){_tagParameterOrProperty(TAGGED,r,i.toString(),n)}function createTaggedDecorator(r){return(e,i,n)=>{tagParameter(e,i,n,r)}}function injectBase(r){return e=>(i,n,o)=>createTaggedDecorator(new Metadata(r,e))(i,n,o)}const inject=injectBase(INJECT_TAG),multiInject=injectBase(MULTI_INJECT_TAG);function injectable(){return function(r){return Reflect$1.defineMetadata(PARAM_TYPES,null,r),r}}function named(r){return createTaggedDecorator(new Metadata(NAMED_TAG,r))}const BindingScopeEnum={Singleton:"Singleton",Transient:"Transient"},BindingTypeEnum={ConstantValue:"ConstantValue",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid"};class Binding{constructor(e,i){this.id=Generator.GenAutoIncrementId(),this.activated=!1,this.serviceIdentifier=e,this.scope=i,this.type=BindingTypeEnum.Invalid,this.constraint=n=>!0,this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.dynamicValue=null}clone(){const e=new Binding(this.serviceIdentifier,this.scope);return e.activated=e.scope===BindingScopeEnum.Singleton&&this.activated,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.provider=this.provider,e.constraint=this.constraint,e.cache=this.cache,e}}class MetadataReader{getConstructorMetadata(e){return{compilerGeneratedMetadata:Reflect$1.getMetadata(PARAM_TYPES,e),userGeneratedMetadata:Reflect$1.getMetadata(TAGGED,e)||{}}}getPropertiesMetadata(e){throw new Error("")}}const taggedConstraint=r=>e=>{const i=n=>{if(n==null)return!1;if(n.key===r&&n.value===e)return!0;if(n.constructorArgsMetadata==null)return!1;const o=n.constructorArgsMetadata;for(let l=0;l<o.length;l++)if(o[l].key===r&&o[l].value===e)return!0;return!1};return i.metaData=new Metadata(r,e),i},namedConstraint=taggedConstraint(NAMED_TAG);class BindingInSyntax{constructor(e){this._binding=e}inRequestScope(){throw new Error("")}inSingletonScope(){return this._binding.scope=BindingScopeEnum.Singleton,this}inTransientScope(){return this._binding.scope=BindingScopeEnum.Transient,this}whenTargetNamed(e){return this._binding.constraint=namedConstraint(e),this}}class BindingToSyntax{constructor(e){this._binding=e}to(e){return this._binding.type=BindingTypeEnum.Instance,this._binding.implementationType=e,new BindingInSyntax(this._binding)}toSelf(){const e=this._binding.serviceIdentifier;return this.to(e)}toDynamicValue(e){return this._binding.type=BindingTypeEnum.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new BindingInSyntax(this._binding)}toConstantValue(e){return this._binding.type=BindingTypeEnum.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=BindingScopeEnum.Singleton,new BindingInSyntax(this._binding)}toFactory(e){return this._binding.type=BindingTypeEnum.Factory,this._binding.factory=e,this._binding.scope=BindingScopeEnum.Singleton,new BindingInSyntax(this._binding)}toService(e){this.toDynamicValue(i=>i.container.get(e))}}class Container{constructor(e){const i=e||{};i.defaultScope=i.defaultScope||BindingScopeEnum.Transient,this.options=i,this.id=Generator.GenAutoIncrementId(),this._bindingDictionary=new Map,this._metadataReader=new MetadataReader}load(e){const i=this._getContainerModuleHelpersFactory()(e.id);e.registry(i.bindFunction,i.unbindFunction,i.isboundFunction,i.rebindFunction)}get(e){const i=this._getNotAllArgs(e,!1);return this._get(i)}getAll(e){const i=this._getAllArgs(e);return this._get(i)}getTagged(e,i,n){const o=this._getNotAllArgs(e,!1,i,n);return this._get(o)}getNamed(e,i){return this.getTagged(e,NAMED_TAG,i)}isBound(e){return this._bindingDictionary.has(e)}bind(e){const i=this.options.defaultScope,n=new Binding(e,i),o=this._bindingDictionary.get(e)||[];return o.push(n),this._bindingDictionary.set(e,o),new BindingToSyntax(n)}unbind(e){this._bindingDictionary.delete(e)}rebind(e){return this.unbind(e),this.bind(e)}_getContainerModuleHelpersFactory(){const e=(d,u)=>{d._binding.moduleId=u},i=d=>u=>{const f=this.bind(u);return e(f,d),f},n=()=>d=>this.unbind(d),o=()=>d=>this.isBound(d),l=d=>u=>{const f=this.rebind(u);return e(f,d),f};return d=>({bindFunction:i(d),isboundFunction:o(),rebindFunction:l(d),unbindFunction:n(),unbindAsyncFunction:u=>null})}_getNotAllArgs(e,i,n,o){return{avoidConstraints:!1,isMultiInject:i,serviceIdentifier:e,key:n,value:o}}_getAllArgs(e){return{avoidConstraints:!0,isMultiInject:!0,serviceIdentifier:e}}_get(e){const i=[];return this._bindingDictionary.get(e.serviceIdentifier).filter(n=>n.constraint(e)).forEach(n=>{i.push(this._resolveFromBinding(n))}),e.isMultiInject||i.length!==1?i:i[0]}_getChildRequest(e){const i=e.implementationType,{userGeneratedMetadata:n}=this._metadataReader.getConstructorMetadata(i),o=Object.keys(n),l=[];for(let d=0;d<o.length;d++){const u=n[d],f={};u.forEach(S=>{f[S.key]=S.value});const g={inject:f[INJECT_TAG],multiInject:f[MULTI_INJECT_TAG]},_=g.inject||g.multiInject,y={serviceIdentifier:_,constructorArgsMetadata:u},b={injectIdentifier:_,metadata:u,bindings:this._bindingDictionary.get(_).filter(S=>S.constraint(y))};l.push(b)}return l}_resolveFromBinding(e){const i=this._getResolvedFromBinding(e);return this._saveToScope(e,i),i}_getResolvedFromBinding(e){let i;switch(e.type){case BindingTypeEnum.ConstantValue:case BindingTypeEnum.Function:i=e.cache;break;case BindingTypeEnum.Instance:i=this._resolveInstance(e,e.implementationType);break;default:i=e.dynamicValue({container:this})}return i}_resolveInstance(e,i){if(e.activated)return e.cache;const n=this._getChildRequest(e);return this._createInstance(i,n)}_createInstance(e,i){return i.length?new e(...this._resolveRequests(i)):new e}_resolveRequests(e){return e.map(i=>i.bindings.length>1?i.bindings.map(n=>this._resolveFromBinding(n)):this._resolveFromBinding(i.bindings[0]))}_saveToScope(e,i){e.scope===BindingScopeEnum.Singleton&&(e.cache=i,e.activated=!0)}}const ContributionProvider=Symbol("ContributionProvider");class ContributionProviderCache{constructor(e,i){this.serviceIdentifier=e,this.container=i}getContributions(){return this.caches||(this.caches=[],this.container&&this.container.isBound(this.serviceIdentifier)&&this.caches.push(...this.container.getAll(this.serviceIdentifier))),this.caches}}function bindContributionProvider(r,e){r(ContributionProvider).toDynamicValue(({container:i})=>new ContributionProviderCache(e,i)).inSingletonScope().whenTargetNamed(e)}function bindContributionProviderNoSingletonScope(r,e){r(ContributionProvider).toDynamicValue(({container:i})=>new ContributionProviderCache(e,i)).whenTargetNamed(e)}class Hook{constructor(e,i){this._args=e,this.name=i,this.taps=[]}tap(e,i){this._tap("sync",e,i)}unTap(e,i){const n=typeof e=="string"?e.trim():e.name;n&&(this.taps=this.taps.filter(o=>!(o.name===n&&(!i||o.fn===i))))}_parseOptions(e,i,n){let o;if(typeof i=="string")o={name:i.trim()};else if(typeof i!="object"||i===null)throw new Error("Invalid tap options");if(typeof o.name!="string"||o.name==="")throw new Error("Missing name for tap");return o=Object.assign({type:e,fn:n},o),o}_tap(e,i,n){this._insert(this._parseOptions(e,i,n))}_insert(e){let i;typeof e.before=="string"?i=new Set([e.before]):Array.isArray(e.before)&&(i=new Set(e.before));let n=0;typeof e.stage=="number"&&(n=e.stage);let o=this.taps.length;for(;o>0;){o--;const l=this.taps[o];this.taps[o+1]=l;const d=l.stage||0;if(i){if(i.has(l.name)){i.delete(l.name);continue}if(i.size>0)continue}if(!(d>n)){o++;break}}this.taps[o]=e}}class SyncHook extends Hook{call(...e){this.taps.map(i=>i.fn).forEach(i=>i(...e))}}const EnvContribution=Symbol.for("EnvContribution"),VGlobal=Symbol.for("VGlobal");var __decorate$1b=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$T=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$H=function(r,e){return function(i,n){e(i,n,r)}},__awaiter$9=function(r,e,i,n){return new(i||(i=Promise))(function(o,l){function d(g){try{f(n.next(g))}catch(_){l(_)}}function u(g){try{f(n.throw(g))}catch(_){l(_)}}function f(g){var _;g.done?o(g.value):(_=g.value,_ instanceof i?_:new i(function(y){y(_)})).then(d,u)}f((n=n.apply(r,e||[])).next())})};let DefaultGlobal=class{get env(){return this._env}get isImageAnonymous(){return this._isImageAnonymous}set isImageAnonymous(r){this._isImageAnonymous=r}get devicePixelRatio(){return this._env||this.setEnv("browser"),this.envContribution.getDevicePixelRatio()}get supportEvent(){return this._env||this.setEnv("browser"),this.envContribution.supportEvent}set supportEvent(r){this._env||this.setEnv("browser"),this.envContribution.supportEvent=r}get supportsTouchEvents(){return this._env||this.setEnv("browser"),this.envContribution.supportsTouchEvents}set supportsTouchEvents(r){this._env||this.setEnv("browser"),this.envContribution.supportsTouchEvents=r}get supportsPointerEvents(){return this._env||this.setEnv("browser"),this.envContribution.supportsPointerEvents}set supportsPointerEvents(r){this._env||this.setEnv("browser"),this.envContribution.supportsPointerEvents=r}get supportsMouseEvents(){return this._env||this.setEnv("browser"),this.envContribution.supportsMouseEvents}set supportsMouseEvents(r){this._env||this.setEnv("browser"),this.envContribution.supportsMouseEvents=r}get applyStyles(){return this._env||this.setEnv("browser"),this.envContribution.applyStyles}set applyStyles(r){this._env||this.setEnv("browser"),this.envContribution.applyStyles=r}constructor(r){this.contributions=r,this._isImageAnonymous=!0,this.id=Generator.GenAutoIncrementId(),this.hooks={onSetEnv:new SyncHook(["lastEnv","env","global"])},this.measureTextMethod="native",this.optimizeVisible=!1}bindContribution(r){const e=[];if(this.contributions.getContributions().forEach(i=>{const n=i.configure(this,r);n&&n.then&&e.push(n)}),e.length)return Promise.all(e)}getDynamicCanvasCount(){return this._env||this.setEnv("browser"),this.envContribution.getDynamicCanvasCount()}getStaticCanvasCount(){return this._env||this.setEnv("browser"),this.envContribution.getStaticCanvasCount()}setEnv(r,e){if(e&&e.force===!0||this._env!==r)return this.deactiveCurrentEnv(),this.activeEnv(r,e)}deactiveCurrentEnv(){this.envContribution&&this.envContribution.release()}activeEnv(r,e){const i=this._env;this._env=r;const n=this.bindContribution(e);if(n&&n.then)return n.then(()=>{this.envParams=e,this.hooks.onSetEnv.call(i,r,this)});this.envParams=e,this.hooks.onSetEnv.call(i,r,this)}setActiveEnvContribution(r){this.envContribution=r}createCanvas(r){return this._env||this.setEnv("browser"),this.envContribution.createCanvas(r)}createOffscreenCanvas(r){return this._env||this.setEnv("browser"),this.envContribution.createOffscreenCanvas(r)}releaseCanvas(r){return this._env||this.setEnv("browser"),this.envContribution.releaseCanvas(r)}addEventListener(r,e,i){return this._env||this.setEnv("browser"),this.envContribution.addEventListener(r,e,i)}removeEventListener(r,e,i){return this._env||this.setEnv("browser"),this.envContribution.removeEventListener(r,e,i)}dispatchEvent(r){return this._env||this.setEnv("browser"),this.envContribution.dispatchEvent(r)}getRequestAnimationFrame(){return this._env||this.setEnv("browser"),this.envContribution.getRequestAnimationFrame()}getCancelAnimationFrame(){return this._env||this.setEnv("browser"),this.envContribution.getCancelAnimationFrame()}getElementById(r){return this._env||this.setEnv("browser"),this.envContribution.getElementById?this.envContribution.getElementById(r):null}getRootElement(){return this._env||this.setEnv("browser"),this.envContribution.getRootElement?this.envContribution.getRootElement():null}getDocument(){return this._env||this.setEnv("browser"),this.envContribution.getDocument?this.envContribution.getDocument():null}mapToCanvasPoint(r,e){return this._env||this.setEnv("browser"),this.envContribution.mapToCanvasPoint?this.envContribution.mapToCanvasPoint(r,e):null}loadImage(r){return this._env||this.setEnv("browser"),this.envContribution.loadImage(r)}loadSvg(r){return this._env||this.setEnv("browser"),this.envContribution.loadSvg(r)}loadJson(r){return this._env||this.setEnv("browser"),this.envContribution.loadJson(r)}loadArrayBuffer(r){return this._env||this.setEnv("browser"),this.envContribution.loadArrayBuffer(r)}loadBlob(r){return this._env||this.setEnv("browser"),this.envContribution.loadBlob(r)}loadFont(r,e,i){return __awaiter$9(this,void 0,void 0,function*(){return this._env||this.setEnv("browser"),this.envContribution.loadFont(r,e,i)})}isChrome(){return this._isChrome!=null||(this._env||this.setEnv("browser"),this._isChrome=this._env==="browser"&&navigator.userAgent.indexOf("Chrome")>-1),this._isChrome}isSafari(){return this._isSafari!=null||(this._env||this.setEnv("browser"),this._isSafari=this._env==="browser"&&/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)),this._isSafari}getNativeAABBBounds(r){return this._env||this.setEnv("browser"),this.envContribution.getNativeAABBBounds(r)}removeDom(r){return this._env||this.setEnv("browser"),this.envContribution.removeDom(r)}createDom(r){return this._env||this.setEnv("browser"),this.envContribution.createDom(r)}updateDom(r,e){return this._env||this.setEnv("browser"),this.envContribution.updateDom(r,e)}getElementTop(r,e=!1){return this._env||this.setEnv("browser"),this.envContribution.getElementTop(r,e)}getElementLeft(r,e=!1){return this._env||this.setEnv("browser"),this.envContribution.getElementLeft(r,e)}getElementTopLeft(r,e=!1){return this._env||this.setEnv("browser"),this.envContribution.getElementTopLeft(r,e)}};DefaultGlobal=__decorate$1b([injectable(),__param$H(0,inject(ContributionProvider)),__param$H(0,named(EnvContribution)),__metadata$T("design:paramtypes",[Object])],DefaultGlobal);var MeasureModeEnum;(function(r){r[r.estimate=0]="estimate",r[r.actualBounding=1]="actualBounding",r[r.fontBounding=2]="fontBounding"})(MeasureModeEnum||(MeasureModeEnum={}));const circleThreshold=tau$1-1e-8;class BoundsContext{constructor(e){this.init(e)}init(e){this.bounds=e}arc(e,i,n,o,l,d){if(Math.abs(l-o)>circleThreshold)return this.bounds.add(e-n,i-n),void this.bounds.add(e+n,i+n);let u,f,g,_,y=1/0,b=-1/0,S=1/0,v=-1/0;function A(x){g=n*Math.cos(x),_=n*Math.sin(x),g<y&&(y=g),g>b&&(b=g),_<S&&(S=_),_>v&&(v=_)}if(A(o),A(l),l!==o)if((o%=tau$1)<0&&(o+=tau$1),(l%=tau$1)<0&&(l+=tau$1),l<o&&(d=!d,u=o,o=l,l=u),d)for(l-=tau$1,u=o-o%halfPi$2,f=0;f<4&&u>l;++f,u-=halfPi$2)A(u);else for(u=o-o%halfPi$2+halfPi$2,f=0;f<4&&u<l;++f,u+=halfPi$2)A(u);this.bounds.add(e+y,i+S),this.bounds.add(e+b,i+v)}arcTo(e,i,n,o,l){this.bounds.add(e,i)}bezierCurveTo(e,i,n,o,l,d){this.bounds.add(e,i),this.bounds.add(n,o),this.bounds.add(l,d)}closePath(){}ellipse(){throw new Error("ellipse")}lineTo(e,i){this.bounds.add(e,i)}moveTo(e,i){this.bounds.add(e,i)}quadraticCurveTo(e,i,n,o){this.bounds.add(e,i),this.bounds.add(n,o)}rect(e,i,n,o){this.bounds.add(e,i),this.bounds.add(e+n,i+o)}clear(){this.bounds.clear()}release(...e){}}class CurvePath{constructor(){this.curves=[],this.bounds=new AABBBounds}getCurveLengths(){return this.curves.map(e=>e.getLength())}getPointAt(e){return{x:0,y:0}}getLength(){return 0}getBounds(){return this.bounds}}const rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,commandLengths={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,M:2,L:2,H:1,V:1,C:6,S:4,Q:4,T:2,A:7},enumCommandMap={A:0,AT:1,C:2,Z:3,E:4,L:5,M:6,Q:7,R:8};let currPath,coordsStr,commandChar,coordStr,coordNumber,standardCommandLen;function parseSvgPath(r){if(!r)return[];const e=r.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);if(e===null)return[];let i,n;const o=[];for(let l=0,d=e.length;l<d;l++)if(currPath=e[l],coordsStr=currPath.slice(1),commandChar=currPath[0],i=[commandChar],n=coordsStr.match(rePathCommand),n!==null){for(let u=0,f=n.length;u<f;u++)coordStr=n[u],coordNumber=parseFloat(coordStr),Number.isNaN(coordNumber)||i.push(coordNumber);if(standardCommandLen=commandLengths[commandChar],i.length-1>standardCommandLen){let u,f=commandChar;for(let g=1,_=i.length;g<_;g+=standardCommandLen){u=[f];for(let y=g,b=g+standardCommandLen;y<b;y++)u.push(i[y]);o.push(u),f==="m"?f="l":f==="M"&&(f="L")}}else o.push(i)}else o.push(i);return o}var UpdateTag;(function(r){r[r.NONE=0]="NONE",r[r.UPDATE_BOUNDS=1]="UPDATE_BOUNDS",r[r.UPDATE_SHAPE=2]="UPDATE_SHAPE",r[r.CLEAR_SHAPE=253]="CLEAR_SHAPE",r[r.UPDATE_SHAPE_AND_BOUNDS=3]="UPDATE_SHAPE_AND_BOUNDS",r[r.INIT=179]="INIT",r[r.CLEAR_BOUNDS=254]="CLEAR_BOUNDS",r[r.UPDATE_GLOBAL_MATRIX=32]="UPDATE_GLOBAL_MATRIX",r[r.CLEAR_GLOBAL_MATRIX=223]="CLEAR_GLOBAL_MATRIX",r[r.UPDATE_LOCAL_MATRIX=16]="UPDATE_LOCAL_MATRIX",r[r.CLEAR_LOCAL_MATRIX=239]="CLEAR_LOCAL_MATRIX",r[r.UPDATE_GLOBAL_LOCAL_MATRIX=48]="UPDATE_GLOBAL_LOCAL_MATRIX",r[r.UPDATE_LAYOUT=128]="UPDATE_LAYOUT",r[r.CLEAR_LAYOUT=127]="CLEAR_LAYOUT"})(UpdateTag||(UpdateTag={}));var IContainPointMode;(function(r){r[r.GLOBAL=1]="GLOBAL",r[r.LOCAL=16]="LOCAL",r[r.GLOBAL_ACCURATE=3]="GLOBAL_ACCURATE",r[r.LOCAL_ACCURATE=48]="LOCAL_ACCURATE"})(IContainPointMode||(IContainPointMode={}));var AttributeUpdateType;(function(r){r[r.INIT=0]="INIT",r[r.DEFAULT=1]="DEFAULT",r[r.STATE=2]="STATE",r[r.ANIMATE_BIND=10]="ANIMATE_BIND",r[r.ANIMATE_PLAY=11]="ANIMATE_PLAY",r[r.ANIMATE_START=12]="ANIMATE_START",r[r.ANIMATE_UPDATE=13]="ANIMATE_UPDATE",r[r.ANIMATE_END=14]="ANIMATE_END",r[r.TRANSLATE=20]="TRANSLATE",r[r.TRANSLATE_TO=21]="TRANSLATE_TO",r[r.SCALE=22]="SCALE",r[r.SCALE_TO=23]="SCALE_TO",r[r.ROTATE=24]="ROTATE",r[r.ROTATE_TO=25]="ROTATE_TO"})(AttributeUpdateType||(AttributeUpdateType={}));var AnimateStatus;(function(r){r[r.INITIAL=0]="INITIAL",r[r.RUNNING=1]="RUNNING",r[r.PAUSED=2]="PAUSED",r[r.END=3]="END"})(AnimateStatus||(AnimateStatus={}));var AnimateMode;(function(r){r[r.NORMAL=0]="NORMAL",r[r.SET_ATTR_IMMEDIATELY=1]="SET_ATTR_IMMEDIATELY"})(AnimateMode||(AnimateMode={}));var AnimateStepType;(function(r){r.wait="wait",r.from="from",r.to="to",r.customAnimate="customAnimate"})(AnimateStepType||(AnimateStepType={}));var Direction$1;(function(r){r[r.ROW=1]="ROW",r[r.COLUMN=2]="COLUMN"})(Direction$1||(Direction$1={}));var CurveTypeEnum;(function(r){r[r.CubicBezierCurve=0]="CubicBezierCurve",r[r.QuadraticBezierCurve=1]="QuadraticBezierCurve",r[r.ArcCurve=2]="ArcCurve",r[r.LineCurve=3]="LineCurve",r[r.EllipseCurve=4]="EllipseCurve",r[r.MoveCurve=5]="MoveCurve"})(CurveTypeEnum||(CurveTypeEnum={}));var BaseRenderContributionTime;(function(r){r[r.beforeFillStroke=0]="beforeFillStroke",r[r.afterFillStroke=1]="afterFillStroke"})(BaseRenderContributionTime||(BaseRenderContributionTime={}));function segments(r,e,i,n,o,l,d,u,f){const g=degreeToRadian(d),_=Math.sin(g),y=Math.cos(g),b=y*(u-r)*.5+_*(f-e)*.5,S=y*(f-e)*.5-_*(u-r)*.5;let v=b*b/((i=Math.abs(i))*i)+S*S/((n=Math.abs(n))*n);v>1&&(v=Math.sqrt(v),i*=v,n*=v);const A=y/i,x=_/i,T=-_/n,C=y/n,E=A*u+x*f,P=T*u+C*f,R=A*r+x*e,L=T*r+C*e;let w=1/((R-E)*(R-E)+(L-P)*(L-P))-.25;w<0&&(w=0);let B=Math.sqrt(w);l===o&&(B=-B);const I=.5*(E+R)-B*(L-P),D=.5*(P+L)+B*(R-E),O=Math.atan2(P-D,E-I);let N=Math.atan2(L-D,R-I)-O;N<0&&l===1?N+=tau$1:N>0&&l===0&&(N-=tau$1);const V=Math.ceil(Math.abs(N/(halfPi$2+.001))),H=[];for(let F=0;F<V;++F){const $=O+F*N/V,G=O+(F+1)*N/V;H[F]=[I,D,$,G,i,n,_,y]}return H}function bezier(r){const e=r[0],i=r[1],n=r[2],o=r[3],l=r[4],d=r[5],u=r[6],f=r[7],g=f*l,_=-u*d,y=u*l,b=f*d,S=Math.cos(n),v=Math.sin(n),A=Math.cos(o),x=Math.sin(o),T=.5*(o-n),C=Math.sin(.5*T),E=8/3*C*C/Math.sin(T),P=e+S-E*v,R=i+v+E*S,L=e+A,w=i+x,B=L+E*x,I=w-E*A;return[g*P+_*R,y*P+b*R,g*B+_*I,y*B+b*I,g*L+_*w,y*L+b*w]}function drawArc(r,e,i,n){const o=segments(n[5],n[6],n[0],n[1],n[3],n[4],n[2],e,i);for(let l=0;l<o.length;++l){const d=bezier(o[l]);r.bezierCurveTo(d[0],d[1],d[2],d[3],d[4],d[5])}}const addArcToBezierPath$1=(r,e,i,n,o,l,d)=>{const u=Math.abs(i-e),f=u>.5*Math.PI?Math.ceil(2*u/Math.PI):1,g=(i-e)/f;for(let _=0;_<f;_++){const y=e+g*_,b=e+g*(_+1),S=4*Math.tan(Math.abs(g)/4)/3,v=b<y?-1:1,A=Math.cos(y),x=Math.sin(y),T=Math.cos(b),C=Math.sin(b),E=A*l+n,P=x*d+o,R=T*l+n,L=C*d+o,w=l*S*v,B=d*S*v;r.push(E-w*x,P+B*A,R+w*C,L-B*T,R,L)}},commandFuncs=[(r,e,i,n,o,l,d)=>e.arc(r[1]*o+i,r[2]*l+n,r[3]*(o+l)/2,r[4],r[5],r[6],d),(r,e,i,n,o,l,d)=>e.arcTo(r[1]*o+i,r[2]*l+n,r[3]*o+i,r[4]*l+n,r[5]*(o+l)/2,d),(r,e,i,n,o,l,d)=>e.bezierCurveTo(r[1]*o+i,r[2]*l+n,r[3]*o+i,r[4]*l+n,r[5]*o+i,r[6]*l+n,d),(r,e,i,n)=>e.closePath(),(r,e,i,n,o,l)=>e.ellipse(r[1]*o+i,r[2]*l+n,r[3]*o,r[4]*l,r[5],r[6],r[7],r[8]),(r,e,i,n,o,l,d)=>e.lineTo(r[1]*o+i,r[2]*l+n,d),(r,e,i,n,o,l,d)=>e.moveTo(r[1]*o+i,r[2]*l+n,d),(r,e,i,n,o,l,d)=>e.quadraticCurveTo(r[1]*o+i,r[2]*l+n,r[3]*o+i,r[4]*l+n,d),(r,e,i,n,o,l,d)=>e.rect(r[1]*o+i,r[2]*l+n,r[3]*o,r[4]*l,d)];function renderCommandList(r,e,i=0,n=0,o=1,l=1,d){for(let u=0;u<r.length;u++){const f=r[u];commandFuncs[f[0]](f,e,i,n,o,l,d)}}class Curve{getLength(e){return e!=null?this.calcProjLength(e):(Number.isFinite(this.length)||(this.length=this.calcLength()),this.length)}}function snapLength(r,e){let i=0;const n=r.length;for(let o=0;o<n;o++){const l=r[o],d=e[o],u=r[(o+1)%n],f=e[(o+1)%n];i+=PointService.distanceNN(l,d,u,f)}return i/2}function cubicLength(r,e,i,n,o){return snapLength([r.x,e.x,i.x,n.x],[r.y,e.y,i.y,n.y])}function cubicCalc(r,e,i,n,o){const l=1-o;return l*l*l*r+3*e*o*l*l+3*i*o*o*l+n*o*o*o}function cubicPointAt(r,e,i,n,o){const l=cubicCalc(r.x,e.x,i.x,n.x,o),d=cubicCalc(r.y,e.y,i.y,n.y,o);return new Point(l,d)}function divideCubic(r,e){const{p0:i,p1:n,p2:o,p3:l}=r,d=cubicPointAt(i,n,o,l,e),u=PointService.pointAtPP(i,n,e),f=PointService.pointAtPP(n,o,e),g=PointService.pointAtPP(o,l,e),_=PointService.pointAtPP(u,f,e),y=PointService.pointAtPP(f,g,e);return[new CubicBezierCurve(i,u,_,d),new CubicBezierCurve(d,y,g,l)]}class CubicBezierCurve extends Curve{constructor(e,i,n,o){super(),this.type=CurveTypeEnum.CubicBezierCurve,this.p0=e,this.p1=i,this.p2=n,this.p3=o}_validPoint(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y+this.p2.x+this.p2.y+this.p3.x+this.p3.y)}getPointAt(e){if(this.defined!==!1)return cubicPointAt(this.p0,this.p1,this.p2,this.p3,e);throw new Error("definedfalsegetPointAt")}calcLength(){return this._validPoint()?cubicLength(this.p0,this.p1,this.p2,this.p3):60}calcProjLength(e){return e===Direction$1.ROW?abs$1(this.p0.x-this.p3.x):e===Direction$1.COLUMN?abs$1(this.p0.y-this.p3.y):0}getAngleAt(e){const i=max$1(e-.01,0),n=min$1(e+.01,1),o=this.getPointAt(i),l=this.getPointAt(n);return atan2$1(l.y-o.y,l.x-o.x)}}function divideLinear(r,e){const{p0:i,p1:n}=r,o=PointService.pointAtPP(i,n,e);return[new LineCurve(i,o),new LineCurve(o,n)]}class LineCurve extends Curve{constructor(e,i){super(),this.type=CurveTypeEnum.LineCurve,this.p0=e,this.p1=i}getPointAt(e){if(this.defined!==!1)return PointService.pointAtPP(this.p0,this.p1,e);throw new Error("definedfalsegetPointAt")}getAngleAt(e){return this.angle==null&&(this.angle=atan2$1(this.p1.y-this.p0.y,this.p1.x-this.p0.x)),this.angle}_validPoint(){return Number.isFinite(this.p0.x+this.p0.y+this.p1.x+this.p1.y)}calcLength(){return this._validPoint()?PointService.distancePP(this.p0,this.p1):60}calcProjLength(e){return e===Direction$1.ROW?abs$1(this.p0.x-this.p1.x):e===Direction$1.COLUMN?abs$1(this.p0.y-this.p1.y):0}}class SegContext{get endX(){return this._lastX}get endY(){return this._lastY}constructor(e,i){this.init(e,i)}init(e,i){this._lastX=this._lastY=this._startX=this._startY=0,this.curveType=e,this.direction=i,this.curves=[]}bezierCurveTo(e,i,n,o,l,d,u,f){const g=new CubicBezierCurve(new Point(this._lastX,this._lastY),new Point(e,i),new Point(n,o),new Point(l,d));g.originP1=this._lastOriginP,g.originP2=f,g.defined=u,this.curves.push(g),this._lastX=l,this._lastY=d,this._lastOriginP=f}closePath(){if(this.curves.length<2)return;const e=this.curves[this.curves.length-1];this.lineTo(this._startX,this._startY,e.defined,this._startOriginP)}ellipse(){throw new Error("SegContextellipse")}lineTo(e,i,n,o){const l=this.addLinearCurve(e,i,n,this._lastOriginP,o);this.curves.push(l),this._lastX=e,this._lastY=i,this._lastOriginP=o}moveTo(e,i,n){return this._lastX=this._startX=e,this._lastY=this._startY=i,this._lastOriginP=n,this._startOriginP=n,this}quadraticCurveTo(e,i,n,o){throw new Error("SegContextquadraticCurveTo")}clear(){this.curves=[],this.length=NaN}tryUpdateLength(e){return this.getLength(e)}addLinearCurve(e,i,n,o,l){const d=new LineCurve(new Point(this._lastX,this._lastY),new Point(e,i));return d.originP1=o,d.originP2=l,d.defined=n,d}getPointAt(e){throw new Error("")}getCurveLengths(){return[]}getLength(e){var i,n;if(e===Direction$1.COLUMN){if(!this.curves.length)return 0;const o=this.curves[0],l=this.curves[this.curves.length-1],d=(i=l.p3)!==null&&i!==void 0?i:l.p1;return abs$1(o.p0.y-d.y)}if(e===Direction$1.ROW){if(!this.curves.length)return 0;const o=this.curves[0],l=this.curves[this.curves.length-1],d=(n=l.p3)!==null&&n!==void 0?n:l.p1;return abs$1(o.p0.x-d.x)}return Number.isFinite(this.length)||(this.length=this.curves.reduce((o,l)=>o+l.getLength(),0)),this.length}}class ReflectSegContext extends SegContext{bezierCurveTo(e,i,n,o,l,d,u,f){return super.bezierCurveTo(i,e,o,n,d,l,u,f)}lineTo(e,i,n,o){return super.lineTo(i,e,n,o)}moveTo(e,i,n){return super.moveTo(i,e,n)}clear(){return super.clear()}}function genCurveSegments(r,e,i=1){let n=!1;for(let o=0,l=e.length;o<=l;o++)o>=l===n&&((n=!n)?r.lineStart():r.lineEnd()),n&&r.point(e[o])}function genSegContext(r,e,i){const n=e??(abs$1(i[i.length-1].x-i[0].x)>abs$1(i[i.length-1].y-i[0].y)?Direction$1.ROW:Direction$1.COLUMN);return r==="monotoneY"?new ReflectSegContext(r,n):new SegContext(r,n)}class Linear{constructor(e,i){this.context=e,i&&(this.startPoint=i)}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this.context.closePath(),this._line=1-this._line}point(e){const i=e.x,n=e.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(i,n,this._lastDefined!==!1&&e.defined!==!1,e):this.context.moveTo(i,n,e);break;case 1:this._point=2;default:this.context.lineTo(i,n,this._lastDefined!==!1&&e.defined!==!1,e)}this._lastDefined=e.defined}tryUpdateLength(){return this.context.tryUpdateLength()}}function genLinearSegments(r,e={}){const{direction:i,startPoint:n}=e;if(r.length<2-+!!n)return null;const o=genSegContext("linear",i,r);return genLinearTypeSegments(new Linear(o,n),r),o}function genLinearTypeSegments(r,e){return genCurveSegments(r,e,1)}function point$3(r,e,i,n,o){r.context.bezierCurveTo((2*r._x0+r._x1)/3,(2*r._y0+r._y1)/3,(r._x0+2*r._x1)/3,(r._y0+2*r._y1)/3,(r._x0+4*r._x1+e)/6,(r._y0+4*r._y1+i)/6,n,r.lastPoint1)}class Basis{constructor(e,i){this.context=e,this.startPoint=i}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){this._point===2&&point$3(this,6*this._x1-(this._x0+4*this._x1),6*this._y1-(this._y0+4*this._y1),this._lastDefined1!==!1&&this._lastDefined2!==!1,this.lastPoint1),(this._line||this._line!==0&&this._point===1)&&this.context.closePath(),this._line=1-this._line}point(e){const i=e.x,n=e.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(i,n,this._lastDefined1!==!1&&this._lastDefined2!==!1,e):this.context.moveTo(i,n,e);break;case 1:this._point=2;break;default:point$3(this,i,n,this._lastDefined1!==!1&&this._lastDefined2!==!1)}this._x0=this._x1,this._x1=i,this._y0=this._y1,this._y1=n,this._lastDefined1=this._lastDefined2,this._lastDefined2=e.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=e}tryUpdateLength(){return this.context.tryUpdateLength()}}function genBasisTypeSegments(r,e){return genCurveSegments(r,e,2)}function genBasisSegments(r,e={}){const{direction:i,startPoint:n}=e;if(r.length<2-+!!n)return null;if(r.length<3-+!!n)return genLinearSegments(r,e);const o=genSegContext("basis",i,r);return genBasisTypeSegments(new Basis(o,n),r),o}function sign(r){return r<0?-1:1}function slope3(r,e,i){const n=r._x1-r._x0,o=e-r._x1,l=(r._y1-r._y0)/(n||Number(o<0&&-0)),d=(i-r._y1)/(o||Number(n<0&&-0)),u=(l*o+d*n)/(n+o);return(sign(l)+sign(d))*Math.min(Math.abs(l),Math.abs(d),.5*Math.abs(u))||0}function slope2(r,e){const i=r._x1-r._x0;return i?(3*(r._y1-r._y0)/i-e)/2:e}function point$2(r,e,i,n,o){const l=r._x0,d=r._y0,u=r._x1,f=r._y1,g=(u-l)/3;r.context.bezierCurveTo(l+g,d+g*e,u-g,f-g*i,u,f,n,r.lastPoint1)}class MonotoneX{constructor(e,i){this.context=e,this.startPoint=i}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){switch(this._point){case 2:this.context.lineTo(this._x1,this._y1,this._lastDefined1!==!1&&this._lastDefined2!==!1,this.lastPoint1);break;case 3:point$2(this,this._t0,slope2(this,this._t0),this._lastDefined1!==!1&&this._lastDefined2!==!1,this.lastPoint1)}(this._line||this._line!==0&&this._point===1)&&this.context.closePath(),this._line=1-this._line}point(e){let i=NaN;const n=e.x,o=e.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(n,o,this._lastDefined1!==!1&&this._lastDefined2!==!1,e):this.context.moveTo(n,o,e);break;case 1:this._point=2;break;case 2:this._point=3,point$2(this,slope2(this,i=slope3(this,n,o)),i,this._lastDefined1!==!1&&this._lastDefined2!==!1);break;default:point$2(this,this._t0,i=slope3(this,n,o),this._lastDefined1!==!1&&this._lastDefined2!==!1)}this._x0=this._x1,this._x1=n,this._y0=this._y1,this._y1=o,this._t0=i,this._lastDefined1=this._lastDefined2,this._lastDefined2=e.defined!==!1,this.lastPoint0=this.lastPoint1,this.lastPoint1=e}tryUpdateLength(){return this.context.tryUpdateLength()}}class MonotoneY extends MonotoneX{constructor(e,i){super(e,i)}point(e){return super.point({y:e.x,x:e.y,defined:e.defined})}}function genMonotoneXTypeSegments(r,e){return genCurveSegments(r,e,2)}function genMonotoneXSegments(r,e={}){const{direction:i,startPoint:n}=e;if(r.length<2-+!!n)return null;if(r.length<3-+!!n)return genLinearSegments(r,e);const o=genSegContext("monotoneX",i,r);return genMonotoneXTypeSegments(new MonotoneX(o,n),r),o}function genMonotoneYTypeSegments(r,e){return genCurveSegments(r,e,2)}function genMonotoneYSegments(r,e={}){const{direction:i,startPoint:n}=e;if(r.length<2-+!!n)return null;if(r.length<3-+!!n)return genLinearSegments(r,e);const o=genSegContext("monotoneY",i,r);return genMonotoneYTypeSegments(new MonotoneY(o,n),r),o}let Step$1=class{constructor(e,i=.5,n){this.context=e,this._t=i,this.startPoint=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x=this._y=NaN,this._point=0,this.startPoint&&this.point(this.startPoint)}lineEnd(){0<this._t&&this._t<1&&this._point===2&&this.context.lineTo(this._x,this._y,this._lastDefined!==!1,this.lastPoint),(this._line||this._line!==0&&this._point===1)&&this.context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)}point(e){const i=e.x,n=e.y;switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(i,n,this._lastDefined!==!1&&e.defined!==!1,e):this.context.moveTo(i,n,e);break;case 1:this._point=2;default:if(this._t<=0)this.context.lineTo(this._x,n,this._lastDefined!==!1&&e.defined!==!1,this.lastPoint),this.context.lineTo(i,n,this._lastDefined!==!1&&e.defined!==!1,e);else{const o=this._x*(1-this._t)+i*this._t;this._t===.5?this.context.lineTo(o,this._y,this._lastDefined!==!1,this.lastPoint):this.context.lineTo(o,this._y,this._lastDefined!==!1&&e.defined!==!1,this.lastPoint),this.context.lineTo(o,n,this._lastDefined!==!1&&e.defined!==!1,e)}}this._lastDefined=e.defined,this._x=i,this._y=n,this.lastPoint=e}tryUpdateLength(){return this.context.tryUpdateLength()}};function genStepSegments(r,e,i={}){const{direction:n,startPoint:o}=i;if(r.length<2-+!!o)return null;const l=new SegContext("step",n??(abs$1(r[r.length-1].x-r[0].x)>abs$1(r[r.length-1].y-r[0].y)?Direction$1.ROW:Direction$1.COLUMN));return genStepTypeSegments(new Step$1(l,e,o),r),l}function genStepTypeSegments(r,e){return genCurveSegments(r,e,1)}class LinearClosed extends Linear{lineEnd(){this.context.closePath()}}function genLinearClosedSegments(r,e={}){const{direction:i,startPoint:n}=e;if(r.length<2-+!!n)return null;const o=genSegContext("linear",i,r);return genLinearClosedTypeSegments(new LinearClosed(o,n),r),o}function genLinearClosedTypeSegments(r,e){return genCurveSegments(r,e,1)}function point$1(r,e,i,n,o){let l=r._x1,d=r._y1,u=r._x2,f=r._y2;if(r._l01_a>epsilon$1){const g=2*r._l01_2a+3*r._l01_a*r._l12_a+r._l12_2a,_=3*r._l01_a*(r._l01_a+r._l12_a);l=(l*g-r._x0*r._l12_2a+r._x2*r._l01_2a)/_,d=(d*g-r._y0*r._l12_2a+r._y2*r._l01_2a)/_}if(r._l23_a>epsilon$1){const g=2*r._l23_2a+3*r._l23_a*r._l12_a+r._l12_2a,_=3*r._l23_a*(r._l23_a+r._l12_a);u=(u*g+r._x1*r._l23_2a-e*r._l12_2a)/_,f=(f*g+r._y1*r._l23_2a-i*r._l12_2a)/_}r.context.bezierCurveTo(l,d,u,f,r._x2,r._y2,n,r.lastPoint1)}class CatmullRom{constructor(e,i=.5,n){this.context=e,this.startPoint=n,this._alpha=i}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0}lineEnd(){switch(this._point){case 2:this.context.lineTo(this._x2,this._y2,this._lastDefined1!==!1&&this._lastDefined2!==!1,this.lastPoint1);break;case 3:this.point({x:this._x2,y:this._y2})}(this._line||this._line!==0&&this._point===1)&&this.context.closePath(),this._line=1-this._line}point(e){const{x:i,y:n}=e;if(this._point){const o=this._x2-i,l=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(o*o+l*l,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this.context.lineTo(i,n,this._lastDefined1!==!1&&this._lastDefined2!==!1):this.context.moveTo(i,n);break;case 1:this._point=2;break;case 2:this._point=3;default:point$1(this,i,n,this._lastDefined1!==!1&&this._lastDefined2!==!1)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=i,this._y0=this._y1,this._y1=this._y2,this._y2=n,this._lastDefined1=this._lastDefined2,this._lastDefined2=e.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=e}tryUpdateLength(){return this.context.tryUpdateLength()}}function commonGenCatmullRomSegments(r,e){return function(i,n,o={}){const{direction:l,startPoint:d}=o;if(i.length<2-+!!d)return null;if(i.length<3-+!!d)return genLinearSegments(i,o);const u=genSegContext(r,l,i),f=new e(u,n,d);return genCurveSegments(f,i,2),u}}const genCatmullRomSegments=commonGenCatmullRomSegments("catmullRom",CatmullRom);class CatmullRomClosed{constructor(e,i=.5,n){this.context=e,this.startPoint=n,this._alpha=i}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0}lineEnd(){switch(this._point){case 1:this.context.moveTo(this._x3,this._y3,this.lastPoint1),this.context.closePath();break;case 2:this.context.lineTo(this._x3,this._y3,this._lastDefined1!==!1&&this._lastDefined2!==!1,this.lastPoint1),this.context.closePath();break;case 3:this.point({x:this._x3,y:this._y3}),this.point({x:this._x4,y:this._y4}),this.point({x:this._x5,y:this._y5})}}point(e){const{x:i,y:n}=e;if(this._point){const o=this._x2-i,l=this._y2-n;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(o*o+l*l,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=i,this._y3=n;break;case 1:this._point=2,this.context.moveTo(this._x4=i,this._y4=n,e);break;case 2:this._point=3,this._x5=i,this._y5=n;break;default:point$1(this,i,n,this._lastDefined1!==!1&&this._lastDefined2!==!1)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=i,this._y0=this._y1,this._y1=this._y2,this._y2=n,this._lastDefined1=this._lastDefined2,this._lastDefined2=e.defined,this.lastPoint0=this.lastPoint1,this.lastPoint1=e}tryUpdateLength(){return this.context.tryUpdateLength()}}const genCatmullRomClosedSegments=commonGenCatmullRomSegments("catmullRomClosed",CatmullRomClosed);function calcLineCache(r,e,i){var n,o;switch(e){case"linear":default:return genLinearSegments(r,i);case"basis":return genBasisSegments(r,i);case"monotoneX":return genMonotoneXSegments(r,i);case"monotoneY":return genMonotoneYSegments(r,i);case"step":return genStepSegments(r,.5,i);case"stepBefore":return genStepSegments(r,0,i);case"stepAfter":return genStepSegments(r,1,i);case"catmullRom":return genCatmullRomSegments(r,(n=i==null?void 0:i.curveTension)!==null&&n!==void 0?n:.5,i);case"catmullRomClosed":return genCatmullRomClosedSegments(r,(o=i==null?void 0:i.curveTension)!==null&&o!==void 0?o:.5,i);case"linearClosed":return genLinearClosedSegments(r,i)}}class CustomPath2D extends CurvePath{constructor(e){super(),this.commandList=[],e&&(this._ctx=e),this._boundsContext=new BoundsContext(this.bounds)}setCtx(e){this._ctx=e}moveTo(e,i){return this.commandList.push([enumCommandMap.M,e,i]),this._ctx&&this._ctx.moveTo(e,i),this}lineTo(e,i){return this.commandList.push([enumCommandMap.L,e,i]),this._ctx&&this._ctx.lineTo(e,i),this}quadraticCurveTo(e,i,n,o){return this.commandList.push([enumCommandMap.Q,e,i,n,o]),this._ctx&&this._ctx.quadraticCurveTo(e,i,n,o),this}bezierCurveTo(e,i,n,o,l,d){return this.commandList.push([enumCommandMap.C,e,i,n,o,l,d]),this._ctx&&this._ctx.bezierCurveTo(e,i,n,o,l,d),this}arcTo(e,i,n,o,l){return this.commandList.push([enumCommandMap.AT,e,i,n,o,l]),this._ctx&&this._ctx.arcTo(e,i,n,o,l),this}ellipse(e,i,n,o,l,d,u,f){return this.commandList.push([enumCommandMap.E,e,i,n,o,l,d,u,f]),this._ctx&&this._ctx.ellipse(e,i,n,o,l,d,u,f),this}rect(e,i,n,o){return this.commandList.push([enumCommandMap.R,e,i,n,o]),this._ctx&&this._ctx.rect(e,i,n,o),this}arc(e,i,n,o,l,d){return this.commandList.push([enumCommandMap.A,e,i,n,o,l,d]),this._ctx&&this._ctx.arc(e,i,n,o,l,d),this}closePath(){return this.commandList.push([enumCommandMap.Z]),this._ctx&&this._ctx.closePath(),this}addCurve(e){this.curves.push(e)}clear(){this.transformCbList=null,this.commandList.length=0,this.curves.length=0}beginPath(){this.clear()}toString(){if(!this.toStringCbList){const n=[];n[enumCommandMap.M]=o=>`M${o[1]} ${o[2]}`,n[enumCommandMap.L]=o=>`L${o[1]} ${o[2]}`,n[enumCommandMap.Q]=o=>`Q${o[1]} ${o[2]} ${o[3]} ${o[4]}`,n[enumCommandMap.C]=o=>`C${o[1]} ${o[2]} ${o[3]} ${o[4]} ${o[5]} ${o[6]}`,n[enumCommandMap.A]=o=>{const l=[];addArcToBezierPath$1(l,o[4],o[5],o[1],o[2],o[3],o[3]);let d="";for(let u=0;u<l.length;u+=6)d+=`C${l[u]} ${l[u+1]} ${l[u+2]} ${l[u+3]} ${l[u+4]} ${l[u+5]}`;return d},n[enumCommandMap.R]=o=>`M${o[1]} ${o[2]} h${o[3]} v${o[4]} H${o[1]}Z`,n[enumCommandMap.Z]=o=>"Z",this.toStringCbList=n}const e=this.toStringCbList;let i="";return this.commandList.forEach(n=>{i+=e[n[0]](n)}),i}fromString(e,i,n,o,l){this.clear();const d=parseSvgPath(e);return this._runCommandStrList(d,i,n,o,l),this._updateBounds(),this}fromLine(e){const{points:i,curveType:n,clipRangeByDimension:o}=e.attribute;if(!i)return;const l=calcLineCache(i,n);o==="x"?this.direction=Direction$1.ROW:o==="y"?this.direction=Direction$1.COLUMN:o==="auto"&&(this.direction=l.direction),this.curves=l.curves}fromCustomPath2D(e,i,n,o,l){return this.clear(),this._runCommandList(e.commandList,i,n,o,l),this._updateBounds(),this}transform(e,i,n,o){const l=this.commandList;if(!this.transformCbList){const d=[];d[enumCommandMap.M]=this.moveToTransform,d[enumCommandMap.L]=this.lineToTransform,d[enumCommandMap.Q]=this.quadraticCurveToTransform,d[enumCommandMap.C]=this.bezierCurveToTransform,d[enumCommandMap.AT]=this.arcToTransform,d[enumCommandMap.E]=this.ellipseTransform,d[enumCommandMap.R]=this.rectTransform,d[enumCommandMap.A]=this.arcTransform,d[enumCommandMap.Z]=this.closePathTransform,this.transformCbList=d}l.forEach(d=>{this.transformCbList[d[0]](d,e,i,n,o)}),this._updateBounds()}moveToTransform(e,i,n,o,l){e[1]=e[1]*o+i,e[2]=e[2]*l+n}lineToTransform(e,i,n,o,l){e[1]=e[1]*o+i,e[2]=e[2]*l+n}quadraticCurveToTransform(e,i,n,o,l){e[1]=e[1]*o+i,e[2]=e[2]*l+n,e[3]=e[3]*o+i,e[4]=e[4]*l+n}bezierCurveToTransform(e,i,n,o,l){e[1]=e[1]*o+i,e[2]=e[2]*l+n,e[3]=e[3]*o+i,e[4]=e[4]*l+n,e[5]=e[5]*o+i,e[6]=e[6]*l+n}arcToTransform(e,i,n,o,l){e[1]=e[1]*o+i,e[2]=e[2]*l+n,e[3]=e[3]*o+i,e[4]=e[4]*l+n,e[5]=e[5]*(o+l)/2}ellipseTransform(e,i,n,o,l){e[1]=e[1]*o+i,e[2]=e[2]*l+n,e[3]=e[3]*o,e[4]=e[4]*l}rectTransform(e,i,n,o,l){e[1]=e[1]*o+i,e[2]=e[2]*l+n,e[3]=e[3]*o,e[4]=e[4]*l}arcTransform(e,i,n,o,l){e[1]=e[1]*o+i,e[2]=e[2]*l+n,e[3]=e[3]*(o+l)/2}closePathTransform(){}_runCommandStrList(e,i=0,n=0,o=1,l=1){let d,u,f,g,_,y=null,b=0,S=0,v=0,A=0;for(let x=0,T=e.length;x<T;++x){switch(d=e[x],o===1&&l===1||(d=scale$1(d,o,l)),d[0]){case"l":b+=d[1],S+=d[2],this.lineTo(b+i,S+n);break;case"L":b=d[1],S=d[2],this.lineTo(b+i,S+n);break;case"h":b+=d[1],this.lineTo(b+i,S+n);break;case"H":b=d[1],this.lineTo(b+i,S+n);break;case"v":S+=d[1],this.lineTo(b+i,S+n);break;case"V":S=d[1],this.lineTo(b+i,S+n);break;case"m":b+=d[1],S+=d[2],this.moveTo(b+i,S+n);break;case"M":b=d[1],S=d[2],this.moveTo(b+i,S+n);break;case"c":u=b+d[5],f=S+d[6],v=b+d[3],A=S+d[4],this.bezierCurveTo(b+d[1]+i,S+d[2]+n,v+i,A+n,u+i,f+n),b=u,S=f;break;case"C":b=d[5],S=d[6],v=d[3],A=d[4],this.bezierCurveTo(d[1]+i,d[2]+n,v+i,A+n,b+i,S+n);break;case"s":u=b+d[3],f=S+d[4],v=2*b-v,A=2*S-A,this.bezierCurveTo(v+i,A+n,b+d[1]+i,S+d[2]+n,u+i,f+n),v=b+d[1],A=S+d[2],b=u,S=f;break;case"S":u=d[3],f=d[4],v=2*b-v,A=2*S-A,this.bezierCurveTo(v+i,A+n,d[1]+i,d[2]+n,u+i,f+n),b=u,S=f,v=d[1],A=d[2];break;case"q":u=b+d[3],f=S+d[4],v=b+d[1],A=S+d[2],this.quadraticCurveTo(v+i,A+n,u+i,f+n),b=u,S=f;break;case"Q":u=d[3],f=d[4],this.quadraticCurveTo(d[1]+i,d[2]+n,u+i,f+n),b=u,S=f,v=d[1],A=d[2];break;case"t":u=b+d[1],f=S+d[2],y[0].match(/[QqTt]/)===null?(v=b,A=S):y[0]==="t"?(v=2*b-g,A=2*S-_):y[0]==="q"&&(v=2*b-v,A=2*S-A),g=v,_=A,this.quadraticCurveTo(v+i,A+n,u+i,f+n),b=u,S=f,v=b+d[1],A=S+d[2];break;case"T":u=d[1],f=d[2],v=2*b-v,A=2*S-A,this.quadraticCurveTo(v+i,A+n,u+i,f+n),b=u,S=f;break;case"a":drawArc(this,b+i,S+n,[d[1],d[2],d[3],d[4],d[5],d[6]+b+i,d[7]+S+n]),b+=d[6],S+=d[7];break;case"A":drawArc(this,b+i,S+n,[d[1],d[2],d[3],d[4],d[5],d[6]+i,d[7]+n]),b=d[6],S=d[7];break;case"z":case"Z":this.closePath()}y=d}}_runCommandList(e,i=0,n=0,o=1,l=1){if(i!==0||n!==0||o!==1||l!==1)for(let d=0,u=e.length;d<u;++d){const f=e[d].slice();switch(f[0]){case enumCommandMap.L:this.lineToTransform(f,i,n,o,l);break;case enumCommandMap.M:this.moveToTransform(f,i,n,o,l);break;case enumCommandMap.C:this.bezierCurveToTransform(f,i,n,o,l);break;case enumCommandMap.Q:this.quadraticCurveToTransform(f,i,n,o,l);break;case enumCommandMap.A:this.arcToTransform(f,i,n,o,l);break;case enumCommandMap.E:this.ellipseTransform(f,i,n,o,l);break;case enumCommandMap.R:this.rectTransform(f,i,n,o,l);break;case enumCommandMap.AT:this.arcToTransform(f,i,n,o,l);break;case enumCommandMap.Z:this.closePath()}}else this.commandList=e.map(d=>d.slice())}_updateBounds(){this.bounds.clear(),renderCommandList(this.commandList,this._boundsContext)}release(){this.commandList=[],this._boundsContext=null,this._ctx=null}getLength(){if(this.direction===Direction$1.COLUMN){if(!this.curves.length)return 0;const e=this.curves[0],i=this.curves[this.curves.length-1];return abs$1(e.p0.y-i.p1.y)}if(this.direction===Direction$1.ROW){if(!this.curves.length)return 0;const e=this.curves[0],i=this.curves[this.curves.length-1];return abs$1(e.p0.x-i.p1.x)}return this.curves.reduce((e,i)=>e+i.getLength(),0)}getAttrAt(e){if(!this.curves)return{pos:{x:0,y:0},angle:0};let i,n=0;for(let l=0;l<this.curves.length;l++){i=this.curves[l];const d=i.getLength(this.direction);if(n+d>=e)break;n+=d}const o=(e-n)/i.getLength(this.direction);return{pos:i.getPointAt(o),angle:i.getAngleAt(o)}}}const temp=["l",0,0,0,0,0,0,0];function scale$1(r,e,i){const n=temp[0]=r[0];if(n==="a"||n==="A")temp[1]=e*r[1],temp[2]=i*r[2],temp[3]=r[3],temp[4]=r[4],temp[5]=r[5],temp[6]=e*r[6],temp[7]=i*r[7];else if(n==="h"||n==="H")temp[1]=e*r[1];else if(n==="v"||n==="V")temp[1]=i*r[1];else for(let o=1,l=r.length;o<l;++o)temp[o]=(o%2==1?e:i)*r[o];return temp}const DefaultLayout={alignSelf:"auto"},DefaultTransform={x:0,y:0,z:0,dx:0,dy:0,dz:0,scrollX:0,scrollY:0,scaleX:1,scaleY:1,scaleZ:1,angle:0,alpha:0,beta:0,scaleCenter:[0,0],anchor:[0,0],anchor3d:[0,0],postMatrix:new Matrix},DefaultFillStyle={fillOpacity:1,fill:!1,shadowBlur:0,shadowColor:"black",shadowOffsetX:0,shadowOffsetY:0},commonStroke={strokeOpacity:1,lineDash:[],lineDashOffset:0,lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:10,strokeBoundsBuffer:2,stroke:!1},DefaultStrokeStyle=Object.assign({outerBorder:Object.assign(Object.assign({},commonStroke),{distance:0}),innerBorder:Object.assign(Object.assign({},commonStroke),{distance:0})},commonStroke),DefaultTextStyle={text:"",maxLineWidth:1/0,maxWidth:1/0,textAlign:"left",textBaseline:"alphabetic",fontSize:16,fontFamily:`PingFang SC,Microsoft Yahei,system-ui,-apple-system,segoe ui,
    Roboto,Helvetica,Arial,sans-serif, apple color emoji,segoe ui emoji,segoe ui symbol`,fontWeight:"",ellipsis:"",fontVariant:"",fontStyle:"",lineHeight:void 0,underline:0,lineThrough:0,scaleIn3d:!1,direction:"horizontal",wordBreak:"break-all",ignoreBuf:!1,verticalMode:0,wrap:!1,whiteSpace:"no-wrap",heightLimit:1/0,lineClamp:1/0,suffixPosition:"end",underlineDash:[],underlineOffset:0,disableAutoClipedPoptip:void 0,measureMode:MeasureModeEnum.fontBounding,keepCenterInLine:!1},DefaultPickStyle={pickStrokeBuffer:0},DefaultStyle=Object.assign(Object.assign(Object.assign(Object.assign({forceBoundsWidth:void 0,forceBoundsHeight:void 0,opacity:1,background:null,backgroundOpacity:1,backgroundCornerRadius:0,texture:null,textureColor:"black",textureSize:10,texturePadding:2,backgroundMode:"no-repeat",backgroundFit:!0,blur:0,cursor:null,html:null,react:null},DefaultFillStyle),DefaultStrokeStyle),DefaultLayout),DefaultPickStyle),DefaultConnectAttribute={connectedType:"none",connectedStyle:{},connectedX:NaN,connectedY:NaN},DefaultDebugAttribute={_debug_bounds:!1},DefaultAttribute=Object.assign(Object.assign(Object.assign({strokeSeg:null,renderable:!0,pickable:!0,shadowGraphic:void 0,childrenPickable:!0,fillPickable:!0,strokePickable:!0,visible:!0,zIndex:0,layout:null,boundsPadding:0,fillStrokeOrder:0,renderStyle:"default",pickMode:"accurate",customPickShape:null,boundsMode:"accurate",keepDirIn3d:!0,shadowRootIdx:1,globalZIndex:1,globalCompositeOperation:"",overflow:"hidden",shadowPickMode:"graphic",keepStrokeScale:!1},DefaultDebugAttribute),DefaultStyle),DefaultTransform),DefaultArcAttribute=Object.assign(Object.assign({},DefaultAttribute),{startAngle:0,endAngle:pi2,innerRadius:0,outerRadius:1,innerPadding:0,outerPadding:0,cornerRadius:0,padRadius:0,padAngle:0,cap:!1,forceShowCap:!1}),DefaultAreaAttribute=Object.assign(Object.assign(Object.assign({},DefaultAttribute),DefaultConnectAttribute),{points:[],segments:[],curveType:"linear",clipRange:1,closePath:!1,curveTension:1}),DefaultCircleAttribute=Object.assign(Object.assign({},DefaultAttribute),{radius:1,startAngle:0,endAngle:pi2}),DefaultGroupAttribute=Object.assign(Object.assign({},DefaultAttribute),{width:0,height:0,cornerRadius:0,path:[],clip:!1,visibleAll:!0,display:"relative",flexDirection:"row",flexWrap:"wrap",justifyContent:"flex-start",alignItems:"flex-start",alignContent:"flex-start",baseOpacity:1}),DefaultGlyphAttribute=Object.assign(Object.assign({},DefaultAttribute),{path:"",width:0,height:0,cornerRadius:0,clip:!1}),DefaultLineAttribute=Object.assign(Object.assign(Object.assign({},DefaultAttribute),DefaultConnectAttribute),{points:[],segments:[],curveType:"linear",clipRange:1,clipRangeByDimension:"default",closePath:!1,curveTension:1}),DefaultPathAttribute=Object.assign(Object.assign({},DefaultAttribute),{path:new CustomPath2D,fillStrokeOrder:1,customPath:()=>{Logger.getInstance().warn("")}}),DefaultPolygonAttribute=Object.assign(Object.assign({},DefaultAttribute),{points:[],cornerRadius:0,closePath:!0}),DefaultRectAttribute=Object.assign(Object.assign({},DefaultAttribute),{width:0,height:0,x1:0,y1:0,strokeBoundsBuffer:0,cornerRadius:0});Object.assign(Object.assign({},DefaultAttribute),{width:0,height:0,x1:0,y1:0,cornerRadius:0,length:0});const DefaultSymbolAttribute=Object.assign(Object.assign({},DefaultAttribute),{symbolType:"circle",size:10,keepDirIn3d:!0}),DefaultTextAttribute=Object.assign(Object.assign(Object.assign({},DefaultAttribute),DefaultTextStyle),{strokeBoundsBuffer:0,keepDirIn3d:!0}),DefaultRichTextAttribute=Object.assign(Object.assign(Object.assign({},DefaultAttribute),DefaultTextStyle),{editable:!1,width:300,height:300,ellipsis:!0,wordBreak:"break-word",verticalDirection:"top",textAlign:"left",textBaseline:"top",layoutDirection:"horizontal",textConfig:[],disableAutoWrapLine:!1,maxHeight:void 0,maxWidth:void 0,singleLine:!1}),DefaultImageAttribute=Object.assign(Object.assign({repeatX:"no-repeat",repeatY:"no-repeat",image:"",width:0,height:0},DefaultAttribute),{fill:!0,cornerRadius:0}),DefaultRichTextIconAttribute=Object.assign(Object.assign({},DefaultImageAttribute),{backgroundShowMode:"never",backgroundWidth:0,backgroundHeight:0,textAlign:"left",textBaseline:"middle",direction:"horizontal",margin:0,id:"",width:20,height:20,backgroundFill:"rgba(101, 117, 168, 0.1)",backgroundFillOpacity:1,backgroundStroke:!1,backgroundStrokeOpacity:1,backgroundRadius:4,opacity:1});class Application{}const application=new Application,parse=function(){const r={linearGradient:/^(linear\-gradient)/i,radialGradient:/^(radial\-gradient)/i,conicGradient:/^(conic\-gradient)/i,sideOrCorner:/^to (left (top|bottom)|right (top|bottom)|top (left|right)|bottom (left|right)|left|right|top|bottom)/i,extentKeywords:/^(closest\-side|closest\-corner|farthest\-side|farthest\-corner|contain|cover)/,positionKeywords:/^(left|center|right|top|bottom)/i,pixelValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))px/,percentageValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))\%/,emValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))em/,angleValue:/^(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,fromAngleValue:/^from\s*(-?(([0-9]*\.[0-9]+)|([0-9]+\.?)))deg/,startCall:/^\(/,endCall:/^\)/,comma:/^,/,hexColor:/(^\#[0-9a-fA-F]+)/,literalColor:/^([a-zA-Z]+)/,rgbColor:/^(rgb\(\d{1,3},\s*\d{1,3},\s*\d{1,3}\))/i,rgbaColor:/^(rgba\(\d{1,3},\s*\d{1,3},\s*\d{1,3},\s*((\d\.\d+)|\d{1,3})\))/i};let e="";function i(P){const R=new Error(e+": "+P);throw R.source=e,R}function n(){const P=S(o);return e.length>0&&i("Invalid input not EOF"),P}function o(){return l("linear",r.linearGradient,d)||l("radial",r.radialGradient,f)||l("conic",r.conicGradient,u)}function l(P,R,L){return function(w,B){const I=C(w);if(I){C(r.startCall)||i("Missing (");const D=B(I);return C(r.endCall)||i("Missing )"),D}}(R,function(w){const B=L();return B&&(C(r.comma)||i("Missing comma before color stops")),{type:P,orientation:B,colorStops:S(v)}})}function d(){return T("directional",r.sideOrCorner,1)||T("angular",r.angleValue,1)}function u(){return T("angular",r.fromAngleValue,1)}function f(){let P,R,L=g();return L&&(P=[],P.push(L),R=e,C(r.comma)&&(L=g(),L?P.push(L):e=R)),P}function g(){let P=function(){const R=T("shape",/^(circle)/i,0);return R&&(R.style=x()||_()),R}()||function(){const R=T("shape",/^(ellipse)/i,0);return R&&(R.style=A()||_()),R}();if(P)P.at=y();else{const R=_();if(R){P=R;const L=y();L&&(P.at=L)}else{const L=b();L&&(P={type:"default-radial",at:L})}}return P}function _(){return T("extent-keyword",r.extentKeywords,1)}function y(){if(T("position",/^at/,0)){const P=b();return P||i("Missing positioning value"),P}}function b(){const P={x:A(),y:A()};if(P.x||P.y)return{type:"position",value:P}}function S(P){let R=P();const L=[];if(R)for(L.push(R);C(r.comma);)R=P(),R?L.push(R):i("One extra comma");return L}function v(){const P=T("hex",r.hexColor,1)||T("rgba",r.rgbaColor,1)||T("rgb",r.rgbColor,1)||T("literal",r.literalColor,0);return P||i("Expected color definition"),P.length=A(),P}function A(){return T("%",r.percentageValue,1)||T("position-keyword",r.positionKeywords,1)||x()}function x(){return T("px",r.pixelValue,1)||T("em",r.emValue,1)}function T(P,R,L){const w=C(R);if(w)return{type:P,value:w[L]}}function C(P){const R=/^[\n\r\t\s]+/.exec(e);R&&E(R[0].length);const L=P.exec(e);return L&&E(L[0].length),L}function E(P){e=e.substr(P)}return function(P){return e=P.toString(),n()}}();class GradientParser{static IsGradient(e){return!(typeof e=="string"&&!e.includes("gradient"))}static IsGradientStr(e){return typeof e=="string"&&e.includes("gradient")}static Parse(e){if(GradientParser.IsGradientStr(e))try{const i=parse(e)[0];if(i){if(i.type==="linear")return GradientParser.ParseLinear(i);if(i.type==="radial")return GradientParser.ParseRadial(i);if(i.type==="conic")return GradientParser.ParseConic(i)}}catch{return e}return e}static ParseConic(e){const{orientation:i,colorStops:n=[]}=e,o=pi$1/2,l=parseFloat(i.value)/180*pi$1-o;return{gradient:"conical",x:.5,y:.5,startAngle:l,endAngle:l+pi2,stops:n.map(d=>({color:d.value,offset:parseFloat(d.length.value)/100}))}}static ParseRadial(e){const{colorStops:i=[]}=e;return{gradient:"radial",x0:.5,y0:.5,x1:.5,y1:.5,r0:0,r1:1,stops:i.map(n=>({color:n.value,offset:parseFloat(n.length.value)/100}))}}static ParseLinear(e){const{orientation:i,colorStops:n=[]}=e,o=pi$1/2;let l=i.type==="angular"?parseFloat(i.value)/180*pi$1:0;for(;l<0;)l+=pi2;for(;l>=pi2;)l-=pi2;let d=0,u=0,f=0,g=0;return l<o?(d=0,u=1,f=Math.sin(l),g=u-Math.cos(l)):l<pi$1?(d=0,u=0,f=Math.cos(l-o),g=Math.sin(l-o)):l<pi$1+o?(d=1,u=0,f=d-Math.sin(l-pi$1),g=Math.cos(l-pi$1)):(d=1,f=d-Math.cos(l-o-pi$1),g-=Math.sin(l-o-pi$1)),{gradient:"linear",x0:d,y0:u,x1:f,y1:g,stops:n.map(_=>({color:_.value,offset:parseFloat(_.length.value)/100}))}}}function getScaledStroke(r,e,i){let n=e;const{a:o,b:l,c:d,d:u}=r.currentMatrix,f=Math.sign(o)*Math.sqrt(o*o+l*l),g=Math.sign(u)*Math.sqrt(d*d+u*u);return f+g===0?0:(n=n/Math.abs(f+g)*2*i,n)}function createColor(r,e,i,n=0,o=0){if(!e||e===!0)return"black";let l,d;if(isArray(e))for(let u=0;u<e.length&&(d=e[u],!d);u++);else d=e;if(d=GradientParser.Parse(d),typeof d=="string")return d;if(i.AABBBounds&&(!i.attribute||i.attribute.scaleX!==0||i.attribute.scaleY!==0)){const u=i.AABBBounds;let f=u.x2-u.x1,g=u.y2-u.y1,_=u.x1-n,y=u.y1-o;if(i.attribute){const{scaleX:b=1,scaleY:S=1}=i.attribute;f/=b,g/=S,_/=b,y/=S}d.gradient==="linear"?l=createLinearGradient(r,d,_,y,f,g):d.gradient==="conical"?l=createConicGradient(r,d,_,y,f,g):d.gradient==="radial"&&(l=createRadialGradient(r,d,_,y,f,g))}return l||"orange"}function createLinearGradient(r,e,i,n,o,l){var d,u,f,g;const _=r.createLinearGradient(i+((d=e.x0)!==null&&d!==void 0?d:0)*o,n+((u=e.y0)!==null&&u!==void 0?u:0)*l,i+((f=e.x1)!==null&&f!==void 0?f:1)*o,n+((g=e.y1)!==null&&g!==void 0?g:0)*l);return e.stops.forEach(y=>{_.addColorStop(y.offset,y.color)}),_}function createRadialGradient(r,e,i,n,o,l){var d,u,f,g,_,y;const b=r.createRadialGradient(i+((d=e.x0)!==null&&d!==void 0?d:.5)*o,n+((u=e.y0)!==null&&u!==void 0?u:.5)*l,Math.max(o,l)*((f=e.r0)!==null&&f!==void 0?f:0),i+((g=e.x1)!==null&&g!==void 0?g:.5)*o,n+((_=e.y1)!==null&&_!==void 0?_:.5)*l,Math.max(o,l)*((y=e.r1)!==null&&y!==void 0?y:.5));return e.stops.forEach(S=>{b.addColorStop(S.offset,S.color)}),b}function createConicGradient(r,e,i,n,o,l){var d,u;const f=r.createConicGradient(i+((d=e.x)!==null&&d!==void 0?d:0)*o,n+((u=e.y)!==null&&u!==void 0?u:0)*l,e.startAngle,e.endAngle);return e.stops.forEach(g=>{f.addColorStop(g.offset,g.color)}),f.GetPattern(o+i,l+n,void 0)}const DIRECTION_KEY={horizontal:{width:"width",height:"height",left:"left",top:"top",x:"x",y:"y",bottom:"bottom"},vertical:{width:"height",height:"width",left:"top",top:"left",x:"y",y:"x",bottom:"right"}},defaultFormatting={fill:!0,stroke:!1},regLetter=/\w|\(|\)|-/,regPunctuation=/[.?!,;:/]/,regFirstSpace=/\S/,setTextStyle=(r,e)=>{let i=e.fontSize||16;switch(e.script){case"super":case"sub":i*=.8}r.setTextStyle({textAlign:"left",textBaseline:e.textBaseline||"alphabetic",fontStyle:e.fontStyle||"",fontWeight:e.fontWeight||"",fontSize:i,fontFamily:e.fontFamily})};function applyFillStyle(r,e,i){const n=e&&e.fill||defaultFormatting.fill,{fillOpacity:o=1,opacity:l=1}=e;r.globalAlpha=o*l,r.fillStyle=i?createColor(r,n,{AABBBounds:i}):n,setTextStyle(r,e)}function applyStrokeStyle(r,e){const i=e&&e.stroke||defaultFormatting.stroke;if(!i)return void(r.globalAlpha=0);const{strokeOpacity:n=1,opacity:o=1}=e;r.globalAlpha=n*o,r.lineWidth=e&&typeof e.lineWidth=="number"?e.lineWidth:1,r.strokeStyle=i,setTextStyle(r,e)}function getStrByWithCanvas(r,e,i,n,o){if(!e||e<=0)return 0;const l=application.graphicUtil.textMeasure;let d=n,u=r.slice(0,d),f=Math.floor(l.measureText(u,i).width),g=r.slice(0,d+1),_=Math.floor(l.measureText(g,i).width);for(;f>e||_<=e;){if(f>e?d--:d++,d>r.length){d=r.length;break}if(d<0){d=0;break}u=r.slice(0,d),f=Math.floor(l.measureText(u,i).width),g=r.slice(0,d+1),_=Math.floor(l.measureText(g,i).width)}return o&&(d=testLetter(r,d)),d}function testLetter(r,e,i=!1){let n=e;for(;regLetter.test(r[n-1])&&regLetter.test(r[n])||regPunctuation.test(r[n]);)if(n--,n<=0)return i?testLetter2(r,e):e;return n}function testLetter2(r,e){let i=e;for(;regLetter.test(r[i-1])&&regLetter.test(r[i])||regPunctuation.test(r[i]);)if(i++,i>=r.length)return i;return i}function measureTextCanvas(r,e){const i=application.graphicUtil.textMeasure.measureText(r,e),n={ascent:0,height:0,descent:0,width:0};return typeof i.actualBoundingBoxAscent!="number"||typeof i.actualBoundingBoxDescent!="number"?(n.width=Math.floor(i.width),n.height=e.fontSize||0,n.ascent=n.height,n.descent=0):(n.width=Math.floor(i.width),n.height=Math.floor(i.actualBoundingBoxAscent+i.actualBoundingBoxDescent),n.ascent=Math.floor(i.actualBoundingBoxAscent),n.descent=n.height-n.ascent),n}var __decorate$1a=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d};let ATextMeasure=class{configure(r,e){this.canvas=r.canvas,this.context=r.context,r.bindTextMeasure(this)}_measureTextWithoutAlignBaseline(r,e,i){this.context.setTextStyleWithoutAlignBaseline(e);const n=this.context.measureText(r);return i?this.compatibleMetrics(n,e):n}_measureTextWithAlignBaseline(r,e,i){this.context.setTextStyle(e);const n=this.context.measureText(r);return i?this.compatibleMetrics(n,e):n}compatibleMetrics(r,e){if(r.actualBoundingBoxAscent==null||r.actualBoundingBoxDescent==null||r.fontBoundingBoxAscent==null||r.fontBoundingBoxDescent==null){const{ascent:i,descent:n}=this.measureTextBoundADscentEstimate(e);r.actualBoundingBoxAscent=i,r.actualBoundingBoxDescent=n,r.fontBoundingBoxAscent=i,r.fontBoundingBoxDescent=n}if(r.actualBoundingBoxLeft==null||r.actualBoundingBoxRight==null){const{left:i,right:n}=this.measureTextBoundLeftRightEstimate(e);r.actualBoundingBoxLeft=i,r.actualBoundingBoxRight=n}return r}estimate(r,{fontSize:e=DefaultTextAttribute.fontSize}){let i=0,n=0;for(let o=0;o<r.length;o++)r.charCodeAt(o)<128?i++:n++;return{width:~~(.8*i*e+n*e),height:e}}measureTextWidth(r,e,i){return this.context?(i=i??this._measureTextWithoutAlignBaseline(r,e)).width:this.estimate(r,e).width}measureTextBoundsWidth(r,e,i){return this.context?(i=i??this._measureTextWithoutAlignBaseline(r,e)).width:this.estimate(r,e).width}measureTextBoundsLeftRight(r,e,i){return this.context?{left:(i=i??this._measureTextWithAlignBaseline(r,e,!0)).actualBoundingBoxLeft,right:i.actualBoundingBoxRight}:this.measureTextBoundLeftRightEstimate(e)}measureTextPixelHeight(r,e,i){var n;return this.context?(i=i??this._measureTextWithoutAlignBaseline(r,e,!0),Math.abs(i.actualBoundingBoxAscent-i.actualBoundingBoxDescent)):(n=e.fontSize)!==null&&n!==void 0?n:DefaultTextStyle.fontSize}measureTextPixelADscent(r,e,i){return this.context?{ascent:(i=i??this._measureTextWithAlignBaseline(r,e,!0)).actualBoundingBoxAscent,descent:i.actualBoundingBoxDescent}:this.measureTextBoundADscentEstimate(e)}measureTextBoundHieght(r,e,i){var n;return this.context?(i=i??this._measureTextWithoutAlignBaseline(r,e,!0),Math.abs(i.fontBoundingBoxAscent-i.fontBoundingBoxDescent)):(n=e.fontSize)!==null&&n!==void 0?n:DefaultTextStyle.fontSize}measureTextBoundADscent(r,e,i){return this.context?{ascent:(i=i??this._measureTextWithAlignBaseline(r,e,!0)).fontBoundingBoxAscent,descent:i.fontBoundingBoxDescent}:this.measureTextBoundADscentEstimate(e)}measureTextBoundADscentEstimate(r){var e;const i=(e=r.fontSize)!==null&&e!==void 0?e:DefaultTextStyle.fontSize;return{ascent:.79*i,descent:.21*i}}measureTextBoundLeftRightEstimate(r){var e;const i=(e=r.fontSize)!==null&&e!==void 0?e:DefaultTextStyle.fontSize,{textAlign:n}=r;return n==="center"?{left:i/2,right:i/2}:n==="right"||n==="end"?{left:i,right:0}:{left:0,right:i}}measureTextPixelADscentAndWidth(r,e,i){if(!this.context)return Object.assign(Object.assign({},this.measureTextBoundADscentEstimate(e)),{width:this.estimate(r,e).width});const n=this._measureTextWithoutAlignBaseline(r,e,!0);if(i===MeasureModeEnum.actualBounding)return{ascent:n.actualBoundingBoxAscent,descent:n.actualBoundingBoxDescent,width:n.width};if(i===MeasureModeEnum.estimate)return Object.assign(Object.assign({},this.measureTextBoundADscentEstimate(e)),{width:n.width});if(i===MeasureModeEnum.fontBounding){let o=n.fontBoundingBoxAscent,l=n.fontBoundingBoxDescent;if(n.actualBoundingBoxDescent&&l<n.actualBoundingBoxDescent){const d=n.actualBoundingBoxDescent-l;l+=d,o-=d}else if(n.actualBoundingBoxAscent&&o<n.actualBoundingBoxAscent){const d=n.actualBoundingBoxAscent-o;o+=d,l-=d}return{ascent:o,descent:l,width:n.width}}return{ascent:n.actualBoundingBoxAscent,descent:n.actualBoundingBoxDescent,width:n.width}}measureText(r,e){return this.context?(this.context.setTextStyleWithoutAlignBaseline(e),this.context.measureText(r)):this.estimate(r,e)}clipTextVertical(r,e,i,n){if(r.length===0)return{verticalList:r,width:0};const{fontSize:o=12}=e;r.forEach(f=>{f.width=f.direction===0?o:this.measureTextWidth(f.text,e)});const l=[];let d=0,u=0;for(;u<r.length&&d+r[u].width<i;u++)d+=r[u].width,l.push(r[u]);if(r[u]&&r[u].text.length>1){const f=this._clipText(r[u].text,e,i-d,0,r[u].text.length-1,"end",!1);if(n&&f.str!==r[u].text){let g="",_=0;for(let S=0;S<u;S++){const v=r[S];g+=v.text,_+=v.text.length}g+=r[u].text;const y=_+f.str.length;let b=testLetter(g,y);b-=_,b!==f.str.length-1&&(f.str=f.str.substring(0,b),f.width=this.measureTextWidth(f.str,e))}l.push(Object.assign(Object.assign({},r[u]),{text:f.str,width:f.width})),d+=f.width}return{verticalList:l,width:d}}clipText(r,e,i,n,o){if(r.length===0)return{str:"",width:0};let l=this.measureTextWidth(r,e);if(l<=i)return{str:r,width:l};if(l=this.measureTextWidth(r[0],e),l>i)return{str:"",width:0};const d=this._clipText(r,e,i,0,r.length-1,"end",!1);if(n&&d.str!==r){let u=testLetter(r,d.str.length,o);u!==d.str.length&&(u>d.str.length&&(d.wordBreaked=u,u=d.str.length),d.str=r.substring(0,u),d.width=this.measureTextWidth(d.str,e))}return d}_clipText(r,e,i,n,o,l,d){let u;if(l==="start")u=this._clipTextStart(r,e,i,n,o),d&&(u.result=d+u.str);else if(l==="middle"){const f=this._clipTextMiddle(r,e,i,"","",0,0,1);u={str:"none",width:f.width,result:f.left+d+f.right}}else u=this._clipTextEnd(r,e,i,n,o),d&&(u.result=u.str+d);return u}_clipTextEnd(r,e,i,n,o){if(n===o){Logger.getInstance().warn(`_clipTextEnd${r}, ${n}, ${o}`);const g=r.substring(0,o+1);return{str:g,width:this.measureTextWidth(g,e)}}const l=Math.floor((n+o)/2),d=r.substring(0,l+1),u=this.measureTextWidth(d,e);let f;if(u>i){if(d.length<=1)return{str:"",width:0};const g=r.substring(0,l);return f=this.measureTextWidth(g,e),f<=i?{str:g,width:f}:this._clipTextEnd(r,e,i,n,l)}if(u<i){if(l>=r.length-1)return{str:r,width:this.measureTextWidth(r,e)};const g=r.substring(0,l+2);return f=this.measureTextWidth(g,e),f>=i?{str:d,width:u}:this._clipTextEnd(r,e,i,l,o)}return{str:d,width:u}}_clipTextStart(r,e,i,n,o){const l=Math.ceil((n+o)/2),d=r.substring(l-1,r.length),u=this.measureTextWidth(d,e);let f;if(u>i){if(d.length<=1)return{str:"",width:0};const g=r.substring(l,r.length);return f=this.measureTextWidth(g,e),f<=i?{str:g,width:f}:this._clipTextStart(r,e,i,l,r.length)}if(u<i){if(l<=0)return{str:r,width:this.measureTextWidth(r,e)};const g=r.substring(l-2,r.length);return f=this.measureTextWidth(g,e),f>=i?{str:d,width:u}:this._clipTextStart(r,e,i,n,l)}return{str:d,width:u}}_clipTextMiddle(r,e,i,n,o,l,d,u){const f=r.substring(0,u),g=this.measureTextWidth(f,e);if(g+d>i)return{left:n,right:o,width:l+d};const _=r.substring(r.length-u,r.length),y=this.measureTextWidth(_,e);return g+y>i?{left:f,right:o,width:g+d}:this._clipTextMiddle(r,e,i,f,_,g,y,u+1)}clipTextWithSuffixVertical(r,e,i,n,o,l){if(n==="")return this.clipTextVertical(r,e,i,o);if(r.length===0)return{verticalList:r,width:0};const d=this.clipTextVertical(r,e,i,o);if(d.verticalList.length===r.length&&d.verticalList[d.verticalList.length-1].width===r[r.length-1].width)return d;const u=this.measureTextWidth(n,e);if(u>i)return d;let f;if(i-=u,l==="start"){const g=this.revertVerticalList(r);f=this.clipTextVertical(g,e,i,o);const _=this.revertVerticalList(f.verticalList);_.unshift({text:n,direction:1,width:u}),f.verticalList=_}else if(l==="middle"){const g=this.clipTextVertical(r,e,i/2,o),_=this.revertVerticalList(r),y=this.clipTextVertical(_,e,i/2,o);g.verticalList.push({text:n,direction:1,width:u}),this.revertVerticalList(y.verticalList).forEach(b=>g.verticalList.push(b)),f={verticalList:g.verticalList,width:g.width+y.width}}else f=this.clipTextVertical(r,e,i,o),f.verticalList.push({text:n,direction:1,width:u});return f.width+=u,f}revertVerticalList(r){return r.reverse().map(e=>{const i=e.text.split("").reverse().join("");return Object.assign(Object.assign({},e),{text:i})})}clipTextWithSuffix(r,e,i,n,o,l,d=!1){if(n==="")return this.clipText(r,e,i,o);if(r.length===0)return{str:"",width:0};const u=this.measureTextWidth(r,e);if(!d&&u<=i)return{str:r,width:u};const f=this.measureTextWidth(n,e);if(f>i)return{str:"",width:0};if(d&&u+f<=i)return{str:r+n,width:u+f};i-=f;const g=this._clipText(r,e,i,0,r.length-1,l,n);if(o&&g.str!==r){const _=testLetter(r,g.str.length);_!==g.str.length&&(g.result=r.substring(0,_),g.width=this.measureTextWidth(g.str,e))}else d&&g.str===r&&(g.result=r+n);return g.str=g.result,g.width+=f,g}};ATextMeasure=__decorate$1a([injectable()],ATextMeasure);var __decorate$19=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d};const TextMeasureContribution=Symbol.for("TextMeasureContribution");let DefaultTextMeasureContribution=class extends ATextMeasure{};DefaultTextMeasureContribution=__decorate$19([injectable()],DefaultTextMeasureContribution);const container=new Container,CanvasFactory=Symbol.for("CanvasFactory"),Context2dFactory=Symbol.for("Context2dFactory");function wrapCanvas(r){return container.getNamed(CanvasFactory,application.global.env)(r)}class DefaultCanvasAllocate{constructor(){this.pools=[],this.allocatedCanvas=[]}shareCanvas(){return this.allocatedCanvas.length?this.allocatedCanvas[0]:this.getCommonCanvas()}getCommonCanvas(){return this._commonCanvas||(this._commonCanvas=this.allocate({width:100,height:100,dpr:2})),this._commonCanvas}allocate(e){if(!this.pools.length){const n=wrapCanvas(Object.assign({nativeCanvas:application.global.createCanvas(e)},e));return this.allocatedCanvas.push(n),n}const i=this.pools.pop();return i.resize(e.width,e.height),i.dpr=e.dpr,i}allocateByObj(e){if(!this.pools.length){const n={width:e.width/e.dpr,height:e.height/e.dpr,dpr:e.dpr},o=wrapCanvas(Object.assign({nativeCanvas:application.global.createCanvas(n)},n));return this.allocatedCanvas.push(o),o}const i=this.pools.pop();return i.width=e.width,i.height=e.height,i}free(e){this.pools.push(e)}get length(){return this.pools.length}release(...e){this.pools=[]}}const canvasAllocate=new DefaultCanvasAllocate;var __decorate$18=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$S=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)};const VWindow=Symbol.for("VWindow"),WindowHandlerContribution=Symbol.for("WindowHandlerContribution");let DefaultWindow=class{get width(){if(this._handler){const r=this._handler.getWH();return this._width=r.width}return this._width}get height(){if(this._handler){const r=this._handler.getWH();return this._height=r.height}return this._height}get dpr(){return this._handler.getDpr()}constructor(){this.hooks={onChange:new SyncHook(["x","y","width","height"])},this.active=()=>{const r=this.global;!r.env||this.actived||(container.getNamed(WindowHandlerContribution,r.env).configure(this,r),this.actived=!0)},this._uid=Generator.GenAutoIncrementId(),this.global=application.global,this.postInit()}postInit(){this.global.hooks.onSetEnv.tap("window",this.active),this.active()}get style(){var r;return(r=this._handler.getStyle())!==null&&r!==void 0?r:{}}set style(r){this._handler.setStyle(r)}create(r){var e,i;this._handler.createWindow(r);const n=this._handler.getWH();this._width=n.width,this._height=n.height,r.viewBox?this.setViewBox(r.viewBox):r.canvasControled!==!1?this.setViewBox({x1:0,y1:0,x2:this._width,y2:this._height}):this.setViewBox({x1:0,y1:0,x2:(e=r.width)!==null&&e!==void 0?e:this._width,y2:(i=r.height)!==null&&i!==void 0?i:this._height}),this.title=this._handler.getTitle(),this.resizable=!0}setWindowHandler(r){this._handler=r}setDpr(r){return this._handler.setDpr(r)}resize(r,e){return this._handler.resizeWindow(r,e)}configure(){throw new Error("")}release(){return this.global.hooks.onSetEnv.unTap("window",this.active),this._handler.releaseWindow()}getContext(){return this._handler.getContext()}getNativeHandler(){return this._handler.getNativeHandler()}getImageBuffer(r){return this._handler.getImageBuffer?this._handler.getImageBuffer(r):null}addEventListener(r,e,i){return this._handler.addEventListener(r,e,i)}removeEventListener(r,e,i){return this._handler.removeEventListener(r,e,i)}dispatchEvent(r){return this._handler.dispatchEvent(r)}getBoundingClientRect(){return this._handler.getBoundingClientRect()}getContainer(){return this._handler.container}clearViewBox(r){this._handler.clearViewBox(r)}setViewBox(r){this._handler.setViewBox(r)}setViewBoxTransform(r,e,i,n,o,l){this._handler.setViewBoxTransform(r,e,i,n,o,l)}getViewBox(){return this._handler.getViewBox()}getViewBoxTransform(){return this._handler.getViewBoxTransform()}pointTransform(r,e){const i=this._handler.getViewBox(),n={x:r,y:e};return this._handler.getViewBoxTransform().transformPoint({x:r,y:e},n),n.x-=i.x1,n.y-=i.y1,n}hasSubView(){const r=this._handler.getViewBox();return!(r.x1===0&&r.y1===0&&isNumberClose(this.width,r.width())&&isNumberClose(this.height,r.height()))}isVisible(r){return this._handler.isVisible(r)}onVisibleChange(r){return this._handler.onVisibleChange(r)}getTopLeft(r){return this._handler.getTopLeft(r)}};DefaultWindow=__decorate$18([injectable(),__metadata$S("design:paramtypes",[])],DefaultWindow);var __decorate$17=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$R=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$G=function(r,e){return function(i,n){e(i,n,r)}};let DefaultGraphicUtil=class{get canvas(){return this.tryInitCanvas(),this._canvas}get context(){return this.tryInitCanvas(),this._context}constructor(r){this.contributions=r,this.configured=!1,this.global=application.global,this.global.hooks.onSetEnv.tap("graphic-util",(e,i,n)=>{this.configured=!1,this.configure(n,i)})}get textMeasure(){return this._textMeasure||this.configure(this.global,this.global.env),this._textMeasure}configure(r,e){this.configured||(this.contributions.getContributions().forEach(i=>{i.configure(this,e)}),this.configured=!0)}tryInitCanvas(){if(!this._canvas){const r=canvasAllocate.shareCanvas();this._canvas=r,this._context=r.getContext("2d")}}bindTextMeasure(r){this._textMeasure=r}measureText(r,e,i="native"){var n;this.configure(this.global,this.global.env);const o=this.global.measureTextMethod;this.global.measureTextMethod=i;const l={width:this._textMeasure.measureTextWidth(r,e),height:(n=e.fontSize)!==null&&n!==void 0?n:DefaultTextStyle.fontSize};return this.global.measureTextMethod=o,l}createTextMeasureInstance(r,e,i){return this.configure(this.global,this.global.env),new TextMeasure(Object.assign({defaultFontParams:{fontFamily:DefaultTextStyle.fontFamily,fontSize:DefaultTextStyle.fontSize},getCanvasForMeasure:i||(()=>this.canvas),getTextBounds:void 0,specialCharSet:`-/: .,@%'"~`+TextMeasure.ALPHABET_CHAR_SET+TextMeasure.ALPHABET_CHAR_SET.toUpperCase()},e??{}),r)}drawGraphicToCanvas(r,e,i){if(!e.defaultLayer)return null;const n=container.get(VWindow),o=r.AABBBounds,l=o.width(),d=o.height(),u=-o.x1,f=-o.y1;n.create({viewBox:{x1:u,y1:f,x2:o.x2,y2:o.y2},width:l,height:d,canvas:i,dpr:e.window.dpr,canvasControled:!0,offscreen:!0,title:""});const g=e.params.optimize.disableCheckGraphicWidthOutRange;e.params.optimize.disableCheckGraphicWidthOutRange=!0,e.defaultLayer.getNativeHandler().drawTo(n,[r],{transMatrix:n.getViewBoxTransform(),viewBox:n.getViewBox(),stage:e,layer:e.defaultLayer,renderService:e.renderService,background:"transparent",clear:!0,updateBounds:!1}),e.params.optimize.disableCheckGraphicWidthOutRange=g;const _=n.getNativeHandler();return _.nativeCanvas?_.nativeCanvas:null}};DefaultGraphicUtil=__decorate$17([injectable(),__param$G(0,inject(ContributionProvider)),__param$G(0,named(TextMeasureContribution)),__metadata$R("design:paramtypes",[Object])],DefaultGraphicUtil);var TransformMode;(function(r){r[r.transform=0]="transform",r[r.matrix=1]="matrix"})(TransformMode||(TransformMode={}));const _matrix=new Matrix;let DefaultTransformUtil=class{constructor(){this.matrix=new Matrix}init(r){return this.mode=TransformMode.transform,this.originTransform=r,this.matrix.reset(),this}fromMatrix(r,e){return this.mode=TransformMode.matrix,this.outSourceMatrix=r,this.outTargetMatrix=e,this}scaleMatrix(r,e,i){const n=this.outSourceMatrix;if(_matrix.setValue(n.a,n.b,n.c,n.d,n.e,n.f),this.outTargetMatrix.reset(),i){const{x:o,y:l}=i;this.outTargetMatrix.translate(o,l),this.outTargetMatrix.scale(r,e),this.outTargetMatrix.translate(-o,-l)}else this.outTargetMatrix.scale(r,e);return this.outTargetMatrix.multiply(_matrix.a,_matrix.b,_matrix.c,_matrix.d,_matrix.e,_matrix.f),this}rotateMatrix(r,e){const i=this.outSourceMatrix;if(_matrix.setValue(i.a,i.b,i.c,i.d,i.e,i.f),this.outTargetMatrix.reset(),e){const{x:n,y:o}=e;this.outTargetMatrix.translate(n,o),this.outTargetMatrix.rotate(r),this.outTargetMatrix.translate(-n,-o)}else this.outTargetMatrix.rotate(r);return this.outTargetMatrix.multiply(_matrix.a,_matrix.b,_matrix.c,_matrix.d,_matrix.e,_matrix.f),this}scale(r,e,i){return this.mode===TransformMode.matrix?this.scaleMatrix(r,e,i):this}rotate(r,e){return this.mode===TransformMode.matrix?this.rotateMatrix(r,e):this}translateMatrix(r,e){const i=this.outSourceMatrix;return _matrix.setValue(i.a,i.b,i.c,i.d,i.e,i.f),this.outTargetMatrix.reset(),this.outTargetMatrix.translate(r,e),this.outTargetMatrix.multiply(_matrix.a,_matrix.b,_matrix.c,_matrix.d,_matrix.e,_matrix.f),this}translate(r,e){return this.mode===TransformMode.matrix?this.translateMatrix(r,e):this}simplify(r){return this.mode===TransformMode.matrix?this.simplifyMatrix(r):this}simplifyMatrix(r){return this}};DefaultTransformUtil=__decorate$17([injectable(),__metadata$R("design:paramtypes",[])],DefaultTransformUtil);const defaultThemeObj={arc:DefaultArcAttribute,area:DefaultAreaAttribute,circle:DefaultCircleAttribute,line:DefaultLineAttribute,path:DefaultPathAttribute,symbol:DefaultSymbolAttribute,text:DefaultTextAttribute,rect:DefaultRectAttribute,polygon:DefaultPolygonAttribute,richtext:DefaultRichTextAttribute,richtextIcon:DefaultRichTextIconAttribute,image:DefaultImageAttribute,group:DefaultGroupAttribute,glyph:DefaultGlyphAttribute},themeKeys=Object.keys(defaultThemeObj);function newThemeObj(){return{arc:Object.assign({},defaultThemeObj.arc),area:Object.assign({},defaultThemeObj.area),circle:Object.assign({},defaultThemeObj.circle),line:Object.assign({},defaultThemeObj.line),path:Object.assign({},defaultThemeObj.path),symbol:Object.assign({},defaultThemeObj.symbol),text:Object.assign({},defaultThemeObj.text),rect:Object.assign({},defaultThemeObj.rect),polygon:Object.assign({},defaultThemeObj.polygon),richtext:Object.assign({},defaultThemeObj.richtext),richtextIcon:Object.assign({},defaultThemeObj.richtextIcon),image:Object.assign({},defaultThemeObj.image),group:Object.assign({},defaultThemeObj.group),glyph:Object.assign({},defaultThemeObj.glyph)}}function combine(r,e){Object.keys(e).forEach(i=>{r[i]=e[i]})}const globalThemeObj=newThemeObj();class Theme{constructor(){this.initTheme(),this.dirty=!1}initTheme(){this._defaultTheme={},themeKeys.forEach(e=>{this._defaultTheme[e]=Object.create(globalThemeObj[e])}),this.combinedTheme=this._defaultTheme}getTheme(e){if(!e)return this.combinedTheme;if(!this.dirty)return this.combinedTheme;let i={};const n=this.getParentWithTheme(e);return n&&(i=n.theme),this.applyTheme(e,i),this.combinedTheme}getParentWithTheme(e){for(;e.parent;)if((e=e.parent).theme)return e;return null}applyTheme(e,i,n=!1){if(this.dirty){const o=this.getParentWithTheme(e);if(o){const l=o.theme;(l.dirty||n)&&l.applyTheme(o,i,!0)}this.userTheme?this.doCombine(o&&o.theme.combinedTheme):(o?this.combinedTheme=o.theme.combinedTheme:(this.combinedTheme=this._defaultTheme,Logger.getInstance().warn("")),this.dirty=!1)}return this.combinedTheme}doCombine(e){const i=this.userTheme,n=this.combinedTheme;themeKeys.forEach(o=>{const l=Object.create(globalThemeObj[o]);e&&e[o]&&combine(l,e[o]),n[o]&&combine(l,n[o]),i[o]&&combine(l,i[o]),this.combinedTheme[o]=l}),i.common&&themeKeys.forEach(o=>{combine(this.combinedTheme[o],i.common)}),this.dirty=!1}setTheme(e,i){let n=this.userTheme;n?Object.keys(e).forEach(o=>{n[o]?Object.assign(n[o],e[o]):n[o]=Object.assign({},e[o])}):n=e,this.userTheme=n,this.dirty=!0,this.dirtyChildren(i)}resetTheme(e,i){this.userTheme=e,this.dirty=!0,this.dirtyChildren(i)}dirtyChildren(e){e.forEachChildren(i=>{i.isContainer&&(i.theme&&(i.theme.dirty=!0),this.dirtyChildren(i))})}}const globalTheme=new Theme;function getTheme$1(r,e){return r.glyphHost?getTheme$1(r.glyphHost):e?(r.isContainer,e):getThemeFromGroup(r)||r.attachedThemeGraphic&&getTheme$1(r.attachedThemeGraphic)||globalTheme.getTheme()}function getThemeFromGroup(r){let e;if(e=r.isContainer?r:r.parent,e){for(;e&&!e.theme;)e=e.parent;return e?(e.theme||e.createTheme(),e.theme.getTheme(e)):globalTheme.getTheme()}return null}var __awaiter$8=function(r,e,i,n){return new(i||(i=Promise))(function(o,l){function d(g){try{f(n.next(g))}catch(_){l(_)}}function u(g){try{f(n.throw(g))}catch(_){l(_)}}function f(g){var _;g.done?o(g.value):(_=g.value,_ instanceof i?_:new i(function(y){y(_)})).then(d,u)}f((n=n.apply(r,e||[])).next())})};class Node extends EventEmitter{get previousSibling(){return this._prev}get nextSibling(){return this._next}get children(){return this.getChildren()}get firstChild(){return this._firstChild}get lastChild(){return this._lastChild}get count(){return this._count}get childrenCount(){return this._idMap?this._idMap.size:0}constructor(){super(),this._uid=Generator.GenAutoIncrementId(),this._firstChild=null,this._lastChild=null,this.parent=null,this._count=1}forEachChildren(e,i=!1){if(i){let n=this._lastChild,o=0;for(;n;){if(e(n,o++))return;n=n._prev}}else{let n=this._firstChild,o=0;for(;n;){if(e(n,o++))return;n=n._next}}}forEachChildrenAsync(e,i=!1){return __awaiter$8(this,void 0,void 0,function*(){if(i){let n=this._lastChild,o=0;for(;n;){let l=e(n,o++);if(l.then&&(l=yield l),l)return;n=n._prev}}else{let n=this._firstChild,o=0;for(;n;){let l=e(n,o++);if(l.then&&(l=yield l),l)return;n=n._next}}})}forEach(e){return this.forEachChildren(e)}appendChild(e,i=!0){if(this._uid===e._uid)return null;if(!i&&e.isAncestorsOf(this))throw new Error("Node::appendChildappend");return e.parent&&e.parent.removeChild(e),e.parent=this,this._lastChild?(this._lastChild._next=e,e._prev=this._lastChild,this._lastChild=e):(this._firstChild=this._lastChild=e,e._prev=e._next=null),this._idMap||(this._idMap=new Map),this._idMap.set(e._uid,e),this.setCount(e.count),this._structEdit=!0,e}appendChildArrHighPerformance(e,i=!1){return console.error(""),e}insertBefore(e,i){if(!i)return this.appendChild(e);if(this===e||e===i)return null;if(e.isAncestorsOf(this))throw new Error("Node::insertBeforeinsert");return i.parent!==this?null:(e.parent&&e.parent.removeChild(e),e.parent=this,e._prev=i._prev,i._prev?i._prev._next=e:this._firstChild=e,i._prev=e,e._next=i,this._idMap||(this._idMap=new Map),this._idMap.set(e._uid,e),this._structEdit=!0,this.setCount(e.count),e)}insertAfter(e,i){if(!i)return this.appendChild(e);if(this===e||e===i)return null;if(e.isAncestorsOf(this))throw new Error("Node::insertAfterinsert");return i.parent!==this?null:(e.parent&&e.parent.removeChild(e),e.parent=this,i._next?(i._next._prev=e,e._next=i._next):this._lastChild=e,i._next=e,e._prev=i,this._idMap||(this._idMap=new Map),this._idMap.set(e._uid,e),this._structEdit=!0,this.setCount(e.count),e)}insertInto(e,i){if(!this._ignoreWarn&&this._nodeList&&Logger.getInstance().warn("insertIntoKeepIdxinsertInto"),i>=this.childrenCount)return this.appendChild(e);if(this===e)return null;if(e.isAncestorsOf(this))throw new Error("Node::insertBeforeinsert");if(e.parent&&e.parent.removeChild(e),e.parent=this,i===0)e._next=this._firstChild,this._firstChild&&(this._firstChild._prev=e),e._prev=null,this._firstChild=e;else{let n=this._firstChild;for(let o=0;o<i;o++){if(!n)return null;o>0&&(n=n._next)}if(!n)return null;e._next=n._next,e._prev=n,n._next=e,e._next&&(e._next._prev=e)}return this._idMap||(this._idMap=new Map),this._idMap.set(e._uid,e),this._structEdit=!0,this.setCount(e.count),e}insertIntoKeepIdx(e,i){if(this._nodeList||(this._nodeList=this.children),this._nodeList[i]){const l=this._nodeList[i];return this._nodeList.splice(i,0,e),this.insertBefore(e,l)}let n;this._nodeList[i]=e;for(let l=i-1;l>=0&&(n=this._nodeList[l],!n);l--);if(n)return n._next?this.insertBefore(e,n._next):this.appendChild(e);this._ignoreWarn=!0;const o=this.insertInto(e,0);return this._ignoreWarn=!1,o}removeChild(e){if(!this._idMap||!this._idMap.has(e._uid))return null;if(this._idMap.delete(e._uid),this._nodeList){const i=this._nodeList.findIndex(n=>n===e);i>=0&&this._nodeList.splice(i,1)}return e._prev?e._prev._next=e._next:this._firstChild=e._next,e._next?e._next._prev=e._prev:this._lastChild=e._prev,e.parent=null,e._prev=null,e._next=null,this._structEdit=!0,this.setCount(-e.count),e}delete(){this.parent&&this.parent.removeChild(this)}removeAllChild(e){if(!this._idMap)return;this._nodeList&&(this._nodeList.length=0);let i=this._firstChild;for(;i;){const n=i._next;i.parent=null,i._prev=null,i._next=null,i=i._next,i=n}this._firstChild=null,this._lastChild=null,this._idMap.clear(),this._structEdit=!0,this.setCount(1-this._count)}replaceChild(e,i){throw new Error("")}find(e,i=!1){let n=null;return this.forEachChildren((o,l)=>!(o===this||!e(o,l))&&(n=o,!0)),i&&this.forEachChildren(o=>{if(o.isContainer){const l=o.find(e,!0);if(l)return n=l,!0}return!1}),n}findAll(e,i=!1){let n=[];return this.forEachChildren((o,l)=>{o!==this&&e(o,l)&&n.push(o)}),i&&this.forEachChildren(o=>{if(o.isContainer){const l=o.findAll(e,!0);l.length&&(n=n.concat(l))}}),n}getElementById(e){return this.find(i=>i.id===e,!0)}findChildById(e){return this.getElementById(e)}findChildByUid(e){return this._idMap&&this._idMap.get(e)||null}getElementsByName(e){return this.findAll(i=>i.name===e,!0)}findChildrenByName(e){return this.getElementsByName(e)}getElementsByType(e){return this.findAll(i=>i.type===e,!0)}getChildByName(e,i=!1){return this.find(n=>n.name===e,i)}getChildAt(e){let i=this._firstChild;if(!i)return null;for(let n=0;n<e;n++){if(!i._next)return null;i=i._next}return i}at(e){return this.getChildAt(e)}containNode(e){if(!this._idMap)return!1;if(this._idMap.has(e._uid))return!0;let i=this._firstChild;for(;i;){if(i.containNode(e))return!0;i=i._next}return!1}getRootNode(){let e=this.parent;for(;e!=null&&e.parent;)e=e.parent;return e||this}hasChildNodes(){return this._firstChild!==null}addChild(e){return this.appendChild(e)}add(e){return this.appendChild(e)}getChildren(){const e=[];let i=this._firstChild;for(;i;)e.push(i),i=i._next;return e}isChildOf(e){return!!this.parent&&this.parent._uid===e._uid}isParentOf(e){return e.isChildOf(this)}isDescendantsOf(e){let i=this.parent;if(!i)return!1;do{if(i._uid===e._uid)return!0;i=i.parent}while(i!==null);return!1}isAncestorsOf(e){return e.isDescendantsOf(this)}getAncestor(e){throw new Error("")}setAllDescendantsProps(e,i){let n=this._firstChild;for(;n;)n[e]=i,n.setAllDescendantsProps(e,i),n=n._next}setCount(e){this._count+=e;let i=this.parent;if(i)do i._count+=e,i=i.parent;while(i!==null)}clone(){throw new Error("")}cloneTo(e){throw new Error("")}getParent(){return this.parent}del(e){return this.removeChild(e)}addEventListener(e,i,n){const o=isBoolean(n,!0)&&n||isObject$1(n)&&n.capture,l=isObject$1(n)&&n.once,d=isFunction(i)?void 0:i;return e=o?`${e}capture`:e,i=isFunction(i)?i:i.handleEvent,l?super.once(e,i,d):super.on(e,i,d),this}on(e,i,n){return this.addEventListener(e,i,n)}removeEventListener(e,i,n){const o=isBoolean(n,!0)&&n||isObject$1(n)&&n.capture,l=isFunction(i)?void 0:i;e=o?`${e}capture`:e,i=isFunction(i)?i:i.handleEvent;const d=isObject$1(n)&&n.once;return super.off(e,i,l,d),this}off(e,i,n){return this.removeEventListener(e,i,n)}once(e,i,n){return isObject$1(n)?(n.once=!0,this.addEventListener(e,i,n)):this.addEventListener(e,i,{once:!0})}removeAllEventListeners(){return super.removeAllListeners(),this}removeAllListeners(){return this.removeAllEventListeners()}dispatchEvent(e,...i){return super.emit(e.type,e,...i),!e.defaultPrevented}emit(e,i){return this.dispatchEvent(e,i)}release(){this.removeAllListeners()}}class FederatedEvent{get layerX(){return this.layer.x}get layerY(){return this.layer.y}get pageX(){return this.page.x}get pageY(){return this.page.y}get x(){return this.canvas.x}get y(){return this.canvas.y}get canvasX(){return this.canvas.x}get canvasY(){return this.canvas.y}get viewX(){return this.viewport.x}get viewY(){return this.viewport.y}constructor(e){this.bubbles=!0,this.cancelBubble=!0,this.cancelable=!1,this.composed=!1,this.defaultPrevented=!1,this.eventPhase=FederatedEvent.prototype.NONE,this.propagationStopped=!1,this.propagationImmediatelyStopped=!1,this.layer={x:0,y:0},this.page={x:0,y:0},this.canvas={x:0,y:0},this.viewport={x:0,y:0},this.NONE=0,this.CAPTURING_PHASE=1,this.AT_TARGET=2,this.BUBBLING_PHASE=3,this.manager=e}composedPath(){return!this.manager||this.path&&this.path[this.path.length-1]===this.target||(this.path=this.target?this.manager.propagationPath(this.target):[]),this.composedDetailPath(),this.path}composedDetailPath(){return this.pickParams&&this.pickParams.graphic?(this.detailPath=this.path.slice(),this._composedDetailPath(this.pickParams)):this.detailPath=this.path.slice(),this.detailPath}_composedDetailPath(e){if(e&&e.graphic){const i=this.pickParams.graphic;if(i.stage){const n=i.stage.eventSystem.manager.propagationPath(i);this.detailPath.push(n),this._composedDetailPath(e.params)}}}preventDefault(){try{this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.preventDefault()}catch{this.nativeEvent.preventDefault&&isFunction(this.nativeEvent.preventDefault)&&this.nativeEvent.preventDefault()}this.defaultPrevented=!0}stopImmediatePropagation(){this.propagationImmediatelyStopped=!0}stopPropagation(){try{this.nativeEvent instanceof Event&&this.nativeEvent.cancelable&&this.nativeEvent.stopPropagation()}catch{this.nativeEvent.stopPropagation&&isFunction(this.nativeEvent.stopPropagation)&&this.nativeEvent.stopPropagation()}this.propagationStopped=!0}initEvent(){}initUIEvent(){}clone(){throw new Error("Method not implemented.")}}class FederatedMouseEvent extends FederatedEvent{constructor(){super(...arguments),this.client={x:0,y:0},this.movement={x:0,y:0},this.offset={x:0,y:0},this.global={x:0,y:0},this.screen={x:0,y:0}}get clientX(){return this.client.x}get clientY(){return this.client.y}get movementX(){return this.movement.x}get movementY(){return this.movement.y}get offsetX(){return this.offset.x}get offsetY(){return this.offset.y}get globalX(){return this.global.x}get globalY(){return this.global.y}get screenX(){return this.screen.x}get screenY(){return this.screen.y}getModifierState(e){return"getModifierState"in this.nativeEvent&&this.nativeEvent.getModifierState(e)}initMouseEvent(e,i,n,o,l,d,u,f,g,_,y,b,S,v,A){throw new Error("Method not implemented.")}}class FederatedPointerEvent extends FederatedMouseEvent{constructor(){super(...arguments),this.width=0,this.height=0,this.isPrimary=!1}getCoalescedEvents(){return this.type==="pointermove"||this.type==="mousemove"||this.type==="touchmove"?[this]:[]}getPredictedEvents(){throw new Error("getPredictedEvents is not supported!")}clone(){var e,i,n;const o=new FederatedPointerEvent(this.manager);o.eventPhase=o.NONE,o.currentTarget=null,o.path=[],o.detailPath=[],o.target=null,o.nativeEvent=this.nativeEvent,o.originalEvent=this.originalEvent,(e=this.manager)===null||e===void 0||e.copyPointerData(this,o),(i=this.manager)===null||i===void 0||i.copyMouseData(this,o),(n=this.manager)===null||n===void 0||n.copyData(this,o),o.target=this.target,o.path=this.composedPath().slice();const l=this.composedDetailPath();return o.detailPath=l&&l.slice(),o.type=this.type,o}}class FederatedWheelEvent extends FederatedMouseEvent{constructor(){super(...arguments),this.DOM_DELTA_PIXEL=0,this.DOM_DELTA_LINE=1,this.DOM_DELTA_PAGE=2}clone(){var e,i,n;const o=new FederatedWheelEvent(this.manager);o.eventPhase=o.NONE,o.currentTarget=null,o.path=[],o.detailPath=[],o.target=null,o.nativeEvent=this.nativeEvent,o.originalEvent=this.originalEvent,(e=this.manager)===null||e===void 0||e.copyWheelData(this,o),(i=this.manager)===null||i===void 0||i.copyMouseData(this,o),(n=this.manager)===null||n===void 0||n.copyData(this,o),o.target=this.target,o.path=this.composedPath().slice();const l=this.composedDetailPath();return o.detailPath=l&&l.slice(),o.type=this.type,o}}FederatedWheelEvent.DOM_DELTA_PIXEL=0,FederatedWheelEvent.DOM_DELTA_LINE=1,FederatedWheelEvent.DOM_DELTA_PAGE=2;class CustomEvent extends FederatedEvent{constructor(e,i){super(),this.type=e,this.detail=i}}const WILDCARD="*",clock=typeof performance=="object"&&performance.now?performance:Date;function isMouseLike(r){return r==="mouse"||r==="pen"}class EventManager{constructor(e,i){this.dispatch=new EventEmitter,this.cursorTarget=null,this.pauseNotify=!1,this.mappingState={trackingData:{}},this.eventPool=new Map,this.onPointerDown=(n,o)=>{if(!(n instanceof FederatedPointerEvent))return void Logger.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");const l=this.createPointerEvent(n,n.type,o);if(this.dispatchEvent(l,"pointerdown"),l.pointerType==="touch")this.dispatchEvent(l,"touchstart");else if(isMouseLike(l.pointerType)){const d=l.button===2;this.dispatchEvent(l,d?"rightdown":"mousedown")}this.trackingData(n.pointerId).pressTargetsByButton[n.button]=l.composedPath(),this.freeEvent(l)},this.onPointerMove=(n,o)=>{var l,d;if(!(n instanceof FederatedPointerEvent))return void Logger.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");const u=this.createPointerEvent(n,n.type,o),f=isMouseLike(u.pointerType),g=this.trackingData(n.pointerId),_=this.findMountedTarget(g.overTargets);if(g.overTargets&&_&&_!==this.rootTarget&&_!==u.target){const y=n.type==="mousemove"?"mouseout":"pointerout",b=this.createPointerEvent(n,y,_||void 0);if(this.dispatchEvent(b,"pointerout"),f&&this.dispatchEvent(b,"mouseout"),!u.composedPath().includes(_)){const S=this.createPointerEvent(n,"pointerleave",_||void 0);for(S.eventPhase=S.AT_TARGET;S.target&&!u.composedPath().includes(S.target);)S.currentTarget=S.target,this.notifyTarget(S),f&&this.notifyTarget(S,"mouseleave"),S.target=S.target.parent;this.freeEvent(S)}this.freeEvent(b)}if(_!==u.target){const y=n.type==="mousemove"?"mouseover":"pointerover",b=this.clonePointerEvent(u,y);this.dispatchEvent(b,"pointerover"),f&&this.dispatchEvent(b,"mouseover");let S=_==null?void 0:_.parent;for(;S&&S!==this.rootTarget.parent&&S!==u.target;)S=S.parent;if(!S||S===this.rootTarget.parent){const v=this.clonePointerEvent(u,"pointerenter");v.eventPhase=v.AT_TARGET;let A=v.target;const x=new Set;let T=_;for(;T&&T!==this.rootTarget;)x.add(T),T=T.parent;for(;A&&A!==_&&A!==this.rootTarget.parent;)x.has(A)||(v.currentTarget=A,this.notifyTarget(v),f&&this.notifyTarget(v,"mouseenter")),A=A.parent;this.freeEvent(v)}this.freeEvent(b)}this.dispatchEvent(u,"pointermove"),u.pointerType==="touch"&&this.dispatchEvent(u,"touchmove"),f&&(this.dispatchEvent(u,"mousemove"),this.cursorTarget=u.target,this.cursor=((d=(l=u.target)===null||l===void 0?void 0:l.attribute)===null||d===void 0?void 0:d.cursor)||this.rootTarget.getCursor()),g.overTargets=u.composedPath(),this.freeEvent(u)},this.onPointerOver=(n,o)=>{var l,d;if(!(n instanceof FederatedPointerEvent))return void Logger.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");const u=this.trackingData(n.pointerId),f=this.createPointerEvent(n,n.type,o),g=isMouseLike(f.pointerType);this.dispatchEvent(f,"pointerover"),g&&this.dispatchEvent(f,"mouseover"),f.pointerType==="mouse"&&(this.cursorTarget=f.target,this.cursor=((d=(l=f.target)===null||l===void 0?void 0:l.attribute)===null||d===void 0?void 0:d.cursor)||this.rootTarget.getCursor());const _=this.clonePointerEvent(f,"pointerenter");for(_.eventPhase=_.AT_TARGET;_.target&&_.target!==this.rootTarget.parent;)_.currentTarget=_.target,this.notifyTarget(_),g&&this.notifyTarget(_,"mouseenter"),_.target=_.target.parent;u.overTargets=f.composedPath(),this.freeEvent(f),this.freeEvent(_)},this.onPointerOut=(n,o)=>{if(!(n instanceof FederatedPointerEvent))return void Logger.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");const l=this.trackingData(n.pointerId);if(l.overTargets){const d=isMouseLike(n.pointerType),u=this.findMountedTarget(l.overTargets),f=this.createPointerEvent(n,"pointerout",u||void 0);this.dispatchEvent(f),d&&this.dispatchEvent(f,"mouseout");const g=this.createPointerEvent(n,"pointerleave",u||void 0);for(g.eventPhase=g.AT_TARGET;g.target&&g.target!==this.rootTarget.parent;)g.currentTarget=g.target,this.notifyTarget(g),d&&this.notifyTarget(g,"mouseleave"),g.target=g.target.parent;l.overTargets=[],this.freeEvent(f),this.freeEvent(g)}this.cursorTarget=null,this.cursor=""},this.onPointerUp=(n,o)=>{var l;if(!(n instanceof FederatedPointerEvent))return void Logger.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");const d=clock.now(),u=this.createPointerEvent(n,n.type,o);if(this.dispatchEvent(u,"pointerup"),u.pointerType==="touch")this.dispatchEvent(u,"touchend");else if(isMouseLike(u.pointerType)){const y=u.button===2;this.dispatchEvent(u,y?"rightup":"mouseup")}const f=this.trackingData(n.pointerId),g=this.findMountedTarget(f.pressTargetsByButton[n.button]);let _=g;if(g&&!u.composedPath().includes(g)){let y=g;for(;y&&!u.composedPath().includes(y);){if(u.currentTarget=y,this.notifyTarget(u,"pointerupoutside"),u.pointerType==="touch")this.notifyTarget(u,"touchendoutside");else if(isMouseLike(u.pointerType)){const b=u.button===2;this.notifyTarget(u,b?"rightupoutside":"mouseupoutside")}y=y.parent}delete f.pressTargetsByButton[n.button],_=y}if(_){const y=this.clonePointerEvent(u,"click");y.target=_,y.path=[],y.detailPath=[],f.clicksByButton[n.button]||(f.clicksByButton[n.button]={clickCount:0,target:y.target,timeStamp:d});const b=f.clicksByButton[n.button];b.target===y.target&&d-b.timeStamp<((l=this._config.clickInterval)!==null&&l!==void 0?l:200)?++b.clickCount:b.clickCount=1,b.target=y.target,b.timeStamp=d,y.detail=b.clickCount,isMouseLike(y.pointerType)?(this.dispatchEvent(y,"click"),b.clickCount===2&&this.dispatchEvent(y,"dblclick")):y.pointerType==="touch"&&this._config.supportsTouchEvents&&(this.dispatchEvent(y,"tap"),b.clickCount===2&&this.dispatchEvent(y,"dbltap")),this.dispatchEvent(y,"pointertap"),this.freeEvent(y)}this.freeEvent(u)},this.onPointerUpOutside=(n,o)=>{if(!(n instanceof FederatedPointerEvent))return void Logger.getInstance().warn("EventManager cannot map a non-pointer event as a pointer event");const l=this.trackingData(n.pointerId),d=this.findMountedTarget(l.pressTargetsByButton[n.button]),u=this.createPointerEvent(n,n.type,o);if(d){let f=d;for(;f;)u.currentTarget=f,this.notifyTarget(u,"pointerupoutside"),u.pointerType==="touch"?this.notifyTarget(u,"touchendoutside"):isMouseLike(u.pointerType)&&this.notifyTarget(u,u.button===2?"rightupoutside":"mouseupoutside"),f=f.parent;delete l.pressTargetsByButton[n.button]}this.freeEvent(u)},this.onWheel=(n,o)=>{if(!(n instanceof FederatedWheelEvent))return void Logger.getInstance().warn("EventManager cannot map a non-wheel event as a wheel event");const l=this.createWheelEvent(n,o);this.dispatchEvent(l),this.freeEvent(l)},this.rootTarget=e,this.mappingTable={},this._config=Object.assign({clickInterval:200},i),this.addEventMapping("pointerdown",this.onPointerDown),this.addEventMapping("pointermove",this.onPointerMove),this.addEventMapping("pointerout",this.onPointerOut),this.addEventMapping("pointerleave",this.onPointerOut),this.addEventMapping("pointerover",this.onPointerOver),this.addEventMapping("pointerup",this.onPointerUp),this.addEventMapping("pointerupoutside",this.onPointerUpOutside),this.addEventMapping("wheel",this.onWheel)}addEventMapping(e,i){this.mappingTable[e]||(this.mappingTable[e]=[]),this.mappingTable[e].push({fn:i,priority:0}),this.mappingTable[e].sort((n,o)=>n.priority-o.priority)}dispatchEvent(e,i){e.propagationStopped=!1,e.propagationImmediatelyStopped=!1,this.propagate(e,i),this.dispatch.emit(i||e.type,e)}mapEvent(e){var i,n,o,l,d,u,f;if(!this.rootTarget)return;const g=this.mappingTable[e.type];let _;const y=`${e.canvasX}-${e.canvasY}`;if(!((i=this._prePointTargetCache)===null||i===void 0)&&i[y]&&(!((o=(n=this._prePointTargetCache)===null||n===void 0?void 0:n[y])===null||o===void 0)&&o.stage)&&((d=(l=this._prePointTargetCache)===null||l===void 0?void 0:l[y])===null||d===void 0?void 0:d.stage.renderCount)===((u=this._prePointTargetCache)===null||u===void 0?void 0:u.stageRenderCount)?_=this._prePointTargetCache[y]:(_=this.pickTarget(e.viewX,e.viewY,e),e.pickParams||(this._prePointTargetCache={[y]:_,stageRenderCount:(f=_==null?void 0:_.stage.renderCount)!==null&&f!==void 0?f:-1})),g)for(let b=0,S=g.length;b<S;b++)g[b].fn(e,_);else Logger.getInstance().warn(`[EventManager]: Event mapping not defined for ${e.type}`)}propagate(e,i){if(!e.target)return;const n=e.composedPath();e.eventPhase=e.CAPTURING_PHASE;for(let o=0,l=n.length-1;o<l;o++)if(e.currentTarget=n[o],this.notifyTarget(e,i),e.propagationStopped||e.propagationImmediatelyStopped)return;if(e.eventPhase=e.AT_TARGET,e.currentTarget=e.target,this.notifyTarget(e,i),!e.propagationStopped&&!e.propagationImmediatelyStopped){e.eventPhase=e.BUBBLING_PHASE;for(let o=n.length-2;o>=0;o--)if(e.currentTarget=n[o],this.notifyTarget(e,i),e.propagationStopped||e.propagationImmediatelyStopped)return}}propagationPath(e){const i=[e];for(let n=0;n<2048&&e!==this.rootTarget&&e.parent;n++){if(!e.parent)throw new Error("Cannot find propagation path to disconnected target");i.push(e.parent),e=e.parent}return i.reverse(),i}notifyTarget(e,i){if(this.pauseNotify)return;i=i??e.type;const n=e.eventPhase===e.CAPTURING_PHASE||e.eventPhase===e.AT_TARGET?`${i}capture`:i;this.notifyListeners(e,n),e.eventPhase===e.AT_TARGET&&this.notifyListeners(e,i)}findMountedTarget(e){if(!e)return null;let i=e[0];for(let n=1;n<e.length&&e[n].parent===i;n++)i=e[n];return i}createPointerEvent(e,i,n){var o,l;const d=this.allocateEvent(FederatedPointerEvent);return this.copyPointerData(e,d),this.copyMouseData(e,d),this.copyData(e,d),d.nativeEvent=e.nativeEvent,d.originalEvent=e,d.target=n||this.pickTarget((o=d.viewX)!==null&&o!==void 0?o:d.global.x,(l=d.viewY)!==null&&l!==void 0?l:d.global.y,d),typeof i=="string"&&(d.type=i),d}createWheelEvent(e,i){var n,o;const l=this.allocateEvent(FederatedWheelEvent);return this.copyWheelData(e,l),this.copyMouseData(e,l),this.copyData(e,l),l.nativeEvent=e.nativeEvent,l.originalEvent=e,l.target=i||this.pickTarget((n=l.viewX)!==null&&n!==void 0?n:l.global.x,(o=l.viewY)!==null&&o!==void 0?o:l.global.y,l),l}clonePointerEvent(e,i){const n=this.allocateEvent(FederatedPointerEvent);n.nativeEvent=e.nativeEvent,n.originalEvent=e.originalEvent,this.copyPointerData(e,n),this.copyMouseData(e,n),this.copyData(e,n),n.target=e.target,n.path=e.composedPath().slice();const o=e.composedDetailPath();return n.detailPath=o&&o.slice(),n.type=i??n.type,n}copyWheelData(e,i){i.deltaMode=e.deltaMode,i.deltaX=e.deltaX,i.deltaY=e.deltaY,i.deltaZ=e.deltaZ}copyPointerData(e,i){e instanceof FederatedPointerEvent&&i instanceof FederatedPointerEvent&&(i.pointerId=e.pointerId,i.width=e.width,i.height=e.height,i.isPrimary=e.isPrimary,i.pointerType=e.pointerType,i.pressure=e.pressure,i.tangentialPressure=e.tangentialPressure,i.tiltX=e.tiltX,i.tiltY=e.tiltY,i.twist=e.twist)}copyMouseData(e,i){e instanceof FederatedMouseEvent&&i instanceof FederatedMouseEvent&&(i.altKey=e.altKey,i.button=e.button,i.buttons=e.buttons,i.ctrlKey=e.ctrlKey,i.shiftKey=e.shiftKey,i.metaKey=e.metaKey,["client","movement","canvas","screen","global","offset","viewport"].forEach(n=>{i[n].x=e[n].x,i[n].y=e[n].y}))}copyData(e,i){i.isTrusted=e.isTrusted,i.srcElement=e.srcElement,i.timeStamp=clock.now(),i.type=e.type,i.detail=e.detail,i.view=e.view,i.which=e.which,i.layer.x=e.layer.x,i.layer.y=e.layer.y,i.page.x=e.page.x,i.page.y=e.page.y,i.pickParams=e.pickParams}trackingData(e){return this.mappingState.trackingData[e]||(this.mappingState.trackingData[e]={pressTargetsByButton:{},clicksByButton:{},overTarget:null}),this.mappingState.trackingData[e]}allocateEvent(e){var i;this.eventPool.has(e)||this.eventPool.set(e,[]);const n=((i=this.eventPool.get(e))===null||i===void 0?void 0:i.pop())||new e(this);return n.eventPhase=n.NONE,n.currentTarget=null,n.path=[],n.detailPath=[],n.target=null,n}freeEvent(e){var i;if(e.manager!==this)throw new Error("It is illegal to free an event not managed by this EventManager!");const n=e.constructor;this.eventPool.has(n)||this.eventPool.set(n,[]),(i=this.eventPool.get(n))===null||i===void 0||i.push(e)}notifyListeners(e,i){const n=e.currentTarget._events[i];if(n)if("fn"in n)n.once&&e.currentTarget.removeEventListener(i,n.fn,{once:!0}),n.fn.call(n.context,e);else for(let o=0,l=n.length;o<l&&!e.propagationImmediatelyStopped;o++)n[o].once&&e.currentTarget.removeEventListener(i,n[o].fn,{once:!0}),n[o].fn.call(n[o].context,e);this.emitDelegation(e,i)}emitDelegation(e,i){const n=e.currentTarget._events[WILDCARD];if(n)if("fn"in n)n.fn.call(n.context,e,i);else for(let o=0,l=n.length;o<l&&!e.propagationImmediatelyStopped;o++)n[o].fn.call(n[o].context,e,i)}pickTarget(e,i,n){let o;const l=this.rootTarget.pick(e,i);return o=l&&l.graphic?l.graphic:l&&l.group?l.group:this.rootTarget.AABBBounds.contains(e,i)?this.rootTarget:null,n&&(n.pickParams=l.params),o}release(){this.dispatch.removeAllListeners(),this.eventPool.clear(),this.rootTarget=null,this.mappingTable=null,this.mappingState=null,this.cursorTarget=null}}const EventTarget={dispatchEvent(r){var e;if(!(r instanceof FederatedEvent))throw new Error("DisplayObject cannot propagate events outside of the Federated Events API");return r.defaultPrevented=!1,r.path=[],r.detailPath&&(r.detailPath=[]),r.target=this,(e=r==null?void 0:r.manager)===null||e===void 0||e.dispatchEvent(r),!r.defaultPrevented},emit(r,e){return this.dispatchEvent(new CustomEvent(r,e))}},TOUCH_TO_POINTER={touchstart:"pointerdown",touchend:"pointerup",touchendoutside:"pointerupoutside",touchmove:"pointermove",touchcancel:"pointercancel"};class EventSystem{constructor(e){this.resolution=1,this.onPointerDown=_=>{if(this.supportsTouchEvents&&_.pointerType==="touch")return;const y=this.normalizeToPointerData(_);this.autoPreventDefault&&y[0].isNormalized&&(_.cancelable||!("cancelable"in _))&&_.preventDefault();for(let b=0,S=y.length;b<S;b++){const v=y[b],A=this.bootstrapEvent(this.rootPointerEvent,v);this.manager.mapEvent(A)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onPointerMove=_=>{if(this.supportsTouchEvents&&_.pointerType==="touch"||this.isEventOutsideOfTargetElement(_))return;const y=this.normalizeToPointerData(_);for(let b=0,S=y.length;b<S;b++){const v=this.bootstrapEvent(this.rootPointerEvent,y[b]);this.manager.mapEvent(v)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onPointerUp=_=>{if(this.supportsTouchEvents&&_.pointerType==="touch")return;const y=this.isEventOutsideOfTargetViewPort(_)?"outside":"",b=this.normalizeToPointerData(_);for(let S=0,v=b.length;S<v;S++){const A=this.bootstrapEvent(this.rootPointerEvent,b[S]);A.type+=y,this.manager.mapEvent(A)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onPointerOverOut=_=>{if(this.supportsTouchEvents&&_.pointerType==="touch")return;const y=this.normalizeToPointerData(_);for(let b=0,S=y.length;b<S;b++){const v=this.bootstrapEvent(this.rootPointerEvent,y[b]);this.manager.mapEvent(v)}this.setCursor(this.manager.cursor,this.manager.cursorTarget),this.rootPointerEvent.nativeEvent=null},this.onWheel=_=>{const y=this.normalizeWheelEvent(_);this.manager.mapEvent(y)};const{targetElement:i,resolution:n,rootNode:o,global:l,autoPreventDefault:d=!1,clickInterval:u,supportsTouchEvents:f=l.supportsTouchEvents,supportsPointerEvents:g=l.supportsPointerEvents}=e;this.manager=new EventManager(o,{clickInterval:u,supportsTouchEvents:f}),this.globalObj=l,this.supportsPointerEvents=g,this.supportsTouchEvents=f,this.supportsMouseEvents=l.supportsMouseEvents,this.applyStyles=l.applyStyles,this.autoPreventDefault=d,this.eventsAdded=!1,this.rootPointerEvent=new FederatedPointerEvent,this.rootWheelEvent=new FederatedWheelEvent,this.cursorStyles={default:"inherit",pointer:"pointer"},this.resolution=n,this.setTargetElement(i)}release(){this.removeEvents(),this.manager&&this.manager.release(),this.domElement=null,this.manager=null,this.globalObj=null}setCursor(e,i){if(!i&&!this.manager.rootTarget.window._handler.canvas.controled)return;e||(e="default");const{applyStyles:n,domElement:o}=this;if(this.currentCursor===e)return;this.currentCursor=e;const l=this.cursorStyles[e];l?typeof l=="string"&&n?o.style.cursor=l:typeof l=="function"?l(e):typeof l=="object"&&n&&Object.assign(o.style,l):n&&isString(e)&&!has(this.cursorStyles,e)&&(o.style.cursor=e)}setTargetElement(e){this.removeEvents(),this.domElement=e,this.addEvents()}addEvents(){if(this.eventsAdded||!this.domElement)return;const{globalObj:e,domElement:i}=this;this.supportsPointerEvents?(e.getDocument()?(e.getDocument().addEventListener("pointermove",this.onPointerMove,!0),e.getDocument().addEventListener("pointerup",this.onPointerUp,!0)):(i.addEventListener("pointermove",this.onPointerMove,!0),i.addEventListener("pointerup",this.onPointerUp,!0)),i.addEventListener("pointerdown",this.onPointerDown,!0),i.addEventListener("pointerleave",this.onPointerOverOut,!0),i.addEventListener("pointerover",this.onPointerOverOut,!0)):(e.getDocument()?(e.getDocument().addEventListener("mousemove",this.onPointerMove,!0),e.getDocument().addEventListener("mouseup",this.onPointerUp,!0)):(i.addEventListener("mousemove",this.onPointerMove,!0),i.addEventListener("mouseup",this.onPointerUp,!0)),i.addEventListener("mousedown",this.onPointerDown,!0),i.addEventListener("mouseout",this.onPointerOverOut,!0),i.addEventListener("mouseover",this.onPointerOverOut,!0)),this.supportsTouchEvents&&(i.addEventListener("touchstart",this.onPointerDown,!0),i.addEventListener("touchend",this.onPointerUp,!0),i.addEventListener("touchmove",this.onPointerMove,!0)),i.addEventListener("wheel",this.onWheel,{capture:!0}),this.eventsAdded=!0}removeEvents(){if(!this.eventsAdded||!this.domElement)return;const{globalObj:e,domElement:i}=this;this.supportsPointerEvents?(e.getDocument()?(e.getDocument().removeEventListener("pointermove",this.onPointerMove,!0),e.getDocument().removeEventListener("pointerup",this.onPointerUp,!0)):(i.removeEventListener("pointermove",this.onPointerMove,!0),i.removeEventListener("pointerup",this.onPointerUp,!0)),i.removeEventListener("pointerdown",this.onPointerDown,!0),i.removeEventListener("pointerleave",this.onPointerOverOut,!0),i.removeEventListener("pointerover",this.onPointerOverOut,!0)):(e.getDocument()?(e.getDocument().removeEventListener("mousemove",this.onPointerMove,!0),e.getDocument().removeEventListener("mouseup",this.onPointerUp,!0)):(i.removeEventListener("mousemove",this.onPointerMove,!0),i.removeEventListener("mouseup",this.onPointerUp,!0)),i.removeEventListener("mousedown",this.onPointerDown,!0),i.removeEventListener("mouseout",this.onPointerOverOut,!0),i.removeEventListener("mouseover",this.onPointerOverOut,!0)),this.supportsTouchEvents&&(i.removeEventListener("touchstart",this.onPointerDown,!0),i.removeEventListener("touchend",this.onPointerUp,!0),i.removeEventListener("touchmove",this.onPointerMove,!0)),i.removeEventListener("wheel",this.onWheel,!0),this.domElement=null,this.eventsAdded=!1}mapToViewportPoint(e){return this.domElement.pointTransform?this.domElement.pointTransform(e.x,e.y):e}mapToCanvasPoint(e){var i,n;const o=(i=this.globalObj)===null||i===void 0?void 0:i.mapToCanvasPoint(e,this.domElement);if(o)return o;let l=0,d=0;if(e.changedTouches){const f=(n=e.changedTouches[0])!==null&&n!==void 0?n:{};l=f.clientX||0,d=f.clientY||0}else l=e.clientX||0,d=e.clientY||0;const u=this.domElement.getBoundingClientRect();return{x:l-u.left,y:d-u.top}}normalizeToPointerData(e){const i=[];if(this.supportsTouchEvents&&e.changedTouches&&e.changedTouches.length)for(let n=0,o=e.changedTouches.length;n<o;n++){const l=e.changedTouches[n];isUndefined(l.button)&&(l.button=0),isUndefined(l.buttons)&&(l.buttons=1),isUndefined(l.isPrimary)&&(l.isPrimary=e.touches.length===1&&e.type==="touchstart"),isUndefined(l.width)&&(l.width=l.radiusX||1),isUndefined(l.height)&&(l.height=l.radiusY||1),isUndefined(l.tiltX)&&(l.tiltX=0),isUndefined(l.tiltY)&&(l.tiltY=0),isUndefined(l.pointerType)&&(l.pointerType="touch"),isUndefined(l.pointerId)&&(l.pointerId=l.identifier||0),isUndefined(l.pressure)&&(l.pressure=l.force||.5),isUndefined(l.twist)&&(l.twist=0),isUndefined(l.tangentialPressure)&&(l.tangentialPressure=0),isUndefined(l.layerX)&&(l.layerX=l.offsetX=l.clientX),isUndefined(l.layerY)&&(l.layerY=l.offsetY=l.clientY),l.isNormalized=!0,l.type=e.type,i.push(l)}else if(this.globalObj.supportsMouseEvents&&(!(e instanceof MouseEvent)||this.supportsPointerEvents&&e instanceof PointerEvent))i.push(e);else{const n=e;isUndefined(n.isPrimary)&&(n.isPrimary=!0),isUndefined(n.width)&&(n.width=1),isUndefined(n.height)&&(n.height=1),isUndefined(n.tiltX)&&(n.tiltX=0),isUndefined(n.tiltY)&&(n.tiltY=0),isUndefined(n.pointerType)&&(n.pointerType="mouse"),isUndefined(n.pointerId)&&(n.pointerId=1),isUndefined(n.pressure)&&(n.pressure=.5),isUndefined(n.twist)&&(n.twist=0),isUndefined(n.tangentialPressure)&&(n.tangentialPressure=0),n.isNormalized=!0,i.push(n)}return i}normalizeWheelEvent(e){const i=this.rootWheelEvent;this.transferMouseData(i,e),i.deltaMode=e.deltaMode,i.deltaX=e.deltaX,i.deltaY=e.deltaY,i.deltaZ=e.deltaZ;const{x:n,y:o}=this.mapToCanvasPoint(e);i.canvas.x=n,i.canvas.y=o,i.global.x=n,i.global.y=o,i.offset.x=n,i.offset.y=o;const{x:l,y:d}=this.mapToViewportPoint(i);return i.viewport.x=l,i.viewport.y=d,i.nativeEvent=e,i.type=e.type,i}bootstrapEvent(e,i){e.originalEvent=null,e.nativeEvent=i,e.pointerId=i.pointerId,e.width=i.width,e.height=i.height,e.isPrimary=i.isPrimary,e.pointerType=i.pointerType,e.pressure=i.pressure,e.tangentialPressure=i.tangentialPressure,e.tiltX=i.tiltX,e.tiltY=i.tiltY,e.twist=i.twist,this.transferMouseData(e,i);const{x:n,y:o}=this.mapToCanvasPoint(i);e.canvas.x=n,e.canvas.y=o,e.global.x=n,e.global.y=o,e.offset.x=n,e.offset.y=o;const{x:l,y:d}=this.mapToViewportPoint(e);return e.viewport.x=l,e.viewport.y=d,e.isTrusted=i.isTrusted,e.type==="pointerleave"&&(e.type="pointerout"),e.type.startsWith("mouse")&&(e.type=e.type.replace("mouse","pointer")),e.type.startsWith("touch")&&(e.type=TOUCH_TO_POINTER[e.type]||e.type),e}transferMouseData(e,i){e.isTrusted=i.isTrusted,e.srcElement=i.srcElement,e.timeStamp=clock.now(),e.type=i.type,e.altKey=i.altKey,e.button=i.button,e.buttons=i.buttons,e.client.x=i.clientX,e.client.y=i.clientY,e.ctrlKey=i.ctrlKey,e.shiftKey=i.shiftKey,e.metaKey=i.metaKey,e.movement.x=i.movementX,e.movement.y=i.movementY,e.page.x=i.pageX,e.page.y=i.pageY,e.relatedTarget=null}isEventOutsideOfTargetViewPort(e){if(this.isEventOutsideOfTargetElement(e))return!0;if(this.domElement.getViewBox){const i=this.mapToViewportPoint(this.mapToCanvasPoint(e)),n=this.domElement.getViewBox(),o=n.width(),l=n.height();return!(i.x<o&&i.y<l&&i.x>0&&i.y>0)}return!1}isEventOutsideOfTargetElement(e){let i=e.target;return e.composedPath&&e.composedPath().length>0&&(i=e.composedPath()[0]),i!==(this.domElement.getNativeHandler?this.domElement.getNativeHandler().nativeCanvas:this.domElement)}pauseTriggerEvent(){this.manager.pauseNotify=!0}resumeTriggerEvent(){this.manager.pauseNotify=!1}}var STATUS$1;(function(r){r[r.INITIAL=0]="INITIAL",r[r.RUNNING=1]="RUNNING",r[r.PAUSE=2]="PAUSE"})(STATUS$1||(STATUS$1={}));class RAFTickHandler{static Avaliable(){return!!application.global.getRequestAnimationFrame()}avaliable(){return RAFTickHandler.Avaliable()}tick(e,i){application.global.getRequestAnimationFrame()(()=>{this.released||i(this)})}release(){this.released=!0}getTime(){return Date.now()}}class TimeOutTickHandler{static Avaliable(){return!0}avaliable(){return TimeOutTickHandler.Avaliable()}tick(e,i){this.timerId=setTimeout(()=>{i(this)},e)}release(){this.timerId>0&&(clearTimeout(this.timerId),this.timerId=-1)}getTime(){return Date.now()}}class DefaultTicker extends EventEmitter{set mode(e){this._mode!==e&&(this._mode=e,this.setupTickHandler())}get mode(){return this._mode}constructor(e=[]){super(),this.handleTick=(i,n)=>{const{once:o=!1}=n??{};this.ifCanStop()?this.stop():(this._handlerTick(),o||i.tick(this.interval,this.handleTick))},this._handlerTick=()=>{const i=this.tickerHandler.getTime();let n=0;this.lastFrameTime>=0&&(n=i-this.lastFrameTime),this.lastFrameTime=i,this.status===STATUS$1.RUNNING&&(this.tickCounts++,this.timelines.forEach(o=>{o.tick(n)}),this.emit("afterTick"))},this.init(),this.lastFrameTime=-1,this.tickCounts=0,this.timelines=e,this.autoStop=!0}init(){this.interval=NaN,this.status=STATUS$1.INITIAL,application.global.hooks.onSetEnv.tap("default-ticker",()=>{this.initHandler()}),application.global.env&&this.initHandler()}addTimeline(e){this.timelines.push(e)}remTimeline(e){this.timelines=this.timelines.filter(i=>i!==e)}initHandler(){if(this._mode)return null;const e=[{mode:"raf",cons:RAFTickHandler},{mode:"timeout",cons:TimeOutTickHandler}];for(let i=0;i<e.length;i++)if(e[i].cons.Avaliable()){this.mode=e[i].mode;break}return null}setupTickHandler(){let e;switch(this._mode){case"raf":e=new RAFTickHandler;break;case"timeout":e=new TimeOutTickHandler;break;default:Logger.getInstance().warn(""),e=new RAFTickHandler}return!!e.avaliable()&&(this.tickerHandler&&this.tickerHandler.release(),this.tickerHandler=e,!0)}setInterval(e){this.interval=e}getInterval(){return this.interval}setFPS(e){this.setInterval(1e3/e)}getFPS(){return 1e3/this.interval}tick(e){this.tickerHandler.tick(e,i=>{this.handleTick(i,{once:!0})})}tickTo(e){this.tickerHandler.tickTo&&this.tickerHandler.tickTo(e,i=>{this.handleTick(i,{once:!0})})}pause(){return this.status!==STATUS$1.INITIAL&&(this.status=STATUS$1.PAUSE,!0)}resume(){return this.status!==STATUS$1.INITIAL&&(this.status=STATUS$1.RUNNING,!0)}ifCanStop(){return!!(this.autoStop&&(!this.timelines.length||this.timelines.reduce((e,i)=>e+i.animateCount,0)===0))}start(e=!1){return this.status===STATUS$1.RUNNING||!this.tickerHandler||!e&&(this.status===STATUS$1.PAUSE||!this.timelines.length||this.timelines.reduce((i,n)=>i+n.animateCount,0)===0)?!1:(this.status=STATUS$1.RUNNING,this.tickerHandler.tick(0,this.handleTick),!0)}stop(){this.status=STATUS$1.INITIAL,this.setupTickHandler(),this.lastFrameTime=-1}trySyncTickStatus(){this.status===STATUS$1.RUNNING&&this._handlerTick()}}class Easing{constructor(){}static linear(e){return e}static none(){return this.linear}static get(e){return e<-1?e=-1:e>1&&(e=1),function(i){return e===0?i:e<0?i*(i*-e+1+e):i*((2-i)*e+(1-e))}}static getPowIn(e){return function(i){return Math.pow(i,e)}}static getPowOut(e){return function(i){return 1-Math.pow(1-i,e)}}static getPowInOut(e){return function(i){return(i*=2)<1?.5*Math.pow(i,e):1-.5*Math.abs(Math.pow(2-i,e))}}static getBackIn(e){return function(i){return i*i*((e+1)*i-e)}}static getBackOut(e){return function(i){return--i*i*((e+1)*i+e)+1}}static getBackInOut(e){return e*=1.525,function(i){return(i*=2)<1?i*i*((e+1)*i-e)*.5:.5*((i-=2)*i*((e+1)*i+e)+2)}}static sineIn(e){return 1-Math.cos(e*Math.PI/2)}static sineOut(e){return Math.sin(e*Math.PI/2)}static sineInOut(e){return-(Math.cos(Math.PI*e)-1)/2}static expoIn(e){return e===0?0:Math.pow(2,10*e-10)}static expoOut(e){return e===1?1:1-Math.pow(2,-10*e)}static expoInOut(e){return e===0?0:e===1?1:e<.5?Math.pow(2,20*e-10)/2:(2-Math.pow(2,-20*e+10))/2}static circIn(e){return-(Math.sqrt(1-e*e)-1)}static circOut(e){return Math.sqrt(1- --e*e)}static circInOut(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}static bounceOut(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}static bounceIn(e){return 1-Easing.bounceOut(1-e)}static bounceInOut(e){return e<.5?.5*Easing.bounceIn(2*e):.5*Easing.bounceOut(2*e-1)+.5}static getElasticIn(e,i){return function(n){if(n===0||n===1)return n;const o=i/pi2*Math.asin(1/e);return-e*Math.pow(2,10*(n-=1))*Math.sin((n-o)*pi2/i)}}static getElasticOut(e,i){return function(n){if(n===0||n===1)return n;const o=i/pi2*Math.asin(1/e);return e*Math.pow(2,-10*n)*Math.sin((n-o)*pi2/i)+1}}static getElasticInOut(e,i){return function(n){const o=i/pi2*Math.asin(1/e);return(n*=2)<1?e*Math.pow(2,10*(n-=1))*Math.sin((n-o)*pi2/i)*-.5:e*Math.pow(2,-10*(n-=1))*Math.sin((n-o)*pi2/i)*.5+1}}}Easing.quadIn=Easing.getPowIn(2),Easing.quadOut=Easing.getPowOut(2),Easing.quadInOut=Easing.getPowInOut(2),Easing.cubicIn=Easing.getPowIn(3),Easing.cubicOut=Easing.getPowOut(3),Easing.cubicInOut=Easing.getPowInOut(3),Easing.quartIn=Easing.getPowIn(4),Easing.quartOut=Easing.getPowOut(4),Easing.quartInOut=Easing.getPowInOut(4),Easing.quintIn=Easing.getPowIn(5),Easing.quintOut=Easing.getPowOut(5),Easing.quintInOut=Easing.getPowInOut(5),Easing.backIn=Easing.getBackIn(1.7),Easing.backOut=Easing.getBackOut(1.7),Easing.backInOut=Easing.getBackInOut(1.7),Easing.elasticIn=Easing.getElasticIn(1,.3),Easing.elasticOut=Easing.getElasticOut(1,.3),Easing.elasticInOut=Easing.getElasticInOut(1,.3*1.5);class DefaultTimeline{constructor(){this.id=Generator.GenAutoIncrementId(),this.animateHead=null,this.animateTail=null,this.animateCount=0,this.paused=!1}addAnimate(e){this.animateTail?(this.animateTail.nextAnimate=e,e.prevAnimate=this.animateTail,this.animateTail=e,e.nextAnimate=null):(this.animateHead=e,this.animateTail=e),this.animateCount++}pause(){this.paused=!0}resume(){this.paused=!1}tick(e){if(this.paused)return;let i=this.animateHead;for(this.animateCount=0;i;)i.status===AnimateStatus.END?this.removeAnimate(i):i.status===AnimateStatus.RUNNING||i.status===AnimateStatus.INITIAL?(this.animateCount++,i.advance(e)):i.status===AnimateStatus.PAUSED&&this.animateCount++,i=i.nextAnimate}clear(){let e=this.animateHead;for(;e;)e.release(),e=e.nextAnimate;this.animateHead=null,this.animateTail=null,this.animateCount=0}removeAnimate(e,i=!0){e._onRemove&&e._onRemove.forEach(n=>n()),e===this.animateHead?(this.animateHead=e.nextAnimate,e===this.animateTail?this.animateTail=null:this.animateHead.prevAnimate=null):e===this.animateTail?(this.animateTail=e.prevAnimate,this.animateTail.nextAnimate=null):(e.prevAnimate.nextAnimate=e.nextAnimate,e.nextAnimate.prevAnimate=e.prevAnimate),i&&e.release()}}const defaultTimeline=new DefaultTimeline;class ACustomAnimate{constructor(e,i,n,o,l){this.from=e,this.to=i,this.duration=n,this.easing=o,this.params=l,this.updateCount=0}bind(e,i){this.target=e,this.subAnimate=i,this.onBind()}onBind(){}onFirstRun(){}onStart(){}onEnd(){}getEndProps(){return this.to}getFromProps(){return this.from}getMergedEndProps(){var e;const i=this.getEndProps();return i?this._endProps===i?this._mergedEndProps:(this._endProps=i,void(this._mergedEndProps=Object.assign({},(e=this.step.prev.getLastProps())!==null&&e!==void 0?e:{},i))):this.step.prev?this.step.prev.getLastProps():i}update(e,i,n){if(this.updateCount===0){this.onFirstRun();const o=this.step.getLastProps();Object.keys(o).forEach(l=>{this.subAnimate.animate.validAttr(l)&&(n[l]=o[l])})}this.updateCount+=1,this.onUpdate(e,i,n),e&&this.onEnd()}}class CbAnimate extends ACustomAnimate{constructor(e){super(null,null,0,"linear"),this.cb=e}onUpdate(e,i,n){}onStart(){this.cb()}}let Animate$1=class we{constructor(e=Generator.GenAutoIncrementId(),i=defaultTimeline,n){this.id=e,this.timeline=i||defaultTimeline,this.status=AnimateStatus.INITIAL,this.tailAnimate=new SubAnimate(this),this.subAnimates=[this.tailAnimate],this.timeScale=1,this.rawPosition=-1,this._startTime=0,this._duringTime=0,this.timeline.addAnimate(this),this.slience=n}setTimeline(e){e!==this.timeline&&(this.timeline.removeAnimate(this,!1),e.addAnimate(this))}getStartTime(){return this._startTime}getDuration(){return this.subAnimates.reduce((e,i)=>e+i.totalDuration,0)}after(e){const i=e.getDuration();return this._startTime=i,this}afterAll(e){let i=-1/0;return e.forEach(n=>{i=max$1(n.getDuration(),i)}),this._startTime=i,this}parallel(e){return this._startTime=e.getStartTime(),this}static AddInterpolate(e,i){we.interpolateMap.set(e,i)}play(e){if(this.tailAnimate.play(e),this.target){const i=this.target.stage;i&&i.renderNextFrame()}return this.subAnimates.length===1&&this.tailAnimate.totalDuration===e.duration&&this.trySetAttribute(e.getFromProps(),e.mode),this}trySetAttribute(e,i=we.mode){e&&i&AnimateMode.SET_ATTR_IMMEDIATELY&&this.target.setAttributes&&this.target.setAttributes(e,!1,{type:AttributeUpdateType.ANIMATE_PLAY})}runCb(e){const i=new CbAnimate(()=>{e(this,i.step.prev)});return this.tailAnimate.play(i),this}customInterpolate(e,i,n,o,l,d){const u=we.interpolateMap.get(e)||we.interpolateMap.get("");return!!u&&u(e,i,n,o,l,d)}pause(){this.status===AnimateStatus.RUNNING&&(this.status=AnimateStatus.PAUSED)}resume(){this.status===AnimateStatus.PAUSED&&(this.status=AnimateStatus.RUNNING)}to(e,i,n,o){if(this.tailAnimate.to(e,i,n,o),this.target){const l=this.target.stage;l&&l.renderNextFrame()}return this}from(e,i,n,o){if(this.tailAnimate.from(e,i,n,o),this.target){const l=this.target.stage;l&&l.renderNextFrame()}return this}wait(e){if(this.tailAnimate.wait(e),this.target){const i=this.target.stage;i&&i.renderNextFrame()}return this}startAt(e){if(this.tailAnimate.startAt(e),this.target){const i=this.target.stage;i&&i.renderNextFrame()}return this}loop(e){if(this.tailAnimate.loop=e,this.target){const i=this.target.stage;i&&i.renderNextFrame()}return this}reversed(e){if(this.tailAnimate.reversed=e,this.target){const i=this.target.stage;i&&i.renderNextFrame()}return this}bounce(e){if(this.tailAnimate.bounce=e,this.target){const i=this.target.stage;i&&i.renderNextFrame()}return this}subAnimate(){const e=new SubAnimate(this,this.tailAnimate);return this.tailAnimate=e,this.subAnimates.push(e),e.bind(this.target),this}getStartProps(){return this.subAnimates[0].getStartProps()}getEndProps(){return this.tailAnimate.getEndProps()}depreventAttr(e){this._preventAttrs&&this._preventAttrs.delete(e)}preventAttr(e){this._preventAttrs||(this._preventAttrs=new Set),this._preventAttrs.add(e)}preventAttrs(e){e.forEach(i=>this.preventAttr(i))}validAttr(e){return!this._preventAttrs||!this._preventAttrs.has(e)}bind(e){return this.target=e,this.target.onAnimateBind&&!this.slience&&this.target.onAnimateBind(this),this.subAnimates.forEach(i=>{i.bind(e)}),this}advance(e){if(this._duringTime<this._startTime){if(this._duringTime+e*this.timeScale<this._startTime)return void(this._duringTime+=e*this.timeScale);e=this._duringTime+e*this.timeScale-this._startTime,this._duringTime=this._startTime}this.status===AnimateStatus.INITIAL&&(this.status=AnimateStatus.RUNNING,this._onStart&&this._onStart.forEach(i=>i())),this.setPosition(Math.max(this.rawPosition,0)+e*this.timeScale)&&this.status===AnimateStatus.RUNNING&&(this.status=AnimateStatus.END,this._onEnd&&this._onEnd.forEach(i=>i()))}setPosition(e){let i,n=0;const o=this.rawPosition,l=this.subAnimates.reduce((u,f)=>u+f.totalDuration,0);e<0&&(e=0);const d=e>=l;if(d&&(e=l),e===o)return d;for(let u=0;u<this.subAnimates.length&&(i=this.subAnimates[u],!(n+i.totalDuration>=e));u++)n+=i.totalDuration,i=void 0;return this.rawPosition=e,i.setPosition(e-n),d}onStart(e){this._onStart||(this._onStart=[]),this._onStart.push(e)}onEnd(e){this._onEnd||(this._onEnd=[]),this._onEnd.push(e)}onRemove(e){this._onRemove||(this._onRemove=[]),this._onRemove.push(e)}onFrame(e){this._onFrame||(this._onFrame=[]),this._onFrame.push(e)}release(){this.status=AnimateStatus.END}stop(e){e||this.target.onStop(),e==="start"?this.target.onStop(this.getStartProps()):e==="end"?this.target.onStop(this.getEndProps()):this.target.onStop(e),this.release()}};Animate$1.mode=AnimateMode.NORMAL,Animate$1.interpolateMap=new Map;class SubAnimate{get totalDuration(){return this.calcAttr(),this._totalDuration+this._startAt}constructor(e,i){this.rawPosition=-1,this.position=0,this.loop=0,this.duration=0,this.animate=e,this.stepHead=new Step(0,0,i?Object.assign({},i.stepTail.props):{}),this.stepTail=this.stepHead,this.dirty=!0,this._startAt=0}calcAttr(){this.dirty&&(this._totalDuration=this.duration*(this.loop+1))}bind(e){return this.target=e,this}play(e){let i=e.duration;(i==null||i<0)&&(i=0);const n=e.easing,o=typeof n=="string"?Easing[n]:n,l=this._addStep(i,null,o);return l.type=AnimateStepType.customAnimate,this._appendProps(e.getEndProps(),l,!1),this._appendCustomAnimate(e,l),this}to(e,i,n,o){(i==null||i<0)&&(i=0);const l=typeof n=="string"?Easing[n]:n,d=this._addStep(i,null,l);return d.type=AnimateStepType.to,this._appendProps(e,d,!!o&&o.tempProps),d.propKeys||(d.propKeys=Object.keys(d.props)),o&&o.noPreventAttrs||this.target.animates.forEach(u=>{u.id!==this.animate.id&&u.preventAttrs(d.propKeys)}),this}from(e,i,n,o){this.to(e,0,n,o);const l={};this.stepTail.propKeys||(this.stepTail.propKeys=Object.keys(this.stepTail.props)),this.stepTail.propKeys.forEach(d=>{l[d]=this.getLastPropByName(d,this.stepTail)}),this.to(l,i,n,o),this.stepTail.type=AnimateStepType.from}startAt(e){return e<0&&(e=0),this._startAt=e,this}getStartProps(){var e;return(e=this.stepHead)===null||e===void 0?void 0:e.props}getEndProps(){return this.stepTail.props}getLastStep(){return this._lastStep}wait(e){if(e>0){const i=this._addStep(+e,null);i.type=AnimateStepType.wait,i.prev.customAnimate?i.props=i.prev.customAnimate.getEndProps():i.props=i.prev.props,this.target.onAddStep&&this.target.onAddStep(i)}return this}_addStep(e,i,n){const o=new Step(this.duration,e,i,n);return this.duration+=e,this.stepTail.append(o),this.stepTail=o,o}_appendProps(e,i,n){i.props=n?e:Object.assign({},e);let o=i.prev;const l=i.props;for(i.propKeys||(i.propKeys=Object.keys(i.props)),i.propKeys.forEach(u=>{i.props[u]===void 0&&(i.props[u]=this.target.getDefaultAttribute(u))});o.prev;)o.props&&(o.propKeys||(o.propKeys=Object.keys(o.props)),o.propKeys.forEach(u=>{l[u]===void 0&&(l[u]=o.props[u])})),i.propKeys=Object.keys(i.props),o=o.prev;const d=this.stepHead.props;i.propKeys||(i.propKeys=Object.keys(l)),i.propKeys.forEach(u=>{if(d[u]===void 0){const f=this.animate.getStartProps();d[u]=f[u]=this.target.getComputedAttribute(u)}}),this.target.onAddStep&&this.target.onAddStep(i)}_appendCustomAnimate(e,i){i.customAnimate=e,e.step=i,e.bind(this.target,this)}setPosition(e){var i;const n=this.duration,o=this.loop,l=this.rawPosition;let d,u,f=!1;const g=(i=this._startAt)!==null&&i!==void 0?i:0;if(e<0&&(e=0),e<g)return this.rawPosition=e,!1;if(e-=g,n<=0&&(f=!0,n<0)||(d=Math.floor(e/n),u=e-d*n,f=e>=o*n+n,f&&(u=n,d=o,e=u*d+n),e===l))return f;const _=!this.reversed!=!(this.bounce&&d%2);return _&&(u=n-u),this._deltaPosition=u-this.position,this.position=u,this.rawPosition=e+g,this.updatePosition(f,_),f}updatePosition(e,i){if(!this.stepHead)return;let n=this.stepHead.next;const o=this.position,l=this.duration;if(this.target&&n){let d=n.next;for(;d&&d.position<=o;)n=d,d=n.next;let u=e?l===0?1:o/l:(o-n.position)/n.duration;n.easing&&(u=n.easing(u)),this.tryCallCustomAnimateLifeCycle(n,this._lastStep||(i?this.stepTail:this.stepHead),i),this.updateTarget(n,u,e),this._lastStep=n,this.animate._onFrame&&this.animate._onFrame.forEach(f=>f(n,u))}}tryCallCustomAnimateLifeCycle(e,i,n){if(e!==i)if(n){let o=i.prev;for(;o&&o!==e;)o.customAnimate&&(o.customAnimate.onStart&&o.customAnimate.onStart(),o.customAnimate.onEnd&&o.customAnimate.onEnd()),o=e.prev;i&&i.customAnimate&&i.customAnimate.onEnd&&i.customAnimate.onEnd(),e&&e.customAnimate&&e.customAnimate.onStart&&e.customAnimate.onStart()}else{let o=i.next;for(;o&&o!==e;)o.customAnimate&&(o.customAnimate.onStart&&o.customAnimate.onStart(),o.customAnimate.onEnd&&o.customAnimate.onEnd()),o=o.next;i&&i.customAnimate&&i.customAnimate.onEnd&&i.customAnimate.onEnd(),e&&e.customAnimate&&e.customAnimate.onStart&&e.customAnimate.onStart()}}getLastPropByName(e,i){let n=i.prev;for(;n;){if(n.props&&n.props[e]!==void 0)return n.props[e];if(n.customAnimate){const o=n.customAnimate.getEndProps()[e];if(o!==void 0)return o}n=n.prev}return Logger.getInstance().warn("step"),i.props[e]}updateTarget(e,i,n){e.props==null&&e.customAnimate==null||this.target.onStep(this,this.animate,e,i,n)}}class Step{constructor(e,i,n,o){this.duration=i,this.position=e,this.props=n,this.easing=o}append(e){e.prev=this,e.next=this.next,this.next=e}getLastProps(){let e=this.prev;for(;e;){if(e.props)return e.props;if(e.customAnimate)return e.customAnimate.getMergedEndProps();e=e.prev}return null}}const DefaultStateAnimateConfig={duration:200,easing:"cubicOut"};var Edge;(function(r){r[r.Top=1]="Top",r[r.Right=2]="Right",r[r.Bottom=4]="Bottom",r[r.Left=8]="Left",r[r.ALL=15]="ALL"})(Edge||(Edge={}));const _strokeVec4=[!1,!1,!1,!1],parseStroke=r=>{var e;let i=!0;if(isBoolean(r,!0)){for(let n=0;n<4;n++)_strokeVec4[n]=r,i&&(i=!((e=_strokeVec4[n])!==null&&e!==void 0&&!e));i=r}else if(Array.isArray(r))for(let n=0;n<4;n++)_strokeVec4[n]=!!r[n],i&&(i=!!_strokeVec4[n]);else _strokeVec4[0]=!1,_strokeVec4[1]=!1,_strokeVec4[2]=!1,_strokeVec4[3]=!1;return{isFullStroke:i,stroke:_strokeVec4}},_paddingVec4=[0,0,0,0],parsePadding=r=>r?isArray(r)?r.length===0?0:r.length===1?r[0]:r.length===2?(_paddingVec4[0]=r[0],_paddingVec4[2]=r[0],_paddingVec4[1]=r[1],_paddingVec4[3]=r[1],_paddingVec4):r:r:0,_coords=[{x:0,y:0},{x:0,y:0},{x:0,y:0},{x:0,y:0}],indexList=[1,2,3,0,1,2,3,0];function circleBounds(r,e,i,n){for(;r>=pi2;)r-=pi2;for(;r<0;)r+=pi2;for(;r>e;)e+=pi2;_coords[0].x=i,_coords[1].y=i,_coords[2].x=-i,_coords[3].y=-i;const o=Math.ceil(r/halfPi$2)%4,l=Math.ceil(e/halfPi$2)%4;if(n.add(cos$1(r)*i,sin$1(r)*i),n.add(cos$1(e)*i,sin$1(e)*i),o!==l||e-r>pi$1){let d=!1;for(let u=0;u<indexList.length;u++)if(d||o!==indexList[u]){if(d&&l===indexList[u])break;if(d){const f=_coords[indexList[u]];n.add(f.x,f.y)}}else{d=!0;const f=_coords[o];n.add(f.x,f.y)}}}function pointInterpolation(r,e,i){const{x:n,y:o}=pointAt(r.x,r.y,e.x,e.y,i),{x:l,y:d}=pointAt(r.x1,r.y1,e.x1,e.y1,i),u=new Point(n,o,l,d);return u.defined=e.defined,u}function pointsInterpolation(r,e,i){if(!r||!e)return[];Array.isArray(r)||(r=[r]),Array.isArray(e)||(e=[e]);let n=[];if(r.length>e.length){n=e.map(o=>{const l=new Point(o.x,o.y,o.x1,o.y1);return l.defined=o.defined,l});for(let o=0;o<e.length;o++)n[o]=pointInterpolation(r[o],e[o],i)}else{n=e.map(o=>{const l=new Point(o.x,o.y,o.x1,o.y1);return l.defined=o.defined,l});for(let o=0;o<r.length;o++)n[o]=pointInterpolation(r[o],e[o],i)}return n}function getAttributeFromDefaultAttrList(r,e){if(isArray(r)){let i;for(let n=0;n<r.length&&i===void 0;n++)i=r[n][e];return i}return r[e]}class RafBasedSTO{constructor(e=RafBasedSTO.TimeOut){this.durations=[],this.timeout=e,this.lastDate=0,this.durationsListThreshold=30}call(e){return this.lastDate=Date.now(),setTimeout(()=>{this.appendDuration(Date.now()-this.lastDate),e(0)},this.timeout,!0)}clear(e){clearTimeout(e)}appendDuration(e){this.durations.push(e),this.durations.length>this.durationsListThreshold&&this.durations.shift(),this.timeout=Math.min(Math.max(this.durations.reduce((i,n)=>i+n,0)/this.durations.length,1e3/60),1e3/30)}}RafBasedSTO.TimeOut=1e3/60;const rafBasedSto=new RafBasedSTO,_calculateLineHeight=(r,e)=>isString(r)&&r[r.length-1]==="%"?e*(Number.parseFloat(r.substring(0,r.length-1))/100):r,calculateLineHeight=(r,e)=>{const i=_calculateLineHeight(r,e);return isNaN(i)?i:Math.max(e,i)};class IncreaseCount extends ACustomAnimate{constructor(e,i,n,o,l){super(e,i,n,o,l)}getEndProps(){return this.valid===!1?{}:{text:this.to}}onBind(){var e,i,n,o,l,d,u,f;this.fromNumber=isNumber((e=this.from)===null||e===void 0?void 0:e.text)?(i=this.from)===null||i===void 0?void 0:i.text:Number.parseFloat((n=this.from)===null||n===void 0?void 0:n.text),this.toNumber=isNumber((o=this.to)===null||o===void 0?void 0:o.text)?(l=this.to)===null||l===void 0?void 0:l.text:Number.parseFloat((d=this.to)===null||d===void 0?void 0:d.text),Number.isFinite(this.toNumber)||(this.fromNumber=0),Number.isFinite(this.toNumber)||(this.valid=!1),this.valid!==!1&&(this.decimalLength=(f=(u=this.params)===null||u===void 0?void 0:u.fixed)!==null&&f!==void 0?f:Math.max(getDecimalPlaces(this.fromNumber),getDecimalPlaces(this.toNumber)))}onEnd(){}onUpdate(e,i,n){this.valid!==!1&&(n.text=e?this.toNumber:(this.fromNumber+(this.toNumber-this.fromNumber)*i).toFixed(this.decimalLength))}}var Direction;(function(r){r[r.LEFT_TO_RIGHT=0]="LEFT_TO_RIGHT",r[r.RIGHT_TO_LEFT=1]="RIGHT_TO_LEFT",r[r.TOP_TO_BOTTOM=2]="TOP_TO_BOTTOM",r[r.BOTTOM_TO_TOP=3]="BOTTOM_TO_TOP",r[r.STROKE=4]="STROKE"})(Direction||(Direction={}));class TagPointsUpdate extends ACustomAnimate{constructor(e,i,n,o,l){var d,u;super(e,i,n,o,l),this.newPointAnimateType=(d=l==null?void 0:l.newPointAnimateType)!==null&&d!==void 0?d:"grow",this.clipRangeByDimension=(u=l==null?void 0:l.clipRangeByDimension)!==null&&u!==void 0?u:"x"}getPoints(e,i=!1){if(e.points)return e.points;if(e.segments){const n=[];return this.segmentsCache||(this.segmentsCache=[]),e.segments.map(o=>{var l,d;o.points&&n.push(...o.points),i&&this.segmentsCache.push((d=(l=o.points)===null||l===void 0?void 0:l.length)!==null&&d!==void 0?d:0)}),n}return[]}onBind(){const e=this.getPoints(this.from),i=this.getPoints(this.to,!0);this.fromPoints=e?Array.isArray(e)?e:[e]:[],this.toPoints=i?Array.isArray(i)?i:[i]:[];const n=new Map;this.fromPoints.forEach(g=>{g.context&&n.set(g.context,g)});let o,l,d=1/0,u=-1/0;for(let g=0;g<this.toPoints.length;g+=1)if(n.has(this.toPoints[g].context)){d=g,o=n.get(this.toPoints[g].context);break}for(let g=this.toPoints.length-1;g>=0;g-=1)if(n.has(this.toPoints[g].context)){u=g,l=n.get(this.toPoints[g].context);break}this.newPointAnimateType==="clip"&&this.toPoints.length!==0&&(Number.isFinite(u)?(this.clipRange=this.toPoints[u][this.clipRangeByDimension]/this.toPoints[this.toPoints.length-1][this.clipRangeByDimension],this.clipRange===1&&(this.shrinkClipRange=this.toPoints[u][this.clipRangeByDimension]/this.fromPoints[this.fromPoints.length-1][this.clipRangeByDimension]),isValidNumber(this.clipRange)?this.clipRange=clamp(this.clipRange,0,1):this.clipRange=0):this.clipRange=0);let f=this.toPoints[0];this.interpolatePoints=this.toPoints.map((g,_)=>{const y=n.get(g.context);return y?(f=y,[y,g]):this.newPointAnimateType==="appear"||this.newPointAnimateType==="clip"?[g,g]:_<d&&o?[o,g]:_>u&&l?[l,g]:[f,g]}),this.points=this.interpolatePoints.map(g=>{const _=g[0],y=g[1],b=new Point(_.x,_.y,_.x1,_.y1);return b.defined=y.defined,b.context=y.context,b})}onFirstRun(){const e=this.target.attribute.clipRange;isValidNumber(e*this.clipRange)&&(this.clipRange*=e)}onUpdate(e,i,n){if(this.points=this.points.map((o,l)=>{const d=pointInterpolation(this.interpolatePoints[l][0],this.interpolatePoints[l][1],i);return d.context=o.context,d}),this.clipRange){if(this.shrinkClipRange)return void(e?(n.points=this.toPoints,n.clipRange=1):(n.points=this.fromPoints,n.clipRange=this.clipRange-(this.clipRange-this.shrinkClipRange)*i));n.clipRange=this.clipRange+(1-this.clipRange)*i}if(this.segmentsCache&&this.to.segments){let o=0;n.segments=this.to.segments.map((l,d)=>{const u=o+this.segmentsCache[d],f=this.points.slice(o,u);return o=u,Object.assign(Object.assign({},l),{points:f})})}else n.points=this.points}}class ClipGraphicAnimate extends ACustomAnimate{constructor(e,i,n,o,l){super(null,null,n,o,l),this.clipFromAttribute=e,this.clipToAttribute=i,this._group=l==null?void 0:l.group,this._clipGraphic=l==null?void 0:l.clipGraphic}onBind(){this._group&&this._clipGraphic&&(this._lastClip=this._group.attribute.clip,this._lastPath=this._group.attribute.path,this._group.setAttributes({clip:!0,path:[this._clipGraphic]},!1,{type:AttributeUpdateType.ANIMATE_BIND}))}onEnd(){this._group&&this._group.setAttributes({clip:this._lastClip,path:this._lastPath},!1,{type:AttributeUpdateType.ANIMATE_END})}onUpdate(e,i,n){if(!this._clipGraphic)return;const o={};Object.keys(this.clipFromAttribute).forEach(l=>{o[l]=this.clipFromAttribute[l]+(this.clipToAttribute[l]-this.clipFromAttribute[l])*i}),this._clipGraphic.setAttributes(o,!1,{type:AttributeUpdateType.ANIMATE_UPDATE,animationState:{ratio:i,end:e}})}}class ClipAngleAnimate extends ClipGraphicAnimate{constructor(e,i,n,o,l){var d,u,f,g,_,y,b,S,v,A,x,T;const C=(u=(d=l==null?void 0:l.group)===null||d===void 0?void 0:d.attribute)!==null&&u!==void 0?u:{},E=(f=C.width)!==null&&f!==void 0?f:0,P=(g=C.height)!==null&&g!==void 0?g:0,R=(_=l==null?void 0:l.animationType)!==null&&_!==void 0?_:"in",L=(y=l==null?void 0:l.startAngle)!==null&&y!==void 0?y:0,w=(b=l==null?void 0:l.orient)!==null&&b!==void 0?b:"clockwise";let B=0,I=0;w==="anticlockwise"?(I=R==="in"?L+2*Math.PI:L,I=L+2*Math.PI):(B=L,I=R==="out"?L+2*Math.PI:L);const D=application.graphicService.creator.arc({x:(v=(S=l==null?void 0:l.center)===null||S===void 0?void 0:S.x)!==null&&v!==void 0?v:E/2,y:(x=(A=l==null?void 0:l.center)===null||A===void 0?void 0:A.y)!==null&&x!==void 0?x:P/2,outerRadius:(T=l==null?void 0:l.radius)!==null&&T!==void 0?T:(E+P)/2,innerRadius:0,startAngle:B,endAngle:I,fill:!0});let O,N;w==="anticlockwise"?(O={startAngle:L+2*Math.PI},N={startAngle:L}):(O={endAngle:L},N={endAngle:L+2*Math.PI}),super(R==="in"?O:N,R==="in"?N:O,n,o,{group:l==null?void 0:l.group,clipGraphic:D})}}class ClipDirectionAnimate extends ClipGraphicAnimate{constructor(e,i,n,o,l){var d,u,f,g,_,y,b,S,v;const A=(u=(d=l==null?void 0:l.group)===null||d===void 0?void 0:d.attribute)!==null&&u!==void 0?u:{},x=(g=(f=l==null?void 0:l.width)!==null&&f!==void 0?f:A.width)!==null&&g!==void 0?g:0,T=(y=(_=l==null?void 0:l.height)!==null&&_!==void 0?_:A.height)!==null&&y!==void 0?y:0,C=(b=l==null?void 0:l.animationType)!==null&&b!==void 0?b:"in",E=(S=l==null?void 0:l.direction)!==null&&S!==void 0?S:"x",P=(v=l==null?void 0:l.orient)!==null&&v!==void 0?v:"positive",R=application.graphicService.creator.rect({x:0,y:0,width:C==="in"&&E==="x"?0:x,height:C==="in"&&E==="y"?0:T,fill:!0});let L={},w={};E==="y"?P==="negative"?(L={y:T,height:0},w={y:0,height:T}):(L={height:0},w={height:T}):P==="negative"?(L={x,width:0},w={x:0,width:x}):(L={width:0},w={width:x}),super(C==="in"?L:w,C==="in"?w:L,n,o,{group:l==null?void 0:l.group,clipGraphic:R})}}class RotateBySphereAnimate extends ACustomAnimate{onStart(){const{center:e,r:i}=typeof this.params=="function"?this.params():this.params,n=this.target.getComputedAttribute("x"),o=this.target.getComputedAttribute("y"),l=this.target.getComputedAttribute("z"),d=Math.acos((o-e.y)/i);let u=Math.acos((n-e.x)/i/Math.sin(d));l-e.z<0&&(u=pi2-u),this.theta=u,this.phi=d}onBind(){}onEnd(){}onUpdate(e,i,n){if(this.phi==null||this.theta==null)return;const{center:o,r:l,cb:d}=typeof this.params=="function"?this.params():this.params,u=2*Math.PI*i,f=this.theta+u,g=this.phi,_=l*Math.sin(g)*Math.cos(f)+o.x,y=l*Math.cos(g)+o.y,b=l*Math.sin(g)*Math.sin(f)+o.z;for(n.x=_,n.y=y,n.z=b,n.alpha=f+pi$1/2;n.alpha>pi2;)n.alpha-=pi2;n.alpha=pi2-n.alpha,n.zIndex=-1e4*n.z,d&&d(n)}}class AnimateGroup extends ACustomAnimate{constructor(e,i){super(null,null,e,"linear"),this.customAnimates=i}initAnimates(){this.customAnimates.forEach(e=>{e.step=this.step,e.subAnimate=this.subAnimate,e.target=this.target})}getEndProps(){const e={};return this.customAnimates.forEach(i=>{Object.assign(e,i.getEndProps())}),e}onBind(){this.initAnimates(),this.customAnimates.forEach(e=>{e.onBind()})}onEnd(){this.customAnimates.forEach(e=>{e.onEnd()})}onStart(){this.customAnimates.forEach(e=>{e.onStart()})}onUpdate(e,i,n){this.updating||(this.updating=!0,this.customAnimates.forEach(o=>{const l=o.easing;i=(typeof l=="string"?Easing[l]:l)(i),o.onUpdate(e,i,n)}),this.updating=!1)}}const normalizeRectAttributes=r=>{if(!r)return{x:0,y:0,width:0,height:0};let e=isNil(r.width)?r.x1-r.x:r.width,i=isNil(r.height)?r.y1-r.y:r.height,n=0,o=0;return e<0?(n=e,e=-e):Number.isNaN(e)&&(e=0),i<0?(o=i,i=-i):Number.isNaN(i)&&(i=0),{x:n,y:o,width:e,height:i}};var ColorType;(function(r){r[r.Color255=0]="Color255",r[r.Color1=1]="Color1"})(ColorType||(ColorType={}));class ColorStore{static Get(e,i=ColorType.Color1,n=[0,0,0,1]){if(i===ColorType.Color1){const d=ColorStore.store1[e];if(d)return n[0]=d[0],n[1]=d[1],n[2]=d[2],n[3]=d[3],n;const u=Color.parseColorString(e);if(u){const f=[u.r/255,u.g/255,u.b/255,u.opacity];ColorStore.store1[e]=f,ColorStore.store255[e]=[u.r,u.g,u.b,u.opacity],n[0]=f[0],n[1]=f[1],n[2]=f[2],n[3]=f[3]}return n}const o=ColorStore.store255[e];if(o)return n[0]=o[0],n[1]=o[1],n[2]=o[2],n[3]=o[3],n;const l=Color.parseColorString(e);return l&&(ColorStore.store1[e]=[l.r/255,l.g/255,l.b/255,l.opacity],ColorStore.store255[e]=[l.r,l.g,l.b,l.opacity],n[0]=l.r,n[1]=l.g,n[2]=l.b,n[3]=l.opacity),n}static Set(e,i,n){if(i===ColorType.Color1){if(ColorStore.store1[e])return;ColorStore.store1[e]=n,ColorStore.store255[e]=[Math.floor(255*n[0]),Math.floor(255*n[1]),Math.floor(255*n[2]),Math.floor(255*n[3])]}else{if(ColorStore.store255[e])return;ColorStore.store255[e]=n,ColorStore.store1[e]=[n[0]/255,n[1]/255,n[2]/255,n[3]]}}}ColorStore.store255={},ColorStore.store1={};function colorArrayToString(r,e=!1){return Array.isArray(r)&&isNumber(r[0])?e?`rgb(${Math.round(r[0])},${Math.round(r[1])},${Math.round(r[2])},${r[3].toFixed(2)})`:`rgb(${Math.round(r[0])},${Math.round(r[1])},${Math.round(r[2])})`:r}function interpolateColor(r,e,i,n,o){return Array.isArray(r)&&!isNumber(r[0])||Array.isArray(e)&&!isNumber(e[0])?new Array(4).fill(0).map((l,d)=>_interpolateColor(isArray(r)?r[d]:r,isArray(e)?e[d]:e,i,n)):_interpolateColor(r,e,i,n,o)}function _interpolateColor(r,e,i,n,o){if(!r||!e)return r&&colorArrayToString(r)||e&&colorArrayToString(e)||!1;let l,d,u=!1,f=!1;if(Array.isArray(r)?l=r:typeof r=="string"?l=ColorStore.Get(r,ColorType.Color255):u=!0,Array.isArray(e)?d=e:typeof e=="string"?d=ColorStore.Get(e,ColorType.Color255):f=!0,u!==f){const g=u?r:e,_=u?e:r,y=Object.assign(Object.assign({},g),{stops:g.stops.map(b=>Object.assign(Object.assign({},b),{color:colorArrayToString(_)}))});return u?interpolateColor(g,y,i,n,o):interpolateColor(y,g,i,n,o)}if(u){if(r.gradient===e.gradient){const g=r,_=e,y=g.stops,b=_.stops;if(y.length!==b.length)return!1;if(g.gradient==="linear")return interpolateGradientLinearColor(g,_,i);if(g.gradient==="radial")return interpolateGradientRadialColor(g,_,i);if(g.gradient==="conical")return interpolateGradientConicalColor(g,_,i)}return!1}return o&&o(l,d),colorArrayToString(interpolatePureColorArray(l,d,i),n)}function interpolateGradientLinearColor(r,e,i){const n=r.stops,o=e.stops;return{gradient:"linear",x0:r.x0+(e.x0-r.x0)*i,x1:r.x1+(e.x1-r.x1)*i,y0:r.y0+(e.y0-r.y0)*i,y1:r.y1+(e.y1-r.y1)*i,stops:new Array(n.length).fill(0).map((l,d)=>({color:colorStringInterpolationToStr(n[d].color,o[d].color,i),offset:n[d].offset+(o[d].offset-n[d].offset)*i}))}}function interpolateGradientRadialColor(r,e,i){const n=r.stops,o=e.stops;return{gradient:"radial",x0:r.x0+(e.x0-r.x0)*i,x1:r.x1+(e.x1-r.x1)*i,y0:r.y0+(e.y0-r.y0)*i,y1:r.y1+(e.y1-r.y1)*i,r0:r.r0+(e.r0-r.r0)*i,r1:r.r1+(e.r1-r.r1)*i,stops:new Array(n.length).fill(0).map((l,d)=>({color:colorStringInterpolationToStr(n[d].color,o[d].color,i),offset:n[d].offset+(o[d].offset-n[d].offset)*i}))}}function interpolateGradientConicalColor(r,e,i){const n=r.stops,o=e.stops;return{gradient:"conical",startAngle:r.startAngle+(e.startAngle-r.startAngle)*i,endAngle:r.endAngle+(e.endAngle-r.endAngle)*i,x:r.x+(e.x-r.x)*i,y:r.y+(e.y-r.y)*i,stops:new Array(n.length).fill(0).map((l,d)=>({color:colorStringInterpolationToStr(n[d].color,o[d].color,i),offset:n[d].offset+(o[d].offset-n[d].offset)*i}))}}function interpolatePureColorArray(r,e,i){return[r[0]+(e[0]-r[0])*i,r[1]+(e[1]-r[1])*i,r[2]+(e[2]-r[2])*i,r[3]+(e[3]-r[3])*i]}const _fromColorRGB=[0,0,0,0],_toColorRGB=[0,0,0,0];function colorStringInterpolationToStr(r,e,i){return ColorStore.Get(r,ColorType.Color255,_fromColorRGB),ColorStore.Get(e,ColorType.Color255,_toColorRGB),`rgba(${Math.round(_fromColorRGB[0]+(_toColorRGB[0]-_fromColorRGB[0])*i)},${Math.round(_fromColorRGB[1]+(_toColorRGB[1]-_fromColorRGB[1])*i)},${Math.round(_fromColorRGB[2]+(_toColorRGB[2]-_fromColorRGB[2])*i)},${_fromColorRGB[3]+(_toColorRGB[3]-_fromColorRGB[3])*i})`}class GroupFadeIn extends ACustomAnimate{getEndProps(){return{}}onBind(){this.target.setTheme({common:{opacity:0}})}onEnd(){this.target.setTheme({common:{opacity:1}})}onUpdate(e,i,n){this.target.setTheme({common:{opacity:i}})}}class GroupFadeOut extends ACustomAnimate{getEndProps(){return{}}onBind(){this.target.setTheme({common:{opacity:1}})}onEnd(){this.target.setTheme({common:{opacity:0}})}onUpdate(e,i,n){this.target.setTheme({common:{opacity:1-i}})}}class ResourceLoader{static GetImage(e,i){var n;const o=ResourceLoader.cache.get(e);o?o.loadState==="fail"?application.global.getRequestAnimationFrame()(()=>{i.imageLoadFail(e)}):o.loadState==="init"||o.loadState==="loading"?(n=o.waitingMark)===null||n===void 0||n.push(i):i&&i.imageLoadSuccess(e,o.data):ResourceLoader.loadImage(e,i)}static GetSvg(e,i){var n;let o=ResourceLoader.cache.get(e);o?o.loadState==="fail"?application.global.getRequestAnimationFrame()(()=>{i.imageLoadFail(e)}):o.loadState==="init"||o.loadState==="loading"?(n=o.waitingMark)===null||n===void 0||n.push(i):i&&i.imageLoadSuccess(e,o.data):(o={type:"image",loadState:"init"},ResourceLoader.cache.set(e,o),o.dataPromise=application.global.loadSvg(e),o.dataPromise?(o.waitingMark=[i],o.dataPromise.then(l=>{var d;o.loadState=l!=null&&l.data?"success":"fail",o.data=l==null?void 0:l.data,(d=o.waitingMark)===null||d===void 0||d.map((u,f)=>{l!=null&&l.data?(o.loadState="success",o.data=l.data,u.imageLoadSuccess(e,l.data)):(o.loadState="fail",u.imageLoadFail(e))}),o.waitingMark&&(o.waitingMark=[])})):(o.loadState="fail",i.imageLoadFail(e)))}static GetFile(e,i){let n=ResourceLoader.cache.get(e);return n?n.loadState==="fail"?Promise.reject():n.loadState==="init"||n.loadState==="loading"?n.dataPromise.then(o=>o.data):Promise.resolve(n.data):(n={type:i,loadState:"init"},ResourceLoader.cache.set(e,n),i==="arrayBuffer"?n.dataPromise=application.global.loadArrayBuffer(e):i==="blob"?n.dataPromise=application.global.loadBlob(e):i==="json"&&(n.dataPromise=application.global.loadJson(e)),n.dataPromise.then(o=>o.data))}static loading(){setTimeout(()=>{if(!ResourceLoader.isLoading&&ResourceLoader.toLoadAueue.length){ResourceLoader.isLoading=!0;const e=ResourceLoader.toLoadAueue.splice(0,10),i=[];e.forEach(n=>{const{url:o,marks:l}=n,d={type:"image",loadState:"init"};if(ResourceLoader.cache.set(o,d),d.dataPromise=application.global.loadImage(o),d.dataPromise){d.waitingMark=l;const u=d.dataPromise.then(f=>{var g;d.loadState=f!=null&&f.data?"success":"fail",d.data=f==null?void 0:f.data,(g=d.waitingMark)===null||g===void 0||g.map((_,y)=>{f!=null&&f.data?(d.loadState="success",d.data=f.data,_.imageLoadSuccess(o,f.data)):(d.loadState="fail",_.imageLoadFail(o))}),d.waitingMark&&(d.waitingMark=[])});i.push(u)}else d.loadState="fail",l.forEach(u=>u.imageLoadFail(o))}),Promise.all(i).then(()=>{ResourceLoader.isLoading=!1,this.onLoadSuccessCb.forEach(n=>n()),ResourceLoader.loading()}).catch(n=>{console.error(n),ResourceLoader.isLoading=!1,this.onLoadSuccessCb.forEach(o=>o()),ResourceLoader.loading()})}},0)}static loadImage(e,i){const n=getIndex(e,ResourceLoader.toLoadAueue);if(n!==-1)return ResourceLoader.toLoadAueue[n].marks.push(i),void ResourceLoader.loading();ResourceLoader.toLoadAueue.push({url:e,marks:[i]}),ResourceLoader.loading()}static improveImageLoading(e){const i=getIndex(e,ResourceLoader.toLoadAueue);if(i!==-1){const n=ResourceLoader.toLoadAueue.splice(i,1);ResourceLoader.toLoadAueue.unshift(n[0])}}static onLoadSuccess(e){this.onLoadSuccessCb.push(e)}}function getIndex(r,e){for(let i=0;i<e.length;i++)if(e[i].url===r)return i;return-1}ResourceLoader.cache=new Map,ResourceLoader.isLoading=!1,ResourceLoader.toLoadAueue=[],ResourceLoader.onLoadSuccessCb=[];const tempMatrix=new Matrix,tempBounds$1=new AABBBounds,GRAPHIC_UPDATE_TAG_KEY=["lineWidth","scaleX","scaleY","angle","anchor","visible"],tempConstantXYKey=["x","y"],tempConstantScaleXYKey=["scaleX","scaleY"],tempConstantAngleKey=["angle"],point=new Point,NOWORK_ANIMATE_ATTR={strokeSeg:1,boundsPadding:2,pickMode:1,boundsMode:1,customPickShape:1,pickable:1,childrenPickable:1,visible:1,zIndex:1,layout:1,keepDirIn3d:1,globalZIndex:1,outerBorder:1,innerBorder:1,lineDash:1,lineCap:1,lineJoin:1,miterLimit:2,strokeBoundsBuffer:2,scaleCenter:1,anchor:1,anchor3d:1,postMatrix:1,backgroundMode:2,background:1,texture:1,cursor:1,html:1};class Graphic extends Node{static mixin(e){const i=Object.keys(e);for(let n=0;n<i.length;++n){const o=i[n];Object.defineProperty(Graphic.prototype,o,Object.getOwnPropertyDescriptor(e,o))}}get AABBBounds(){return this.tryUpdateAABBBounds(this.attribute.boundsMode==="imprecise")}get OBBBounds(){return this.tryUpdateOBBBounds()}get globalAABBBounds(){return this.tryUpdateGlobalAABBBounds()}get transMatrix(){return this.tryUpdateLocalTransMatrix(!0)}get globalTransMatrix(){return this.tryUpdateGlobalTransMatrix(!0)}constructor(e={}){var i;super(),this._AABBBounds=new AABBBounds,this._updateTag=UpdateTag.INIT,this.attribute=e,this.valid=this.isValid(),this.updateAABBBoundsStamp=0,e.background?this.loadImage((i=e.background.background)!==null&&i!==void 0?i:e.background,!0):e.shadowGraphic&&this.setShadowGraphic(e.shadowGraphic)}setMode(e){e==="3d"?this.set3dMode():this.set2dMode()}set3dMode(){this.in3dMode=!0}set2dMode(){this.in3dMode=!1}getOffsetXY(e,i=!1){var n,o;const{dx:l=e.dx,dy:d=e.dy}=this.attribute;if(i&&this.parent){const u=this.parent.attribute;point.x=l+((n=u.scrollX)!==null&&n!==void 0?n:0),point.y=d+((o=u.scrollY)!==null&&o!==void 0?o:0)}else point.x=l,point.y=d;return point}onAnimateBind(e){this._emitCustomEvent("animate-bind",e)}tryUpdateAABBBounds(e){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;if(!this.valid)return this._AABBBounds.clear(),this._AABBBounds;application.graphicService.beforeUpdateAABBBounds(this,this.stage,!0,this._AABBBounds);const i=this.doUpdateAABBBounds(e);return application.graphicService.afterUpdateAABBBounds(this,this.stage,this._AABBBounds,this,!0),i}tryUpdateOBBBounds(){return this._OBBBounds||(this._OBBBounds=new OBBBounds),this.tryUpdateAABBBounds(),this.updateOBBBoundsStamp===this.updateAABBBoundsStamp?this._OBBBounds:(this.updateOBBBoundsStamp=this.updateAABBBoundsStamp,this.valid?this.doUpdateOBBBounds():(this._OBBBounds.clear(),this._OBBBounds))}combindShadowAABBBounds(e){if(this.shadowRoot){const i=this.shadowRoot.AABBBounds.clone();e.union(i)}}doUpdateOBBBounds(){return this._OBBBounds}doUpdateAABBBounds(e){this.updateAABBBoundsStamp++;const i=this.getGraphicTheme();this._AABBBounds.clear();const n=this.attribute,o=this.updateAABBBounds(n,i,this._AABBBounds,e),{boundsPadding:l=i.boundsPadding}=n,d=parsePadding(l);return d&&o.expand(d),this.clearUpdateBoundTag(),o}updatePathProxyAABBBounds(e){const i=typeof this.pathProxy=="function"?this.pathProxy(this.attribute):this.pathProxy;if(!i)return!1;const n=new BoundsContext(e);return renderCommandList(i.commandList,n,0,0),!0}tryUpdateGlobalAABBBounds(){const e=this.AABBBounds;return this._globalAABBBounds?this._globalAABBBounds.setValue(e.x1,e.y1,e.x2,e.y2):this._globalAABBBounds=e.clone(),this._globalAABBBounds.empty()||this.parent&&this._globalAABBBounds.transformWithMatrix(this.parent.globalTransMatrix),this._globalAABBBounds}tryUpdateGlobalTransMatrix(e=!0){if(this._globalTransMatrix){if(this.parent){const i=this.parent.globalTransMatrix;this._globalTransMatrix.setValue(i.a,i.b,i.c,i.d,i.e,i.f)}}else this._globalTransMatrix=this.parent?this.parent.globalTransMatrix.clone():this.transMatrix.clone();return this.shouldUpdateGlobalMatrix()&&this.doUpdateGlobalMatrix(),this._globalTransMatrix}shouldUpdateGlobalMatrix(){return!0}tryUpdateLocalTransMatrix(e=!0){return this._transMatrix||(this._transMatrix=new Matrix),this.shouldUpdateLocalMatrix()&&(this.doUpdateLocalMatrix(),e&&this.clearUpdateLocalPositionTag()),this._transMatrix}shouldUpdateAABBBounds(){return this.shadowRoot?(!!(this._updateTag&UpdateTag.UPDATE_BOUNDS)||this.shadowRoot.shouldUpdateAABBBounds())&&application.graphicService.validCheck(this.attribute,this.getGraphicTheme(),this._AABBBounds,this):!!(this._updateTag&UpdateTag.UPDATE_BOUNDS)&&application.graphicService.validCheck(this.attribute,this.getGraphicTheme(),this._AABBBounds,this)}shouldSelfChangeUpdateAABBBounds(){return this.shadowRoot?!!(this._updateTag&UpdateTag.UPDATE_BOUNDS)||this.shadowRoot.shouldUpdateAABBBounds():!!(this._updateTag&UpdateTag.UPDATE_BOUNDS)}shouldUpdateLocalMatrix(){return!!(this._updateTag&UpdateTag.UPDATE_LOCAL_MATRIX)}isValid(){var e,i;const n=this.attribute;return Number.isFinite(((e=n.x)!==null&&e!==void 0?e:0)+((i=n.y)!==null&&i!==void 0?i:0))}_validNumber(e){return e==null||Number.isFinite(e)}shouldUpdateShape(){return!!(this._updateTag&UpdateTag.UPDATE_SHAPE)}clearUpdateShapeTag(){this._updateTag&=UpdateTag.CLEAR_SHAPE}containsPoint(e,i,n,o){if(!o)return!1;if(n===IContainPointMode.GLOBAL){const l=new Point(e,i);this.parent&&this.parent.globalTransMatrix.transformPoint(l,l),e=l.x,i=l.y}return o.containsPoint(this,{x:e,y:i})}setAttributes(e,i=!1,n){(e=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(e,this.attribute,null,n)||e).background?this.loadImage(e.background,!0):e.shadowGraphic&&this.setShadowGraphic(e.shadowGraphic),this._setAttributes(e,i,n)}_setAttributes(e,i=!1,n){const o=Object.keys(e);for(let l=0;l<o.length;l++){const d=o[l];this.attribute[d]=e[d]}this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!i&&!this.needUpdateTags(o)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(n)}setAttribute(e,i,n,o){var l;const d=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({[e]:i},this.attribute,e,o);d?this._setAttributes(d,n,o):isNil((l=this.normalAttrs)===null||l===void 0?void 0:l[e])?(this.attribute[e]=i,this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!n&&!this.needUpdateTag(e)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(o)):this.normalAttrs[e]=i,e==="background"?this.loadImage(i,!0):e==="shadowGraphic"&&this.setShadowGraphic(i)}needUpdateTags(e,i=GRAPHIC_UPDATE_TAG_KEY){for(let n=0;n<i.length;n++){const o=i[n];if(e.indexOf(o)!==-1)return!0}return!1}needUpdateTag(e,i=GRAPHIC_UPDATE_TAG_KEY){for(let n=0;n<i.length;n++)if(e===i[n])return!0;return!1}initAttributes(e){const i={type:AttributeUpdateType.INIT};e=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(e,this.attribute,null,i)||e,this.attribute=e,e.background?this.loadImage(e.background,!0):e.shadowGraphic&&this.setShadowGraphic(e.shadowGraphic),this._updateTag=UpdateTag.INIT,this.valid=this.isValid(),this.onAttributeUpdate(i)}translate(e,i){var n,o;if(e===0&&i===0)return this;const l={type:AttributeUpdateType.TRANSLATE},d=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({x:e,y:i},this.attribute,tempConstantXYKey,l);d&&(e=d.x,i=d.y,delete d.x,delete d.y,this._setAttributes(d));const u=this.attribute,f=u.postMatrix;return f?application.transformUtil.fromMatrix(f,f).translate(e,i):(u.x=((n=u.x)!==null&&n!==void 0?n:DefaultTransform.x)+e,u.y=((o=u.y)!==null&&o!==void 0?o:DefaultTransform.y)+i),this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(l),this}translateTo(e,i){const n=this.attribute;if(n.x===e&&n.y===i)return this;const o={type:AttributeUpdateType.TRANSLATE_TO},l=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({x:e,y:i},this.attribute,tempConstantXYKey,o);return l?(this._setAttributes(l,!1,o),this):(n.x=e,n.y=i,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(o),this)}scale(e,i,n){var o,l;if(e===1&&i===1)return this;const d={type:AttributeUpdateType.SCALE},u=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({scaleX:e,scaleY:i,scaleCenter:n},this.attribute,tempConstantScaleXYKey,d);u&&(e=u.scaleX,i=u.scaleY,delete u.scaleX,delete u.scaleY,this._setAttributes(u));const f=this.attribute;if(n){let{postMatrix:g}=this.attribute;g||(g=new Matrix,f.postMatrix=g),application.transformUtil.fromMatrix(g,g).scale(e,i,n)}else f.scaleX=((o=f.scaleX)!==null&&o!==void 0?o:DefaultTransform.scaleX)*e,f.scaleY=((l=f.scaleY)!==null&&l!==void 0?l:DefaultTransform.scaleY)*i;return this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(d),this}scaleTo(e,i){const n=this.attribute;if(n.scaleX===e&&n.scaleY===i)return this;const o={type:AttributeUpdateType.SCALE_TO},l=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({scaleX:e,scaleY:i},this.attribute,tempConstantScaleXYKey,o);return l?(this._setAttributes(l,!1,o),this):(n.scaleX=e,n.scaleY=i,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(o),this)}rotate(e,i){var n;if(e===0)return this;const o={type:AttributeUpdateType.ROTATE},l=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({angle:e,rotateCenter:i},this.attribute,tempConstantAngleKey,o);l&&(delete l.angle,this._setAttributes(l,!1,o));const d=this.attribute;if(i){let{postMatrix:u}=this.attribute;u||(u=new Matrix,d.postMatrix=u),application.transformUtil.fromMatrix(u,u).rotate(e,i)}else d.angle=((n=d.angle)!==null&&n!==void 0?n:DefaultTransform.angle)+e;return this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(o),this}rotateTo(e){const i=this.attribute;if(i.angle===e)return this;const n={type:AttributeUpdateType.ROTATE_TO},o=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(e,this.attribute,tempConstantAngleKey,n);return o?(this._setAttributes(o,!1,n),this):(i.angle=e,this.addUpdatePositionTag(),this.addUpdateBoundTag(),this.addUpdateLayoutTag(),this.onAttributeUpdate(n),this)}skewTo(e,i){return this}animate(e){this.animates||(this.animates=new Map);const i=new Animate$1(e==null?void 0:e.id,this.stage&&this.stage.getTimeline(),e==null?void 0:e.slience);if(i.bind(this),e){const{onStart:n,onFrame:o,onEnd:l,onRemove:d}=e;n!=null&&i.onStart(n),o!=null&&i.onFrame(o),l!=null&&i.onEnd(l),d!=null&&i.onRemove(d),i.interpolateFunc=e.interpolate}return this.animates.set(i.id,i),i.onRemove(()=>{this.animates.delete(i.id)}),i}onAttributeUpdate(e){e&&e.skipUpdateCallback||(application.graphicService.onAttributeUpdate(this),this._emitCustomEvent("afterAttributeUpdate",e))}update(e){e?(e.bounds&&this.tryUpdateAABBBounds(this.attribute.boundsMode==="imprecise"),e.trans&&this.tryUpdateLocalTransMatrix()):(this.tryUpdateAABBBounds(this.attribute.boundsMode==="imprecise"),this.tryUpdateLocalTransMatrix())}hasState(e){return!(!this.currentStates||!this.currentStates.length)&&(!!isNil(e)||this.currentStates.includes(e))}getState(e){var i;return(i=this.states)===null||i===void 0?void 0:i[e]}applyStateAttrs(e,i,n,o){var l,d,u,f;if(n){const g=Object.keys(e),_=this.getNoWorkAnimateAttr(),y={};let b;g.forEach(v=>{_[v]?(b||(b={}),b[v]=e[v]):y[v]=o&&e[v]===void 0?this.getDefaultAttribute(v):e[v]});const S=this.animate({slience:!0});S.stateNames=i,S.to(y,(d=(l=this.stateAnimateConfig)===null||l===void 0?void 0:l.duration)!==null&&d!==void 0?d:DefaultStateAnimateConfig.duration,(f=(u=this.stateAnimateConfig)===null||u===void 0?void 0:u.easing)!==null&&f!==void 0?f:DefaultStateAnimateConfig.easing),b&&this.setAttributes(b,!1,{type:AttributeUpdateType.STATE})}else this.stopStateAnimates(),this.setAttributes(e,!1,{type:AttributeUpdateType.STATE})}updateNormalAttrs(e){const i={};this.normalAttrs?(Object.keys(e).forEach(n=>{n in this.normalAttrs?(i[n]=this.normalAttrs[n],delete this.normalAttrs[n]):i[n]=this.getNormalAttribute(n)}),Object.keys(this.normalAttrs).forEach(n=>{e[n]=this.normalAttrs[n]})):Object.keys(e).forEach(n=>{i[n]=this.getNormalAttribute(n)}),this.normalAttrs=i}stopStateAnimates(e="end"){this.animates&&this.animates.forEach(i=>{i.stateNames&&(i.stop(e),this.animates.delete(i.id))})}getNormalAttribute(e){let i=this.attribute[e];return this.animates&&this.animates.forEach(n=>{if(n.stateNames){const o=n.getEndProps();has(o,e)&&(i=o[e])}}),i}clearStates(e){this.hasState()&&this.normalAttrs?(this.currentStates=[],this.applyStateAttrs(this.normalAttrs,this.currentStates,e,!0)):this.currentStates=[],this.normalAttrs=null}removeState(e,i){if((this.currentStates?this.currentStates.indexOf(e):-1)>=0){const n=this.currentStates.filter(o=>o!==e);this.useStates(n,i)}}toggleState(e,i){if(this.hasState(e))this.removeState(e,i);else if((this.currentStates?this.currentStates.indexOf(e):-1)<0){const n=this.currentStates?this.currentStates.slice():[];n.push(e),this.useStates(n,i)}}addState(e,i,n){var o;if(this.currentStates&&this.currentStates.includes(e)&&(i||this.currentStates.length===1))return;const l=i&&(!((o=this.currentStates)===null||o===void 0)&&o.length)?this.currentStates.concat([e]):[e];this.useStates(l,n)}useStates(e,i){var n;if(!e.length)return void this.clearStates(i);if(!(((n=this.currentStates)===null||n===void 0?void 0:n.length)!==e.length||e.some((l,d)=>this.currentStates[d]!==l)))return;const o={};e.forEach(l=>{var d;const u=this.stateProxy?this.stateProxy(l,e):(d=this.states)===null||d===void 0?void 0:d[l];u&&Object.assign(o,u)}),this.updateNormalAttrs(o),this.currentStates=e,this.applyStateAttrs(o,e,i)}addUpdateBoundTag(){this._updateTag|=UpdateTag.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag(),this.glyphHost&&this.glyphHost.addUpdateBoundTag()}addUpdateShapeTag(){this._updateTag|=UpdateTag.UPDATE_SHAPE}addUpdateShapeAndBoundsTag(){this._updateTag|=UpdateTag.UPDATE_SHAPE_AND_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag(),this.glyphHost&&this.glyphHost.addUpdateBoundTag()}updateShapeAndBoundsTagSetted(){return(this._updateTag&UpdateTag.UPDATE_SHAPE_AND_BOUNDS)===UpdateTag.UPDATE_SHAPE_AND_BOUNDS}clearUpdateBoundTag(){this._updateTag&=UpdateTag.CLEAR_BOUNDS}addUpdatePositionTag(){this.shadowRoot&&this.shadowRoot.addUpdateGlobalPositionTag(),this._updateTag|=UpdateTag.UPDATE_GLOBAL_LOCAL_MATRIX}addUpdateGlobalPositionTag(){this.shadowRoot&&this.shadowRoot.addUpdateGlobalPositionTag(),this._updateTag|=UpdateTag.UPDATE_GLOBAL_MATRIX}clearUpdateLocalPositionTag(){this._updateTag&=UpdateTag.CLEAR_LOCAL_MATRIX}clearUpdateGlobalPositionTag(){this._updateTag&=UpdateTag.CLEAR_GLOBAL_MATRIX}addUpdateLayoutTag(){this._updateTag|=UpdateTag.UPDATE_LAYOUT}clearUpdateLayoutTag(){this._updateTag&=UpdateTag.CLEAR_LAYOUT}needUpdateLayout(){return!!(this._updateTag&UpdateTag.UPDATE_LAYOUT)}getAnchor(e,i){const n=[0,0],o=()=>{if(i.b)return i.b;const{scaleX:l,scaleY:d,angle:u}=this.attribute;return tempBounds$1.copy(this._AABBBounds),this.setAttributes({scaleX:1,scaleY:1,angle:0}),i.b=this.AABBBounds.clone(),this._AABBBounds.copy(tempBounds$1),this.setAttributes({scaleX:l,scaleY:d,angle:u}),i.b};if(typeof e[0]=="string"){const l=parseFloat(e[0])/100,d=o();n[0]=d.x1+(d.x2-d.x1)*l}else n[0]=e[0];if(typeof e[1]=="string"){const l=parseFloat(e[1])/100,d=o();n[1]=d.y1+(d.y2-d.y1)*l}else n[1]=e[1];return n}doUpdateLocalMatrix(){const{x:e=DefaultTransform.x,y:i=DefaultTransform.y,scaleX:n=DefaultTransform.scaleX,scaleY:o=DefaultTransform.scaleY,angle:l=DefaultTransform.angle,scaleCenter:d,anchor:u,postMatrix:f}=this.attribute;let g=[0,0];const _={};if(u&&(g=this.getAnchor(u,_)),!d||n===1&&o===1)normalTransform(this._transMatrix,this._transMatrix.reset(),e,i,n,o,l,u&&g);else{const b=this._transMatrix;b.reset(),b.translate(g[0],g[1]),b.rotate(l),b.translate(-g[0],-g[1]),b.translate(e,i),g=this.getAnchor(d,_),application.transformUtil.fromMatrix(b,b).scale(n,o,{x:g[0],y:g[1]})}const y=this.getOffsetXY(DefaultTransform);if(this._transMatrix.e+=y.x,this._transMatrix.f+=y.y,f){const b=tempMatrix.setValue(f.a,f.b,f.c,f.d,f.e,f.f),S=this._transMatrix;b.multiply(S.a,S.b,S.c,S.d,S.e,S.f),S.setValue(b.a,b.b,b.c,b.d,b.e,b.f)}}doUpdateGlobalMatrix(){if(this.parent){this._globalTransMatrix.multiply(this.transMatrix.a,this.transMatrix.b,this.transMatrix.c,this.transMatrix.d,this.transMatrix.e,this.transMatrix.f);const{scrollX:e=0,scrollY:i=0}=this.parent.attribute;this._globalTransMatrix.translate(e,i)}}setStage(e,i){if(this.stage!==e){if(this.stage=e,this.layer=i,this.setStageToShadowRoot(e,i),this.animates&&this.animates.size){const n=e.getTimeline();this.animates.forEach(o=>{o.setTimeline(n)})}this._onSetStage&&this._onSetStage(this,e,i),application.graphicService.onSetStage(this,e)}}setStageToShadowRoot(e,i){this.shadowRoot&&this.shadowRoot.setStage(e,i)}onAddStep(e){}onStop(e){e&&this.setAttributes(e,!1,{type:AttributeUpdateType.ANIMATE_END})}onStep(e,i,n,o,l){const d={};if(n.customAnimate)n.customAnimate.update(l,o,d);else{const u=n.props,f=n.parsedProps,g=n.propKeys;this.stepInterpolate(e,i,d,n,o,l,u,void 0,f,g)}this.setAttributes(d,!1,{type:AttributeUpdateType.ANIMATE_UPDATE,animationState:{ratio:o,end:l,step:n,isFirstFrameOfStep:e.getLastStep()!==n}}),this.stage&&this.stage.renderNextFrame()}stepInterpolate(e,i,n,o,l,d,u,f,g,_){_||(_=Object.keys(u),o.propKeys=_),d?o.propKeys.forEach(y=>{i.validAttr(y)&&(n[y]=u[y])}):_.forEach(y=>{var b;if(!i.validAttr(y))return;const S=u[y],v=(b=f&&f[y])!==null&&b!==void 0?b:e.getLastPropByName(y,o);if(S==null||v==null||S===v)return void(n[y]=S);let A;A=i.interpolateFunc&&i.interpolateFunc(y,l,v,S,n),A||(A=i.customInterpolate(y,l,v,S,this,n),A||this.defaultInterpolate(S,v,y,n,g,l)||this._interpolate(y,l,v,S,n))}),o.parsedProps=g}defaultInterpolate(e,i,n,o,l,d){if(Number.isFinite(e))return o[n]=i+(e-i)*d,!0;if(n==="fill"){l||(l={});const u=l.fillColorArray,f=interpolateColor(i,u??e,d,!1,(g,_)=>{l.fillColorArray=_});return f&&(o[n]=f),!0}if(n==="stroke"){l||(l={});const u=l.strokeColorArray,f=interpolateColor(i,u??e,d,!1,(g,_)=>{l.strokeColorArray=_});return f&&(o[n]=f),!0}if(n==="shadowColor"){l||(l={});const u=l.shadowColorArray,f=interpolateColor(i,u??e,d,!0,(g,_)=>{l.shadowColorArray=_});return f&&(o[n]=f),!0}return!1}_interpolate(e,i,n,o,l){}getDefaultAttribute(e){return this.getGraphicTheme()[e]}getComputedAttribute(e){var i;return(i=this.attribute[e])!==null&&i!==void 0?i:this.getDefaultAttribute(e)}onSetStage(e,i=!1){this._onSetStage=e,i&&this.stage&&e(this,this.stage)}attachShadow(e){return e&&(e.shadowHost=this),this.shadowRoot=e??application.graphicService.creator.shadowRoot(this),this.addUpdateBoundTag(),this.shadowRoot.setStage(this.stage,this.layer),this.shadowRoot}detachShadow(){this.shadowRoot&&(this.addUpdateBoundTag(),this.shadowRoot=null)}toJson(){return{attribute:this.attribute,_uid:this._uid,type:this.type,name:this.name,children:this.children.map(e=>e.toJson())}}createPathProxy(e){return isString(e,!0)?this.pathProxy=new CustomPath2D().fromString(e):this.pathProxy=new CustomPath2D,this.pathProxy}loadImage(e,i=!1){if(!e||i&&backgroundNotImage(e))return;const n=e;this.resources||(this.resources=new Map);const o={data:"init",state:null};this.resources.set(n,o),typeof e=="string"?(o.state="loading",e.startsWith("<svg")?(ResourceLoader.GetSvg(e,this),this.backgroundImg=this.backgroundImg||i):(isValidUrl(e)||e.includes("/")||isBase64(e))&&(ResourceLoader.GetImage(e,this),this.backgroundImg=this.backgroundImg||i)):isObject$1(e)?(o.state="success",o.data=e,this.backgroundImg=this.backgroundImg||i):o.state="fail"}setShadowGraphic(e){e?this.attachShadow().add(e):this.detachShadow()}imageLoadSuccess(e,i,n){if(!this.resources)return;const o=this.resources.get(e);o&&(o.state="success",o.data=i,n&&n(),this.addUpdateBoundTag(),this.stage&&this.stage.renderNextFrame())}imageLoadFail(e,i){if(!this.resources)return;const n=this.resources.get(e);n&&(n.state="fail",i&&i())}_stopAnimates(e){e&&e.forEach(i=>{i.stop()})}stopAnimates(e=!1){this._stopAnimates(this.animates),this.shadowRoot&&this.shadowRoot.stopAnimates(!0),this.isContainer&&e&&this.forEachChildren(i=>{i.stopAnimates(e)})}release(){this.releaseStatus="released",application.graphicService.onRelease(this)}_emitCustomEvent(e,i){var n,o;if(this._events&&e in this._events){const l=new CustomEvent(e,i);l.bubbles=!1,l.manager=(o=(n=this.stage)===null||n===void 0?void 0:n.eventSystem)===null||o===void 0?void 0:o.manager,this.dispatchEvent(l)}}}function backgroundNotImage(r){return!(!r.fill&&!r.stroke)}Graphic.mixin(EventTarget);function getAllMatches(r,e){const i=[];let n=e.exec(r);for(;n;){const o=[];o.startIndex=e.lastIndex-n[0].length;const l=n.length;for(let d=0;d<l;d++)o.push(n[d]);i.push(o),n=e.exec(r)}return i}class XmlNode{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,i){e==="__proto__"&&(e="#__proto__"),this.child.push({[e]:i})}addChild(e){e.tagname==="__proto__"&&(e.tagname="#__proto__"),e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,":@":e[":@"]}):this.child.push({[e.tagname]:e.child})}}function findClosingIndex(r,e,i,n){const o=r.indexOf(e,i);if(o===-1)throw new Error(n);return o+e.length-1}function tagExpWithClosingIndex(r,e,i=">"){let n,o="";for(let l=e;l<r.length;l++){let d=r[l];if(n)d===n&&(n="");else if(d==='"'||d==="'")n=d;else if(d===i[0]){if(!i[1])return{data:o,index:l};if(r[l+1]===i[1])return{data:o,index:l}}else d==="	"&&(d=" ");o+=d}}function readTagExp(r,e,i,n=">"){const o=tagExpWithClosingIndex(r,e+1,n);if(!o)return;let l=o.data;const d=o.index,u=l.search(/\s/);let f=l,g=!0;return u!==-1&&(f=l.substr(0,u).replace(/\s\s*$/,""),l=l.substr(u+1)),{tagName:f,tagExp:l,closeIndex:d,attrExpPresent:g,rawTagName:f}}const attrsRegx=new RegExp(`([^\\s=]+)\\s*(=\\s*(['"])([\\s\\S]*?)\\3)?`,"gm");class OrderedObjParser{constructor(e){this.currentNode=null,this.options=e,this.tagsNodeStack=[],this.docTypeEntities={}}addChild(e,i,n){const o=i.tagname;typeof o=="string"&&(i.tagname=o),e.addChild(i)}buildAttributesMap(e,i,n){const o={};if(!e)return;const l=getAllMatches(e,attrsRegx),d=l.length;for(let u=0;u<d;u++){const f=l[u][1],g=l[u][4],_=f;f&&(o[_]=g===void 0||(isNaN(g)?g:Number(g)))}return o}parseXml(e){e=e.replace(/\r\n?/g,`
`);const i=new XmlNode("!xml");let n=i,o="",l="";for(let d=0;d<e.length;d++)if(e[d]==="<")if(e[d+1]==="/"){const u=findClosingIndex(e,">",d,"Closing Tag is not closed."),f=l.lastIndexOf(".");l=l.substring(0,f),n=this.tagsNodeStack.pop(),n&&n.child&&o&&n.child[n.child.length-1][":@"]&&(n.child[n.child.length-1][":@"].text=o),o="",d=u}else if(e[d+1]==="?")d=readTagExp(e,d,!1,"?>").closeIndex+1;else if(e.substr(d+1,3)==="!--")d=findClosingIndex(e,"-->",d+4,"Comment is not closed.");else{const u=readTagExp(e,d);let f=u.tagName,g=u.tagExp;const _=u.attrExpPresent,y=u.closeIndex;if(f!==i.tagname&&(l+=l?"."+f:f),g.length>0&&g.lastIndexOf("/")===g.length-1){f[f.length-1]==="/"?(f=f.substr(0,f.length-1),l=l.substr(0,l.length-1),g=f):g=g.substr(0,g.length-1);const b=new XmlNode(f);f!==g&&_&&(b[":@"]=this.buildAttributesMap(g,l,f)),this.addChild(n,b,l),l=l.substr(0,l.lastIndexOf("."))}else{const b=new XmlNode(f);this.tagsNodeStack.push(n),f!==g&&_&&(b[":@"]=this.buildAttributesMap(g,l,f)),this.addChild(n,b,l),n=b}o="",d=y}else o+=e[d];return i.child}}function prettify(r,e){return compress(r)}function compress(r,e){const i={};for(let n=0;n<r.length;n++){const o=r[n],l=propName(o);if(l!==void 0&&o[l]){const d=compress(o[l]);isLeafTag(d),o[":@"]&&assignAttributes(d,o[":@"]),i[l]!==void 0&&i.hasOwnProperty(l)?(Array.isArray(i[l])||(i[l]=[i[l]]),i[l].push(d)):i[l]=d}}return i}function propName(r){const e=Object.keys(r);for(let i=0;i<e.length;i++){const n=e[i];if(n!==":@")return n}}function assignAttributes(r,e,i){if(e){const n=Object.keys(e),o=n.length;for(let l=0;l<o;l++){const d=n[l];r[d]=e[d]}}}function isLeafTag(r){return Object.keys(r).length===0}class XMLParser{constructor(e){this.options=Object.assign({},XMLParser.defaultOptions,e)}valid(e){return e.startsWith("<")}parse(e){if(!this.valid)return!1;const i=new OrderedObjParser(this.options).parseXml(e);return prettify(i,this.options)}}XMLParser.defaultOptions={};function isSvg(r){return r.startsWith("<svg")||r.startsWith("<?xml")}var __awaiter$7=function(r,e,i,n){return new(i||(i=Promise))(function(o,l){function d(g){try{f(n.next(g))}catch(_){l(_)}}function u(g){try{f(n.throw(g))}catch(_){l(_)}}function f(g){var _;g.done?o(g.value):(_=g.value,_ instanceof i?_:new i(function(y){y(_)})).then(d,u)}f((n=n.apply(r,e||[])).next())})};function waitForAllSubLayers(r){return __awaiter$7(this,void 0,void 0,function*(){const e=[],i=r.getChildren();yield new Promise(n=>{application.global.getRequestAnimationFrame()(()=>{n(null)})}),i.forEach(n=>{n.subLayers.size&&n.subLayers.forEach(o=>{o.drawContribution&&o.drawContribution.hooks&&o.drawContribution.rendering&&e.push(new Promise(l=>{o.drawContribution.hooks.completeDraw.tap("outWait",()=>{o.drawContribution.hooks.completeDraw.taps=o.drawContribution.hooks.completeDraw.taps.filter(d=>d.name!=="outWait"),l(null)})}))})}),yield Promise.all(e)})}function boundStroke(r,e,i,n=0){return r.expand(e+(n/2+(i?miterAdjustment(i,e):0))),r}function miterAdjustment(r,e){return r?e:0}let NUMBER_TYPE=0;function genNumberType(){return NUMBER_TYPE++}var TextDirection;(function(r){r[r.HORIZONTAL=0]="HORIZONTAL",r[r.VERTICAL=1]="VERTICAL"})(TextDirection||(TextDirection={}));function verticalLayout(r){const e=[];let i=0,n="";for(let o=0;o<r.length;o++)rotateText(r[o])?i?n+=r[o]:(i=1,n=r[o]):(i&&(e.push({text:n,direction:TextDirection.VERTICAL}),n="",i=0),e.push({text:r[o],direction:TextDirection.HORIZONTAL}));return n&&e.push({text:n,direction:TextDirection.VERTICAL}),e}const rotateCharList=["","","","","","","","","",""],rotateCharMap=new Map;rotateCharList.forEach(r=>rotateCharMap.set(r,!0));const noRotateCharList=[""],noRotateCharMap=new Map;function rotateText(r){if(rotateCharMap.has(r))return!0;if(noRotateCharMap.has(r))return!1;let e=!1;return r.codePointAt(0)<256&&(e=!0),e}noRotateCharList.forEach(r=>noRotateCharMap.set(r,!0));const ARC_NUMBER_TYPE=genNumberType(),ARC3D_NUMBER_TYPE=genNumberType(),AREA_NUMBER_TYPE=genNumberType(),CIRCLE_NUMBER_TYPE=genNumberType(),GLYPH_NUMBER_TYPE=genNumberType(),GROUP_NUMBER_TYPE=genNumberType(),IMAGE_NUMBER_TYPE=genNumberType(),LINE_NUMBER_TYPE=genNumberType(),PATH_NUMBER_TYPE=genNumberType(),POLYGON_NUMBER_TYPE=genNumberType(),PYRAMID3D_NUMBER_TYPE=genNumberType(),RECT_NUMBER_TYPE=genNumberType(),RECT3D_NUMBER_TYPE=genNumberType(),RICHTEXT_NUMBER_TYPE=genNumberType(),SYMBOL_NUMBER_TYPE=genNumberType(),TEXT_NUMBER_TYPE=genNumberType(),GraphicService=Symbol.for("GraphicService"),GraphicCreator$1=Symbol.for("GraphicCreator"),SVG_PARSE_ATTRIBUTE_MAP={"stroke-linecap":"lineCap","stroke-linejoin":"lineJoin","stroke-dasharray":"lineDash","stroke-dashoffset":"lineDashOffset","stroke-width":"lineWidth","fill-opacity":"fillOpacity","stroke-opacity":"strokeOpacity",stroke:"stroke",fill:"fill"},SVG_PARSE_ATTRIBUTE_MAP_KEYS=Object.keys(SVG_PARSE_ATTRIBUTE_MAP);var GroupUpdateAABBBoundsMode;(function(r){r[r.LESS_GROUP=0]="LESS_GROUP",r[r.MORE_GROUP=1]="MORE_GROUP"})(GroupUpdateAABBBoundsMode||(GroupUpdateAABBBoundsMode={}));let Group$1=class Ie extends Graphic{constructor(e){super(e),this.type="group",this.parent=null,this.isContainer=!0,this.numberType=GROUP_NUMBER_TYPE,this._childUpdateTag=UpdateTag.UPDATE_BOUNDS}setMode(e){e==="3d"?this.set3dMode():this.set2dMode()}set3dMode(){this.in3dMode=!0}set2dMode(){this.in3dMode=!1}setTheme(e){return this.theme||(this.theme=new Theme),this.theme.setTheme(e,this)}createTheme(){this.theme||(this.theme=new Theme)}visibleAll(e){this.setAttribute("visible",e),this.forEachChildren(i=>{i.isContainer&&i.visibleAll?i.visibleAll(e):i.setAttribute("visible",e)})}hideAll(){this.visibleAll(!1)}showAll(){this.visibleAll(!0)}containsPoint(e,i,n){if(n===IContainPointMode.GLOBAL){const o=new Point(e,i);return this.parent&&this.parent.globalTransMatrix.transformPoint(o,o),this.AABBBounds.contains(o.x,o.y)}return this.AABBBounds.contains(e,i)}shouldUpdateAABBBounds(){return!!super.shouldUpdateAABBBounds()||!!(this._childUpdateTag&UpdateTag.UPDATE_BOUNDS)}tryUpdateAABBBounds(){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;application.graphicService.beforeUpdateAABBBounds(this,this.stage,!0,this._AABBBounds);const e=this.shouldSelfChangeUpdateAABBBounds(),i=this.doUpdateAABBBounds();return this.addUpdateLayoutTag(),application.graphicService.afterUpdateAABBBounds(this,this.stage,this._AABBBounds,this,e),i}doUpdateLocalMatrix(){const{x:e=DefaultTransform.x,y:i=DefaultTransform.y,dx:n=DefaultTransform.dx,dy:o=DefaultTransform.dy,scaleX:l=DefaultTransform.scaleX,scaleY:d=DefaultTransform.scaleY,angle:u=DefaultTransform.angle,postMatrix:f}=this.attribute;if(e!==0||i!==0||n!==0||o!==0||l!==1||d!==1||u!==0||f)return super.doUpdateLocalMatrix();this._transMatrix.reset()}getGraphicTheme(){return getTheme$1(this).group}updateAABBBounds(e,i,n){const o=n;n=n.clone();const{width:l,height:d,path:u,clip:f=i.clip}=e;if(u&&u.length?u.forEach(g=>{n.union(g.AABBBounds)}):l!=null&&d!=null&&n.set(0,0,Math.max(0,l),Math.max(0,d)),!f){this.forEachChildren(y=>{n.union(y.AABBBounds)});const{scrollX:g=0,scrollY:_=0}=e;n.translate(g,_)}return application.graphicService.updateTempAABBBounds(n),application.graphicService.transformAABBBounds(e,n,i,!1,this),o.copy(n),o}doUpdateAABBBounds(){this.updateAABBBoundsStamp++;const e=super.doUpdateAABBBounds();return this.parent&&this.parent.addChildUpdateBoundTag(),this._emitCustomEvent("AAABBBoundsChange"),e}clearUpdateBoundTag(){this._updateTag&=UpdateTag.CLEAR_BOUNDS,this._childUpdateTag&=UpdateTag.CLEAR_BOUNDS}addUpdateBoundTag(){this._updateTag|=UpdateTag.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag()}addChildUpdateBoundTag(){this._childUpdateTag&UpdateTag.UPDATE_BOUNDS||(this._childUpdateTag|=UpdateTag.UPDATE_BOUNDS,this.parent&&this.parent.addChildUpdateBoundTag())}getTheme(){return this.theme.getTheme(this)}incrementalAppendChild(e){const i=super.appendChild(e);return this.stage&&i&&(i.stage=this.stage,i.layer=this.layer),this.addUpdateBoundTag(),application.graphicService.onAddIncremental(e,this,this.stage),i}incrementalClearChild(){super.removeAllChild(),this.addUpdateBoundTag(),application.graphicService.onClearIncremental(this,this.stage)}_updateChildToStage(e){return this.stage&&e&&e.setStage(this.stage,this.layer),this.addUpdateBoundTag(),e}appendChild(e,i=!0){const n=super.appendChild(e);return i&&this.stage&&n&&n.setStage(this.stage,this.layer),this.addUpdateBoundTag(),n}insertBefore(e,i){return this._updateChildToStage(super.insertBefore(e,i))}insertAfter(e,i){return this._updateChildToStage(super.insertAfter(e,i))}insertInto(e,i){return this._updateChildToStage(super.insertInto(e,i))}removeChild(e){const i=super.removeChild(e);return e.stage=null,application.graphicService.onRemove(e),this.addUpdateBoundTag(),i}removeAllChild(e=!1){this.forEachChildren(i=>{application.graphicService.onRemove(i),e&&i.isContainer&&i.removeAllChild(e)}),super.removeAllChild(),this.addUpdateBoundTag()}setStage(e,i){this.stage!==e&&(this.stage=e,this.layer=i,this.setStageToShadowRoot(e,i),this._onSetStage&&this._onSetStage(this,e,i),application.graphicService.onSetStage(this,e),this.forEachChildren(n=>{n.setStage(e,this.layer)}))}addUpdatePositionTag(){super.addUpdatePositionTag(),this.forEachChildren(e=>{e.isContainer&&e.addUpdateGlobalPositionTag()})}addUpdateGlobalPositionTag(){super.addUpdateGlobalPositionTag(),this.forEachChildren(e=>{e.isContainer&&e.addUpdateGlobalPositionTag()})}tryUpdateGlobalTransMatrix(e=!0){if(this.shouldUpdateGlobalMatrix()){if(this._globalTransMatrix){if(this.parent){const i=this.parent.globalTransMatrix;this._globalTransMatrix.setValue(i.a,i.b,i.c,i.d,i.e,i.f)}}else this._globalTransMatrix=this.parent?this.parent.globalTransMatrix.clone():this.transMatrix.clone();this.doUpdateGlobalMatrix(),e&&this.clearUpdateGlobalPositionTag()}return this._globalTransMatrix}shouldUpdateGlobalMatrix(){return!!(this._updateTag&UpdateTag.UPDATE_GLOBAL_MATRIX)}_getChildByName(e,i){return this.find(n=>n.name===e,i)}createOrUpdateChild(e,i,n){let o=this._getChildByName(e);return o?o.setAttributes(i):(o=application.graphicService.creator[n](i),o.name=e,this.add(o)),o}clone(){return new Ie(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return Ie.NOWORK_ANIMATE_ATTR}};Group$1.NOWORK_ANIMATE_ATTR=NOWORK_ANIMATE_ATTR;function createGroup(r){return new Group$1(r)}class Layer extends Group$1{get offscreen(){return this.layerHandler.offscreen}get layerMode(){return this.layerHandler.type}get width(){return this.stage?this.stage.width:0}get height(){return this.stage?this.stage.height:0}get viewWidth(){return this.stage?this.stage.viewWidth:0}get viewHeight(){return this.stage?this.stage.viewHeight:0}get dirtyBound(){throw new Error("")}get dpr(){return this._dpr}constructor(e,i,n,o){var l;super({}),this.stage=e,this.global=i,this.window=n,this.main=o.main,this.layerHandler=o.layerHandler,this.layerHandler.init(this,n,{main:o.main,canvasId:o.canvasId,width:this.viewWidth,height:this.viewHeight,zIndex:(l=o.zIndex)!==null&&l!==void 0?l:0}),this.layer=this,this.subLayers=new Map,this.theme=new Theme,this.background="rgba(0, 0, 0, 0)",this.afterDrawCbs=[]}combineSubLayer(e=!0){const i=Array.from(this.subLayers.values()).sort((n,o)=>n.zIndex-o.zIndex);this.layerHandler.merge(i.map(n=>(n.layer.subLayers.size&&n.layer.combineSubLayer(e),n.layer.getNativeHandler()))),e&&i.forEach(n=>{n.group&&(n.group.incremental=0)}),i.forEach(n=>{application.layerService.releaseLayer(this.stage,n.layer)}),this.subLayers.clear()}getNativeHandler(){return this.layerHandler}setStage(e,i){super.setStage(e,this)}pick(e,i){throw new Error("")}tryRenderSecondaryLayer(e,i){this.layerHandler.secondaryHandlers&&this.layerHandler.secondaryHandlers.length&&this.layerHandler.secondaryHandlers.forEach(n=>{n.layer.renderCount=this.renderCount,n.layer.render(e,i)})}render(e,i){var n;this.layerHandler.render([this],{renderService:e.renderService,stage:this.stage,layer:this,viewBox:e.viewBox,transMatrix:e.transMatrix,background:(n=e.background)!==null&&n!==void 0?n:this.background,updateBounds:e.updateBounds},i),this.afterDrawCbs.forEach(o=>o(this)),this.tryRenderSecondaryLayer(e,i)}resize(e,i){this.layerHandler.resize(e,i)}resizeView(e,i){this.layerHandler.resizeView(e,i)}setDpr(e){this.layerHandler.setDpr(e)}afterDraw(e){this.afterDrawCbs.push(e)}startAnimate(e){throw new Error("")}setToFrame(e){throw new Error("")}prepare(e,i){}release(){super.release(),this.layerHandler.release(),this.subLayers&&this.subLayers.forEach(e=>{application.layerService.releaseLayer(this.stage,e.layer)})}drawTo(e,i){var n;this.layerHandler.drawTo(e,[this],Object.assign({background:(n=i.background)!==null&&n!==void 0?n:this.background,renderService:i.renderService,viewBox:i.viewBox,transMatrix:i.transMatrix,stage:this.stage,layer:this},i)),this.afterDrawCbs.forEach(o=>o(this))}}const TransformUtil=Symbol.for("TransformUtil"),GraphicUtil=Symbol.for("GraphicUtil"),LayerService=Symbol.for("LayerService"),StaticLayerHandlerContribution=Symbol.for("StaticLayerHandlerContribution"),DynamicLayerHandlerContribution=Symbol.for("DynamicLayerHandlerContribution"),VirtualLayerHandlerContribution=Symbol.for("VirtualLayerHandlerContribution");var DefaultLayerService_1,__decorate$16=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$Q=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)};let DefaultLayerService=DefaultLayerService_1=class{static GenerateLayerId(){return`${DefaultLayerService_1.idprefix}_${DefaultLayerService_1.prefix_count++}`}constructor(){this.layerMap=new Map,this.global=application.global}tryInit(){this.inited||(this.staticLayerCountInEnv=this.global.getStaticCanvasCount(),this.dynamicLayerCountInEnv=this.global.getDynamicCanvasCount(),this.inited=!0)}getStageLayer(r){return this.layerMap.get(r)}getRecommendedLayerType(r){return r||(this.staticLayerCountInEnv!==0?"static":this.dynamicLayerCountInEnv!==0?"dynamic":"virtual")}getLayerHandler(r){let e;return e=r==="static"?container.get(StaticLayerHandlerContribution):r==="dynamic"?container.get(DynamicLayerHandlerContribution):container.get(VirtualLayerHandlerContribution),e}createLayer(r,e={main:!1}){var i;this.tryInit();let n=this.getRecommendedLayerType(e.layerMode);n=e.main||e.canvasId?"static":n;const o=this.getLayerHandler(n),l=new Layer(r,this.global,r.window,Object.assign(Object.assign({main:!1},e),{layerMode:n,canvasId:(i=e.canvasId)!==null&&i!==void 0?i:DefaultLayerService_1.GenerateLayerId(),layerHandler:o})),d=this.layerMap.get(r)||[];return d.push(l),this.layerMap.set(r,d),this.staticLayerCountInEnv--,l}prepareStageLayer(r){let e;r.forEachChildren(i=>{const n=i.getNativeHandler();n.type==="virtual"?(n.mainHandler=e,e.secondaryHandlers.push(n)):(e=n,e.secondaryHandlers=[])})}releaseLayer(r,e){e.release();const i=this.layerMap.get(r)||[];this.layerMap.set(r,i.filter(n=>n!==e))}layerCount(r){return(this.layerMap.get(r)||[]).length}restLayerCount(r){return this.global.env==="browser"?10:0}releaseStage(r){this.layerMap.delete(r)}};DefaultLayerService.idprefix="visactor_layer",DefaultLayerService.prefix_count=0,DefaultLayerService=DefaultLayerService_1=__decorate$16([injectable(),__metadata$Q("design:paramtypes",[])],DefaultLayerService);const coreModule=new ContainerModule(r=>{r(VGlobal).to(DefaultGlobal).inSingletonScope(),r(VWindow).to(DefaultWindow),r(GraphicUtil).to(DefaultGraphicUtil).inSingletonScope(),r(TransformUtil).to(DefaultTransformUtil).inSingletonScope(),r(LayerService).to(DefaultLayerService).inSingletonScope()});function runFill(r,e){return!(!r&&!e)}function runStroke(r,e){let i;return i=isArray(r)?r.some(n=>n||n===void 0):!!r,i&&e>0}function fillVisible(r,e,i){return i&&r*e>0}function rectFillVisible(r,e,i,n,o){return o&&r*e>0&&i!==0&&n!==0}function strokeVisible(r,e){return r*e>0}function rectStrokeVisible(r,e,i,n){return r*e>0&&i!==0&&n!==0}function drawPathProxy(r,e,i,n,o,l,d,u){if(!r.pathProxy)return!1;const f=getTheme$1(r,l==null?void 0:l.theme)[r.type.replace("3d","")],{fill:g=f.fill,stroke:_=f.stroke,opacity:y=f.opacity,fillOpacity:b=f.fillOpacity,lineWidth:S=f.lineWidth,strokeOpacity:v=f.strokeOpacity,visible:A=f.visible,x=f.x,y:T=f.y}=r.attribute,C=fillVisible(y,b,g),E=strokeVisible(y,v),P=runFill(g),R=runStroke(_,S);if(!A||!P&&!R||!(C||E||d||u))return!0;e.beginPath();const L=typeof r.pathProxy=="function"?r.pathProxy(r.attribute):r.pathProxy;return renderCommandList(L.commandList,e,i,n),e.setShadowBlendStyle&&e.setShadowBlendStyle(r,r.attribute,f),R&&E&&(e.setStrokeStyle(r,r.attribute,i-x,n-T,f),e.stroke()),P&&C&&(e.setCommonStyle(r,r.attribute,i-x,n-T,f),e.fill()),!0}function intersect(r,e,i,n,o,l,d,u){const f=i-r,g=n-e,_=d-o,y=u-l;let b=y*f-_*g;return b*b<epsilon$1?[]:(b=(_*(e-l)-y*(r-o))/b,[r+b*f,e+b*g])}function cornerTangents(r,e,i,n,o,l,d){const u=r-i,f=e-n,g=(d?l:-l)/Math.sqrt(u*u+f*f),_=g*f,y=-g*u,b=r+_,S=e+y,v=i+_,A=n+y,x=(b+v)/2,T=(S+A)/2,C=v-b,E=A-S,P=C*C+E*E,R=o-l,L=b*A-v*S,w=(E<0?-1:1)*Math.sqrt(Math.max(0,R*R*P-L*L));let B=(L*E-C*w)/P,I=(-L*C-E*w)/P;const D=(L*E+C*w)/P,O=(-L*C+E*w)/P,N=B-x,V=I-T,H=D-x,F=O-T;return N*N+V*V>H*H+F*F&&(B=D,I=O),{cx:B,cy:I,x01:-_,y01:-y,x11:B*(o/R-1),y11:I*(o/R-1)}}function calculateArcCornerRadius(r,e,i,n,o){const l=abs$1(i-e),d=r.getParsedCornerRadius(),u=isArray(d),{outerDeltaAngle:f,innerDeltaAngle:g,outerStartAngle:_,outerEndAngle:y,innerEndAngle:b,innerStartAngle:S}=r.getParsePadAngle(e,i),v=u?d[0]:d,A=u?d[1]:d,x=u?d[2]:d,T=u?d[3]:d,C=Math.max(A,v),E=Math.max(x,T);let P=C,R=E;const L=o*cos$1(_),w=o*sin$1(_),B=n*cos$1(b),I=n*sin$1(b);let D,O,N,V;if((E>epsilon$1||C>epsilon$1)&&(D=o*cos$1(y),O=o*sin$1(y),N=n*cos$1(S),V=n*sin$1(S),l<pi$1)){const H=intersect(L,w,N,V,D,O,B,I);if(H){const F=L-H[0],$=w-H[1],G=D-H[0],Y=O-H[1],Q=1/sin$1(acos$1((F*G+$*Y)/(sqrt$3(F*F+$*$)*sqrt$3(G*G+Y*Y)))/2),q=sqrt$3(H[0]*H[0]+H[1]*H[1]);R=min$1(E,(n-q)/(Q-1)),P=min$1(C,(o-q)/(Q+1))}}return{outerDeltaAngle:f,xors:L,yors:w,xirs:N,yirs:V,xore:D,yore:O,xire:B,yire:I,limitedOcr:P,limitedIcr:R,outerCornerRadiusStart:v,outerCornerRadiusEnd:A,maxOuterCornerRadius:C,maxInnerCornerRadius:E,outerStartAngle:_,outerEndAngle:y,innerDeltaAngle:g,innerEndAngle:b,innerStartAngle:S,innerCornerRadiusStart:T,innerCornerRadiusEnd:x}}function drawArcPath$1(r,e,i,n,o,l,d){const{startAngle:u,endAngle:f}=r.getParsedAngle(),g=abs$1(f-u),_=f>u;let y=!1;if(o<l){const b=o;o=l,l=b}if(o<=epsilon$1)e.moveTo(i,n);else if(g>=pi2-epsilon$1)e.moveTo(i+o*cos$1(u),n+o*sin$1(u)),e.arc(i,n,o,u,f,!_),l>epsilon$1&&(e.moveTo(i+l*cos$1(f),n+l*sin$1(f)),e.arc(i,n,l,f,u,_));else{const{outerDeltaAngle:b,xors:S,yors:v,xirs:A,yirs:x,limitedOcr:T,outerCornerRadiusStart:C,outerCornerRadiusEnd:E,maxOuterCornerRadius:P,xore:R,yore:L,xire:w,yire:B,outerStartAngle:I,outerEndAngle:D,limitedIcr:O,innerDeltaAngle:N,innerEndAngle:V,innerStartAngle:H,innerCornerRadiusStart:F,innerCornerRadiusEnd:$,maxInnerCornerRadius:G}=calculateArcCornerRadius(r,u,f,l,o);if(b<.001)d&&(d[3]||d[1])&&e.moveTo(i+S,n+v),y=!0;else if(T>epsilon$1){const Y=min$1(C,T),Q=min$1(E,T),q=cornerTangents(A,x,S,v,o,Y,Number(_)),te=cornerTangents(R,L,w,B,o,Q,Number(_));T<P&&Y===Q?!d||d[0]?(e.moveTo(i+q.cx+q.x01,n+q.cy+q.y01),e.arc(i+q.cx,n+q.cy,T,atan2$1(q.y01,q.x01),atan2$1(te.y01,te.x01),!_)):e.moveTo(i+q.cx+T*cos$1(atan2$1(te.y01,te.x01)),n+q.cy+T*sin$1(atan2$1(te.y01,te.x01))):!d||d[0]?(e.moveTo(i+q.cx+q.x01,n+q.cy+q.y01),Y>0&&e.arc(i+q.cx,n+q.cy,Y,atan2$1(q.y01,q.x01),atan2$1(q.y11,q.x11),!_),e.arc(i,n,o,atan2$1(q.cy+q.y11,q.cx+q.x11),atan2$1(te.cy+te.y11,te.cx+te.x11),!_),Q>0&&e.arc(i+te.cx,n+te.cy,Q,atan2$1(te.y11,te.x11),atan2$1(te.y01,te.x01),!_)):Q>0?e.moveTo(i+te.cx+Q*cos$1(atan2$1(te.y01,te.x01)),n+te.cy+Q*sin$1(atan2$1(te.y01,te.x01))):e.moveTo(i+R,n+o*sin$1(D))}else!d||d[0]?(e.moveTo(i+S,n+v),e.arc(i,n,o,I,D,!_)):e.moveTo(i+o*cos$1(D),n+o*sin$1(D));if(!(l>epsilon$1)||N<.001)!d||d[1]?e.lineTo(i+w,n+B):e.moveTo(i+w,n+B),y=!0;else if(O>epsilon$1){const Y=min$1(F,O),Q=min$1($,O),q=cornerTangents(w,B,R,L,l,-Q,Number(_)),te=cornerTangents(S,v,A,x,l,-Y,Number(_));if(!d||d[1]?e.lineTo(i+q.cx+q.x01,n+q.cy+q.y01):e.moveTo(i+q.cx+q.x01,n+q.cy+q.y01),O<G&&Y===Q){const ue=atan2$1(te.y01,te.x01);!d||d[2]?e.arc(i+q.cx,n+q.cy,O,atan2$1(q.y01,q.x01),ue,!_):e.moveTo(i+q.cx+cos$1(ue),n+q.cy+sin$1(ue))}else!d||d[2]?(Q>0&&e.arc(i+q.cx,n+q.cy,Q,atan2$1(q.y01,q.x01),atan2$1(q.y11,q.x11),!_),e.arc(i,n,l,atan2$1(q.cy+q.y11,q.cx+q.x11),atan2$1(te.cy+te.y11,te.cx+te.x11),_),Y>0&&e.arc(i+te.cx,n+te.cy,Y,atan2$1(te.y11,te.x11),atan2$1(te.y01,te.x01),!_)):Y>0?e.moveTo(i+te.cx+Y*cos$1(atan2$1(te.y01,te.x01)),n+te.cy+Y*sin$1(atan2$1(te.y01,te.x01))):e.moveTo(i+A,n+x)}else!d||d[1]?e.lineTo(i+w,n+B):e.moveTo(i+w,n+B),!d||d[2]?e.arc(i,n,l,V,H,_):e.moveTo(i+l*cos$1(H),n+l*sin$1(H))}return d?d[3]&&e.lineTo(i+o*cos$1(u),n+o*sin$1(u)):e.closePath(),y}class ConicalCanvas{static GetCanvas(){try{return ConicalCanvas.canvas||(ConicalCanvas.canvas=application.global.createCanvas({})),ConicalCanvas.canvas}catch{return null}}static GetCtx(){if(!ConicalCanvas.ctx){const e=ConicalCanvas.GetCanvas();ConicalCanvas.ctx=e.getContext("2d")}return ConicalCanvas.ctx}}class ColorInterpolate extends LRU{static getInstance(){return ColorInterpolate._instance||(ColorInterpolate._instance=new ColorInterpolate),ColorInterpolate._instance}constructor(e=[],i=100){super(),this.cacheParams={CLEAN_THRESHOLD:100,L_TIME:1e3},this.dataMap=new Map;const n=ConicalCanvas.GetCanvas(),o=ConicalCanvas.GetCtx();if(n.width=i,n.height=1,!o)return;if(o.translate(0,0),!o)throw new Error("ctx");const l=o.createLinearGradient(0,0,i,0);e.forEach(d=>{l.addColorStop(d[0],d[1])}),o.fillStyle=l,o.fillRect(0,0,i,1),this.rgbaSet=o.getImageData(0,0,i,1).data}getColor(e){const i=this.rgbaSet.slice(4*e,4*e+4);return`rgba(${i[0]}, ${i[1]}, ${i[2]}, ${i[3]/255})`}GetOrCreate(e,i,n,o,l=[],d=100){let u=`${e}${i}${n}${o}`;l.forEach(g=>u+=g.join()),u+=d;let f=this.dataMap.get(u);return f||(f={data:new ColorInterpolate(l,d),timestamp:[]},this.addLimitedTimestamp(f,Date.now(),{}),this.dataMap.set(u,f)),this.clearCache(this.dataMap,this.cacheParams),f.data}}class ConicalPatternStore{static GetSize(e){for(let i=0;i<ConicalPatternStore.ImageSize.length;i++)if(ConicalPatternStore.ImageSize[i]>=e)return ConicalPatternStore.ImageSize[i];return e}static Get(e,i,n,o,l,d,u){const f=ConicalPatternStore.GenKey(e,i,n,o,l),g=ConicalPatternStore.cache[f];if(!g||g.length===0)return null;for(let _=0;_<g.length;_++)if(g[_].width>=d&&g[_].height>=u)return g[_].pattern;return null}static Set(e,i,n,o,l,d,u,f){const g=ConicalPatternStore.GenKey(e,i,n,o,l);ConicalPatternStore.cache[g]?ConicalPatternStore.cache[g].push({width:u,height:f,pattern:d}):ConicalPatternStore.cache[g]=[{width:u,height:f,pattern:d}]}static GenKey(e,i,n,o,l){return`${i},${n},${o},${l},${e.join()}`}}ConicalPatternStore.cache={},ConicalPatternStore.ImageSize=[20,40,80,160,320,640,1280,2560];function getConicGradientAt(r,e,i,n){const{stops:o,startAngle:l,endAngle:d}=n;for(;i<0;)i+=pi2;for(;i>pi2;)i-=pi2;if(i<l||i>d)return o[0].color;let u,f,g=(i-l)/(d-l);for(let _=0;_<o.length;_++)if(o[_].offset>=g){u=o[_-1],f=o[_];break}return g=(g-u.offset)/(f.offset-u.offset),interpolateColor(u.color,f.color,g,!1)}function createConicalGradient(r,e,i,n,o,l,d,u,f){const g=Math.floor(180*o/Math.PI),_=ConicalCanvas.GetCanvas(),y=ConicalCanvas.GetCtx();if(!y)return null;const b=ConicalPatternStore.GetSize(u),S=ConicalPatternStore.GetSize(f);let v=ConicalPatternStore.Get(e,i,n,l,d,b,S);if(v)return v;const A=Math.sqrt(Math.max(Math.max(Math.pow(i,2)+Math.pow(n,2),Math.pow(b-i,2)+Math.pow(n,2)),Math.max(Math.pow(b-i,2)+Math.pow(S-n,2),Math.pow(i,2)+Math.pow(S-n,2)))),x=g+1,T=o/Math.max(1,x-1),C=ColorInterpolate.getInstance().GetOrCreate(i,n,b,S,e,x),E=2*Math.PI*A/360;_.width=b,_.height=S,y.setTransform(1,0,0,1,0,0),y.clearRect(0,0,b,S),y.translate(i,n),y.rotate(l);for(let R=0,L=x-1;R<L&&!(l+R*T>d);R++){const w=C.getColor(R);y.beginPath(),y.rotate(T),y.moveTo(0,0),y.lineTo(A,-2*E),y.lineTo(A,0),y.fillStyle=w,y.closePath(),y.fill()}const P=y.getImageData(0,0,b,S);return _.width=P.width,_.height=P.height,y.putImageData(P,0,0),v=r.createPattern(_,"no-repeat"),v&&ConicalPatternStore.Set(e,i,n,l,d,v,b,S),v}const ArcRenderContribution=Symbol.for("ArcRenderContribution"),AreaRenderContribution=Symbol.for("AreaRenderContribution"),CircleRenderContribution=Symbol.for("CircleRenderContribution"),GroupRenderContribution=Symbol.for("GroupRenderContribution"),ImageRenderContribution=Symbol.for("ImageRenderContribution"),PathRenderContribution=Symbol.for("PathRenderContribution"),PolygonRenderContribution=Symbol.for("PolygonRenderContribution"),RectRenderContribution=Symbol.for("RectRenderContribution"),SymbolRenderContribution=Symbol.for("SymbolRenderContribution"),TextRenderContribution=Symbol.for("TextRenderContribution"),InteractiveSubRenderContribution=Symbol.for("InteractiveSubRenderContribution");function textDrawOffsetX(r,e){return r==="end"||r==="right"?-e:r==="center"?-e/2:0}function textLayoutOffsetY(r,e,i,n=0){return r==="middle"?-e/2:r==="top"?0:r==="bottom"?n-e:r&&r!=="alphabetic"?0:(i||(i=e),-(e-i)/2-.79*i)}function textAttributesToStyle(r){const e={},i=n=>/^\d+(\.\d+)?$/.test(`${n}`)?`${n}px`:`${n}`;return["textAlign","fontFamily","fontVariant","fontStyle","fontWeight"].forEach(n=>{r[n]&&(e[lowerCamelCaseToMiddle(n)]=r[n])}),["fontSize","lineHeight"].forEach(n=>{const o=lowerCamelCaseToMiddle(n);isNil(r[n])||(e[o]=i(r[n]))}),isValid(r.maxLineWidth)&&(e["max-width"]=i(r.maxLineWidth)),r.underline?e["text-decoration"]="underline":r.lineThrough&&(e["text-decoration"]="line-through"),r.fill&&isString(r.fill)&&(e.color=r.fill),e}function identityMat4(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function rotateX(r,e,i){const n=Math.sin(i),o=Math.cos(i),l=e[4],d=e[5],u=e[6],f=e[7],g=e[8],_=e[9],y=e[10],b=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=l*o+g*n,r[5]=d*o+_*n,r[6]=u*o+y*n,r[7]=f*o+b*n,r[8]=g*o-l*n,r[9]=_*o-d*n,r[10]=y*o-u*n,r[11]=b*o-f*n,r}function rotateY(r,e,i){const n=Math.sin(i),o=Math.cos(i),l=e[0],d=e[1],u=e[2],f=e[3],g=e[8],_=e[9],y=e[10],b=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=l*o-g*n,r[1]=d*o-_*n,r[2]=u*o-y*n,r[3]=f*o-b*n,r[8]=l*n+g*o,r[9]=d*n+_*o,r[10]=u*n+y*o,r[11]=f*n+b*o,r}function rotateZ(r,e,i){const n=Math.sin(i),o=Math.cos(i),l=e[0],d=e[1],u=e[2],f=e[3],g=e[4],_=e[5],y=e[6],b=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=l*o+g*n,r[1]=d*o+_*n,r[2]=u*o+y*n,r[3]=f*o+b*n,r[4]=g*o-l*n,r[5]=_*o-d*n,r[6]=y*o-u*n,r[7]=b*o-f*n,r}function translate(r,e,i){const n=i[0],o=i[1],l=i[2];let d,u,f,g,_,y,b,S,v,A,x,T;return e===r?(r[12]=e[0]*n+e[4]*o+e[8]*l+e[12],r[13]=e[1]*n+e[5]*o+e[9]*l+e[13],r[14]=e[2]*n+e[6]*o+e[10]*l+e[14],r[15]=e[3]*n+e[7]*o+e[11]*l+e[15]):(d=e[0],u=e[1],f=e[2],g=e[3],_=e[4],y=e[5],b=e[6],S=e[7],v=e[8],A=e[9],x=e[10],T=e[11],r[0]=d,r[1]=u,r[2]=f,r[3]=g,r[4]=_,r[5]=y,r[6]=b,r[7]=S,r[8]=v,r[9]=A,r[10]=x,r[11]=T,r[12]=d*n+_*o+v*l+e[12],r[13]=u*n+y*o+A*l+e[13],r[14]=f*n+b*o+x*l+e[14],r[15]=g*n+S*o+T*l+e[15]),r}function mat3Tomat4(r,e){r[0]=e.a,r[1]=e.b,r[2]=0,r[3]=0,r[4]=e.c,r[5]=e.d,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=e.e,r[13]=e.f,r[14]=0,r[15]=1}function scaleMat4(r,e,i){const n=i[0],o=i[1],l=i[2];return r[0]=e[0]*n,r[1]=e[1]*n,r[2]=e[2]*n,r[3]=e[3]*n,r[4]=e[4]*o,r[5]=e[5]*o,r[6]=e[6]*o,r[7]=e[7]*o,r[8]=e[8]*l,r[9]=e[9]*l,r[10]=e[10]*l,r[11]=e[11]*l,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function multiplyMat4Mat4(r,e,i){const n=e[0],o=e[1],l=e[2],d=e[3],u=e[4],f=e[5],g=e[6],_=e[7],y=e[8],b=e[9],S=e[10],v=e[11],A=e[12],x=e[13],T=e[14],C=e[15];let E=i[0],P=i[1],R=i[2],L=i[3];return r[0]=E*n+P*u+R*y+L*A,r[1]=E*o+P*f+R*b+L*x,r[2]=E*l+P*g+R*S+L*T,r[3]=E*d+P*_+R*v+L*C,E=i[4],P=i[5],R=i[6],L=i[7],r[4]=E*n+P*u+R*y+L*A,r[5]=E*o+P*f+R*b+L*x,r[6]=E*l+P*g+R*S+L*T,r[7]=E*d+P*_+R*v+L*C,E=i[8],P=i[9],R=i[10],L=i[11],r[8]=E*n+P*u+R*y+L*A,r[9]=E*o+P*f+R*b+L*x,r[10]=E*l+P*g+R*S+L*T,r[11]=E*d+P*_+R*v+L*C,E=i[12],P=i[13],R=i[14],L=i[15],r[12]=E*n+P*u+R*y+L*A,r[13]=E*o+P*f+R*b+L*x,r[14]=E*l+P*g+R*S+L*T,r[15]=E*d+P*_+R*v+L*C,r}function lookAt(r,e,i,n){let o,l,d,u,f,g,_,y,b,S;const v=e[0],A=e[1],x=e[2],T=n[0],C=n[1],E=n[2],P=i[0],R=i[1],L=i[2];return Math.abs(v-P)<epsilon$1&&Math.abs(A-R)<epsilon$1&&Math.abs(x-L)<epsilon$1?identityMat4(r):(_=v-P,y=A-R,b=x-L,S=1/Math.hypot(_,y,b),_*=S,y*=S,b*=S,o=C*b-E*y,l=E*_-T*b,d=T*y-C*_,S=Math.hypot(o,l,d),S?(S=1/S,o*=S,l*=S,d*=S):(o=0,l=0,d=0),u=y*d-b*l,f=b*o-_*d,g=_*l-y*o,S=Math.hypot(u,f,g),S?(S=1/S,u*=S,f*=S,g*=S):(u=0,f=0,g=0),r[0]=o,r[1]=u,r[2]=_,r[3]=0,r[4]=l,r[5]=f,r[6]=y,r[7]=0,r[8]=d,r[9]=g,r[10]=b,r[11]=0,r[12]=-(o*v+l*A+d*x),r[13]=-(u*v+f*A+g*x),r[14]=-(_*v+y*A+b*x),r[15]=1,r)}function ortho(r,e,i,n,o,l,d){const u=1/(e-i),f=1/(n-o),g=1/(l-d);return r[0]=-2*u,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*f,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*g,r[11]=0,r[12]=(e+i)*u,r[13]=(o+n)*f,r[14]=(d+l)*g,r[15]=1,r}function transformMat4(r,e,i){const n=e[0],o=e[1],l=e[2];let d=i[3]*n+i[7]*o+i[11]*l+i[15];return d=d||1,r[0]=(i[0]*n+i[4]*o+i[8]*l+i[12])/d,r[1]=(i[1]*n+i[5]*o+i[9]*l+i[13])/d,r[2]=(i[2]*n+i[6]*o+i[10]*l+i[14])/d,r}function createMat4(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}class DefaultMatrixAllocate{constructor(){this.pools=[]}allocate(e,i,n,o,l,d){if(!this.pools.length)return new Matrix(e,i,n,o,l,d);const u=this.pools.pop();return u.a=e,u.b=i,u.c=n,u.d=o,u.e=l,u.f=d,u}allocateByObj(e){if(!this.pools.length)return new Matrix(e.a,e.b,e.c,e.d,e.e,e.f);const i=this.pools.pop();return i.a=e.a,i.b=e.b,i.c=e.c,i.d=e.d,i.e=e.e,i.f=e.f,i}free(e){this.pools.push(e)}get length(){return this.pools.length}release(...e){this.pools=[]}}class DefaultMat4Allocate{constructor(){this.pools=[]}static identity(e){return identityMat4(e)}allocate(){if(!this.pools.length)return createMat4();const e=this.pools.pop();return DefaultMat4Allocate.identity(e),e}allocateByObj(e){let i;i=this.pools.length?this.pools.pop():createMat4();for(let n=0;n<i.length;n++)i[n]=e[n];return i}free(e){e&&this.pools.push(e)}get length(){return this.pools.length}release(...e){this.pools=[]}}const matrixAllocate=new DefaultMatrixAllocate,mat4Allocate=new DefaultMat4Allocate;var __decorate$15=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$P=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$F=function(r,e){return function(i,n){e(i,n,r)}};function getModelMatrix(r,e,i){var n;const{x:o=i.x,y:l=i.y,z:d=i.z,dx:u=i.dx,dy:f=i.dy,dz:g=i.dz,scaleX:_=i.scaleX,scaleY:y=i.scaleY,scaleZ:b=i.scaleZ,alpha:S=i.alpha,beta:v=i.beta,angle:A=i.angle,anchor3d:x=e.attribute.anchor,anchor:T}=e.attribute,C=[0,0,0];if(x){if(typeof x[0]=="string"){const E=parseFloat(x[0])/100,P=e.AABBBounds;C[0]=P.x1+(P.x2-P.x1)*E}else C[0]=x[0];if(typeof x[1]=="string"){const E=parseFloat(x[1])/100,P=e.AABBBounds;C[1]=P.x1+(P.x2-P.x1)*E}else C[1]=x[1];C[2]=(n=x[2])!==null&&n!==void 0?n:0}if(identityMat4(r),translate(r,r,[o+u,l+f,d+g]),translate(r,r,[C[0],C[1],C[2]]),rotateX(r,r,v),rotateY(r,r,S),translate(r,r,[-C[0],-C[1],C[2]]),scaleMat4(r,r,[_,y,b]),A){const E=mat4Allocate.allocate(),P=[0,0];if(T){if(typeof x[0]=="string"){const R=parseFloat(x[0])/100,L=e.AABBBounds;P[0]=L.x1+(L.x2-L.x1)*R}else P[0]=x[0];if(typeof x[1]=="string"){const R=parseFloat(x[1])/100,L=e.AABBBounds;P[1]=L.x1+(L.x2-L.x1)*R}else P[1]=x[1]}translate(E,E,[P[0],P[1],0]),rotateZ(E,E,A),translate(E,E,[-P[0],-P[1],0]),multiplyMat4Mat4(r,r,E)}}function shouldUseMat4(r){const{alpha:e,beta:i}=r.attribute;return e||i}let DefaultGraphicService=class{constructor(r){this.creator=r,this.hooks={onAttributeUpdate:new SyncHook(["graphic"]),onSetStage:new SyncHook(["graphic","stage"]),onRemove:new SyncHook(["graphic"]),onRelease:new SyncHook(["graphic"]),onAddIncremental:new SyncHook(["graphic","group","stage"]),onClearIncremental:new SyncHook(["graphic","group","stage"]),beforeUpdateAABBBounds:new SyncHook(["graphic","stage","willUpdate","aabbBounds"]),afterUpdateAABBBounds:new SyncHook(["graphic","stage","aabbBounds","globalAABBBounds","selfChange"]),clearAABBBounds:new SyncHook(["graphic","stage","aabbBounds"])},this.tempAABBBounds1=new AABBBounds,this.tempAABBBounds2=new AABBBounds}onAttributeUpdate(r){this.hooks.onAttributeUpdate.taps.length&&this.hooks.onAttributeUpdate.call(r)}onSetStage(r,e){this.hooks.onSetStage.taps.length&&this.hooks.onSetStage.call(r,e)}onRemove(r){this.hooks.onRemove.taps.length&&this.hooks.onRemove.call(r)}onRelease(r){this.hooks.onRelease.taps.length&&this.hooks.onRelease.call(r)}onAddIncremental(r,e,i){this.hooks.onAddIncremental.taps.length&&this.hooks.onAddIncremental.call(r,e,i)}onClearIncremental(r,e){this.hooks.onClearIncremental.taps.length&&this.hooks.onClearIncremental.call(r,e)}beforeUpdateAABBBounds(r,e,i,n){this.hooks.beforeUpdateAABBBounds.taps.length&&this.hooks.beforeUpdateAABBBounds.call(r,e,i,n)}afterUpdateAABBBounds(r,e,i,n,o){this.hooks.afterUpdateAABBBounds.taps.length&&this.hooks.afterUpdateAABBBounds.call(r,e,i,n,o)}clearAABBBounds(r,e,i){this.hooks.clearAABBBounds.taps.length&&this.hooks.clearAABBBounds.call(r,e,i)}updatePathProxyAABBBounds(r,e){const i=typeof e.pathProxy=="function"?e.pathProxy(e.attribute):e.pathProxy;if(!i)return!1;const n=new BoundsContext(r);return renderCommandList(i.commandList,n,0,0),!0}updateHTMLTextAABBBounds(r,e,i,n){const{textAlign:o,textBaseline:l}=r;if(r.forceBoundsHeight!=null){const d=isNumber(r.forceBoundsHeight)?r.forceBoundsHeight:r.forceBoundsHeight(),u=textLayoutOffsetY(l,d,d);i.set(i.x1,u,i.x2,u+d)}if(r.forceBoundsWidth!=null){const d=isNumber(r.forceBoundsWidth)?r.forceBoundsWidth:r.forceBoundsWidth(),u=textDrawOffsetX(o,d);i.set(u,i.y1,u+d,i.y2)}}combindShadowAABBBounds(r,e){if(e&&e.shadowRoot){const i=e.shadowRoot.AABBBounds;r.union(i)}}transformAABBBounds(r,e,i,n,o){if(!e.empty()){const{scaleX:u=i.scaleX,scaleY:f=i.scaleY,stroke:g=i.stroke,shadowBlur:_=i.shadowBlur,lineWidth:y=i.lineWidth,pickStrokeBuffer:b=i.pickStrokeBuffer,strokeBoundsBuffer:S=i.strokeBoundsBuffer}=r,v=this.tempAABBBounds1,A=this.tempAABBBounds2;if(g&&y){const x=(y+b)/Math.abs(u+f);boundStroke(v,x,n,S),e.union(v),v.setValue(A.x1,A.y1,A.x2,A.y2)}if(_){const{shadowOffsetX:x=i.shadowOffsetX,shadowOffsetY:T=i.shadowOffsetY}=r,C=_/Math.abs(u+f)*2;boundStroke(v,C,!1,S+1),v.translate(x,T),e.union(v)}}if(this.combindShadowAABBBounds(e,o),e.empty())return;let l=!0;const d=o.transMatrix;o&&o.isContainer&&(l=!(d.a===1&&d.b===0&&d.c===0&&d.d===1&&d.e===0&&d.f===0)),l&&transformBoundsWithMatrix(e,e,d)}validCheck(r,e,i,n){if(!n||r.forceBoundsHeight!=null||r.forceBoundsWidth!=null||n.shadowRoot||n.isContainer)return!0;const{visible:o=e.visible}=r;return!(!n.valid||!o)||(i.empty()||(n.parent&&i.transformWithMatrix(n.parent.globalTransMatrix),application.graphicService.clearAABBBounds(n,n.stage,i),i.clear()),!1)}updateTempAABBBounds(r){const e=this.tempAABBBounds1,i=this.tempAABBBounds2;return e.setValue(r.x1,r.y1,r.x2,r.y2),i.setValue(r.x1,r.y1,r.x2,r.y2),{tb1:e,tb2:i}}};DefaultGraphicService=__decorate$15([injectable(),__param$F(0,inject(GraphicCreator$1)),__metadata$P("design:paramtypes",[Object])],DefaultGraphicService);const result={x:0,y:0,z:0,lastModelMatrix:null};class BaseRender{init(e){e&&(this._renderContribitions=e.getContributions()),this._renderContribitions||(this._renderContribitions=[]),this.builtinContributions&&this.builtinContributions.forEach(i=>this._renderContribitions.push(i)),this._renderContribitions.length&&(this._renderContribitions.sort((i,n)=>n.order-i.order),this._beforeRenderContribitions=this._renderContribitions.filter(i=>i.time===BaseRenderContributionTime.beforeFillStroke),this._afterRenderContribitions=this._renderContribitions.filter(i=>i.time===BaseRenderContributionTime.afterFillStroke))}beforeRenderStep(e,i,n,o,l,d,u,f,g,_,y,b,S){this._beforeRenderContribitions&&this._beforeRenderContribitions.forEach(v=>{v.supportedAppName&&e.stage&&e.stage.params&&e.stage.params.context&&e.stage.params.context.appName&&!(Array.isArray(v.supportedAppName)?v.supportedAppName:[v.supportedAppName]).includes(e.stage.params.context.appName)||v.drawShape(e,i,n,o,l,d,u,f,g,_,y,b,S)})}afterRenderStep(e,i,n,o,l,d,u,f,g,_,y,b,S){this._afterRenderContribitions&&this._afterRenderContribitions.forEach(v=>{v.supportedAppName&&e.stage&&e.stage.params&&e.stage.params.context&&e.stage.params.context.appName&&!(Array.isArray(v.supportedAppName)?v.supportedAppName:[v.supportedAppName]).includes(e.stage.params.context.appName)||v.drawShape(e,i,n,o,l,d,u,f,g,_,y,b,S)})}valid(e,i,n,o){const{fill:l=i.fill,background:d,stroke:u=i.stroke,opacity:f=i.opacity,fillOpacity:g=i.fillOpacity,lineWidth:_=i.lineWidth,strokeOpacity:y=i.strokeOpacity,visible:b=i.visible}=e.attribute,S=fillVisible(f,g,l),v=strokeVisible(f,y),A=runFill(l,d),x=runStroke(u,_);return!(!e.valid||!b)&&!(!A&&!x)&&!!(S||v||n||o||d)&&{fVisible:S,sVisible:v,doFill:A,doStroke:x}}transform(e,i,n,o=!1){const{x:l=i.x,y:d=i.y,z:u=i.z,scaleX:f=i.scaleX,scaleY:g=i.scaleY,angle:_=i.angle,postMatrix:y}=e.attribute,b=n.modelMatrix,S=n.camera;result.x=l,result.y=d,result.z=u,result.lastModelMatrix=b;const v=S&&(o||shouldUseMat4(e)),A=v?e.transMatrix.onlyTranslate()&&!y:f===1&&g===1&&_===0&&!y;if(v){const x=mat4Allocate.allocate(),T=mat4Allocate.allocate();getModelMatrix(T,e,i),multiplyMat4Mat4(x,b||x,T),result.x=0,result.y=0,result.z=0,n.modelMatrix=x,n.setTransform(1,0,0,1,0,0,!0),mat4Allocate.free(T)}if(A&&!b){const x=e.getOffsetXY(i);result.x+=x.x,result.y+=x.y,result.z=u,n.setTransformForCurrent()}else if(v)result.x=0,result.y=0,result.z=0,n.setTransform(1,0,0,1,0,0,!0);else if(S&&n.project){const x=e.getOffsetXY(i);result.x+=x.x,result.y+=x.y,this.transformWithoutTranslate(n,result.x,result.y,result.z,f,g,_)}else n.transformFromMatrix(e.transMatrix,!0),result.x=0,result.y=0,result.z=0;return result}transformUseContext2d(e,i,n,o){const l=o.camera;if(this.camera=l,l){const d=e.AABBBounds,u=d.x2-d.x1,f=d.y2-d.y1,g=o.project(0,0,n),_=o.project(u,0,n),y=o.project(u,f,n),b={x:0,y:0},S={x:u,y:0},v={x:u,y:f};o.camera=null;const A=1/(b.x*(v.y-S.y)-S.x*v.y+v.x*S.y+(S.x-v.x)*b.y),x=-(b.y*(y.x-_.x)-S.y*y.x+v.y*_.x+(S.y-v.y)*g.x)*A,T=(S.y*y.y+b.y*(_.y-y.y)-v.y*_.y+(v.y-S.y)*g.y)*A,C=(b.x*(y.x-_.x)-S.x*y.x+v.x*_.x+(S.x-v.x)*g.x)*A,E=-(S.x*y.y+b.x*(_.y-y.y)-v.x*_.y+(v.x-S.x)*g.y)*A,P=(b.x*(v.y*_.x-S.y*y.x)+b.y*(S.x*y.x-v.x*_.x)+(v.x*S.y-S.x*v.y)*g.x)*A,R=(b.x*(v.y*_.y-S.y*y.y)+b.y*(S.x*y.y-v.x*_.y)+(v.x*S.y-S.x*v.y)*g.y)*A;o.setTransform(x,T,C,E,P,R,!0)}}restoreTransformUseContext2d(e,i,n,o){this.camera&&(o.camera=this.camera)}transformWithoutTranslate(e,i,n,o,l,d,u){const f=e.project(i,n,o);e.translate(f.x,f.y,!1),e.scale(l,d,!1),e.rotate(u,!1),e.translate(-f.x,-f.y,!1),e.setTransformForCurrent()}_draw(e,i,n,o,l){const{context:d}=o;if(!d)return;const{renderable:u}=e.attribute;if(u===!1)return;d.highPerformanceSave();const f=this.transform(e,i,d,n),{x:g,y:_,z:y,lastModelMatrix:b}=f;this.z=y,drawPathProxy(e,d,g,_,o,l)||(this.drawShape(e,d,g,_,o,l),this.z=0,d.modelMatrix!==b&&mat4Allocate.free(d.modelMatrix),d.modelMatrix=b),d.highPerformanceRestore()}}var __decorate$14=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$O=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$E=function(r,e){return function(i,n){e(i,n,r)}};class DefaultBaseBackgroundRenderContribution{constructor(){this.time=BaseRenderContributionTime.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(e,i,n,o,l,d,u,f,g,_,y,b,S){var v;const{background:A,backgroundOpacity:x=(v=e.attribute.fillOpacity)!==null&&v!==void 0?v:g.backgroundOpacity,opacity:T=g.opacity,backgroundMode:C=g.backgroundMode,backgroundFit:E=g.backgroundFit}=e.attribute;if(A)if(e.backgroundImg&&e.resources){const P=e.resources.get(A);if(P.state!=="success"||!P.data)return;if(i.save(),e.parent&&!e.transMatrix.onlyTranslate()){const L=getTheme$1(e.parent).group,{scrollX:w=L.scrollX,scrollY:B=L.scrollY}=e.parent.attribute;i.setTransformFromMatrix(e.parent.globalTransMatrix,!0),i.translate(w,B)}i.clip();const R=e.AABBBounds;i.setCommonStyle(e,e.attribute,n,o,g),i.globalAlpha=x*T,this.doDrawImage(i,P.data,R,C,E),i.restore(),e.transMatrix.onlyTranslate()||i.setTransformForCurrent()}else i.highPerformanceSave(),i.setCommonStyle(e,e.attribute,n,o,g),i.globalAlpha=x*T,i.fillStyle=A,i.fill(),i.highPerformanceRestore()}doDrawImage(e,i,n,o,l){if(o==="no-repeat")e.drawImage(i,n.x1,n.y1,n.width(),n.height());else{const d=n.width(),u=n.height();let f=d,g=u;if(l&&o!=="repeat"&&(i.width||i.height)){const b=i.width,S=i.height;o==="repeat-x"?(f=b*(u/S),g=u):o==="repeat-y"&&(g=S*(d/b),f=d);const v=e.dpr,A=canvasAllocate.allocate({width:f,height:g,dpr:v}),x=A.getContext("2d");x&&(x.inuse=!0,x.clearMatrix(),x.setTransformForCurrent(!0),x.clearRect(0,0,f,g),x.drawImage(i,0,0,f,g),i=A.nativeCanvas),canvasAllocate.free(A)}const _=e.dpr,y=e.createPattern(i,o);y.setTransform&&y.setTransform(new DOMMatrix([1/_,0,0,1/_,0,0])),e.fillStyle=y,e.translate(n.x1,n.y1),e.fillRect(0,0,d,u),e.translate(-n.x1,-n.y1)}}}const defaultBaseBackgroundRenderContribution=new DefaultBaseBackgroundRenderContribution;let DefaultBaseInteractiveRenderContribution=class{constructor(r){this.subRenderContribitions=r,this.time=BaseRenderContributionTime.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(r,e,i,n,o,l,d,u,f,g,_,y,b){this._subRenderContribitions||(this._subRenderContribitions=this.subRenderContribitions.getContributions()),this._subRenderContribitions.forEach(S=>{S.render(r,e,i,n,o,l,d,u,f,g,_,y,b)})}};DefaultBaseInteractiveRenderContribution=__decorate$14([injectable(),__param$E(0,inject(ContributionProvider)),__param$E(0,named(InteractiveSubRenderContribution)),__metadata$O("design:paramtypes",[Object])],DefaultBaseInteractiveRenderContribution);class DefaultBaseTextureRenderContribution{constructor(){this.time=BaseRenderContributionTime.afterFillStroke,this.useStyle=!0,this.order=10}createCommonPattern(e,i,n,o,l){const d=(e-2*i)/2,u=o.dpr,f=canvasAllocate.allocate({width:e,height:e,dpr:u}),g=f.getContext("2d");if(!g)return null;g.inuse=!0,g.clearMatrix(),g.setTransformForCurrent(!0),g.clearRect(0,0,e,e),l(d,g);const _=o.createPattern(f.nativeCanvas,"repeat");return _.setTransform&&_.setTransform(new DOMMatrix([1/u,0,0,1/u,0,0])),canvasAllocate.free(f),_}createCirclePattern(e,i,n,o){return this.createCommonPattern(e,i,n,o,(l,d)=>{d.fillStyle=n,d.arc(l,l,l,0,pi2),d.fill()})}createDiamondPattern(e,i,n,o){return this.createCommonPattern(e,i,n,o,(l,d)=>{const u=e/2,f=u;d.fillStyle=n,d.moveTo(u,f-l),d.lineTo(l+u,f),d.lineTo(u,f+l),d.lineTo(u-l,f),d.closePath(),d.fill()})}createRectPattern(e,i,n,o){return this.createCommonPattern(e,i,n,o,(l,d)=>{const u=i,f=u;d.fillStyle=n,d.fillRect(u,f,2*l,2*l)})}createVerticalLinePattern(e,i,n,o){return this.createCommonPattern(e,i,n,o,(l,d)=>{const u=i;d.fillStyle=n,d.fillRect(u,0,2*l,e)})}createHorizontalLinePattern(e,i,n,o){return this.createCommonPattern(e,i,n,o,(l,d)=>{const u=i;d.fillStyle=n,d.fillRect(0,u,e,2*l)})}createBiasLRLinePattern(e,i,n,o){return this.createCommonPattern(e,i,n,o,(l,d)=>{d.strokeStyle=n,d.lineWidth=l,d.moveTo(0,0),d.lineTo(e,e);const u=e/2,f=-u;d.moveTo(u,f),d.lineTo(u+e,f+e),d.moveTo(-u,-f),d.lineTo(-u+e,-f+e),d.stroke()})}createBiasRLLinePattern(e,i,n,o){return this.createCommonPattern(e,i,n,o,(l,d)=>{d.strokeStyle=n,d.lineWidth=l,d.moveTo(e,0),d.lineTo(0,e);const u=e/2,f=u;d.moveTo(e+u,f),d.lineTo(u,f+e),d.moveTo(e-u,-f),d.lineTo(-u,-f+e),d.stroke()})}createGridPattern(e,i,n,o){return this.createCommonPattern(e,i,n,o,(l,d)=>{const u=i,f=u;d.fillStyle=n,d.fillRect(u,f,l,l),d.fillRect(u+l,f+l,l,l)})}initTextureMap(e,i){this.textureMap=new Map}drawShape(e,i,n,o,l,d,u,f,g,_,y,b,S){this.textureMap||this.initTextureMap(i,e.stage);const{texture:v=g.texture,textureColor:A=g.textureColor,textureSize:x=g.textureSize,texturePadding:T=g.texturePadding}=e.attribute;v&&this.drawTexture(v,e,i,n,o,g,A,x,T)}drawTexture(e,i,n,o,l,d,u,f,g){let _=this.textureMap.get(e);if(!_)switch(e){case"circle":_=this.createCirclePattern(f,g,u,n);break;case"diamond":_=this.createDiamondPattern(f,g,u,n);break;case"rect":_=this.createRectPattern(f,g,u,n);break;case"vertical-line":_=this.createVerticalLinePattern(f,g,u,n);break;case"horizontal-line":_=this.createHorizontalLinePattern(f,g,u,n);break;case"bias-lr":_=this.createBiasLRLinePattern(f,g,u,n);break;case"bias-rl":_=this.createBiasRLLinePattern(f,g,u,n);break;case"grid":_=this.createGridPattern(f,g,u,n)}_&&(n.highPerformanceSave(),n.setCommonStyle(i,i.attribute,o,l,d),n.fillStyle=_,n.fill(),n.highPerformanceRestore())}}const defaultBaseTextureRenderContribution=new DefaultBaseTextureRenderContribution;class DefaultArcRenderContribution{constructor(){this.time=BaseRenderContributionTime.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(e,i,n,o,l,d,u,f,g,_,y,b){const{outerBorder:S,innerBorder:v}=e.attribute,A=S&&S.visible!==!1,x=v&&v.visible!==!1;if(!A&&!x)return;const{innerPadding:T=g.innerPadding,outerPadding:C=g.outerPadding,startAngle:E=g.startAngle,endAngle:P=g.endAngle,opacity:R=g.opacity,x:L=g.x,y:w=g.y,scaleX:B=g.scaleX,scaleY:I=g.scaleY,keepStrokeScale:D=g.keepStrokeScale}=e.attribute;let{innerRadius:O=g.innerRadius,outerRadius:N=g.outerRadius}=e.attribute;N+=C,O-=T;const V=(H,F)=>{const $=!(!H||!H.stroke),{distance:G=g[F].distance}=H,Y=D?G:getScaledStroke(i,G,i.dpr),Q=G/N,q=F==="outerBorder"?1:-1;if(e.setAttributes({outerRadius:N+q*Y,innerRadius:O-q*Y,startAngle:E-q*Q,endAngle:P+q*Q}),i.beginPath(),drawArcPath$1(e,i,n,o,N+q*Y,O-q*Y),i.setShadowBlendStyle&&i.setShadowBlendStyle(e,e.attribute,g),b)b(i,H,g[F]);else if($){const te=g[F].opacity;g[F].opacity=R,i.setStrokeStyle(e,H,(L-n)/B,(w-o)/I,g[F]),g[F].opacity=te,i.stroke()}};A&&V(S,"outerBorder"),x&&V(v,"innerBorder"),e.setAttributes({outerRadius:N,innerRadius:O,startAngle:E,endAngle:P})}}const defaultArcRenderContribution=new DefaultArcRenderContribution,defaultArcTextureRenderContribution=defaultBaseTextureRenderContribution,defaultArcBackgroundRenderContribution=defaultBaseBackgroundRenderContribution;class DefaultCircleRenderContribution{constructor(){this.time=BaseRenderContributionTime.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(e,i,n,o,l,d,u,f,g,_,y,b){const{outerBorder:S,innerBorder:v}=e.attribute,A=S&&S.visible!==!1,x=v&&v.visible!==!1;if(!A&&!x)return;const{radius:T=g.radius,startAngle:C=g.startAngle,endAngle:E=g.endAngle,opacity:P=g.opacity,x:R=g.x,y:L=g.y,scaleX:w=g.scaleX,scaleY:B=g.scaleY,keepStrokeScale:I=g.keepStrokeScale}=e.attribute,D=(O,N)=>{const V=!(!O||!O.stroke),{distance:H=g[N].distance}=O,F=I?H:getScaledStroke(i,H,i.dpr),$=N==="outerBorder"?1:-1;if(i.beginPath(),i.arc(n,o,T+$*F,C,E),i.closePath(),i.setShadowBlendStyle&&i.setShadowBlendStyle(e,e.attribute,g),b)b(i,O,g[N]);else if(V){const G=g[N].opacity;g[N].opacity=P,i.setStrokeStyle(e,O,(R-n)/w,(L-o)/B,g[N]),g[N].opacity=G,i.stroke()}};A&&D(S,"outerBorder"),x&&D(v,"innerBorder")}}const defaultCircleRenderContribution=new DefaultCircleRenderContribution,defaultCircleTextureRenderContribution=defaultBaseTextureRenderContribution,defaultCircleBackgroundRenderContribution=defaultBaseBackgroundRenderContribution;class DefaultGroupBackgroundRenderContribution extends DefaultBaseBackgroundRenderContribution{constructor(){super(...arguments),this.time=BaseRenderContributionTime.beforeFillStroke}drawShape(e,i,n,o,l,d,u,f,g,_,y,b){const{background:S,backgroundMode:v=g.backgroundMode,backgroundFit:A=g.backgroundFit}=e.attribute;if(S)if(e.backgroundImg&&e.resources){const x=e.resources.get(S);if(x.state!=="success"||!x.data)return;i.highPerformanceSave(),i.setTransformFromMatrix(e.parent.globalTransMatrix,!0);const T=e.AABBBounds;this.doDrawImage(i,x.data,T,v,A),i.highPerformanceRestore(),i.setTransformForCurrent()}else i.highPerformanceSave(),i.fillStyle=S,i.fill(),i.highPerformanceRestore()}}const defaultGroupBackgroundRenderContribution=new DefaultGroupBackgroundRenderContribution,halfPi=pi$1/2;function createRectPath(r,e,i,n,o,l,d){let u;if(n<0&&(e+=n,n=-n),o<0&&(i+=o,o=-o),isNumber(l,!0))u=[l=abs$1(l),l,l,l];else if(Array.isArray(l)){const L=l;let w,B;switch(L.length){case 0:u=[0,0,0,0];break;case 1:w=abs$1(L[0]),u=[w,w,w,w];break;case 2:case 3:w=abs$1(L[0]),B=abs$1(L[1]),u=[w,B,w,B];break;default:u=L,u[0]=abs$1(u[0]),u[1]=abs$1(u[1]),u[2]=abs$1(u[2]),u[3]=abs$1(u[3])}}else u=[0,0,0,0];if(n<0||u[0]+u[1]+u[2]+u[3]<1e-12)return r.rect(e,i,n,o);const[f,g,_,y]=[[e,i],[e+n,i],[e+n,i+o],[e,i+o]],b=Math.min(n/2,o/2),S=[Math.min(b,u[0]),Math.min(b,u[1]),Math.min(b,u[2]),Math.min(b,u[3])],v=[f[0]+S[0],f[1]],A=[f[0],f[1]+S[0]],x=[g[0]-S[1],g[1]],T=[g[0],g[1]+S[1]],C=[_[0]-S[2],_[1]],E=[_[0],_[1]-S[2]],P=[y[0]+S[3],y[1]],R=[y[0],y[1]-S[3]];if(r.moveTo(v[0],v[1]),d&&d[0]?d[0](v[0],v[1],x[0],x[1]):r.lineTo(x[0],x[1]),!arrayEqual(x,T)){d&&d[0]&&r.moveTo(x[0],x[1]);const L=x[0],w=x[1]+S[1];r.arc(L,w,S[1],-halfPi,0,!1)}if(d&&d[1]?d[1](T[0],T[1],E[0],E[1]):r.lineTo(E[0],E[1]),!arrayEqual(C,E)){const L=E[0]-S[2],w=E[1];d&&d[1]&&r.moveTo(E[0],E[1]),r.arc(L,w,S[2],0,halfPi,!1)}if(d&&d[2]?d[2](C[0],C[1],P[0],P[1]):r.lineTo(P[0],P[1]),!arrayEqual(P,R)){const L=P[0],w=P[1]-S[3];d&&d[2]&&r.moveTo(P[0],P[1]),r.arc(L,w,S[3],halfPi,pi$1,!1)}if(d&&d[3]?d[3](R[0],R[1],A[0],A[1]):r.lineTo(A[0],A[1]),!arrayEqual(v,A)){const L=v[0],w=v[1]+S[0];d&&d[3]&&r.moveTo(A[0],A[1]),r.arc(L,w,S[0],pi$1,pi$1+halfPi,!1)}return!d&&r.closePath(),r}var __decorate$13=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d};class DefaultRectRenderContribution{constructor(){this.time=BaseRenderContributionTime.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(e,i,n,o,l,d,u,f,g,_,y,b){const{outerBorder:S,innerBorder:v}=e.attribute,A=S&&S.visible!==!1,x=v&&v.visible!==!1;if(!A&&!x)return;const{cornerRadius:T=g.cornerRadius,opacity:C=g.opacity,x:E=g.x,y:P=g.y,scaleX:R=g.scaleX,scaleY:L=g.scaleY,x1:w,y1:B,keepStrokeScale:I=g.keepStrokeScale}=e.attribute;let{width:D,height:O}=e.attribute;D=(D??w-n)||0,O=(O??B-o)||0;const N=(V,H)=>{const F=!(!V||!V.stroke),$=H==="outerBorder"?-1:1,{distance:G=g[H].distance}=V,Y=I?G:getScaledStroke(i,G,i.dpr),Q=n+$*Y,q=o+$*Y,te=2*Y;if(T===0||isArray(T)&&T.every(ue=>ue===0)?(i.beginPath(),i.rect(Q,q,D-$*te,O-$*te)):(i.beginPath(),createRectPath(i,Q,q,D-$*te,O-$*te,T)),i.setShadowBlendStyle&&i.setShadowBlendStyle(e,e.attribute,g),b)b(i,V,g[H]);else if(F){const ue=g[H].opacity;g[H].opacity=C,i.setStrokeStyle(e,V,(E-n)/R,(P-o)/L,g[H]),g[H].opacity=ue,i.stroke()}};A&&N(S,"outerBorder"),x&&N(v,"innerBorder")}}let SplitRectBeforeRenderContribution=class{constructor(){this.time=BaseRenderContributionTime.beforeFillStroke,this.useStyle=!0,this.order=0}drawShape(r,e,i,n,o,l,d,u,f,g,_,y,b){const{stroke:S=f.stroke}=r.attribute;Array.isArray(S)&&S.some(v=>v===!1)&&(b.doStroke=!1)}};SplitRectBeforeRenderContribution=__decorate$13([injectable()],SplitRectBeforeRenderContribution);let SplitRectAfterRenderContribution=class{constructor(){this.time=BaseRenderContributionTime.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(r,e,i,n,o,l,d,u,f,g,_,y){const{x1:b,y1:S,x:v=f.x,y:A=f.y,stroke:x=f.stroke,cornerRadius:T=f.cornerRadius}=r.attribute;let{width:C,height:E}=r.attribute;if(C=(C??b-v)||0,E=(E??S-A)||0,Array.isArray(x)&&x.some(P=>P===!1)){if(e.setStrokeStyle(r,r.attribute,i,n,f),!(T===0||isArray(T)&&T.every(P=>P===0))){let P,R=0;return createRectPath(e,i,n,C,E,T,new Array(4).fill(0).map((L,w)=>(B,I,D,O)=>{x[w]&&(R===w-1&&x[w]===P||(e.setStrokeStyle(r,Object.assign(Object.assign({},r.attribute),{stroke:x[w]}),i,n,f),e.beginPath(),e.moveTo(B,I),P=x[w]),R=w,e.lineTo(D,O),e.stroke(),w===3&&e.beginPath())})),void e.stroke()}if(e.beginPath(),e.moveTo(i,n),x[0]?e.lineTo(i+C,n):e.moveTo(i+C,n),x[1]?e.lineTo(i+C,n+E):e.moveTo(i+C,n+E),x[2]?e.lineTo(i,n+E):e.moveTo(i,n+E),x[3]){const P=x[0]?n-e.lineWidth/2:n;e.lineTo(i,P)}else e.moveTo(i,n);e.stroke()}}};SplitRectAfterRenderContribution=__decorate$13([injectable()],SplitRectAfterRenderContribution);const defaultRectRenderContribution=new DefaultRectRenderContribution,defaultRectTextureRenderContribution=defaultBaseTextureRenderContribution,defaultRectBackgroundRenderContribution=defaultBaseBackgroundRenderContribution;class DefaultImageRenderContribution extends DefaultRectRenderContribution{constructor(){super(...arguments),this.time=BaseRenderContributionTime.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(e,i,n,o,l,d,u,f,g,_,y,b){return super.drawShape(e,i,n,o,l,d,u,f,g,_,y,b)}}const defaultImageRenderContribution=new DefaultImageRenderContribution,defaultImageBackgroundRenderContribution=defaultBaseBackgroundRenderContribution;class DefaultSymbolRenderContribution{constructor(){this.time=BaseRenderContributionTime.afterFillStroke,this.useStyle=!0,this.order=0}drawShape(e,i,n,o,l,d,u,f,g,_,y,b){const S=e.getParsedPath();if(!S)return;const{outerBorder:v,innerBorder:A}=e.attribute,x=v&&v.visible!==!1,T=A&&A.visible!==!1;if(!x&&!T)return;const{size:C=g.size,opacity:E=g.opacity,x:P=g.x,y:R=g.y,scaleX:L=g.scaleX,scaleY:w=g.scaleY,keepStrokeScale:B=g.keepStrokeScale}=e.attribute,I=(D,O)=>{const N=!(!D||!D.stroke),{distance:V=g[O].distance}=D,H=B?V:getScaledStroke(i,V,i.dpr),F=O==="outerBorder"?1:-1;if(i.beginPath(),S.drawOffset(i,C,n,o,F*H)===!1&&i.closePath(),i.setShadowBlendStyle&&i.setShadowBlendStyle(e,e.attribute,g),b)b(i,D,g[O]);else if(N){const $=g[O].opacity;g[O].opacity=E,i.setStrokeStyle(e,D,(P-n)/L,(R-o)/w,g[O]),g[O].opacity=$,i.stroke()}};x&&I(v,"outerBorder"),T&&I(A,"innerBorder")}}const defaultSymbolRenderContribution=new DefaultSymbolRenderContribution,defaultSymbolTextureRenderContribution=defaultBaseTextureRenderContribution,defaultSymbolBackgroundRenderContribution=defaultBaseBackgroundRenderContribution;class DefaultAreaTextureRenderContribution extends DefaultBaseTextureRenderContribution{constructor(){super(...arguments),this.time=BaseRenderContributionTime.afterFillStroke}drawShape(e,i,n,o,l,d,u,f,g,_,y,b,S){var v,A,x,T;this.textureMap||this.initTextureMap(i,e.stage);const{attribute:C=e.attribute}=S||{},{texture:E=(v=e.attribute.texture)!==null&&v!==void 0?v:getAttributeFromDefaultAttrList(g,"texture"),textureColor:P=(A=e.attribute.textureColor)!==null&&A!==void 0?A:getAttributeFromDefaultAttrList(g,"textureColor"),textureSize:R=(x=e.attribute.textureSize)!==null&&x!==void 0?x:getAttributeFromDefaultAttrList(g,"textureSize"),texturePadding:L=(T=e.attribute.texturePadding)!==null&&T!==void 0?T:getAttributeFromDefaultAttrList(g,"texturePadding")}=C;E&&this.drawTexture(E,e,i,n,o,g,P,R,L)}}var __decorate$12=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$N=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$D=function(r,e){return function(i,n){e(i,n,r)}};let DefaultCanvasArcRender=class extends BaseRender{constructor(r){super(),this.arcRenderContribitions=r,this.numberType=ARC_NUMBER_TYPE,this.builtinContributions=[defaultArcRenderContribution,defaultArcBackgroundRenderContribution,defaultArcTextureRenderContribution],this.init(r)}drawArcTailCapPath(r,e,i,n,o,l,d,u){const f=u-d,g=r.getParsedAngle(),_=g.startAngle;let y=g.endAngle;y=u;const b=y>_;let S=!1;if(o<l){const $=o;o=l,l=$}const{xors:v,yors:A,xirs:x,yirs:T,limitedOcr:C,outerCornerRadiusStart:E,outerCornerRadiusEnd:P,maxOuterCornerRadius:R,xore:L,yore:w,xire:B,yire:I,limitedIcr:D,innerDeltaAngle:O,innerStartAngle:N,innerCornerRadiusStart:V,innerCornerRadiusEnd:H,maxInnerCornerRadius:F}=calculateArcCornerRadius(r,_,y,l,o);if(C>epsilon$1){const $=min$1(E,C),G=min$1(P,C),Y=cornerTangents(x,T,v,A,o,$,Number(b)),Q=cornerTangents(L,w,B,I,o,G,Number(b));if(C<R&&$===G)e.moveTo(i+Y.cx+Y.x01,n+Y.cy+Y.y01),e.arc(i+Y.cx,n+Y.cy,C,atan2$1(Y.y01,Y.x01),atan2$1(Q.y01,Q.x01),!b);else{const q=y-f-.03,te=atan2$1(Q.y11,Q.x11);e.arc(i,n,o,q,te,!b),G>0&&e.arc(i+Q.cx,n+Q.cy,G,atan2$1(Q.y11,Q.x11),atan2$1(Q.y01,Q.x01),!b)}}else e.moveTo(i+v,n+A);if(!(l>epsilon$1)||O<.001)e.lineTo(i+B,n+I),S=!0;else if(D>epsilon$1){const $=min$1(V,D),G=min$1(H,D),Y=cornerTangents(B,I,L,w,l,-G,Number(b)),Q=cornerTangents(v,A,x,T,l,-$,Number(b));if(e.lineTo(i+Y.cx+Y.x01,n+Y.cy+Y.y01),D<F&&$===G){const q=atan2$1(Q.y01,Q.x01);e.arc(i+Y.cx,n+Y.cy,D,atan2$1(Y.y01,Y.x01),q,!b)}else{G>0&&e.arc(i+Y.cx,n+Y.cy,G,atan2$1(Y.y01,Y.x01),atan2$1(Y.y11,Y.x11),!b);const q=atan2$1(Y.cy+Y.y11,Y.cx+Y.x11),te=y-f-.03;e.arc(i,n,l,q,te,b)}}else e.lineTo(i+l*cos$1(N),n+l*sin$1(N));return S}drawShape(r,e,i,n,o,l,d,u){const f=getTheme$1(r,l==null?void 0:l.theme).arc,{fill:g=f.fill,stroke:_=f.stroke,x:y=f.x,y:b=f.y,fillStrokeOrder:S=f.fillStrokeOrder}=r.attribute,v=this.valid(r,f,d,u);if(!v)return;const{fVisible:A,sVisible:x,doFill:T,doStroke:C}=v,{outerPadding:E=f.outerPadding,innerPadding:P=f.innerPadding,cap:R=f.cap,forceShowCap:L=f.forceShowCap}=r.attribute;let{outerRadius:w=f.outerRadius,innerRadius:B=f.innerRadius}=r.attribute;w+=E,B-=P;let I=0;const D=(isBoolean(R)&&R||R[0])&&g.gradient==="conical";if(D){const{sc:H,startAngle:F,endAngle:$}=r.getParsedAngle();abs$1($-F)<pi2-epsilon$1&&(I=H||0,g.startAngle-=I,g.endAngle-=I)}let O=!1;const{isFullStroke:N,stroke:V}=parseStroke(_);if(T||N){e.beginPath(),drawArcPath$1(r,e,i,n,w,B),O=!0,e.setShadowBlendStyle&&e.setShadowBlendStyle(r,r.attribute,f),this.beforeRenderStep(r,e,i,n,T,C,A,x,f,o,d,u);const H=()=>{T&&(d?d(e,r.attribute,f):A&&(e.setCommonStyle(r,r.attribute,y-i,b-n,f),e.fill()))},F=()=>{C&&N&&(u?u(e,r.attribute,f):x&&(e.setStrokeStyle(r,r.attribute,y-i,b-n,f),e.stroke()))};S?(F(),H()):(H(),F())}if(!N&&C&&(e.beginPath(),drawArcPath$1(r,e,i,n,w,B,V),O||this.beforeRenderStep(r,e,i,n,T,C,A,x,f,o,d,u),u?u(e,r.attribute,f):x&&(e.setStrokeStyle(r,r.attribute,i,n,f),e.stroke())),(isBoolean(R)&&R||R[1])&&L){const{startAngle:H,endAngle:F}=r.getParsedAngle();if(abs$1(F-H)>=pi2-epsilon$1){e.beginPath();const $=Math.abs(w-B)/2/w,{endAngle:G=f.endAngle,fill:Y=f.fill}=r.attribute,Q=G;this.drawArcTailCapPath(r,e,i,n,w,B,Q,Q+$),O||this.beforeRenderStep(r,e,i,n,T,C,A,x,f,o,d,u);const q=()=>{if(T){const ue=Y;if(ue.gradient==="conical"){const he=getConicGradientAt(0,0,G,ue);d||fillVisible&&(e.setCommonStyle(r,r.attribute,i,n,f),e.fillStyle=he,e.fill())}}},te=()=>{C&&(u||x&&(e.setStrokeStyle(r,r.attribute,i,n,f),e.stroke()))};q(),te()}}this.afterRenderStep(r,e,i,n,T,C,A,x,f,o,d,u),D&&(g.startAngle+=I,g.endAngle+=I)}draw(r,e,i,n){const o=getTheme$1(r,n==null?void 0:n.theme).arc;this._draw(r,o,!1,i,n)}};DefaultCanvasArcRender=__decorate$12([injectable(),__param$D(0,inject(ContributionProvider)),__param$D(0,named(ArcRenderContribution)),__metadata$N("design:paramtypes",[Object])],DefaultCanvasArcRender);var __decorate$11=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$M=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$C=function(r,e){return function(i,n){e(i,n,r)}};let DefaultCanvasCircleRender=class extends BaseRender{constructor(r){super(),this.circleRenderContribitions=r,this.numberType=CIRCLE_NUMBER_TYPE,this.builtinContributions=[defaultCircleRenderContribution,defaultCircleBackgroundRenderContribution,defaultCircleTextureRenderContribution],this.init(r)}drawShape(r,e,i,n,o,l,d,u){const f=getTheme$1(r,l==null?void 0:l.theme).circle,{radius:g=f.radius,startAngle:_=f.startAngle,endAngle:y=f.endAngle,x:b=f.x,y:S=f.y,fillStrokeOrder:v=f.fillStrokeOrder}=r.attribute,A=this.valid(r,f,d,u);if(!A)return;const{fVisible:x,sVisible:T,doFill:C,doStroke:E}=A;e.beginPath(),e.arc(i,n,g,_,y),e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(r,r.attribute,f),this.beforeRenderStep(r,e,i,n,C,E,x,T,f,o,d,u);const P=()=>{C&&(d?d(e,r.attribute,f):x&&(e.setCommonStyle(r,r.attribute,b-i,S-n,f),e.fill()))},R=()=>{E&&(u?u(e,r.attribute,f):T&&(e.setStrokeStyle(r,r.attribute,b-i,S-n,f),e.stroke()))};v?(R(),P()):(P(),R()),this.afterRenderStep(r,e,i,n,C,E,x,T,f,o,d,u)}draw(r,e,i,n){const o=getTheme$1(r,n==null?void 0:n.theme).circle;this._draw(r,o,!1,i,n)}};DefaultCanvasCircleRender=__decorate$11([injectable(),__param$C(0,inject(ContributionProvider)),__param$C(0,named(CircleRenderContribution)),__metadata$M("design:paramtypes",[Object])],DefaultCanvasCircleRender);function drawSegItem(r,e,i,n){if(!e.p1)return;const{offsetX:o=0,offsetY:l=0,offsetZ:d=0}=n||{};if(i===1)e.p2&&e.p3?r.bezierCurveTo(o+e.p1.x,l+e.p1.y,o+e.p2.x,l+e.p2.y,o+e.p3.x,l+e.p3.y,d):r.lineTo(o+e.p1.x,l+e.p1.y,d);else if(e.p2&&e.p3){const[u]=divideCubic(e,i);r.bezierCurveTo(o+u.p1.x,l+u.p1.y,o+u.p2.x,l+u.p2.y,o+u.p3.x,l+u.p3.y,d)}else{const u=e.getPointAt(i);r.lineTo(o+u.x,l+u.y,d)}}function drawEachCurve(r,e,i,n,o,l,d){var u;let f=e.p0,g=n;if(i&&i.originP1===i.originP2&&(f=i.p0),e.defined)n||(r.lineTo(f.x+o,f.y+l,d),g=!n);else{const{originP1:_,originP2:y}=e;let b;if(_&&_.defined!==!1&&!i?b=f:_&&y.defined!==!1&&(b=(u=e.p3)!==null&&u!==void 0?u:e.p1),n){g=!n;const S=b?b.x:e.p0.x,v=b?b.y:e.p0.y;r.moveTo(S+o,v+l,d)}else b&&(g=!n,r.lineTo(b.x+o,b.y+l,d))}return g}function drawSegments(r,e,i,n,o){const{offsetX:l=0,offsetY:d=0,offsetZ:u=0,mode:f="none",drawConnect:g=!1}=o||{};if(g&&f==="none"||!e)return;let _=!0;const{curves:y}=e;if(i>=1){if(g){let T,C=!0;y.forEach((E,P)=>{E.originP1!==E.originP2&&(C=drawEachCurve(r,E,T,C,l,d,u)),T=E})}else y.forEach(T=>{T.defined?(_&&r.moveTo(T.p0.x+l,T.p0.y+d,u),drawSegItem(r,T,1,o),_=!1):_=!0});return}if(i<=0)return;let b;n==="x"?b=Direction$1.ROW:n==="y"?b=Direction$1.COLUMN:n==="auto"&&(b=e.direction);const S=i*e.tryUpdateLength(b);let v=0,A=!0,x=null;for(let T=0,C=y.length;T<C;T++){const E=y[T],P=E.getLength(b),R=(S-v)/P;if(v+=P,R<0)break;if(g){if(E.originP1===E.originP2){x=E;continue}A=drawEachCurve(r,E,x,A,l,d,u),x=E}else{if(!E.defined){_=!0;continue}_&&r.moveTo(E.p0.x+l,E.p0.y+d,u),drawSegItem(r,E,min$1(R,1),o),_=!1}}}function drawIncrementalSegments(r,e,i,n){const{offsetX:o=0,offsetY:l=0}=n||{},d=e?e.points[e.points.length-1]:i.points[0];r.moveTo(d.x+o,d.y+l),i.points.forEach(u=>{u.defined!==!1?r.lineTo(u.x+o,u.y+l):r.moveTo(u.x+o,u.y+l)})}function drawIncrementalAreaSegments(r,e,i,n){const{offsetX:o=0,offsetY:l=0}=n||{},{points:d}=i,u=[];for(let f=0;f<d.length;f++)d[f].defined;u.push(d),u.forEach((f,g)=>{var _,y,b,S;const v=e&&g===0?e.points[e.points.length-1]:f[0];r.moveTo(v.x+o,v.y+l),f.forEach(A=>{A.defined!==!1?r.lineTo(A.x+o,A.y+l):r.moveTo(A.x+o,A.y+l)});for(let A=f.length-1;A>=0;A--){const x=f[A];r.lineTo((_=x.x1)!==null&&_!==void 0?_:x.x,(y=x.y1)!==null&&y!==void 0?y:x.y)}r.lineTo((b=v.x1)!==null&&b!==void 0?b:v.x,(S=v.y1)!==null&&S!==void 0?S:v.y),r.closePath()})}var __decorate$10=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d};let DefaultCanvasLineRender=class extends BaseRender{constructor(){super(...arguments),this.numberType=LINE_NUMBER_TYPE}draw(r,e,i,n){const o=getTheme$1(r,n==null?void 0:n.theme).line;this._draw(r,o,!1,i,n)}drawSegmentItem(r,e,i,n,o,l,d,u,f,g,_,y,b,S,v){var A;if(!e)return;r.beginPath();const x=(A=this.z)!==null&&A!==void 0?A:0;drawSegments(r.camera?r:r.nativeContext,e,f,g,{offsetX:_,offsetY:y,offsetZ:x}),b.cache&&!isArray(b.cache)&&b.cache.curves.every(E=>E.defined)&&b.attribute.curveType&&b.attribute.curveType.includes("Closed")&&r.closePath(),r.setShadowBlendStyle&&r.setShadowBlendStyle(b,d,u);const{x:T=0,x:C=0}=d;return i!==!1&&(S?S(r,d,u):o&&(r.setCommonStyle(b,d,T-_,C-y,u),r.fill())),n!==!1&&(v?v(r,d,u):l&&(r.setStrokeStyle(b,d,T-_,C-y,u),r.stroke())),!1}drawLinearLineHighPerformance(r,e,i,n,o,l,d,u,f,g,_,y,b){var S;e.beginPath();const v=(S=this.z)!==null&&S!==void 0?S:0,{points:A}=r.attribute,x=A[0];e.moveTo(x.x+d,x.y+u,v);for(let E=1;E<A.length;E++){const P=A[E];e.lineTo(P.x+d,P.y+u,v)}e.setShadowBlendStyle&&e.setShadowBlendStyle(r,r.attribute,f);const{x:T=0,x:C=0}=r.attribute;i!==!1&&(y?y(e,r.attribute,f):o&&(e.setCommonStyle(r,r.attribute,T-d,C-u,f),e.fill())),n!==!1&&(b?b(e,r.attribute,f):l&&(e.setStrokeStyle(r,r.attribute,T-d,C-u,f),e.stroke()))}drawShape(r,e,i,n,o,l,d,u){const f=getTheme$1(r,l==null?void 0:l.theme).line,{fill:g=f.fill,stroke:_=f.stroke,fillOpacity:y=f.fillOpacity,strokeOpacity:b=f.strokeOpacity,segments:S,points:v,closePath:A,curveTension:x=f.curveTension,connectedType:T=f.connectedType}=r.attribute;if(!this.valid(r,f,d,u))return;let{curveType:C=f.curveType}=r.attribute;A&&C==="linear"&&(C="linearClosed");const{clipRange:E=f.clipRange,clipRangeByDimension:P=f.clipRangeByDimension}=r.attribute;if(E===1&&!S&&!v.some(L=>L.defined===!1)&&C==="linear")return this.drawLinearLineHighPerformance(r,e,!!g,!!_,y,b,i,n,f,o,l,d,u);function R(L,w){return w==="none"?L:L.filter(B=>B.defined!==!1)}if(r.shouldUpdateShape()){const{points:L,segments:w}=r.attribute,B=L;if(w&&w.length){let I,D;if(r.cache=w.map((O,N)=>{if(O.points.length<=1&&N===0)return O.points[0]&&(D={endX:O.points[0].x,endY:O.points[0].y,curves:[{defined:O.points[0].defined!==!1}]}),null;N===1?I={x:D.endX,y:D.endY,defined:D.curves[D.curves.length-1].defined}:N>1&&(I.x=D.endX,I.y=D.endY,I.defined=D.curves[D.curves.length-1].defined);const V=calcLineCache(R(O.points,T),C,{startPoint:I,curveTension:x});return D=V,V}).filter(O=>!!O),C==="linearClosed"){let O;for(let N=0;N<r.cache.length;N++){const V=r.cache[N];for(let H=0;H<V.curves.length;H++)if(V.curves[H].defined){O=V.curves[H].p0;break}if(O)break}r.cache[r.cache.length-1]&&r.cache[r.cache.length-1].lineTo(O.x,O.y,!0)}}else{if(!L||!L.length)return r.cache=null,void r.clearUpdateShapeTag();r.cache=calcLineCache(R(B,T),C,{curveTension:x})}r.clearUpdateShapeTag()}if(Array.isArray(r.cache)){const L=r.attribute.segments.filter(w=>w.points.length);if(L[0].points.length===1&&L.shift(),E===1){let w=!1;r.cache.forEach((B,I)=>{w||(w=this.drawSegmentItem(e,B,!!g,!!_,y,b,L[I],[f,r.attribute],E,P,i,n,r,d,u))})}else{const w=r.cache.reduce((O,N)=>O+N.getLength(),0),B=E*w;let I=0,D=!1;r.cache.forEach((O,N)=>{if(D)return;const V=O.getLength(),H=(B-I)/V;I+=V,H>0&&(D=this.drawSegmentItem(e,O,!!g,!!_,y,b,L[N],[f,r.attribute],min$1(H,1),P,i,n,r,d,u))})}}else this.drawSegmentItem(e,r.cache,!!g,!!_,y,b,r.attribute,f,E,P,i,n,r,d,u)}};DefaultCanvasLineRender=__decorate$10([injectable()],DefaultCanvasLineRender);function drawAreaSegments(r,e,i,n){var o;const{top:l,bottom:d}=e;if(l.curves.length!==d.curves.length)return;if(i>=1){const T=[],C=[];let E=!0;for(let P=0,R=l.curves.length;P<R;P++){const L=l.curves[P];E!==L.defined?(E?(drawAreaBlock(r,T,C,n),T.length=0,C.length=0):(T.push(L),C.push(d.curves[R-P-1])),E=!E):E&&(T.push(L),C.push(d.curves[R-P-1]))}return void drawAreaBlock(r,T,C,n)}if(i<=0)return;let{direction:u}=n||{};const{curves:f}=l,g=(o=f[f.length-1].p3)!==null&&o!==void 0?o:f[f.length-1].p1,_=abs$1(g.x-f[0].p0.x),y=abs$1(g.y-f[0].p0.y);u=u??(_>y?Direction$1.ROW:Direction$1.COLUMN),Number.isFinite(_)||(u=Direction$1.COLUMN),Number.isFinite(y)||(u=Direction$1.ROW);const b=i*(u===Direction$1.ROW?_:y);let S=0,v=!0;const A=[],x=[];for(let T=0,C=l.curves.length;T<C;T++){const E=l.curves[T],P=E.getLength(u),R=(b-S)/P;if(R<0)break;S+=P;let L=null,w=null;v!==E.defined?(v?(drawAreaBlock(r,A,x,n),A.length=0,x.length=0):(L=E,w=d.curves[C-T-1]),v=!v):v&&(L=E,w=d.curves[C-T-1]),L&&w&&(R<1&&(L=L.p2&&L.p3?divideCubic(L,R)[0]:divideLinear(L,R)[0],w=w.p2&&w.p3?divideCubic(w,1-R)[1]:divideLinear(w,1-R)[1]),L.defined=v,w.defined=v,A.push(L),x.push(w)),L=null,w=null}drawAreaBlock(r,A,x,n)}function drawAreaBlock(r,e,i,n){const{offsetX:o=0,offsetY:l=0,offsetZ:d=0}=n||{};let u=!0;e.forEach(f=>{f.defined?(u&&r.moveTo(f.p0.x+o,f.p0.y+l,d),drawSegItem(r,f,1,n),u=!1):u=!0}),u=!0;for(let f=i.length-1;f>=0;f--){const g=i[f];g.defined?(u&&r.lineTo(g.p0.x+o,g.p0.y+l,d),drawSegItem(r,g,1,n),u=!1):u=!0}r.closePath()}const defaultAreaTextureRenderContribution=new DefaultAreaTextureRenderContribution,defaultAreaBackgroundRenderContribution=defaultBaseBackgroundRenderContribution;var __decorate$$=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$L=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$B=function(r,e){return function(i,n){e(i,n,r)}};let DefaultCanvasAreaRender=class extends BaseRender{constructor(r){super(),this.areaRenderContribitions=r,this.numberType=AREA_NUMBER_TYPE,this.builtinContributions=[defaultAreaTextureRenderContribution,defaultAreaBackgroundRenderContribution],this.init(r)}drawLinearAreaHighPerformance(r,e,i,n,o,l,d,u,f,g,_,y,b){var S,v,A;const{points:x}=r.attribute;if(x.length<2)return;e.beginPath();const T=(S=this.z)!==null&&S!==void 0?S:0,C=x[0];e.moveTo(C.x+d,C.y+u,T);for(let R=1;R<x.length;R++){const L=x[R];e.lineTo(L.x+d,L.y+u,T)}for(let R=x.length-1;R>=0;R--){const L=x[R];e.lineTo(((v=L.x1)!==null&&v!==void 0?v:L.x)+d,((A=L.y1)!==null&&A!==void 0?A:L.y)+u,T)}e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(r,r.attribute,f),this.beforeRenderStep(r,e,d,u,!!o,!1,i,!1,f,g,y,null,{attribute:r.attribute});const{x:E=0,x:P=0}=r.attribute;i!==!1&&(y?y(e,r.attribute,f):o&&(e.setCommonStyle(r,r.attribute,E-d,P-u,f),e.fill())),this.afterRenderStep(r,e,d,u,!!o,!1,i,!1,f,g,y,null,{attribute:r.attribute}),(()=>{var R,L;if(n){const{stroke:w=f&&f.stroke}=r.attribute;if(isArray(w)&&(w[0]||w[2])&&w[1]===!1){if(e.beginPath(),w[0]){e.moveTo(C.x+d,C.y+u,T);for(let B=1;B<x.length;B++){const I=x[B];e.lineTo(I.x+d,I.y+u,T)}}else if(w[2]){const B=x[x.length-1];e.moveTo(B.x+d,B.y+u,T);for(let I=x.length-2;I>=0;I--){const D=x[I];e.lineTo(((R=D.x1)!==null&&R!==void 0?R:D.x)+d,((L=D.y1)!==null&&L!==void 0?L:D.y)+u,T)}}}b?b(e,r.attribute,f):(e.setStrokeStyle(r,r.attribute,E-d,P-u,f),e.stroke())}})()}drawShape(r,e,i,n,o,l,d,u){var f,g,_,y,b,S;const v=getTheme$1(r,l==null?void 0:l.theme).area,{fill:A=v.fill,stroke:x=v.stroke,fillOpacity:T=v.fillOpacity,z:C=v.z,strokeOpacity:E=v.strokeOpacity,curveTension:P=v.curveTension,connectedType:R=v.connectedType}=r.attribute,L=this.valid(r,v,d,u);if(!L)return;const{doFill:w}=L,B=L.doStroke&&L.sVisible,{clipRange:I=v.clipRange,closePath:D,points:O,segments:N}=r.attribute;let{curveType:V=v.curveType}=r.attribute;function H(F,$){return $!=="connect"?F:F.filter(G=>G.defined!==!1)}if(D&&V==="linear"&&(V="linearClosed"),I===1&&!N&&!O.some(F=>F.defined===!1)&&V==="linear")return this.drawLinearAreaHighPerformance(r,e,!!A,B,T,E,i,n,v,o,l,d,u);if(r.shouldUpdateShape()){if(N&&N.length){let F,$;const G=N.map((q,te)=>{if(q.points.length<=1&&te===0)return q.points[0]&&($={endX:q.points[0].x,endY:q.points[0].y}),null;te===1?F={x:$.endX,y:$.endY}:te>1&&(F.x=$.endX,F.y=$.endY);const ue=calcLineCache(H(q.points,R),V,{startPoint:F,curveTension:P});return $=ue,ue}).filter(q=>!!q);let Y;const Q=[];for(let q=N.length-1;q>=0;q--){const te=N[q].points,ue=[];for(let he=te.length-1;he>=0;he--)ue.push({x:(f=te[he].x1)!==null&&f!==void 0?f:te[he].x,y:(g=te[he].y1)!==null&&g!==void 0?g:te[he].y});if(q!==0){const he=N[q-1].points,fe=he[he.length-1];fe&&ue.push({x:(_=fe.x1)!==null&&_!==void 0?_:fe.x,y:(y=fe.y1)!==null&&y!==void 0?y:fe.y})}ue.length>1&&(Y=calcLineCache(H(ue,R),V==="stepBefore"?"stepAfter":V==="stepAfter"?"stepBefore":V,{curveTension:P}),Q.unshift(Y))}r.cacheArea=Q.map((q,te)=>({top:G[te],bottom:q}))}else{if(!O||!O.length)return r.cacheArea=null,void r.clearUpdateShapeTag();{const F=H(O,R),$=[];for(let Q=F.length-1;Q>=0;Q--)$.push({x:(b=F[Q].x1)!==null&&b!==void 0?b:F[Q].x,y:(S=F[Q].y1)!==null&&S!==void 0?S:F[Q].y});const G=calcLineCache(F,V,{curveTension:P}),Y=calcLineCache($,V==="stepBefore"?"stepAfter":V==="stepAfter"?"stepBefore":V,{curveTension:P});r.cacheArea={top:G,bottom:Y}}}r.clearUpdateShapeTag()}if(Array.isArray(r.cacheArea)){const F=r.attribute.segments.filter($=>$.points.length);if(F[0].points.length===1&&F.shift(),I===1){let $=!1;r.cacheArea.forEach((G,Y)=>{$||($=this.drawSegmentItem(e,G,w,T,B,E,F[Y],[v,r.attribute],I,i,n,C,r,o,d,u))})}else{const $=r.cacheArea.reduce((q,te)=>q+te.top.getLength(),0),G=I*$;let Y=0,Q=!1;r.cacheArea.forEach((q,te)=>{if(Q)return;const ue=q.top.getLength(),he=(G-Y)/ue;Y+=ue,he>0&&(Q=this.drawSegmentItem(e,q,w,T,B,E,F[te],[v,r.attribute],min$1(he,1),i,n,C,r,o,d,u))})}}else this.drawSegmentItem(e,r.cacheArea,w,T,B,E,r.attribute,v,I,i,n,C,r,o,d,u)}draw(r,e,i,n){const o=getTheme$1(r,n==null?void 0:n.theme).area;this._draw(r,o,!1,i,n)}drawSegmentItem(r,e,i,n,o,l,d,u,f,g,_,y,b,S,v,A){return this._drawSegmentItem(r,e,i,n,o,l,d,u,f,g,_,y,b,S,v,A)}_drawSegmentItem(r,e,i,n,o,l,d,u,f,g,_,y,b,S,v,A){if(!(e&&e.top&&e.bottom&&e.top.curves&&e.top.curves.length&&e.bottom.curves&&e.bottom.curves.length))return;r.beginPath();const{points:x,segments:T}=b.attribute;let C,E,P=Direction$1.ROW;if(T){const I=T[T.length-1];E=T[0].points[0],C=I.points[I.points.length-1]}else E=x[0],C=x[x.length-1];const R=abs$1(C.x-E.x),L=abs$1(C.y-E.y);P=C.x1==null?Direction$1.ROW:C.y1==null?Direction$1.COLUMN:Number.isFinite(R+L)?R>L?Direction$1.ROW:Direction$1.COLUMN:Direction$1.ROW,drawAreaSegments(r.camera?r:r.nativeContext,e,f,{offsetX:g,offsetY:_,offsetZ:y,direction:P}),this.beforeRenderStep(b,r,g,_,!!n,!1,i,!1,u,S,v,null,{attribute:d}),r.setShadowBlendStyle&&r.setShadowBlendStyle(b,d,u);const{x:w=0,x:B=0}=d;return i!==!1&&(v?v(r,d,u):n&&(r.setCommonStyle(b,d,w-g,B-_,u),r.fill())),this.afterRenderStep(b,r,g,_,!!n,!1,i,!1,u,S,v,null,{attribute:d}),(()=>{if(o!==!1)if(A)A(r,d,u);else{const{stroke:I=u&&u[1]&&u[1].stroke}=d;isArray(I)&&(I[0]||I[2])&&I[1]===!1&&(r.beginPath(),drawSegments(r.camera?r:r.nativeContext,I[0]?e.top:e.bottom,f,P===Direction$1.ROW?"x":"y",{offsetX:g,offsetY:_,offsetZ:y})),r.setStrokeStyle(b,d,w-g,B-_,u),r.stroke()}})(),!1}};DefaultCanvasAreaRender=__decorate$$([injectable(),__param$B(0,inject(ContributionProvider)),__param$B(0,named(AreaRenderContribution)),__metadata$L("design:paramtypes",[Object])],DefaultCanvasAreaRender);const defaultPathTextureRenderContribution=defaultBaseTextureRenderContribution,defaultPathBackgroundRenderContribution=defaultBaseBackgroundRenderContribution;var __decorate$_=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$K=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$A=function(r,e){return function(i,n){e(i,n,r)}};let DefaultCanvasPathRender=class extends BaseRender{constructor(r){super(),this.pathRenderContribitions=r,this.numberType=PATH_NUMBER_TYPE,this.builtinContributions=[defaultPathBackgroundRenderContribution,defaultPathTextureRenderContribution],this.init(r)}drawShape(r,e,i,n,o,l,d,u){var f,g,_;const y=(f=this.tempTheme)!==null&&f!==void 0?f:getTheme$1(r,l==null?void 0:l.theme).path,{x:b=y.x,y:S=y.y,fillStrokeOrder:v=y.fillStrokeOrder}=r.attribute,A=(g=this.z)!==null&&g!==void 0?g:0,x=this.valid(r,y,d,u);if(!x)return;const{fVisible:T,sVisible:C,doFill:E,doStroke:P}=x;if(e.beginPath(),r.pathShape)renderCommandList(r.pathShape.commandList,e,i,n,1,1,A);else{const w=(_=r.attribute.path)!==null&&_!==void 0?_:y.path;renderCommandList(w.commandList,e,i,n,1,1,A)}e.setShadowBlendStyle&&e.setShadowBlendStyle(r,r.attribute,y),this.beforeRenderStep(r,e,i,n,E,P,T,C,y,o,d,u);const R=()=>{P&&(u?u(e,r.attribute,y):C&&(e.setStrokeStyle(r,r.attribute,b-i,S-n,y),e.stroke()))},L=()=>{E&&(d?d(e,r.attribute,y):T&&(e.setCommonStyle(r,r.attribute,b-i,S-n,y),e.fill()))};v?(R(),L()):(L(),R()),this.afterRenderStep(r,e,i,n,E,P,T,C,y,o,d,u)}draw(r,e,i,n){const o=getTheme$1(r,n==null?void 0:n.theme).path;this.tempTheme=o,this._draw(r,o,!1,i,n),this.tempTheme=null}};DefaultCanvasPathRender=__decorate$_([injectable(),__param$A(0,inject(ContributionProvider)),__param$A(0,named(PathRenderContribution)),__metadata$K("design:paramtypes",[Object])],DefaultCanvasPathRender);var __decorate$Z=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$J=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$z=function(r,e){return function(i,n){e(i,n,r)}};let DefaultCanvasRectRender=class extends BaseRender{constructor(r){super(),this.rectRenderContribitions=r,this.type="rect",this.numberType=RECT_NUMBER_TYPE,this.builtinContributions=[defaultRectRenderContribution,defaultRectBackgroundRenderContribution,defaultRectTextureRenderContribution],this.init(r)}drawShape(r,e,i,n,o,l,d,u){var f;const g=(f=this.tempTheme)!==null&&f!==void 0?f:getTheme$1(r,l==null?void 0:l.theme).rect,{fill:_=g.fill,background:y,stroke:b=g.stroke,cornerRadius:S=g.cornerRadius,opacity:v=g.opacity,fillOpacity:A=g.fillOpacity,lineWidth:x=g.lineWidth,strokeOpacity:T=g.strokeOpacity,visible:C=g.visible,x1:E,y1:P,x:R=g.x,y:L=g.y,fillStrokeOrder:w=g.fillStrokeOrder}=r.attribute;let{width:B,height:I}=r.attribute;B=(B??E-R)||0,I=(I??P-L)||0;const D=rectFillVisible(v,A,B,I,_),O=rectStrokeVisible(v,T,B,I),N=runFill(_,y),V=runStroke(b,x);if(!r.valid||!C||!N&&!V||!(D||O||d||u||y))return;S===0||isArray(S)&&S.every(G=>G===0)?(e.beginPath(),e.rect(i,n,B,I)):(e.beginPath(),createRectPath(e,i,n,B,I,S));const H={doFill:N,doStroke:V};e.setShadowBlendStyle&&e.setShadowBlendStyle(r,r.attribute,g),this.beforeRenderStep(r,e,i,n,N,V,D,O,g,o,d,u,H);const F=()=>{H.doFill&&(d?d(e,r.attribute,g):D&&(e.setCommonStyle(r,r.attribute,R-i,L-n,g),e.fill()))},$=()=>{H.doStroke&&(u?u(e,r.attribute,g):O&&(e.setStrokeStyle(r,r.attribute,R-i,L-n,g),e.stroke()))};w?($(),F()):(F(),$()),this.afterRenderStep(r,e,i,n,N,V,D,O,g,o,d,u)}draw(r,e,i,n){const o=getTheme$1(r,n==null?void 0:n.theme).rect;this.tempTheme=o,this._draw(r,o,!1,i,n),this.tempTheme=null}};DefaultCanvasRectRender=__decorate$Z([injectable(),__param$z(0,inject(ContributionProvider)),__param$z(0,named(RectRenderContribution)),__metadata$J("design:paramtypes",[Object])],DefaultCanvasRectRender);var __decorate$Y=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$I=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$y=function(r,e){return function(i,n){e(i,n,r)}};let DefaultCanvasSymbolRender=class extends BaseRender{constructor(r){super(),this.symbolRenderContribitions=r,this.numberType=SYMBOL_NUMBER_TYPE,this.builtinContributions=[defaultSymbolRenderContribution,defaultSymbolBackgroundRenderContribution,defaultSymbolTextureRenderContribution],this.init(r)}drawShape(r,e,i,n,o,l,d,u){var f;const g=getTheme$1(r,l==null?void 0:l.theme).symbol,{size:_=g.size,x:y=g.x,y:b=g.y,scaleX:S=g.scaleX,scaleY:v=g.scaleY,fillStrokeOrder:A=g.fillStrokeOrder}=r.attribute,x=this.valid(r,g,d,u);if(!x)return;const{fVisible:T,sVisible:C,doFill:E,doStroke:P}=x,R=r.getParsedPath();if(!R)return;const{keepDirIn3d:L=g.keepDirIn3d}=r.attribute,w=(f=this.z)!==null&&f!==void 0?f:0;e.beginPath();const B=(O,N)=>{var V,H,F;if(r._parsedPath.svgCache){const Y=Object.assign({},N);Y.fill=(V=N.fill)!==null&&V!==void 0?V:r.attribute.fill,Y.opacity=(H=N.opacity)!==null&&H!==void 0?H:r.attribute.opacity,Y.fillOpacity=r.attribute.fillOpacity,Y.stroke=(F=N.stroke)!==null&&F!==void 0?F:r.attribute.stroke,N=Y}const $=()=>{N.fill&&(d?d(e,r.attribute,g):(e.setCommonStyle(r,N,y-i,b-n,g),e.fill()))},G=()=>{N.stroke&&(u?u(e,r.attribute,g):(e.setStrokeStyle(r,N,(y-i)/S,(b-n)/v,g),e.stroke()))};A?(G(),$()):($(),G())};if(L&&e.camera&&e.project){const O=e.project(i,n,w),N=e.camera;e.camera=null,R.draw(e,isArray(_)?[_[0]*S,_[1]*v]:_*S,O.x,O.y,void 0,B)===!1&&e.closePath(),e.camera=N}else R.draw(e,_,i,n,w,B)===!1&&e.closePath();e.setShadowBlendStyle&&e.setShadowBlendStyle(r,r.attribute,g),this.beforeRenderStep(r,e,i,n,E,P,T,C,g,o,d,u);const I=()=>{E&&!R.isSvg&&(d?d(e,r.attribute,g):T&&(e.setCommonStyle(r,r.attribute,y-i,b-n,g),e.fill()))},D=()=>{P&&!R.isSvg&&(u?u(e,r.attribute,g):C&&(e.setStrokeStyle(r,r.attribute,(y-i)/S,(b-n)/v,g),e.stroke()))};A?(D(),I()):(I(),D()),this.afterRenderStep(r,e,i,n,E,P,T,C,g,o,d,u)}draw(r,e,i,n){const o=getTheme$1(r,n==null?void 0:n.theme).symbol;this._draw(r,o,!1,i,n)}};DefaultCanvasSymbolRender=__decorate$Y([injectable(),__param$y(0,inject(ContributionProvider)),__param$y(0,named(SymbolRenderContribution)),__metadata$I("design:paramtypes",[Object])],DefaultCanvasSymbolRender);class DefaultBoundsAllocate{constructor(){this.pools=[];for(let e=0;e<10;e++)this.pools.push(new AABBBounds)}allocate(e,i,n,o){if(!this.pools.length)return new AABBBounds().setValue(e,i,n,o);const l=this.pools.pop();return l.x1=e,l.y1=i,l.x2=n,l.y2=o,l}allocateByObj(e){if(!this.pools.length)return new AABBBounds(e);const i=this.pools.pop();return i.x1=e.x1,i.y1=e.y1,i.x2=e.x2,i.y2=e.y2,i}free(e){this.pools.push(e)}get length(){return this.pools.length}release(...e){this.pools=[]}}const boundsAllocate=new DefaultBoundsAllocate;class GraphicCreator{constructor(){this.store=new Map}RegisterGraphicCreator(e,i){this.store.set(e,i),this[e]=i}CreateGraphic(e,i){const n=this.store.get(e);return n?n(i):null}}const graphicCreator=new GraphicCreator;let text,richText;function getTextBounds(r){return text||(text=graphicCreator.CreateGraphic("text",{})),text.initAttributes(r),text.AABBBounds}function getRichTextBounds(r){return richText||(richText=graphicCreator.CreateGraphic("richtext",{})),richText.setAttributes(r),richText.AABBBounds}class DefaultTextBackgroundRenderContribution extends DefaultBaseBackgroundRenderContribution{constructor(){super(...arguments),this.time=BaseRenderContributionTime.beforeFillStroke}drawShape(e,i,n,o,l,d,u,f,g,_,y,b){var S,v,A,x,T,C,E,P,R,L;const{backgroundMode:w=g.backgroundMode,backgroundFit:B=g.backgroundFit}=e.attribute;let I,{background:D}=e.attribute;if(!D)return;const O=()=>{e.type==="richtext"&&(i.restore(),i.save(),I&&i.setTransformFromMatrix(I,!0,1))};let N;e.type==="richtext"&&(I=i.currentMatrix.clone(),i.restore(),i.save(),i.setTransformForCurrent());const V=isObject$1(D)&&D.background,H=e.transMatrix.onlyTranslate();if(V){const F=e.AABBBounds,$=((S=D.x)!==null&&S!==void 0?S:F.x1)+((v=D.dx)!==null&&v!==void 0?v:0),G=((A=D.y)!==null&&A!==void 0?A:F.y1)+((x=D.dy)!==null&&x!==void 0?x:0),Y=(T=D.width)!==null&&T!==void 0?T:F.width(),Q=(C=D.height)!==null&&C!==void 0?C:F.height();if(N=boundsAllocate.allocate($,G,$+Y,G+Q),D=D.background,!H){const q=N.width(),te=N.height();N.set(((E=D.x)!==null&&E!==void 0?E:0)+((P=D.dx)!==null&&P!==void 0?P:0),((R=D.y)!==null&&R!==void 0?R:0)+((L=D.dy)!==null&&L!==void 0?L:0),q,te)}}else N=e.AABBBounds,H||(N=getTextBounds(Object.assign(Object.assign({},e.attribute),{angle:0,scaleX:1,scaleY:1,x:0,y:0,dx:0,dy:0})).clone());if(e.backgroundImg&&e.resources){const F=e.resources.get(D);if(F.state!=="success"||!F.data)return void O();i.highPerformanceSave(),H&&i.setTransformFromMatrix(e.parent.globalTransMatrix,!0),i.setCommonStyle(e,e.attribute,n,o,g),this.doDrawImage(i,F.data,N,w,B),i.highPerformanceRestore(),i.setTransformForCurrent()}else{const{backgroundCornerRadius:F}=e.attribute;i.highPerformanceSave(),i.setCommonStyle(e,e.attribute,n,o,g),i.fillStyle=D,F?(createRectPath(i,N.x1,N.y1,N.width(),N.height(),F),i.fill()):i.fillRect(N.x1,N.y1,N.width(),N.height()),i.highPerformanceRestore()}V&&boundsAllocate.free(N),O()}}const defaultTextBackgroundRenderContribution=new DefaultTextBackgroundRenderContribution;var __decorate$X=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$H=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$x=function(r,e){return function(i,n){e(i,n,r)}};let DefaultCanvasTextRender=class extends BaseRender{constructor(r){super(),this.textRenderContribitions=r,this.numberType=TEXT_NUMBER_TYPE,this.builtinContributions=[defaultTextBackgroundRenderContribution],this.init(r)}drawShape(r,e,i,n,o,l,d,u){var f,g,_;const y=getTheme$1(r,l==null?void 0:l.theme).text,{text:b,underline:S=y.underline,lineThrough:v=y.lineThrough,keepDirIn3d:A=y.keepDirIn3d,direction:x=y.direction,fontSize:T=y.fontSize,verticalMode:C=y.verticalMode,x:E=y.x,y:P=y.y}=r.attribute,R=(f=calculateLineHeight(r.attribute.lineHeight,T))!==null&&f!==void 0?f:T,L=this.valid(r,y,d,u);if(!L)return;const{fVisible:w,sVisible:B,doFill:I,doStroke:D}=L,O=!A,N=this.z||0;e.beginPath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(r,r.attribute,y),this.beforeRenderStep(r,e,i,n,I,D,w,B,y,o,d,u),O&&this.transformUseContext2d(r,y,N,e);const V=(H,F,$,G)=>{let Y=i+F;const Q=n+$;if(G){e.highPerformanceSave(),Y+=T;const q=matrixAllocate.allocate(1,0,0,1,0,0);q.rotateByCenter(Math.PI/2,Y,Q),e.transformFromMatrix(q,!0),matrixAllocate.free(q)}D&&(u?u(e,r.attribute,y):B&&(e.setStrokeStyle(r,r.attribute,E-i,P-n,y),e.strokeText(H,Y,Q,N))),I&&(d?d(e,r.attribute,y):w&&(e.setCommonStyle(r,r.attribute,E-i,P-n,y),e.fillText(H,Y,Q,N))),G&&(e.highPerformanceRestore(),e.setTransformForCurrent())};if(e.setTextStyleWithoutAlignBaseline(r.attribute,y,N),x==="horizontal"){const{multilineLayout:H}=r;if(!H)return void e.highPerformanceRestore();const{xOffset:F,yOffset:$}=H.bbox;D&&(u?u(e,r.attribute,y):B&&(e.setStrokeStyle(r,r.attribute,E-i,P-n,y),H.lines.forEach(G=>{e.strokeText(G.str,(G.leftOffset||0)+F+i,(G.topOffset||0)+$+n,N)}))),I&&(d?d(e,r.attribute,y):w&&(e.setCommonStyle(r,r.attribute,E-i,P-n,y),H.lines.forEach(G=>{e.fillText(G.str,(G.leftOffset||0)+F+i,(G.topOffset||0)+$+n,N),this.drawUnderLine(S,v,r,(G.leftOffset||0)+F+i,(G.topOffset||0)+$+n,G.descent,(G.descent-G.ascent)/2,N,y,e,{width:G.width})})))}else{let{textAlign:H=y.textAlign,textBaseline:F=y.textBaseline}=r.attribute;if(!C){const ue=H;H=(g=r.getBaselineMapAlign()[F])!==null&&g!==void 0?g:"left",F=(_=r.getAlignMapBaseline()[ue])!==null&&_!==void 0?_:"top"}r.tryUpdateAABBBounds();const $=r.cache,{verticalList:G}=$;e.textAlign="left",e.textBaseline="top";const Y=R*G.length;let Q=0;G.forEach(ue=>{const he=ue.reduce((fe,pe)=>fe+(pe.width||0),0);Q=max$1(he,Q)});let q=0,te=0;F==="bottom"?te=-Y:F==="middle"&&(te=-Y/2),H==="center"?q-=Q/2:H==="right"&&(q-=Q),G.forEach((ue,he)=>{const fe=ue.reduce((ee,J)=>ee+(J.width||0),0),pe=Q-fe;let me=q;H==="center"?me+=pe/2:H==="right"&&(me+=pe),ue.forEach(ee=>{const{text:J,width:ie,direction:le}=ee;V(J,Y-(he+1)*R+te,me,le),me+=ie})})}O&&this.restoreTransformUseContext2d(r,y,N,e),this.afterRenderStep(r,e,i,n,I,D,w,B,y,o,d,u)}draw(r,e,i,n){const o=getTheme$1(r,n==null?void 0:n.theme).text,{keepDirIn3d:l=o.keepDirIn3d}=r.attribute,d=!l;this._draw(r,o,d,i,n)}drawUnderLine(r,e,i,n,o,l,d,u,f,g,_){if(e+r<=0)return;const{textAlign:y=f.textAlign,fill:b=f.fill,opacity:S=f.opacity,underlineOffset:v=f.underlineOffset,underlineDash:A=f.underlineDash,fillOpacity:x=f.fillOpacity}=i.attribute,T=!isNil(_),C=T?_.width:i.clipedWidth,E=T?0:textDrawOffsetX(y,C),P={lineWidth:0,stroke:b,opacity:S,strokeOpacity:x};if(r){P.lineWidth=r,g.setStrokeStyle(i,P,n,o,f),A&&g.setLineDash(A),g.beginPath();const R=o+l+v;g.moveTo(n+E,R,u),g.lineTo(n+E+C,R,u),g.stroke()}if(e){P.lineWidth=e,g.setStrokeStyle(i,P,n,o,f),g.beginPath();const R=o+d;g.moveTo(n+E,R,u),g.lineTo(n+E+C,R,u),g.stroke()}}};DefaultCanvasTextRender=__decorate$X([injectable(),__param$x(0,inject(ContributionProvider)),__param$x(0,named(TextRenderContribution)),__metadata$H("design:paramtypes",[Object])],DefaultCanvasTextRender);function drawPolygon(r,e,i,n){r.moveTo(e[0].x+i,e[0].y+n);for(let o=1;o<e.length;o++)r.lineTo(e[o].x+i,e[o].y+n)}function drawRoundedPolygon(r,e,i,n,o,l=!0){var d;if(e.length<3)return void drawPolygon(r,e,i,n);let u=0,f=e.length-1;l||(u+=1,f-=1,r.moveTo(e[0].x+i,e[0].y+n));for(let g=u;g<=f;g++){const _=e[g===0?f:(g-1)%e.length],y=e[g%e.length],b=e[(g+1)%e.length],S=y.x-_.x,v=y.y-_.y,A=y.x-b.x,x=y.y-b.y,T=(Math.atan2(v,S)-Math.atan2(x,A))/2,C=Math.abs(Math.tan(T));let E=Array.isArray(o)?(d=o[g%e.length])!==null&&d!==void 0?d:0:o,P=E/C;const R=getLength(S,v),L=getLength(A,x),w=Math.min(R,L);P>w&&(P=w,E=w*C);const B=getProportionPoint(y,P,R,S,v),I=getProportionPoint(y,P,L,A,x),D=2*y.x-B.x-I.x,O=2*y.y-B.y-I.y,N=getLength(D,O),V=getProportionPoint(y,getLength(P,E),N,D,O);let H=Math.atan2(B.y-V.y,B.x-V.x);const F=Math.atan2(I.y-V.y,I.x-V.x);let $=F-H;$<0&&(H=F,$=-$),$>Math.PI&&($-=Math.PI),g===0?r.moveTo(B.x+i,B.y+n):r.lineTo(B.x+i,B.y+n),$&&r.arcTo(y.x+i,y.y+n,I.x+i,I.y+n,E),r.lineTo(I.x+i,I.y+n)}l||r.lineTo(e[f+1].x+i,e[f+1].y+n)}function getLength(r,e){return Math.sqrt(r*r+e*e)}function getProportionPoint(r,e,i,n,o){const l=e/i;return{x:r.x-n*l,y:r.y-o*l}}const defaultPolygonTextureRenderContribution=defaultBaseTextureRenderContribution,defaultPolygonBackgroundRenderContribution=defaultBaseBackgroundRenderContribution;var __decorate$W=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$G=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$w=function(r,e){return function(i,n){e(i,n,r)}};let DefaultCanvasPolygonRender=class extends BaseRender{constructor(r){super(),this.polygonRenderContribitions=r,this.numberType=POLYGON_NUMBER_TYPE,this.builtinContributions=[defaultPolygonBackgroundRenderContribution,defaultPolygonTextureRenderContribution],this.init(r)}drawShape(r,e,i,n,o,l,d,u){const f=getTheme$1(r,l==null?void 0:l.theme).polygon,{points:g=f.points,cornerRadius:_=f.cornerRadius,x:y=f.x,y:b=f.y,closePath:S=f.closePath,fillStrokeOrder:v=f.fillStrokeOrder}=r.attribute,A=this.valid(r,f,d,u);if(!A)return;const{fVisible:x,sVisible:T,doFill:C,doStroke:E}=A;e.beginPath(),_<=0||isArray(_)&&_.every(L=>L===0)?drawPolygon(e.camera?e:e.nativeContext,g,i,n):drawRoundedPolygon(e.camera?e:e.nativeContext,g,i,n,_,S),S&&e.closePath(),e.setShadowBlendStyle&&e.setShadowBlendStyle(r,r.attribute,f),this.beforeRenderStep(r,e,i,n,C,E,x,T,f,o,d,u);const P=()=>{C&&(d?d(e,r.attribute,f):x&&(e.setCommonStyle(r,r.attribute,y-i,b-n,f),e.fill()))},R=()=>{E&&(u?u(e,r.attribute,f):T&&(e.setStrokeStyle(r,r.attribute,y-i,b-n,f),e.stroke()))};v?(R(),P()):(P(),R()),this.afterRenderStep(r,e,i,n,C,E,x,T,f,o,d,u)}draw(r,e,i,n){const o=getTheme$1(r,n==null?void 0:n.theme).polygon;this._draw(r,o,!1,i,n)}};DefaultCanvasPolygonRender=__decorate$W([injectable(),__param$w(0,inject(ContributionProvider)),__param$w(0,named(PolygonRenderContribution)),__metadata$G("design:paramtypes",[Object])],DefaultCanvasPolygonRender);var __decorate$V=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$F=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$v=function(r,e){return function(i,n){e(i,n,r)}};let DefaultCanvasGroupRender=class{constructor(r){this.groupRenderContribitions=r,this.numberType=GROUP_NUMBER_TYPE}drawShape(r,e,i,n,o,l,d,u){const f=getTheme$1(r,l==null?void 0:l.theme).group,{fill:g=f.fill,background:_,stroke:y=f.stroke,opacity:b=f.opacity,width:S=f.width,height:v=f.height,clip:A=f.clip,fillOpacity:x=f.fillOpacity,strokeOpacity:T=f.strokeOpacity,cornerRadius:C=f.cornerRadius,path:E=f.path,lineWidth:P=f.lineWidth,visible:R=f.visible,fillStrokeOrder:L=f.fillStrokeOrder,x:w=f.x,y:B=f.y}=r.attribute,I=rectFillVisible(b,x,S,v,g),D=rectStrokeVisible(b,T,S,v),O=runFill(g,_),N=runStroke(y,P);if(!r.valid||!R||!A&&(!O&&!N||!(I||D||d||u||_)))return;if(E&&E.length&&o.drawContribution){const $=e.disableFill,G=e.disableStroke,Y=e.disableBeginPath;e.disableFill=!0,e.disableStroke=!0,e.disableBeginPath=!0,E.forEach(Q=>{o.drawContribution.getRenderContribution(Q).draw(Q,o.renderService,o,l)}),e.disableFill=$,e.disableStroke=G,e.disableBeginPath=Y}else C===0||isArray(C)&&C.every($=>$===0)?(e.beginPath(),e.rect(i,n,S,v)):(e.beginPath(),createRectPath(e,i,n,S,v,C));this._groupRenderContribitions||(this._groupRenderContribitions=this.groupRenderContribitions.getContributions()||[],this._groupRenderContribitions.push(defaultGroupBackgroundRenderContribution));const V={doFill:O,doStroke:N};this._groupRenderContribitions.forEach($=>{$.time===BaseRenderContributionTime.beforeFillStroke&&$.drawShape(r,e,i,n,O,N,I,D,f,o,d,u,V)}),A&&e.clip(),e.setShadowBlendStyle&&e.setShadowBlendStyle(r,r.attribute,f);const H=()=>{V.doFill&&(d?d(e,r.attribute,f):I&&(e.setCommonStyle(r,r.attribute,w-i,B-n,f),e.fill()))},F=()=>{V.doStroke&&(u?u(e,r.attribute,f):D&&(e.setStrokeStyle(r,r.attribute,w-i,B-n,f),e.stroke()))};L?(F(),H()):(H(),F()),this._groupRenderContribitions.forEach($=>{$.time===BaseRenderContributionTime.afterFillStroke&&$.drawShape(r,e,i,n,O,N,I,D,f,o,d,u)})}draw(r,e,i,n){const{context:o}=i;if(!o)return;const{clip:l,baseOpacity:d=1}=r.attribute;l?o.save():o.highPerformanceSave();const u=o.baseGlobalAlpha;o.baseGlobalAlpha*=d;const f=getTheme$1(r,n==null?void 0:n.theme).group,g=o.modelMatrix;if(o.camera){const S=mat4Allocate.allocate(),v=mat4Allocate.allocate();getModelMatrix(v,r,f),multiplyMat4Mat4(S,g||S,v),o.modelMatrix=S,mat4Allocate.free(v),o.setTransform(1,0,0,1,0,0,!0)}else o.transformFromMatrix(r.transMatrix,!0);o.beginPath(),n.skipDraw?this.drawShape(r,o,0,0,i,n,()=>!1,()=>!1):this.drawShape(r,o,0,0,i);const{scrollX:_=f.scrollX,scrollY:y=f.scrollY}=r.attribute;let b;(_||y)&&o.translate(_,y),n&&n.drawingCb&&(b=n.drawingCb()),o.modelMatrix!==g&&mat4Allocate.free(o.modelMatrix),o.modelMatrix=g,o.baseGlobalAlpha=u,b&&b.then?b.then(()=>{l?o.restore():o.highPerformanceRestore()}):l?o.restore():o.highPerformanceRestore()}};DefaultCanvasGroupRender=__decorate$V([injectable(),__param$v(0,inject(ContributionProvider)),__param$v(0,named(GroupRenderContribution)),__metadata$F("design:paramtypes",[Object])],DefaultCanvasGroupRender);var __decorate$U=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$E=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$u=function(r,e){return function(i,n){e(i,n,r)}};const repeatStr=["","repeat-x","repeat-y","repeat"];let DefaultCanvasImageRender=class extends BaseRender{constructor(r){super(),this.imageRenderContribitions=r,this.numberType=IMAGE_NUMBER_TYPE,this.builtinContributions=[defaultImageRenderContribution,defaultImageBackgroundRenderContribution],this.init(r)}drawShape(r,e,i,n,o,l,d,u){const f=getTheme$1(r).image,{width:g=f.width,height:_=f.height,repeatX:y=f.repeatX,repeatY:b=f.repeatY,x:S=f.x,y:v=f.y,cornerRadius:A=f.cornerRadius,fillStrokeOrder:x=f.fillStrokeOrder,image:T}=r.attribute,C=this.valid(r,f,d);if(!C)return;const{fVisible:E,sVisible:P,doFill:R,doStroke:L}=C;if(!T||!r.resources)return;const w=r.resources.get(T);if(w.state!=="success")return;let B=!1;A===0||isArray(A)&&A.every(O=>O===0)||(e.beginPath(),createRectPath(e,i,n,g,_,A),B=!0),e.setShadowBlendStyle&&e.setShadowBlendStyle(r,r.attribute,f);const I=()=>{if(R){if(d)d(e,r.attribute,f);else if(E){e.setCommonStyle(r,r.attribute,i,n,f);let O=0;if(y==="repeat"&&(O|=1),b==="repeat"&&(O|=2),O){const N=e.createPattern(w.data,repeatStr[O]);e.fillStyle=N,e.translate(i,n,!0),e.fillRect(0,0,g,_),e.translate(-i,-n,!0)}else e.drawImage(w.data,i,n,g,_)}}},D=()=>{L&&(u?u(e,r.attribute,f):P&&(e.setStrokeStyle(r,r.attribute,S-i,v-n,f),e.stroke()))};x?(D(),B&&(e.save(),e.clip()),this.beforeRenderStep(r,e,i,n,R,!1,E,!1,f,o,d),I(),B&&e.restore()):(B&&(e.save(),e.clip()),this.beforeRenderStep(r,e,i,n,R,!1,E,!1,f,o,d),I(),B&&e.restore(),D()),this.afterRenderStep(r,e,i,n,R,!1,E,!1,f,o,d)}draw(r,e,i){const{image:n}=r.attribute;if(!n||!r.resources)return;const o=r.resources.get(n);if(o.state==="loading"&&isString(n))return void ResourceLoader.improveImageLoading(n);if(o.state!=="success")return;const{context:l}=e.drawParams;if(!l)return;const d=getTheme$1(r).image;this._draw(r,d,!1,i)}};DefaultCanvasImageRender=__decorate$U([injectable(),__param$u(0,inject(ContributionProvider)),__param$u(0,named(ImageRenderContribution)),__metadata$E("design:paramtypes",[Object])],DefaultCanvasImageRender);const IncrementalDrawContribution=Symbol.for("IncrementalDrawContribution"),ArcRender=Symbol.for("ArcRender"),Arc3dRender=Symbol.for("Arc3dRender"),AreaRender=Symbol.for("AreaRender"),CircleRender=Symbol.for("CircleRender"),GraphicRender=Symbol.for("GraphicRender"),GroupRender=Symbol.for("GroupRender"),LineRender=Symbol.for("LineRender"),PathRender=Symbol.for("PathRender"),PolygonRender=Symbol.for("PolygonRender"),RectRender=Symbol.for("RectRender"),Rect3DRender=Symbol.for("Rect3DRender"),SymbolRender=Symbol.for("SymbolRender"),TextRender=Symbol.for("TextRender"),RichTextRender=Symbol.for("RichTextRender"),Pyramid3dRender=Symbol.for("Pyramid3dRender"),GlyphRender=Symbol.for("GlyphRender"),ImageRender=Symbol.for("ImageRender"),DrawContribution=Symbol.for("DrawContribution"),draw3dItem=(r,e,i,n)=>{let o,l=!1,d=!1;if(e.forEachChildren(u=>(l=u.numberType===ARC3D_NUMBER_TYPE,!l)),e.forEachChildren(u=>(d=!!u.findFace,!d)),l){const u=e.getChildren(),f=[...u];f.sort((g,_)=>{var y,b,S,v;let A=((b=(y=g.attribute.startAngle)!==null&&y!==void 0?y:0+g.attribute.endAngle)!==null&&b!==void 0?b:0)/2,x=((v=(S=_.attribute.startAngle)!==null&&S!==void 0?S:0+_.attribute.endAngle)!==null&&v!==void 0?v:0)/2;for(;A<0;)A+=pi2;for(;x<0;)x+=pi2;return x-A}),f.forEach(g=>{g._next=null,g._prev=null}),e.removeAllChild(),e.update(),f.forEach(g=>{e.appendChild(g)}),n.hack_pieFace="outside",o=i(l,d),o&&o.graphic||(n.hack_pieFace="inside",o=i(l,d)),o&&o.graphic||(n.hack_pieFace="top",o=i(l,d)),e.removeAllChild(),u.forEach(g=>{g._next=null,g._prev=null}),u.forEach(g=>{e.appendChild(g)})}else if(d){const u=e.getChildren(),f=u.map(g=>({ave_z:g.findFace().vertices.map(_=>{var y;return r.view(_[0],_[1],(y=_[2]+g.attribute.z)!==null&&y!==void 0?y:0)[2]}).reduce((_,y)=>_+y,0),g}));f.sort((g,_)=>_.ave_z-g.ave_z),e.removeAllChild(),f.forEach(g=>{g.g._next=null,g.g._prev=null}),e.update(),f.forEach(g=>{e.add(g.g)}),o=i(l,d),e.removeAllChild(),u.forEach(g=>{g._next=null,g._prev=null}),e.update(),u.forEach(g=>{e.add(g)})}else o=i(l,d);return o};var __decorate$T=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$D=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)};const DrawItemInterceptor=Symbol.for("DrawItemInterceptor"),tempDirtyBounds=new AABBBounds,tempBackupDirtyBounds=new AABBBounds;class ShadowRootDrawItemInterceptorContribution{constructor(){this.order=1}afterDrawItem(e,i,n,o,l){return e.attribute.shadowRootIdx==null&&e.shadowRoot&&e.shadowRoot.attribute.shadowRootIdx<0||(e.attribute.shadowRootIdx>0||!e.attribute.shadowRootIdx||e.shadowRoot&&e.shadowRoot.attribute.shadowRootIdx>0)&&this.drawItem(e,i,n,o,l),!1}beforeDrawItem(e,i,n,o,l){return e.attribute.shadowRootIdx==null&&e.shadowRoot&&e.shadowRoot.attribute.shadowRootIdx>0||(e.attribute.shadowRootIdx<0||e.shadowRoot&&e.shadowRoot.attribute.shadowRootIdx<0)&&this.drawItem(e,i,n,o,l),!1}drawItem(e,i,n,o,l){if(!e.shadowRoot)return!1;const{context:d}=n;if(d.highPerformanceSave(),d.transformFromMatrix(e.transMatrix,!0),o.dirtyBounds&&o.backupDirtyBounds){tempDirtyBounds.copy(o.dirtyBounds),tempBackupDirtyBounds.copy(o.backupDirtyBounds);const u=e.globalTransMatrix.getInverse();o.dirtyBounds.copy(o.backupDirtyBounds).transformWithMatrix(u),o.backupDirtyBounds.copy(o.dirtyBounds)}return o.renderGroup(e.shadowRoot,n,matrixAllocate.allocate(1,0,0,1,0,0)),d.highPerformanceRestore(),o.dirtyBounds&&o.backupDirtyBounds&&(o.dirtyBounds.copy(tempDirtyBounds),o.backupDirtyBounds.copy(tempBackupDirtyBounds)),!0}}class DebugDrawItemInterceptorContribution{constructor(){this.order=1}afterDrawItem(e,i,n,o,l){return e.attribute._debug_bounds&&this.drawItem(e,i,n,o,l),!1}drawItem(e,i,n,o,l){if(!e.attribute._debug_bounds)return!1;const{context:d}=n;d.highPerformanceSave(),e.parent&&d.setTransformFromMatrix(e.parent.globalTransMatrix,!0),e.glyphHost&&e.glyphHost.parent&&d.setTransformFromMatrix(e.glyphHost.parent.globalTransMatrix,!0);const u=e.AABBBounds;return e.attribute._debug_bounds!==!0&&e.attribute._debug_bounds(d,e),d.strokeRect(u.x1,u.y1,u.width(),u.height()),d.highPerformanceRestore(),!0}}let CommonDrawItemInterceptorContribution=class{constructor(){this.order=1,this.interceptors=[new ShadowRootDrawItemInterceptorContribution,new Canvas3DDrawItemInterceptor,new InteractiveDrawItemInterceptorContribution,new DebugDrawItemInterceptorContribution]}afterDrawItem(r,e,i,n,o){for(let l=0;l<this.interceptors.length;l++)if(this.interceptors[l].afterDrawItem&&this.interceptors[l].afterDrawItem(r,e,i,n,o))return!0;return!1}beforeDrawItem(r,e,i,n,o){if((!r.in3dMode||i.in3dInterceptor)&&!r.shadowRoot&&!(r.baseGraphic||r.attribute.globalZIndex||r.interactiveGraphic))return!1;for(let l=0;l<this.interceptors.length;l++)if(this.interceptors[l].beforeDrawItem&&this.interceptors[l].beforeDrawItem(r,e,i,n,o))return!0;return!1}};CommonDrawItemInterceptorContribution=__decorate$T([injectable(),__metadata$D("design:paramtypes",[])],CommonDrawItemInterceptorContribution);class InteractiveDrawItemInterceptorContribution{constructor(){this.order=1}beforeDrawItem(e,i,n,o,l){return!this.processing&&(e.baseGraphic?this.beforeDrawInteractive(e,i,n,o,l):this.beforeSetInteractive(e,i,n,o,l))}beforeSetInteractive(e,i,n,o,l){let d=e.interactiveGraphic;if(e.attribute.globalZIndex){d||(d=e.clone(),e.interactiveGraphic=d,d.baseGraphic=e),d.setAttributes({globalZIndex:0,zIndex:e.attribute.globalZIndex},!1,{skipUpdateCallback:!0}),n.stage.tryInitInteractiveLayer();const u=n.stage.getLayer("_builtin_interactive");return u&&this.getShadowRoot(u).add(d),!0}if(d){n.stage.tryInitInteractiveLayer();const u=n.stage.getLayer("_builtin_interactive");u&&this.getShadowRoot(u).removeChild(d),e.interactiveGraphic=null,d.baseGraphic=null}return!1}beforeDrawInteractive(e,i,n,o,l){const d=e.baseGraphic;let u=!!d.stage,f=d.parent;for(;u&&f&&f.stage!==f;)u=!!f.stage,f=f.parent;if(!u){const g=n.stage.getLayer("_builtin_interactive");return g&&this.getShadowRoot(g).removeChild(e),!0}if(d){this.processing=!0;const{context:g}=n;return g.highPerformanceSave(),g.setTransformFromMatrix(d.parent.globalTransMatrix,!0),d.isContainer?o.renderGroup(d,n,d.parent.globalTransMatrix):o.renderItem(d,n),g.highPerformanceRestore(),this.processing=!1,!0}return!1}getShadowRoot(e){var i;let n=e.getElementById("_interactive_group");return n||(n=graphicCreator.CreateGraphic("group",{}),n.id="_interactive_group",e.add(n)),(i=n.shadowRoot)!==null&&i!==void 0?i:n.attachShadow()}}class Canvas3DDrawItemInterceptor{constructor(){this.order=1}beforeDrawItem(e,i,n,o,l){if(!e.in3dMode||n.in3dInterceptor)return!1;n.in3dInterceptor=!0;const{context:d,stage:u}=i.drawParams;d.canvas,d.save(),this.initCanvasCtx(d),d.camera=u.camera;const f=d.currentMatrix;f.a/=d.dpr,f.b/=d.dpr,f.c/=d.dpr,f.d/=d.dpr,f.e/=d.dpr,f.f/=d.dpr;const g=mat4Allocate.allocate();mat3Tomat4(g,f);const _=d.modelMatrix;if(_){if(g){const y=mat4Allocate.allocate();d.modelMatrix=multiplyMat4Mat4(y,_,g)}}else d.modelMatrix=g;return d.setTransform(1,0,0,1,0,0,!0),e.isContainer?draw3dItem(d,e,(y,b)=>o.renderGroup(e,n,e.parent.globalTransMatrix,!y&&b),n):o.renderItem(e,n),d.camera=null,d.restore(),d.modelMatrix!==_&&mat4Allocate.free(d.modelMatrix),d.modelMatrix=_,n.in3dInterceptor=!1,!0}initCanvasCtx(e){e.setTransformForCurrent()}}var __decorate$S=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$C=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$t=function(r,e){return function(i,n){e(i,n,r)}};const RenderService=Symbol.for("RenderService");let DefaultRenderService=class{constructor(r){this.drawContribution=r}prepare(r){r&&this.renderTreeRoots.forEach(e=>{this._prepare(e,r)})}_prepare(r,e){r.forEachChildren(i=>{this._prepare(i,e)}),r.update({bounds:e,trans:!0})}prepareRenderList(){}beforeDraw(r){}draw(r){this.drawContribution.draw(this,Object.assign({},this.drawParams))}afterDraw(r){this.drawContribution.afterDraw&&this.drawContribution.afterDraw(this,Object.assign({},this.drawParams))}render(r,e){this.renderTreeRoots=r,this.drawParams=e;const i=e.updateBounds;this.prepare(i),this.prepareRenderList(),this.beforeDraw(e),this.draw(e),this.afterDraw(e),this.drawParams=null}};DefaultRenderService=__decorate$S([injectable(),__param$t(0,inject(DrawContribution)),__metadata$C("design:paramtypes",[Object])],DefaultRenderService);const renderModule$1=new ContainerModule(r=>{r(RenderService).to(DefaultRenderService)}),PickerService=Symbol.for("PickerService"),GlobalPickerService=Symbol.for("GlobalPickerService"),updateBoundsOfCommonOuterBorder=(r,e,i)=>{const{outerBorder:n,shadowBlur:o=e.shadowBlur}=r;if(n){const l=e.outerBorder,{distance:d=l.distance,lineWidth:u=l.lineWidth}=n;i.expand(d+(o+u)/2)}return i},CIRCLE_UPDATE_TAG_KEY=["radius","startAngle","endAngle",...GRAPHIC_UPDATE_TAG_KEY];class Circle extends Graphic{constructor(e={radius:1}){super(e),this.type="circle",this.numberType=CIRCLE_NUMBER_TYPE}isValid(){return super.isValid()&&this._isValid()}_isValid(){const{startAngle:e,endAngle:i,radius:n}=this.attribute;return this._validNumber(e)&&this._validNumber(i)&&this._validNumber(n)}getGraphicTheme(){return getTheme$1(this).circle}updateAABBBounds(e,i,n,o){this.updatePathProxyAABBBounds(n)||(o?this.updateCircleAABBBoundsImprecise(e,i,n):this.updateCircleAABBBoundsAccurate(e,i,n));const{tb1:l,tb2:d}=application.graphicService.updateTempAABBBounds(n);return updateBoundsOfCommonOuterBorder(e,i,l),n.union(l),l.setValue(d.x1,d.y1,d.x2,d.y2),application.graphicService.transformAABBBounds(e,n,i,!1,this),n}updateCircleAABBBoundsImprecise(e,i,n){const{radius:o=i.radius}=e;return n.set(-o,-o,o,o),n}updateCircleAABBBoundsAccurate(e,i,n){const{startAngle:o=i.startAngle,endAngle:l=i.endAngle,radius:d=i.radius}=e;return l-o>pi2-epsilon$1?n.set(-d,-d,d,d):circleBounds(o,l,d,n),n}needUpdateTags(e){return super.needUpdateTags(e,CIRCLE_UPDATE_TAG_KEY)}needUpdateTag(e){return super.needUpdateTag(e,CIRCLE_UPDATE_TAG_KEY)}toCustomPath(){var e,i,n;const o=this.attribute,l=(e=o.radius)!==null&&e!==void 0?e:this.getDefaultAttribute("radius"),d=(i=o.startAngle)!==null&&i!==void 0?i:this.getDefaultAttribute("startAngle"),u=(n=o.endAngle)!==null&&n!==void 0?n:this.getDefaultAttribute("endAngle"),f=new CustomPath2D;return f.arc(0,0,l,d,u),f}clone(){return new Circle(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return Circle.NOWORK_ANIMATE_ATTR}}Circle.NOWORK_ANIMATE_ATTR=NOWORK_ANIMATE_ATTR;function createCircle(r){return new Circle(r)}class CanvasTextLayout{constructor(e,i,n){this.fontFamily=e,this.textOptions=i,this.textMeasure=n}LayoutBBox(e,i,n,o){if(e.xOffset=i==="left"||i==="start"?0:i==="center"?e.width/-2:i==="right"||i==="end"?-e.width:0,n==="top")e.yOffset=0;else if(n==="middle")e.yOffset=e.height/-2;else if(n==="alphabetic"){let l=.79;if(o.length===1){const d=o[0];l=d.ascent/(d.ascent+d.descent)}e.yOffset=e.height*-l}else e.yOffset=-e.height;return e}GetLayoutByLines(e,i,n,o,l="",d,u){const{lineWidth:f,suffixPosition:g="end",measureMode:_=MeasureModeEnum.actualBounding,keepCenterInLine:y=!1}=u??{};e=e.map(A=>A.toString());const b=[],S=[0,0];if(typeof f=="number"&&f!==1/0){let A;for(let x=0,T=e.length;x<T;x++){const C=this.textMeasure.measureTextPixelADscentAndWidth(e[x],this.textOptions,_);let E=e[x].toString();if(C.width>f){const P=this.textMeasure.clipTextWithSuffix(e[x],this.textOptions,f,l,d,g);E=P.str,A=P.width}else A=C.width;b.push({str:E,width:A,ascent:C.ascent,descent:C.descent,keepCenterInLine:y})}S[0]=f}else{let A,x,T=0;for(let C=0,E=e.length;C<E;C++){x=e[C];const P=this.textMeasure.measureTextPixelADscentAndWidth(e[C],this.textOptions,_);A=P.width,T=Math.max(T,A),b.push({str:x,width:A,ascent:P.ascent,descent:P.descent,keepCenterInLine:y})}S[0]=T}S[1]=b.length*o,S[0]=b.reduce((A,x)=>Math.max(A,x.width),0);const v={xOffset:0,yOffset:0,width:S[0],height:S[1]};return this.LayoutBBox(v,i,n,b),this.layoutWithBBox(v,b,i,n,o)}layoutWithBBox(e,i,n,o,l){const d=[0,0],u=i.length*l;o==="top"||(o==="middle"?d[1]=(e.height-u)/2:o==="bottom"&&(d[1]=e.height-u));for(let f=0;f<i.length;f++)this.lineOffset(e,i[f],n,o,l,d);return{bbox:e,lines:i,fontFamily:this.fontFamily,fontSize:this.textOptions.fontSize,fontWeight:this.textOptions.fontWeight,lineHeight:l,textAlign:n,textBaseline:o}}lineOffset(e,i,n,o,l,d){if(n==="left"||n==="start"?i.leftOffset=0:n==="center"?i.leftOffset=(e.width-i.width)/2:n!=="right"&&n!=="end"||(i.leftOffset=e.width-i.width),i.topOffset=l/2+(i.ascent-i.descent)/2+d[1],!i.keepCenterInLine){const f=i.ascent+i.descent+0;if(f<l-0&&(o==="bottom"?i.topOffset+=(l-f)/2:o==="top"&&(i.topOffset-=(l-f)/2)),o==="alphabetic"){const g=l/(i.ascent+i.descent);i.topOffset=l/2+(i.ascent-i.descent)/2*g+d[1]}}return d[1]+=l,i}}const TEXT_UPDATE_TAG_KEY=["text","maxLineWidth","maxWidth","textAlign","textBaseline","heightLimit","lineClamp","fontSize","fontFamily","fontWeight","ellipsis","lineHeight","direction","wordBreak","heightLimit","lineClamp",...GRAPHIC_UPDATE_TAG_KEY];let Text$1=class Pe extends Graphic{get font(){const e=this.getGraphicTheme();return this._font||(this._font=getContextFont(this.attribute,e)),this._font}get clipedText(){var e;const i=this.attribute,n=this.getGraphicTheme(),o=this.getMaxWidth(n);return Number.isFinite(o)?(this.tryUpdateAABBBounds(),this.cache.clipedText):((e=i.text)!==null&&e!==void 0?e:n.text).toString()}get clipedWidth(){return this.tryUpdateAABBBounds(),this.cache.clipedWidth}get cliped(){var e,i;const n=this.getGraphicTheme(),o=this.attribute,l=this.getMaxWidth(n);if(!Number.isFinite(l))return!1;const{text:d}=this.attribute;if(this.tryUpdateAABBBounds(),(i=(e=this.cache)===null||e===void 0?void 0:e.layoutData)===null||i===void 0?void 0:i.lines){let u="";return this.cache.layoutData.lines.forEach(f=>{u+=f.str}),(Array.isArray(d)?d.join(""):d)!==u}return o.direction==="vertical"&&this.cache.verticalList&&this.cache.verticalList[0]?this.cache.verticalList[0].map(u=>u.text).join("")!==o.text.toString():this.clipedText!=null&&this.clipedText!==o.text.toString()}get multilineLayout(){return this.tryUpdateAABBBounds(),this.cache.layoutData}get isMultiLine(){return Array.isArray(this.attribute.text)||this.attribute.whiteSpace==="normal"}constructor(e={text:"",fontSize:16}){super(e),this.type="text",this.numberType=TEXT_NUMBER_TYPE,this.cache={}}isValid(){return super.isValid()&&this._isValid()}_isValid(){const{text:e}=this.attribute;return isArray(e)?!e.every(i=>i==null||i===""):e!=null&&e!==""}getGraphicTheme(){return getTheme$1(this).text}doUpdateOBBBounds(){const e=this.getGraphicTheme();this._OBBBounds.clear();const i=this.attribute,{angle:n=e.angle}=i;if(!n){const g=this.AABBBounds;return this._OBBBounds.setValue(g.x1,g.y1,g.x2,g.y2),this._OBBBounds}this.obbText||(this.obbText=new Pe({})),this.obbText.setAttributes(Object.assign(Object.assign({},i),{angle:0}));const o=this.obbText.AABBBounds,{x:l,y:d}=i,u={x:(o.x1+o.x2)/2,y:(o.y1+o.y2)/2},f=rotatePoint(u,n,{x:l,y:d});return this._OBBBounds.copy(o),this._OBBBounds.translate(f.x-u.x,f.y-u.y),this._OBBBounds.angle=n,this._OBBBounds}updateAABBBounds(e,i,n){const{text:o=i.text}=this.attribute;Array.isArray(o)?this.updateMultilineAABBBounds(o):this.updateSingallineAABBBounds(o);const{tb1:l}=application.graphicService.updateTempAABBBounds(n),{scaleX:d=i.scaleX,scaleY:u=i.scaleY,shadowBlur:f=i.shadowBlur,strokeBoundsBuffer:g=i.strokeBoundsBuffer}=e;if(f){const _=f/Math.abs(d+u);boundStroke(l,_,!0,g),n.union(l)}return application.graphicService.combindShadowAABBBounds(n,this),e.forceBoundsHeight==null&&e.forceBoundsWidth==null||application.graphicService.updateHTMLTextAABBBounds(e,i,n),transformBoundsWithMatrix(n,n,this.transMatrix),n}updateSingallineAABBBounds(e){this.updateMultilineAABBBounds([e]);const i=this.cache.layoutData;if(i&&i.lines&&i.lines.length){const n=i.lines[0];this.cache.clipedText=n.str,this.cache.clipedWidth=n.width}return this._AABBBounds}updateMultilineAABBBounds(e){const i=this.getGraphicTheme(),{direction:n=i.direction,underlineOffset:o=i.underlineOffset}=this.attribute,l=n==="horizontal"?this.updateHorizontalMultilineAABBBounds(e):this.updateVerticalMultilineAABBBounds(e);return n==="horizontal"&&o&&this._AABBBounds.add(this._AABBBounds.x1,this._AABBBounds.y2+o),l}guessLineHeightBuf(e){return e?.1*e:0}updateHorizontalMultilineAABBBounds(e){var i;const n=this.getGraphicTheme(),o=this.attribute,{fontFamily:l=n.fontFamily,textAlign:d=n.textAlign,textBaseline:u=n.textBaseline,fontSize:f=n.fontSize,fontWeight:g=n.fontWeight,ellipsis:_=n.ellipsis,maxLineWidth:y,stroke:b=n.stroke,wrap:S=n.wrap,measureMode:v=n.measureMode,lineWidth:A=n.lineWidth,whiteSpace:x=n.whiteSpace,suffixPosition:T=n.suffixPosition,ignoreBuf:C=n.ignoreBuf,keepCenterInLine:E=n.keepCenterInLine}=o,P=C?0:this.guessLineHeightBuf(f),R=this.getLineHeight(o,n,P);if(x==="normal"||S)return this.updateWrapAABBBounds(e);if(!this.shouldUpdateShape()&&(!((i=this.cache)===null||i===void 0)&&i.layoutData)){const I=this.cache.layoutData.bbox;return this._AABBBounds.set(I.xOffset,I.yOffset,I.xOffset+I.width,I.yOffset+I.height),b&&this._AABBBounds.expand(A/2),this._AABBBounds}const L=application.graphicUtil.textMeasure,w=new CanvasTextLayout(l,{fontSize:f,fontWeight:g,fontFamily:l,lineHeight:R},L).GetLayoutByLines(e,d,u,R,_===!0?n.ellipsis:_||void 0,!1,{lineWidth:y,suffixPosition:T,measureMode:v,keepCenterInLine:E}),{bbox:B}=w;return this.cache.layoutData=w,this.clearUpdateShapeTag(),this._AABBBounds.set(B.xOffset,B.yOffset,B.xOffset+B.width,B.yOffset+B.height),b&&this._AABBBounds.expand(A/2),this._AABBBounds}updateWrapAABBBounds(e){var i,n,o;const l=this.getGraphicTheme(),{fontFamily:d=l.fontFamily,textAlign:u=l.textAlign,textBaseline:f=l.textBaseline,fontSize:g=l.fontSize,ellipsis:_=l.ellipsis,maxLineWidth:y,stroke:b=l.stroke,lineWidth:S=l.lineWidth,wordBreak:v=l.wordBreak,fontWeight:A=l.fontWeight,ignoreBuf:x=l.ignoreBuf,measureMode:T=l.measureMode,suffixPosition:C=l.suffixPosition,heightLimit:E=0,lineClamp:P,keepCenterInLine:R=l.keepCenterInLine}=this.attribute,L=x?0:this.guessLineHeightBuf(g),w=this.getLineHeight(this.attribute,l,L);if(!this.shouldUpdateShape()&&(!((i=this.cache)===null||i===void 0)&&i.layoutData)){const G=this.cache.layoutData.bbox;return this._AABBBounds.set(G.xOffset,G.yOffset,G.xOffset+G.width,G.yOffset+G.height),b&&this._AABBBounds.expand(S/2),this._AABBBounds}const B=application.graphicUtil.textMeasure,I={fontSize:g,fontWeight:A,fontFamily:d,lineHeight:w},D=new CanvasTextLayout(d,I,B),O=isArray(e)?e.map(G=>G.toString()):[e.toString()],N=[],V=[0,0];let H=1/0;if(E>0&&(H=Math.max(Math.floor(E/w),1)),P&&(H=Math.min(H,P)),typeof y=="number"&&y!==1/0){if(y>0)for(let Y=0;Y<O.length;Y++){const Q=O[Y];let q=!0;if(Y===H-1){const fe=B.clipTextWithSuffix(Q,I,y,_,!1,C,Y!==O.length-1),pe=B.measureTextPixelADscentAndWidth(fe.str,I,T);N.push({str:fe.str,width:fe.width,ascent:pe.ascent,descent:pe.descent,keepCenterInLine:R});break}const te=B.clipText(Q,I,y,v!=="break-all",v==="keep-all");if(Q!==""&&te.str===""||te.wordBreaked){if(_){const fe=B.clipTextWithSuffix(Q,I,y,_,!1,C);te.str=(n=fe.str)!==null&&n!==void 0?n:"",te.width=(o=fe.width)!==null&&o!==void 0?o:0}else te.str="",te.width=0;q=!1}const ue=B.measureTextPixelADscentAndWidth(te.str,I,T);N.push({str:te.str,width:te.width,ascent:ue.ascent,descent:ue.descent,keepCenterInLine:R});let he=te.str.length;if(!te.wordBreaked||Q!==""&&te.str===""||(q=!0,he=te.wordBreaked),te.str.length!==Q.length){if(q){let fe=Q.substring(he);v==="keep-all"&&(fe=fe.replace(/^\s+/g,"")),O.splice(Y+1,0,fe)}}}let G=0;N.forEach(Y=>{G=Math.max(G,Y.width)}),V[0]=G}else{let G,Y,Q=0;for(let q=0,te=O.length;q<te;q++){if(q===H-1){const he=B.clipTextWithSuffix(O[q],I,y,_,!1,C),fe=B.measureTextPixelADscentAndWidth(he.str,I,T);N.push({str:he.str,width:he.width,ascent:fe.ascent,descent:fe.descent,keepCenterInLine:R}),Q=Math.max(Q,he.width);break}Y=O[q],G=B.measureTextWidth(Y,I),Q=Math.max(Q,G);const ue=B.measureTextPixelADscentAndWidth(Y,I,T);N.push({str:Y,width:G,ascent:ue.ascent,descent:ue.descent,keepCenterInLine:R})}V[0]=Q}V[1]=N.length*w;const F={xOffset:0,yOffset:0,width:V[0],height:V[1]};D.LayoutBBox(F,u,f,N);const $=D.layoutWithBBox(F,N,u,f,w);return this.cache.layoutData=$,this.clearUpdateShapeTag(),this._AABBBounds.set(F.xOffset,F.yOffset,F.xOffset+F.width,F.yOffset+F.height),b&&this._AABBBounds.expand(S/2),this._AABBBounds}updateVerticalMultilineAABBBounds(e){var i,n;const o=this.getGraphicTheme(),l=application.graphicUtil.textMeasure;let d;const u=this.attribute,{maxLineWidth:f=o.maxLineWidth,ellipsis:g=o.ellipsis,fontFamily:_=o.fontFamily,fontSize:y=o.fontSize,fontWeight:b=o.fontWeight,stroke:S=o.stroke,lineWidth:v=o.lineWidth,verticalMode:A=o.verticalMode,suffixPosition:x=o.suffixPosition}=u,T=this.getLineHeight(u,o,0);let{textAlign:C=o.textAlign,textBaseline:E=o.textBaseline}=u;if(!A){const B=C;C=(i=Pe.baselineMapAlign[E])!==null&&i!==void 0?i:"left",E=(n=Pe.alignMapBaseline[B])!==null&&n!==void 0?n:"top"}if(d=0,!this.shouldUpdateShape()&&this.cache){this.cache.verticalList.forEach(O=>{const N=O.reduce((V,H)=>V+H.width,0);d=max$1(N,d)});const B=textDrawOffsetX(C,d),I=this.cache.verticalList.length*T,D=textLayoutOffsetY(E,I,y);return this._AABBBounds.set(D,B,D+I,B+d),S&&this._AABBBounds.expand(v/2),this._AABBBounds}const P=e.map(B=>verticalLayout(B.toString()));P.forEach((B,I)=>{if(Number.isFinite(f))if(g){const D=g===!0?o.ellipsis:g,O=l.clipTextWithSuffixVertical(B,{fontSize:y,fontWeight:b,fontFamily:_},f,D,!1,x);P[I]=O.verticalList,d=O.width}else{const D=l.clipTextVertical(B,{fontSize:y,fontWeight:b,fontFamily:_},f,!1);P[I]=D.verticalList,d=D.width}else d=0,B.forEach(D=>{const O=D.direction===TextDirection.HORIZONTAL?y:l.measureTextWidth(D.text,{fontSize:y,fontWeight:b,fontFamily:_});d+=O,D.width=O})}),this.cache.verticalList=P,this.clearUpdateShapeTag(),this.cache.verticalList.forEach(B=>{const I=B.reduce((D,O)=>D+O.width,0);d=max$1(I,d)});const R=textDrawOffsetX(C,d),L=this.cache.verticalList.length*T,w=textLayoutOffsetY(E,L,y);return this._AABBBounds.set(w,R,w+L,R+d),S&&this._AABBBounds.expand(v/2),this._AABBBounds}getMaxWidth(e){var i,n;const o=this.attribute;return(n=(i=o.maxLineWidth)!==null&&i!==void 0?i:o.maxWidth)!==null&&n!==void 0?n:e.maxWidth}getLineHeight(e,i,n){var o;return(o=calculateLineHeight(e.lineHeight,e.fontSize||i.fontSize))!==null&&o!==void 0?o:(e.fontSize||i.fontSize)+n}needUpdateTags(e,i=TEXT_UPDATE_TAG_KEY){return super.needUpdateTags(e,i)}needUpdateTag(e,i=TEXT_UPDATE_TAG_KEY){return super.needUpdateTag(e,i)}clone(){return new Pe(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return Pe.NOWORK_ANIMATE_ATTR}getBaselineMapAlign(){return Pe.baselineMapAlign}getAlignMapBaseline(){return Pe.alignMapBaseline}};Text$1.NOWORK_ANIMATE_ATTR=Object.assign({ellipsis:1,wordBreak:1,direction:1,textAlign:1,textBaseline:1,fontFamily:1,fontWeight:1},NOWORK_ANIMATE_ATTR),Text$1.baselineMapAlign={top:"left",bottom:"right",middle:"center"},Text$1.alignMapBaseline={left:"top",right:"bottom",center:"middle"};function createText(r){return new Text$1(r)}class BaseSymbol{bounds(e,i){if(isNumber(e)){const n=e/2;i.x1=-n,i.x2=n,i.y1=-n,i.y2=n}else i.x1=-e[0]/2,i.x2=e[0]/2,i.y1=-e[1]/2,i.y2=e[1]/2}parseSize(e){return isNumber(e)?e:Math.min(e[0],e[1])}}function circle$1(r,e,i,n,o){return o?r.arc(i,n,e,0,tau$1,!1,o):r.arc(i,n,e,0,tau$1),!1}class CircleSymbol extends BaseSymbol{constructor(){super(...arguments),this.type="circle",this.pathStr="M0.5,0A0.5,0.5,0,1,1,-0.5,0A0.5,0.5,0,1,1,0.5,0"}draw(e,i,n,o,l){return circle$1(e,this.parseSize(i)/2,n,o,l)}drawOffset(e,i,n,o,l,d){return circle$1(e,this.parseSize(i)/2+l,n,o,d)}drawToSvgPath(e,i,n,o){const l=this.parseSize(e)/2;return`M ${i-l}, ${n} a ${l},${l} 0 1,0 ${2*l},0 a ${l},${l} 0 1,0 -${2*l},0`}}const circle$2=new CircleSymbol;function cross(r,e,i,n,o){return r.moveTo(-3*e+i,-e+n,o),r.lineTo(-e+i,-e+n,o),r.lineTo(-e+i,-3*e+n,o),r.lineTo(e+i,-3*e+n,o),r.lineTo(e+i,-e+n,o),r.lineTo(3*e+i,-e+n,o),r.lineTo(3*e+i,e+n,o),r.lineTo(e+i,e+n,o),r.lineTo(e+i,3*e+n,o),r.lineTo(-e+i,3*e+n,o),r.lineTo(-e+i,e+n,o),r.lineTo(-3*e+i,e+n,o),r.closePath(),!0}function crossOffset(r,e,i,n,o,l){return r.moveTo(-3*e+i-o,-e+n-o,l),r.lineTo(-e+i-o,-e+n-o,l),r.lineTo(-e+i-o,-3*e+n-o,l),r.lineTo(e+i+o,-3*e+n-o,l),r.lineTo(e+i+o,-e+n-o,l),r.lineTo(3*e+i+o,-e+n-o,l),r.lineTo(3*e+i+o,e+n+o,l),r.lineTo(e+i+o,e+n+o,l),r.lineTo(e+i+o,3*e+n+o,l),r.lineTo(-e+i-o,3*e+n+o,l),r.lineTo(-e+i-o,e+n+o,l),r.lineTo(-3*e+i-o,e+n+o,l),r.closePath(),!0}class CrossSymbol extends BaseSymbol{constructor(){super(...arguments),this.type="cross",this.pathStr="M-0.5,-0.2L-0.5,0.2L-0.2,0.2L-0.2,0.5L0.2,0.5L0.2,0.2L0.5,0.2L0.5,-0.2L0.2,-0.2L0.2,-0.5L-0.2,-0.5L-0.2,-0.2Z"}draw(e,i,n,o,l){return cross(e,this.parseSize(i)/6,n,o,l)}drawOffset(e,i,n,o,l,d){return crossOffset(e,this.parseSize(i)/6,n,o,l,d)}}const cross$1=new CrossSymbol;function diamond$1(r,e,i,n,o){return r.moveTo(i,n-e,o),r.lineTo(e+i,n,o),r.lineTo(i,n+e,o),r.lineTo(i-e,n,o),r.closePath(),!0}class DiamondSymbol extends BaseSymbol{constructor(){super(...arguments),this.type="diamond",this.pathStr="M-0.5,0L0,-0.5L0.5,0L0,0.5Z"}draw(e,i,n,o,l){return diamond$1(e,this.parseSize(i)/2,n,o,l)}drawFitDir(e,i,n,o,l){return diamond$1(e,this.parseSize(i)/2,n,o,l)}drawOffset(e,i,n,o,l,d){return diamond$1(e,this.parseSize(i)/2+l,n,o,d)}}const diamond$2=new DiamondSymbol;function square$2(r,e,i,n){const o=2*e;return r.rect(i-e,n-e,o,o),!1}class SquareSymbol extends BaseSymbol{constructor(){super(...arguments),this.type="square",this.pathStr="M-0.5,-0.5h1v1h-1Z"}draw(e,i,n,o){return square$2(e,this.parseSize(i)/2,n,o)}drawOffset(e,i,n,o,l){return square$2(e,this.parseSize(i)/2+l,n,o)}}const square$3=new SquareSymbol;function trianglUpOffset(r,e,i,n,o=0){return r.moveTo(i+e+2*o,e+n+o),r.lineTo(i-e-2*o,e+n+o),r.lineTo(i,n-e-2*o),r.closePath(),!0}class TriangleUpSymbol extends BaseSymbol{constructor(){super(...arguments),this.type="triangleUp",this.pathStr="M0.5,0.5 L-0.5,0.5 L0,-0.5 Z"}draw(e,i,n,o){return trianglUpOffset(e,this.parseSize(i)/2,n,o)}drawOffset(e,i,n,o,l){return trianglUpOffset(e,this.parseSize(i)/2,n,o,l)}}const triangleUp=new TriangleUpSymbol;class TriangleSymbol extends TriangleUpSymbol{constructor(){super(...arguments),this.type="triangle"}}const triangle$1=new TriangleSymbol,kr=Math.sin(Math.PI/10)/Math.sin(7*Math.PI/10),kx=Math.sin(tau$1/10)*kr,ky=-Math.cos(tau$1/10)*kr;function star$1(r,e,i,n){const o=kx*e,l=ky*e;r.moveTo(i,-e+n),r.lineTo(o+i,l+n);for(let d=1;d<5;++d){const u=tau$1*d/5,f=Math.cos(u),g=Math.sin(u);r.lineTo(g*e+i,-f*e+n),r.lineTo(f*o-g*l+i,g*o+f*l+n)}return r.closePath(),!0}class StarSymbol extends BaseSymbol{constructor(){super(...arguments),this.type="star",this.pathStr="M0 -1L0.22451398828979266 -0.3090169943749474L0.9510565162951535 -0.30901699437494745L0.3632712640026804 0.1180339887498948L0.5877852522924732 0.8090169943749473L8.326672684688674e-17 0.3819660112501051L-0.587785252292473 0.8090169943749476L-0.3632712640026804 0.11803398874989487L-0.9510565162951536 -0.30901699437494723L-0.22451398828979274 -0.30901699437494734Z"}draw(e,i,n,o){return star$1(e,this.parseSize(i)/2,n,o)}drawOffset(e,i,n,o,l){return star$1(e,this.parseSize(i)/2+l,n,o)}}const star$2=new StarSymbol,sqrt3$1=sqrt$3(3);function arrow(r,e,i,n){const o=e,l=o/sqrt3$1,d=l/5,u=e;return r.moveTo(0+i,-o+n),r.lineTo(l/2+i,n),r.lineTo(d/2+i,n),r.lineTo(d/2+i,u+n),r.lineTo(-d/2+i,u+n),r.lineTo(-d/2+i,n),r.lineTo(-l/2+i,n),r.closePath(),!0}class ArrowSymbol extends BaseSymbol{constructor(){super(...arguments),this.type="arrow",this.pathStr="M-0.07142857142857142,0.5L0.07142857142857142,0.5L0.07142857142857142,-0.0625L0.2,-0.0625L0,-0.5L-0.2,-0.0625L-0.07142857142857142,-0.0625Z"}draw(e,i,n,o){return arrow(e,this.parseSize(i)/2,n,o)}drawOffset(e,i,n,o,l){return arrow(e,this.parseSize(i)/2+l,n,o)}}const arrow$1=new ArrowSymbol;function wedge(r,e,i,n){const o=2*e;return r.moveTo(i,-e+n),r.lineTo(o/3/2+i,e+n),r.lineTo(-o/3/2+i,e+n),r.closePath(),!0}class WedgeSymbol extends BaseSymbol{constructor(){super(...arguments),this.type="wedge",this.pathStr="M0,-0.5773502691896257L-0.125,0.28867513459481287L0.125,0.28867513459481287Z"}draw(e,i,n,o){return wedge(e,this.parseSize(i)/2,n,o)}drawOffset(e,i,n,o,l){return wedge(e,this.parseSize(i)/2+l,n,o)}}const wedge$1=new WedgeSymbol;function stroke(r,e,i,n){return r.moveTo(-e+i,n),r.lineTo(i,e+n),!1}class StrokeSymbol extends BaseSymbol{constructor(){super(...arguments),this.type="stroke",this.pathStr=""}draw(e,i,n,o){return stroke(e,this.parseSize(i)/2,n,o)}drawOffset(e,i,n,o,l){return stroke(e,this.parseSize(i)/2+l,n,o)}}const stroke$1=new StrokeSymbol,c$1=-.5,s=sqrt$3(3)/2,k=1/sqrt$3(12);function wye(r,e,i,n){const o=e/2,l=e*k,d=o,u=e*k+e,f=-d,g=u;return r.moveTo(o+i,l+n),r.lineTo(d+i,u+n),r.lineTo(f+i,g+n),r.lineTo(c$1*o-s*l+i,s*o+c$1*l+n),r.lineTo(c$1*d-s*u+i,s*d+c$1*u+n),r.lineTo(c$1*f-s*g+i,s*f+c$1*g+n),r.lineTo(c$1*o+s*l+i,c$1*l-s*o+n),r.lineTo(c$1*d+s*u+i,c$1*u-s*d+n),r.lineTo(c$1*f+s*g+i,c$1*g-s*f+n),r.closePath(),!1}class WyeSymbol extends BaseSymbol{constructor(){super(...arguments),this.type="wye",this.pathStr="M0.25 0.14433756729740646L0.25 0.6443375672974064L-0.25 0.6443375672974064L-0.25 0.14433756729740643L-0.6830127018922193 -0.10566243270259357L-0.4330127018922193 -0.5386751345948129L0 -0.28867513459481287L0.4330127018922193 -0.5386751345948129L0.6830127018922193 -0.10566243270259357Z"}draw(e,i,n,o){return wye(e,this.parseSize(i)/2,n,o)}drawOffset(e,i,n,o,l){return wye(e,this.parseSize(i)/2+l,n,o)}}const wye$1=new WyeSymbol;function trianglLeftOffset(r,e,i,n,o){return r.moveTo(-e+i-2*o,n),r.lineTo(e+i+o,e+n+2*o),r.lineTo(e+i+o,n-e-2*o),r.closePath(),!0}class TriangleLeftSymbol extends BaseSymbol{constructor(){super(...arguments),this.type="triangleLeft",this.pathStr="M-0.5,0 L0.5,0.5 L0.5,-0.5 Z"}draw(e,i,n,o){return trianglLeftOffset(e,this.parseSize(i)/2,n,o,0)}drawOffset(e,i,n,o,l){return trianglLeftOffset(e,this.parseSize(i)/2,n,o,l)}}const triangleLeft=new TriangleLeftSymbol;function trianglRightOffset(r,e,i,n,o=0){return r.moveTo(i-e-o,e+n+2*o),r.lineTo(e+i+2*o,n),r.lineTo(i-e-o,n-e-2*o),r.closePath(),!0}class TriangleRightSymbol extends BaseSymbol{constructor(){super(...arguments),this.type="triangleRight",this.pathStr="M-0.5,0.5 L0.5,0 L-0.5,-0.5 Z"}draw(e,i,n,o){return trianglRightOffset(e,this.parseSize(i)/2,n,o)}drawOffset(e,i,n,o,l){return trianglRightOffset(e,this.parseSize(i)/2,n,o,l)}}const triangleRight=new TriangleRightSymbol;function trianglDownOffset(r,e,i,n,o=0){return r.moveTo(i-e-2*o,n-e-o),r.lineTo(i+e+2*o,n-e-o),r.lineTo(i,n+e+2*o),r.closePath(),!0}class TriangleDownSymbol extends BaseSymbol{constructor(){super(...arguments),this.type="triangleDown",this.pathStr="M-0.5,-0.5 L0.5,-0.5 L0,0.5 Z"}draw(e,i,n,o){return trianglDownOffset(e,this.parseSize(i)/2,n,o)}drawOffset(e,i,n,o,l){return trianglDownOffset(e,this.parseSize(i)/2,n,o,l)}}const triangleDown=new TriangleDownSymbol,sqrt3=sqrt$3(3);function thinTriangle(r,e,i,n){const o=e*sqrt3;return r.moveTo(i,n+-o/3*2),r.lineTo(e+i,n+o),r.lineTo(i-e,n+o),r.closePath(),!0}class ThinTriangleSymbol extends BaseSymbol{constructor(){super(...arguments),this.type="thinTriangle",this.pathStr="M0,-0.5773502691896257L-0.5,0.28867513459481287L0.5,0.28867513459481287Z"}draw(e,i,n,o){return thinTriangle(e,this.parseSize(i)/2/sqrt3,n,o)}drawOffset(e,i,n,o,l){return thinTriangle(e,this.parseSize(i)/2/sqrt3+l,n,o)}}const thinTriangle$1=new ThinTriangleSymbol;function arrow2Left(r,e,i,n){const o=2*e;return r.moveTo(e+i,n-o),r.lineTo(i-e,n),r.lineTo(e+i,o+n),!0}class Arrow2LeftSymbol extends BaseSymbol{constructor(){super(...arguments),this.type="arrow2Left",this.pathStr="M 0.25 -0.5 L -0.25 0 l 0.25 0.5"}draw(e,i,n,o){return arrow2Left(e,this.parseSize(i)/4,n,o)}drawOffset(e,i,n,o,l){return arrow2Left(e,this.parseSize(i)/4+l,n,o)}}const arrow2Left$1=new Arrow2LeftSymbol;function arrow2Right(r,e,i,n){const o=2*e;return r.moveTo(i-e,n-o),r.lineTo(i+e,n),r.lineTo(i-e,o+n),!0}class Arrow2RightSymbol extends BaseSymbol{constructor(){super(...arguments),this.type="arrow2Right",this.pathStr="M -0.25 -0.5 l 0.25 0 l -0.25 0.5"}draw(e,i,n,o){return arrow2Right(e,this.parseSize(i)/4,n,o)}drawOffset(e,i,n,o,l){return arrow2Right(e,this.parseSize(i)/4+l,n,o)}}const arrow2Right$1=new Arrow2RightSymbol;function arrow2Up(r,e,i,n){const o=2*e;return r.moveTo(i-o,n+e),r.lineTo(i,n-e),r.lineTo(i+o,n+e),!0}class Arrow2UpSymbol extends BaseSymbol{constructor(){super(...arguments),this.type="arrow2Up",this.pathStr="M -0.5 0.25 L 0 -0.25 l 0.5 0.25"}draw(e,i,n,o){return arrow2Up(e,this.parseSize(i)/4,n,o)}drawOffset(e,i,n,o,l){return arrow2Up(e,this.parseSize(i)/4+l,n,o)}}const arrow2Up$1=new Arrow2UpSymbol;function arrow2Down(r,e,i,n){const o=2*e;return r.moveTo(i-o,n-e),r.lineTo(i,n+e),r.lineTo(i+o,n-e),!0}class Arrow2DownSymbol extends BaseSymbol{constructor(){super(...arguments),this.type="arrow2Down",this.pathStr="M -0.5 -0.25 L 0 0.25 l 0.5 -0.25"}draw(e,i,n,o){return arrow2Down(e,this.parseSize(i)/4,n,o)}drawOffset(e,i,n,o,l){return arrow2Down(e,this.parseSize(i)/4+l,n,o)}}const arrow2Down$1=new Arrow2DownSymbol;function lineV(r,e,i,n,o){return r.moveTo(i,n-e),r.lineTo(i,n+e),!0}class LineVSymbol extends BaseSymbol{constructor(){super(...arguments),this.type="lineV",this.pathStr="M0,-0.5L0,0.5"}draw(e,i,n,o,l){return lineV(e,this.parseSize(i)/2,n,o)}drawOffset(e,i,n,o,l,d){return lineV(e,this.parseSize(i)/2+l,n,o)}drawToSvgPath(e,i,n,o){const l=this.parseSize(e)/2;return`M ${i}, ${n-l} L ${i},${n+l}`}}const lineV$1=new LineVSymbol;function lineH(r,e,i,n,o){return r.moveTo(i-e,n),r.lineTo(i+e,n),!0}class LineHSymbol extends BaseSymbol{constructor(){super(...arguments),this.type="lineH",this.pathStr="M-0.5,0L0.5,0"}draw(e,i,n,o,l){return lineH(e,this.parseSize(i)/2,n,o)}drawOffset(e,i,n,o,l,d){return lineH(e,this.parseSize(i)/2+l,n,o)}drawToSvgPath(e,i,n,o){const l=this.parseSize(e)/2;return`M ${i-l}, ${n} L ${i+l},${n}`}}const lineH$1=new LineHSymbol;function close(r,e,i,n,o){return r.moveTo(i-e,n-e),r.lineTo(i+e,n+e),r.moveTo(i+e,n-e),r.lineTo(i-e,n+e),!0}class CloseSymbol extends BaseSymbol{constructor(){super(...arguments),this.type="close",this.pathStr="M-0.5,-0.5L0.5,0.5,M0.5,-0.5L-0.5,0.5"}draw(e,i,n,o,l){return close(e,this.parseSize(i)/2,n,o)}drawOffset(e,i,n,o,l,d){return close(e,this.parseSize(i)/2+l,n,o)}drawToSvgPath(e,i,n,o){const l=this.parseSize(e)/2;return`M ${i-l}, ${n-l} L ${i+l},${n+l} M ${i+l}, ${n-l} L ${i-l},${n+l}`}}const close$1=new CloseSymbol;function rectSizeArray(r,e,i,n){return r.rect(i-e[0]/2,n-e[1]/2,e[0],e[1]),!1}function rectSize(r,e,i,n){const o=e,l=e/2;return r.rect(i-o/2,n-l/2,o,l),!1}class RectSymbol extends BaseSymbol{constructor(){super(...arguments),this.type="rect",this.pathStr="M -0.5,0.25 L 0.5,0.25 L 0.5,-0.25,L -0.5,-0.25 Z"}draw(e,i,n,o){return isNumber(i)?rectSize(e,i,n,o):rectSizeArray(e,i,n,o)}drawOffset(e,i,n,o,l){return isNumber(i)?rectSize(e,i+2*l,n,o):rectSizeArray(e,[i[0]+2*l,i[1]+2*l],n,o)}}const rect=new RectSymbol,tempBounds=new AABBBounds;class CustomSymbolClass{constructor(e,i,n=!1){this.pathStr="",this.type=e,isArray(i)?this.svgCache=i:this.path=i,this.isSvg=n}drawOffset(e,i,n,o,l,d,u){return i=this.parseSize(i),this.isSvg?!!this.svgCache&&(this.svgCache.forEach(f=>{e.beginPath(),renderCommandList(f.path.commandList,e,n,o,i,i),u&&u(f.path,f.attribute)}),!1):(renderCommandList(this.path.commandList,e,n,o,i+l,i+l),!1)}draw(e,i,n,o,l,d){return i=this.parseSize(i),this.drawOffset(e,i,n,o,0,l,d)}parseSize(e){return isNumber(e)?e:Math.min(e[0],e[1])}bounds(e,i){if(e=this.parseSize(e),this.isSvg)return this.svgCache?(i.clear(),void this.svgCache.forEach(({path:n})=>{tempBounds.x1=n.bounds.x1*e,tempBounds.y1=n.bounds.y1*e,tempBounds.x2=n.bounds.x2*e,tempBounds.y2=n.bounds.y2*e,i.union(tempBounds)})):void 0;this.path.bounds&&(i.x1=this.path.bounds.x1*e,i.y1=this.path.bounds.y1*e,i.x2=this.path.bounds.x2*e,i.y2=this.path.bounds.y2*e)}}const builtinSymbols=[circle$2,cross$1,diamond$2,square$3,thinTriangle$1,triangle$1,star$2,arrow$1,wedge$1,stroke$1,wye$1,triangleLeft,triangleRight,triangleUp,triangleDown,arrow2Left$1,arrow2Right$1,arrow2Up$1,arrow2Down$1,rect,lineV$1,lineH$1,close$1],builtinSymbolsMap={};builtinSymbols.forEach(r=>{builtinSymbolsMap[r.type]=r});const builtInSymbolStrMap={arrowLeft:"M 0.25 -0.5 L -0.25 0 l 0.5 0.5",arrowRight:"M -0.25 -0.5 l 0.5 0.5 l -0.5 0.5",rectRound:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",roundLine:"M 1.2392 -0.258 L -1.3432 -0.258 C -1.4784 -0.258 -1.588 -0.1436 -1.588 -0.002 c 0 0.1416 0.1096 0.256 0.2448 0.256 l 2.5824 0 c 0.1352 0 0.2448 -0.1144 0.2448 -0.256 C 1.484 -0.1436 1.3744 -0.258 1.2392 -0.258 z"},updateBoundsOfSymbolOuterBorder=(r,e,i)=>{const{outerBorder:n,shadowBlur:o=e.shadowBlur,strokeBoundsBuffer:l=e.strokeBoundsBuffer}=r;if(n){const d=e.outerBorder,{distance:u=d.distance,lineWidth:f=d.lineWidth}=n;boundStroke(i,u+(o+f)/2,!0,l)}return i},_tempBounds=new AABBBounds,SYMBOL_UPDATE_TAG_KEY=["symbolType","size",...GRAPHIC_UPDATE_TAG_KEY];let Symbol$1=class Le extends Graphic{constructor(e={symbolType:"circle"}){super(e),this.type="symbol",this.numberType=SYMBOL_NUMBER_TYPE}getParsedPath(){return this.shouldUpdateShape()&&(this.doUpdateParsedPath(),this.clearUpdateShapeTag()),this._parsedPath}isValid(){return super.isValid()&&this._isValid()}_isValid(){const{size:e}=this.attribute;return isArray(e)?e.length===2&&e.every(this._validNumber):this._validNumber(e)}doUpdateParsedPath(){const e=this.getGraphicTheme();let{symbolType:i=e.symbolType}=this.attribute,n=builtinSymbolsMap[i];if(n)return this._parsedPath=n,n;if(n=Le.userSymbolMap[i],n)return this._parsedPath=n,n;if(i=builtInSymbolStrMap[i]||i,isSvg(i)===!0){const f=new XMLParser,{svg:g}=f.parse(i);if(!g)return null;const _=isArray(g.path)?g.path:[g.path];_tempBounds.clear();const y=[];_.forEach(A=>{const x=new CustomPath2D().fromString(A.d),T={};SVG_PARSE_ATTRIBUTE_MAP_KEYS.forEach(C=>{A[C]&&(T[SVG_PARSE_ATTRIBUTE_MAP[C]]=A[C])}),y.push({path:x,attribute:T}),_tempBounds.union(x.bounds)});const b=_tempBounds.width(),S=_tempBounds.height(),v=1/max$1(b,S);return y.forEach(A=>A.path.transform(0,0,v,v)),this._parsedPath=new CustomSymbolClass(i,y,!0),Le.userSymbolMap[i]=this._parsedPath,this._parsedPath}const o=new CustomPath2D().fromString(i),l=o.bounds.width(),d=o.bounds.height(),u=1/max$1(l,d);return o.transform(0,0,u,u),this._parsedPath=new CustomSymbolClass(i,o),Le.userSymbolMap[i]=this._parsedPath,this._parsedPath}getGraphicTheme(){return getTheme$1(this).symbol}updateAABBBounds(e,i,n,o){this.updatePathProxyAABBBounds(n)||(o?this.updateSymbolAABBBoundsImprecise(e,i,n):this.updateSymbolAABBBoundsAccurate(e,i,n));const{tb1:l,tb2:d}=application.graphicService.updateTempAABBBounds(n);updateBoundsOfSymbolOuterBorder(e,i,l),n.union(l),l.setValue(d.x1,d.y1,d.x2,d.y2);const{lineJoin:u=i.lineJoin}=e;return application.graphicService.transformAABBBounds(e,n,i,u==="miter",this),n}updateSymbolAABBBoundsImprecise(e,i,n){const{size:o=i.size}=e;if(isArray(o))n.set(-o[0]/2,-o[1]/2,o[0]/2,o[1]/2);else{const l=o/2;n.set(-l,-l,l,l)}return n}updateSymbolAABBBoundsAccurate(e,i,n){const{size:o=i.size}=e;return this.getParsedPath().bounds(o,n),n}needUpdateTags(e){return super.needUpdateTags(e,SYMBOL_UPDATE_TAG_KEY)}needUpdateTag(e){return super.needUpdateTag(e,SYMBOL_UPDATE_TAG_KEY)}toCustomPath(){const e=this.getParsedPath(),i=this.attribute.size,n=isArray(i)?i:[i,i];return e.path?new CustomPath2D().fromCustomPath2D(e.path,0,0,n[0],n[1]):new CustomPath2D().fromString(e.pathStr,0,0,n[0],n[1])}clone(){return new Le(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return Le.NOWORK_ANIMATE_ATTR}};Symbol$1.userSymbolMap={},Symbol$1.NOWORK_ANIMATE_ATTR=Object.assign({symbolType:1},NOWORK_ANIMATE_ATTR);function createSymbol(r){return new Symbol$1(r)}const LINE_UPDATE_TAG_KEY=["segments","points","curveType","curveTension",...GRAPHIC_UPDATE_TAG_KEY];let Line$1=class Be extends Graphic{constructor(e={}){super(e),this.type="line",this.numberType=LINE_NUMBER_TYPE}isValid(){return super.isValid()&&this._isValid()}_isValid(){if(this.pathProxy)return!0;const{points:e,segments:i}=this.attribute;return i?i.length!==0:!!e&&!(e.length<=1)}_interpolate(e,i,n,o,l){e==="points"&&(l.points=pointsInterpolation(n,o,i))}getGraphicTheme(){return getTheme$1(this).line}updateAABBBounds(e,i,n){this.updatePathProxyAABBBounds(n)||(e.segments?this.updateLineAABBBoundsBySegments(e,i,n):this.updateLineAABBBoundsByPoints(e,i,n)),application.graphicService.updateTempAABBBounds(n);const{lineJoin:o=i.lineJoin}=e;return application.graphicService.transformAABBBounds(e,n,i,o==="miter",this),n}updateLineAABBBoundsByPoints(e,i,n,o){const{points:l=i.points,connectedType:d}=e,u=n;return l.forEach(f=>{f.defined===!1&&d!=="connect"||u.add(f.x,f.y)}),u}updateLineAABBBoundsBySegments(e,i,n,o){const{segments:l=i.segments,connectedType:d}=e,u=n;return l.forEach(f=>{f.points.forEach(g=>{g.defined===!1&&d!=="connect"||u.add(g.x,g.y)})}),u}needUpdateTags(e){return super.needUpdateTags(e,LINE_UPDATE_TAG_KEY)}needUpdateTag(e){return super.needUpdateTag(e,LINE_UPDATE_TAG_KEY)}toCustomPath(){const e=this.attribute,i=new CustomPath2D,n=e.segments,o=l=>{if(l&&l.length){let d=!0;l.forEach(u=>{u.defined!==!1&&(d?i.moveTo(u.x,u.y):i.lineTo(u.x,u.y),d=!1)})}};return n&&n.length?n.forEach(l=>{o(l.points)}):e.points&&o(e.points),i}clone(){return new Be(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return Be.NOWORK_ANIMATE_ATTR}};Line$1.NOWORK_ANIMATE_ATTR=Object.assign({segments:1,curveType:1},NOWORK_ANIMATE_ATTR);function createLine(r){return new Line$1(r)}const RECT_UPDATE_TAG_KEY=["width","x1","y1","height","cornerRadius",...GRAPHIC_UPDATE_TAG_KEY];class Rect extends Graphic{constructor(e){super(e),this.type="rect",this.numberType=RECT_NUMBER_TYPE}isValid(){return super.isValid()&&this._isValid()}_isValid(){return!0}getGraphicTheme(){return getTheme$1(this).rect}updateAABBBounds(e,i,n){if(!this.updatePathProxyAABBBounds(n)){let{width:d,height:u}=e;const{x1:f,y1:g,x:_,y}=e;d=d??f-_,u=u??g-y,(isFinite(d)||isFinite(u)||isFinite(_)||isFinite(y))&&n.set(0,0,d||0,u||0)}const{tb1:o,tb2:l}=application.graphicService.updateTempAABBBounds(n);return updateBoundsOfCommonOuterBorder(e,i,o),n.union(o),o.setValue(l.x1,l.y1,l.x2,l.y2),application.graphicService.transformAABBBounds(e,n,i,!1,this),n}needUpdateTags(e){return super.needUpdateTags(e,RECT_UPDATE_TAG_KEY)}needUpdateTag(e){return super.needUpdateTag(e,RECT_UPDATE_TAG_KEY)}toCustomPath(){const e=this.attribute,{x:i,y:n,width:o,height:l}=normalizeRectAttributes(e),d=new CustomPath2D;return d.moveTo(i,n),d.rect(i,n,o,l),d}clone(){return new Rect(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return Rect.NOWORK_ANIMATE_ATTR}}Rect.NOWORK_ANIMATE_ATTR=NOWORK_ANIMATE_ATTR;function createRect(r){return new Rect(r)}const CUBE_VERTICES=[[0,0,0],[1,0,0],[1,1,0],[0,1,0],[0,0,1],[1,0,1],[1,1,1],[0,1,1]];class Rect3d extends Rect{constructor(e){super(e),this.type="rect3d",this.numberType=RECT3D_NUMBER_TYPE}findFace(){const e={polygons:[],vertices:[],edges:[]},i=this.getGraphicTheme(),{x1:n,y1:o,x:l,y:d,length:u=min$1(i.width,i.height)}=this.attribute;let{width:f,height:g}=this.attribute;f=f??n-l,g=g??o-d;for(let _=0;_<CUBE_VERTICES.length;_++){const y=CUBE_VERTICES[_];e.vertices.push([y[0]*f,y[1]*g,y[2]*u])}return e.polygons.push({polygon:[0,1,5,4],normal:[0,-1,0]}),e.polygons.push({polygon:[2,3,7,6],normal:[0,1,0]}),e.polygons.push({polygon:[4,7,3,0],normal:[-1,0,0]}),e.polygons.push({polygon:[1,2,6,5],normal:[1,0,0]}),e.polygons.push({polygon:[0,1,2,3],normal:[0,0,-1]}),e.polygons.push({polygon:[4,5,6,7],normal:[0,0,1]}),e.edges=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[3,7],[1,5],[2,6]],e}getNoWorkAnimateAttr(){return Rect3d.NOWORK_ANIMATE_ATTR}}Rect3d.NOWORK_ANIMATE_ATTR=NOWORK_ANIMATE_ATTR;function createRect3d(r){return new Rect3d(r)}class Glyph extends Graphic{constructor(e){super(e),this.type="glyph",this.numberType=GLYPH_NUMBER_TYPE,this.subGraphic=[],this._onInit&&this._onInit(this),this.valid=this.isValid()}setSubGraphic(e){this.detachSubGraphic(),this.subGraphic=e,e.forEach(i=>{i.glyphHost=this,Object.setPrototypeOf(i.attribute,this.attribute)}),this.valid=this.isValid(),this.addUpdateBoundTag()}detachSubGraphic(){this.subGraphic.forEach(e=>{e.glyphHost=null,Object.setPrototypeOf(e.attribute,{})})}getSubGraphic(){return this.subGraphic}onInit(e){this._onInit=e}onUpdate(e){this._onUpdate=e}isValid(){return!0}setAttribute(e,i,n,o){super.setAttribute(e,i,n,o),this.subGraphic.forEach(l=>{l.addUpdateShapeAndBoundsTag(),l.addUpdatePositionTag()})}setAttributes(e,i=!1,n){super.setAttributes(e,i,n),this.subGraphic.forEach(o=>{o.addUpdateShapeAndBoundsTag(),o.addUpdatePositionTag()})}translate(e,i){return super.translate(e,i),this.subGraphic.forEach(n=>{n.addUpdatePositionTag(),n.addUpdateBoundTag()}),this}translateTo(e,i){return super.translateTo(e,i),this.subGraphic.forEach(n=>{n.addUpdatePositionTag(),n.addUpdateBoundTag()}),this}scale(e,i,n){return super.scale(e,i,n),this.subGraphic.forEach(o=>{o.addUpdatePositionTag(),o.addUpdateBoundTag()}),this}scaleTo(e,i){return super.scaleTo(e,i),this.subGraphic.forEach(n=>{n.addUpdatePositionTag(),n.addUpdateBoundTag()}),this}rotate(e){return super.rotate(e),this.subGraphic.forEach(i=>{i.addUpdatePositionTag(),i.addUpdateBoundTag()}),this}rotateTo(e){return super.rotate(e),this.subGraphic.forEach(i=>{i.addUpdatePositionTag(),i.addUpdateBoundTag()}),this}getGraphicTheme(){return getTheme$1(this).glyph}updateAABBBounds(e,i,n){return this.getSubGraphic().forEach(o=>{n.union(o.AABBBounds)}),n}doUpdateAABBBounds(){this.updateAABBBoundsStamp++,this._AABBBounds.clear();const e=this.updateAABBBounds(this.attribute,this.getGraphicTheme(),this._AABBBounds);return this.clearUpdateBoundTag(),e}needUpdateTags(e){return!1}needUpdateTag(e){return!1}useStates(e,i){var n;if(!e.length)return void this.clearStates(i);if(!(((n=this.currentStates)===null||n===void 0?void 0:n.length)!==e.length||e.some((d,u)=>this.currentStates[u]!==d)))return;this.stopStateAnimates();const o={},l=this.subGraphic.map(()=>({}));e.forEach(d=>{var u;const f=this.glyphStateProxy?this.glyphStateProxy(d,e):this.glyphStates[d];f&&(Object.assign(o,f.attributes),!((u=f.subAttributes)===null||u===void 0)&&u.length&&l.forEach((g,_)=>{Object.assign(g,f.subAttributes[_])}))}),this.subGraphic.forEach((d,u)=>{d.updateNormalAttrs(l[u]),d.applyStateAttrs(l[u],e,i)}),this.updateNormalAttrs(o),this.currentStates=e,this.applyStateAttrs(o,e,i)}clearStates(e){this.stopStateAnimates(),this.hasState()&&this.normalAttrs?(this.currentStates=[],this.subGraphic.forEach(i=>{i.applyStateAttrs(i.normalAttrs,this.currentStates,e,!0),i.normalAttrs=null}),this.applyStateAttrs(this.normalAttrs,this.currentStates,e,!0)):this.currentStates=[],this.normalAttrs=null}clone(){const e=new Glyph(Object.assign({},this.attribute));return e.setSubGraphic(this.subGraphic.map(i=>i.clone())),e}getNoWorkAnimateAttr(){return Glyph.NOWORK_ANIMATE_ATTR}}Glyph.NOWORK_ANIMATE_ATTR=NOWORK_ANIMATE_ATTR;function createGlyph(r){return new Glyph(r)}class Frame{constructor(e,i,n,o,l,d,u,f,g,_,y,b,S,v){this.left=e,this.top=i,this.width=n,this.height=o,this.actualHeight=0,this.bottom=i+o,this.right=e+n,this.ellipsis=l,this.wordBreak=d,this.verticalDirection=u,this.lines=[],this.globalAlign=f,this.globalBaseline=g,this.layoutDirection=_,this.directionKey=DIRECTION_KEY[this.layoutDirection],this.isWidthMax=y,this.isHeightMax=b,this.singleLine=S,v?(v.clear(),this.icons=v):this.icons=new Map}draw(e,i){const{width:n,height:o}=this.getActualSize(),l=this.isWidthMax?Math.min(this.width,n):this.width||n||0;let d=this.isHeightMax?Math.min(this.height,o):this.height||o||0;d=Math.min(d,o);let u=0;switch(this.globalBaseline){case"top":u=0;break;case"middle":u=-d/2;break;case"bottom":u=-d}let f=0;this.globalAlign==="right"||this.globalAlign==="end"?f=-l:this.globalAlign==="center"&&(f=-l/2);let g=this[this.directionKey.height];this.singleLine&&(g=this.lines[0].height+1);let _=!1;if(this.verticalDirection==="middle")if(this.actualHeight>=g&&g!==0)for(let y=0;y<this.lines.length;y++){const{top:b,height:S}=this.lines[y];if(b+S<this[this.directionKey.top]||b+S>this[this.directionKey.top]+g)return _;let v=!1;this.ellipsis&&this.lines[y+1]&&this.lines[y+1].top+this.lines[y+1].height>this[this.directionKey.top]+g&&(v=!0,_=!0),this.lines[y].draw(e,v,this.lines[y][this.directionKey.left]+f,this.lines[y][this.directionKey.top]+u,this.ellipsis,i)}else{const y=Math.floor((g-this.actualHeight)/2);this.layoutDirection==="vertical"?f+=y:u+=y;for(let b=0;b<this.lines.length;b++)this.lines[b].draw(e,!1,this.lines[b][this.directionKey.left]+f,this.lines[b][this.directionKey.top]+u,this.ellipsis,i)}else if(this.verticalDirection==="bottom"&&this.layoutDirection!=="vertical")for(let y=0;y<this.lines.length;y++){const{top:b,height:S}=this.lines[y],v=g-this.lines[y].top-this.lines[y].height;if(g===0)this.lines[y].draw(e,!1,f,v+u,this.ellipsis,i);else{if(v+S>this[this.directionKey.top]+g||v<this[this.directionKey.top])return _;{let A=!1;this.ellipsis&&this.lines[y+1]&&v-this.lines[y+1].height<this[this.directionKey.top]&&(A=!0,_=!0),this.lines[y].draw(e,A,f,v+u,this.ellipsis,i)}}}else{this.verticalDirection==="bottom"&&this.layoutDirection==="vertical"&&this.singleLine&&this.isWidthMax&&(f+=this.lines[0].height+1);for(let y=0;y<this.lines.length;y++){this.verticalDirection==="bottom"&&this.layoutDirection==="vertical"&&(f-=this.lines[y].height+this.lines[y].top);const{top:b,height:S}=this.lines[y];if(g===0)this.lines[y].draw(e,!1,this.lines[y][this.directionKey.left]+f,this.lines[y][this.directionKey.top]+u,this.ellipsis,i);else{if(b+S<this[this.directionKey.top]||b+S>this[this.directionKey.top]+g)return _;{let v=!1;this.ellipsis&&this.lines[y+1]&&this.lines[y+1].top+this.lines[y+1].height>this[this.directionKey.top]+g&&(v=!0,_=!0),this.lines[y].draw(e,v,this.lines[y][this.directionKey.left]+f,this.lines[y][this.directionKey.top]+u,this.ellipsis,i)}}}}return _}getActualSize(){return this.ellipsis?this.getActualSizeWidthEllipsis():this.getRawActualSize()}getRawActualSize(){let e=0,i=0;for(let n=0;n<this.lines.length;n++){const o=this.lines[n];o.actualWidth>e&&(e=o.actualWidth),i+=o.height}return{width:this.layoutDirection==="vertical"?i:e,height:this.layoutDirection==="vertical"?e:i}}getActualSizeWidthEllipsis(){let e=0,i=0;const{width:n,height:o}=this.getRawActualSize();this.width,this.height;let l=this[this.directionKey.height];if(this.singleLine&&(l=this.lines[0].height+1),this.verticalDirection==="middle")if(this.actualHeight>=l&&l!==0)for(let d=0;d<this.lines.length;d++){const{top:u,height:f}=this.lines[d];if(!(u+f<this[this.directionKey.top]||u+f>this[this.directionKey.top]+l))if(this.ellipsis&&this.lines[d+1]&&this.lines[d+1].top+this.lines[d+1].height>this[this.directionKey.top]+l){const g=this.ellipsis===!0?"...":this.ellipsis||"",_=this.lines[d].getWidthWithEllips(g);_>e&&(e=_),i+=this.lines[d].height}else this.lines[d].actualWidth>e&&(e=this.lines[d].actualWidth),i+=this.lines[d].height}else{Math.floor((l-this.actualHeight)/2);for(let d=0;d<this.lines.length;d++)this.lines[d].actualWidth>e&&(e=this.lines[d].actualWidth),i+=this.lines[d].height}else if(this.verticalDirection==="bottom")for(let d=0;d<this.lines.length;d++){const{top:u,height:f}=this.lines[d],g=l-this.lines[d].top-this.lines[d].height;if(l===0)this.lines[d].actualWidth>e&&(e=this.lines[d].actualWidth),i+=this.lines[d].height;else if(!(g+f>this[this.directionKey.top]+l||g<this[this.directionKey.top]))if(this.ellipsis&&this.lines[d+1]&&g-this.lines[d+1].height<this[this.directionKey.top]){const _=this.ellipsis===!0?"...":this.ellipsis||"",y=this.lines[d].getWidthWithEllips(_);y>e&&(e=y),i+=this.lines[d].height}else this.lines[d].actualWidth>e&&(e=this.lines[d].actualWidth),i+=this.lines[d].height}else for(let d=0;d<this.lines.length;d++){const{top:u,height:f}=this.lines[d];if(l===0)this.lines[d].actualWidth>e&&(e=this.lines[d].actualWidth),i+=this.lines[d].height;else if(!(u+f<this[this.directionKey.top]||u+f>this[this.directionKey.top]+l))if(this.ellipsis&&this.lines[d+1]&&this.lines[d+1].top+this.lines[d+1].height>this[this.directionKey.top]+l){const g=this.ellipsis===!0?"...":this.ellipsis||"",_=this.lines[d].getWidthWithEllips(g);_>e&&(e=_),i+=this.lines[d].height}else this.lines[d].actualWidth>e&&(e=this.lines[d].actualWidth),i+=this.lines[d].height}return{width:this.layoutDirection==="vertical"?i:e,height:this.layoutDirection==="vertical"?e:i}}}class Paragraph{constructor(e,i,n){this.fontSize=n.fontSize||16,this.textBaseline=n.textBaseline||"alphabetic";const o=calculateLineHeight(n.lineHeight,this.fontSize);this.lineHeight=typeof o=="number"?o>this.fontSize?o:this.fontSize:Math.floor(1.2*this.fontSize),this.height=this.lineHeight;const{ascent:l,height:d,descent:u,width:f}=measureTextCanvas(e,n);let g=0,_=0,y=0;this.height>d&&(g=(this.height-d)/2,_=Math.ceil(g),y=Math.floor(g)),this.textBaseline==="top"?(this.ascent=g,this.descent=d-g):this.textBaseline==="bottom"?(this.ascent=d-g,this.descent=g):this.textBaseline==="middle"?(this.ascent=this.height/2,this.descent=this.height/2):(this.ascent=l+_,this.descent=u+y),this.length=e.length,this.width=f||0,this.text=e||"",this.newLine=i||!1,this.character=n,this.left=0,this.top=0,this.ellipsis="normal",this.ellipsisWidth=0,this.ellipsisOtherParagraphWidth=0,n.direction==="vertical"&&(this.direction=n.direction,this.widthOrigin=this.width,this.heightOrigin=this.height,this.width=this.heightOrigin,this.height=this.widthOrigin,this.lineHeight=this.height),this.ellipsisStr="..."}updateWidth(){const{width:e}=measureTextCanvas(this.text,this.character);this.width=e,this.direction==="vertical"&&(this.widthOrigin=this.width,this.width=this.heightOrigin,this.height=this.widthOrigin)}draw(e,i,n,o,l){let d=this.text,u=this.left+n;i+=this.top;let f=this.direction;if(this.verticalEllipsis)d=this.ellipsisStr,f="vertical",i-=this.ellipsisWidth/2;else{if(this.ellipsis==="hide")return;if(this.ellipsis==="add")d+=this.ellipsisStr,l!=="right"&&l!=="end"||(u-=this.ellipsisWidth);else if(this.ellipsis==="replace"){const _=getStrByWithCanvas(d,(f==="vertical"?this.height:this.width)-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,d.length-1);if(d=d.slice(0,_),d+=this.ellipsisStr,l==="right"||l==="end"){const{width:y}=measureTextCanvas(this.text.slice(_),this.character);f==="vertical"||(u-=this.ellipsisWidth-y)}}}switch(this.character.script){case"super":i-=this.ascent*(1/3);break;case"sub":i+=this.descent/2}f==="vertical"&&(e.save(),e.rotateAbout(Math.PI/2,u,i),e.translate(-this.heightOrigin||-this.lineHeight/2,-this.descent/2),e.translate(u,i),u=0,i=0);const{lineWidth:g=1}=this.character;this.character.stroke&&g&&e.strokeText(d,u,i),this.character.fill&&e.fillText(d,u,i),this.character.fill&&(typeof this.character.lineThrough=="boolean"||typeof this.character.underline=="boolean"?(this.character.underline&&e.fillRect(u,1+i,this.widthOrigin||this.width,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1),this.character.lineThrough&&e.fillRect(u,1+i-this.ascent/2,this.widthOrigin||this.width,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)):this.character.textDecoration==="underline"?e.fillRect(u,1+i,this.widthOrigin||this.width,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1):this.character.textDecoration==="line-through"&&e.fillRect(u,1+i-this.ascent/2,this.widthOrigin||this.width,this.character.fontSize?Math.max(1,Math.floor(this.character.fontSize/10)):1)),f==="vertical"&&e.restore()}getWidthWithEllips(e){let i=this.text;const n=e==="vertical"?this.height:this.width;if(this.ellipsis==="hide")return n;if(this.ellipsis==="add")return n+this.ellipsisWidth;if(this.ellipsis==="replace"){const o=getStrByWithCanvas(i,n-this.ellipsisWidth+this.ellipsisOtherParagraphWidth,this.character,i.length-1);i=i.slice(0,o),i+=this.ellipsisStr;const{width:l}=measureTextCanvas(this.text.slice(o),this.character);return n+this.ellipsisWidth-l}return n}}function seperateParagraph(r,e){const i=r.text.slice(0,e),n=r.text.slice(e);return[new Paragraph(i,r.newLine,r.character),new Paragraph(n,!0,r.character)]}const IMAGE_UPDATE_TAG_KEY=["width","height","image",...GRAPHIC_UPDATE_TAG_KEY];class Image extends Graphic{constructor(e){super(e),this.type="image",this.numberType=IMAGE_NUMBER_TYPE,this.loadImage(this.attribute.image)}get width(){var e;return(e=this.attribute.width)!==null&&e!==void 0?e:0}set width(e){this.attribute.width===e&&(this.attribute.width=e,this.addUpdateShapeAndBoundsTag())}get height(){var e;return(e=this.attribute.height)!==null&&e!==void 0?e:0}set height(e){this.attribute.height===e&&(this.attribute.height=e,this.addUpdateShapeAndBoundsTag())}get repeatX(){var e;return(e=this.attribute.repeatX)!==null&&e!==void 0?e:"no-repeat"}set repeatX(e){this.attribute.repeatX===e&&(this.attribute.repeatX=e)}get repeatY(){var e;return(e=this.attribute.repeatY)!==null&&e!==void 0?e:"no-repeat"}set repeatY(e){this.attribute.repeatY===e&&(this.attribute.repeatY=e)}get image(){return this.attribute.image}set image(e){e!==this.attribute.image&&(this.attribute.image=e,this.loadImage(this.attribute.image))}imageLoadSuccess(e,i,n){super.imageLoadSuccess(e,i,()=>{this.successCallback&&this.successCallback()})}imageLoadFail(e,i){super.imageLoadFail(e,()=>{this.failCallback&&this.failCallback()})}setAttributes(e,i,n){return e.image&&this.loadImage(e.image),super.setAttributes(e,i,n)}setAttribute(e,i,n,o){return e==="image"&&this.loadImage(i),super.setAttribute(e,i,n,o)}getGraphicTheme(){return getTheme$1(this).image}updateAABBBounds(e,i,n){if(!this.updatePathProxyAABBBounds(n)){const{width:d=i.width,height:u=i.height}=e;n.set(0,0,d,u)}const{tb1:o,tb2:l}=application.graphicService.updateTempAABBBounds(n);return updateBoundsOfCommonOuterBorder(e,i,o),n.union(o),o.setValue(l.x1,l.y1,l.x2,l.y2),application.graphicService.transformAABBBounds(e,n,i,!1,this),n}getDefaultAttribute(e){return DefaultImageAttribute[e]}needUpdateTags(e){return super.needUpdateTags(e,IMAGE_UPDATE_TAG_KEY)}needUpdateTag(e){return super.needUpdateTag(e,IMAGE_UPDATE_TAG_KEY)}clone(){return new Image(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return Image.NOWORK_ANIMATE_ATTR}}Image.NOWORK_ANIMATE_ATTR=Object.assign({image:1,repeatX:1,repeatY:1},NOWORK_ANIMATE_ATTR);function createImage(r){return new Image(r)}class RichTextIcon extends Image{constructor(e){if(super(e),this._x=0,this._y=0,this._hovered=!1,this._marginArray=[0,0,0,0],e.backgroundShowMode==="always"&&(this._hovered=!0),e.margin){const i=parsePadding(e.margin);this._marginArray=typeof i=="number"?[i,i,i,i]:i}this.onBeforeAttributeUpdate=(i,n,o)=>{if(isArray(o)&&o.indexOf("margin")!==-1||o==="margin")if(n.margin){const l=parsePadding(n.margin);this._marginArray=typeof l=="number"?[l,l,l,l]:l}else this._marginArray=[0,0,0,0]}}get width(){var e;return((e=this.attribute.width)!==null&&e!==void 0?e:0)+this._marginArray[1]+this._marginArray[3]}get height(){var e;return((e=this.attribute.height)!==null&&e!==void 0?e:0)+this._marginArray[0]+this._marginArray[2]}tryUpdateAABBBounds(){if(!this.shouldUpdateAABBBounds())return this._AABBBounds;this.doUpdateAABBBounds();const{width:e=DefaultImageAttribute.width,height:i=DefaultImageAttribute.height}=this.attribute,{backgroundWidth:n=e,backgroundHeight:o=i}=this.attribute,l=(n-e)/2,d=(o-i)/2;return this._AABBBounds.expand([0,2*l,2*d,0]),this._AABBBounds}setHoverState(e){this.attribute.backgroundShowMode==="hover"&&this._hovered!==e&&(this._hovered=e)}}class Line{constructor(e,i,n,o,l,d,u,f){this.left=e,this.width=i,this.baseline=n,this.ascent=o,this.descent=l,this.top=n-o,this.paragraphs=d.map(_=>_),this.textAlign=(this.paragraphs[0]instanceof RichTextIcon?this.paragraphs[0].attribute.textAlign:this.paragraphs[0].character.textAlign)||"left",this.direction=u,this.directionKey=DIRECTION_KEY[this.direction],this.actualWidth=0;let g=0;this.paragraphs.forEach((_,y)=>{if(y===0&&_ instanceof Paragraph){const b=regFirstSpace.exec(_.text);(b==null?void 0:b.index)!==0&&(_.text=_.text.slice(b==null?void 0:b.index),_.updateWidth())}this.actualWidth+=_[this.directionKey.width],g=Math.max(_[this.directionKey.height],g)}),this.height=g,this.blankWidth=f?0:this.width-this.actualWidth,this.calcOffset(i,f)}calcOffset(e,i){const n=this.directionKey,o=this.height;let l=this.left,d=0;this.actualWidth<e&&!i&&(this.textAlign==="right"||this.textAlign==="end"?l=e-this.actualWidth:this.textAlign==="center"?l=(e-this.actualWidth)/2:this.textAlign==="justify"&&(this.paragraphs.length<2?l=(e-this.actualWidth)/2:d=(e-this.actualWidth)/(this.paragraphs.length-1))),this.paragraphs.map(function(u){u instanceof RichTextIcon?(u["_"+n.x]=l,l+=u[n.width]+d,u["_"+n.y]=u.attribute.textBaseline==="top"?0:u.attribute.textBaseline==="bottom"?o-u.height:(o-u.height)/2):(u[n.left]=l,l+=u[n.width]+d)})}draw(e,i,n,o,l,d){if(l&&(i||this.paragraphs.some(u=>u.overflow))){let u=!0,f=!1;for(let _=this.paragraphs.length-1;_>=0;_--){const y=this.paragraphs[_];if(y.overflow)u=u&&y.text==="";else if(u){f=!0;break}}let g=0;if(!f)for(let _=this.paragraphs.length-1;_>=0;_--){const y=this.paragraphs[_];if(y.overflow){if(y.text==="")break;continue}if(y instanceof RichTextIcon)break;if(this.direction==="vertical"&&y.direction!=="vertical"){y.verticalEllipsis=!0;break}const b=l===!0?"...":l||"";y.ellipsisStr=b;const{width:S}=measureTextCanvas(b,y.character),v=S||0;if(v<=this.blankWidth+g){i&&(y.ellipsis="add");break}if(v<=this.blankWidth+g+y.width){y.ellipsis="replace",y.ellipsisWidth=v,y.ellipsisOtherParagraphWidth=this.blankWidth+g;break}y.ellipsis="hide",g+=y.width}}this.paragraphs.forEach((u,f)=>{if(u instanceof RichTextIcon)return u.setAttributes({x:n+u._x,y:o+u._y}),void d(u,e,n+u._x,o+u._y,this.ascent);const g={x1:this.left,y1:this.top,x2:this.left+this.actualWidth,y2:this.top+this.height};applyStrokeStyle(e,u.character),applyFillStyle(e,u.character,g),u.draw(e,o+this.ascent,n,f===0,this.textAlign)})}getWidthWithEllips(e){let i=0;for(let o=this.paragraphs.length-1;o>=0;o--){const l=this.paragraphs[o];if(l instanceof RichTextIcon)break;const{width:d}=measureTextCanvas(e,l.character),u=d||0;if(u<=this.blankWidth+i){l.ellipsis="add",l.ellipsisWidth=u;break}if(u<=this.blankWidth+i+l.width){l.ellipsis="replace",l.ellipsisWidth=u,l.ellipsisOtherParagraphWidth=this.blankWidth+i;break}l.ellipsis="hide",i+=l.width}let n=0;return this.paragraphs.forEach((o,l)=>{n+=o instanceof RichTextIcon?o.width:o.getWidthWithEllips(this.direction)}),n}}class Wrapper{constructor(e){this.frame=e,this.width=this.frame.width,this.height=this.frame.height,this.lineWidth=0,this.y=this.frame.top,this.maxAscent=0,this.maxDescent=0,this.maxAscentForBlank=0,this.maxDescentForBlank=0,this.lineBuffer=[],this.direction=e.layoutDirection,this.directionKey=DIRECTION_KEY[this.direction]}store(e){if(e instanceof RichTextIcon){this.frame.icons.set(e.richtextId,e),this.lineBuffer.push(e),this.lineWidth+=e[this.directionKey.width];let i=0,n=0;e.attribute.textBaseline==="top"?(i=0,n=e.height):e.attribute.textBaseline==="bottom"?(i=e.height,n=0):(i=e.height/2,n=e.height/2),this.maxAscent=Math.max(this.maxAscent,i),this.maxDescent=Math.max(this.maxDescent,n)}else this.lineBuffer.push(e),e.text.length!==0?(this.lineWidth+=e[this.directionKey.width],this.maxAscent=Math.max(this.maxAscent,e.ascent),this.maxDescent=Math.max(this.maxDescent,e.descent)):(this.maxAscentForBlank=Math.max(this.maxAscentForBlank,e.ascent),this.maxDescentForBlank=Math.max(this.maxDescentForBlank,e.descent))}send(){if(this.lineBuffer.length===0)return;const e=this.maxAscent===0?this.maxAscentForBlank:this.maxAscent,i=this.maxDescent===0?this.maxDescentForBlank:this.maxDescent,n=new Line(this.frame.left,this[this.directionKey.width],this.y+e,e,i,this.lineBuffer,this.direction,this.direction==="horizontal"?this.frame.isWidthMax:this.frame.isHeightMax);this.frame.lines.push(n),this.frame.actualHeight+=n.height,this.y+=n.height,this.lineBuffer.length=0,this.lineWidth=this.maxAscent=this.maxDescent=this.maxAscentForBlank=this.maxDescentForBlank=0}deal(e,i=!1){e instanceof RichTextIcon?this.direction==="horizontal"&&this.width===0||this.direction==="vertical"&&this.height===0||this.lineWidth+e[this.directionKey.width]<=this[this.directionKey.width]?this.store(e):this.lineBuffer.length===0?(this.store(e),this.send()):(this.send(),this.deal(e)):typeof this.width!="number"||this.width<0||(e.newLine&&this.send(),e.text.length!==0&&(this.direction==="horizontal"&&this.width===0||this.direction==="vertical"&&this.height===0||this.lineWidth+e[this.directionKey.width]<=this[this.directionKey.width]?this.store(e):this.lineWidth===this[this.directionKey.width]?(this.send(),this.deal(e)):this.cut(e,i)))}cut(e,i){const n=this[this.directionKey.width]-this.lineWidth||0,o=Math.ceil(n/e[this.directionKey.width]*e.length)||0,l=getStrByWithCanvas(e.text,n,e.character,o,this.frame.wordBreak==="break-word");if(l!==0){const[d,u]=seperateParagraph(e,l);this.store(d),i?this.send():this.deal(u)}else this.lineBuffer.length!==0&&(this.send(),this.deal(e))}}const RICHTEXT_UPDATE_TAG_KEY=["width","height","ellipsis","wordBreak","verticalDirection","maxHeight","maxWidth","textAlign","textBaseline","textConfig","layoutDirection","fill","stroke","fontSize","fontFamily","fontStyle","fontWeight","lineWidth","opacity","fillOpacity","strokeOpacity",...GRAPHIC_UPDATE_TAG_KEY];class RichText extends Graphic{constructor(e){super(e),this.type="richtext",this._currentHoverIcon=null,this.numberType=RICHTEXT_NUMBER_TYPE,this.onBeforeAttributeUpdate=(i,n,o)=>{for(const l in i)if(l==="hoverIconId"){if(i[l]===n[l])continue;const d=this._frameCache.icons.get(i[l]);this.updateHoverIconState(d)}}}get width(){var e;return(e=this.attribute.width)!==null&&e!==void 0?e:DefaultRichTextAttribute.width}set width(e){this.attribute.width!==e&&(this.attribute.width=e,this.addUpdateShapeAndBoundsTag())}get height(){var e;return(e=this.attribute.height)!==null&&e!==void 0?e:DefaultRichTextAttribute.height}set height(e){this.attribute.height!==e&&(this.attribute.height=e,this.addUpdateShapeAndBoundsTag())}get maxWidth(){return this.attribute.maxWidth}set maxWidth(e){this.attribute.maxWidth!==e&&(this.attribute.maxWidth=e,this.addUpdateShapeAndBoundsTag())}get maxHeight(){return this.attribute.maxHeight}set maxHeight(e){this.attribute.maxHeight!==e&&(this.attribute.maxHeight=e,this.addUpdateShapeAndBoundsTag())}get ellipsis(){var e;return(e=this.attribute.ellipsis)!==null&&e!==void 0?e:DefaultRichTextAttribute.ellipsis}set ellipsis(e){this.attribute.ellipsis!==e&&(this.attribute.ellipsis=e,this.addUpdateShapeAndBoundsTag())}get wordBreak(){var e;return(e=this.attribute.wordBreak)!==null&&e!==void 0?e:DefaultRichTextAttribute.wordBreak}set wordBreak(e){this.attribute.wordBreak!==e&&(this.attribute.wordBreak=e,this.addUpdateShapeAndBoundsTag())}get verticalDirection(){var e;return(e=this.attribute.verticalDirection)!==null&&e!==void 0?e:DefaultRichTextAttribute.verticalDirection}set verticalDirection(e){this.attribute.verticalDirection!==e&&(this.attribute.verticalDirection=e,this.addUpdateShapeAndBoundsTag())}get textAlign(){var e;return(e=this.attribute.textAlign)!==null&&e!==void 0?e:DefaultRichTextAttribute.textAlign}set textAlign(e){this.attribute.textAlign!==e&&(this.attribute.textAlign=e,this.addUpdateShapeAndBoundsTag())}get textBaseline(){var e;return(e=this.attribute.textBaseline)!==null&&e!==void 0?e:DefaultRichTextAttribute.textBaseline}set textBaseline(e){this.attribute.textBaseline!==e&&(this.attribute.textBaseline=e,this.addUpdateShapeAndBoundsTag())}get textConfig(){var e;return(e=this.attribute.textConfig)!==null&&e!==void 0?e:DefaultRichTextAttribute.textConfig}set textConfig(e){this.attribute.textConfig=e,this.addUpdateShapeAndBoundsTag()}getGraphicTheme(){return getTheme$1(this).richtext}updateAABBBounds(e,i,n){const{width:o=i.width,height:l=i.height,maxWidth:d=i.maxWidth,maxHeight:u=i.maxHeight,textAlign:f=i.textAlign,textBaseline:g=i.textBaseline}=e;if(o>0&&l>0)n.set(0,0,o,l);else{const b=this.getFrameCache(),{width:S,height:v}=b.getActualSize();let A=o||S||0,x=l||v||0;x=typeof u=="number"&&x>u?u:x||0,A=typeof d=="number"&&A>d?d:A||0,n.set(0,0,A,x)}let _=0;switch(g){case"top":_=0;break;case"middle":_=-n.height()/2;break;case"bottom":_=-n.height()}let y=0;switch(f){case"left":y=0;break;case"center":y=-n.width()/2;break;case"right":y=-n.width()}return n.translate(y,_),application.graphicService.updateTempAABBBounds(n),e.forceBoundsHeight==null&&e.forceBoundsWidth==null||application.graphicService.updateHTMLTextAABBBounds(e,i,n),application.graphicService.transformAABBBounds(e,n,i,!1,this),n}needUpdateTags(e){return super.needUpdateTags(e,RICHTEXT_UPDATE_TAG_KEY)}needUpdateTag(e){return super.needUpdateTag(e,RICHTEXT_UPDATE_TAG_KEY)}getFrameCache(){return this.shouldUpdateShape()&&(this.doUpdateFrameCache(),this.clearUpdateShapeTag()),this._frameCache}get cliped(){const e=this.getFrameCache();if(e.actualHeight>e.height)return!0;const{disableAutoWrapLine:i}=this.attribute;if(i)for(let n=0;n<e.lines.length;n++){const o=e.lines[n];for(let l=0;l<o.paragraphs.length;l++){const d=o.paragraphs[l];if(d.overflow&&d.text!=="")return!0}}return!1}combinedStyleToCharacter(e){const{fill:i,stroke:n,fontSize:o,fontFamily:l,fontStyle:d,fontWeight:u,lineWidth:f,opacity:g,fillOpacity:_,strokeOpacity:y}=this.attribute;return Object.assign({fill:i,stroke:n,fontSize:o,fontFamily:l,fontStyle:d,fontWeight:u,lineWidth:f,opacity:g,fillOpacity:_,strokeOpacity:y},e)}doUpdateFrameCache(e){var i;const{textConfig:n=[],maxWidth:o,maxHeight:l,width:d,height:u,ellipsis:f,wordBreak:g,verticalDirection:_,textAlign:y,textBaseline:b,layoutDirection:S,singleLine:v,disableAutoWrapLine:A}=this.attribute,x=[],T=e??n;for(let B=0;B<T.length;B++)if("image"in T[B]){const I=this.combinedStyleToCharacter(T[B]);I.lineWidth=void 0;const D=I.id&&this._frameCache&&this._frameCache.icons&&this._frameCache.icons.get(I.id);if(D)x.push(D);else{const O=new RichTextIcon(I);O.successCallback=()=>{var N;this.addUpdateBoundTag(),(N=this.stage)===null||N===void 0||N.renderNextFrame()},O.richtextId=I.id,x.push(O)}}else{const I=this.combinedStyleToCharacter(T[B]);if(isNumber(I.text)&&(I.text=`${I.text}`),I.text&&I.text.includes(`
`)){const D=I.text.split(`
`);for(let O=0;O<D.length;O++)x.push(new Paragraph(D[O],O!==0,I))}else I.text&&x.push(new Paragraph(I.text,!1,I))}const C=typeof o=="number"&&Number.isFinite(o)&&o>0,E=typeof l=="number"&&Number.isFinite(l)&&l>0,P=typeof d=="number"&&Number.isFinite(d)&&d>0&&(!C||d<=o),R=typeof u=="number"&&Number.isFinite(u)&&u>0&&(!E||u<=l),L=new Frame(0,0,(P?d:C?o:0)||0,(R?u:E?l:0)||0,f,g,_,y,b,S||"horizontal",!P&&C,!R&&E,v||!1,(i=this._frameCache)===null||i===void 0?void 0:i.icons),w=new Wrapper(L);if(A){let B=0,I=!1;for(let D=0;D<x.length;D++){const O=x[D];I?(O.overflow=!0,O.left=1/0,O.top=1/0,!O.newLine&&L.lines[L.lines.length-1].paragraphs.push(O)):w.deal(O,!0),L.lines.length!==B&&(B=L.lines.length,w.lineBuffer.length=0,O.overflow=!0,O.left=1e3,O.top=1e3,L.lines[L.lines.length-1].paragraphs.push(O),I=!0),O.newLine&&(I=!1,w.lineWidth=0),w.send()}}else for(let B=0;B<x.length;B++)w.deal(x[B]);if(w.send(),!(L.layoutDirection==="horizontal"?P:R)){const B=L.getActualSizeWidthEllipsis();let I=L.layoutDirection==="horizontal"?B.width:B.height;(L.layoutDirection==="horizontal"?C:E)&&(I=Math.min(I,L.layoutDirection==="horizontal"?o:l)),L.lines.forEach(function(D){D.calcOffset(I,!1)})}this._frameCache=L}clone(){return new RichText(Object.assign({},this.attribute))}setStage(e,i){super.setStage(e,i),this.getFrameCache().icons.forEach(n=>{n.setStage(e,i)})}bindIconEvent(){this.addEventListener("pointermove",e=>{const i=this.pickIcon(e.global);i&&i===this._currentHoverIcon||(i?this.setAttribute("hoverIconId",i.richtextId):!i&&this._currentHoverIcon&&this.setAttribute("hoverIconId",void 0))}),this.addEventListener("pointerleave",e=>{this._currentHoverIcon&&this.setAttribute("hoverIconId",void 0)})}updateHoverIconState(e){var i,n,o,l,d;e?((i=this._currentHoverIcon)===null||i===void 0||i.setHoverState(!1),this._currentHoverIcon=e,this._currentHoverIcon.setHoverState(!0),(n=this.stage)===null||n===void 0||n.setCursor(e.attribute.cursor),(o=this.stage)===null||o===void 0||o.renderNextFrame()):(this._currentHoverIcon.setHoverState(!1),this._currentHoverIcon=null,(l=this.stage)===null||l===void 0||l.setCursor(),(d=this.stage)===null||d===void 0||d.renderNextFrame())}pickIcon(e){const i=this.getFrameCache(),{e:n,f:o}=this.globalTransMatrix;let l;return i.icons.forEach((d,u)=>{var f,g;const _=d.AABBBounds.clone();_.translate(d._marginArray[3],d._marginArray[0]),_.containsPoint({x:e.x-n,y:e.y-o})&&(l=d,l.globalX=((f=l.attribute.x)!==null&&f!==void 0?f:0)+n+d._marginArray[3],l.globalY=((g=l.attribute.y)!==null&&g!==void 0?g:0)+o+d._marginArray[0])}),l}getNoWorkAnimateAttr(){return RichText.NOWORK_ANIMATE_ATTR}}RichText.NOWORK_ANIMATE_ATTR=Object.assign({ellipsis:1,wordBreak:1,verticalDirection:1,textAlign:1,textBaseline:1,textConfig:1,layoutDirection:1},NOWORK_ANIMATE_ATTR);function createRichText(r){return new RichText(r)}const PATH_UPDATE_TAG_KEY=["path","customPath",...GRAPHIC_UPDATE_TAG_KEY];class Path extends Graphic{constructor(e){super(e),this.type="path",this.numberType=PATH_NUMBER_TYPE}get pathShape(){return this.tryUpdateAABBBounds(),this.getParsedPathShape()}isValid(){return super.isValid()&&this._isValid()}_isValid(){const{path:e}=this.attribute;return e!=null&&e!==""}getParsedPathShape(){const e=this.getGraphicTheme();if(!this.valid)return e.path;const i=this.attribute;return i.path instanceof CustomPath2D?i.path:(isNil(this.cache)&&this.doUpdatePathShape(),this.cache instanceof CustomPath2D?this.cache:e.path)}getGraphicTheme(){return getTheme$1(this).path}updateAABBBounds(e,i,n){if(!this.updatePathProxyAABBBounds(n)){const u=this.getParsedPathShape();n.union(u.getBounds())}const{tb1:o,tb2:l}=application.graphicService.updateTempAABBBounds(n);updateBoundsOfCommonOuterBorder(e,i,o),n.union(o),o.setValue(l.x1,l.y1,l.x2,l.y2);const{lineJoin:d=i.lineJoin}=e;return application.graphicService.transformAABBBounds(e,n,i,d==="miter",this),n}doUpdateAABBBounds(e){return this.doUpdatePathShape(),super.doUpdateAABBBounds(e)}doUpdatePathShape(){const e=this.attribute;isString(e.path,!0)?this.cache=new CustomPath2D().fromString(e.path):e.customPath&&(this.cache=new CustomPath2D,e.customPath(this.cache,this))}needUpdateTags(e){return super.needUpdateTags(e,PATH_UPDATE_TAG_KEY)}needUpdateTag(e){return super.needUpdateTag(e,PATH_UPDATE_TAG_KEY)}toCustomPath(){return new CustomPath2D().fromCustomPath2D(this.getParsedPathShape(),0,0)}clone(){return new Path(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return Path.NOWORK_ANIMATE_ATTR}}Path.NOWORK_ANIMATE_ATTR=Object.assign({path:1,customPath:1},NOWORK_ANIMATE_ATTR);function createPath(r){return new Path(r)}const AREA_UPDATE_TAG_KEY=["segments","points","curveType","curveTension",...GRAPHIC_UPDATE_TAG_KEY];class Area extends Graphic{constructor(e){super(e),this.type="area",this.numberType=AREA_NUMBER_TYPE}isValid(){return super.isValid()&&this._isValid()}_isValid(){if(this.pathProxy)return!0;const{points:e,segments:i}=this.attribute;return i?i.length!==0:!!e&&e.length!==0}getGraphicTheme(){return getTheme$1(this).area}updateAABBBounds(e,i,n){this.updatePathProxyAABBBounds(n)||(e.segments?this.updateAreaAABBBoundsBySegments(e,i,n):this.updateAreaAABBBoundsByPoints(e,i,n)),application.graphicService.updateTempAABBBounds(n);const{lineJoin:o=i.lineJoin}=e;return application.graphicService.transformAABBBounds(e,n,i,o==="miter",this),n}updateAreaAABBBoundsByPoints(e,i,n,o){const{points:l=i.points}=e,d=n;return l.forEach(u=>{var f,g;d.add(u.x,u.y),d.add((f=u.x1)!==null&&f!==void 0?f:u.x,(g=u.y1)!==null&&g!==void 0?g:u.y)}),d}updateAreaAABBBoundsBySegments(e,i,n,o){const{segments:l=i.segments}=e,d=n;return l.forEach(u=>{u.points.forEach(f=>{var g,_;d.add(f.x,f.y),d.add((g=f.x1)!==null&&g!==void 0?g:f.x,(_=f.y1)!==null&&_!==void 0?_:f.y)})}),d}_interpolate(e,i,n,o,l){e==="points"&&(l.points=pointsInterpolation(n,o,i))}needUpdateTags(e){return super.needUpdateTags(e,AREA_UPDATE_TAG_KEY)}needUpdateTag(e){return super.needUpdateTag(e,AREA_UPDATE_TAG_KEY)}toCustomPath(){const e=new CustomPath2D,i=this.attribute,n=i.segments,o=l=>{if(l&&l.length){let d=!0;const u=[];if(l.forEach(f=>{var g,_;f.defined!==!1&&(d?e.moveTo(f.x,f.y):e.lineTo(f.x,f.y),u.push({x:(g=f.x1)!==null&&g!==void 0?g:f.x,y:(_=f.y1)!==null&&_!==void 0?_:f.y}),d=!1)}),u.length){for(let f=u.length-1;f>=0;f--)e.lineTo(u[f].x,u[f].y);e.closePath()}}};return i.points?o(i.points):n&&n.length&&n.forEach(l=>{o(l.points)}),e}clone(){return new Area(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return Area.NOWORK_ANIMATE_ATTR}}Area.NOWORK_ANIMATE_ATTR=Object.assign({segments:1,curveType:1},NOWORK_ANIMATE_ATTR);function createArea(r){return new Area(r)}const ARC_UPDATE_TAG_KEY=["innerRadius","outerRadius","startAngle","endAngle","cornerRadius","padAngle","padRadius","cap",...GRAPHIC_UPDATE_TAG_KEY];class Arc extends Graphic{constructor(e){super(e),this.type="arc",this.numberType=ARC_NUMBER_TYPE}isValid(){return super.isValid()&&this._isValid()}_isValid(){const{startAngle:e,endAngle:i,outerRadius:n,innerRadius:o}=this.attribute;return this._validNumber(e)&&this._validNumber(i)&&this._validNumber(n)&&this._validNumber(o)}getParsedCornerRadius(){const e=this.getGraphicTheme(),{cornerRadius:i=e.cornerRadius,innerPadding:n=e.innerPadding,outerPadding:o=e.outerPadding}=this.attribute;let{outerRadius:l=e.outerRadius,innerRadius:d=e.innerRadius}=this.attribute;if(l+=o,d-=n,i===0||i==="0%")return 0;const u=Math.abs(l-d),f=g=>Math.min(isNumber(g,!0)?g:u*parseFloat(g)/100,u/2);if(isArray(i)){const g=i.map(_=>f(_)||0);return g.length===0?[g[0],g[0],g[0],g[0]]:g.length===2?[g[0],g[1],g[0],g[1]]:(g.length===3&&g.push(0),g)}return f(i)}getParsedAngle(){const e=this.getGraphicTheme();let{startAngle:i=e.startAngle,endAngle:n=e.endAngle}=this.attribute;const{cap:o=e.cap}=this.attribute,l=n-i>=0?1:-1,d=n-i;if(i=clampAngleByRadian(i),n=i+d,o&&abs$1(d)<pi2-epsilon$1){let u=1,f=1;o.length&&(u=Number(o[0]),f=Number(o[1]));let{outerRadius:g=e.outerRadius,innerRadius:_=e.innerRadius}=this.attribute;const{outerPadding:y=e.outerPadding,innerPadding:b=e.innerPadding}=this.attribute;g+=y,_-=b;const S=Math.abs(g-_)/2,v=S/g;if(S>epsilon$1&&g>epsilon$1)return{startAngle:i-l*v*u,endAngle:n+l*v*f,sc:l*v*u,ec:l*v*f}}return{startAngle:i,endAngle:n}}getParsePadAngle(e,i){const n=this.getGraphicTheme(),{innerPadding:o=n.innerPadding,outerPadding:l=n.outerPadding,padAngle:d=n.padAngle}=this.attribute;let{outerRadius:u=n.outerRadius,innerRadius:f=n.innerRadius}=this.attribute;u+=l,f-=o;const{padRadius:g=sqrt$3(u*u+f*f)}=this.attribute,_=abs$1(i-e);let y=e,b=i,S=e,v=i;const A=d/2;let x=_,T=_;if(A>epsilon$1&&g>epsilon$1){const C=i>e?1:-1;let E=asin$1(Number(g)/f*sin$1(A)),P=asin$1(Number(g)/u*sin$1(A));return(x-=2*E)>epsilon$1?(E*=C,S+=E,v-=E):(x=0,S=v=(e+i)/2),(T-=2*P)>epsilon$1?(P*=C,y+=P,b-=P):(T=0,y=b=(e+i)/2),{outerStartAngle:y,outerEndAngle:b,innerStartAngle:S,innerEndAngle:v,innerDeltaAngle:x,outerDeltaAngle:T}}return{outerStartAngle:y,outerEndAngle:b,innerStartAngle:S,innerEndAngle:v,innerDeltaAngle:x,outerDeltaAngle:T}}getGraphicTheme(){return getTheme$1(this).arc}updateAABBBounds(e,i,n,o){this.updatePathProxyAABBBounds(n)||(o?this.updateArcAABBBoundsImprecise(e,i,n):this.updateArcAABBBoundsAccurate(e,i,n));const{tb1:l,tb2:d}=application.graphicService.updateTempAABBBounds(n);updateBoundsOfCommonOuterBorder(e,i,l),n.union(l),l.setValue(d.x1,d.y1,d.x2,d.y2);const{lineJoin:u=i.lineJoin}=e;return application.graphicService.transformAABBBounds(e,n,i,u==="miter",this),n}updateArcAABBBoundsImprecise(e,i,n){let{outerRadius:o=i.outerRadius,innerRadius:l=i.innerRadius}=e;const{outerPadding:d=i.outerPadding,innerPadding:u=i.innerPadding}=e;return o+=d,l-=u,o<l&&(o=l),n.set(-o,-o,o,o),n}updateArcAABBBoundsAccurate(e,i,n){let{outerRadius:o=i.outerRadius,innerRadius:l=i.innerRadius}=e;const{outerPadding:d=i.outerPadding,innerPadding:u=i.innerPadding}=e;if(o+=d,l-=u,o<l){const _=o;o=l,l=_}let{endAngle:f=i.endAngle,startAngle:g=i.startAngle}=e;if(g>f){const _=g;g=f,f=_}return o<=epsilon$1?n.set(0,0,0,0):Math.abs(f-g)>pi2-epsilon$1?n.set(-o,-o,o,o):(circleBounds(g,f,o,n),circleBounds(g,f,l,n)),n}needUpdateTags(e){return super.needUpdateTags(e,ARC_UPDATE_TAG_KEY)}needUpdateTag(e){return super.needUpdateTag(e,ARC_UPDATE_TAG_KEY)}toCustomPath(){var e,i,n,o;const l=this.attribute,{startAngle:d,endAngle:u}=this.getParsedAngle();let f=((e=l.innerRadius)!==null&&e!==void 0?e:0)-((i=l.innerPadding)!==null&&i!==void 0?i:0),g=((n=l.outerRadius)!==null&&n!==void 0?n:0)-((o=l.outerPadding)!==null&&o!==void 0?o:0);const _=abs$1(u-d),y=u>d;if(g<f){const S=g;g=f,f=S}const b=new CustomPath2D;if(g<=epsilon$1)b.moveTo(0,0);else if(_>=pi2-epsilon$1)b.moveTo(0+g*cos$1(d),0+g*sin$1(d)),b.arc(0,0,g,d,u,!y),f>epsilon$1&&(b.moveTo(0+f*cos$1(u),0+f*sin$1(u)),b.arc(0,0,f,u,d,y));else{const S=g*cos$1(d),v=g*sin$1(d),A=f*cos$1(u),x=f*sin$1(u);b.moveTo(0+S,0+v),b.arc(0,0,g,d,u,!y),b.lineTo(0+A,0+x),b.arc(0,0,f,u,d,y),b.closePath()}return b}clone(){return new Arc(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return Arc.NOWORK_ANIMATE_ATTR}}Arc.NOWORK_ANIMATE_ATTR=Object.assign({cap:1},NOWORK_ANIMATE_ATTR);function createArc(r){return new Arc(r)}class Arc3d extends Arc{constructor(e){super(e),this.type="arc3d",this.numberType=ARC3D_NUMBER_TYPE}updateAABBBounds(e,i,n){const o=this.stage;if(!o||!o.camera)return n;const{outerRadius:l=i.outerRadius,height:d=0}=e,u=l+d;return n.setValue(-u,-u,u,u),application.graphicService.updateTempAABBBounds(n),application.graphicService.transformAABBBounds(e,n,i,!1,this),n}getNoWorkAnimateAttr(){return Arc3d.NOWORK_ANIMATE_ATTR}}Arc3d.NOWORK_ANIMATE_ATTR=Object.assign({cap:1},NOWORK_ANIMATE_ATTR);function createArc3d(r){return new Arc3d(r)}const POLYGON_UPDATE_TAG_KEY=["points","cornerRadius",...GRAPHIC_UPDATE_TAG_KEY];class Polygon extends Graphic{constructor(e){super(e),this.type="polygon",this.numberType=POLYGON_NUMBER_TYPE}isValid(){return super.isValid()&&this._isValid()}_isValid(){const{points:e}=this.attribute;return e&&e.length>=2}getGraphicTheme(){return getTheme$1(this).polygon}updateAABBBounds(e,i,n){this.updatePathProxyAABBBounds(n)||this.updatePolygonAABBBoundsImprecise(e,i,n),application.graphicService.updateTempAABBBounds(n);const{lineJoin:o=i.lineJoin}=e;return application.graphicService.transformAABBBounds(e,n,i,o==="miter",this),n}updatePolygonAABBBoundsImprecise(e,i,n){const{points:o=i.points}=e;return o.forEach(l=>{n.add(l.x,l.y)}),n}_interpolate(e,i,n,o,l){e==="points"&&(l.points=pointsInterpolation(n,o,i))}needUpdateTags(e){return super.needUpdateTags(e,POLYGON_UPDATE_TAG_KEY)}needUpdateTag(e){return super.needUpdateTag(e,POLYGON_UPDATE_TAG_KEY)}toCustomPath(){const e=this.attribute.points,i=new CustomPath2D;return e.forEach((n,o)=>{o===0?i.moveTo(n.x,n.y):i.lineTo(n.x,n.y)}),i.closePath(),i}clone(){return new Polygon(Object.assign({},this.attribute))}getNoWorkAnimateAttr(){return Polygon.NOWORK_ANIMATE_ATTR}}Polygon.NOWORK_ANIMATE_ATTR=NOWORK_ANIMATE_ATTR;function createPolygon(r){return new Polygon(r)}class Pyramid3d extends Polygon{constructor(e){super(e),this.type="pyramid3d",this.numberType=PYRAMID3D_NUMBER_TYPE}updateAABBBounds(e,i,n){const o=this.stage;return!o||!o.camera||(this.findFace().vertices.forEach(l=>{const d=l[0],u=l[1];n.add(d,u)}),application.graphicService.updateTempAABBBounds(n),application.graphicService.transformAABBBounds(e,n,i,!1,this)),n}findFace(){const{points:e}=this.attribute,i=e.map((u,f)=>{const g=f===3?e[0]:e[f+1],_=u.x-g.x;return _===0?0:(u.y-g.y)/_}),n=e.map(u=>({p:u,d:0}));let o=!1,l=0;for(let u=0;u<i.length-1;u++){for(let f=u+1;f<i.length;f++){if(i[u]===i[f]){o=!0;const g=PointService.distancePP(n[u].p,n[u+1].p);n[u].d=g,n[u+1].d=g,l=max$1(l,g);const _=PointService.distancePP(n[f].p,n[f+1].p);n[f].d=_,n[f+1].d=_,l=max$1(l,_)}if(o)break}if(o)break}for(let u=e.length-1;u>=0;u--){const f=e[u];n.unshift({p:f,d:0})}for(let u=0;u<e.length;u++){const f=(l-n[u+e.length].d)/2;n[u].d+=f,n[u+e.length].d+=f}const d={polygons:[],vertices:[],edges:[]};return n.forEach(u=>{d.vertices.push([u.p.x,u.p.y,u.d])}),d.polygons.push({polygon:[0,4,5,1],normal:[0,-1,0]}),d.polygons.push({polygon:[7,6,2,3],normal:[0,1,0]}),d.polygons.push({polygon:[0,4,7,3],normal:[-1,0,0]}),d.polygons.push({polygon:[1,5,6,2],normal:[1,0,0]}),d.polygons.push({polygon:[0,1,2,3],normal:[0,0,-1]}),d.polygons.push({polygon:[4,5,6,7],normal:[0,0,1]}),d.edges=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[3,7],[1,5],[2,6]],d}_isValid(){return super._isValid()&&this.attribute.points.length===4}getNoWorkAnimateAttr(){return Pyramid3d.NOWORK_ANIMATE_ATTR}}Pyramid3d.NOWORK_ANIMATE_ATTR=NOWORK_ANIMATE_ATTR;function createPyramid3d(r){return new Pyramid3d(r)}class ShadowRoot extends Group$1{constructor(e){super({x:0,y:0}),this.type="shadowroot",this.shadowHost=e}clearUpdateBoundTag(){super.clearUpdateBoundTag(),this.shadowHost&&this.shadowHost.clearUpdateBoundTag()}addUpdateBoundTag(){super.addUpdateBoundTag(),this.shadowHost&&this.shadowHost.addUpdateBoundTag()}addUpdateShapeAndBoundsTag(){super.addUpdateShapeAndBoundsTag(),this.shadowHost&&this.shadowHost.addUpdateBoundTag()}tryUpdateGlobalTransMatrix(e=!0){if(this.shouldUpdateGlobalMatrix()){const i=this.transMatrix;this._globalTransMatrix?this._globalTransMatrix.setValue(i.a,i.b,i.c,i.d,i.e,i.f):this._globalTransMatrix=i.clone(),this.doUpdateGlobalMatrix(),e&&this.clearUpdateGlobalPositionTag()}return this._globalTransMatrix}doUpdateGlobalMatrix(){if(this.shadowHost){const e=this.shadowHost.globalTransMatrix;this._globalTransMatrix.multiply(e.a,e.b,e.c,e.d,e.e,e.f)}}tryUpdateGlobalAABBBounds(){return this._globalAABBBounds?this._globalAABBBounds.setValue(this._AABBBounds.x1,this._AABBBounds.y1,this._AABBBounds.x2,this._AABBBounds.y2):this._globalAABBBounds=this._AABBBounds.clone(),this.shadowHost&&this._globalAABBBounds.transformWithMatrix(this.shadowHost.globalTransMatrix),this._globalAABBBounds}}function createShadowRoot(r){return new ShadowRoot(r)}var __decorate$R=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d};const PickItemInterceptor=Symbol.for("PickItemInterceptor");let ShadowRootPickItemInterceptorContribution=class{constructor(){this.order=1}afterPickItem(r,e,i,n,o){return r.attribute.shadowRootIdx>0||!r.attribute.shadowRootIdx?this._pickItem(r,e,i,n,o):null}beforePickItem(r,e,i,n,o){return r.attribute.shadowRootIdx<0?this._pickItem(r,e,i,n,o):null}_pickItem(r,e,i,n,o){var l;if(!r.shadowRoot)return null;const{parentMatrix:d}=o||{};if(!d)return null;const u=e.pickContext;u.highPerformanceSave();const f=(l=getTheme$1(r))===null||l===void 0?void 0:l[r.type],{shadowPickMode:g=f==null?void 0:f.shadowPickMode}=r.attribute,_=r.shadowRoot,y=matrixAllocate.allocateByObj(d),b=new Point(y.a*i.x+y.c*i.y+y.e,y.b*i.x+y.d*i.y+y.f),S=e.pickGroup(_,b,y,n);return u.highPerformanceRestore(),!S.graphic&&S.group&&g==="full"&&(S.graphic=S.group),S}};ShadowRootPickItemInterceptorContribution=__decorate$R([injectable()],ShadowRootPickItemInterceptorContribution);let InteractivePickItemInterceptorContribution=class{constructor(){this.order=1}beforePickItem(r,e,i,n,o){const l=r.baseGraphic;if(l&&l.parent){const d=new Point(i.x,i.y),u=e.pickContext;u.highPerformanceSave();const f=l.parent.globalTransMatrix;f.transformPoint(d,d);const g=l.isContainer?e.pickGroup(l,d.clone(),f,n):e.pickItem(l,d.clone(),f,n);return u.highPerformanceRestore(),g}return null}};InteractivePickItemInterceptorContribution=__decorate$R([injectable()],InteractivePickItemInterceptorContribution);let Canvas3DPickItemInterceptor=class{constructor(){this.order=1}beforePickItem(r,e,i,n,o){if(!r.in3dMode||n.in3dInterceptor)return null;const l=e.pickContext,d=r.stage;if(!l||!d)return null;if(n.in3dInterceptor=!0,l.save(),this.initCanvasCtx(l),l.camera=d.camera,r.isContainer){const u=draw3dItem(l,r,()=>e.pickGroup(r,i,o.parentMatrix,n),n);return l.camera=null,n.in3dInterceptor=!1,l.restore(),u}return l.restore(),null}initCanvasCtx(r){r.setTransformForCurrent()}};Canvas3DPickItemInterceptor=__decorate$R([injectable()],Canvas3DPickItemInterceptor);const pickModule=new ContainerModule((r,e,i)=>{i(PickerService)||(r(GlobalPickerService).toSelf(),r(PickerService).toService(GlobalPickerService)),r(Canvas3DPickItemInterceptor).toSelf().inSingletonScope(),r(PickItemInterceptor).toService(Canvas3DPickItemInterceptor),r(ShadowRootPickItemInterceptorContribution).toSelf().inSingletonScope(),r(PickItemInterceptor).toService(ShadowRootPickItemInterceptorContribution),r(InteractivePickItemInterceptorContribution).toSelf().inSingletonScope(),r(PickItemInterceptor).toService(InteractivePickItemInterceptorContribution),bindContributionProvider(r,PickItemInterceptor)}),graphicModule=new ContainerModule(r=>{r(GraphicService).to(DefaultGraphicService).inSingletonScope(),r(GraphicCreator$1).toConstantValue(graphicCreator)}),AutoEnablePlugins=Symbol.for("AutoEnablePlugins"),PluginService=Symbol.for("PluginService");var __decorate$Q=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$B=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$s=function(r,e){return function(i,n){e(i,n,r)}};let DefaultPluginService=class{constructor(r){this.autoEnablePlugins=r,this.onStartupFinishedPlugin=[],this.onRegisterPlugin=[],this.actived=!1}active(r,e){this.stage=r,this.actived=!0;const{pluginList:i}=e;i&&container.isBound(AutoEnablePlugins)&&this.autoEnablePlugins.getContributions().forEach(n=>{i.includes(n.name)&&this.register(n)})}findPluginsByName(r){const e=[];return this.onStartupFinishedPlugin.forEach(i=>{i.name===r&&e.push(i)}),this.onRegisterPlugin.forEach(i=>{i.name===r&&e.push(i)}),e}register(r){r.activeEvent==="onStartupFinished"?this.onStartupFinishedPlugin.push(r):r.activeEvent==="onRegister"&&(this.onRegisterPlugin.push(r),r.activate(this))}unRegister(r){r.activeEvent==="onStartupFinished"?this.onStartupFinishedPlugin.splice(this.onStartupFinishedPlugin.indexOf(r),1):r.activeEvent==="onRegister"&&this.onRegisterPlugin.splice(this.onStartupFinishedPlugin.indexOf(r),1),r.deactivate(this)}release(...r){this.onStartupFinishedPlugin.forEach(e=>{e.deactivate(this)}),this.onStartupFinishedPlugin=[],this.onRegisterPlugin.forEach(e=>{e.deactivate(this)}),this.onRegisterPlugin=[]}};DefaultPluginService=__decorate$Q([injectable(),__param$s(0,inject(ContributionProvider)),__param$s(0,named(AutoEnablePlugins)),__metadata$B("design:paramtypes",[Object])],DefaultPluginService);const pluginModule=new ContainerModule(r=>{r(PluginService).to(DefaultPluginService),bindContributionProviderNoSingletonScope(r,AutoEnablePlugins)}),envModules=new ContainerModule(r=>{bindContributionProvider(r,EnvContribution)}),textMeasureModules=new ContainerModule(r=>{r(TextMeasureContribution).to(DefaultTextMeasureContribution).inSingletonScope(),bindContributionProvider(r,TextMeasureContribution)});var __decorate$P=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$A=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)};let CanvasLayerHandlerContribution=class{constructor(){this.type="static",this.offscreen=!1,this.global=application.global}setDpr(r){this.canvas.dpr=r}init(r,e,i){if(this.layer=r,this.window=e,i.main)this.main=!0,this.context=e.getContext(),this.canvas=this.context.getCanvas();else{let n;this.main=!1,i.canvasId&&(n=this.global.getElementById(i.canvasId)),n||(n=this.global.createCanvas({width:e.width,height:e.height})),n.style&&(n.style["pointer-events"]="none");const o=e.getContext().getCanvas().nativeCanvas,l=wrapCanvas({nativeCanvas:n,width:e.width,height:e.height,dpr:e.dpr,id:i.canvasId,canvasControled:!0,container:e.getContainer(),x:o.offsetLeft,y:o.offsetTop});l.applyPosition(),this.canvas=l,this.context=l.getContext()}}resize(r,e){this.canvas.resize(r,e)}resizeView(r,e){}render(r,e,i){var n;if(!this.main){const o=this.window.getContext().getCanvas().nativeCanvas;!o||this.canvas.x===o.offsetLeft&&this.canvas.y===o.offsetTop||(this.canvas.x=o.offsetLeft,this.canvas.y=o.offsetTop,this.canvas.applyPosition())}e.renderService.render(r,Object.assign(Object.assign({context:this.context,clear:(n=e.background)!==null&&n!==void 0?n:"#ffffff"},e),i))}merge(r){r.forEach(e=>{const i=e.getContext().canvas.nativeCanvas;this.context.drawImage(i,0,0)})}prepare(r,e){}drawTo(r,e,i){var n;const o=r.getContext();i.renderService.render(e,Object.assign(Object.assign({context:o},i),{clear:i.clear?(n=i.background)!==null&&n!==void 0?n:"#fff":void 0}))}getContext(){return this.context}release(){this.canvas.release()}};CanvasLayerHandlerContribution=__decorate$P([injectable(),__metadata$A("design:paramtypes",[])],CanvasLayerHandlerContribution);const layerHandlerModules=new ContainerModule(r=>{r(CanvasLayerHandlerContribution).toSelf(),r(StaticLayerHandlerContribution).toService(CanvasLayerHandlerContribution)});function load$1(r){r.load(envModules),r.load(textMeasureModules),r.load(layerHandlerModules)}var __awaiter$6=function(r,e,i,n){return new(i||(i=Promise))(function(o,l){function d(g){try{f(n.next(g))}catch(_){l(_)}}function u(g){try{f(n.throw(g))}catch(_){l(_)}}function f(g){var _;g.done?o(g.value):(_=g.value,_ instanceof i?_:new i(function(y){y(_)})).then(d,u)}f((n=n.apply(r,e||[])).next())})};function parseChildMap(r,e,i){const n={},o=[];return r.forEachChildren(l=>{const{zIndex:d=e}=l.attribute;n[d]?n[d].push(l):(n[d]=[l],o.push(d))},i),o.sort((l,d)=>i?d-l:l-d),{childMap:n,zIdxArray:o}}function foreach(r,e,i,n=!1,o=!1){let l=!1;if(o)l=!0;else{let d;r.forEachChildren((u,f)=>{const{zIndex:g=e}=u.attribute;if(f===0)d=g;else if(d!==g)return l=!0,!0;return!1},n)}if(l){const{childMap:d,zIdxArray:u}=parseChildMap(r,e,n);let f=!1;for(let g=0;g<u.length&&!f;g++){const _=d[u[g]];o&&_.sort((y,b)=>{var S,v;return(n?-1:1)*(((S=b.attribute.z)!==null&&S!==void 0?S:0)-((v=y.attribute.z)!==null&&v!==void 0?v:0))});for(let y=0;y<_.length;y++)if(i(_[y],y)){f=!0;break}}}else r.forEachChildren(i,n)}function foreachAsync(r,e,i,n=!1){return __awaiter$6(this,void 0,void 0,function*(){yield r.forEachChildrenAsync(i,n)})}function findNextGraphic(r,e,i,n=!1){let o=!1;r.forEachChildren((u,f)=>{const{zIndex:g=i}=u.attribute;if(f!==0){if(g!==void 0)return o=!0,!0}return!1},n);let l=null,d=!1;if(o){const{childMap:u,zIdxArray:f}=parseChildMap(r,i,n);let g=!1;for(let _=0;_<f.length&&!g;_++){const y=u[f[_]];for(let b=0;b<y.length;b++){if(d){g=!0,l=y[b];break}y[b]._uid!==e||(d=!0)}}}else r.forEachChildren(u=>d?(l=u,!0):(u._uid===e&&(d=!0),!1),n);return l}var __decorate$O=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$z=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$r=function(r,e){return function(i,n){e(i,n,r)}};let DefaultDrawContribution=class{constructor(r,e){this.contributions=r,this.drawItemInterceptorContributions=e,this.currentRenderMap=new Map,this.defaultRenderMap=new Map,this.styleRenderMap=new Map,this.dirtyBounds=new Bounds,this.backupDirtyBounds=new Bounds,this.global=application.global,this.layerService=application.layerService,this.init()}init(){this.contributions.forEach(r=>{if(r.style){const e=this.styleRenderMap.get(r.style)||new Map;e.set(r.numberType,r),this.styleRenderMap.set(r.style,e)}else this.defaultRenderMap.set(r.numberType,r)}),this.InterceptorContributions=this.drawItemInterceptorContributions.getContributions().sort((r,e)=>r.order-e.order)}prepareForDraw(r,e){e.updateBounds?this.useDirtyBounds=!0:this.useDirtyBounds=!e.stage.params.optimize.disableCheckGraphicWidthOutRange}draw(r,e){this.prepareForDraw(r,e),e.drawContribution=this,this.currentRenderMap=this.styleRenderMap.get(e.renderStyle)||this.defaultRenderMap,this.currentRenderService=r;const{context:i,stage:n,viewBox:o,transMatrix:l}=e;if(!i)return;const d=this.dirtyBounds.setValue(0,0,o.width(),o.height());if(n.dirtyBounds&&!n.dirtyBounds.empty()){const f=getRectIntersect(d,n.dirtyBounds,!1);d.x1=Math.floor(f.x1),d.y1=Math.floor(f.y1),d.x2=Math.ceil(f.x2),d.y2=Math.ceil(f.y2)}const u=i.dpr%1;(u||u!==.5)&&(d.x1=Math.floor(d.x1*i.dpr)/i.dpr,d.y1=Math.floor(d.y1*i.dpr)/i.dpr,d.x2=Math.ceil(d.x2*i.dpr)/i.dpr,d.y2=Math.ceil(d.y2*i.dpr)/i.dpr),this.backupDirtyBounds.copy(d),i.inuse=!0,i.setClearMatrix(l.a,l.b,l.c,l.d,l.e,l.f),i.clearMatrix(),i.setTransformForCurrent(!0),i.translate(o.x1,o.y1,!0),i.beginPath(),i.rect(d.x1,d.y1,d.width(),d.height()),i.clip(),n.camera&&(this.dirtyBounds.setValue(-1/0,-1/0,1/0,1/0),this.backupDirtyBounds.setValue(-1/0,-1/0,1/0,1/0)),this.clearScreen(r,i,e),i.save(),r.renderTreeRoots.sort((f,g)=>{var _,y;return((_=f.attribute.zIndex)!==null&&_!==void 0?_:DefaultAttribute.zIndex)-((y=g.attribute.zIndex)!==null&&y!==void 0?y:DefaultAttribute.zIndex)}).forEach(f=>{f.isContainer?this.renderGroup(f,e,matrixAllocate.allocate(1,0,0,1,0,0)):this.renderItem(f,e)}),i.restore(),i.setClearMatrix(1,0,0,1,0,0),i.inuse=!1,i.draw()}doRegister(){throw new Error("")}_findNextGraphic(r){let e=r.parent,i=r._uid;for(;e;){const n=findNextGraphic(e,i,DefaultAttribute.zIndex);if(n)return n;i=e._uid,e=e.parent}return null}renderGroup(r,e,i,n){if(e.break||r.attribute.visibleAll===!1)return;if(r.incremental&&(e.startAtId==null||e.startAtId===r._uid))return e.break=!0,void this._increaseRender(r,e);if(this.useDirtyBounds&&!isRectIntersect(r.AABBBounds,this.dirtyBounds,!1))return;let o,l=i;if(this.useDirtyBounds){o=boundsAllocate.allocateByObj(this.dirtyBounds);const d=r.transMatrix;l=matrixAllocate.allocateByObj(i).multiply(d.a,d.b,d.c,d.d,d.e,d.f),this.dirtyBounds.copy(this.backupDirtyBounds).transformWithMatrix(l.getInverse())}this.renderItem(r,e,{drawingCb:()=>{var d;n?r.forEachChildren(u=>{e.break||(u.isContainer?this.renderGroup(u,e,l):this.renderItem(u,e))}):foreach(r,DefaultAttribute.zIndex,u=>{e.break||(u.isContainer?this.renderGroup(u,e,l):this.renderItem(u,e))},!1,!!(!((d=e.context)===null||d===void 0)&&d.camera))}}),this.useDirtyBounds&&(this.dirtyBounds.copy(o),boundsAllocate.free(o),matrixAllocate.free(l))}_increaseRender(r,e){const{layer:i,stage:n}=e,{subLayers:o}=i;let l=o.get(r._uid);l||(l={layer:this.layerService.createLayer(n),zIndex:o.size,group:r},o.set(r._uid,l));const d=l.layer.getNativeHandler().getContext(),u=l.drawContribution||container.get(IncrementalDrawContribution);u.dirtyBounds.setValue(-1/0,-1/0,1/0,1/0),u.backupDirtyBounds.setValue(-1/0,-1/0,1/0,1/0),u.draw(this.currentRenderService,Object.assign(Object.assign({},e),{drawContribution:u,clear:"transparent",layer:l.layer,context:d,startAtId:r._uid,break:!1})),l.drawContribution=u;const f=this._findNextGraphic(r);if(f)if(f.isContainer&&f.incremental)this._increaseRender(f,e);else{let g=o.get(f._uid);g||(g={layer:this.layerService.createLayer(n),zIndex:o.size},o.set(f._uid,g));const _=g.layer.getNativeHandler().getContext();this.draw(this.currentRenderService,Object.assign(Object.assign({},e),{drawContribution:u,clear:"transparent",layer:g.layer,context:_,startAtId:f._uid,break:!1}))}}getRenderContribution(r){let e;return e||(e=this.selectRenderByNumberType(r.numberType,r)),e||(e=this.selectRenderByType(r.type)),e}renderItem(r,e,i){if(this.InterceptorContributions.length)for(let u=0;u<this.InterceptorContributions.length;u++){const f=this.InterceptorContributions[u];if(f.beforeDrawItem&&f.beforeDrawItem(r,this.currentRenderService,e,this,i))return}const n=this.getRenderContribution(r);if(!n)return;let o,l=this.scrollMatrix&&(this.scrollMatrix.e!==0||this.scrollMatrix.f!==0);if(r.parent){const{scrollX:u=0,scrollY:f=0}=r.parent.attribute;(u||f)&&(l=!0,this.scrollMatrix||(this.scrollMatrix=matrixAllocate.allocate(1,0,0,1,0,0)),this.scrollMatrix.translate(-u,-f))}if(l&&(o=this.dirtyBounds.clone().transformWithMatrix(this.scrollMatrix)),this.useDirtyBounds&&!r.isContainer&&!isRectIntersect(r.AABBBounds,o??this.dirtyBounds,!1)){if(l&&r.parent){const{scrollX:u=0,scrollY:f=0}=r.parent.attribute;this.scrollMatrix&&this.scrollMatrix.translate(u,f)}return}const d=e.startAtId!=null&&r._uid!==e.startAtId;if(r._uid===e.startAtId&&(e.startAtId=null),i&&(i.skipDraw=d),d?r.isContainer&&n.draw(r,this.currentRenderService,e,i):n.draw(r,this.currentRenderService,e,i),l&&r.parent){const{scrollX:u=0,scrollY:f=0}=r.parent.attribute;this.scrollMatrix&&this.scrollMatrix.translate(u,f)}if(this.InterceptorContributions.length)for(let u=0;u<this.InterceptorContributions.length;u++){const f=this.InterceptorContributions[u];if(f.afterDrawItem&&f.afterDrawItem(r,this.currentRenderService,e,this))return}}selectRenderByType(r){return Logger.getInstance().warn(""),null}selectRenderByNumberType(r,e){let i;if(e.attribute.renderStyle){const n=this.styleRenderMap.get(e.attribute.renderStyle);i=n&&n.get(r)}return i||this.currentRenderMap.get(r)||this.defaultRenderMap.get(r)}clearScreen(r,e,i){var n,o;const{clear:l,viewBox:d}=i,u=d.width(),f=d.height();if(l){e.clearRect(0,0,u,f);const g=(n=r.drawParams)===null||n===void 0?void 0:n.stage;if(g&&(e.globalAlpha=(o=g.attribute.opacity)!==null&&o!==void 0?o:1),g&&g.backgroundImg&&g.resources){const _=g.resources.get(l);_&&_.state==="success"&&_.data&&e.drawImage(_.data,0,0,u,f)}else e.fillStyle=createColor(e,l,{AABBBounds:{x1:0,y1:0,x2:0+u,y2:0+f}},0,0),e.fillRect(0,0,u,f)}}afterDraw(r,e){}};DefaultDrawContribution=__decorate$O([injectable(),__param$r(0,multiInject(GraphicRender)),__param$r(1,inject(ContributionProvider)),__param$r(1,named(DrawItemInterceptor)),__metadata$z("design:paramtypes",[Array,Object])],DefaultDrawContribution);var __decorate$N=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d};let DefaultIncrementalCanvasLineRender=class extends DefaultCanvasLineRender{constructor(){super(...arguments),this.numberType=LINE_NUMBER_TYPE}drawShape(r,e,i,n,o,l,d,u){if(r.incremental&&o.multiGraphicOptions){const{startAtIdx:f,length:g}=o.multiGraphicOptions,{segments:_=[]}=r.attribute;if(f>_.length)return;const y=getTheme$1(r).line,{fill:b=y.fill,stroke:S=y.stroke,opacity:v=y.opacity,fillOpacity:A=y.fillOpacity,strokeOpacity:x=y.strokeOpacity,lineWidth:T=y.lineWidth,visible:C=y.visible}=r.attribute,E=fillVisible(v,A,b),P=strokeVisible(v,x),R=runFill(b),L=runStroke(S,T);if(!r.valid||!C||!R&&!L||!(E||P||d||u))return;const{context:w}=o;for(let B=f;B<f+g;B++)this.drawIncreaseSegment(r,w,_[B-1],_[B],r.attribute.segments[B],[y,r.attribute],i,n)}else super.drawShape(r,e,i,n,o,l,d,u)}drawIncreaseSegment(r,e,i,n,o,l,d,u){n&&(e.beginPath(),drawIncrementalSegments(e.nativeContext,i,n,{offsetX:d,offsetY:u}),e.setShadowBlendStyle&&e.setShadowBlendStyle(r,o,l),e.setStrokeStyle(r,o,d,u,l),e.stroke())}};DefaultIncrementalCanvasLineRender=__decorate$N([injectable()],DefaultIncrementalCanvasLineRender);var __decorate$M=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d};let DefaultIncrementalCanvasAreaRender=class extends DefaultCanvasAreaRender{constructor(){super(...arguments),this.numberType=AREA_NUMBER_TYPE}drawShape(r,e,i,n,o,l,d){if(r.incremental&&o.multiGraphicOptions){const{startAtIdx:u,length:f}=o.multiGraphicOptions,{segments:g=[]}=r.attribute;if(u>g.length)return;const _=getTheme$1(r).area,{fill:y=_.fill,fillOpacity:b=_.fillOpacity,opacity:S=_.opacity,visible:v=_.visible}=r.attribute,A=fillVisible(S,b,y),x=runFill(y);if(!r.valid||!v||!x||!A&&!d)return;for(let T=u;T<u+f;T++)this.drawIncreaseSegment(r,e,g[T-1],g[T],r.attribute.segments[T],[_,r.attribute],i,n)}else super.drawShape(r,e,i,n,o,l,d)}drawIncreaseSegment(r,e,i,n,o,l,d,u){n&&(e.beginPath(),drawIncrementalAreaSegments(e.camera?e:e.nativeContext,i,n,{offsetX:d,offsetY:u}),e.setShadowBlendStyle&&e.setShadowBlendStyle(r,o,l),e.setCommonStyle(r,o,d,u,l),e.fill())}};DefaultIncrementalCanvasAreaRender=__decorate$M([injectable()],DefaultIncrementalCanvasAreaRender);var STATUS,__decorate$L=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$y=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$q=function(r,e){return function(i,n){e(i,n,r)}},__awaiter$5=function(r,e,i,n){return new(i||(i=Promise))(function(o,l){function d(g){try{f(n.next(g))}catch(_){l(_)}}function u(g){try{f(n.throw(g))}catch(_){l(_)}}function f(g){var _;g.done?o(g.value):(_=g.value,_ instanceof i?_:new i(function(y){y(_)})).then(d,u)}f((n=n.apply(r,e||[])).next())})};(function(r){r[r.NORMAL=0]="NORMAL",r[r.STOP=1]="STOP"})(STATUS||(STATUS={}));let DefaultIncrementalDrawContribution=class extends DefaultDrawContribution{constructor(r,e,i,n){super(r,n),this.contributions=r,this.lineRender=e,this.areaRender=i,this.drawItemInterceptorContributions=n,this.rendering=!1,this.currFrameStartAt=0,this.currentIdx=0,this.status=STATUS.NORMAL,this.checkingForDrawPromise=null,this.hooks={completeDraw:new SyncHook([])},this.defaultRenderMap.set(this.lineRender.numberType,this.lineRender),this.defaultRenderMap.set(this.areaRender.numberType,this.areaRender)}draw(r,e){return __awaiter$5(this,void 0,void 0,function*(){if(this.checkingForDrawPromise)return;this.lastRenderService=r,this.lastDrawContext=e,this.checkingForDrawPromise=this.checkForDraw(e);const i=yield this.checkingForDrawPromise;if(this.checkingForDrawPromise=null,i)return;this.currentRenderService=r;const{context:n,viewBox:o}=e;n&&(n.inuse=!0,n.clearMatrix(),n.setTransformForCurrent(!0),n.save(),e.restartIncremental&&this.clearScreen(this.currentRenderService,n,e),n.translate(o.x1,o.y1,!0),n.save(),r.renderTreeRoots.sort((l,d)=>{var u,f;return((u=l.attribute.zIndex)!==null&&u!==void 0?u:DefaultAttribute.zIndex)-((f=d.attribute.zIndex)!==null&&f!==void 0?f:DefaultAttribute.zIndex)}).forEach(l=>{this.renderGroup(l,e)}),this.hooks.completeDraw.tap("top-draw",()=>{n.restore(),n.restore(),n.draw(),n.inuse=!1,this.rendering=!1}))})}_increaseRender(r,e){return __awaiter$5(this,void 0,void 0,function*(){this.rendering=!0,yield this._renderIncrementalGroup(r,e)})}_renderIncrementalGroup(r,e){return __awaiter$5(this,void 0,void 0,function*(){this.count=r.count,yield new Promise(i=>{this.renderItem(r,e,{drawingCb:()=>__awaiter$5(this,void 0,void 0,function*(){if(r.count!==2)yield foreachAsync(r,DefaultAttribute.zIndex,(n,o)=>{if(this.status===STATUS.STOP)return!0;if(n.isContainer||o<this.currentIdx)return!1;const l=this.currFrameStartAt+r.incremental;return o<l&&(this.currentIdx=o+1,this.renderItem(n,e)),o===l-1&&(this.currFrameStartAt=this.currentIdx,this.waitToNextFrame())}),i(!1);else{const n=r.getChildAt(0);if(n.incremental&&n.attribute.segments)for(n.incrementalAt||(n.incrementalAt=0);n.incrementalAt<n.attribute.segments.length;)e.multiGraphicOptions={startAtIdx:n.incrementalAt,length:n.incremental},this.renderItem(n,e),n.incrementalAt+=n.incremental,yield this.waitToNextFrame();else this.renderItem(n,e);i(!1)}})})}),this.hooks.completeDraw.call()})}waitToNextFrame(){return __awaiter$5(this,void 0,void 0,function*(){return new Promise(r=>{this.global.getRequestAnimationFrame()(()=>{r(!1)})})})}checkForDraw(r){return __awaiter$5(this,void 0,void 0,function*(){let e=this.rendering;return r.restartIncremental&&(e=!1,yield this.forceStop(),this.resetToInit()),e})}forceStop(){return __awaiter$5(this,void 0,void 0,function*(){this.rendering&&(this.status=STATUS.STOP,yield new Promise(r=>{this.hooks.completeDraw.tap("stopCb",()=>{this.status=STATUS.NORMAL,this.hooks.completeDraw.taps=this.hooks.completeDraw.taps.filter(e=>e.name!=="stopCb"),r(!1)})}))})}resetToInit(){this.currFrameStartAt=0,this.currentIdx=0}renderGroup(r,e){return __awaiter$5(this,void 0,void 0,function*(){if(!e.break&&r.attribute.visibleAll!==!1)return r.incremental&&e.startAtId===r._uid?(yield this._increaseRender(r,e),void(e.break=!0)):void(yield new Promise(i=>{this.renderItem(r,e,{drawingCb:()=>__awaiter$5(this,void 0,void 0,function*(){yield foreachAsync(r,DefaultAttribute.zIndex,n=>__awaiter$5(this,void 0,void 0,function*(){e.break||n.isContainer&&(yield this.renderGroup(n,e))})),i(!1)})})}))})}};DefaultIncrementalDrawContribution=__decorate$L([injectable(),__param$q(0,multiInject(GraphicRender)),__param$q(1,inject(DefaultIncrementalCanvasLineRender)),__param$q(2,inject(DefaultIncrementalCanvasAreaRender)),__param$q(3,inject(ContributionProvider)),__param$q(3,named(DrawItemInterceptor)),__metadata$y("design:paramtypes",[Array,Object,Object,Object])],DefaultIncrementalDrawContribution);const renderModule=new ContainerModule(r=>{r(DefaultBaseBackgroundRenderContribution).toSelf().inSingletonScope(),r(DefaultBaseTextureRenderContribution).toSelf().inSingletonScope(),r(DrawContribution).to(DefaultDrawContribution),r(IncrementalDrawContribution).to(DefaultIncrementalDrawContribution),r(GroupRender).to(DefaultCanvasGroupRender).inSingletonScope(),r(GraphicRender).toService(GroupRender),bindContributionProvider(r,GroupRenderContribution),r(DefaultBaseInteractiveRenderContribution).toSelf().inSingletonScope(),bindContributionProvider(r,InteractiveSubRenderContribution),bindContributionProvider(r,GraphicRender),r(CommonDrawItemInterceptorContribution).toSelf().inSingletonScope(),r(DrawItemInterceptor).toService(CommonDrawItemInterceptorContribution),bindContributionProvider(r,DrawItemInterceptor)});function load(r){r.load(renderModule)}function preLoadAllModule(){preLoadAllModule.__loaded||(preLoadAllModule.__loaded=!0,container.load(coreModule),container.load(graphicModule),container.load(renderModule$1),container.load(pickModule),container.load(pluginModule),load$1(container),load(container))}preLoadAllModule.__loaded=!1,preLoadAllModule();const vglobal=container.get(VGlobal);application.global=vglobal;const graphicUtil=container.get(GraphicUtil);application.graphicUtil=graphicUtil;const transformUtil=container.get(TransformUtil);application.transformUtil=transformUtil;const graphicService=container.get(GraphicService);application.graphicService=graphicService;const layerService=container.get(LayerService);application.layerService=layerService;class AutoRenderPlugin{constructor(){this.name="AutoRenderPlugin",this.activeEvent="onRegister",this._uid=Generator.GenAutoIncrementId(),this.key=this.name+this._uid,this.handleChange=e=>{e.glyphHost&&(e=e.glyphHost),e.stage===this.pluginService.stage&&e.stage!=null&&e.stage.renderNextFrame()}}activate(e){this.pluginService=e,application.graphicService.hooks.onAttributeUpdate.tap(this.key,this.handleChange),application.graphicService.hooks.onSetStage.tap(this.key,this.handleChange),application.graphicService.hooks.onRemove.tap(this.key,this.handleChange)}deactivate(e){const i=n=>n.filter(o=>o.name!==this.key);application.graphicService.hooks.onAttributeUpdate.taps=i(application.graphicService.hooks.onAttributeUpdate.taps),application.graphicService.hooks.onSetStage.taps=i(application.graphicService.hooks.onSetStage.taps),application.graphicService.hooks.onRemove.taps=i(application.graphicService.hooks.onRemove.taps)}}class AutoRefreshPlugin{constructor(){this.name="AutoRefreshPlugin",this.activeEvent="onRegister",this._uid=Generator.GenAutoIncrementId(),this.key=this.name+this._uid,this.handleChange=e=>{e.glyphHost&&(e=e.glyphHost),e.stage===this.pluginService.stage&&e.stage!=null&&e.stage.renderNextFrame()}}activate(e){this.pluginService=e,this.dpr=application.global.devicePixelRatio,this.refresh()}refresh(){this._refreshByMediaQuery()||this._refreshByRaf()}_refreshByRaf(){const e=application.global.getRequestAnimationFrame();this.rafId=e(()=>{application.global.devicePixelRatio!==this.dpr&&(this.dpr=application.global.devicePixelRatio,this.pluginService.stage.setDpr(this.dpr,!0)),this.refresh()})}_refreshByMediaQuery(){try{const e=`(resolution: ${window.devicePixelRatio}dppx)`,i=()=>{window.devicePixelRatio!==this.dpr&&(this.dpr=window.devicePixelRatio,this.pluginService.stage.setDpr(this.dpr,!0))};matchMedia(e).addEventListener("change",i)}catch{return!1}return!0}deactivate(e){const i=application.global.getCancelAnimationFrame();i&&this.rafId&&i(this.rafId)}}class IncrementalAutoRenderPlugin{constructor(){this.name="IncrementalAutoRenderPlugin",this.activeEvent="onRegister",this.nextFrameRenderGroupSet=new Set,this.willNextFrameRender=!1,this.nextUserParams={},this._uid=Generator.GenAutoIncrementId(),this.key=this.name+this._uid}activate(e){this.pluginService=e,application.graphicService.hooks.onAddIncremental.tap(this.key,(i,n,o)=>{i.glyphHost&&(i=i.glyphHost),i.stage===e.stage&&i.stage!=null&&(this.nextUserParams.startAtId=n._uid,this.renderNextFrame(n))}),application.graphicService.hooks.onClearIncremental.tap(this.key,(i,n)=>{i.stage===e.stage&&i.stage!=null&&(this.nextUserParams.startAtId=i._uid,this.nextUserParams.restartIncremental=!0,this.renderNextFrame(i))})}deactivate(e){application.graphicService.hooks.onAddIncremental.taps=application.graphicService.hooks.onAddIncremental.taps.filter(i=>i.name!==this.key),application.graphicService.hooks.onClearIncremental.taps=application.graphicService.hooks.onClearIncremental.taps.filter(i=>i.name!==this.key)}renderNextFrame(e){this.nextFrameRenderGroupSet.add(e),this.willNextFrameRender||(this.willNextFrameRender=!0,application.global.getRequestAnimationFrame()(()=>{this._doRenderInThisFrame(),this.willNextFrameRender=!1}))}_doRenderInThisFrame(){const e=this.pluginService.stage;this.nextFrameRenderGroupSet.size&&(this.nextFrameRenderGroupSet.forEach(i=>{const n=i.layer;if(!n||!i.layer.subLayers)return;const o=i.layer.subLayers.get(i._uid);o&&o.drawContribution&&o.drawContribution.draw(e.renderService,Object.assign({stage:e,layer:n,viewBox:e.window.getViewBox(),transMatrix:e.window.getViewBoxTransform(),clear:"transparent",renderService:e.renderService,updateBounds:!1,startAtId:i._uid,context:o.layer.getNativeHandler().getContext()},this.nextUserParams))}),this.nextUserParams={},this.nextFrameRenderGroupSet.clear())}}const globalBounds=new AABBBounds;class DirtyBoundsPlugin{constructor(){this.name="DirtyBoundsPlugin",this.activeEvent="onRegister",this._uid=Generator.GenAutoIncrementId(),this.key=this.name+this._uid}activate(e){this.pluginService=e,e.stage.hooks.afterRender.tap(this.key,i=>{i&&i===this.pluginService.stage&&i.dirtyBounds.clear()}),application.graphicService.hooks.beforeUpdateAABBBounds.tap(this.key,(i,n,o,l)=>{i.glyphHost&&(i=i.glyphHost),n&&n===this.pluginService.stage&&n.renderCount&&(i.isContainer&&!i.shouldSelfChangeUpdateAABBBounds()||o&&(globalBounds.setValue(l.x1,l.y1,l.x2,l.y2),n.dirty(globalBounds,i.parent&&i.parent.globalTransMatrix)))}),application.graphicService.hooks.afterUpdateAABBBounds.tap(this.key,(i,n,o,l,d)=>{n&&n===this.pluginService.stage&&n.renderCount&&(i.isContainer&&!d||n.dirty(l.globalAABBBounds))}),application.graphicService.hooks.clearAABBBounds.tap(this.key,(i,n,o)=>{n&&n===this.pluginService.stage&&n.renderCount&&n&&n.dirty(o)}),application.graphicService.hooks.onRemove.tap(this.key,i=>{const n=i.stage;n&&n===this.pluginService.stage&&n.renderCount&&n&&n.dirty(i.globalAABBBounds)})}deactivate(e){application.graphicService.hooks.beforeUpdateAABBBounds.taps=application.graphicService.hooks.beforeUpdateAABBBounds.taps.filter(i=>i.name!==this.key),application.graphicService.hooks.afterUpdateAABBBounds.taps=application.graphicService.hooks.afterUpdateAABBBounds.taps.filter(i=>i.name!==this.key),application.graphicService.hooks.clearAABBBounds.taps=application.graphicService.hooks.clearAABBBounds.taps.filter(i=>i.name!==this.key),e.stage.hooks.afterRender.taps=e.stage.hooks.afterRender.taps.filter(i=>i.name!==this.key),application.graphicService.hooks.onRemove.taps=application.graphicService.hooks.onRemove.taps.filter(i=>i.name!==this.key)}}const defaultTicker=new DefaultTicker;defaultTicker.addTimeline(defaultTimeline);defaultTicker.setFPS(60);let _isBrowserEnv;function initIsBrowserEnv(){if(_isBrowserEnv==null)try{const r=document.createElement("canvas"),e=r.getContext("2d");_isBrowserEnv=!!(window&&r.getBoundingClientRect&&requestAnimationFrame&&window.devicePixelRatio&&e&&e.isPointInPath&&e.isPointInStroke),_isBrowserEnv&&(_isBrowserEnv=!!document.createElement)}catch{_isBrowserEnv=!1}}function isBrowserEnv(){initIsBrowserEnv();const r=application.global&&application.global.env;return r?r==="browser":_isBrowserEnv}let Factory$2=class De{static registerPlugin(e,i){De._pluginClasses[e]=i}static getPlugin(e){return De._pluginClasses[e]}};Factory$2._pluginClasses={};const DefaultConfig$1={BACKGROUND:"white"};class Stage extends Group$1{set viewBox(e){this.window.setViewBox(e)}get viewBox(){return this.window.getViewBox()}get x(){return this.window.getViewBox().x1}set x(e){const i=this.window.getViewBox();i.translate(e-i.x1,0),this.window.setViewBox(i)}get y(){return this.window.getViewBox().y1}set y(e){const i=this.window.getViewBox();i.translate(0,e-i.y1),this.window.setViewBox(i)}get width(){return this.window.width}set width(e){this.resize(e,this.height)}get viewWidth(){return this.window.getViewBox().width()}set viewWidth(e){this.resizeView(e,this.viewHeight)}get viewHeight(){return this.window.getViewBox().height()}set viewHeight(e){this.resizeView(this.viewWidth,e)}get height(){return this.window.height}set height(e){this.resize(this.width,e)}get dpr(){return this.window.dpr}set dpr(e){this.setDpr(e)}get background(){var e;return(e=this._background)!==null&&e!==void 0?e:DefaultConfig$1.BACKGROUND}set background(e){this._background=e}get defaultLayer(){return this.at(0)}get eventSystem(){return this._eventSystem}constructor(e={}){var i;super({}),this.tickedBeforeRender=!0,this._onVisibleChange=n=>{if(!(this._skipRender<0))if(n){if(this.dirtyBounds){const o=this.window.getViewBox();this.dirtyBounds.setValue(o.x1,o.y1,o.width(),o.height())}this._skipRender>1&&this.renderNextFrame(),this._skipRender=0}else this._skipRender=1},this.beforeRender=n=>{this._beforeRender&&this._beforeRender(n)},this.afterRender=n=>{this.renderCount++,this._afterRender&&this._afterRender(n),this._afterNextRenderCbs&&this._afterNextRenderCbs.forEach(o=>o(n)),this._afterNextRenderCbs=null,this.tickedBeforeRender=!1},this.afterTickCb=()=>{var n;this.tickedBeforeRender=!0,((n=this.params.optimize)===null||n===void 0?void 0:n.tickRenderMode)==="performance"||this.state!=="rendering"&&this.render()},this.params=e,this.theme=new Theme,this.hooks={beforeRender:new SyncHook(["stage"]),afterRender:new SyncHook(["stage"])},this.global=application.global,!this.global.env&&isBrowserEnv()&&this.global.setEnv("browser"),this.window=container.get(VWindow),this.renderService=container.get(RenderService),this.pluginService=container.get(PluginService),this.layerService=container.get(LayerService),this.pluginService.active(this,e),this.window.create({width:e.width,height:e.height,viewBox:e.viewBox,container:e.container,dpr:e.dpr||this.global.devicePixelRatio,canvasControled:e.canvasControled!==!1,title:e.title||"",canvas:e.canvas}),this.state="normal",this.renderCount=0,this.tryInitEventSystem(),this._background=(i=e.background)!==null&&i!==void 0?i:DefaultConfig$1.BACKGROUND,this.appendChild(this.layerService.createLayer(this,{main:!0})),this.nextFrameRenderLayerSet=new Set,this.willNextFrameRender=!1,this.stage=this,this.renderStyle=e.renderStyle,e.autoRender&&this.enableAutoRender(),e.autoRefresh&&this.enableAutoRefresh(),e.disableDirtyBounds===!1&&this.enableDirtyBounds(),e.enableHtmlAttribute&&this.enableHtmlAttribute(e.enableHtmlAttribute),e.ReactDOM&&this.enableReactAttribute(e.ReactDOM),e.enableLayout&&this.enableLayout(),this.hooks.beforeRender.tap("constructor",this.beforeRender),this.hooks.afterRender.tap("constructor",this.afterRender),this._beforeRender=e.beforeRender,this._afterRender=e.afterRender,this.ticker=e.ticker||defaultTicker,this.supportInteractiveLayer=e.interactiveLayer!==!1,this.timeline=new DefaultTimeline,this.ticker.addTimeline(this.timeline),this.timeline.pause(),e.optimize||(e.optimize={}),this.optmize(e.optimize),e.background&&isString(this._background)&&this._background.includes("/")&&this.setAttributes({background:this._background}),this.ticker.on("afterTick",this.afterTickCb)}pauseRender(e=-1){this._skipRender=e}resumeRender(){this._skipRender=0}tryInitEventSystem(){this.global.supportEvent&&!this._eventSystem&&(this._eventSystem=new EventSystem(Object.assign({targetElement:this.window,resolution:this.window.dpr||this.global.devicePixelRatio,rootNode:this,global:this.global,supportsPointerEvents:this.params.supportsPointerEvents,supportsTouchEvents:this.params.supportsTouchEvents},this.params.event)))}preventRender(e){e?this._skipRender=-1/0:this.params.optimize.skipRenderWithOutRange!==!1?this._skipRender=this.window.isVisible()?0:1:this._skipRender=0}optmize(e){this.optmizeRender(e.skipRenderWithOutRange),this.params.optimize=e}optmizeRender(e=!1){e&&(this._skipRender=this._skipRender<0?this._skipRender:this.window.isVisible()?0:1,this.window.onVisibleChange(this._onVisibleChange))}getTimeline(){return this.timeline}get3dOptions(e){const{center:i={x:this.width/2,y:this.height/2,z:0,dx:0,dy:0,dz:0},light:n={},alpha:o=0,beta:l=0,camera:d,fieldRatio:u=1,fieldDepth:f}=e;return Object.assign(Object.assign({},e),{center:i,light:n,alpha:o,beta:l,camera:d,fieldRatio:u,fieldDepth:f})}set3dOptions(e){var i,n,o,l,d,u;this.option3d=e;const f=this.get3dOptions(e),{light:g,center:_,camera:y,alpha:b,beta:S,fieldRatio:v,fieldDepth:A}=f,{dir:x=[1,1,-1],color:T="white",ambient:C}=g,E=((i=_.x)!==null&&i!==void 0?i:this.width/2)+((n=_.dx)!==null&&n!==void 0?n:0),P=((o=_.y)!==null&&o!==void 0?o:this.height/2)+((l=_.dy)!==null&&l!==void 0?l:0),R=[E,P,((d=_.z)!==null&&d!==void 0?d:0)+((u=_.dz)!==null&&u!==void 0?u:0)];let L=0,w=0,B=0;y||(L=Math.sin(b)+E,w=Math.sin(S)+P,B=Math.cos(b)*Math.cos(S)*1);const I=Factory$2.getPlugin("DirectionalLight");I&&(this.light=new I(x,T,C));const D={left:0,right:this.width,top:0,bottom:this.height,fieldRatio:v,fieldDepth:A,viewParams:{pos:[L,w,B],center:R,up:[0,1,0]}};if(this.camera)this.camera.params=D;else{const O=Factory$2.getPlugin("OrthoCamera");O&&(this.camera=new O(D))}e.enableView3dTransform&&this.enableView3dTransform()}setBeforeRender(e){this._beforeRender=e}setAfterRender(e){this._afterRender=e}afterNextRender(e){this._afterNextRenderCbs||(this._afterNextRenderCbs=[]),this._afterNextRenderCbs.push(e)}enableView3dTransform(){if(this.view3dTranform)return;this.view3dTranform=!0;const e=Factory$2.getPlugin("ViewTransform3dPlugin");e&&this.pluginService.register(new e)}disableView3dTranform(){this.view3dTranform&&(this.view3dTranform=!1,this.pluginService.findPluginsByName("ViewTransform3dPlugin").forEach(e=>{this.pluginService.unRegister(e)}))}enableAutoRender(){this.autoRender||(this.autoRender=!0,this.pluginService.register(new AutoRenderPlugin))}disableAutoRender(){this.autoRender&&(this.autoRender=!1,this.pluginService.findPluginsByName("AutoRenderPlugin").forEach(e=>{this.pluginService.unRegister(e)}))}enableAutoRefresh(){this.autoRefresh||(this.autoRefresh=!0,this.pluginService.register(new AutoRefreshPlugin))}disableAutoRefresh(){this.autoRefresh&&(this.autoRefresh=!1,this.pluginService.findPluginsByName("AutoRefreshPlugin").forEach(e=>{this.pluginService.unRegister(e)}))}enableIncrementalAutoRender(){this.increaseAutoRender||(this.increaseAutoRender=!0,this.pluginService.register(new IncrementalAutoRenderPlugin))}disableIncrementalAutoRender(){this.increaseAutoRender&&(this.increaseAutoRender=!1,this.pluginService.findPluginsByName("IncrementalAutoRenderPlugin").forEach(e=>{this.pluginService.unRegister(e)}))}enableDirtyBounds(){if(this.dirtyBounds)return;this.dirtyBounds=new Bounds;let e=this.pluginService.findPluginsByName("DirtyBoundsPlugin")[0];e?e.activate(this.pluginService):(e=new DirtyBoundsPlugin,this.pluginService.register(e))}disableDirtyBounds(){this.dirtyBounds&&(this.dirtyBounds=null,this.pluginService.findPluginsByName("DirtyBoundsPlugin").forEach(e=>{this.pluginService.unRegister(e)}))}enableLayout(){if(this._enableLayout)return;this._enableLayout=!0;const e=Factory$2.getPlugin("FlexLayoutPlugin");e&&this.pluginService.register(new e)}disableLayout(){this._enableLayout&&(this._enableLayout=!1,this.pluginService.findPluginsByName("FlexLayoutPlugin").forEach(e=>{this.pluginService.unRegister(e)}))}enableHtmlAttribute(e){if(this.htmlAttribute)return;const i=Factory$2.getPlugin("HtmlAttributePlugin");i&&(this.htmlAttribute=e,this.pluginService.register(new i))}disableHtmlAttribute(){this.htmlAttribute&&(this.htmlAttribute=!1,this.pluginService.findPluginsByName("HtmlAttributePlugin").forEach(e=>{this.pluginService.unRegister(e)}))}enableReactAttribute(e){if(this.reactAttribute)return;const i=Factory$2.getPlugin("ReactAttributePlugin");i&&(this.reactAttribute=e,this.pluginService.register(new i))}disableReactAttribute(){this.reactAttribute&&(this.reactAttribute=!1,this.pluginService.findPluginsByName("ReactAttributePlugin").forEach(e=>{this.pluginService.unRegister(e)}))}getPluginsByName(e){return this.pluginService.findPluginsByName(e)}tryUpdateAABBBounds(){const e=this.window.getViewBox();return this._AABBBounds.setValue(e.x1,e.y1,e.x2,e.y2),this._AABBBounds}combineLayer(e,i){throw new Error("")}createLayer(e,i){if(this.releaseStatus==="released")return;const n=this.layerService.createLayer(this,{main:!1,layerMode:i,canvasId:e});return this.appendChild(n),n}sortLayer(e){const i=this.children;i.sort(e),this.removeAllChild(),i.forEach(n=>{this.appendChild(n)})}removeLayer(e){return this.removeChild(this.findChildByUid(e))}tryInitInteractiveLayer(){this.releaseStatus!=="released"&&this.supportInteractiveLayer&&!this.interactiveLayer&&(this.interactiveLayer=this.createLayer(),this.interactiveLayer.name="_builtin_interactive",this.interactiveLayer.attribute.pickable=!1,this.nextFrameRenderLayerSet.add(this.interactiveLayer))}clearViewBox(e){this.window.clearViewBox(e)}render(e,i){if(this.releaseStatus==="released")return;this.ticker.start(),this.timeline.resume();const n=this.state;this.state="rendering",this.tickedBeforeRender||this.ticker.trySyncTickStatus(),this.layerService.prepareStageLayer(this),this._skipRender||(this.lastRenderparams=i,this.hooks.beforeRender.call(this),this._skipRender||(this.renderLayerList(this.children),this.combineLayersToWindow(),this.nextFrameRenderLayerSet.clear()),this.hooks.afterRender.call(this)),this.state=n,this._skipRender&&this._skipRender++}combineLayersToWindow(){if(this.global.env==="harmony"){const e=this.window.getContext().nativeContext;this.forEachChildren((i,n)=>{if(n>0){const o=i.getNativeHandler().getContext().canvas.nativeCanvas.nativeCanvas._c.transferToImageBitmap();e.transferFromImageBitmap(o)}})}}renderNextFrame(e,i){this.nextFrameRenderLayerSet.size!==this.childrenCount&&(e||this).forEach(n=>{this.nextFrameRenderLayerSet.add(n)}),this.willNextFrameRender||(this.willNextFrameRender=!0,this.global.getRequestAnimationFrame()(()=>{this._doRenderInThisFrame(),this.willNextFrameRender=!1}))}_doRenderInThisFrame(){if(this.releaseStatus==="released")return;this.timeline.resume(),this.ticker.start();const e=this.state;this.state="rendering",this.layerService.prepareStageLayer(this),this.nextFrameRenderLayerSet.size&&!this._skipRender&&(this.hooks.beforeRender.call(this),this._skipRender||(this.renderLayerList(Array.from(this.nextFrameRenderLayerSet.values()),this.lastRenderparams||{}),this.combineLayersToWindow(),this.nextFrameRenderLayerSet.clear()),this.hooks.afterRender.call(this)),this.state=e,this._skipRender&&this._skipRender++}renderLayerList(e,i){const n=[];for(let o=0;o<e.length;o++){let l=e[o];l.layerMode==="virtual"&&(l=l.getNativeHandler().mainHandler.layer),n.includes(l)||n.push(l)}n.forEach(o=>{o.renderCount>this.renderCount||(o.renderCount=this.renderCount+1,o===this.interactiveLayer&&this.dirtyBounds&&this.dirtyBounds.clear(),o.render({renderService:this.renderService,background:o===this.defaultLayer?this.background:void 0,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty()),viewBox:this.window.getViewBox(),transMatrix:this.window.getViewBoxTransform()},Object.assign({renderStyle:this.renderStyle},i)))}),this.interactiveLayer&&!e.includes(this.interactiveLayer)&&(this.dirtyBounds&&this.dirtyBounds.clear(),this.interactiveLayer.render({renderService:this.renderService,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty()),viewBox:this.window.getViewBox(),transMatrix:this.window.getViewBoxTransform()},Object.assign({renderStyle:this.renderStyle},i)))}resizeWindow(e,i,n=!0){this.window.resize(e,i),n&&this.render()}resize(e,i,n=!0){this.releaseStatus!=="released"&&(this.window.hasSubView()||this.viewBox.setValue(this.viewBox.x1,this.viewBox.y1,this.viewBox.x1+e,this.viewBox.y1+i),this.window.resize(e,i),this.forEachChildren(o=>{o.resize(e,i)}),this.camera&&this.option3d&&this.set3dOptions(this.option3d),n&&this.render())}resizeView(e,i,n=!0){this.releaseStatus!=="released"&&(this.viewBox.setValue(this.viewBox.x1,this.viewBox.y1,this.viewBox.x1+e,this.viewBox.y1+i),this.forEachChildren(o=>{o.resizeView(e,i)}),this.camera&&(this.camera.params=Object.assign(Object.assign({},this.camera.params),{right:this.width,bottom:this.height})),n&&this.render())}setViewBox(e,i,n,o,l){let d=!0;typeof e=="object"?(this.viewBox.setValue(e.x1,e.y1,e.x2,e.y2),i===!1&&(d=!1)):(this.viewBox.setValue(e,i,e+n,i+o),l===!1&&(d=!1)),this.forEachChildren(u=>{u.resizeView(this.viewBox.width(),this.viewBox.height())}),d&&this.render()}setDpr(e,i=!0){this.forEachChildren(n=>{n.setDpr(e)}),i&&this.render()}setOrigin(e,i){throw new Error("")}export(e){throw new Error("")}pick(e,i){if(this.releaseStatus==="released")return;const n=this.getPickerService().pick(this.children,new Point(e,i),{bounds:this.AABBBounds});return!(!(n!=null&&n.graphic)&&!(n!=null&&n.group))&&n}startAnimate(e){throw new Error("")}setToFrame(e){throw new Error("")}release(){super.release(),this.hooks.beforeRender.unTap("constructor",this.beforeRender),this.hooks.afterRender.unTap("constructor",this.afterRender),this.eventSystem&&this.eventSystem.release(),this.layerService.releaseStage(this),this.pluginService.release(),this.forEach(e=>{e.release()}),this.interactiveLayer&&(this.interactiveLayer.forEachChildren(e=>{e.setStage&&e.setStage(null,null),this.interactiveLayer.removeChild(e)}),this.interactiveLayer.release()),this.window.release(),this.ticker.remTimeline(this.timeline),this.ticker.removeListener("afterTick",this.afterTickCb),this.renderService.renderTreeRoots=[]}setStage(e){}dirty(e,i){this.releaseStatus!=="released"&&(i&&e.transformWithMatrix(i),this.dirtyBounds.empty()&&this.dirtyBounds.setValue(e.x1,e.y1,e.x2,e.y2),this.dirtyBounds.union(e))}getLayer(e){return this.children.filter(i=>i.name===e)[0]}renderTo(e){this.releaseStatus!=="released"&&this.forEachChildren((i,n)=>{i.drawTo(e,{renderService:this.renderService,viewBox:e.getViewBox(),transMatrix:e.getViewBoxTransform(),background:i===this.defaultLayer?this.background:void 0,clear:n===0,updateBounds:!(!this.dirtyBounds||this.dirtyBounds.empty())})})}renderToNewWindow(e=!0,i){if(this.releaseStatus==="released")return;const n=container.get(VWindow),o=i?-i.x1:0,l=i?-i.y1:0,d=i?i.x2:this.viewWidth,u=i?i.y2:this.viewHeight,f=i?i.width():this.viewWidth,g=i?i.height():this.viewHeight;return n.create({viewBox:{x1:o,y1:l,x2:d,y2:u},width:f,height:g,dpr:this.window.dpr,canvasControled:!0,offscreen:!0,title:""}),this.renderTo(n),n}toCanvas(e=!0,i){if(this.releaseStatus==="released")return;const n=this.renderToNewWindow(e,i).getNativeHandler();return n.nativeCanvas?n.nativeCanvas:null}setCursor(e){this._cursor=e,this.eventSystem.setCursor(e,"ignore")}getCursor(){return this._cursor}eventPointTransform(e){const i=this.global.mapToCanvasPoint(e,this.window.getContext().canvas.nativeCanvas);return this.stage.window.pointTransform(i.x,i.y)}pauseTriggerEvent(){this._eventSystem&&this._eventSystem.pauseTriggerEvent()}resumeTriggerEvent(){this._eventSystem&&this._eventSystem.resumeTriggerEvent()}getPickerService(){return this.pickerService||(this.pickerService=container.get(PickerService)),this.pickerService}}function createStage(r){return new Stage(r)}const DefaultConfig={WIDTH:500,HEIGHT:500,DPR:1};class BaseCanvas{get displayWidth(){return this._pixelWidth/this._dpr}get displayHeight(){return this._pixelHeight/this._dpr}get id(){return this._id}get x(){return this._x}set x(e){this._x=e}get y(){return this._y}set y(e){this._y=e}get nativeCanvas(){return this._nativeCanvas}get width(){return this._pixelWidth}set width(e){this._pixelWidth=e,this._displayWidth=e/(this._dpr||1)}get height(){return this._pixelHeight}set height(e){this._pixelHeight=e,this._displayHeight=e/(this._dpr||1)}getContext(e){return this._context}get visiable(){return this._visiable}set visiable(e){this._visiable=e,e?this.show():this.hide()}get dpr(){return this._dpr}set dpr(e){this._dpr=e,this.resize(this._displayWidth,this._displayHeight)}constructor(e){var i;const{nativeCanvas:n,width:o=DefaultConfig.WIDTH,height:l=DefaultConfig.HEIGHT,dpr:d=DefaultConfig.DPR,x:u,y:f,id:g,canvasControled:_=!0}=e;this._x=u??0,this._y=f??0,this._pixelWidth=o*d,this._pixelHeight=l*d,this._visiable=e.visiable!==!1,this.controled=_,this._displayWidth=o,this._displayHeight=l,this._dpr=d,this._nativeCanvas=n,this._id=(i=n.id)!==null&&i!==void 0?i:g,g&&(n.id=g),this.init(e)}getNativeCanvas(){return this._nativeCanvas}hide(){}show(){}applyPosition(){}resetStyle(e){}resize(e,i){}toDataURL(e,i){return""}readPixels(e,i,n,o){return this._context.getImageData(e,i,n,o)}convertToBlob(e){throw new Error("")}transferToImageBitmap(){throw new Error("")}release(...e){this.controled&&this._nativeCanvas.parentElement&&this._nativeCanvas.parentElement.removeChild(this._nativeCanvas)}}BaseCanvas.env="browser";var __decorate$K=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__awaiter$4=function(r,e,i,n){return new(i||(i=Promise))(function(o,l){function d(g){try{f(n.next(g))}catch(_){l(_)}}function u(g){try{f(n.throw(g))}catch(_){l(_)}}function f(g){var _;g.done?o(g.value):(_=g.value,_ instanceof i?_:new i(function(y){y(_)})).then(d,u)}f((n=n.apply(r,e||[])).next())})};let BaseEnvContribution=class{configure(r,...e){r.env===this.type&&r.setActiveEnvContribution(this)}getNativeAABBBounds(r){return new AABBBounds}removeDom(r){return!1}createDom(r){return null}updateDom(r,e){return!1}getDynamicCanvasCount(){return 999}getStaticCanvasCount(){return 999}getElementById(r){return document.getElementById(r)}getRootElement(){return document.body}loadJson(r){const e=fetch(r).then(i=>i.json());return e.then(i=>({data:i,state:"success"})).catch(()=>({data:null,state:"fail"})),e}loadArrayBuffer(r){return fetch(r).then(e=>e.arrayBuffer()).then(e=>({data:e,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadBlob(r){return fetch(r).then(e=>e.blob()).then(e=>({data:e,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}getElementTop(r,e){return 0}getElementLeft(r,e){return 0}getElementTopLeft(r,e){return{top:0,left:0}}loadFont(r,e,i){return __awaiter$4(this,void 0,void 0,function*(){return{loadState:"fail"}})}};BaseEnvContribution=__decorate$K([injectable()],BaseEnvContribution);var __decorate$J=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$x=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)};let BaseWindowHandlerContribution=class{constructor(){this._uid=Generator.GenAutoIncrementId(),this.viewBox=new AABBBounds,this.modelMatrix=new Matrix(1,0,0,1,0,0)}onChange(r){this._onChangeCb=r}configure(r,e){e.env===this.type&&r.setWindowHandler(this)}release(...r){this.releaseWindow()}isVisible(r){return!0}onVisibleChange(r){}getTopLeft(r){return{top:0,left:0}}setViewBox(r){this.viewBox.setValue(r.x1,r.y1,r.x2,r.y2)}getViewBox(){return this.viewBox}setViewBoxTransform(r,e,i,n,o,l){this.modelMatrix.setValue(r,e,i,n,o,l)}getViewBoxTransform(){return this.modelMatrix}};BaseWindowHandlerContribution=__decorate$J([injectable(),__metadata$x("design:paramtypes",[])],BaseWindowHandlerContribution);class DirectionalLight{constructor(e,i,n=.8){this.dir=e,this.color=i,this.colorRgb=ColorStore.Get(i,ColorType.Color1),this.ambient=n;const o=sqrt$3(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);this.formatedDir=[e[0]/o,e[1]/o,e[2]/o]}computeColor(e,i){const n=this.formatedDir,o=min$1(max$1((e[0]*n[0]+e[1]*n[1]+e[2]*n[2])*(1-this.ambient/2),0)+this.ambient,1);let l;l=isString(i)?ColorStore.Get(i,ColorType.Color1):i;const d=this.colorRgb;return`rgb(${d[0]*l[0]*o}, ${d[1]*l[1]*o}, ${d[2]*l[2]*o})`}}const registerDirectionalLight=()=>{Factory$2.registerPlugin("DirectionalLight",DirectionalLight)};class OrthoCamera{set params(e){this._params=Object.assign({},e),this._projectionMatrixCached=this.forceGetProjectionMatrix(),this._viewMatrixCached=this.forceGetViewMatrix()}get params(){return Object.assign({},this._params)}constructor(e){this.params=e}getViewMatrix(){return this._viewMatrixCached||(this._viewMatrixCached=mat4Allocate.allocate()),this._viewMatrixCached}forceGetViewMatrix(){this._viewMatrixCached||(this._viewMatrixCached=mat4Allocate.allocate());const{pos:e,center:i,up:n}=this.params.viewParams;return lookAt(this._viewMatrixCached,e,i,n),this._vp||(this._vp=mat4Allocate.allocate()),this._vp=multiplyMat4Mat4(this._vp,this.getProjectionMatrix(),this.getViewMatrix()),this._viewMatrixCached}getProjectionMatrix(){return this._projectionMatrixCached||(this._projectionMatrixCached=mat4Allocate.allocate()),this._projectionMatrixCached}forceGetProjectionMatrix(){this._projectionMatrixCached||(this._projectionMatrixCached=mat4Allocate.allocate());const{left:e,top:i,right:n,bottom:o}=this._params;return ortho(this._projectionMatrixCached,e,n,o,i,0,-2e6),this._vp||(this._vp=mat4Allocate.allocate()),this._vp=multiplyMat4Mat4(this._vp,this.getProjectionMatrix(),this.getViewMatrix()),this._projectionMatrixCached}getField(){const{fieldRatio:e=.8,fieldDepth:i,left:n,right:o}=this._params;return(i??o-n)*e}getProjectionScale(e){const i=this.getField();return i/(i+e)}view(e,i,n){const o=[0,0,0];return transformMat4(o,[e,i,n],this._viewMatrixCached),o}vp(e,i,n){const o=[0,0,0],{pos:l}=this._params.viewParams;transformMat4(o,[e,i,n],this._viewMatrixCached),e=o[0],i=o[1],n=o[2];const d=this.getProjectionScale(n);return{x:e*d+l[0],y:i*d+l[1]}}}const registerOrthoCamera=()=>{Factory$2.registerPlugin("OrthoCamera",OrthoCamera)};var __decorate$I=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$w=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$p=function(r,e){return function(i,n){e(i,n,r)}};let DefaultPickService=class{constructor(r){this.pickItemInterceptorContributions=r,this.type="default",this.global=application.global}_init(){this.InterceptorContributions=this.pickItemInterceptorContributions.getContributions().sort((r,e)=>r.order-e.order)}pick(r,e,i){let n={graphic:null,group:null};i.pickerService=this;const o=i.bounds.width(),l=i.bounds.height();if(!new AABBBounds().setValue(0,0,o,l).containsPoint(e))return n;this.pickContext&&(this.pickContext.inuse=!0),i.pickContext=this.pickContext,this.pickContext&&this.pickContext.clearMatrix(!0,1);const d=new Matrix(1,0,0,1,0,0);let u;for(let f=r.length-1;f>=0&&(n=r[f].isContainer?this.pickGroup(r[f],e,d,i):this.pickItem(r[f],e,d,i),!n.graphic);f--)u||(u=n.group);if(n.graphic||(n.group=u),this.pickContext&&(this.pickContext.inuse=!1),n.graphic){let f=n.graphic;for(;f.parent;)f=f.parent;f.shadowHost&&(n.params={shadowTarget:n.graphic},n.graphic=f.shadowHost)}return n}containsPoint(r,e,i){var n;return!!(!((n=this.pickItem(r,e,null,i??{pickContext:this.pickContext,pickerService:this}))===null||n===void 0)&&n.graphic)}pickGroup(r,e,i,n){let o={group:null,graphic:null};if(r.attribute.visibleAll===!1)return o;const l=n.pickContext,d=l.modelMatrix;if(l.camera){const S=r.transMatrix,v=mat4Allocate.allocate();if(mat3Tomat4(v,S),d){if(v){const A=mat4Allocate.allocate();l.modelMatrix=multiplyMat4Mat4(A,d,v),mat4Allocate.free(v)}}else mat3Tomat4(v,r.globalTransMatrix),l.modelMatrix=v}if(this.InterceptorContributions.length)for(let S=0;S<this.InterceptorContributions.length;S++){const v=this.InterceptorContributions[S];if(v.beforePickItem){const A=v.beforePickItem(r,this,e,n,{parentMatrix:i});if(A)return l.modelMatrix!==d&&mat4Allocate.free(l.modelMatrix),l.modelMatrix=d,A}}const u=r.transMatrix,f=matrixAllocate.allocateByObj(i),g=new Point(e.x,e.y);f.transformPoint(g,g);const _=r.AABBBounds.containsPoint(g);if(!_&&!r.stage.camera)return o;const y=this.pickItem(r,g.clone(),i,n);y&&y.graphic&&(o.graphic=y.graphic,o.params=y.params);const b=r.attribute.pickable!==!1&&_;return f.multiply(u.a,u.b,u.c,u.d,u.e,u.f),r.attribute.childrenPickable===!1||y&&y.graphic||foreach(r,DefaultAttribute.zIndex,S=>{if(S.isContainer){const v=new Point(e.x,e.y),A=getTheme$1(r).group,{scrollX:x=A.scrollX,scrollY:T=A.scrollY}=r.attribute;v.x-=x,v.y-=T,o=this.pickGroup(S,v,f,n)}else{const v=new Point(e.x,e.y);f.transformPoint(v,v);const A=getTheme$1(r).group,{scrollX:x=A.scrollX,scrollY:T=A.scrollY}=r.attribute;v.x-=x,v.y-=T;const C=this.pickItem(S,v,i,n);C&&C.graphic&&(o.graphic=C.graphic,o.params=C.params)}return!!o.graphic||!!o.group},!0,!!l.camera),l.modelMatrix!==d&&mat4Allocate.free(l.modelMatrix),l.modelMatrix=d,o.graphic||o.group||!b||r.stage.camera||(o.group=r),matrixAllocate.free(f),o}selectPicker(r){return this.pickerMap.get(r.numberType)||null}};DefaultPickService=__decorate$I([injectable(),__param$p(0,inject(ContributionProvider)),__param$p(0,named(PickItemInterceptor)),__metadata$w("design:paramtypes",[Object])],DefaultPickService);function simplifyRadialDist(r,e){let i,n,o=r[0].x,l=r[0].y;const d=[r[0]];for(let u=1,f=r.length;u<f;u++)i=r[u].x-o,n=r[u].y-l,i*i+n*n>e&&(o=r[u].x,l=r[u].y,d.push(r[u]));return r[r.length-1].x===o&&r[r.length-1].y===l||d.push(r[r.length-1]),d}function flatten_simplify(r,e,i){return r.length<=10?r:r=simplifyRadialDist(r,e!==void 0?e*e:1)}let loadArcModule=!1;const arcModule=new ContainerModule(r=>{loadArcModule||(loadArcModule=!0,r(DefaultCanvasArcRender).toSelf().inSingletonScope(),r(ArcRender).to(DefaultCanvasArcRender).inSingletonScope(),r(GraphicRender).toService(ArcRender),r(ArcRenderContribution).toService(DefaultBaseInteractiveRenderContribution),bindContributionProvider(r,ArcRenderContribution))});let loadRectModule=!1;const rectModule=new ContainerModule(r=>{loadRectModule||(loadRectModule=!0,r(DefaultCanvasRectRender).toSelf().inSingletonScope(),r(RectRender).to(DefaultCanvasRectRender).inSingletonScope(),r(GraphicRender).toService(RectRender),r(SplitRectAfterRenderContribution).toSelf(),r(SplitRectBeforeRenderContribution).toSelf(),r(RectRenderContribution).toService(SplitRectAfterRenderContribution),r(RectRenderContribution).toService(SplitRectBeforeRenderContribution),r(RectRenderContribution).toService(DefaultBaseInteractiveRenderContribution),bindContributionProvider(r,RectRenderContribution))});let loadLineModule=!1;const lineModule=new ContainerModule(r=>{loadLineModule||(loadLineModule=!0,r(DefaultCanvasLineRender).toSelf().inSingletonScope(),r(DefaultIncrementalCanvasLineRender).toSelf().inSingletonScope(),r(LineRender).to(DefaultCanvasLineRender).inSingletonScope(),r(GraphicRender).toService(LineRender))});let loadAreaModule=!1;const areaModule=new ContainerModule(r=>{loadAreaModule||(loadAreaModule=!0,r(DefaultCanvasAreaRender).toSelf().inSingletonScope(),r(AreaRender).to(DefaultCanvasAreaRender).inSingletonScope(),r(GraphicRender).toService(AreaRender),r(AreaRenderContribution).toService(DefaultBaseInteractiveRenderContribution),bindContributionProvider(r,AreaRenderContribution),r(DefaultIncrementalCanvasAreaRender).toSelf().inSingletonScope())});let loadSymbolModule=!1;const symbolModule=new ContainerModule(r=>{loadSymbolModule||(loadSymbolModule=!0,r(DefaultCanvasSymbolRender).toSelf().inSingletonScope(),r(SymbolRender).to(DefaultCanvasSymbolRender).inSingletonScope(),r(GraphicRender).toService(SymbolRender),r(SymbolRenderContribution).toService(DefaultBaseInteractiveRenderContribution),bindContributionProvider(r,SymbolRenderContribution))});let loadCircleModule=!1;const circleModule=new ContainerModule(r=>{loadCircleModule||(loadCircleModule=!0,r(DefaultCanvasCircleRender).toSelf().inSingletonScope(),r(CircleRender).to(DefaultCanvasCircleRender).inSingletonScope(),r(GraphicRender).toService(CircleRender),r(CircleRenderContribution).toService(DefaultBaseInteractiveRenderContribution),bindContributionProvider(r,CircleRenderContribution))});let loadTextModule=!1;const textModule=new ContainerModule(r=>{loadTextModule||(loadTextModule=!0,r(TextRender).to(DefaultCanvasTextRender).inSingletonScope(),r(GraphicRender).toService(TextRender),r(TextRenderContribution).toService(DefaultBaseInteractiveRenderContribution),bindContributionProvider(r,TextRenderContribution))});let loadPathModule=!1;const pathModule=new ContainerModule(r=>{loadPathModule||(loadPathModule=!0,r(DefaultCanvasPathRender).toSelf().inSingletonScope(),r(PathRender).to(DefaultCanvasPathRender).inSingletonScope(),r(GraphicRender).toService(PathRender),r(PathRenderContribution).toService(DefaultBaseInteractiveRenderContribution),bindContributionProvider(r,PathRenderContribution))});let loadPolygonModule=!1;const polygonModule=new ContainerModule(r=>{loadPolygonModule||(loadPolygonModule=!0,r(PolygonRender).to(DefaultCanvasPolygonRender).inSingletonScope(),r(GraphicRender).toService(PolygonRender),r(PolygonRenderContribution).toService(DefaultBaseInteractiveRenderContribution),bindContributionProvider(r,PolygonRenderContribution))});var __decorate$H=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d};let DefaultCanvasGlyphRender=class{constructor(){this.numberType=GLYPH_NUMBER_TYPE}drawShape(r,e,i,n,o,l,d,u){o.drawContribution&&r.getSubGraphic().forEach(f=>{const g=o.drawContribution.getRenderContribution(f);g&&g.drawShape&&g.drawShape(f,e,i,n,o,l,d,u)})}draw(r,e,i,n){const{context:o}=i;if(!o||(o.highPerformanceSave(),!i.drawContribution))return;const l=getTheme$1(r),d=r.getSubGraphic();d.length&&d.forEach(u=>{i.drawContribution.renderItem(u,i,{theme:l})}),o.highPerformanceRestore()}};DefaultCanvasGlyphRender=__decorate$H([injectable()],DefaultCanvasGlyphRender);let loadGlyphModule=!1;const glyphModule=new ContainerModule(r=>{loadGlyphModule||(loadGlyphModule=!0,r(GlyphRender).to(DefaultCanvasGlyphRender).inSingletonScope(),r(GraphicRender).toService(GlyphRender))});var __decorate$G=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$v=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)};let DefaultCanvasRichTextRender=class extends BaseRender{constructor(){super(),this.numberType=RICHTEXT_NUMBER_TYPE,this.builtinContributions=[defaultTextBackgroundRenderContribution],this.init()}drawShape(r,e,i,n,o){const l=getTheme$1(r).richtext,{strokeOpacity:d=l.strokeOpacity,opacity:u=l.opacity,fillOpacity:f=l.fillOpacity,visible:g=l.visible}=r.attribute;if(!r.valid||!g)return;const _=fillVisible(u,f,!0),y=fillVisible(u,d,!0);_&&(e.setShadowBlendStyle&&e.setShadowBlendStyle(r,r.attribute,l),e.translate(i,n),this.beforeRenderStep(r,e,i,n,_,y,_,y,l,o),r.getFrameCache().draw(e,this.drawIcon),this.afterRenderStep(r,e,i,n,_,y,_,y,l,o))}drawIcon(r,e,i,n,o){var l;const d=getTheme$1(r).richtextIcon,{width:u=d.width,height:f=d.height,opacity:g=d.opacity,image:_,backgroundFill:y=d.backgroundFill,backgroundFillOpacity:b=d.backgroundFillOpacity,backgroundStroke:S=d.backgroundStroke,backgroundStrokeOpacity:v=d.backgroundStrokeOpacity,backgroundRadius:A=d.backgroundRadius,margin:x}=r.attribute,{backgroundWidth:T=u,backgroundHeight:C=f}=r.attribute;if(x&&(i+=r._marginArray[3],n+=r._marginArray[0]),r._hovered){const P=(T-u)/2,R=(C-f)/2;A===0?(e.beginPath(),e.rect(i-P,n-R,T,C)):(e.beginPath(),createRectPath(e,i-P,n-R,T,C,A)),y&&(e.globalAlpha=b,e.fillStyle=y,e.fill()),S&&(e.globalAlpha=v,e.strokeStyle=S,e.stroke())}const E=_&&((l=r==null?void 0:r.resources)===null||l===void 0?void 0:l.get(_));E&&E.state==="success"&&(e.globalAlpha=g,e.drawImage(E.data,i,n,u,f))}draw(r,e,i){const n=getTheme$1(r).richtext;this._draw(r,n,!1,i)}};DefaultCanvasRichTextRender=__decorate$G([injectable(),__metadata$v("design:paramtypes",[])],DefaultCanvasRichTextRender);let loadRichtextModule=!1;const richtextModule=new ContainerModule(r=>{loadRichtextModule||(loadRichtextModule=!0,r(RichTextRender).to(DefaultCanvasRichTextRender).inSingletonScope(),r(GraphicRender).toService(RichTextRender))});let loadImageModule=!1;const imageModule=new ContainerModule(r=>{loadImageModule||(loadImageModule=!0,r(ImageRender).to(DefaultCanvasImageRender).inSingletonScope(),r(GraphicRender).toService(ImageRender),r(ImageRenderContribution).toService(DefaultBaseInteractiveRenderContribution),bindContributionProvider(r,ImageRenderContribution))});class Base3dRender extends BaseRender{stroke(e,i,n,o,l){const d=o.vertices;o.edges.forEach(u=>{const f=d[u[0]],g={x:e+f[0],y:i+f[1],z:n+f[2]},_=d[u[1]],y={x:e+_[0],y:i+_[1],z:n+_[2]};l.beginPath(),l.moveTo(g.x,g.y,g.z),l.lineTo(y.x,y.y,y.z),l.stroke()})}fill(e,i,n,o,l,d,u,f,g,_,y){const b=ColorStore.Get(d,ColorType.Color255),S=o.vertices,v=S.map(x=>u.view(x[0],x[1],x[2])[2]),A=[];o.polygons.forEach((x,T)=>{if(l&&!l[T])return;A.push({faceIdx:T,polygon:x});const{polygon:C}=x,E=v[C[0]],P=v[C[1]],R=v[C[2]],L=v[C[3]];x.ave_z=E+P+R+L}),A.sort((x,T)=>T.polygon.ave_z-x.polygon.ave_z),A.forEach(x=>{const{polygon:T,normal:C}=x.polygon,E=S[T[0]],P=S[T[1]],R=S[T[2]],L=S[T[3]],w={x:e+E[0],y:i+E[1],z:n+E[2]},B={x:e+P[0],y:i+P[1],z:n+P[2]},I={x:e+R[0],y:i+R[1],z:n+R[2]},D={x:e+L[0],y:i+L[1],z:n+L[2]};u.beginPath(),u.moveTo(w.x,w.y,w.z),u.lineTo(B.x,B.y,B.z),u.lineTo(I.x,I.y,I.z),u.lineTo(D.x,D.y,D.z),u.closePath(),y?y(u,g&&g.attribute,_):(u.fillStyle=f?f.computeColor(C,b):d,u.fill())})}}var __decorate$F=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d};let DefaultCanvasRect3dRender=class extends Base3dRender{constructor(){super(...arguments),this.type="rect3d",this.numberType=RECT3D_NUMBER_TYPE}drawShape(r,e,i,n,o,l,d,u){var f;const g=getTheme$1(r,l==null?void 0:l.theme).rect,{fill:_=g.fill,stroke:y=g.stroke,x1:b,y1:S,x:v,y:A,opacity:x=g.opacity,fillOpacity:T=g.fillOpacity,lineWidth:C=g.lineWidth,strokeOpacity:E=g.strokeOpacity,visible:P=g.visible}=r.attribute;let{width:R,height:L}=r.attribute;R=(R??b-v)||0,L=(L??S-A)||0;const w=(f=this.z)!==null&&f!==void 0?f:0,B=rectFillVisible(x,T,R,L,_),I=rectStrokeVisible(x,E,R,L),D=runFill(_),O=runStroke(y,C);if(!r.valid||!P||!D&&!O||!(B||I||d||u))return;const{light:N}=o.stage||{},V=r.findFace();if(_!==!1){e.setCommonStyle(r,r.attribute,i,n,g);let H=_;typeof H!="string"&&(H="black"),this.fill(i,n,w,V,null,H,e,N,null,null,d)}y!==!1&&(e.setStrokeStyle(r,r.attribute,i,n,g),this.stroke(i,n,w,V,e))}draw(r,e,i){const n=getTheme$1(r).rect;this._draw(r,n,!1,i)}};DefaultCanvasRect3dRender=__decorate$F([injectable()],DefaultCanvasRect3dRender);let loadRect3dModule=!1;const rect3dModule=new ContainerModule(r=>{loadRect3dModule||(loadRect3dModule=!0,r(Rect3DRender).to(DefaultCanvasRect3dRender).inSingletonScope(),r(GraphicRender).toService(Rect3DRender))});var __decorate$E=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d};function drawArcPath(r,e,i,n,o,l,d){const{startAngle:u,endAngle:f}=r.getParsedAngle(),g=abs$1(f-u),_=f>u;let y=!1;if(l<d){const b=l;l=d,d=b}if(l<=epsilon$1)e.moveTo(i,n,o);else if(g>=pi2-epsilon$1)e.moveTo(i+l*cos$1(u),n+l*sin$1(u),o),e.arc(i,n,l,u,f,!_,o),d>epsilon$1&&(e.moveTo(i+d*cos$1(f),n+d*sin$1(f),o),e.arc(i,n,d,f,u,_,o));else{const{outerDeltaAngle:b,innerDeltaAngle:S,outerStartAngle:v,outerEndAngle:A,innerEndAngle:x,innerStartAngle:T}=r.getParsePadAngle(u,f),C=l*cos$1(v),E=l*sin$1(v),P=d*cos$1(x),R=d*sin$1(x);b<.001?y=!0:(e.moveTo(i+C,n+E,o),e.arc(i,n,l,v,A,!_,o)),!(d>epsilon$1)||S<.001?(e.lineTo(i+P,n+R,o),y=!0):(e.lineTo(i+P,n+R,o),e.arc(i,n,d,x,T,_,o))}return e.closePath(),y}function drawInnerOuterArcPath(r,e,i,n,o,l,d,u){const{startAngle:f,endAngle:g}=r.getParsedAngle(),_=abs$1(g-f),y=g>f;let b=!1;if(d<=epsilon$1)e.moveTo(i,n,o);else if(_>=pi2-epsilon$1)e.moveTo(i+d*cos$1(f),n+d*sin$1(f),o),e.arc(i,n,d,f,g,!y,o),e.lineTo(i+d*cos$1(g),n+d*sin$1(g),l),e.arc(i,n,d,g,f,y,l);else{const{innerouterDeltaAngle:S,innerouterStartAngle:v,innerouterEndAngle:A}=u(f,g),x=d*cos$1(v),T=d*sin$1(v),C=d*cos$1(A),E=d*sin$1(A);S<.001?b=!0:(e.moveTo(i+x,n+T,o),e.arc(i,n,d,v,A,!y,o),e.lineTo(i+C,n+E,l),e.arc(i,n,d,A,v,y,l))}return e.closePath(),b}let DefaultCanvasArc3DRender=class extends BaseRender{constructor(){super(...arguments),this.numberType=ARC3D_NUMBER_TYPE}drawShape(r,e,i,n,o,l,d,u){var f;const g=getTheme$1(r,l==null?void 0:l.theme).arc,{fill:_=g.fill}=r.attribute,y=this.valid(r,g,d,u);if(!y)return;const{fVisible:b,sVisible:S,doFill:v,doStroke:A}=y,x=(f=this.z)!==null&&f!==void 0?f:0,{outerPadding:T=g.outerPadding,innerPadding:C=g.innerPadding,height:E=10}=r.attribute;let{outerRadius:P=g.outerRadius,innerRadius:R=g.innerRadius}=r.attribute;P+=T,R-=C;const L=ColorStore.Get(_,ColorType.Color255),{light:w}=o.stage||{},B=o.hack_pieFace,I={top:x,bottom:x+E},D={top:[0,1,0],bottom:[0,-1,0],outside:[1,0,-1],inside:[1,0,-1]};B==="bottom"||B==="top"?(e.beginPath(),drawArcPath(r,e,i,n,I[B],P,R),e.setShadowBlendStyle&&e.setShadowBlendStyle(r,r.attribute,g),v&&(d?d(e,r.attribute,g):b&&(e.setCommonStyle(r,r.attribute,i,n,g),e.fillStyle=w?w.computeColor(D[B],L):_,e.fill())),A&&(u?u(e,r.attribute,g):S&&(e.setStrokeStyle(r,r.attribute,i,n,g),e.stroke()))):B!=="outside"&&B!=="inside"||(B==="inside"&&(e.save(),e.beginPath(),e.arc(i,n,R,0,pi2,!0,I.top),e.clip()),e.beginPath(),drawInnerOuterArcPath(r,e,i,n,I.top,I.bottom,B==="outside"?P:R,(O,N)=>{const{outerDeltaAngle:V,innerDeltaAngle:H,outerStartAngle:F,outerEndAngle:$,innerEndAngle:G,innerStartAngle:Y}=r.getParsePadAngle(O,N);return B==="outside"?{innerouterDeltaAngle:V,innerouterEndAngle:$,innerouterStartAngle:F}:{innerouterDeltaAngle:H,innerouterEndAngle:G,innerouterStartAngle:Y}}),e.setShadowBlendStyle&&e.setShadowBlendStyle(r,r.attribute,g),v&&(d?d(e,r.attribute,g):b&&(e.setCommonStyle(r,r.attribute,i,n,g),e.fillStyle=w?w.computeColor(D[B],L):_,e.fill())),A&&(u?u(e,r.attribute,g):S&&(e.setStrokeStyle(r,r.attribute,i,n,g),e.stroke())),B==="inside"&&e.restore())}draw(r,e,i,n){const o=getTheme$1(r,n==null?void 0:n.theme).arc;this._draw(r,o,!1,i,n)}};DefaultCanvasArc3DRender=__decorate$E([injectable()],DefaultCanvasArc3DRender);let loadArc3dModule=!1;const arc3dModule=new ContainerModule(r=>{loadArc3dModule||(loadArc3dModule=!0,r(Arc3dRender).to(DefaultCanvasArc3DRender).inSingletonScope(),r(GraphicRender).toService(Arc3dRender))});var __decorate$D=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d};let DefaultCanvasPyramid3dRender=class extends Base3dRender{constructor(){super(...arguments),this.type="pyramid3d",this.numberType=PYRAMID3D_NUMBER_TYPE}drawShape(r,e,i,n,o,l,d,u){var f;const g=getTheme$1(r,l==null?void 0:l.theme).polygon,{fill:_=g.fill,stroke:y=g.stroke,face:b=[!0,!0,!0,!0,!0,!0]}=r.attribute,S=(f=this.z)!==null&&f!==void 0?f:0;if(!this.valid(r,g,d,u))return;const{light:v}=o.stage||{},A=r.findFace();if(_!==!1){e.setCommonStyle(r,r.attribute,i,n,g);let x=_;typeof x!="string"&&(x="black"),this.fill(i,n,S,A,b,x,e,v,r,g,d)}y!==!1&&(e.setStrokeStyle(r,r.attribute,i,n,g),this.stroke(i,n,S,A,e))}draw(r,e,i){const n=getTheme$1(r).polygon;this._draw(r,n,!1,i)}};DefaultCanvasPyramid3dRender=__decorate$D([injectable()],DefaultCanvasPyramid3dRender);let loadPyramid3dModule=!1;const pyramid3dModule=new ContainerModule(r=>{loadPyramid3dModule||(loadPyramid3dModule=!0,r(Pyramid3dRender).to(DefaultCanvasPyramid3dRender).inSingletonScope(),r(GraphicRender).toService(Pyramid3dRender))});function registerArcGraphic$1(){graphicCreator.RegisterGraphicCreator("arc",createArc)}function registerArc3dGraphic$1(){graphicCreator.RegisterGraphicCreator("arc3d",createArc3d)}function registerAreaGraphic$1(){graphicCreator.RegisterGraphicCreator("area",createArea)}function registerCircleGraphic(){graphicCreator.RegisterGraphicCreator("circle",createCircle)}function registerGlyphGraphic$1(){graphicCreator.RegisterGraphicCreator("glyph",createGlyph)}function registerGroupGraphic$1(){graphicCreator.RegisterGraphicCreator("group",createGroup)}function registerImageGraphic$1(){graphicCreator.RegisterGraphicCreator("image",createImage)}function registerLineGraphic$1(){graphicCreator.RegisterGraphicCreator("line",createLine)}function registerPathGraphic$1(){graphicCreator.RegisterGraphicCreator("path",createPath)}function registerPolygonGraphic$1(){graphicCreator.RegisterGraphicCreator("polygon",createPolygon)}function registerPyramid3dGraphic$1(){graphicCreator.RegisterGraphicCreator("pyramid3d",createPyramid3d)}function registerRectGraphic$1(){graphicCreator.RegisterGraphicCreator("rect",createRect)}function registerRect3dGraphic$1(){graphicCreator.RegisterGraphicCreator("rect3d",createRect3d)}function registerRichtextGraphic(){graphicCreator.RegisterGraphicCreator("richtext",createRichText)}function registerSymbolGraphic$1(){graphicCreator.RegisterGraphicCreator("symbol",createSymbol)}function registerTextGraphic$1(){graphicCreator.RegisterGraphicCreator("text",createText)}function registerShadowRootGraphic(){graphicCreator.RegisterGraphicCreator("shadowRoot",createShadowRoot)}class HtmlAttributePlugin{constructor(){this.name="HtmlAttributePlugin",this.activeEvent="onRegister",this._uid=Generator.GenAutoIncrementId(),this.key=this.name+this._uid,this.htmlMap={},this.renderId=0,this.onWheel=e=>{try{const i=new e.constructor(e.type,e);this.pluginService.stage.window.getContext().getCanvas().nativeCanvas.dispatchEvent(i)}catch{return}}}activate(e){this.pluginService=e,e.stage.hooks.afterRender.tap(this.key,i=>{i&&i===this.pluginService.stage&&this.drawHTML([...e.stage.getChildren()])})}deactivate(e){e.stage.hooks.afterRender.taps=e.stage.hooks.afterRender.taps.filter(i=>i.name!==this.key),application.graphicService.hooks.onRemove.unTap(this.key),application.graphicService.hooks.onRelease.unTap(this.key),this.release()}getWrapContainer(e,i,n){let o;return o=i?typeof i=="string"?application.global.getElementById(i):i:e.window.getContainer(),{wrapContainer:application.global.createDom(Object.assign({tagName:"div",parent:o},n)),nativeContainer:o}}parseDefaultStyleFromGraphic(e){const i=e.type==="text"&&e.attribute?e.attribute:getTheme$1(e).text;return textAttributesToStyle(i)}getTransformOfText(e){const i=getTheme$1(e).text,{textAlign:n=i.textAlign,textBaseline:o=i.textBaseline}=e.attribute,l=e.globalTransMatrix.toTransformAttrs(),{rotateDeg:d,scaleX:u,scaleY:f}=l,g={left:"0",start:"0",end:"-100%",center:"-50%",right:"-100%",top:"0",middle:"-50%",bottom:"-100%",alphabetic:"-79%"},_={left:"0",start:"0",end:"100%",center:"50%",right:"100%",top:"0",middle:"50%",bottom:"100%",alphabetic:"79%"};return{textAlign:n,transform:`translate(${g[n]},${g[o]}) rotate(${d}deg) scaleX(${u}) scaleY(${f})`,transformOrigin:`${_[n]} ${_[o]}`}}updateStyleOfWrapContainer(e,i,n,o,l){const{pointerEvents:d,penetrateEventList:u=[]}=l;let f=this.parseDefaultStyleFromGraphic(e);f.display=e.attribute.visible!==!1?"block":"none",f.pointerEvents=d===!0?"all":d||"none",f.pointerEvents!=="none"&&(this.removeWrapContainerEventListener(n),u.forEach(C=>{C==="wheel"&&n.addEventListener("wheel",this.onWheel)})),n.style.position||(n.style.position="absolute",o.style.position="relative");let g=0,_=0;const y=e.globalAABBBounds;let b=l.anchorType;if(isNil(b)&&(b=e.type==="text"?"position":"boundsLeftTop"),b==="boundsLeftTop"&&(b="top-left"),b==="position"||y.empty()){const C=e.globalTransMatrix;g=C.e,_=C.f}else{const C=calculateAnchorOfBounds(y,b);g=C.x,_=C.y}const S=application.global.getElementTopLeft(o,!1),v=i.window.getTopLeft(!1),A=i.viewBox,x=g+v.left-S.left+A.x1,T=_+v.top-S.top+A.y1;if(f.left=`${x}px`,f.top=`${T}px`,e.type==="text"&&b==="position"&&(f=Object.assign(Object.assign({},f),this.getTransformOfText(e))),isFunction(l.style)){const C=l.style({top:T,left:x,width:y.width(),height:y.height()},e,n);C&&(f=Object.assign(Object.assign({},f),C))}else isObject$1(l.style)?f=Object.assign(Object.assign({},f),l.style):isString(l.style)&&l.style&&(f=Object.assign(Object.assign({},f),styleStringToObject(l.style)));application.global.updateDom(n,{width:l.width,height:l.height,style:f})}clearCacheContainer(){this.htmlMap&&Object.keys(this.htmlMap).forEach(e=>{this.htmlMap[e]&&this.htmlMap[e].renderId!==this.renderId&&this.removeElement(e)}),this.renderId+=1}drawHTML(e){application.global.env==="browser"&&(e.sort((i,n)=>{var o,l;return((o=i.attribute.zIndex)!==null&&o!==void 0?o:DefaultAttribute.zIndex)-((l=n.attribute.zIndex)!==null&&l!==void 0?l:DefaultAttribute.zIndex)}).forEach(i=>{this.renderGroupHTML(i)}),this.clearCacheContainer())}renderGroupHTML(e){this.renderGraphicHTML(e),e.forEachChildren(i=>{i.isContainer?this.renderGroupHTML(i):this.renderGraphicHTML(i)})}removeElement(e){if(!this.htmlMap||!this.htmlMap[e])return;const{wrapContainer:i}=this.htmlMap[e];i&&application.global.removeDom(i),this.htmlMap[e]=null}removeWrapContainerEventListener(e){e.removeEventListener("wheel",this.onWheel)}renderGraphicHTML(e){var i;const{html:n}=e.attribute;if(!n)return;const o=e.stage;if(!o)return;const{dom:l,container:d}=n;if(!l)return;const u=isNil(n.id)?`${(i=e.id)!==null&&i!==void 0?i:e._uid}_react`:n.id;if(this.htmlMap&&this.htmlMap[u]&&d&&d!==this.htmlMap[u].container&&this.removeElement(u),this.htmlMap&&this.htmlMap[u])typeof l=="string"?this.htmlMap[u].wrapContainer.innerHTML=l:l!==this.htmlMap[u].wrapContainer.firstChild&&(this.htmlMap[u].wrapContainer.removeChild(this.htmlMap[u].wrapContainer.firstChild),this.htmlMap[u].wrapContainer.appendChild(l));else{const{wrapContainer:_,nativeContainer:y}=this.getWrapContainer(o,d);_&&(typeof l=="string"?_.innerHTML=l:_.appendChild(l),this.htmlMap||(this.htmlMap={}),this.htmlMap[u]={wrapContainer:_,nativeContainer:y,container:d,renderId:this.renderId})}if(!this.htmlMap||!this.htmlMap[u])return;const{wrapContainer:f,nativeContainer:g}=this.htmlMap[u];this.updateStyleOfWrapContainer(e,o,f,g,n),this.htmlMap[u].renderId=this.renderId}release(){application.global.env==="browser"&&this.removeAllDom(this.pluginService.stage.defaultLayer)}removeAllDom(e){this.htmlMap&&(Object.keys(this.htmlMap).forEach(i=>{this.removeElement(i)}),this.htmlMap=null)}}const registerHtmlAttributePlugin=()=>{Factory$2.registerPlugin("HtmlAttributePlugin",HtmlAttributePlugin)};class ReactAttributePlugin extends HtmlAttributePlugin{constructor(){super(...arguments),this.name="ReactAttributePlugin",this.activeEvent="onRegister",this._uid=Generator.GenAutoIncrementId(),this.key=this.name+this._uid,this.htmlMap={}}removeElement(e){if(!this.htmlMap||!this.htmlMap[e])return;const{root:i,wrapContainer:n,unmount:o}=this.htmlMap[e];i?application.global.getRequestAnimationFrame()(()=>{i.unmount()}):o&&o(),n&&application.global.removeDom(n),this.htmlMap[e]=null}renderGraphicHTML(e){var i;const{react:n}=e.attribute;if(!n)return;const o=e.stage;if(!o)return;const l=o.params.ReactDOM,{element:d,container:u}=n;if(!d||!l||!l.createRoot&&!l.render)return;const f=isNil(n.id)?`${(i=e.id)!==null&&i!==void 0?i:e._uid}_react`:n.id;if(this.htmlMap&&this.htmlMap[f]&&u&&u!==this.htmlMap[f].container&&this.removeElement(f),this.htmlMap&&this.htmlMap[f])l.createRoot?this.htmlMap[f].root.render(d):l.render(d,this.htmlMap[f].wrapContainer);else{const{wrapContainer:y,nativeContainer:b}=this.getWrapContainer(o,u);if(y)if(this.htmlMap||(this.htmlMap={}),l.createRoot){const S=l.createRoot(y);S.render(d),this.htmlMap[f]={root:S,wrapContainer:y,nativeContainer:b,container:u,renderId:this.renderId}}else l.render(d,y),this.htmlMap[f]={wrapContainer:y,nativeContainer:b,container:u,renderId:this.renderId,unmount:()=>{l.unmountComponentAtNode(y)}}}if(!this.htmlMap||!this.htmlMap[f])return;const{wrapContainer:g,nativeContainer:_}=this.htmlMap[f];this.updateStyleOfWrapContainer(e,o,g,_,n),this.htmlMap[f].renderId=this.renderId}}const registerReactAttributePlugin=()=>{Factory$2.registerPlugin("ReactAttributePlugin",ReactAttributePlugin)};class ViewTransform3dPlugin{constructor(){this.name="ViewTransform3dPlugin",this.activeEvent="onRegister",this._uid=Generator.GenAutoIncrementId(),this.key=this.name+this._uid,this.onMouseDown=e=>{this.option3d||(this.option3d=this.pluginService.stage.option3d),this.option3d&&(this.mousedown=!0,this.pageX=e.page.x,this.pageY=e.page.y)},this.onMouseUp=e=>{this.option3d||(this.option3d=this.pluginService.stage.option3d),this.option3d&&(this.mousedown=!1)},this.onMouseMove=e=>{var i,n;const o=this.pluginService.stage;if(this.option3d||(this.option3d=o.option3d),this.option3d&&this.mousedown)if(this.pageX&&this.pageY){const l=e.page.x-this.pageX,d=e.page.y-this.pageY;this.pageX=e.page.x,this.pageY=e.page.y;const u=l/100,f=d/100;this.option3d.alpha=((i=this.option3d.alpha)!==null&&i!==void 0?i:0)+u,this.option3d.beta=((n=this.option3d.beta)!==null&&n!==void 0?n:0)+f,o.set3dOptions(this.option3d),o.renderNextFrame()}else this.pageX=e.page.x,this.pageY=e.page.y}}activate(e){this.pluginService=e;const i=e.stage;this.option3d=i.option3d,i.addEventListener("mousedown",this.onMouseDown),i.addEventListener("mouseup",this.onMouseUp),i.addEventListener("mousemove",this.onMouseMove)}deactivate(e){const i=e.stage;i.removeEventListener("mousedown",this.onMouseDown),i.removeEventListener("mouseup",this.onMouseUp),i.removeEventListener("mousemove",this.onMouseMove)}}const registerViewTransform3dPlugin=()=>{Factory$2.registerPlugin("ViewTransform3dPlugin",ViewTransform3dPlugin)};function combineDomains(r){const e=[];for(let i=0;i<r.length;i++){const n=r[i];i!==0&&n[0]===e[e.length-1]||e.push(n[0]),e.push(n[1])}return e}const warn=(r,e)=>(isFunction(config.warnHandler)&&config.warnHandler.call(null,r,e),Logger.getInstance().warn(`[VChart warn]: ${r}`)),error$1=(r,e,i)=>{{if(!isFunction(config.errorHandler))throw new Error(r);config.errorHandler.call(null,r,e)}},config={warnHandler:!1,errorHandler:!1},isBrowser=isBrowserEnv(),domDocument=isBrowser&&globalThis?globalThis.document:void 0;function isTrueBrowser(r){return(r==="desktop-browser"||r==="mobile-browser")&&isBrowser}function isMobileLikeMode(r){return isMiniAppLikeMode(r)||r==="mobile-browser"}function isMiniAppLikeMode(r){return r.includes("miniApp")||r==="lynx"||r==="wx"||r==="harmony"}let VChartId=0;function createID(){return VChartId>=9999999&&(VChartId=0),VChartId++}function couldBeValidNumber(r){return r!=null&&r!==""&&(!!isNumber(r)||+r==+r)}function toValidNumber(r){if(isValidNumber(r))return r;const e=+r;return isValidNumber(e)?e:0}function isDataDomainSpec(r){return!(!r||r.length===0)&&!isNil(r[0])&&!isNil(r[0].dataId)&&isArray(r[0].fields)}const accessor=(r,e,i)=>(r.fields=e||[],r.fname=i,r),getter=r=>e=>get(e,r),identity$1=r=>r,zero=r=>0,error=r=>{Logger.getInstance().error(r)},splitAccessPath=r=>{const e=[],i=r.length;let n,o,l,d=null,u=0,f="";r+="";const g=()=>{e.push(f+r.substring(n,o)),f="",n=o+1};for(n=0,o=0;o<i;o+=1)if(l=r[o],l==="\\")f+=r.substring(n,o),f+=r.substring(++o,++o),n=o;else if(l===d)g(),d=null,u=-1;else{if(d)continue;n===u&&l==='"'||n===u&&l==="'"?(n=o+1,d=l):l!=="."||u?l==="["?(o>n&&g(),n=o+1,u=n):l==="]"&&(u||error("Access path missing open bracket: "+r),u>0&&g(),u=0,n=o+1):o>n?g():n=o+1}return u&&error("Access path missing closing bracket: "+r),d&&error("Access path missing closing quote: "+r),o>n&&(o+=1,g()),e},fieldSingle=(r,e,i={})=>{if(isFunction(r))return r;const n=splitAccessPath(r),o=n.length===1?n[0]:r;return accessor((i&&i.get||getter)(n),[o],o)},field$3=(r,e,i={})=>{if(isArray(r)){const n=r.map(o=>fieldSingle(o,e,i));return o=>n.map(l=>l(o))}return fieldSingle(r,e,i)},extent$2=(r,e)=>{const i=isFunction(e)?e:l=>l;let n,o;if(r&&r.length){const l=r.length;for(let d=0;d<l;d+=1){let u=i(r[d]);isNil(u)||!isNumber(u=+u)||Number.isNaN(u)||(isNil(n)?(n=u,o=u):(n=Math.min(n,u),o=Math.max(o,u)))}return[n,o]}return[n,o]},toPercent=(r,e)=>isNil(r)?e:isString(r)?e*parseFloat(r)/100:r;function ordinaryLeastSquares(r,e,i,n){const o=n-r*r,l=Math.abs(o)<1e-24?0:(i-r*e)/o;return[e-l*r,l]}function visitPoints(r,e,i,n){let o,l,d=-1;r.forEach(u=>{o=e(u),l=i(u),!isNil(o)&&(o=+o)>=o&&!isNil(l)&&(l=+l)>=l&&n(o,l,++d)})}function rSquared(r,e,i,n,o){let l=0,d=0;return visitPoints(r,e,i,(u,f)=>{const g=f-o(u),_=f-n;l+=g*g,d+=_*_}),1-l/d}function regressionLinear(r,e=n=>n.x,i=n=>n.y){let n=0,o=0,l=0,d=0,u=0;visitPoints(r,e,i,(_,y)=>{++u,n+=(_-n)/u,o+=(y-o)/u,l+=(_*y-l)/u,d+=(_*_-d)/u});const f=ordinaryLeastSquares(n,o,l,d),g=_=>f[0]+f[1]*_;return{coef:f,predict:g,rSquared:rSquared(r,e,i,o,g)}}function isHorizontal$2(r){return r==="horizontal"}function isVertical$1(r){return r==="vertical"}const shapes={triangleForward,triangleUpright:triangle,triangle,diamond,square:square$1,star,cardioid,circle,pentagon};function diamond(){return function(r){const e=r%(2*Math.PI/4);return 1/(Math.cos(e)+Math.sin(e))}}function star(){return function(r){const e=(r+.955)%(2*Math.PI/10);return(r+.955)%(2*Math.PI/5)-2*Math.PI/10>=0?1/(Math.cos(2*Math.PI/10-e)+3.07768*Math.sin(2*Math.PI/10-e)):1/(Math.cos(e)+3.07768*Math.sin(e))}}function square$1(){return function(r){return Math.min(1/Math.abs(Math.cos(r)),1/Math.abs(Math.sin(r)))}}function triangle(){return function(r){const e=(r+3*Math.PI/2)%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))}}function triangleForward(){return function(r){const e=r%(2*Math.PI/3);return 1/(Math.cos(e)+Math.sqrt(3)*Math.sin(e))}}function cardioid(){return function(r){return 1+Math.sin(r)}}function circle(){return function(){return 1}}function pentagon(){return function(r){const e=(r+.955)%(2*Math.PI/5);return 1/(Math.cos(e)+.726543*Math.sin(e))}}function getMaxRadiusAndCenter(r,e){const i=e[0],n=e[1];let o=1;const l=[e[0]>>1,e[1]>>1];switch(r){case"cardioid":l[1]=~~(n/2.7*.4),o=Math.floor(Math.min(i/2.3,n/2.6));break;case"triangleForward":o=n/Math.sqrt(.75)>i?Math.floor(i/2):Math.floor(n/(2*Math.sqrt(.75)));break;case"triangle":case"triangleUpright":l[1]=~~(n/1.5),o=Math.floor(Math.min(n/1.5,i/2));break;case"circle":case"diamond":case"square":case"star":case"pentagon":o=Math.floor(Math.min(i/2,n/2));break;default:o=Math.floor(Math.max(i/2,n/2))}return{maxRadius:o,center:l}}const getShapeFunction=r=>shapes[r]?shapes[r]():shapes.circle(),generateIsEmptyPixel=r=>{if(!r||r==="#fff")return(n,o,l)=>{const d=n.width;return n.data[o*d*4+4*l+3]===0||n.data[o*d*4+4*l+0]===255&&n.data[o*d*4+4*l+1]===255&&n.data[o*d*4+4*l+2]===255};const e=vglobal.createCanvas({width:1,height:1}).getContext("2d",{willReadFrequently:!0});e.fillStyle=r,e.fillRect(0,0,1,1);const i=e.getImageData(0,0,1,1).data;return(n,o,l)=>{const d=n.width;return[0,1,2,3].every(u=>n.data[4*(o*d+l)+u]===i[u])}},generateMaskCanvas=(r,e,i,n)=>{const{backgroundColor:o="#fff"}=r,l=vglobal.createCanvas({width:e,height:i,dpr:1}),d=l.getContext("2d",{willReadFrequently:!0});return d.fillStyle=o,d.fillRect(0,0,l.width,l.height),r.type==="text"?drawTextMask(r,l.width,l.height,d):r.type==="geometric"&&drawGeometricMask(r,l.width,l.height,d),l},drawTextMask=(r,e,i,n)=>{const{fontFamily:o="sans-serif",fontWeight:l="normal",fontStyle:d="normal",fontVariant:u="normal",fill:f,text:g,hollow:_}=r;let y=12;n.font=`${d} ${u} ${l} ${y}px ${o}`,n.textAlign="center",n.textBaseline="middle",n.fillStyle=f??"black";const b=n.measureText(g),S=d!=="normal"?1.1:1,v=isValid(b.actualBoundingBoxRight)&&isValid(b.actualBoundingBoxLeft)?Math.ceil(S*(Math.abs(b.actualBoundingBoxRight)+Math.abs(b.actualBoundingBoxLeft))):0,A=Math.max(Math.ceil(b.width),v,y);if(_&&(n.globalCompositeOperation="xor"),A>e){const x=Math.min(e/A,i/y);n.fillText(g,e/2,i/2),n.scale(x,x)}else y=Math.floor(y*e/A),y=Math.min(y,i),n.font=`${d} ${u} ${l} ${y}px ${o}`,n.fillText(g,Math.floor(e/2),Math.floor(i/2))},generatePoints=(r,e,i=0,n)=>{const o=2*Math.PI/n;return new Array(n).fill(0).map((l,d)=>polarToCartesian(r,e,i+d*o))},generateCardioidPoints=(r,e,i=0,n)=>{const o=2*Math.PI/n,l=getShapeFunction("cardioid");return new Array(n).fill(0).map((d,u)=>{const f=i+u*o,g=e*l(f);return polarToCartesian(r,g,f)})},drawRegularPolygon=(r,e)=>{r.beginPath(),e.forEach((i,n)=>{n===0?r.moveTo(i.x,i.y):r.lineTo(i.x,i.y)}),r.closePath(),r.fill()},drawCardioid=(r,e)=>{let i;r.beginPath(),e.forEach((n,o)=>{o===0?r.moveTo(n.x,n.y):r.bezierCurveTo(n.x,n.y,i.x,i.y,n.x,n.y),i=n}),r.closePath(),r.fill()},drawGeometricMask=(r,e,i,n)=>{const{fill:o,hollow:l}=r,{center:d,maxRadius:u}=getMaxRadiusAndCenter(r.shape,[e,i]);n.fillStyle=o??"black",l&&(n.globalCompositeOperation="xor");const f=d[0],g=d[1];if(r.shape==="cardioid")drawCardioid(n,generateCardioidPoints({x:f,y:g},u,0,100));else if(r.shape==="circle")n.beginPath(),n.arc(f,g,u,0,2*Math.PI,!0),n.fill();else if(r.shape==="diamond")drawRegularPolygon(n,generatePoints({x:f,y:g},u,-Math.PI/2,4));else if(r.shape==="square")drawRegularPolygon(n,generatePoints({x:f,y:g},u,-Math.PI/4,4));else if(r.shape==="pentagon")drawRegularPolygon(n,generatePoints({x:f,y:g},u,Math.PI/2,5));else if(r.shape==="triangle"||r.shape==="triangleUpright")drawRegularPolygon(n,generatePoints({x:f,y:g},u,-Math.PI/2,3));else if(r.shape==="triangleForward")drawRegularPolygon(n,generatePoints({x:f,y:g},u,0,3));else if(r.shape==="star"){const _=generatePoints({x:f,y:g},u,-Math.PI/2,5),y=generatePoints({x:f,y:g},u/(2*Math.cos(Math.PI/5)),-Math.PI/2+Math.PI/5,5),b=[];for(let S=0;S<5;S++)b.push(_[S]),b.push(y[S]);drawRegularPolygon(n,b)}else n.fillRect(0,0,e,i)},GROUP_ATTRIBUTES=["x","y","dx","dy","scaleX","scaleY","angle","anchor","postMatrix","visible","clip","pickable","childrenPickable","zIndex","cursor"];class AbstractComponent extends Group$1{constructor(e,i){super(e),i!=null&&i.mode&&(this.mode=i.mode,this.setMode(i.mode)),i!=null&&i.skipDefault&&(this.skipDefault=!0),this.setTheme({common:{strokeBoundsBuffer:0}}),this.attribute=e,this.onSetStage(()=>{this.render(),this.bindEvents()})}setAttribute(e,i,n,o){const l=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate({[e]:i},this.attribute,e,o);if(l)return this._setAttributes(l,n);isPlainObject(this.attribute[e])&&isPlainObject(i)&&!isFunction(this.attribute[e])&&!isFunction(i)?merge$1(this.attribute[e],i):this.attribute[e]=i,GROUP_ATTRIBUTES.includes(e)||this.render(),this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!n&&!this.needUpdateTag(e)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.onAttributeUpdate()}setAttributes(e,i,n){return e=this.onBeforeAttributeUpdate&&this.onBeforeAttributeUpdate(e,this.attribute,null,n)||e,this._setAttributes(e,i)}_setAttributes(e,i){const n=Object.keys(e);this._mergeAttributes(e,n),n.every(o=>GROUP_ATTRIBUTES.includes(o))||this.render(),this.valid=this.isValid(),this.updateShapeAndBoundsTagSetted()||!i&&!this.needUpdateTags(n)?this.addUpdateBoundTag():this.addUpdateShapeAndBoundsTag(),this.addUpdatePositionTag(),this.onAttributeUpdate()}_mergeAttributes(e,i){isNil(i)&&(i=Object.keys(e));for(let n=0;n<i.length;n++){const o=i[n];!isPlainObject(this.attribute[o])||isFunction(this.attribute[o])||isFunction(e[o])?this.attribute[o]=e[o]:merge$1(this.attribute[o],e[o])}}bindEvents(){}_getNodeId(e){var i;return`${(i=this.id)!==null&&i!==void 0?i:this._uid}-${this.name}-${e}`}_dispatchEvent(e,i){var n;const o=new CustomEvent(e,i);o.manager=(n=this.stage)===null||n===void 0?void 0:n.eventSystem.manager,this.dispatchEvent(o)}}const MathPickerContribution=Symbol.for("MathPickerContribution"),MathArcPicker=Symbol.for("MathArcPicker"),MathAreaPicker=Symbol.for("MathAreaPicker"),MathCirclePicker=Symbol.for("MathCirclePicker"),MathImagePicker=Symbol.for("MathImagePicker"),MathLinePicker=Symbol.for("MathLinePicker"),MathPathPicker=Symbol.for("MathPathPicker"),MathRectPicker=Symbol.for("MathRectPicker"),MathSymbolPicker=Symbol.for("MathSymbolPicker"),MathTextPicker=Symbol.for("MathTextPicker"),MathPolygonPicker=Symbol.for("MathPolygonPicker"),MathGlyphPicker=Symbol.for("MathGlyphPicker"),CanvasArcPicker=Symbol.for("CanvasArcPicker"),CanvasArc3dPicker=Symbol.for("CanvasArc3dPicker"),CanvasAreaPicker=Symbol.for("CanvasAreaPicker"),CanvasCirclePicker=Symbol.for("CanvasCirclePicker"),CanvasImagePicker=Symbol.for("CanvasImagePicker"),CanvasLinePicker=Symbol.for("CanvasLinePicker"),CanvasPathPicker=Symbol.for("CanvasPathPicker"),CanvasRectPicker=Symbol.for("CanvasRectPicker"),CanvasRect3dPicker=Symbol.for("CanvasRect3dPicker"),CanvasSymbolPicker=Symbol.for("CanvasSymbolPicker"),CanvasTextPicker=Symbol.for("CanvasTextPicker"),CanvasPolygonPicker=Symbol.for("CanvasPolygonPicker"),CanvasPyramid3dPicker=Symbol.for("CanvasPyramid3dPicker"),CanvasRichTextPicker=Symbol.for("CanvasRichTextPicker"),CanvasGlyphPicker=Symbol.for("CanvasGlyphPicker"),CanvasGroupPicker=Symbol.for("CanvasGroupPicker"),CanvasPickerContribution=Symbol.for("CanvasPickerContribution"),calcDirection=(r,e)=>{const i=e.x-r.x,n=e.y-r.y;return Math.abs(i)>Math.abs(n)?i>0?"right":"left":n>0?"down":"up"},calcDistance=(r,e)=>{const i=Math.abs(e.x-r.x),n=Math.abs(e.y-r.y);return Math.sqrt(i*i+n*n)},getCenter=r=>{const e=r.length;if(e===1)return{x:Math.round(r[0].x),y:Math.round(r[0].y)};let i=0,n=0,o=0;for(;o<e;)i+=r[o].x,n+=r[o].y,o++;return{x:Math.round(i/e),y:Math.round(n/e)}};class Gesture extends EventEmitter{constructor(e,i={}){var n,o,l,d,u,f,g,_,y,b;super(),this.cachedEvents=[],this.startPoints=[],this.processEvent={},this.throttleTimer=0,this.emitThrottles=[],this.lastTapTarget=null,this.onStart=S=>{this.cachedEvents=[],this.startPoints=[],this.reset(),this.startTime=clock.now();const{cachedEvents:v,startPoints:A}=this;S&&v.push(S.clone()),A.length=v.length;for(let x=0;x<v.length;x++){const{x:T,y:C}=v[x],E={x:T,y:C};A[x]=E}if(A.length!==1)this.startDistance=calcDistance(A[0],A[1]),this.center=getCenter([A[0],A[1]]);else{const x=v[0];this.pressTimeout=setTimeout(()=>{x.direction="none",x.deltaX=0,x.deltaY=0,x.points=A,this.triggerStartEvent("press",x),this.triggerEvent("press",x),this.eventType="press",this.direction="none",this.pressTimeout=null},this.config.press.time)}},this.onMove=S=>{this.clearPressTimeout();const{startPoints:v,cachedEvents:A}=this;if(!v.length)return;const x=S.clone(),{x:T,y:C,pointerId:E}=x;for(let I=0,D=A.length;I<D;I++)if(E===A[I].pointerId){A[I]=x;break}const P={x:T,y:C},R=A.map(I=>({x:I.x,y:I.y})),L=clock.now();if(this.prevMoveTime=this.lastMoveTime,this.prevMovePoint=this.lastMovePoint,this.lastMoveTime=L,this.lastMovePoint=P,v.length===1){const I=v[0],D=T-I.x,O=C-I.y,N=this.direction||calcDirection(I,P);this.direction=N;const V=this.getEventType(P);return x.direction=N,x.deltaX=D,x.deltaY=O,x.points=R,this.triggerStartEvent(V,x),void this.triggerEvent(V,x)}const{startDistance:w}=this,B=calcDistance(R[0],R[1]);x.scale=B/w,x.center=this.center,x.points=R,this.triggerStartEvent("pinch",x),this.triggerEvent("pinch",x)},this.onEnd=S=>{const v=S.clone(),{cachedEvents:A,startPoints:x}=this,T=A.map(C=>({x:C.x,y:C.y}));if(v.points=T,this.triggerEndEvent(v),A.length===1){const C=clock.now(),E=this.lastMoveTime;if(C-E<100){const P=E-(this.prevMoveTime||this.startTime);if(P>0){const R=this.prevMovePoint||x[0],L=this.lastMovePoint||x[0],w=calcDistance(R,L),B=w/P;if(B>this.config.swipe.velocity&&w>this.config.swipe.threshold)return v.velocity=B,v.direction=calcDirection(R,L),this.triggerEvent("swipe",v),this.cachedEvents=[],this.startPoints=[],void this.reset()}}C-this.startTime<this.config.press.time&&(C-this.lastTapTime<this.config.tap.interval&&S.target===this.lastTapTarget?this.tapCount++:this.tapCount=1,this.lastTapTime=C,this.lastTapTarget=S.target,this.tapCount===1?this.triggerEvent("tap",v):this.tapCount===2&&(this.triggerEvent("doubletap",v),this.tapCount=0))}for(let C=0,E=A.length;C<E;C++)if(A[C].pointerId===v.pointerId){A.splice(C,1),x.splice(C,1);break}this.reset(),A.length>0&&this.onStart()},this.element=e,this.tapCount=0,this.lastTapTime=0,this.config={press:{time:(o=(n=i==null?void 0:i.press)===null||n===void 0?void 0:n.time)!==null&&o!==void 0?o:251,threshold:(d=(l=i==null?void 0:i.press)===null||l===void 0?void 0:l.threshold)!==null&&d!==void 0?d:9},swipe:{threshold:(f=(u=i==null?void 0:i.swipe)===null||u===void 0?void 0:u.threshold)!==null&&f!==void 0?f:10,velocity:(_=(g=i==null?void 0:i.swipe)===null||g===void 0?void 0:g.velocity)!==null&&_!==void 0?_:.3},tap:{interval:(b=(y=i==null?void 0:i.tap)===null||y===void 0?void 0:y.interval)!==null&&b!==void 0?b:300}},this.initEvents()}initEvents(){const{element:e}=this;e&&(e.addEventListener("pointerdown",this.onStart),e.addEventListener("pointermove",this.onMove),e.addEventListener("pointerup",this.onEnd),e.addEventListener("pointerupoutside",this.onEnd))}removeEvents(){const{element:e}=this;e&&(e.removeEventListener("pointerdown",this.onStart),e.removeEventListener("pointermove",this.onMove),e.removeEventListener("pointerup",this.onEnd),e.removeEventListener("pointerupoutside",this.onEnd))}release(){this.removeEvents(),this.element=null}getEventType(e){const{eventType:i,startTime:n,startPoints:o}=this;if(i==="press")return i;let l;return l=clock.now()-n>this.config.press.time&&calcDistance(o[0],e)<this.config.press.threshold?"press":"pan",this.eventType=l,l}enable(e){this.processEvent[e]=!0}isProcess(e){return this.processEvent[e]}pushEvent(e,i){const{emitThrottles:n}=this,o={type:e,ev:i};for(let l=0,d=n.length;l<d;l++)if(n[l].type===e)return void n.splice(l,1,o);n.push(o)}clearPressTimeout(){this.pressTimeout&&(clearTimeout(this.pressTimeout),this.pressTimeout=null)}reset(){this.clearPressTimeout(),this.startTime=0,this.startDistance=0,this.direction=null,this.eventType=null,this.prevMoveTime=0,this.prevMovePoint=null,this.lastMoveTime=0,this.lastMovePoint=null}triggerEvent(e,i){this.pushEvent(e,i);const{throttleTimer:n,emitThrottles:o}=this;n||(this.throttleTimer=application.global.getRequestAnimationFrame()(()=>{application.global.getCancelAnimationFrame()(this.throttleTimer),this.throttleTimer=null;for(let l=0,d=o.length;l<d;l++){const{type:u,ev:f}=o[l];this.emitEvent(u,f)}this.emitThrottles.length=0}))}triggerStartEvent(e,i){this.isProcess(e)||(this.enable(e),this.triggerEvent(`${e}start`,i))}triggerEndEvent(e){const i=this.processEvent;Object.keys(i).forEach(n=>{this.triggerEvent(`${n}end`,e),n==="press"&&this.triggerEvent(`${n}up`,e),delete i[n]})}emitEvent(e,i){if(!this.element)return;const n=this.element._events[WILDCARD];if(n)if("fn"in n)n.fn.call(n.context,i,e);else for(let o=0,l=n.length;o<l&&!i.propagationImmediatelyStopped;o++)n[o].fn.call(n[o].context,i,e);this.emit(e,i)}}var __decorate$C=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$u=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)};const outP=[0,0,0],addArcToBezierPath=(r,e,i,n,o,l,d,u)=>{if(u)for(;i>e;)i-=pi2;else for(;i<e;)i+=pi2;const f=pi$1/3*(i>e?1:-1);let g=e,_=g;for(;_!==i;){_=f>0?Math.min(_+f,i):Math.max(_+f,i);const y=Math.abs(_-g),b=4*Math.tan(y/4)/3,S=_<g?-1:1,v=Math.cos(g),A=Math.sin(g),x=Math.cos(_),T=Math.sin(_),C=v*l+n,E=A*d+o,P=x*l+n,R=T*d+o,L=l*b*S,w=d*b*S;r.push([C-L*A,E+w*v,P+L*T,R-w*x,P,R]),g=_}};let BrowserContext2d=class{set fillStyle(r){this.nativeContext.fillStyle=r}get fillStyle(){return this.nativeContext.fillStyle}set font(r){this.nativeContext.font=r}get font(){return this.nativeContext.font}set globalAlpha(r){this.nativeContext.globalAlpha=r*this.baseGlobalAlpha}get globalAlpha(){return this.nativeContext.globalAlpha}set lineCap(r){this.nativeContext.lineCap=r}get lineCap(){return this.nativeContext.lineCap}set lineDashOffset(r){this.nativeContext.lineDashOffset=r}get lineDashOffset(){return this.nativeContext.lineDashOffset}set lineJoin(r){this.nativeContext.lineJoin=r}get lineJoin(){return this.nativeContext.lineJoin}set lineWidth(r){this.nativeContext.lineWidth=r}get lineWidth(){return this.nativeContext.lineWidth}set miterLimit(r){this.nativeContext.miterLimit=r}get miterLimit(){return this.nativeContext.miterLimit}set shadowBlur(r){this.nativeContext.shadowBlur=r}get shadowBlur(){return this.nativeContext.shadowBlur}set shadowColor(r){this.nativeContext.shadowColor=r}get shadowColor(){return this.nativeContext.shadowColor}set shadowOffsetX(r){this.nativeContext.shadowOffsetX=r}get shadowOffsetX(){return this.nativeContext.shadowOffsetX}set shadowOffsetY(r){this.nativeContext.shadowOffsetY=r}get shadowOffsetY(){return this.nativeContext.shadowOffsetY}set strokeStyle(r){this.nativeContext.strokeStyle=r}get strokeStyle(){return this.nativeContext.strokeStyle}set textAlign(r){this.nativeContext.textAlign=r}get textAlign(){return this.nativeContext.textAlign}set textBaseline(r){this.nativeContext.textBaseline=r}get textBaseline(){return this.nativeContext.textBaseline}get inuse(){return!!this._inuse}set inuse(r){r!==!!this._inuse&&(this._inuse=r,r?(this.nativeContext.save(),this.reset()):this.nativeContext.restore())}constructor(r,e){this.fillAttributes=Object.assign(Object.assign({},DefaultFillStyle),{opacity:1}),this.strokeAttributes=Object.assign(Object.assign({},DefaultStrokeStyle),{opacity:1}),this.textAttributes=Object.assign(Object.assign({},DefaultTextStyle),{opacity:1}),this._clearShadowStyle=!1,this._clearFilterStyle=!1,this._clearGlobalCompositeOperationStyle=!1;const i=r.nativeCanvas.getContext("2d");if(!i)throw new Error("2d");this.nativeContext=i,this.canvas=r,this.matrix=new Matrix(1,0,0,1,0,0),this.stack=[],this.dpr=e,this.applyedMatrix=new Matrix(1,0,0,1,0,0),this._clearMatrix=new Matrix(1,0,0,1,0,0),this.baseGlobalAlpha=1}reset(){this.stack.length&&Logger.getInstance().warn("bugmatrix"),this.matrix.setValue(1,0,0,1,0,0),this.applyedMatrix=new Matrix(1,0,0,1,0,0),this.stack.length=0,this.nativeContext.setTransform(1,0,0,1,0,0)}getCanvas(){return this.canvas}getContext(){return this.nativeContext}setTransformForCurrent(r=!1){!r&&this.applyedMatrix.equalToMatrix(this.matrix)||(this.applyedMatrix.setValue(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f),this.nativeContext.setTransform(this.matrix.a,this.matrix.b,this.matrix.c,this.matrix.d,this.matrix.e,this.matrix.f))}get currentMatrix(){return this.matrix}cloneMatrix(r){return matrixAllocate.allocateByObj(r)}clear(){this.save(),this.resetTransform(),this.nativeContext.clearRect(0,0,this.canvas.width,this.canvas.height),this.restore()}restore(){this.nativeContext.restore(),this.stack.length>0&&(matrixAllocate.free(this.matrix),this.matrix=this.stack.pop(),this.setTransformForCurrent(!0))}highPerformanceRestore(){this.stack.length>0&&(matrixAllocate.free(this.matrix),this.matrix=this.stack.pop())}rotate(r,e=!0){this.matrix.rotate(r),e&&this.setTransformForCurrent()}save(){const r=this.cloneMatrix(this.matrix);this.stack.push(r),this.nativeContext.save()}highPerformanceSave(){const r=this.cloneMatrix(this.matrix);this.stack.push(r)}scale(r,e,i=!0){this.matrix.scale(r,e),i&&this.setTransformForCurrent()}setScale(r,e,i=!0){this.matrix.setScale(r,e),i&&this.setTransformForCurrent()}scalePoint(r,e,i,n,o=!0){this.translate(i,n,!1),this.scale(r,e,!1),this.translate(-i,-n,!1),o&&this.setTransformForCurrent()}setTransform(r,e,i,n,o,l,d=!0,u=this.dpr){this.matrix.setValue(u*r,u*e,u*i,u*n,u*o,u*l),d&&this.setTransformForCurrent()}setTransformFromMatrix(r,e=!0,i=this.dpr){this.matrix.setValue(r.a*i,r.b*i,r.c*i,r.d*i,r.e*i,r.f*i),e&&this.setTransformForCurrent()}resetTransform(r=!0,e=this.dpr){this.setTransform(e,0,0,e,0,0),r&&this.setTransformForCurrent()}transform(r,e,i,n,o,l,d=!0){this.matrix.multiply(r,e,i,n,o,l),d&&this.setTransformForCurrent()}transformFromMatrix(r,e){this.matrix.multiply(r.a,r.b,r.c,r.d,r.e,r.f),e&&this.setTransformForCurrent()}translate(r,e,i=!0){this.matrix.translate(r,e),i&&this.setTransformForCurrent()}rotateDegrees(r,e=!0){const i=r*Math.PI/180;this.rotate(i,e)}rotateAbout(r,e,i,n=!0){this.translate(e,i,!1),this.rotate(r,!1),this.translate(-e,-i,!1),n&&this.setTransformForCurrent()}rotateDegreesAbout(r,e,i,n=!0){this.translate(e,i,!1),this.rotateDegrees(r,!1),this.translate(-e,-i,!1),n&&this.setTransformForCurrent()}beginPath(){this.disableBeginPath||this.nativeContext.beginPath()}clip(r,e){r?typeof r=="string"?this.nativeContext.clip(r):this.nativeContext.clip(r,e):this.nativeContext.clip()}arc(r,e,i,n,o,l,d){if(d=d||0,this.camera){const u=[];addArcToBezierPath(u,n,o,r,e,i,i,l);for(let f=0;f<u.length;++f){const g=u[f];this.bezierCurveTo(g[0],g[1],g[2],g[3],g[4],g[5],d)}}else this.nativeContext.arc(r,e,Math.max(0,i),n,o,l)}arcTo(r,e,i,n,o){this.nativeContext.arcTo(r,e,i,n,o)}bezierCurveTo(r,e,i,n,o,l,d){if(d=d||0,this.camera){let u=d,f=d;this.modelMatrix&&(transformMat4(outP,[r,e,d],this.modelMatrix),r=outP[0],e=outP[1],u=outP[2],transformMat4(outP,[i,n,d],this.modelMatrix),i=outP[0],n=outP[1],f=outP[2],transformMat4(outP,[o,l,d],this.modelMatrix),o=outP[0],l=outP[1],d=outP[2]);let g=this.camera.vp(o,l,d);o=g.x,l=g.y,g=this.camera.vp(r,e,u),r=g.x,e=g.y,g=this.camera.vp(i,n,f),i=g.x,n=g.y}this.nativeContext.bezierCurveTo(r,e,i,n,o,l)}closePath(){this.nativeContext.closePath()}ellipse(r,e,i,n,o,l,d,u){u==null?this.nativeContext.ellipse(r,e,i,n,o,l,d):this.nativeContext.ellipse(r,e,i,n,o,l,d,u)}lineTo(r,e,i){if(i=i||0,this.camera){this.modelMatrix&&(transformMat4(outP,[r,e,i],this.modelMatrix),r=outP[0],e=outP[1],i=outP[2]);const n=this.camera.vp(r,e,i);r=n.x,e=n.y}this.nativeContext.lineTo(r,e)}moveTo(r,e,i){if(i=i||0,this.camera){this.modelMatrix&&(transformMat4(outP,[r,e,i],this.modelMatrix),r=outP[0],e=outP[1],i=outP[2]);const n=this.camera.vp(r,e,i);r=n.x,e=n.y}this.nativeContext.moveTo(r,e)}quadraticCurveTo(r,e,i,n,o){if(o=o||0,this.camera){let l=o;this.modelMatrix&&(transformMat4(outP,[r,e,o],this.modelMatrix),r=outP[0],e=outP[1],l=outP[2],transformMat4(outP,[i,n,o],this.modelMatrix),i=outP[0],n=outP[1],o=outP[2]);let d=this.camera.vp(i,n,o);i=d.x,n=d.y,d=this.camera.vp(r,e,l),r=d.x,e=d.y}this.nativeContext.quadraticCurveTo(r,e,i,n)}rect(r,e,i,n,o){o=o||0,this.camera?(this.moveTo(r,e,o),this.lineTo(r+i,e,o),this.lineTo(r+i,e+n,o),this.lineTo(r,e+n,o),this.closePath()):this.nativeContext.rect(r,e,i,n)}createImageData(){const r=arguments;return r.length===2?this.nativeContext.createImageData(r[0],r[1]):r.length===1?this.nativeContext.createImageData(r[0]):null}createLinearGradient(r,e,i,n){return isFinite(r+e+i+n)||(r=0,e=0,i=0,n=0),this.nativeContext.createLinearGradient(r,e,i,n)}createPattern(r,e){return r.width===0||r.height===0?null:this.nativeContext.createPattern(r,e)}createRadialGradient(r,e,i,n,o,l){return this.nativeContext.createRadialGradient(r,e,i,n,o,l)}createConicGradient(r,e,i,n){let o,l=!1;const d=this;return{stops:[],addColorStop(u,f){this.stops.push([u,f]),l=!0},GetPattern(u,f,g){return l&&(g||(g=n-i),o=createConicalGradient(d,this.stops,r,e,g,i,n,u,f),l=!1),o}}}fill(r,e){this.disableFill||(r?this.nativeContext.fill(r):this.nativeContext.fill())}fillRect(r,e,i,n){this.nativeContext.fillRect(r,e,i,n)}clearRect(r,e,i,n){this.nativeContext.clearRect(r,e,i,n)}project(r,e,i){if(i=i||0,this.camera){this.modelMatrix&&(transformMat4(outP,[r,e,i],this.modelMatrix),r=outP[0],e=outP[1],i=outP[2]);const n=this.camera.vp(r,e,i);r=n.x,e=n.y}return{x:r,y:e}}view(r,e,i){return i=i||0,this.camera?(this.modelMatrix&&(transformMat4(outP,[r,e,i],this.modelMatrix),r=outP[0],e=outP[1],i=outP[2]),this.camera.view(r,e,i)):[r,e,i]}fillText(r,e,i,n){if(n=n||0,this.camera){this.modelMatrix&&(transformMat4(outP,[e,i,n],this.modelMatrix),e=outP[0],i=outP[1],n=outP[2]);const o=this.camera.vp(e,i,n);e=o.x,i=o.y}this.nativeContext.fillText(r,e,i)}getImageData(r,e,i,n){return this.nativeContext.getImageData(r,e,i,n)}getLineDash(){return this.nativeContext.getLineDash()}isPointInPath(r,e){return this.nativeContext.isPointInPath(r,e)}isPointInStroke(r,e){return this.nativeContext.isPointInStroke(r,e)}measureText(r,e=application.global.measureTextMethod){var i,n;if(!e||e==="native")return this.nativeContext.measureText(r);this.mathTextMeasure||(this.mathTextMeasure=application.graphicUtil.createTextMeasureInstance({},{},()=>this.canvas.nativeCanvas));const o=(i=this.fontFamily)!==null&&i!==void 0?i:DefaultTextStyle.fontFamily,l=(n=this.fontSize)!==null&&n!==void 0?n:DefaultTextStyle.fontSize;return this.mathTextMeasure.textSpec.fontFamily===o&&this.mathTextMeasure.textSpec.fontSize===l||(this.mathTextMeasure.textSpec.fontFamily=o,this.mathTextMeasure.textSpec.fontSize=l,this.mathTextMeasure._numberCharSize=null,this.mathTextMeasure._fullCharSize=null,this.mathTextMeasure._letterCharSize=null,this.mathTextMeasure._specialCharSizeMap={}),this.mathTextMeasure.measure(r,e)}putImageData(r,e,i){this.nativeContext.putImageData(r,e,i)}setLineDash(r){const e=arguments,i=this.nativeContext;this.nativeContext.setLineDash?e[0]&&i.setLineDash(e[0]):"mozDash"in i?i.mozDash=e[0]:"webkitLineDash"in i&&(i.webkitLineDash=e[0])}stroke(r){this.disableStroke||(r?this.nativeContext.stroke(r):this.nativeContext.stroke())}strokeRect(r,e,i,n){this.nativeContext.strokeRect(r,e,i,n)}strokeText(r,e,i,n){if(n=n||0,this.camera){this.modelMatrix&&(transformMat4(outP,[e,i,n],this.modelMatrix),e=outP[0],i=outP[1],n=outP[2]);const o=this.camera.vp(e,i,n);e=o.x,i=o.y}this.nativeContext.strokeText(r,e,i)}drawImage(){const r=this.nativeContext,e=arguments;e.length===3?r.drawImage(e[0],e[1],e[2]):e.length===5?r.drawImage(e[0],e[1],e[2],e[3],e[4]):e.length===9&&r.drawImage(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7],e[8])}setCommonStyle(r,e,i,n,o){if(Array.isArray(o)){if(o.length<=1)return this._setCommonStyle(r,e,i,n,o[0]);const l=Object.create(o[0]);return o.forEach((d,u)=>{u!==0&&Object.assign(l,d)}),this._setCommonStyle(r,e,i,n,l)}return this._setCommonStyle(r,e,i,n,o)}_setCommonStyle(r,e,i,n,o){const l=this.nativeContext;o||(o=this.fillAttributes);const{fillOpacity:d=o.fillOpacity,opacity:u=o.opacity,fill:f=o.fill}=e;l.globalAlpha=d*u*this.baseGlobalAlpha,d>1e-12&&u>1e-12&&(l.fillStyle=createColor(this,f,r,i,n))}setShadowBlendStyle(r,e,i){if(Array.isArray(i)){if(i.length<=1)return this._setShadowBlendStyle(r,i[0]);const n=Object.create(i[0]);return i.forEach((o,l)=>{l!==0&&Object.assign(n,o)}),this._setShadowBlendStyle(r,e,n)}return this._setShadowBlendStyle(r,e,i)}_setShadowBlendStyle(r,e,i){const n=this.nativeContext;i||(i=this.fillAttributes);const{opacity:o=i.opacity,shadowBlur:l=i.shadowBlur,shadowColor:d=i.shadowColor,shadowOffsetX:u=i.shadowOffsetX,shadowOffsetY:f=i.shadowOffsetY,blur:g=i.blur,globalCompositeOperation:_=i.globalCompositeOperation}=e;o<=1e-12||(l||u||f?(n.shadowBlur=l*this.dpr,n.shadowColor=d,n.shadowOffsetX=u*this.dpr,n.shadowOffsetY=f*this.dpr,this._clearShadowStyle=!0):this._clearShadowStyle&&(n.shadowBlur=0,n.shadowOffsetX=0,n.shadowOffsetY=0),g?(n.filter=`blur(${g}px)`,this._clearFilterStyle=!0):this._clearFilterStyle&&(n.filter="blur(0px)",this._clearFilterStyle=!1),_?(n.globalCompositeOperation=_,this._clearGlobalCompositeOperationStyle=!0):this._clearGlobalCompositeOperationStyle&&(n.globalCompositeOperation="source-over",this._clearGlobalCompositeOperationStyle=!1))}setStrokeStyle(r,e,i,n,o){if(Array.isArray(o)){if(o.length<=1)return this._setStrokeStyle(r,e,i,n,o[0]);const l=Object.create(o[0]);return o.forEach((d,u)=>{u!==0&&Object.assign(l,d)}),this._setStrokeStyle(r,e,i,n,l)}return this._setStrokeStyle(r,e,i,n,o)}_setStrokeStyle(r,e,i,n,o){const l=this.nativeContext;o||(o=this.strokeAttributes);const{strokeOpacity:d=o.strokeOpacity,opacity:u=o.opacity}=e;if(l.globalAlpha=d*u*this.baseGlobalAlpha,d>1e-12&&u>1e-12){const{lineWidth:f=o.lineWidth,stroke:g=o.stroke,lineJoin:_=o.lineJoin,lineDash:y=o.lineDash,lineCap:b=o.lineCap,miterLimit:S=o.miterLimit,keepStrokeScale:v=o.keepStrokeScale}=e;l.lineWidth=v?f:getScaledStroke(this,f,this.dpr),l.strokeStyle=createColor(this,g,r,i,n),l.lineJoin=_,y&&l.setLineDash(y),l.lineCap=b,l.miterLimit=S}}setTextStyleWithoutAlignBaseline(r,e,i){const n=this.nativeContext;e||(e=this.textAttributes);const{scaleIn3d:o=e.scaleIn3d}=r;r.font?n.font=r.font:n.font=getContextFont(r,e,o&&this.camera&&this.camera.getProjectionScale(i));const{fontFamily:l=e.fontFamily,fontSize:d=e.fontSize}=r;this.fontFamily=l,this.fontSize=d,n.textAlign="left",n.textBaseline="alphabetic"}setTextStyle(r,e,i){var n,o;const l=this.nativeContext;e||(e=this.textAttributes),r.font?l.font=r.font:l.font=getContextFont(r,e,this.camera&&this.camera.getProjectionScale(i));const{fontFamily:d=e.fontFamily,fontSize:u=e.fontSize}=r;this.fontFamily=d,this.fontSize=u,l.textAlign=(n=r.textAlign)!==null&&n!==void 0?n:e.textAlign,l.textBaseline=(o=r.textBaseline)!==null&&o!==void 0?o:e.textBaseline}draw(){}clearMatrix(r=!0,e=this.dpr){this.setTransformFromMatrix(this._clearMatrix,r,e)}setClearMatrix(r,e,i,n,o,l){this._clearMatrix.setValue(r,e,i,n,o,l)}onlyTranslate(r=this.dpr){return this.matrix.a===r&&this.matrix.b===0&&this.matrix.c===0&&this.matrix.d===r}release(...r){this.stack.forEach(e=>matrixAllocate.free(e)),this.stack.length=0}};BrowserContext2d.env="browser",BrowserContext2d=__decorate$C([injectable(),__metadata$u("design:paramtypes",[Object,Number])],BrowserContext2d);var __decorate$B=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$t=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)};let BrowserCanvas=class extends BaseCanvas{constructor(r){super(r)}init(r){const{container:e}=r;if(typeof e=="string"){const i=application.global.getElementById(e);i&&(this._container=i)}else this._container=e;this._context=new BrowserContext2d(this,this._dpr),this.initStyle()}initStyle(){if(!this.controled)return;const{nativeCanvas:r}=this;r.width=this._pixelWidth,r.height=this._pixelHeight,!r.style||this.setCanvasStyle(r,this._x,this._y,this._displayWidth,this._displayHeight),this._container&&this._container.appendChild(r),this.visiable||this.hide()}hide(){this._nativeCanvas&&(this._nativeCanvas.style.display="none")}show(){this._nativeCanvas&&(this._nativeCanvas.style.display="block")}applyPosition(){const r=this._nativeCanvas;r.style.position="absolute",r.style.top=`${this._y}px`,r.style.left=`${this._x}px`}resetStyle(r){if(!this.controled)return;const{width:e=this._displayWidth,height:i=this._displayHeight,dpr:n=this._dpr,x:o=this._x,y:l=this._y}=r,{nativeCanvas:d}=this;d.width=e*n,d.height=i*n,!d.style||this.setCanvasStyle(d,o,l,e,i),r.id&&(d.id=r.id),this.visiable||this.hide()}setCanvasStyle(r,e,i,n,o){this.controled&&(r.style.width=`${n}px`,r.style.height=`${o}px`)}toDataURL(r,e){return r==="image/jpeg"?this._nativeCanvas.toDataURL(r,e):r==="image/png"?this._nativeCanvas.toDataURL(r):this._nativeCanvas.toDataURL(r,e)}resize(r,e){this.controled&&(this._pixelWidth=r*this._dpr,this._pixelHeight=e*this._dpr,this._displayWidth=r,this._displayHeight=e,this._nativeCanvas.style&&(this._nativeCanvas.style.width=`${r}px`,this._nativeCanvas.style.height=`${e}px`),this._nativeCanvas.width=this._pixelWidth,this._nativeCanvas.height=this._pixelHeight,this._context.dpr=this._dpr)}};BrowserCanvas.env="browser",BrowserCanvas=__decorate$B([injectable(),__metadata$t("design:paramtypes",[Object])],BrowserCanvas);function createModule(r,e){return new ContainerModule(i=>{i(CanvasFactory).toDynamicValue(()=>n=>new r(n)).whenTargetNamed(r.env),i(Context2dFactory).toDynamicValue(()=>(n,o)=>new e(n,o)).whenTargetNamed(e.env)})}const browserCanvasModule=createModule(BrowserCanvas,BrowserContext2d);var __decorate$A=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$s=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$o=function(r,e){return function(i,n){e(i,n,r)}};let DefaultCanvasPickerService=class extends DefaultPickService{constructor(r,e,i){super(i),this.contributions=r,this.drawContribution=e,this.pickItemInterceptorContributions=i,this.global.hooks.onSetEnv.tap("canvas-picker-service",(n,o,l)=>{this.configure(l,o)}),this.configure(this.global,this.global.env),this.pickerMap=new Map,this.init()}init(){this.contributions.getContributions().forEach(r=>{this.pickerMap.set(r.numberType,r)}),super._init()}configure(r,e){this.pickCanvas=canvasAllocate.shareCanvas(),this.pickContext=this.pickCanvas.getContext("2d")}pickItem(r,e,i,n){if(r.attribute.pickable===!1)return null;if(this.InterceptorContributions.length)for(let f=0;f<this.InterceptorContributions.length;f++){const g=this.InterceptorContributions[f];if(g.beforePickItem){const _=g.beforePickItem(r,this,e,n,{parentMatrix:i});if(_)return _}}const o=this.pickerMap.get(r.numberType);if(!o)return null;const l=o.contains(r,e,n),d=l?r:null,u={graphic:d,params:l};if(d)return u;if(this.InterceptorContributions.length)for(let f=0;f<this.InterceptorContributions.length;f++){const g=this.InterceptorContributions[f];if(g.afterPickItem){const _=g.afterPickItem(r,this,e,n,{parentMatrix:i});if(_)return _}}return u}};DefaultCanvasPickerService=__decorate$A([injectable(),__param$o(0,inject(ContributionProvider)),__param$o(0,named(CanvasPickerContribution)),__param$o(1,inject(DrawContribution)),__param$o(2,inject(ContributionProvider)),__param$o(2,named(PickItemInterceptor)),__metadata$s("design:paramtypes",[Object,Object,Object])],DefaultCanvasPickerService);var __decorate$z=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d};let DefaultCanvasGroupPicker=class{constructor(){this.type="group",this.numberType=GROUP_NUMBER_TYPE}contains(r,e,i){return!1}};DefaultCanvasGroupPicker=__decorate$z([injectable()],DefaultCanvasGroupPicker);const m$1=new ContainerModule((r,e,i,n)=>{m$1.__vloaded||(m$1.__vloaded=!0,r(CanvasGroupPicker).to(DefaultCanvasGroupPicker).inSingletonScope(),r(CanvasPickerContribution).toService(CanvasGroupPicker),bindContributionProvider(r,CanvasPickerContribution))});m$1.__vloaded=!1;const canvasPickerModule=new ContainerModule((r,e,i,n)=>{i(DefaultCanvasPickerService)||r(DefaultCanvasPickerService).toSelf().inSingletonScope(),i(PickerService)?n(PickerService).toService(DefaultCanvasPickerService):r(PickerService).toService(DefaultCanvasPickerService)});function loadCanvasPicker(r){r.load(m$1),r.load(canvasPickerModule)}var BrowserWindowHandlerContribution_1,__decorate$y=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$r=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)};let BrowserWindowHandlerContribution=BrowserWindowHandlerContribution_1=class extends BaseWindowHandlerContribution{get container(){return this.canvas.nativeCanvas.parentElement}static GenerateCanvasId(){return`${BrowserWindowHandlerContribution_1.idprefix}_${BrowserWindowHandlerContribution_1.prefix_count++}`}constructor(){super(),this.type="browser",this._canvasIsIntersecting=!0,this.global=application.global,this.viewBox=new AABBBounds,this.modelMatrix=new Matrix(1,0,0,1,0,0)}getTitle(){return this.canvas.id&&this.canvas.id.toString()}getWH(){return{width:this.canvas.width/(this.canvas.dpr||1),height:this.canvas.height/(this.canvas.dpr||1)}}getXY(){return this.canvas.nativeCanvas.getBoundingClientRect()}createWindow(r){r.canvas?this.createWindowByCanvas(r):this.createWindowByConfig(r),this.postInit()}postInit(){if(this.global.optimizeVisible)try{this.observerCanvas()}catch{console.error("IntersectionObserver")}}isElementVisible(r){const e=r.getBoundingClientRect(),i=window.innerWidth||document.documentElement.clientWidth,n=window.innerHeight||document.documentElement.clientHeight;return!(e.right<0||e.bottom<0||e.left>i||e.top>n)}observerCanvas(){this._canvasIsIntersecting=this.isElementVisible(this.canvas.nativeCanvas);const r=new IntersectionObserver((e,i)=>{e.forEach(n=>{this._canvasIsIntersecting!==n.isIntersecting?(this._canvasIsIntersecting=n.isIntersecting,this._onVisibleChangeCb&&this._onVisibleChangeCb(n.isIntersecting)):this._canvasIsIntersecting=n.isIntersecting})});r&&r.observe(this.canvas.nativeCanvas)}createWindowByConfig(r){const e=this.global.createCanvas({width:r.width,height:r.height});let i;if(i=typeof r.container=="string"?this.global.getElementById(r.container):r.container?r.container:this.global.getRootElement(),!i)throw new Error("containerId");r.offscreen?i=null:i.appendChild(e);const n={width:r.width,height:r.height,dpr:r.dpr,nativeCanvas:e,container:i,id:BrowserWindowHandlerContribution_1.GenerateCanvasId(),canvasControled:!0};this.canvas=new BrowserCanvas(n)}createWindowByCanvas(r){var e;let i;if(typeof r.canvas=="string"){if(i=this.global.getElementById(r.canvas),!i)throw new Error("canvasId canvasdom")}else i=r.canvas;if(!i)throw new Error("canvas");let n=r.width,o=r.height;if(n==null||o==null||!r.canvasControled){const d=i.getBoundingClientRect();n=d.width,o=d.height}let l=r.dpr;l==null&&(l=(e=i.getContext("2d").pixelRatio)!==null&&e!==void 0?e:i.width/n),this.canvas=new BrowserCanvas({width:n,height:o,dpr:l,nativeCanvas:i,canvasControled:r.canvasControled})}releaseWindow(){this.canvas.release()}resizeWindow(r,e){this.canvas.resize(r,e)}setDpr(r){this.canvas.dpr=r}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}addEventListener(r,e,i){return this.canvas.nativeCanvas.addEventListener(r,e,i)}removeEventListener(r,e,i){return this.canvas.nativeCanvas.removeEventListener(r,e,i)}dispatchEvent(r){return this.canvas.nativeCanvas.dispatchEvent(r)}getStyle(){var r;return(r=this.canvas.nativeCanvas.style)!==null&&r!==void 0?r:{}}setStyle(r){this.canvas.nativeCanvas.style=r}getBoundingClientRect(){const r=this.canvas.nativeCanvas,e=this.getWH();return r.parentElement?this.canvas.nativeCanvas.getBoundingClientRect():{x:0,y:0,width:e.width,height:e.height,left:0,top:0,right:0,bottom:0}}clearViewBox(r){const e=this.viewBox,i=this.getContext(),n=this.getDpr();i.nativeContext.save(),i.nativeContext.setTransform(n,0,0,n,0,0),i.clearRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1),r&&(i.fillStyle=r,i.fillRect(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1)),i.nativeContext.restore()}isVisible(r){return this._canvasIsIntersecting}onVisibleChange(r){this._onVisibleChangeCb=r}getTopLeft(r){return this.global.getElementTopLeft(this.canvas.nativeCanvas,r)}};BrowserWindowHandlerContribution.env="browser",BrowserWindowHandlerContribution.idprefix="visactor_window",BrowserWindowHandlerContribution.prefix_count=0,BrowserWindowHandlerContribution=BrowserWindowHandlerContribution_1=__decorate$y([injectable(),__metadata$r("design:paramtypes",[])],BrowserWindowHandlerContribution);const browserWindowModule=new ContainerModule(r=>{r(BrowserWindowHandlerContribution).toSelf(),r(WindowHandlerContribution).toDynamicValue(e=>e.container.get(BrowserWindowHandlerContribution)).whenTargetNamed(BrowserWindowHandlerContribution.env)});var __decorate$x=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$q=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__awaiter$3=function(r,e,i,n){return new(i||(i=Promise))(function(o,l){function d(g){try{f(n.next(g))}catch(_){l(_)}}function u(g){try{f(n.throw(g))}catch(_){l(_)}}function f(g){var _;g.done?o(g.value):(_=g.value,_ instanceof i?_:new i(function(y){y(_)})).then(d,u)}f((n=n.apply(r,e||[])).next())})};class DynamicB{get x1(){return this.dom.getBoundingClientRect().left}get x2(){return this.dom.getBoundingClientRect().right}get y1(){return this.dom.getBoundingClientRect().top}get y2(){return this.dom.getBoundingClientRect().bottom}get width(){return this.dom.getBoundingClientRect().width}get height(){return this.dom.getBoundingClientRect().height}constructor(e){this.dom=e}}function createImageElement(r,e=!1){const i=document.createElement("img");if(application.global.isImageAnonymous&&(i.crossOrigin="anonymous"),e){const n=new Blob([r],{type:"image/svg+xml"});r=window.URL.createObjectURL(n)}return i.src=r,i.complete?Promise.resolve(i):new Promise((n,o)=>{i.onload=()=>{n(i)},i.onerror=()=>{o(new Error(""))}})}let BrowserEnvContribution=class extends BaseEnvContribution{constructor(){super(),this.type="browser",this.supportEvent=!0;try{this.supportsTouchEvents="ontouchstart"in globalThis,this.supportsPointerEvents=!!globalThis.PointerEvent,this.supportsMouseEvents=!!globalThis.MouseEvent}catch{this.supportsTouchEvents=!1,this.supportsPointerEvents=!1,this.supportsPointerEvents=!1}this.applyStyles=!0}mapToCanvasPoint(r,e){var i,n;let o=0,l=0,d=0,u=0;if(r.changedTouches){const f=(i=r.changedTouches[0])!==null&&i!==void 0?i:{};o=f.clientX||0,l=f.clientY||0,d=o,u=l}else o=r.clientX||0,l=r.clientY||0,d=r.offsetX||0,u=r.offsetY||0;if(e){const f=o,g=l,_=e.getBoundingClientRect(),y=(n=e.getNativeHandler)===null||n===void 0?void 0:n.call(e).nativeCanvas;let b,S;return y&&(b=_.width/y.offsetWidth,S=_.height/y.offsetHeight),{x:(f-_.left)/(isValidNumber(b)?b:1),y:(g-_.top)/(isValidNumber(S)?S:1)}}return{x:d,y:u}}getNativeAABBBounds(r){let e=r;if(typeof r=="string"&&(e=new DOMParser().parseFromString(r,"text/html").firstChild,e.lastChild&&(e=e.lastChild.firstChild)),e.getBoundingClientRect){const i=e.getBoundingClientRect();return new DynamicB(i)}return new AABBBounds}removeDom(r){return r.parentElement.removeChild(r),!0}updateDom(r,e){const{width:i,height:n,style:o}=e;return o&&(isString(o)?r.setAttribute("style",o):Object.keys(o).forEach(l=>{r.style[l]=o[l]})),i!=null&&(r.style.width=`${i}px`),n!=null&&(r.style.height=`${n}px`),!0}createDom(r){const{tagName:e="div",parent:i}=r,n=document.createElement(e);if(this.updateDom(n,r),i){const o=isString(i)?this.getElementById(i):i;o&&o.appendChild&&o.appendChild(n)}return n}loadImage(r){return createImageElement(r,!1).then(e=>({data:e,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadSvg(r){return createImageElement(r,!0).then(e=>({data:e,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}createCanvas(r){var e,i;const n=document.createElement("canvas");r.id&&(n.id=(e=r.id)!==null&&e!==void 0?e:Generator.GenAutoIncrementId().toString());const o=(i=r.dpr)!==null&&i!==void 0?i:window.devicePixelRatio;return r.width&&r.height&&(n.style.width=`${r.width}px`,n.style.height=`${r.height}px`,n.width=r.width*o,n.height=r.height*o),n}createOffscreenCanvas(r){var e;const i=(e=r.dpr)!==null&&e!==void 0?e:window.devicePixelRatio;return new OffscreenCanvas(r.width*i,r.height*i)}releaseCanvas(r){let e;e=typeof r=="string"?document.getElementById(r):r,e&&e.parentElement&&e.parentElement.removeChild(e)}getDevicePixelRatio(){return window.devicePixelRatio}getRequestAnimationFrame(){return window.requestAnimationFrame}getCancelAnimationFrame(){return window.cancelAnimationFrame}addEventListener(r,e,i){return document.addEventListener(r,e,i)}removeEventListener(r,e,i){return document.removeEventListener(r,e,i)}dispatchEvent(r){return document.dispatchEvent(r)}getElementById(r){return document.getElementById(r)}getRootElement(){return document.body}getDocument(){return document}release(...r){}getElementTop(r,e){let i=r.offsetTop,n=r.offsetParent;for(;n!==null;)i+=n.offsetTop,n=n.offsetParent;return i}getElementLeft(r,e){let i=r.offsetLeft,n=r.offsetParent;for(;n!==null;)i+=n.offsetLeft,n=n.offsetParent;return i}getElementTopLeft(r,e){let i=r.offsetTop,n=r.offsetLeft,o=r.offsetParent;for(;o!==null;)i+=o.offsetTop,n+=o.offsetLeft,o=o.offsetParent;return{top:i,left:n}}loadFont(r,e,i){return __awaiter$3(this,void 0,void 0,function*(){return new FontFace(r,isString(e)?`url(${e})`:e,i).load().then(function(n){return document.fonts.add(n),{loadState:"success"}}).catch(function(n){return console.error("Failed to load font:",n),{loadState:"fail"}})})}};BrowserEnvContribution=__decorate$x([injectable(),__metadata$q("design:paramtypes",[])],BrowserEnvContribution);const browserEnvModule=new ContainerModule(r=>{browserEnvModule.isBrowserBound||(browserEnvModule.isBrowserBound=!0,r(BrowserEnvContribution).toSelf().inSingletonScope(),r(EnvContribution).toService(BrowserEnvContribution))});browserEnvModule.isBrowserBound=!1;function loadBrowserEnv(r,e=!0){loadBrowserEnv.__loaded||(loadBrowserEnv.__loaded=!0,r.load(browserEnvModule),r.load(browserCanvasModule),r.load(browserWindowModule),e&&loadCanvasPicker(r))}loadBrowserEnv.__loaded=!1;class PickerBase{contains(e,i,n){if(!e.AABBBounds.containsPoint(i))return!1;if(e.attribute.pickMode==="imprecise")return!0;const{pickContext:o}=n??{};if(!o)return!1;const l=e.getGraphicTheme();o.highPerformanceSave();let{x:d=l.x,y:u=l.y}=e.attribute;if(e.transMatrix.onlyTranslate()){const g=e.getOffsetXY(l);d+=g.x,u+=g.y,o.setTransformForCurrent()}else d=0,u=0,o.transformFromMatrix(e.transMatrix,!0);let f=!1;return this.canvasRenderer.drawShape(e,o,d,u,{},null,(g,_,y)=>!!f||(f=g.isPointInPath(i.x,i.y),f),(g,_,y)=>{if(f)return!0;const b=_.lineWidth||y.lineWidth,S=_.pickStrokeBuffer||y.pickStrokeBuffer,v=_.keepStrokeScale||y.keepStrokeScale;return o.lineWidth=v?b+S:getScaledStroke(o,b+S,o.dpr),f=g.isPointInStroke(i.x,i.y),f}),o.highPerformanceRestore(),f}}var __decorate$w=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$p=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$n=function(r,e){return function(i,n){e(i,n,r)}};let DefaultMathArcPicker=class extends PickerBase{constructor(r){super(),this.canvasRenderer=r,this.type="arc",this.numberType=ARC_NUMBER_TYPE}};DefaultMathArcPicker=__decorate$w([injectable(),__param$n(0,inject(ArcRender)),__metadata$p("design:paramtypes",[Object])],DefaultMathArcPicker);let loadArcPick$1=!1;const arcMathPickModule=new ContainerModule((r,e,i,n)=>{loadArcPick$1||(loadArcPick$1=!0,r(MathArcPicker).to(DefaultMathArcPicker).inSingletonScope(),r(MathPickerContribution).toService(MathArcPicker))});var __decorate$v=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$o=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$m=function(r,e){return function(i,n){e(i,n,r)}};let DefaultMathAreaPicker=class extends PickerBase{constructor(r){super(),this.canvasRenderer=r,this.type="area",this.numberType=AREA_NUMBER_TYPE}};DefaultMathAreaPicker=__decorate$v([injectable(),__param$m(0,inject(AreaRender)),__metadata$o("design:paramtypes",[Object])],DefaultMathAreaPicker);let loadAreaPick$1=!1;const areaMathPickModule=new ContainerModule((r,e,i,n)=>{loadAreaPick$1||(loadAreaPick$1=!0,r(MathAreaPicker).to(DefaultMathAreaPicker).inSingletonScope(),r(MathPickerContribution).toService(MathAreaPicker))});var __decorate$u=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$n=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$l=function(r,e){return function(i,n){e(i,n,r)}};let DefaultMathCirclePicker=class extends PickerBase{constructor(r){super(),this.canvasRenderer=r,this.type="circle",this.numberType=CIRCLE_NUMBER_TYPE}};DefaultMathCirclePicker=__decorate$u([injectable(),__param$l(0,inject(CircleRender)),__metadata$n("design:paramtypes",[Object])],DefaultMathCirclePicker);let loadCirclePick$1=!1;const circleMathPickModule=new ContainerModule((r,e,i,n)=>{loadCirclePick$1||(loadCirclePick$1=!0,r(MathCirclePicker).to(DefaultMathCirclePicker).inSingletonScope(),r(MathPickerContribution).toService(MathCirclePicker))});class GlyphPickerBase{constructor(){this.type="glyph",this.numberType=GLYPH_NUMBER_TYPE}contains(e,i,n){if(!e.AABBBounds.containsPoint(i))return!1;if(e.attribute.pickMode==="imprecise")return!0;const{pickContext:o}=n??{};if(!o)return!1;const l=n==null?void 0:n.pickerService;if(l){let d=!1;return e.getSubGraphic().forEach(u=>{if(d)return;const f=l.pickItem(u,i,null,n);d=!(!f||!f.graphic)}),d}return!1}}var __decorate$t=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$m=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$k=function(r,e){return function(i,n){e(i,n,r)}};let DefaultMathGlyphPicker=class extends GlyphPickerBase{constructor(r){super(),this.canvasRenderer=r}};DefaultMathGlyphPicker=__decorate$t([injectable(),__param$k(0,inject(GlyphRender)),__metadata$m("design:paramtypes",[Object])],DefaultMathGlyphPicker);let loadGlyphPick$1=!1;const glyphMathPickModule=new ContainerModule((r,e,i,n)=>{loadGlyphPick$1||(loadGlyphPick$1=!0,r(MathGlyphPicker).to(DefaultMathGlyphPicker).inSingletonScope(),r(DefaultMathGlyphPicker).toService(MathGlyphPicker))});var __decorate$s=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d};let DefaultMathImagePicker=class{constructor(){this.type="image",this.numberType=IMAGE_NUMBER_TYPE}contains(r,e,i){const{pickContext:n}=i??{};return!!n&&!!r.AABBBounds.containsPoint(e)}};DefaultMathImagePicker=__decorate$s([injectable()],DefaultMathImagePicker);let loadImagePick$1=!1;const imageMathPickModule=new ContainerModule((r,e,i,n)=>{loadImagePick$1||(loadImagePick$1=!0,r(MathImagePicker).to(DefaultMathImagePicker).inSingletonScope(),r(DefaultMathImagePicker).toService(MathImagePicker))});var __decorate$r=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$l=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$j=function(r,e){return function(i,n){e(i,n,r)}};let DefaultMathLinePicker=class extends PickerBase{constructor(r){super(),this.canvasRenderer=r,this.type="line",this.numberType=LINE_NUMBER_TYPE}};DefaultMathLinePicker=__decorate$r([injectable(),__param$j(0,inject(LineRender)),__metadata$l("design:paramtypes",[Object])],DefaultMathLinePicker);let loadLinePick$1=!1;const lineMathPickModule=new ContainerModule((r,e,i,n)=>{loadLinePick$1||(loadLinePick$1=!0,r(MathLinePicker).to(DefaultMathLinePicker).inSingletonScope(),r(MathPickerContribution).toService(MathLinePicker))});var __decorate$q=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$k=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$i=function(r,e){return function(i,n){e(i,n,r)}};let DefaultMathPolygonPicker=class extends PickerBase{constructor(r){super(),this.canvasRenderer=r,this.type="polygon",this.numberType=POLYGON_NUMBER_TYPE}};DefaultMathPolygonPicker=__decorate$q([injectable(),__param$i(0,inject(PolygonRender)),__metadata$k("design:paramtypes",[Object])],DefaultMathPolygonPicker);let loadPolygonPick$1=!1;const polygonMathPickModule=new ContainerModule((r,e,i,n)=>{loadPolygonPick$1||(loadPolygonPick$1=!0,r(MathPolygonPicker).to(DefaultMathPolygonPicker).inSingletonScope(),r(MathPickerContribution).toService(MathPolygonPicker))});var __decorate$p=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$j=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$h=function(r,e){return function(i,n){e(i,n,r)}};let DefaultMathPathPicker=class extends PickerBase{constructor(r){super(),this.canvasRenderer=r,this.type="path",this.numberType=PATH_NUMBER_TYPE}};DefaultMathPathPicker=__decorate$p([injectable(),__param$h(0,inject(PathRender)),__metadata$j("design:paramtypes",[Object])],DefaultMathPathPicker);let loadPathPick$1=!1;const pathMathPickModule=new ContainerModule((r,e,i,n)=>{loadPathPick$1||(loadPathPick$1=!0,r(MathPathPicker).to(DefaultMathPathPicker).inSingletonScope(),r(MathPickerContribution).toService(MathPathPicker))}),_bounds=new AABBBounds;class RectPickerBase{constructor(){this.type="rect",this.numberType=RECT_NUMBER_TYPE}contains(e,i,n){if(!e.AABBBounds.containsPoint(i))return!1;if(e.attribute.pickMode==="imprecise")return!0;const{pickContext:o}=n??{};if(!o)return!1;const l=e.getGraphicTheme(),{cornerRadius:d=l.cornerRadius}=e.attribute;let{x:u=l.x,y:f=l.y}=e.attribute;o.highPerformanceSave();let g=!0;if(e.transMatrix.onlyTranslate()){const y=e.getOffsetXY(l);u+=y.x,f+=y.y,o.setTransformForCurrent()}else u=0,f=0,g=!1,o.transformFromMatrix(e.transMatrix,!0);let _=!0;if(!g||e.shadowRoot||isNumber(d,!0)&&d!==0||isArray(d)&&d.some(y=>y!==0))_=!1,this.canvasRenderer.drawShape(e,o,u,f,{},null,(y,b,S)=>!!_||(_=y.isPointInPath(i.x,i.y),_),(y,b,S)=>{if(_)return!0;const v=b.lineWidth||S.lineWidth,A=b.pickStrokeBuffer||S.pickStrokeBuffer,x=b.keepStrokeScale||S.keepStrokeScale;return o.lineWidth=x?v+A:getScaledStroke(o,v+A,o.dpr),_=y.isPointInStroke(i.x,i.y),_});else{const{fill:y=l.fill,stroke:b=l.stroke,lineWidth:S=l.lineWidth}=e.attribute;if(y)_=!0;else if(b){const v=e.AABBBounds;_bounds.setValue(v.x1,v.y1,v.x2,v.y2),_bounds.expand(-S/2),_=!_bounds.containsPoint(i)}}return o.highPerformanceRestore(),_}}var __decorate$o=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$i=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$g=function(r,e){return function(i,n){e(i,n,r)}};let DefaultMathRectPicker=class extends RectPickerBase{constructor(r){super(),this.canvasRenderer=r}};DefaultMathRectPicker=__decorate$o([injectable(),__param$g(0,inject(RectRender)),__metadata$i("design:paramtypes",[Object])],DefaultMathRectPicker);let loadRectPick$1=!1;const rectMathPickModule=new ContainerModule((r,e,i,n)=>{loadRectPick$1||(loadRectPick$1=!0,r(MathRectPicker).to(DefaultMathRectPicker).inSingletonScope(),r(MathPickerContribution).toService(MathRectPicker))});let loadRichTextPick=!1;const richTextMathPickModule=new ContainerModule((r,e,i,n)=>{loadRichTextPick||(loadRichTextPick=!0,r(MathImagePicker).to(DefaultMathImagePicker).inSingletonScope(),r(DefaultMathImagePicker).toService(MathImagePicker))});var __decorate$n=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$h=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$f=function(r,e){return function(i,n){e(i,n,r)}};let DefaultMathSymbolPicker=class extends PickerBase{constructor(r){super(),this.canvasRenderer=r,this.type="symbol",this.numberType=SYMBOL_NUMBER_TYPE}};DefaultMathSymbolPicker=__decorate$n([injectable(),__param$f(0,inject(SymbolRender)),__metadata$h("design:paramtypes",[Object])],DefaultMathSymbolPicker);let loadSymbolPick$1=!1;const symbolMathPickModule=new ContainerModule((r,e,i,n)=>{loadSymbolPick$1||(loadSymbolPick$1=!0,r(MathSymbolPicker).to(DefaultMathSymbolPicker).inSingletonScope(),r(MathPickerContribution).toService(MathSymbolPicker))});var __decorate$m=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d};let DefaultMathTextPicker=class{constructor(){this.type="text",this.numberType=TEXT_NUMBER_TYPE}contains(r,e,i){return!!r.AABBBounds.containsPoint(e)}};DefaultMathTextPicker=__decorate$m([injectable()],DefaultMathTextPicker);let loadTextPick$1=!1;const textMathPickModule=new ContainerModule((r,e,i,n)=>{loadTextPick$1||(loadTextPick$1=!0,r(MathTextPicker).to(DefaultMathTextPicker).inSingletonScope(),r(MathPickerContribution).toService(MathTextPicker))});var __decorate$l=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$g=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)};let NodeContext2d=class extends BrowserContext2d{constructor(r,e){super(r,e);const i=r.nativeCanvas.getContext("2d");if(!i)throw new Error("2d");this.nativeContext=i,this.canvas=r,this.matrix=new Matrix(1,0,0,1,0,0),this.stack=[],this.dpr=e??1}release(...r){}};NodeContext2d.env="node",NodeContext2d=__decorate$l([injectable(),__metadata$g("design:paramtypes",[Object,Number])],NodeContext2d);var __decorate$k=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$f=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)};let NodeCanvas=class extends BaseCanvas{constructor(r){super(r)}init(){this._context=new NodeContext2d(this,this._dpr),this.nativeCanvas.width=this._pixelWidth,this.nativeCanvas.height=this._pixelHeight}release(...r){this._nativeCanvas.release&&isFunction(this._nativeCanvas.release)&&this._nativeCanvas.release()}};NodeCanvas.env="node",NodeCanvas=__decorate$k([injectable(),__metadata$f("design:paramtypes",[Object])],NodeCanvas);const nodeCanvasModule=createModule(NodeCanvas,NodeContext2d);var __decorate$j=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$e=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$e=function(r,e){return function(i,n){e(i,n,r)}};let NodeWindowHandlerContribution=class extends BaseWindowHandlerContribution{get container(){return null}constructor(r){super(),this.global=r,this.type="node"}getTitle(){return""}getWH(){return{width:this.canvas.displayWidth,height:this.canvas.displayHeight}}getXY(){return{x:0,y:0}}createWindow(r){r.canvas?this.createWindowByCanvas(r):this.createWindowByConfig(r)}createWindowByConfig(r){const e=this.global.createCanvas({width:r.width,height:r.height}),i={width:r.width,height:r.height,dpr:r.dpr,nativeCanvas:e,id:Generator.GenAutoIncrementId().toString(),canvasControled:!0};this.canvas=new NodeCanvas(i)}createWindowByCanvas(r){const e=r.canvas;let i=r.width,n=r.height;i!=null&&n!=null&&r.canvasControled||(i=e.width,n=e.height),this.canvas=new NodeCanvas({width:i,height:n,dpr:1,nativeCanvas:e,canvasControled:r.canvasControled})}releaseWindow(){this.canvas.release()}resizeWindow(r,e){this.canvas.resize(r,e)}setDpr(r){this.canvas.dpr=r}getContext(){return this.canvas.getContext()}getNativeHandler(){return this.canvas}getDpr(){return this.canvas.dpr}getImageBuffer(r="image/png"){return this.canvas.nativeCanvas.toBuffer(r)}addEventListener(r,e,i){}dispatchEvent(r){return!0}removeEventListener(r,e,i){}getStyle(){}setStyle(r){}getBoundingClientRect(){return null}clearViewBox(r){}};NodeWindowHandlerContribution.env="node",NodeWindowHandlerContribution=__decorate$j([injectable(),__param$e(0,inject(VGlobal)),__metadata$e("design:paramtypes",[Object])],NodeWindowHandlerContribution);const nodeWindowModule=new ContainerModule(r=>{r(NodeWindowHandlerContribution).toSelf(),r(WindowHandlerContribution).toDynamicValue(e=>e.container.get(NodeWindowHandlerContribution)).whenTargetNamed(NodeWindowHandlerContribution.env)});var __decorate$i=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d};let NodeEnvContribution=class extends BaseEnvContribution{constructor(){super(...arguments),this.type="node",this._lastTime=0,this.supportEvent=!1}configure(r,e){r.env===this.type&&(r.setActiveEnvContribution(this),this.pkg=e)}getDynamicCanvasCount(){return 0}getStaticCanvasCount(){return 999}loadJson(r){const e=fetch(r).then(i=>i.json());return e.then(i=>({data:i,state:"success"})).catch(()=>({data:null,state:"fail"})),e}loadArrayBuffer(r){return fetch(r).then(e=>e.arrayBuffer()).then(e=>({data:e,loadState:"success"})).catch(()=>({data:null,loadState:"fail"}))}loadImage(r){const{loadImage:e}=this.pkg;return e?e(r).then(i=>({loadState:i?"success":"fail",data:i})).catch(()=>({loadState:"fail",data:null})):Promise.reject(new Error("node-canvas loadImage could not be found!"))}loadSvg(r){const e=this.pkg.Resvg;if(!e)return Promise.reject(new Error("@resvg/resvg-js svgParser could not be found!"));const i=new e(r).render().asPng();return this.loadImage(i)}createCanvas(r){return this.pkg.createCanvas(r.width,r.height)}releaseCanvas(r){}getDevicePixelRatio(){return 1}getRequestAnimationFrame(){return function(r){return rafBasedSto.call(r)}}getCancelAnimationFrame(){return r=>{rafBasedSto.clear(r)}}addEventListener(r,e,i){}removeEventListener(r,e,i){}getElementById(r){return null}getRootElement(){return null}dispatchEvent(r){}release(...r){}createOffscreenCanvas(r){}};NodeEnvContribution=__decorate$i([injectable()],NodeEnvContribution);const nodeEnvModule=new ContainerModule(r=>{nodeEnvModule.isNodeBound||(nodeEnvModule.isNodeBound=!0,r(NodeEnvContribution).toSelf().inSingletonScope(),r(EnvContribution).toService(NodeEnvContribution))});nodeEnvModule.isNodeBound=!1;function loadNodeEnv(r,e=!0){loadNodeEnv.__loaded||(loadNodeEnv.__loaded=!0,r.load(nodeEnvModule),r.load(nodeCanvasModule),r.load(nodeWindowModule))}loadNodeEnv.__loaded=!1;var __decorate$h=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$d=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$d=function(r,e){return function(i,n){e(i,n,r)}};let DefaultCanvasArcPicker=class extends PickerBase{constructor(r){super(),this.canvasRenderer=r,this.type="arc",this.numberType=ARC_NUMBER_TYPE}};DefaultCanvasArcPicker=__decorate$h([injectable(),__param$d(0,inject(ArcRender)),__metadata$d("design:paramtypes",[Object])],DefaultCanvasArcPicker);let loadArcPick=!1;const arcCanvasPickModule=new ContainerModule((r,e,i,n)=>{loadArcPick||(loadArcPick=!0,r(CanvasArcPicker).to(DefaultCanvasArcPicker).inSingletonScope(),r(CanvasPickerContribution).toService(CanvasArcPicker))});var __decorate$g=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$c=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$c=function(r,e){return function(i,n){e(i,n,r)}};let DefaultCanvasRectPicker=class extends RectPickerBase{constructor(r){super(),this.canvasRenderer=r}};DefaultCanvasRectPicker=__decorate$g([injectable(),__param$c(0,inject(RectRender)),__metadata$c("design:paramtypes",[Object])],DefaultCanvasRectPicker);let loadRectPick=!1;const rectCanvasPickModule=new ContainerModule((r,e,i,n)=>{loadRectPick||(loadRectPick=!0,r(CanvasRectPicker).to(DefaultCanvasRectPicker).inSingletonScope(),r(CanvasPickerContribution).toService(CanvasRectPicker))});class BaseLinePicker extends BaseRender{contains(e,i,n){if(!e.AABBBounds.containsPoint(i))return!1;if(e.attribute.pickMode==="imprecise")return!0;const{pickContext:o}=n??{};if(!o)return!1;o.highPerformanceSave();const l=e.getGraphicTheme(),d=this.transform(e,l,o),{x:u,y:f,z:g,lastModelMatrix:_}=d;let y=i;if(o.camera){y=i.clone();const S=e.parent.globalTransMatrix;y.x=S.a*i.x+S.c*i.y+S.e,y.y=S.b*i.x+S.d*i.y+S.f}this.canvasRenderer.z=g;let b=!1;return this.canvasRenderer.drawShape(e,o,u,f,{},null,S=>!!b||(b=S.isPointInPath(y.x,y.y),b),(S,v,A)=>{if(b)return!0;const x=v.lineWidth||A.lineWidth,T=v.pickStrokeBuffer||A.pickStrokeBuffer,C=v.keepStrokeScale||A.keepStrokeScale;return o.lineWidth=C?x+T:getScaledStroke(o,x+T,o.dpr),b=S.isPointInStroke(y.x,y.y),b}),this.canvasRenderer.z=0,o.modelMatrix!==_&&mat4Allocate.free(o.modelMatrix),o.modelMatrix=_,o.highPerformanceRestore(),b}}var __decorate$f=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$b=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$b=function(r,e){return function(i,n){e(i,n,r)}};let DefaultCanvasLinePicker=class extends BaseLinePicker{constructor(r){super(),this.canvasRenderer=r,this.type="line",this.numberType=LINE_NUMBER_TYPE}};DefaultCanvasLinePicker=__decorate$f([injectable(),__param$b(0,inject(LineRender)),__metadata$b("design:paramtypes",[Object])],DefaultCanvasLinePicker);let loadLinePick=!1;const lineCanvasPickModule=new ContainerModule((r,e,i,n)=>{loadLinePick||(loadLinePick=!0,r(CanvasLinePicker).to(DefaultCanvasLinePicker).inSingletonScope(),r(CanvasPickerContribution).toService(CanvasLinePicker))});var __decorate$e=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$a=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$a=function(r,e){return function(i,n){e(i,n,r)}};let DefaultCanvasAreaPicker=class extends PickerBase{constructor(r){super(),this.canvasRenderer=r,this.type="area",this.numberType=AREA_NUMBER_TYPE}};DefaultCanvasAreaPicker=__decorate$e([injectable(),__param$a(0,inject(AreaRender)),__metadata$a("design:paramtypes",[Object])],DefaultCanvasAreaPicker);let loadAreaPick=!1;const areaCanvasPickModule=new ContainerModule((r,e,i,n)=>{loadAreaPick||(loadAreaPick=!0,r(CanvasAreaPicker).to(DefaultCanvasAreaPicker).inSingletonScope(),r(CanvasPickerContribution).toService(CanvasAreaPicker))});class Base3dPicker extends BaseRender{contains(e,i,n){const{pickContext:o}=n??{};if(!o)return!1;const l=e.getGraphicTheme();o.highPerformanceSave();const d=this.transform(e,l,o),{x:u,y:f,z:g,lastModelMatrix:_}=d;let y=i;if(o.camera){y=i.clone();const S=e.parent.globalTransMatrix;y.x=S.a*i.x+S.c*i.y+S.e,y.y=S.b*i.x+S.d*i.y+S.f}this.canvasRenderer.z=g;let b=!1;return this.canvasRenderer.drawShape(e,o,u,f,n,null,(S,v,A)=>!!b||(b=S.isPointInPath(y.x,y.y),b)),this.canvasRenderer.z=0,o.modelMatrix!==_&&mat4Allocate.free(o.modelMatrix),o.modelMatrix=_,o.highPerformanceRestore(),b}}var __decorate$d=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$9=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$9=function(r,e){return function(i,n){e(i,n,r)}};let DefaultCanvasSymbolPicker=class extends Base3dPicker{constructor(r){super(),this.canvasRenderer=r,this.type="symbol",this.numberType=SYMBOL_NUMBER_TYPE}contains(r,e,i){const{pickContext:n}=i??{};if(!n)return!1;const o=r.getParsedPath();if(!n.camera){if(!r.AABBBounds.containsPoint(e))return!1;if(o.isSvg||r.attribute.pickMode==="imprecise")return!0}n.highPerformanceSave();const l=r.getGraphicTheme(),d=this.transform(r,l,n),{x:u,y:f,z:g,lastModelMatrix:_}=d;let y=e;if(n.camera){y=e.clone();const S=r.parent.globalTransMatrix;y.x=S.a*e.x+S.c*e.y+S.e,y.y=S.b*e.x+S.d*e.y+S.f}this.canvasRenderer.z=g;let b=!1;return this.canvasRenderer.drawShape(r,n,u,f,{},null,(S,v,A)=>!!b||(b=S.isPointInPath(y.x,y.y),b),(S,v,A)=>{if(b)return!0;const x=v.lineWidth||A.lineWidth,T=v.pickStrokeBuffer||A.pickStrokeBuffer,C=v.keepStrokeScale||A.keepStrokeScale;return n.lineWidth=C?x+T:getScaledStroke(n,x+T,n.dpr),b=S.isPointInStroke(y.x,y.y),b}),this.canvasRenderer.z=0,n.modelMatrix!==_&&mat4Allocate.free(n.modelMatrix),n.modelMatrix=_,n.highPerformanceRestore(),b}};DefaultCanvasSymbolPicker=__decorate$d([injectable(),__param$9(0,inject(SymbolRender)),__metadata$9("design:paramtypes",[Object])],DefaultCanvasSymbolPicker);let loadSymbolPick=!1;const symbolCanvasPickModule=new ContainerModule((r,e,i,n)=>{loadSymbolPick||(loadSymbolPick=!0,r(CanvasSymbolPicker).to(DefaultCanvasSymbolPicker).inSingletonScope(),r(CanvasPickerContribution).toService(CanvasSymbolPicker))});var __decorate$c=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$8=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$8=function(r,e){return function(i,n){e(i,n,r)}};let DefaultCanvasCirclePicker=class extends PickerBase{constructor(r){super(),this.canvasRenderer=r,this.type="circle",this.numberType=CIRCLE_NUMBER_TYPE}};DefaultCanvasCirclePicker=__decorate$c([injectable(),__param$8(0,inject(CircleRender)),__metadata$8("design:paramtypes",[Object])],DefaultCanvasCirclePicker);let loadCirclePick=!1;const circleCanvasPickModule=new ContainerModule((r,e,i,n)=>{loadCirclePick||(loadCirclePick=!0,r(CanvasCirclePicker).to(DefaultCanvasCirclePicker).inSingletonScope(),r(CanvasPickerContribution).toService(CanvasCirclePicker))});var __decorate$b=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$7=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$7=function(r,e){return function(i,n){e(i,n,r)}};let DefaultCanvasTextPicker=class extends Base3dPicker{constructor(r){super(),this.canvasRenderer=r,this.type="text",this.numberType=TEXT_NUMBER_TYPE}contains(r,e,i){const{pickContext:n}=i??{};if(!n)return!1;const o=r.AABBBounds;if(!n.camera)return!!o.containsPoint(e);n.highPerformanceSave();const l=r.getGraphicTheme(),{keepDirIn3d:d=l.keepDirIn3d}=r.attribute,u=!d,f=this.transform(r,l,n,u),{x:g,y:_,z:y,lastModelMatrix:b}=f;this.canvasRenderer.z=y;let S=e;if(n.camera){S=e.clone();const A=r.parent.globalTransMatrix;S.x=A.a*e.x+A.c*e.y+A.e,S.y=A.b*e.x+A.d*e.y+A.f}let v=!1;return this.canvasRenderer.drawShape(r,n,g,_,{},null,(A,x,T)=>{if(v)return!0;const{fontSize:C=l.fontSize,textBaseline:E=l.textBaseline,textAlign:P=l.textAlign}=r.attribute,R=r.AABBBounds,L=R.height(),w=R.width(),B=textLayoutOffsetY(E,L,C),I=textDrawOffsetX(P,w);return A.rect(I+g,B+_,w,L,y),v=A.isPointInPath(S.x,S.y),v},(A,x,T)=>v),this.canvasRenderer.z=0,n.modelMatrix!==b&&mat4Allocate.free(n.modelMatrix),n.modelMatrix=b,n.highPerformanceRestore(),v}};DefaultCanvasTextPicker=__decorate$b([injectable(),__param$7(0,inject(TextRender)),__metadata$7("design:paramtypes",[Object])],DefaultCanvasTextPicker);let loadTextPick=!1;const textCanvasPickModule=new ContainerModule((r,e,i,n)=>{loadTextPick||(loadTextPick=!0,r(CanvasTextPicker).to(DefaultCanvasTextPicker).inSingletonScope(),r(CanvasPickerContribution).toService(CanvasTextPicker))});var __decorate$a=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$6=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$6=function(r,e){return function(i,n){e(i,n,r)}};let DefaultCanvasPathPicker=class extends BaseLinePicker{constructor(r){super(),this.canvasRenderer=r,this.type="path",this.numberType=PATH_NUMBER_TYPE}};DefaultCanvasPathPicker=__decorate$a([injectable(),__param$6(0,inject(PathRender)),__metadata$6("design:paramtypes",[Object])],DefaultCanvasPathPicker);let loadPathPick=!1;const pathCanvasPickModule=new ContainerModule((r,e,i,n)=>{loadPathPick||(loadPathPick=!0,r(CanvasPathPicker).to(DefaultCanvasPathPicker).inSingletonScope(),r(CanvasPickerContribution).toService(CanvasPathPicker))});var __decorate$9=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$5=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$5=function(r,e){return function(i,n){e(i,n,r)}};let DefaultCanvasPolygonPicker=class extends PickerBase{constructor(r){super(),this.canvasRenderer=r,this.type="polygon",this.numberType=POLYGON_NUMBER_TYPE}};DefaultCanvasPolygonPicker=__decorate$9([injectable(),__param$5(0,inject(PolygonRender)),__metadata$5("design:paramtypes",[Object])],DefaultCanvasPolygonPicker);let loadPolygonPick=!1;const polygonCanvasPickModule=new ContainerModule((r,e,i,n)=>{loadPolygonPick||(loadPolygonPick=!0,r(CanvasPolygonPicker).to(DefaultCanvasPolygonPicker).inSingletonScope(),r(CanvasPickerContribution).toService(CanvasPolygonPicker))});var __decorate$8=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$4=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$4=function(r,e){return function(i,n){e(i,n,r)}};let DefaultCanvasGlyphPicker=class extends GlyphPickerBase{constructor(r){super(),this.canvasRenderer=r}};DefaultCanvasGlyphPicker=__decorate$8([injectable(),__param$4(0,inject(GlyphRender)),__metadata$4("design:paramtypes",[Object])],DefaultCanvasGlyphPicker);let loadGlyphPick=!1;const glyphCanvasPickModule=new ContainerModule((r,e,i,n)=>{loadGlyphPick||(loadGlyphPick=!0,r(CanvasGlyphPicker).to(DefaultCanvasGlyphPicker).inSingletonScope(),r(CanvasPickerContribution).toService(CanvasGlyphPicker))});var __decorate$7=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$3=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$3=function(r,e){return function(i,n){e(i,n,r)}};let DefaultCanvasRichTextPicker=class{constructor(r){this.canvasRenderer=r,this.type="richtext",this.numberType=RICHTEXT_NUMBER_TYPE}contains(r,e,i){return!!r.AABBBounds.containsPoint(e)}};DefaultCanvasRichTextPicker=__decorate$7([injectable(),__param$3(0,inject(RichTextRender)),__metadata$3("design:paramtypes",[Object])],DefaultCanvasRichTextPicker);let loadRichtextPick=!1;const richtextCanvasPickModule=new ContainerModule((r,e,i,n)=>{loadRichtextPick||(loadRichtextPick=!0,r(CanvasRichTextPicker).to(DefaultCanvasRichTextPicker).inSingletonScope(),r(CanvasPickerContribution).toService(CanvasRichTextPicker))});var __decorate$6=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d};let DefaultCanvasImagePicker=class{constructor(){this.type="image",this.numberType=IMAGE_NUMBER_TYPE}contains(r,e,i){const{pickContext:n}=i??{};return!!n&&!!r.AABBBounds.containsPoint(e)}};DefaultCanvasImagePicker=__decorate$6([injectable()],DefaultCanvasImagePicker);let loadImagePick=!1;const imageCanvasPickModule=new ContainerModule((r,e,i,n)=>{loadImagePick||(loadImagePick=!0,r(CanvasImagePicker).to(DefaultCanvasImagePicker).inSingletonScope(),r(CanvasPickerContribution).toService(CanvasImagePicker))});var __decorate$5=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$2=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$2=function(r,e){return function(i,n){e(i,n,r)}};let DefaultCanvasRect3dPicker=class extends Base3dPicker{constructor(r){super(),this.canvasRenderer=r,this.type="rect3d",this.numberType=RECT3D_NUMBER_TYPE,this.themeType="rect"}};DefaultCanvasRect3dPicker=__decorate$5([injectable(),__param$2(0,inject(Rect3DRender)),__metadata$2("design:paramtypes",[Object])],DefaultCanvasRect3dPicker);let loadRect3dPick=!1;const rect3dCanvasPickModule=new ContainerModule((r,e,i,n)=>{loadRect3dPick||(loadRect3dPick=!0,r(CanvasRect3dPicker).to(DefaultCanvasRect3dPicker).inSingletonScope(),r(CanvasPickerContribution).toService(CanvasRect3dPicker))});var __decorate$4=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata$1=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param$1=function(r,e){return function(i,n){e(i,n,r)}};let DefaultCanvasArc3dPicker=class extends Base3dPicker{constructor(r){super(),this.canvasRenderer=r,this.type="arc3d",this.numberType=ARC3D_NUMBER_TYPE,this.themeType="arc"}};DefaultCanvasArc3dPicker=__decorate$4([injectable(),__param$1(0,inject(Arc3dRender)),__metadata$1("design:paramtypes",[Object])],DefaultCanvasArc3dPicker);let loadArc3dPick=!1;const arc3dCanvasPickModule=new ContainerModule((r,e,i,n)=>{loadArc3dPick||(loadArc3dPick=!0,r(CanvasArc3dPicker).to(DefaultCanvasArc3dPicker).inSingletonScope(),r(CanvasPickerContribution).toService(CanvasArc3dPicker))});var __decorate$3=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d},__metadata=function(r,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(r,e)},__param=function(r,e){return function(i,n){e(i,n,r)}};let DefaultCanvasPyramid3dPicker=class extends Base3dPicker{constructor(r){super(),this.canvasRenderer=r,this.type="pyramid3d",this.numberType=PYRAMID3D_NUMBER_TYPE,this.themeType="polygon"}};DefaultCanvasPyramid3dPicker=__decorate$3([injectable(),__param(0,inject(Pyramid3dRender)),__metadata("design:paramtypes",[Object])],DefaultCanvasPyramid3dPicker);let loadPyramid3dPick=!1;const pyramid3dCanvasPickModule=new ContainerModule((r,e,i,n)=>{loadPyramid3dPick||(loadPyramid3dPick=!0,r(CanvasPyramid3dPicker).to(DefaultCanvasPyramid3dPicker).inSingletonScope(),r(CanvasPickerContribution).toService(CanvasPyramid3dPicker))}),browser=isBrowserEnv();function _registerArc(){_registerArc.__loaded||(_registerArc.__loaded=!0,registerArcGraphic$1(),container.load(arcModule),container.load(browser?arcCanvasPickModule:arcMathPickModule))}_registerArc.__loaded=!1;const registerArc=_registerArc;function _registerArc3d(){_registerArc3d.__loaded||(_registerArc3d.__loaded=!0,registerArc3dGraphic$1(),registerDirectionalLight(),registerOrthoCamera(),container.load(arc3dModule),container.load(arc3dCanvasPickModule))}_registerArc3d.__loaded=!1;const registerArc3d=_registerArc3d;function _registerArea(){_registerArea.__loaded||(_registerArea.__loaded=!0,registerAreaGraphic$1(),container.load(areaModule),container.load(browser?areaCanvasPickModule:areaMathPickModule))}_registerArea.__loaded=!1;const registerArea=_registerArea;function _registerCircle(){_registerCircle.__loaded||(_registerCircle.__loaded=!0,registerCircleGraphic(),container.load(circleModule),container.load(browser?circleCanvasPickModule:circleMathPickModule))}_registerCircle.__loaded=!1;const registerCircle=_registerCircle;function _registerGlyph(){_registerGlyph.__loaded||(_registerGlyph.__loaded=!0,registerGlyphGraphic$1(),container.load(glyphModule),container.load(browser?glyphCanvasPickModule:glyphMathPickModule))}_registerGlyph.__loaded=!1;const registerGlyph=_registerGlyph;function _registerGroup(){_registerGroup.__loaded||(_registerGroup.__loaded=!0,registerGroupGraphic$1())}_registerGroup.__loaded=!1;const registerGroup=_registerGroup;function _registerImage(){_registerImage.__loaded||(_registerImage.__loaded=!0,registerImageGraphic$1(),container.load(imageModule),container.load(browser?imageCanvasPickModule:imageMathPickModule))}_registerImage.__loaded=!1;const registerImage=_registerImage;function _registerLine(){_registerLine.__loaded||(_registerLine.__loaded=!0,registerLineGraphic$1(),container.load(lineModule),container.load(browser?lineCanvasPickModule:lineMathPickModule))}_registerLine.__loaded=!1;const registerLine=_registerLine;function _registerPath(){_registerPath.__loaded||(_registerPath.__loaded=!0,registerPathGraphic$1(),container.load(pathModule),container.load(browser?pathCanvasPickModule:pathMathPickModule))}_registerPath.__loaded=!1;const registerPath=_registerPath;function _registerPolygon(){_registerPolygon.__loaded||(_registerPolygon.__loaded=!0,registerPolygonGraphic$1(),container.load(polygonModule),container.load(browser?polygonCanvasPickModule:polygonMathPickModule))}_registerPolygon.__loaded=!1;const registerPolygon=_registerPolygon;function _registerPyramid3d(){_registerPyramid3d.__loaded||(_registerPyramid3d.__loaded=!0,registerPyramid3dGraphic$1(),registerDirectionalLight(),registerOrthoCamera(),container.load(pyramid3dModule),container.load(pyramid3dCanvasPickModule))}_registerPyramid3d.__loaded=!1;const registerPyramid3d=_registerPyramid3d;function _registerRect(){_registerRect.__loaded||(_registerRect.__loaded=!0,registerRectGraphic$1(),container.load(rectModule),container.load(browser?rectCanvasPickModule:rectMathPickModule))}_registerRect.__loaded=!1;const registerRect=_registerRect;function _registerRect3d(){_registerRect3d.__loaded||(_registerRect3d.__loaded=!0,registerRect3dGraphic$1(),container.load(rect3dModule),container.load(rect3dCanvasPickModule))}_registerRect3d.__loaded=!1;const registerRect3d=_registerRect3d;function _registerRichtext(){_registerRichtext.__loaded||(_registerRichtext.__loaded=!0,registerRichtextGraphic(),container.load(richtextModule),container.load(browser?richtextCanvasPickModule:richTextMathPickModule))}_registerRichtext.__loaded=!1;const registerRichtext=_registerRichtext;function _registerShadowRoot(){_registerShadowRoot.__loaded||(_registerShadowRoot.__loaded=!0,registerShadowRootGraphic())}_registerShadowRoot.__loaded=!1;const registerShadowRoot=_registerShadowRoot;function _registerSymbol(){_registerSymbol.__loaded||(_registerSymbol.__loaded=!0,registerSymbolGraphic$1(),container.load(symbolModule),container.load(browser?symbolCanvasPickModule:symbolMathPickModule))}_registerSymbol.__loaded=!1;const registerSymbol=_registerSymbol;function _registerText(){_registerText.__loaded||(_registerText.__loaded=!0,registerTextGraphic$1(),container.load(textModule),container.load(browser?textCanvasPickModule:textMathPickModule))}_registerText.__loaded=!1;const registerText=_registerText;function loadScrollbarComponent(){registerGroup(),registerRect()}const POLAR_START_ANGLE$1=-.5*Math.PI,POLAR_END_ANGLE$1=1.5*Math.PI,DEFAULT_TEXT_FONT_FAMILY="PingFang SC,Helvetica Neue,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol",DEFAULT_TEXT_FONT_SIZE=14;var StateValue;(function(r){r.selected="selected",r.selectedReverse="selected_reverse",r.hover="hover",r.hoverReverse="hover_reverse"})(StateValue||(StateValue={}));const DEFAULT_STATES$2={[StateValue.selectedReverse]:{},[StateValue.selected]:{},[StateValue.hover]:{},[StateValue.hoverReverse]:{}},DEFAULT_HTML_TEXT_SPEC={container:"",width:30,height:30,style:{}},SCROLLBAR_EVENT="scrollDrag",delayMap$3={debounce,throttle};loadScrollbarComponent();let ScrollBar$1=class Ne extends AbstractComponent{constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},Ne.defaultAttributes,e)),this.name="scrollbar",this._onRailPointerDown=n=>{const{viewX:o,viewY:l}=n,{direction:d,width:u,height:f,range:g}=this.attribute,_=this._sliderSize,[y,b]=this._getScrollRange();let S;if(d==="vertical"){const v=l-this._viewPosition.y,A=clamp(v-_/2,y,b);S=v/f,this._slider.setAttribute("y",A,!0)}else{const v=o-this._viewPosition.x,A=clamp(v-_/2,y,b);S=v/u,this._slider.setAttribute("x",A,!0)}this.setScrollRange([S-(g[1]-g[0])/2,S+(g[1]-g[0])/2],!1),this.stage&&!this.stage.autoRender&&this.stage.renderNextFrame()},this._onSliderPointerDown=n=>{const{stopSliderDownPropagation:o=!0}=this.attribute;o&&n.stopPropagation();const{direction:l}=this.attribute,{x:d,y:u}=this.stage.eventPointTransform(n);this._prePos=l==="horizontal"?d:u,this._dispatchEvent("scrollDown",{pos:this._prePos,event:n}),vglobal.env==="browser"?(vglobal.addEventListener("pointermove",this._onSliderPointerMoveWithDelay,{capture:!0}),vglobal.addEventListener("pointerup",this._onSliderPointerUp)):(this.stage.addEventListener("pointermove",this._onSliderPointerMoveWithDelay,{capture:!0}),this.stage.addEventListener("pointerup",this._onSliderPointerUp),this.stage.addEventListener("pointerupoutside",this._onSliderPointerUp))},this._computeScrollValue=n=>{const{direction:o}=this.attribute,{x:l,y:d}=this.stage.eventPointTransform(n);let u,f,g=0;const{width:_,height:y}=this.getSliderRenderBounds();return o==="vertical"?(f=d,g=f-this._prePos,u=g/y):(f=l,g=f-this._prePos,u=g/_),[f,u]},this._onSliderPointerMove=n=>{const{stopSliderMovePropagation:o=!0}=this.attribute;o&&n.stopPropagation();const l=this.getScrollRange(),[d,u]=this._computeScrollValue(n);this.setScrollRange([l[0]+u,l[1]+u],!0),this._prePos=d},this._onSliderPointerMoveWithDelay=this.attribute.delayTime===0?this._onSliderPointerMove:delayMap$3[this.attribute.delayType](this._onSliderPointerMove,this.attribute.delayTime),this._onSliderPointerUp=n=>{n.preventDefault();const{realTime:o=!0,range:l,limitRange:d=[0,1]}=this.attribute,u=this.getScrollRange(),[f,g]=this._computeScrollValue(n),_=[u[0]+g,u[1]+g];this._dispatchEvent("scrollUp",{pre:l,value:clampRange(_,d[0],d[1])}),vglobal.env==="browser"?(vglobal.removeEventListener("pointermove",this._onSliderPointerMoveWithDelay,{capture:!0}),vglobal.removeEventListener("pointerup",this._onSliderPointerUp)):(this.stage.removeEventListener("pointermove",this._onSliderPointerMoveWithDelay,{capture:!0}),this.stage.removeEventListener("pointerup",this._onSliderPointerUp),this.stage.removeEventListener("pointerupoutside",this._onSliderPointerUp))}}setScrollRange(e,i=!0){const{direction:n="horizontal",limitRange:o=[0,1],range:l,realTime:d=!0}=this.attribute,u=clampRange(e,o[0],o[1]);if(i){const f=this._getSliderPos(u);if(this._slider){const g=f[1]-f[0];this._sliderSize=g,n==="horizontal"?this._slider.setAttributes({x:f[0],width:g},!0):this._slider.setAttributes({y:f[0],height:g},!0),this.stage&&!this.stage.autoRender&&this.stage.renderNextFrame()}}this.attribute.range=u,d&&this._dispatchEvent(SCROLLBAR_EVENT,{pre:l,value:u})}getScrollRange(){return this.attribute.range}bindEvents(){if(this.attribute.disableTriggerEvent)return;const{delayType:e="throttle",delayTime:i=0}=this.attribute;this._rail&&this._rail.addEventListener("pointerdown",delayMap$3[e](this._onRailPointerDown,i)),this._slider&&this._slider.addEventListener("pointerdown",this._onSliderPointerDown)}render(){this._reset();const{direction:e="horizontal",width:i,height:n,range:o,limitRange:l=[0,1],railStyle:d,sliderStyle:u,padding:f=2}=this.attribute,g=this.createOrUpdateChild("scrollbar-container",{},"group"),_=g.createOrUpdateChild("scrollbar-rail",Object.assign({x:0,y:0,width:i,height:n},d),"rect");this._rail=_;const y=this.getSliderRenderBounds(),b=this._getSliderPos(clampRange(o,l[0],l[1])),S=b[1]-b[0];let v;this._sliderSize=S,v=e==="horizontal"?{x:b[0],y:y.y1,width:S,height:y.height}:{x:y.x1,y:b[0],width:y.width,height:S};const A=g.createOrUpdateChild("slider",Object.assign(Object.assign(Object.assign(Object.assign({},v),{cornerRadius:this._getDefaultSliderCornerRadius()}),u),{boundsPadding:normalizePadding$1(f),pickMode:"imprecise"}),"rect");this._slider=A,this._container=g;const x=this._container.AABBBounds;this._viewPosition={x:x.x1,y:x.y1}}getSliderRenderBounds(){if(this._sliderRenderBounds)return this._sliderRenderBounds;const{width:e,height:i,padding:n=2}=this.attribute,[o,l,d,u]=normalizePadding$1(n),f={x1:u,y1:o,x2:e-l,y2:i-d,width:Math.max(0,e-(u+l)),height:Math.max(0,i-(o+d))};return this._sliderRenderBounds=f,f}_getDefaultSliderCornerRadius(){const{direction:e,round:i}=this.attribute;if(i){const{width:n,height:o}=this.getSliderRenderBounds();return e==="horizontal"?o:n}return 0}_getSliderPos(e){const{direction:i}=this.attribute,{width:n,height:o,x1:l,y1:d}=this.getSliderRenderBounds();return i==="horizontal"?[n*e[0]+l,n*e[1]+l]:[o*e[0]+d,o*e[1]+d]}_getScrollRange(){if(this._sliderLimitRange)return this._sliderLimitRange;const{limitRange:e=[0,1],direction:i}=this.attribute,[n,o]=clampRange(e,0,1),{width:l,height:d,x1:u,y1:f}=this.getSliderRenderBounds(),g=this._sliderSize;return i==="horizontal"?clampRange([u+n*l,u+o*l],u,l-g):clampRange([f+n*d,f+o*d],f,d-g)}_reset(){this._sliderRenderBounds=null,this._sliderLimitRange=null}};ScrollBar$1.defaultAttributes={direction:"horizontal",round:!0,sliderSize:20,sliderStyle:{fill:"rgba(0, 0, 0, .5)"},railStyle:{fill:"rgba(0, 0, 0, .0)"},padding:2,scrollRange:[0,1],delayType:"throttle",delayTime:0,realTime:!0};var ScrollBarPlugin_1,__decorate$2=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d};let ScrollBarPlugin=ScrollBarPlugin_1=class{constructor(){this.name="scrollbar",this.activeEvent="onRegister",this._uid=Generator.GenAutoIncrementId(),this.key=this.name+this._uid,this.scroll=r=>{var e,i;const n=r.target,o=this.getScrollContainer(n);if(!o&&!this.scrollContainer)return;if(!o&&this.scrollContainer){if(!this.scrollContainer.g.stage||this.scrollContainer.g.stage!==n.stage)return;const x=this.formatScrollContainer(this.scrollContainer.g);if(!x)return void this.clearScrollbar(this.scrollContainer.g,"all");this.scrollContainer.showH&&!x.showH&&this.clearScrollbar(this.scrollContainer.g,"horizontal"),this.scrollContainer.showV&&!x.showV&&this.clearScrollbar(this.scrollContainer.g,"vertical"),this.scrollContainer=x}else o&&this.scrollContainer&&o.g!==this.scrollContainer.g&&this.clearScrollbar(this.scrollContainer.g,"all");if(this.scrollContainer=o??this.scrollContainer,!o)return;const l=o.g;if(!l)return;const{width:d,height:u,scrollX:f=0,scrollY:g=0}=l.attribute;let _=f,y=g,{showH:b,showV:S}=o;this.scrollContainerBounds=new Bounds().set(0,0,l.attribute.width,l.attribute.height),b&&b&&(abs$1(r.deltaX)>abs$1(r.deltaY)?(b=b&&!0,S=S&&!1):(b=b&&!1,S=S&&!0));const v=this.childrenBounds.width(),A=this.childrenBounds.height();b&&(_=f-((e=r.deltaX)!==null&&e!==void 0?e:0),_>0?_=0:_<d-v&&(_=d-v)),S&&(y=g-((i=r.deltaY)!==null&&i!==void 0?i:0),y>0?y=0:y<u-A&&(y=u-A)),l.setAttributes({scrollX:_,scrollY:y}),this.addOrUpdateScroll(b,S,l.parent,l)},this.handleScrollBarChange=r=>{if(!(this.scrollContainer&&this.scrollContainerBounds&&this.childrenBounds&&r&&r.target&&r.detail&&r.detail.value))return;const e=r.target,i=r.detail.value;if(e.attribute.direction==="horizontal"){const n=this.childrenBounds.width();this.scrollContainer.g.setAttributes({scrollX:-i[0]*n})}else{const n=this.childrenBounds.height();this.scrollContainer.g.setAttributes({scrollY:-i[0]*n})}}}activate(r){this.pluginService=r;const{stage:e}=this.pluginService;this.childrenBounds=new AABBBounds,e.addEventListener("wheel",this.scroll),this.params=ScrollBarPlugin_1.defaultParams}initEventOfScrollbar(r,e,i){r.addEventListener("pointerover",()=>{e.setAttribute("visibleAll",!0)}),r.addEventListener("pointermove",()=>{e.setAttribute("visibleAll",!0)}),r.addEventListener("pointerout",()=>{e.setAttribute("visibleAll",!1)}),e.addEventListener("pointerover",()=>{e.setAttribute("visibleAll",!0)}),e.addEventListener("pointerout",()=>{e.setAttribute("visibleAll",!0)}),e.addEventListener("scrollUp",this.handleScrollBarChange),e.addEventListener(SCROLLBAR_EVENT,this.handleScrollBarChange)}addOrUpdateScroll(r,e,i,n){if(r){const{scrollBar:o,isUpdate:l}=this.addOrUpdateHScroll(n,i,!0);l||this.initEventOfScrollbar(n,o,!0)}else this.clearScrollbar(n,"horizontal");if(e){const{scrollBar:o,isUpdate:l}=this.addOrUpdateHScroll(n,i,!1);l||this.initEventOfScrollbar(n,o,!1)}else this.clearScrollbar(n,"vertical")}getDirection(r){return r?"horizontal":"vertical"}addOrUpdateHScroll(r,e,i){var n,o;const l=this.getDirection(i),d=`${(n=r.name)!==null&&n!==void 0?n:r._uid}_${this.getDirection(i)}_${this.name}`,u=e.children.filter(R=>R.name===d);let f=!0,g=u[0];const{y:_=0,dy:y=0,x:b=0,dx:S=0,height:v,width:A,zIndex:x=0}=this.scrollContainer.g.attribute,T={x:0,y:0,direction:l,zIndex:x+1,visibleAll:!0,padding:[2,0],railStyle:{fill:"rgba(0, 0, 0, .1)"},range:[0,.05]};i?(T.width=this.scrollContainerBounds.width(),T.height=12):(T.height=this.scrollContainerBounds.height(),T.width=12),g?u.length>1&&u.forEach((R,L)=>{var w;L&&((w=R.parent)===null||w===void 0||w.removeChild(R))}):(f=!1,g=new ScrollBar$1(T),g.name=d,e.add(g),g.isScrollBar=!0);const C=this.childrenBounds,{scrollX:E,scrollY:P}=r.attribute;if(i){const R=Math.min(this.scrollContainerBounds.width()/C.width(),1),L=Math.max(Math.min(E/this.childrenBounds.width(),0),R-1);T.x=b+S,T.y=_+y+v-((o=T.height)!==null&&o!==void 0?o:0),T.range=[-L,-L+R]}else{const R=Math.min(this.scrollContainerBounds.height()/C.height(),1),L=Math.max(Math.min(P/this.childrenBounds.height(),0),R-1);T.x=b+S+A-this.scrollContainerBounds.width(),T.y=_+y,T.range=[-L,-L+R]}return g.setAttributes(T),{scrollBar:g,isUpdate:f}}clearScrollbar(r,e){r.parent&&r.parent.children.filter(i=>i.isScrollBar&&(e==="all"||i.attribute.direction===e)).forEach(i=>{i.parent.removeChild(i)})}formatScrollContainer(r){if(!r||r.type!=="group"||!r.attribute)return null;const{overflow:e,width:i,height:n}=r.attribute;if(!e||e==="hidden")return null;let o=!1,l=!1;e==="scroll"?(o=!0,l=!0):(o=e==="scroll-x",l=!o);const d=this.childrenBounds;return d.clear(),r.forEachChildren(u=>{d.union(u.AABBBounds)}),r.AABBBounds.empty()||(o&&(o=i<d.width()),l&&(l=n<d.height())),o||l?{g:r,showH:o,showV:l}:null}getScrollContainer(r){let e=r;for(;e;){const i=this.formatScrollContainer(e);if(i)return i;e=e.parent}return null}deactivate(r){const{stage:e}=this.pluginService;e.removeEventListener("wheel",this.scroll)}};ScrollBarPlugin.defaultParams={timeout:500},ScrollBarPlugin=ScrollBarPlugin_1=__decorate$2([injectable()],ScrollBarPlugin);const scrollbarModule=new ContainerModule((r,e,i,n)=>{i(ScrollBarPlugin)||(r(ScrollBarPlugin).toSelf(),r(AutoEnablePlugins).toService(ScrollBarPlugin))});function loadScrollbar(){container.load(scrollbarModule)}function traverseGroup(r,e){r.forEachChildren(i=>{const n=e(i);i.isContainer&&!n&&traverseGroup(i,e)})}const isVisible=r=>!isNil(r)&&r.visible!==!1;function getMarksByName(r,e){if(!e)return[];const i=r.find(n=>n.name===e,!0);return i?i.getChildren():[]}function getNoneGroupMarksByName(r,e){if(!e)return[];const i=r.find(n=>n.name===e,!0);return i?i.findAll(n=>n.type!=="group",!0):[]}function removeRepeatPoint(r){const e=[r[0]];for(let i=1;i<r.length;i++)r[i].x===r[i-1].x&&r[i].y===r[i-1].y||e.push(r[i]);return e}function isPostiveXAxis(r){return r>=0&&r<Math.PI/2||r>3*Math.PI/2&&r<=2*Math.PI}function fuzzyEqualNumber(r,e,i){return Math.abs(r-e)<i}function getTextAlignAttrOfVerticalDir(r,e,i){return r?{textAlign:"right",textBaseline:"middle"}:{textAlign:e<Math.PI&&i.toLocaleLowerCase().includes("top")||e>Math.PI&&i.toLocaleLowerCase().includes("bottom")?"left":e<Math.PI&&i.toLocaleLowerCase().includes("bottom")||e>Math.PI&&i.toLocaleLowerCase().includes("top")?"right":"center",textBaseline:e<Math.PI&&i.includes("inside")||e>Math.PI&&!i.includes("inside")?"bottom":"top"}}const defaultAlternativeColors=["#ffffff","#000000"];function labelSmartInvert(r,e,i,n,o,l){if(typeof r!="string"||typeof e!="string")return r;const d=new Color(r).toHex(),u=new Color(e).toHex();return contrastAccessibilityChecker(d,u,i,n,l)?d:improveContrastReverse(d,u,i,n,o,l)}function improveContrastReverse(r,e,i,n,o,l){const d=[];o&&(o instanceof Array?d.push(...o):d.push(o)),d.push(...defaultAlternativeColors);for(const u of d)if(r!==u&&contrastAccessibilityChecker(u,e,i,n,l))return u}function contrastAccessibilityChecker(r,e,i,n,o){if(o==="lightness"){const l=Color.getColorBrightness(new Color(e));return Color.getColorBrightness(new Color(r))<.5?l>=.5:l<.5}return n?contrastRatios(r,e)>n:i==="largeText"?contrastRatios(r,e)>3:contrastRatios(r,e)>4.5}function contrastRatios(r,e){const i=getColorLuminance(r),n=getColorLuminance(e);return((i>n?i:n)+.05)/((i>n?n:i)+.05)}function getColorLuminance(r){const e=hexToRgb(r),i=e[0]/255,n=e[1]/255,o=e[2]/255;let l,d,u;return l=i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4),d=n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4),u=o<=.03928?o/12.92:Math.pow((o+.055)/1.055,2.4),.2126*l+.7152*d+.0722*u}function smartInvertStrategy(r,e,i,n){let o;switch(r){case"base":o=e;break;case"invertBase":o=i;break;case"similarBase":o=n}return o}function scale(r,e){return[r[0]*e,r[1]*e]}function length(r){const[e,i]=r;return Math.sqrt(e*e+i*i)}function normalize$1(r){let e=length(r);return e>0&&(e=1/e),[r[0]*e,r[1]*e]}function angle(r,e){const[i,n]=r,[o,l]=e,d=Math.sqrt((i*i+n*n)*(o*o+l*l)),u=d&&(i*o+n*l)/d;return Math.acos(Math.min(Math.max(u,-1),1))}function angleTo(r,e,i){const n=angle(r,e),o=crossProduct(r,e)>=0;return i?o?2*Math.PI-n:n:o?n:2*Math.PI-n}const initTextMeasure$1=(r,e,i,n)=>new TextMeasure(Object.assign({defaultFontParams:Object.assign({fontFamily:DEFAULT_TEXT_FONT_FAMILY,fontSize:DEFAULT_TEXT_FONT_SIZE},n),getTextBounds:i?void 0:getTextBounds,specialCharSet:`-/: .,@%'"~`+TextMeasure.ALPHABET_CHAR_SET+TextMeasure.ALPHABET_CHAR_SET.toUpperCase()},e??{}),r);function measureTextSize(r,e,i={}){if(!r)return{width:0,height:0};const n=getTextBounds({text:r,fontFamily:e.fontFamily||i.fontFamily||DEFAULT_TEXT_FONT_FAMILY,fontSize:e.fontSize||i.fontSize||12,fontWeight:e.fontWeight||i.fontWeight,textAlign:e.textAlign||"center",textBaseline:e.textBaseline,ellipsis:!!e.ellipsis,maxLineWidth:e.maxLineWidth||1/0,lineHeight:e.fontSize||i.fontSize||12});return{width:n.width(),height:n.height()}}function isRichText(r,e="type"){return getTextType(r,e)==="rich"}function getTextType(r,e="type"){var i,n;return isObject$1(r.text)&&"type"in r.text?(i=r.text.type)!==null&&i!==void 0?i:"text":e in r&&(n=r[e])!==null&&n!==void 0?n:"text"}function richTextAttributeTransform(r){var e,i;return isValid(r.maxLineWidth)&&(r.maxWidth=r.maxLineWidth,delete r.maxLineWidth),r.width=(e=r.width)!==null&&e!==void 0?e:0,r.height=(i=r.height)!==null&&i!==void 0?i:0,r.textConfig=r.text.text||r.text,r}function htmlAttributeTransform(r){const{text:e,_originText:i}=r,{text:n}=e;return r.html=n,r.text=i,r.renderable=!1,r}function reactAttributeTransform(r){const{text:e,_originText:i}=r,{text:n}=e;return r.react=n,r.text=i,r.renderable=!1,r}function createTextGraphicByType(r,e="type"){const i=getTextType(r,e);return i==="rich"?graphicCreator.richtext(richTextAttributeTransform(r)):(i==="html"?r=htmlAttributeTransform(r):i==="react"&&(r=reactAttributeTransform(r)),graphicCreator.text(r))}function alignTextInLine(r,e,i,n,o){r==="right"?i==="center"?e.setAttribute("x",n-o/2):i==="right"||i==="end"?e.setAttribute("x",n):e.setAttribute("x",n-o):i==="center"?e.setAttribute("x",n+o/2):i==="right"||i==="end"?e.setAttribute("x",n+o):e.setAttribute("x",n)}const deltaXYToAngle=(r,e)=>{const i=Math.atan2(r,e);return i<0?i+2*Math.PI:i};function computeOffsetForlimit(r,e){const{x1:i,y1:n,x2:o,y2:l}=e,{x1:d,y1:u,x2:f,y2:g}=r.AABBBounds;let _=0,y=0;return d<i&&(_=i-d),u<n&&(y=n-u),f>o&&(_=o-f),g>l&&(y=l-g),{dx:_,dy:y}}function limitShapeInBounds(r,e){const{dx:i,dy:n}=computeOffsetForlimit(r,e),{dx:o=0,dy:l=0}=r.attribute;i&&r.setAttribute("dx",i+o),n&&r.setAttribute("dy",n+l)}function loadTagComponent(){registerGroup(),registerRect(),registerSymbol(),registerRichtext(),registerText()}var __rest$w=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};loadTagComponent();class Tag extends AbstractComponent{getBgRect(){return this._bgRect}getTextShape(){return this._textShape}constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},Tag.defaultAttributes,e)),this.name="tag",this._tagStates=[],this._rectStates=[],this._symbolStates=[],this._textStates=[]}render(){var e,i,n;this.cacheStates();const{text:o="",textStyle:l={},shape:d={},panel:u={},space:f=4,minWidth:g,maxWidth:_,padding:y=4,visible:b,state:S,type:v,textAlwaysCenter:A,containerTextAlign:x}=this.attribute,T=normalizePadding$1(y),C=this.createOrUpdateChild("tag-content",{x:0,y:0,zIndex:1},"group");let E,P=-T[3],R=-T[0],L=T[1]+T[3],w=T[0]+T[2],B=0,I=0;const{visible:D}=d,O=__rest$w(d,["visible"]);if(isBoolean(D)){const F=(O==null?void 0:O.size)||10,$=isNumber(F)?F:Math.max(F[0],F[1]);E=C.createOrUpdateChild("tag-shape",Object.assign(Object.assign({symbolType:"circle",size:F,strokeBoundsBuffer:0},O),{visible:D,x:$/2,y:$/2}),"symbol"),isEmpty(S==null?void 0:S.shape)||(E.states=S.shape),D&&(I=$+f)}let N;if(L+=I,B+=I,isRichText({text:o})||v==="rich"){const F=Object.assign(Object.assign(Object.assign({},richTextAttributeTransform(Object.assign({type:v,text:o},l))),l),{visible:isValid(o)&&b!==!1,x:B,y:0});N=C.createOrUpdateChild("tag-text",F,"richtext"),L+=N.AABBBounds.width(),w+=N.AABBBounds.height(),P+=N.AABBBounds.x1,R+=N.AABBBounds.y1}else{const F=Object.assign(Object.assign({text:isObject$1(o)&&"type"in o&&o.type==="text"?o.text:o,visible:isValid(o)&&b!==!1,lineHeight:l==null?void 0:l.fontSize},l),{x:B,y:0});isNil(F.lineHeight)&&(F.lineHeight=l.fontSize),N=C.createOrUpdateChild("tag-text",F,"text"),isEmpty(S==null?void 0:S.text)||(N.states=S.text);const $=measureTextSize(F.text,l,(i=(e=this.stage)===null||e===void 0?void 0:e.getTheme())===null||i===void 0?void 0:i.text),G=$.width,Y=$.height;L+=G;const Q=(n=d.size)!==null&&n!==void 0?n:10,q=isNumber(Q)?Q:Math.max(Q[0],Q[1]);w+=Math.max(Y,d.visible?q:0);const{textAlign:te,textBaseline:ue}=l;(isValid(g)||isValid(_))&&(isValid(g)&&L<g&&(L=g),isValid(_)&&L>_&&(L=_,N.setAttribute("maxLineWidth",_-T[1]-T[2]))),P=0,R=0;let he=0;te==="left"||te==="start"?he=1:te==="right"||te==="end"?he=-1:te==="center"&&(he=0),he?he<0?(P-=L,E&&E.setAttribute("x",(E.attribute.x||0)-G),C.setAttribute("x",-T[1]-I)):he>0&&C.setAttribute("x",T[3]):(P-=L/2,E&&E.setAttribute("x",(E.attribute.x||0)-G/2),C.setAttribute("x",-I/2));const fe=x==="right"||x==="end",pe=x==="left"||x==="start";if((x?x==="center":A)&&he){const me=L-T[1]-T[3],ee=G+I,J=he===1?(me-ee)/2+I+G/2:T[0]+I-(L/2+ee/2-I)+G/2;if(N.setAttributes({x:J,textAlign:"center"}),E){const ie=J-G/2-I+q/2;E.setAttributes({x:ie})}}if(pe&&he!==1){const me=L-T[1]-T[3],ee=he===0?-me/2+I/2:-L+T[3]+T[1]+I,J=ee+I;if(N.setAttributes({x:J,textAlign:"left"}),E){const ie=ee+q/2;E.setAttributes({x:ie})}}if(fe&&he!==-1){const me=L-T[1]-T[3],ee=he===0?me/2+I/2:me;if(N.setAttributes({x:ee,textAlign:"right"}),E){const J=ee-G-I+q/2;E.setAttributes({x:J})}}ue==="middle"?(R-=w/2,E&&E.setAttribute("y",0)):ue==="bottom"?(R-=w,E&&E.setAttribute("y",-Y/2),C.setAttribute("y",-T[2])):ue==="top"&&(C.setAttribute("y",T[0]),E&&E.setAttribute("y",Y/2))}const{visible:V}=u,H=__rest$w(u,["visible"]);if(b&&isBoolean(V)){const F=this.createOrUpdateChild("tag-panel",Object.assign(Object.assign({},H),{visible:V&&!!o,width:L,height:w,x:P,y:R}),"rect");if(isEmpty(S==null?void 0:S.panel)||(F.states=S.panel),H.customShape){const $=H.customShape;F.pathProxy=G=>$(this,G,new CustomPath2D)}this._bgRect=F}this._textShape=N,this._symbol=E,this.resetStates()}initAttributes(e,i){e=i!=null&&i.skipDefault?e:merge$1({},Tag.defaultAttributes,e),super.initAttributes(e),this.render()}addState(e,i,n){super.addState(e,i,n),this._textShape&&this._textShape.addState(e,i,n),this._bgRect&&this._bgRect.addState(e,i,n),this._symbol&&this._symbol.addState(e,i,n)}removeState(e,i){super.removeState(e,i),this._textShape&&this._textShape.removeState(e,i),this._bgRect&&this._bgRect.removeState(e,i),this._symbol&&this._symbol.removeState(e,i)}cacheStates(){var e,i,n,o,l,d,u,f,g,_,y,b,S,v;this._tagStates=(i=(e=this.currentStates)===null||e===void 0?void 0:e.slice())!==null&&i!==void 0?i:[],this._rectStates=(l=(o=(n=this._bgRect)===null||n===void 0?void 0:n.currentStates)===null||o===void 0?void 0:o.slice())!==null&&l!==void 0?l:[],this._symbolStates=(f=(u=(d=this._symbol)===null||d===void 0?void 0:d.currentStates)===null||u===void 0?void 0:u.slice())!==null&&f!==void 0?f:[],this._textStates=(y=(_=(g=this._textShape)===null||g===void 0?void 0:g.currentStates)===null||_===void 0?void 0:_.slice())!==null&&y!==void 0?y:[],this.clearStates(),(b=this._bgRect)===null||b===void 0||b.clearStates(),(S=this._symbol)===null||S===void 0||S.clearStates(),(v=this._textShape)===null||v===void 0||v.clearStates()}resetStates(){var e,i,n;this._tagStates.length&&this.useStates(this._tagStates),this._rectStates.length&&((e=this._bgRect)===null||e===void 0||e.useStates(this._rectStates)),this._symbolStates.length&&((i=this._symbol)===null||i===void 0||i.useStates(this._symbolStates)),this._textStates.length&&((n=this._textShape)===null||n===void 0||n.useStates(this._textStates))}}Tag.defaultAttributes={visible:!0,textStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},space:4,padding:4,shape:{fill:"#000"}};const DEFAULT_THEME={visible:!0,position:"auto",titleStyle:{fontSize:16,fill:"#08979c"},contentStyle:{fontSize:12,fill:"green"},panel:{visible:!0,fill:"#e6fffb",size:12,space:0,stroke:"#87e8de",lineWidth:1,cornerRadius:4}},theme={poptip:merge$1({},DEFAULT_THEME)};function loadPoptipComponent(){registerGroup(),registerText(),registerSymbol(),registerRect()}function setPoptipTheme(r){merge$1(theme.poptip,DEFAULT_THEME,r)}var __rest$v=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};const _tBounds=new AABBBounds;loadPoptipComponent();class PopTip extends AbstractComponent{constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},PopTip.defaultAttributes,e)),this.name="poptip",this.positionList=["top","tl","tr","bottom","bl","br","left","lt","lb","right","rt","rb"]}render(){var e,i,n,o,l,d,u,f;const{titleStyle:g={},position:_,contentStyle:y={},panel:b={},space:S=4,minWidth:v=0,maxWidth:A=1/0,padding:x=4,maxWidthPercent:T,visible:C,state:E,dx:P=0,dy:R=0}=this.attribute;let{title:L="",content:w=""}=this.attribute;L=this.attribute.titleFormatMethod?this.attribute.titleFormatMethod(L):L,w=this.attribute.contentFormatMethod?this.attribute.contentFormatMethod(w):w;const B=normalizePadding$1(x),I=this.createOrUpdateChild("poptip-content",{x:0,y:0,zIndex:1},"group"),D=A-B[1]-B[3],O=isValid(L)&&C!==!1,N=Object.assign(Object.assign({text:isArray(L)?L:[L],visible:O,wrap:!0},g),{x:B[3],y:B[0],maxLineWidth:D,textAlign:"left",textBaseline:"top"}),V=I.createOrUpdateChild("poptip-title",N,"text");isEmpty(E==null?void 0:E.title)||(V.states=E.title);const H=V.AABBBounds,F=H.height(),$=H.width();let G=F+S;O||(G=0);const Y=isValid(w)&&C!==!1,Q=Object.assign(Object.assign({text:isArray(w)?w:[w],visible:Y,wrap:!0},y),{x:B[3],y:B[0]+G,maxLineWidth:D,textAlign:"left",textBaseline:"top"}),q=I.createOrUpdateChild("poptip-content",Q,"text");isEmpty(E==null?void 0:E.content)||(q.states=E.content);const te=q.AABBBounds,ue=te.height(),he=te.width();Y&&(G+=ue);let fe=max$1($+B[1]+B[3],he+B[1]+B[3]);fe>A?fe=A:fe<v&&(fe=v);let pe=B[0]+B[2]+G;const{visible:me}=b,ee=__rest$v(b,["visible"]),J=(e=ee.size)!==null&&e!==void 0?e:12,ie=isArray(J)?[J[0]+((i=ee.space)!==null&&i!==void 0?i:0),J[1]+((n=ee.space)!==null&&n!==void 0?n:0)]:J+((o=ee.space)!==null&&o!==void 0?o:0),le=(l=ee.lineWidth)!==null&&l!==void 0?l:1,ce=this.stage?[(d=this.stage.viewWidth)!==null&&d!==void 0?d:this.stage.width,(u=this.stage.viewHeight)!==null&&u!==void 0?u:this.stage.height]:void 0;if(ce){const ne=this.AABBBounds,re=(f=this.attribute.x)!==null&&f!==void 0?f:ne.x1,ae=ce[0]-ne.x1;let z=Math.max(re,ae);const U=(isArray(J)?J[0]:12)+3;if(z=Math.min(z-U,z*T),z<fe){fe=z;const X=B[1]+B[3];V.setAttribute("maxLineWidth",z-X),q.setAttribute("maxLineWidth",z-X),pe=B[0]+B[2],O&&(pe+=V.AABBBounds.height()+S),pe+=q.AABBBounds.height()}}const j=_==="auto";let W,K=-1/0;for(let ne=0;ne<this.positionList.length+1;ne++){const re=j?this.positionList[ne===this.positionList.length?W:ne]:_,{angle:ae,offset:z,rectOffset:U}=this.getAngleAndOffset(re,fe,pe,isArray(ie)?ie:[ie,ie-le]);if(isBoolean(me)){const X=(isArray(J)?J[0]:J)/4,se=I.createOrUpdateChild("poptip-symbol-panel",Object.assign(Object.assign({},ee),{visible:me&&(Y||O),x:X,y:0,strokeBoundsBuffer:-1,boundsPadding:-2,anchor:[0,0],symbolType:"arrow2Left",angle:ae,dx:z[0],dy:z[1],size:J,zIndex:-9}),"symbol");isEmpty(E==null?void 0:E.panel)||(se.states=E.panel);const ge=I.createOrUpdateChild("poptip-rect-panel",Object.assign(Object.assign({},ee),{visible:me&&(Y||O),x:0,y:0,width:fe,height:pe,zIndex:-8}),"rect");isEmpty(E==null?void 0:E.panel)||(ge.states=E.panel)}if(I.setAttributes({x:-z[0]+P,y:-z[1]+R}),!j||!ce)break;{_tBounds.setValue(0,0,fe,pe).transformWithMatrix(I.globalTransMatrix);const X=_tBounds,se=new Bounds().setValue(0,0,ce[0],ce[1]);if(rectInsideAnotherRect(X,se,!1))break;{const ge=getRectIntersect(X,se,!1),de=(ge.x2-ge.x1)*(ge.y2-ge.y1);de>K&&(K=de,W=ne)}}}}getAngleAndOffset(e,i,n,o){const l=o[1]/2;switch(e){case"tl":return{angle:pi$1/2*3,offset:[i/4,n+l],rectOffset:[-i/4,-n-o[1]]};case"top":return{angle:pi$1/2*3,offset:[i/2,n+l],rectOffset:[0,-n-o[1]]};case"tr":return{angle:pi$1/2*3,offset:[i/4*3,n+l],rectOffset:[i/4*3,-n-o[1]]};case"rt":return{angle:0,offset:[-l,n/5],rectOffset:[i/4*3,-n-o[1]]};case"right":return{angle:0,offset:[-l,n/2],rectOffset:[i/4*3,-n-o[1]]};case"rb":return{angle:0,offset:[-l,n/5*4],rectOffset:[i/4*3,-n-o[1]]};case"bl":return{angle:pi$1/2,offset:[i/4,-l],rectOffset:[-i/4,-n-o[1]]};case"bottom":return{angle:pi$1/2,offset:[i/2,-l],rectOffset:[0,-n-o[1]]};case"br":return{angle:pi$1/2,offset:[i/4*3,-l],rectOffset:[i/4*3,-n-o[1]]};case"lt":return{angle:pi$1,offset:[i+l,n/5],rectOffset:[-i/4,-n-o[1]]};case"left":return{angle:pi$1,offset:[i+l,n/2],rectOffset:[0,-n-o[1]]};case"lb":return{angle:pi$1,offset:[i+l,n/5*4],rectOffset:[i/4*3,-n-o[1]]}}}}PopTip.defaultAttributes={position:"rt",visible:!0,title:null,content:null,titleStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},contentStyle:{fontSize:12,fill:"#000",textAlign:"left",textBaseline:"top"},maxWidthPercent:.8,space:8,padding:10};var __decorate$1=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d};function wrapPoptip(r,e){return merge$1(r,theme.poptip,e),r}let PopTipRenderContribution=class{render(r,e,i,n,o,l,d,u,f,g,_,y,b){var S,v;if(r._showPoptip===1){const{visible:A,visibleCb:x}=r.attribute.poptip||{};if(A===!1||x&&x(r)===!1)return;const T={};merge$1(T,PopTip.defaultAttributes,r.attribute.poptip?r.attribute.poptip:{}),this.poptipComponent?this.poptipComponent.initAttributes(T):this.poptipComponent=new PopTip(T);let C=r.attribute.poptip||{};if(r.type==="text"&&C.title==null&&C.content==null){const R={};wrapPoptip(R,C),C=R,C.content=(S=C.content)!==null&&S!==void 0?S:r.attribute.text}const E=r.globalTransMatrix;this.poptipComponent.setAttributes(Object.assign(Object.assign({visibleAll:!0,pickable:!1,childrenPickable:!1},C),{x:E.e,y:E.f})),g.stage.tryInitInteractiveLayer();const P=g.stage.getLayer("_builtin_interactive");P&&P.add(this.poptipComponent)}else r._showPoptip===2&&(r._showPoptip=0,this.poptipComponent&&(this.poptipComponent.setAttributes({visibleAll:!1}),(v=this.poptipComponent.parent)===null||v===void 0||v.removeChild(this.poptipComponent),this.poptipComponent=null))}};PopTipRenderContribution=__decorate$1([injectable()],PopTipRenderContribution);var __decorate=function(r,e,i,n){var o,l=arguments.length,d=l<3?e:n===null?n=Object.getOwnPropertyDescriptor(e,i):n;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")d=Reflect.decorate(r,e,i,n);else for(var u=r.length-1;u>=0;u--)(o=r[u])&&(d=(l<3?o(d):l>3?o(e,i,d):o(e,i))||d);return l>3&&d&&Object.defineProperty(e,i,d),d};class PopTipPluginBase{constructor(){this.activeEvent="onRegister",this._uid=Generator.GenAutoIncrementId(),this.poptip=e=>{const i=e.target;this.needHide(i)?this.unpoptip(e):i!==this.activeGraphic&&(this.needShow(i)&&(i.setAttributes({}),i._showPoptip=1),this.activeGraphic&&(this.activeGraphic.setAttributes({}),this.activeGraphic._showPoptip=2),this.setActiveGraphic(i,!0))},this.unpoptip=e=>{this.activeGraphic&&(this.activeGraphic.setAttributes({}),this.activeGraphic._showPoptip=2,this.setActiveGraphic(null,!0))}}activate(e){this.pluginService=e;const{stage:i}=this.pluginService;i.addEventListener("pointerover",this.poptip)}needHide(e){return e.isContainer||!e.attribute}needShow(e){return!!e.attribute.poptip}setActiveGraphic(e,i){this.activeGraphic=e,this.pluginService.stage.renderNextFrame()}deactivate(e){const{stage:i}=this.pluginService;i.removeEventListener("pointerover",this.poptip)}}let PopTipPlugin=class extends PopTipPluginBase{constructor(){super(...arguments),this.name="poptip",this.key=this.name+this._uid}};PopTipPlugin=__decorate([injectable()],PopTipPlugin);let PopTipForClipedTextPlugin=class extends PopTipPluginBase{constructor(){super(...arguments),this.name="poptipForText",this.key=this.name+this._uid,this.pointerlave=r=>{const{stage:e}=this.pluginService;r.target===e&&this.unpoptip(r)}}activate(r){super.activate(r);const{stage:e}=this.pluginService;e.addEventListener("pointerleave",this.pointerlave)}needHide(r){return r.type!=="text"||!r.cliped||r.isContainer||!r.attribute||r.attribute.disableAutoClipedPoptip}needShow(r){return!0}deactivate(r){const{stage:e}=this.pluginService;super.deactivate(r),e.removeEventListener("pointerleave",this.pointerlave)}};PopTipForClipedTextPlugin=__decorate([injectable()],PopTipForClipedTextPlugin);const popTipModule=new ContainerModule((r,e,i,n)=>{i(PopTipRenderContribution)||(r(PopTipRenderContribution).toSelf().inSingletonScope(),r(InteractiveSubRenderContribution).toService(PopTipRenderContribution)),i(PopTipPlugin)||(r(PopTipPlugin).toSelf(),r(AutoEnablePlugins).toService(PopTipPlugin)),i(PopTipForClipedTextPlugin)||(r(PopTipForClipedTextPlugin).toSelf(),r(AutoEnablePlugins).toService(PopTipForClipedTextPlugin))});function loadPoptip(){container.load(popTipModule)}class CrosshairBase extends AbstractComponent{constructor(){super(...arguments),this.name="crosshair"}render(){this.renderCrosshair(this)}}function loadLineCrosshairComponent(){registerGroup(),registerLine()}function loadCircleCrosshairComponent(){registerGroup(),registerArc()}function loadPolygonCrosshairComponent(){registerGroup(),registerPath()}function loadRectCrosshairComponent(){registerGroup(),registerRect()}function loadSectorCrosshairComponent(){registerGroup(),registerArc()}loadLineCrosshairComponent();class LineCrosshair extends CrosshairBase{constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},LineCrosshair.defaultAttributes,e))}renderCrosshair(e){const{start:i,end:n,lineStyle:o}=this.attribute;return e.createOrUpdateChild("crosshair-line",Object.assign({points:[i,n]},o),"line")}setLocation(e){const{start:i,end:n}=e;this.setAttributes({start:i,end:n})}}LineCrosshair.defaultAttributes={lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}};loadRectCrosshairComponent();class RectCrosshair extends CrosshairBase{constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},RectCrosshair.defaultAttributes,e))}renderCrosshair(e){const{start:i,end:n,rectStyle:o}=this.attribute;return e.createOrUpdateChild("crosshair-rect",Object.assign({x:i.x,y:i.y,width:n.x-i.x,height:n.y-i.y},o),"rect")}setLocation(e){const{start:i,end:n}=e;this.setAttributes({start:i,end:n})}}RectCrosshair.defaultAttributes={rectStyle:{fill:"#b2bacf",opacity:.2}};loadCircleCrosshairComponent();class CircleCrosshair extends CrosshairBase{constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},CircleCrosshair.defaultAttributes,e))}renderCrosshair(e){const{center:i,radius:n,lineStyle:o}=this.attribute;return e.createOrUpdateChild("crosshair-circle",Object.assign(Object.assign(Object.assign(Object.assign({},i),{outerRadius:n}),this.attribute),o),"arc")}setLocation(e){const{center:i}=this.attribute,n=PointService.distancePP(e,i);this.setAttribute("radius",n)}}CircleCrosshair.defaultAttributes={lineStyle:{stroke:["#b2bacf",!1,!1,!1],lineWidth:1,lineDash:[2]}};loadSectorCrosshairComponent();class SectorCrosshair extends CrosshairBase{constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},SectorCrosshair.defaultAttributes,e))}renderCrosshair(e){const{center:i,radius:n,innerRadius:o=0,sectorStyle:l}=this.attribute,{startAngle:d,endAngle:u}=this.attribute;return e.createOrUpdateChild("crosshair-sector",Object.assign(Object.assign(Object.assign({},i),{outerRadius:n,innerRadius:o,startAngle:d,endAngle:u}),l),"arc")}setLocation(e){const{center:i,startAngle:n=POLAR_START_ANGLE$1,endAngle:o=POLAR_END_ANGLE$1}=this.attribute,l=o-n,d=radianToDegree(getAngleByPoint(i,e));this.setAttributes({startAngle:d-l/2,endAngle:d+l/2})}}SectorCrosshair.defaultAttributes={sectorStyle:{fill:"#b2bacf",opacity:.2}};loadPolygonCrosshairComponent();class PolygonCrosshair extends CrosshairBase{constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},PolygonCrosshair.defaultAttributes,e))}renderCrosshair(e){const{center:i,radius:n,sides:o=6,lineStyle:l}=this.attribute,{startAngle:d,endAngle:u}=this.attribute,f=(u-d)%(2*Math.PI)==0,g=(u-d)/o;let _;for(let y=0;y<=o;y++){const b=polarToCartesian(i,n,d+g*y);y===0?_=`M${b.x},${b.y}`:_+=`L${b.x},${b.y}`,y===o&&f&&(_+="Z")}return e.createOrUpdateChild("crosshair-polygon",Object.assign({path:_},l),"path")}setLocation(e){const{center:i}=this.attribute,n=PointService.distancePP(e,i);this.setAttribute("radius",n)}}PolygonCrosshair.defaultAttributes={lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}};function loadSegmentComponent(){registerGroup(),registerLine(),registerPolygon(),registerSymbol()}function loadArcSegmentComponent(){registerGroup(),registerLine(),registerArc(),registerSymbol()}loadSegmentComponent();class Segment extends AbstractComponent{getStartAngle(){return normalizeAngle(this._startAngle)}getEndAngle(){return normalizeAngle(this._endAngle)}getMainSegmentPoints(){return this._mainSegmentPoints}constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},Segment.defaultAttributes,e)),this.name="segment",this.key="segment",this.lines=[]}render(){this.removeAllChild(!0),this._reset();const{startSymbol:e,endSymbol:i,lineStyle:n,state:o,visible:l=!0,multiSegment:d,mainSegmentIndex:u}=this.attribute;if(!l)return;this._computeLineAngle();const f=this._getMainSegmentPoints(),g=this._renderSymbol(e,f,"start"),_=this._renderSymbol(i,f,"end");if(this.startSymbol=g,this.endSymbol=_,d){const y=[...this.attribute.points];if(isValidNumber(u))y[u]=this._clipPoints(y[u]);else{const b=this._clipPoints(flattenArray(y));y[0][0]=b[0],y[y.length-1][y[y.length-1].length-1]=b[b.length-1]}y.forEach((b,S)=>{var v,A;const x=graphicCreator.line(Object.assign(Object.assign({points:b},isArray(n)?(v=n[S])!==null&&v!==void 0?v:n[n.length-1]:n),{fill:!1}));x.name=`${this.name}-line`,x.id=this._getNodeId("line"+S),isEmpty(o==null?void 0:o.line)||(x.states=isArray(o.line)?(A=o.line[S])!==null&&A!==void 0?A:o.line[o.line.length-1]:o.line),this.add(x),this.lines.push(x)})}else{let y=graphicCreator.line;array(n)[0].cornerRadius&&(y=graphicCreator.polygon);const b=y(Object.assign(Object.assign({points:this._clipPoints(this.attribute.points)},array(n)[0]),{fill:!1,closePath:!1}));b.name=`${this.name}-line`,b.id=this._getNodeId("line"),isEmpty(o==null?void 0:o.line)||(b.states=[].concat(o.line)[0]),this.add(b),this.lines.push(b)}}_computeStartRotate(e){return e+Math.PI/2}_computeEndRotate(e){return e+Math.PI/2}_renderSymbol(e,i,n){if(!i.length)return;const{autoRotate:o=!0}=e;let l;if(e&&e.visible){const d=this.getStartAngle(),u=this.getEndAngle(),{state:f}=this.attribute,g=i[0],_=i[i.length-1],{refX:y=0,refY:b=0,refAngle:S=0,style:v,symbolType:A,size:x=12}=e;let T,C;n==="start"?(T={x:g.x+(isValidNumber(d)?y*Math.cos(d)+b*Math.cos(d-Math.PI/2):0),y:g.y+(isValidNumber(d)?y*Math.sin(d)+b*Math.sin(d-Math.PI/2):0)},C=this._computeStartRotate(this._startAngle)):(T={x:_.x+(isValidNumber(u)?y*Math.cos(u)+b*Math.cos(u-Math.PI/2):0),y:_.y+(isValidNumber(u)?y*Math.sin(u)+b*Math.sin(u-Math.PI/2):0)},C=this._computeEndRotate(this._endAngle)),l=graphicCreator.symbol(Object.assign(Object.assign(Object.assign({},T),{symbolType:A,size:x,angle:o?C+S:0,strokeBoundsBuffer:0}),v)),l.name=`${this.name}-${n}-symbol`,l.id=this._getNodeId(`${n}-symbol`),isEmpty(f==null?void 0:f.symbol)||(l.states=f.symbol),n==="start"?isEmpty(f==null?void 0:f.startSymbol)||(l.states=f.startSymbol):isEmpty(f==null?void 0:f.endSymbol)||(l.states=f.endSymbol),this.add(l)}return l}_getMainSegmentPoints(){if(this._mainSegmentPoints)return this._mainSegmentPoints;const{points:e,multiSegment:i,mainSegmentIndex:n}=this.attribute;let o;return o=i?isValidNumber(n)?e[n]:flattenArray(e):e,this._mainSegmentPoints=o,o}_clipPoints(e){const{startSymbol:i={},endSymbol:n={}}=this.attribute;let o=e;if(i.visible){const l=i.clip?i.size||10:0;o=[{x:e[0].x-l/2*(Math.cos(this._startAngle)||0),y:e[0].y-l/2*(Math.sin(this._startAngle)||0)},...o.slice(1)]}if(n.visible){const l=n.clip?n.size||10:0,d={x:e[e.length-1].x-l/2*(Math.cos(this._endAngle)||0),y:e[e.length-1].y-l/2*(Math.sin(this._endAngle)||0)};o=[...o.slice(0,o.length-1),d]}return o}_computeLineAngle(){const e=this._getMainSegmentPoints();if(e.length<=1)return;const i=e[0],n=e[1],o=e[e.length-2],l=e[e.length-1],d=[i.x-n.x,i.y-n.y],u=Math.atan2(d[1],d[0]),f=[l.x-o.x,l.y-o.y],g=Math.atan2(f[1],f[0]);this._startAngle=u,this._endAngle=g}_reset(){this.startSymbol=null,this.endSymbol=null,this._startAngle=null,this._endAngle=null,this._mainSegmentPoints=null}}Segment.defaultAttributes={visible:!0,lineStyle:{lineWidth:1,stroke:"#000"},startSymbol:{visible:!1,autoRotate:!0,symbolType:"triangle",size:12,refX:0,refY:0,refAngle:0,style:{fill:"#000",zIndex:1}},endSymbol:{visible:!1,autoRotate:!0,symbolType:"triangle",size:12,refX:0,refY:0,refAngle:0,style:{fill:"#000",zIndex:1}}};loadArcSegmentComponent();class ArcSegment extends Segment{constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},Segment.defaultAttributes,e)),this.name="arc-segment",this.key="arc-segment",this.isReverseArc=!1}getStartAngle(){const e=this.isReverseArc?this._startAngle+Math.PI/2:this._startAngle-Math.PI/2;return e<0?e+2*Math.PI:e>2*Math.PI?e-2*Math.PI:e}getEndAngle(){const e=this.isReverseArc?this._endAngle-Math.PI/2:this._endAngle+Math.PI/2;return e<0?e+2*Math.PI:e>2*Math.PI?e-2*Math.PI:e}getMainSegmentPoints(){return this._mainSegmentPoints}_computeStartRotate(e){return this.isReverseArc?e+Math.PI:e}_computeEndRotate(e){return this.isReverseArc?e:e+Math.PI}render(){this.removeAllChild(!0),this._reset();const{startSymbol:e,endSymbol:i,lineStyle:n,state:o,visible:l=!0,radius:d,startAngle:u,endAngle:f,center:g}=this.attribute;if(!l)return;this._startAngle=u,this._endAngle=f,this.isReverseArc=u>f;const _={x:g.x+d*Math.cos(this._startAngle),y:g.y+d*Math.sin(this._startAngle)},y={x:g.x+d*Math.cos(this._endAngle),y:g.y+d*Math.sin(this._endAngle)};this._mainSegmentPoints=[_,y];const b=this._renderSymbol(e,this._mainSegmentPoints,"start"),S=this._renderSymbol(i,this._mainSegmentPoints,"end");this.startSymbol=b,this.endSymbol=S;const v=graphicCreator.arc(Object.assign({x:g.x,y:g.y,startAngle:u,endAngle:f,innerRadius:d,outerRadius:d},n));v.name=`${this.name}-line`,v.id=this._getNodeId("arc"),isEmpty(o==null?void 0:o.line)||(v.states=[].concat(o.line)[0]),this.add(v),this.line=v}}var AXIS_ELEMENT_NAME;(function(r){r.innerView="inner-view",r.axisContainer="axis-container",r.labelContainer="axis-label-container",r.tickContainer="axis-tick-container",r.tick="axis-tick",r.subTick="axis-sub-tick",r.label="axis-label",r.title="axis-title",r.gridContainer="axis-grid-container",r.grid="axis-grid",r.gridRegion="axis-grid-region",r.line="axis-line",r.background="axis-background",r.axisLabelBackground="axis-label-background",r.axisBreak="axis-break",r.axisBreakSymbol="axis-break-symbol"})(AXIS_ELEMENT_NAME||(AXIS_ELEMENT_NAME={}));var AxisStateValue;(function(r){r.selected="selected",r.selectedReverse="selected_reverse",r.hover="hover",r.hoverReverse="hover_reverse"})(AxisStateValue||(AxisStateValue={}));const DEFAULT_STATES$1={[AxisStateValue.selectedReverse]:{},[AxisStateValue.selected]:{},[AxisStateValue.hover]:{},[AxisStateValue.hoverReverse]:{}},TopZIndex=999,DEFAULT_AXIS_THEME={title:{space:4,padding:0,textStyle:{fontSize:12,fill:"#333333",fontWeight:"normal",fillOpacity:1}},label:{visible:!0,inside:!1,space:4,padding:0,style:{fontSize:12,fill:"#333",fontWeight:"normal",fillOpacity:1}},tick:{visible:!0,inside:!1,alignWithLabel:!0,length:4,style:{lineWidth:1,stroke:"#000",strokeOpacity:1}},subTick:{visible:!1,inside:!1,count:4,length:2,style:{lineWidth:1,stroke:"#999",strokeOpacity:1}},line:{visible:!0,style:{lineWidth:1,stroke:"#000",strokeOpacity:1}}},DEFAULT_AXIS_BREAK_SYMBOL_STYLE={size:8,stroke:"#000",lineWidth:1,zIndex:1};function genNormalBounds(r){const e=r.AABBBounds;return{x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2,centerX:r.attribute.x,centerY:r.attribute.y,angle:r.attribute.angle}}function genRotateBounds(r){r.forEach(e=>{if(e.rotatedBounds||!e.attribute.angle)return;const i=genNormalBounds(e),n=rotatePoint({x:e.attribute.x,y:e.attribute.y},i.angle,{x:i.centerX,y:i.centerY}),o=n.x-i.centerX,l=n.y-i.centerY;i.x1+=o,i.x2+=o,i.y1+=l,i.y2+=l,i.centerX+=o,i.centerY+=l,e.rotatedBounds=i})}function itemIntersect(r,e){var i,n;return!((i=r.OBBBounds)===null||i===void 0)&&i.empty()||!((n=e.OBBBounds)===null||n===void 0)&&n.empty()?isRectIntersect(r.AABBBounds,e.AABBBounds,!1)&&(!r.rotatedBounds||!e.rotatedBounds||isRotateAABBIntersect(r.rotatedBounds,e.rotatedBounds,!0)):r.OBBBounds.intersects(e.OBBBounds)}const DELTA_ANGLE=Math.sin(Math.PI/10);function isAngleVertical(r,e=DELTA_ANGLE){const i=!isNil(r)&&r!==0,n=i?Math.cos(r):1;return i&&Math.abs(n)<=e}function isAngleHorizontal(r,e=DELTA_ANGLE){const i=!isNil(r)&&r!==0,n=i?Math.sin(r):0;return!i||Math.abs(n)<=e}function getCircleLabelPosition(r,e){return{x:r.x+e[0],y:r.y+e[1]}}function getAxisBreakSymbolAttrs(r={}){var e,i;const{style:n={},angle:o=.5*Math.PI}=r,l=merge$1({},DEFAULT_AXIS_BREAK_SYMBOL_STYLE,n),d=(e=l.size)!==null&&e!==void 0?e:DEFAULT_AXIS_BREAK_SYMBOL_STYLE.size;return Object.assign(Object.assign({},l),{symbolType:(i=l.symbolType)!==null&&i!==void 0?i:`M ${-d/2} ${d*Math.sin(o)} L ${d/2} ${-d*Math.sin(o)}`,symbolSize:d})}function getElMap(r){const e={};return traverseGroup(r,i=>{i.type!=="group"&&i.id&&(e[i.id]=i)}),e}function getVerticalCoord(r,e){return{x:r.x+e[0],y:r.y+e[1]}}function getCircleVerticalVector(r,e,i,n=!1,o=!1){const l=[e.x-i.x,e.y-i.y];return scale(l,(n?-1:1)*(o?-1:1)*r/length(l))}function angleLabelOrientAttribute(r){let e="center",i="middle";return e=(r=normalizeAngle(r))>=Math.PI*(5/3)||r<=Math.PI*(1/3)?"left":r>=Math.PI*(2/3)&&r<=Math.PI*(4/3)?"right":"center",i=r>=Math.PI*(7/6)&&r<=Math.PI*(11/6)?"bottom":r>=Math.PI*(1/6)&&r<=Math.PI*(5/6)?"top":"middle",{align:e,baseline:i}}function getPolarAngleLabelPosition(r,e,i,n,o){const l=polarToCartesian({x:0,y:0},i,r),d=getVerticalCoord(l,getCircleVerticalVector(n,l,e,o));return getCircleLabelPosition(d,getCircleVerticalVector(n||1,d,e,o))}function getCirclePoints(r,e,i,n,o){const l=[],d=o-n;for(let u=0;u<e;u++){const f=n+u*d/e;l.push(polarToCartesian(r,i,f))}return l}function getPolygonPath(r,e){let i="";return r.length===0||(r.forEach((n,o)=>{o===0?i=`M${n.x},${n.y}`:i+=`L${n.x},${n.y}`}),e&&(i+="Z")),i}function textIntersect(r,e,i){var n;let o,l;const d=(n=r.attribute)===null||n===void 0?void 0:n.angle,u=(f,g,_)=>(o=f.AABBBounds,l=g.AABBBounds,_>Math.max(l.x1-o.x2,o.x1-l.x2,l.y1-o.y2,o.y1-l.y2));return isAngleHorizontal(d,Number.EPSILON)?u(r,e,i):(o=r.OBBBounds,l=e.OBBBounds,!o||!l||o.empty()||l.empty()?u(r,e,i):o.intersects(l))}function hasOverlap$1(r,e){for(let i,n=1,o=r.length,l=r[0];n<o;l=i,++n)if(i=r[n],textIntersect(l,i,e))return!0;return!1}const dispatchHoverState=(r,e,i)=>{const n=r.target;return n!==i&&n.name&&!isEmpty(n.states)?(n.addState(StateValue.hover,!0),traverseGroup(e,o=>{o!==n&&o.name&&!isEmpty(o.states)&&o.addState(StateValue.hoverReverse,!0)}),n):i},dispatchUnHoverState=(r,e,i)=>i&&(traverseGroup(e,n=>{n.name&&!isEmpty(n.states)&&(n.removeState(StateValue.hoverReverse),n.removeState(StateValue.hover))}),null),dispatchClickState=(r,e,i)=>{const n=r.target;return i===n&&n.hasState(StateValue.selected)?(traverseGroup(e,o=>{o.name&&!isEmpty(o.states)&&(o.removeState(StateValue.selectedReverse),o.removeState(StateValue.selected))}),null):n.name&&!isEmpty(n.states)?(n.addState(StateValue.selected,!0),traverseGroup(e,o=>{o!==n&&o.name&&!isEmpty(o.states)&&o.addState(StateValue.selectedReverse,!0)}),n):i};class AxisBase extends AbstractComponent{constructor(){super(...arguments),this.name="axis",this.data=[],this.tickLineItems=[],this.subTickLineItems=[],this.axisLabelLayerSize={},this.axisLabelsContainer=null,this._onHover=e=>{this._lastHover=dispatchHoverState(e,this.axisContainer,this._lastHover)},this._onUnHover=e=>{this._lastHover=dispatchUnHoverState(e,this.axisContainer,this._lastHover)},this._onClick=e=>{this._lastSelect=dispatchClickState(e,this.axisContainer,this._lastSelect)}}getInnerView(){return this._innerView}getPrevInnerView(){return this._prevInnerView}getBoundsWithoutRender(e){const i=cloneDeep(this.attribute);merge$1(this.attribute,e);const n=graphicCreator.group({x:this.attribute.x,y:this.attribute.y});return this.add(n),this._renderInner(n),this.removeChild(n),this.attribute=i,n.AABBBounds}render(){this._prevInnerView=this._innerView&&getElMap(this._innerView),this.removeAllChild(!0),this._innerView=graphicCreator.group({x:0,y:0,pickable:!1}),this.add(this._innerView),this._renderInner(this._innerView),this._bindEvent()}_bindEvent(){if(this.attribute.disableTriggerEvent)return;const{hover:e,select:i}=this.attribute;e&&(this._innerView.addEventListener("pointermove",this._onHover),this._innerView.addEventListener("pointerout",this._onUnHover)),i&&this._innerView.addEventListener("pointerdown",this._onClick)}_renderInner(e){const{title:i,label:n,tick:o,line:l,items:d}=this.attribute,u=graphicCreator.group({x:0,y:0,zIndex:1,pickable:!1});if(u.name=AXIS_ELEMENT_NAME.axisContainer,u.id=this._getNodeId("container"),u.setMode(this.mode),this.axisContainer=u,e.add(u),l&&l.visible&&this.renderLine(u),d&&d.length&&(this.data=this._transformItems(d[0]),o&&o.visible&&this.renderTicks(u),n&&n.visible)){const f=graphicCreator.group({x:0,y:0,pickable:!1});f.name=AXIS_ELEMENT_NAME.labelContainer,f.id=this._getNodeId("label-container"),this.axisLabelsContainer=f,u.add(f),d.forEach((g,_)=>{const y=this.renderLabels(f,g,_),b=y.getChildren();this.beforeLabelsOverlap(b,g,y,_,d.length),this.handleLabelsOverlap(b,g,y,_,d.length),this.afterLabelsOverlap(b,g,y,_,d.length);let S=0,v=0,A="center",x="middle",T=0;b.forEach((C,E)=>{var P;const R=C.attribute,L=(P=R.angle)!==null&&P!==void 0?P:0,w=C.AABBBounds;let B=w.width(),I=w.height();L&&(B=Math.abs(B*Math.cos(L)),I=Math.abs(I*Math.sin(L))),S=Math.max(S,B),v=Math.max(v,I),A=R.textAlign,x=R.textBaseline,E===0&&(T=R.x)}),this.axisLabelLayerSize[_]={width:S,height:v,labelPos:T,textAlign:A,textBaseline:x}})}i&&i.visible&&this.renderTitle(u)}renderTicks(e){const i=this.getTickLineItems(),n=graphicCreator.group({x:0,y:0,pickable:!1});n.name=AXIS_ELEMENT_NAME.tickContainer,n.id=this._getNodeId("tick-container"),e.add(n),i.forEach((l,d)=>{var u;const f=graphicCreator.line(Object.assign({},this._getTickLineAttribute("tick",l,d,i)));if(f.name=AXIS_ELEMENT_NAME.tick,f.id=this._getNodeId(l.id),isEmpty((u=this.attribute.tick)===null||u===void 0?void 0:u.state))f.states=DEFAULT_STATES$2;else{const g=this.data[d],_=merge$1({},DEFAULT_STATES$2,this.attribute.tick.state);Object.keys(_).forEach(y=>{isFunction(_[y])&&(_[y]=_[y](g.rawValue,d,g,this.data))}),f.states=_}n.add(f)}),this.tickLineItems=i;const{subTick:o}=this.attribute;if(o&&o.visible){const l=this.getSubTickLineItems();l.length&&l.forEach((d,u)=>{const f=graphicCreator.line(Object.assign({},this._getTickLineAttribute("subTick",d,u,i)));if(f.name=AXIS_ELEMENT_NAME.subTick,f.id=this._getNodeId(`${u}`),isEmpty(o.state))f.states=DEFAULT_STATES$2;else{const g=merge$1({},DEFAULT_STATES$2,o.state);Object.keys(g).forEach(_=>{isFunction(g[_])&&(g[_]=g[_](d.value,u,d,i))}),f.states=g}n.add(f)}),this.subTickLineItems=l}}renderLabels(e,i,n){const{dataFilter:o}=this.attribute.label;o&&isFunction(o)&&(i=o(i,n));const l=this._transformItems(i),d=graphicCreator.group({x:0,y:0,pickable:!1});return d.name=`${AXIS_ELEMENT_NAME.labelContainer}-layer-${n}`,d.id=this._getNodeId(`label-container-layer-${n}`),e.add(d),l.forEach((u,f)=>{var g;const _=this._getLabelAttribute(u,f,l,n),y=createTextGraphicByType(_);if(y.name=AXIS_ELEMENT_NAME.label,y.id=this._getNodeId(`layer${n}-label-${u.id}`),isEmpty((g=this.attribute.label)===null||g===void 0?void 0:g.state))y.states=DEFAULT_STATES$2;else{const b=merge$1({},DEFAULT_STATES$2,this.attribute.label.state);Object.keys(b).forEach(S=>{isFunction(b[S])&&(b[S]=b[S](u,f,l,n))}),y.states=b}y.data=Object.assign(Object.assign({},u),{index:f,layer:n}),d.add(y)}),d}renderTitle(e){const i=this.getTitleAttribute(),n=new Tag(Object.assign({},i));n.name=AXIS_ELEMENT_NAME.title,n.id=this._getNodeId("title"),e.add(n)}getVerticalCoord(e,i,n){return getVerticalCoord(e,this.getVerticalVector(i,n,e))}getTickLineItems(){const{tick:e}=this.attribute,i=this.data,n=[],{alignWithLabel:o,inside:l=!1,length:d,dataFilter:u}=e;let f=1;return i.length>=2&&(f=i[1].value-i[0].value),(u&&isFunction(u)?u(i):i).forEach(g=>{let _=g.point,y=g.value;if(!o){const S=g.value-f/2;if(this.isInValidValue(S))return;_=this.getTickCoord(S),y=S}const b=this.getVerticalCoord(_,d,l);if(this.mode==="3d"){const S=this.getVerticalVector(d,l,_);let v=0,A=0;abs$1(S[0])>abs$1(S[1])?v=pi$1/2*(b.x>_.x?1:-1):A=pi$1/2*(b.y>_.y?-1:1),n.push({start:_,end:b,value:y,id:`tick-${g.id}`,anchor:[_.x,_.y],alpha:v,beta:A})}else n.push({start:_,end:b,value:y,id:`tick-${g.id}`})}),n}getSubTickLineItems(){const{subTick:e}=this.attribute,i=[],{count:n=4,inside:o=!1,length:l=2}=e,d=this.tickLineItems,u=d.length;if(u>=2)for(let f=0;f<u-1;f++){const g=d[f],_=d[f+1];for(let y=0;y<n;y++){const b=(y+1)/(n+1),S=(1-b)*g.value+b*_.value,v=this.getTickCoord(S),A=this.getVerticalCoord(v,l,o);i.push({start:v,end:A,value:S,id:`sub-tick-${S}`})}}return i}_getTickLineAttribute(e,i,n,o){let l=get(this.attribute,`${e}.style`);const d=this.data[n];l=isFunction(l)?merge$1({},get(DEFAULT_AXIS_THEME,`${e}.style`),e==="tick"?l(d.rawValue,n,d,this.data):l(i.value,n,i,o)):l;const{start:u,end:f,anchor:g,alpha:_,beta:y}=i;return Object.assign({points:[u,f],anchor:g,alpha:_,beta:y},l)}_getLabelAttribute(e,i,n,o){var l,d;const{space:u=4,inside:f=!1,formatMethod:g,type:_="text",text:y}=this.attribute.label;let b=u,S=0;!((l=this.attribute.tick)===null||l===void 0)&&l.visible&&this.attribute.tick.inside===f&&(S=this.attribute.tick.length||4),!((d=this.attribute.subTick)===null||d===void 0)&&d.visible&&this.attribute.subTick.inside===f&&(S=Math.max(S,this.attribute.subTick.length||2)),b+=S;const v=this.getRelativeVector(e.point);o>0&&(v[1]===0?b+=(this.axisLabelLayerSize[o-1].height+get(this.attribute,"label.space",4))*o:b+=(this.axisLabelLayerSize[o-1].width+get(this.attribute,"label.space",4))*o);const A=this.getVerticalCoord(e.point,b,f),x=this.getVerticalVector(b||1,f,A),T=g?g(`${e.label}`,e,i,n,o):e.label;let{style:C}=this.attribute.label;C=isFunction(C)?merge$1({},DEFAULT_AXIS_THEME.label.style,C(e,i,n,o)):C;const E=this.getLabelAlign(x,f,C.angle);return C=merge$1(E,C),isFunction(C.text)&&(C.text=C.text({label:e.label,value:e.rawValue,index:e.index,layer:o})),Object.assign(Object.assign(Object.assign({},this.getLabelPosition(A,x,T,C)),{text:y??T,_originText:e.label,lineHeight:C==null?void 0:C.fontSize,type:_}),C)}getLabelPosition(e,i,n,o){return e}_transformItems(e){const i=[];return e.forEach(n=>{var o;i.push(Object.assign(Object.assign({},n),{point:this.getTickCoord(n.value),id:(o=n.id)!==null&&o!==void 0?o:n.label}))}),i}release(){super.release(),this._prevInnerView=null,this._innerView=null}}const methods$2={parity:function(r){return r.filter((e,i)=>i%2?e.setAttribute("opacity",0):1)},greedy:function(r,e){let i;return r.filter((n,o)=>o&&textIntersect(i,n,e)?n.setAttribute("opacity",0):(i=n,1))}};function hasBounds(r){let e;return e=r.OBBBounds.empty()?r.AABBBounds:r.OBBBounds,e.width()>1&&e.height()>1}function reset$1(r){return r.forEach(e=>e.setAttribute("opacity",1)),r}function forceItemVisible$1(r,e,i,n,o=!1){if(i&&!r.attribute.opacity){const l=e.length;if(l>1){r.setAttribute("opacity",1);for(let d=0;d<l;d++){const u=o?e[l-1-d]:e[d];if(!n(u))break;u.setAttribute("opacity",0)}}}}function autoHide(r,e){if(isEmpty(r))return;const i=r.filter(hasBounds);if(isEmpty(i))return;let n;n=reset$1(i);const{method:o="parity",separation:l=0}=e,d=isFunction(o)?o:methods$2[o]||methods$2.parity;if(n.length>=3&&hasOverlap$1(n,l)){do n=d(n,l);while(n.length>=3&&hasOverlap$1(n,l));const u=(b,S,v=!0)=>v&&b<3||S,f=u(n.length,e.firstVisible,!1);let g=u(n.length,e.lastVisible);const _=i[0],y=last(i);textIntersect(_,y,l)&&f&&g&&(y.setAttribute("opacity",0),g=!1),forceItemVisible$1(_,n,f,b=>textIntersect(b,_,l)),forceItemVisible$1(y,n,g,b=>textIntersect(b,y,l)||!(!f||b===_)&&textIntersect(b,_,l),!0)}i.forEach(u=>{u.setAttribute("visible",!!u.attribute.opacity)})}function autoRotate(r,e){if(isEmpty(r))return;const{orient:i,labelRotateAngle:n=[0,45,90]}=e;if(n.length===0||r.some(d=>!!d.attribute.angle))return;let o=0,l=0;for(n&&n.length>0&&(l=n.length);o<l;){const d=n[o++];if(r.forEach(u=>{u.attribute.angle=degreeToRadian(d)}),tryRotate(i,r),!hasIntersect(r))break}}function hasIntersect(r){for(let e=1;e<r.length;e++)if(itemIntersect(r[e-1],r[e]))return!0;return!1}function tryRotate(r,e){r!=="bottom"&&r!=="top"||rotateXAxis(r,e),r!=="left"&&r!=="right"||rotateYAxis(r,e),genRotateBounds(e)}function clampAngle(r=0){if(r<0)for(;r<0;)r+=2*Math.PI;if(r>0)for(;r>=2*Math.PI;)r-=2*Math.PI;return r}function rotateYAxis(r,e){e.forEach((i,n)=>{i.attribute.angle&&i.setAttributes(Object.assign(Object.assign({},getYAxisLabelAlign(r,i.attribute.angle)),{angle:clampAngle(i.attribute.angle)}))})}function rotateXAxis(r,e){e.forEach(i=>{i.attribute.angle&&i.setAttributes(Object.assign(Object.assign({},getXAxisLabelAlign(r,i.attribute.angle)),{angle:clampAngle(i.attribute.angle)}))})}function getXAxisLabelAlign(r,e=0){let i=["center","left","left","left","center","right","right","right","left"],n=["top","top","middle","bottom","bottom","bottom","middle","top","top"];r==="top"&&(i=["center","right","right","right","center","left","left","left","right"],n=["bottom","bottom","middle","top","top","top","middle","bottom","bottom"]);const o=(e=clampAngle(e))/(.5*Math.PI);let l;return l=o===Math.floor(o)?2*Math.floor(o):2*Math.floor(o)+1,{textAlign:i[l],textBaseline:n[l]}}function getYAxisLabelAlign(r,e=0){let i=["right","right","center","left","left","left","center","right","right"],n=["middle","middle","top","top","middle","middle","bottom","bottom","middle"];r==="right"&&(i=["left","left","center","right","right","right","center","left","left"],n=["middle","middle","bottom","bottom","middle","middle","top","middle","middle"]);const o=(e=clampAngle(e))/(.5*Math.PI);let l;return l=o===Math.floor(o)?2*Math.floor(o):2*Math.floor(o)+1,{textAlign:i[l],textBaseline:n[l]}}function normalizeOverflowLimitLength(r){return isValidNumber(r)?{left:r,right:r}:isObject$1(r)?{left:r.left||0,right:r.right||0}:{left:0,right:0}}function autoLimit(r,e){const{limitLength:i,verticalLimitLength:n,ellipsis:o="...",orient:l,axisLength:d}=e;if(isEmpty(r)||!isValidNumber(i))return;const u=normalizeOverflowLimitLength(e.overflowLimitLength),f=r[0],g=f.attribute.angle,_=!isNil(g),y=_?Math.cos(g):1,b=_?Math.sin(g):0,S=isAngleHorizontal(g),v=isAngleVertical(g),A=l==="top"||l==="bottom",x=f.attribute.direction,T=!S&&!v&&A&&(r.length<2||r.some(C=>Math.abs(C.AABBBounds.width()-f.AABBBounds.width())>=2))&&f.AABBBounds.width()>Math.abs(i/b);r.forEach(C=>{var E;if(A&&(v&&Math.floor(C.AABBBounds.height())<=i||S&&Math.floor(C.AABBBounds.width())<=n)||!A&&(x==="vertical"&&Math.floor(C.AABBBounds.height())<=n||x!=="vertical"&&(S&&Math.floor(C.AABBBounds.width())<=i||v&&Math.floor(C.AABBBounds.height())<=n)))return;let P=null;if(S||v)P=A?S?n:i:x==="vertical"||v?n:i;else if(A){const{x1:R,x2:L}=C.AABBBounds,w=b/y,B=Math.abs(i/b);if(T&&w>0&&R<=d+u.right&&i/w+R>d+u.right){const I=(d-R+u.right)/Math.abs(y);P=Math.min(I,B)}else if(T&&w<0&&L>=-u.left&&i/w+L<-u.left){const I=(L+u.left)/Math.abs(y);P=Math.min(I,B)}else P=B}else P=Math.abs(i/y);isValidNumber(C.attribute.maxLineWidth)&&(P=isValidNumber(P)?Math.min(C.attribute.maxLineWidth,P):C.attribute.maxLineWidth),C.setAttributes({maxLineWidth:P,ellipsis:(E=C.attribute.ellipsis)!==null&&E!==void 0?E:o})})}function autoWrap(r,e){const{limitLength:i,axisLength:n,ellipsis:o="...",orient:l}=e;if(isEmpty(r)||!isValidNumber(i))return;const d=r[0].attribute.angle,u=isAngleHorizontal(d),f=isAngleVertical(d),g=l==="top"||l==="bottom";let _=n/r.length;r.forEach((y,b)=>{var S,v,A,x,T;if(g){if(f&&Math.floor(y.AABBBounds.height())<=i)return;if(u){const P=getLabelMinGap(y.attribute.x,(S=r[b+1])===null||S===void 0?void 0:S.attribute.x,(v=r[b-1])===null||v===void 0?void 0:v.attribute.x);isValidNumber(P)&&(_=min$1(_,P))}}else{if(f){const P=getLabelMinGap(y.attribute.y,(A=r[b+1])===null||A===void 0?void 0:A.attribute.y,(x=r[b-1])===null||x===void 0?void 0:x.attribute.y);isValidNumber(P)&&(_=min$1(_,P))}if(u&&Math.floor(y.AABBBounds.width())<=i)return}let C=null,E=null;g?f?(C=i,E=_):(C=_,E=i):f?(C=_,E=i):(C=i,E=_),y.setAttributes({maxLineWidth:C,ellipsis:(T=y.attribute.ellipsis)!==null&&T!==void 0?T:o,whiteSpace:"normal",heightLimit:E})})}function getLabelMinGap(r,e,i){let n;return isValidNumber(e)&&(n=Math.abs(e-r)),isValidNumber(i)&&(n=isValidNumber(n)?Math.min(Math.abs(r-i),n):Math.abs(r-i)),n}function alignAxisLabels(r,e,i,n,o){n==="left"||n==="right"?o==="left"?r.forEach(l=>{var d;l.setAttributes({dx:((d=l.attribute.dx)!==null&&d!==void 0?d:0)+e-l.AABBBounds.x1})}):o==="right"?r.forEach(l=>{var d;l.setAttributes({dx:((d=l.attribute.dx)!==null&&d!==void 0?d:0)+e+i-l.AABBBounds.x2})}):o==="center"&&r.forEach(l=>{var d;l.setAttributes({dx:((d=l.attribute.dx)!==null&&d!==void 0?d:0)+e+i/2-(l.AABBBounds.x1+l.AABBBounds.x2)/2})}):n!=="bottom"&&n!=="top"||(o==="top"?r.forEach(l=>{var d;l.setAttributes({dy:((d=l.attribute.dy)!==null&&d!==void 0?d:0)+e-l.AABBBounds.y1})}):o==="bottom"?r.forEach(l=>{var d;l.setAttributes({dy:((d=l.attribute.dy)!==null&&d!==void 0?d:0)+e+i-l.AABBBounds.y2})}):o==="middle"&&r.forEach(l=>{var d;l.setAttributes({dy:((d=l.attribute.dy)!==null&&d!==void 0?d:0)+e+i/2-(l.AABBBounds.y1+l.AABBBounds.y2)/2})}))}class LineAxisMixin{isInValidValue(e){return e<0||e>1}getTickCoord(e){const{start:i}=this.attribute,n=this.getRelativeVector();return{x:i.x+n[0]*e,y:i.y+n[1]*e}}getRelativeVector(e){const{start:i,end:n}=this.attribute;return[n.x-i.x,n.y-i.y]}getVerticalVector(e,i=!1,n){const{verticalFactor:o=1}=this.attribute,l=this.getRelativeVector(),d=normalize$1(l),u=[d[1],-1*d[0]];return scale(u,e*(i?1:-1)*o)}}function loadBasicAxis(){registerGroup(),registerLine(),registerRichtext(),registerText()}function loadLineAxisComponent(){loadBasicAxis(),registerRect()}function loadCircleAxisComponent(){loadBasicAxis(),registerCircle()}function loadLineAxisGridComponent(){registerGroup(),registerPath()}function loadCircleAxisGridComponent(){registerGroup(),registerPath()}var __rest$u=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};loadLineAxisComponent();class LineAxis extends AxisBase{constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},LineAxis.defaultAttributes,e),i)}_renderInner(e){var i;if(this._breaks=null,this.attribute.breaks&&this.attribute.breaks.length){const o=[];for(let l=0;l<this.attribute.breaks.length;l++){const d=this.attribute.breaks[l],{range:u,breakSymbol:f,rawRange:g}=d;o.push({startPoint:this.getTickCoord(u[0]),endPoint:this.getTickCoord(u[1]),range:u,breakSymbol:f,rawRange:g})}this._breaks=o}super._renderInner(e),this._breaks&&this._breaks.length&&this._breaks.forEach((o,l)=>{const{startPoint:d,endPoint:u,breakSymbol:f,rawRange:g}=o;if((f==null?void 0:f.visible)!==!1){const _=graphicCreator.group({zIndex:TopZIndex});_.name=AXIS_ELEMENT_NAME.axisBreak,_.id=this._getNodeId(`${AXIS_ELEMENT_NAME.axisBreak}-${l}`),_.data=g;const y=getAxisBreakSymbolAttrs(f),b=graphicCreator.symbol(Object.assign({x:d.x,y:d.y},y));b.name=AXIS_ELEMENT_NAME.axisBreakSymbol;const S=graphicCreator.symbol(Object.assign({x:u.x,y:u.y},y));S.name=AXIS_ELEMENT_NAME.axisBreakSymbol,_.add(b),_.add(S),e.add(_)}});const{panel:n}=this.attribute;if(n&&n.visible){const o=this.axisContainer,l=o.AABBBounds,d=graphicCreator.rect(Object.assign({x:l.x1,y:l.y1,width:l.width(),height:l.height()},n.style));d.name=AXIS_ELEMENT_NAME.background,d.id=this._getNodeId("background"),d.states=merge$1({},DEFAULT_STATES$1,(i=n.state)!==null&&i!==void 0?i:{}),o.insertBefore(d,o.firstChild)}}renderLine(e){const{start:i,end:n,line:o}=this.attribute,l=o,{startSymbol:d,endSymbol:u,style:f,state:g}=l,_=__rest$u(l,["startSymbol","endSymbol","style","state"]),y=Object.assign({startSymbol:d,endSymbol:u,lineStyle:f},_);if(this._breaks&&this._breaks.length){const S=[];let v=i;this._breaks.forEach(A=>{const{startPoint:x,endPoint:T}=A;S.push([v,x]),v=T}),S.push([v,n]),y.points=S,y.multiSegment=!0}else y.points=[i,n];isEmpty(g)||(y.state={line:merge$1({},DEFAULT_STATES$1,g),symbol:merge$1({},DEFAULT_STATES$1,g)});const b=new Segment(y);b.name=AXIS_ELEMENT_NAME.line,b.id=this._getNodeId("line"),e.add(b)}getTextAlign(e){let i="center";return isNumberClose(e[0],0)?isNumberClose(e[1],0)?Object.is(e[1],-0)?i="start":Object.is(e[0],-0)&&(i="end"):i="center":e[0]>0?i="start":e[0]<0&&(i="end"),i}getTitleAttribute(){var e,i,n;const o=this.attribute.title,{position:l="middle",space:d=4,textStyle:u={},autoRotate:f=!0,shape:g,background:_,state:y={},maxWidth:b}=o,S=__rest$u(o,["position","space","textStyle","autoRotate","shape","background","state","maxWidth"]);let v=.5;l==="start"?v=0:l==="end"&&(v=1);const{verticalFactor:A=1}=this.attribute,x=-1*A,T=this.getTickCoord(v),C=this.getRelativeVector();let E=0;if(!((e=this.attribute.label)===null||e===void 0)&&e.visible&&this.attribute.label.inside===!1){const V=+get(this.attribute,"label.space",4);E+=V;const H=Object.keys(this.axisLabelLayerSize).length;if(C[1]===0){const F=this.axisLabelsContainer?this.axisLabelsContainer.AABBBounds.height():0;isFinite(F)?E+=F+(H-1)*V:E=0}else if(C[0]===0)if(this.axisLabelsContainer&&this.axisLabelsContainer.AABBBounds&&!this.axisLabelsContainer.AABBBounds.empty()){const F=this.axisLabelLayerSize[0].labelPos,$=this.axisLabelsContainer.AABBBounds;E+=(x===1?$.x2>F?Math.min($.x2-F,$.width()):0:$.x1<F?Math.min(F-$.x1,$.width()):0)+(H-1)*V}else E=0;else Object.keys(this.axisLabelLayerSize).forEach((F,$)=>{E+=this.axisLabelLayerSize[F].width+($>0?V:0)})}let P=0;!((i=this.attribute.tick)===null||i===void 0)&&i.visible&&this.attribute.tick.inside===!1&&(P=this.attribute.tick.length||4),!((n=this.attribute.subTick)===null||n===void 0)&&n.visible&&this.attribute.subTick.inside===!1&&(P=Math.max(P,this.attribute.subTick.length||2));const R=P+E+d,L=this.getVerticalCoord(T,R,!1),w=this.getVerticalVector(R,!1,{x:0,y:0});let B,I,{angle:D}=S;if(B=l==="start"?"start":l==="end"?"end":"center",isNil(D)&&f){D=angleTo(C,[1,0],!0);const{verticalFactor:V=1}=this.attribute;I=-1*V===1?"bottom":"top"}else B=this.getTextAlign(w),I=this.getTextBaseline(w,!1);let O=b;if(isNil(O)){const{verticalLimitSize:V,verticalMinSize:H,orient:F}=this.attribute,$=Math.min(V||1/0,H||1/0);if(isValidNumber($))if(F==="bottom"||F==="top")if(D!==Math.PI/2){const G=Math.abs(Math.cos(D??0));O=G<1e-6?1/0:this.attribute.end.x/G}else O=$-R;else if(D&&D!==0){const G=Math.abs(Math.sin(D));O=G<1e-6?1/0:this.attribute.end.y/G}else O=$-R}const N=Object.assign(Object.assign(Object.assign({},L),S),{maxWidth:O,textStyle:Object.assign({textAlign:B,textBaseline:I},u),state:{text:merge$1({},DEFAULT_STATES$1,y.text),shape:merge$1({},DEFAULT_STATES$1,y.shape),panel:merge$1({},DEFAULT_STATES$1,y.background)}});return N.angle=D,g&&g.visible&&(N.shape=Object.assign({visible:!0},g.style),g.space&&(N.space=g.space)),_&&_.visible&&(N.panel=Object.assign({visible:!0},_.style)),N}getTextBaseline(e,i){let n="middle";const{verticalFactor:o=1}=this.attribute,l=(i?1:-1)*o;return isNumberClose(e[1],0)?n=!isNumberClose(e[0],0)||Object.is(e[0],-0)||Object.is(e[1],-0)?"middle":l===1?"bottom":"top":e[1]>0?n="top":e[1]<0&&(n="bottom"),n}getLabelAlign(e,i,n){const o=this.attribute.orient;if(["top","bottom","right","left"].includes(o)||e[0]===0&&e[1]===0){if(o==="top"||o==="bottom")return getXAxisLabelAlign(i?o==="bottom"?"top":"bottom":o,n);if(o==="left"||o==="right")return getYAxisLabelAlign(i?o==="left"?"right":"left":o,n)}return{textAlign:this.getTextAlign(e),textBaseline:this.getTextBaseline(e,i)}}beforeLabelsOverlap(e,i,n,o,l){var d,u,f,g;const{flush:_=!1}=this.attribute.label||{};if(_&&e.length){const{orient:y,start:b,end:S}=this.attribute,v=y==="bottom"||y==="top",A=e[0],x=last(e),T=v?A.attribute.x>x.attribute.x:A.attribute.y<x.attribute.y;if(v){const C=T?x:A,E=T?A:x,P=b.x,R=S.x,L=C.AABBBounds.x1,w=E.AABBBounds.x2;L<P&&(C.attribute.angle?C.setAttributes({dx:((d=C.attribute.dx)!==null&&d!==void 0?d:0)+P-L}):C.setAttributes({x:P,textAlign:"left"})),w>R&&(E.attribute.angle?E.setAttributes({dx:((u=E.attribute.dx)!==null&&u!==void 0?u:0)+R-w}):E.setAttributes({x:R,textAlign:"right"}))}else{const C=T?x:A,E=T?A:x,P=C.AABBBounds.y2,R=E.AABBBounds.y1,L=b.y,w=S.y;R<L&&(E.attribute.angle?E.setAttributes({dy:((f=E.attribute.dy)!==null&&f!==void 0?f:0)+L-R}):E.setAttributes({y:L,textBaseline:"top"})),P>w&&(C.attribute.angle?C.setAttributes({dy:((g=C.attribute.dy)!==null&&g!==void 0?g:0)+w-P}):C.setAttributes({y:w,textBaseline:"bottom"}))}}}handleLabelsOverlap(e,i,n,o,l){if(isEmpty(e))return;const{verticalLimitSize:d,label:u,orient:f}=this.attribute,g=this._getAxisLabelLimitLength(d,l),{layoutFunc:_,autoRotate:y,autoRotateAngle:b,autoLimit:S,limitEllipsis:v,autoHide:A,autoHideMethod:x,autoHideSeparation:T,lastVisible:C,firstVisible:E,autoWrap:P,overflowLimitLength:R}=u;if(isFunction(_))_(e,i,o,this);else{if(y)autoRotate(e,{labelRotateAngle:b,orient:f});else if(P){const L=Math.abs(f==="left"||f==="right"?this.attribute.start.y-this.attribute.end.y:this.attribute.start.x-this.attribute.end.x);autoWrap(e,{orient:f,limitLength:g,axisLength:L,ellipsis:v})}if(!P&&S&&isValidNumber(g)&&g>0){const L=f==="left"||f==="right",w=Math.abs(L?this.attribute.start.y-this.attribute.end.y:this.attribute.start.x-this.attribute.end.x),B=L?w/e.length:A||y?1/0:w/e.length;autoLimit(e,{limitLength:g,verticalLimitLength:B,ellipsis:v,orient:f,axisLength:w,overflowLimitLength:R})}A&&autoHide(e,{method:x,separation:T,lastVisible:C,firstVisible:E})}}afterLabelsOverlap(e,i,n,o,l){const{verticalLimitSize:d,orient:u}=this.attribute,f=u==="bottom"||u==="top",g=n.AABBBounds;let _=f?g.height():g.width();const{verticalMinSize:y}=this.attribute;if(isValidNumber(y)&&(!isValidNumber(d)||y<=d)){const b=this._getAxisLabelLimitLength(y,l);let S,v;_=Math.max(_,b),u==="left"?(S=g.x2-_,v=g.y1):u==="right"?(S=g.x1,v=g.y1):u==="top"?(S=g.x1,v=g.y2-_):u==="bottom"&&(S=g.x1,v=g.y1);const A=graphicCreator.rect({x:S,y:v,width:f?g.width():_,height:f?_:g.height(),pickable:!1});A.name=AXIS_ELEMENT_NAME.axisLabelBackground,A.id=this._getNodeId("axis-label-background"),n.insertBefore(A,n.firstChild)}if(isValid(this.attribute.label.containerAlign)){let b;u==="left"?b=g.x2-_:u==="right"?b=g.x1:u==="top"?b=g.y2-_:u==="bottom"&&(b=g.y1),alignAxisLabels(e,b,_,u,this.attribute.label.containerAlign)}}_getAxisLabelLimitLength(e,i){var n,o,l,d,u;const{label:f,title:g,line:_,tick:y}=this.attribute,b=(n=f.space)!==null&&n!==void 0?n:4;let S=e,v=0,A=0;const x=_&&_.visible?(o=_.style.lineWidth)!==null&&o!==void 0?o:1:0,T=y&&y.visible?(l=y.length)!==null&&l!==void 0?l:4:0;if(g&&g.visible&&typeof g.text=="string"){v=measureTextSize(g.text,g.textStyle,(u=(d=this.stage)===null||d===void 0?void 0:d.getTheme())===null||u===void 0?void 0:u.text).height;const C=normalizePadding$1(g.padding);A=g.space+C[0]+C[2]}return S&&(S=(S-b-A-v-x-T)/i),S}release(){super.release(),this._breaks=null}}LineAxis.defaultAttributes=DEFAULT_AXIS_THEME,mixin(LineAxis,LineAxisMixin);class CircleAxisMixin{isInValidValue(e){const{startAngle:i=POLAR_START_ANGLE$1,endAngle:n=POLAR_END_ANGLE$1}=this.attribute;return Math.abs(n-i)%(2*Math.PI)==0?e>1:e<0||e>1}getTickCoord(e){const{startAngle:i=POLAR_START_ANGLE$1,endAngle:n=POLAR_END_ANGLE$1,center:o,radius:l,inside:d=!1,innerRadius:u=0}=this.attribute;return polarToCartesian(o,d&&u>0?u:l,i+(n-i)*e)}getVerticalVector(e,i=!1,n){return getCircleVerticalVector(e,n,this.attribute.center,i,this.attribute.inside)}getRelativeVector(e){const{center:i}=this.attribute;return[e.y-i.y,-1*(e.x-i.x)]}}function findSiblingLabels(r,e){const i=r.length;return{prevLabel:e>=1?r[e-1]:r[i-1],nextLabel:e<i-1?r[e+1]:r[0]}}function adjustMaxLineWidth(r,e,i){var n;r.setAttributes({maxLineWidth:e,ellipsis:(n=r.attribute.ellipsis)!==null&&n!==void 0?n:i})}function adjustMaxHeight(r,e,i){const n=[];if(r.length>=3){const{prevLabel:d,nextLabel:u}=findSiblingLabels(r,e);n.push(d,u)}else r.length===2&&n.push(r[e===0?1:0]);const o=r[e];let l=Math.min(Math.abs(o.attribute.y-i.y1),Math.abs(o.attribute.y-i.y2));n.forEach(d=>{l=Math.min(l,Math.abs(d.attribute.y-o.attribute.y))}),l>0&&o.setAttributes({whiteSpace:"normal",heightLimit:l})}function circleAutoLimit(r,e){const{ellipsis:i,inside:n,bounds:o,autoWrap:l,center:d}=e;n||r.forEach((u,f)=>{const{x:g,y:_}=u.attribute,y=u.AABBBounds;if(isNumberClose(g,d.x)){if(_>o.y2||_<o.y1)return void adjustMaxLineWidth(u,0,i);const b=o.x2-o.x1;if(r.length>=3){const{prevLabel:S,nextLabel:v}=findSiblingLabels(r,f);let A=S.attribute.x,x=v.attribute.x;A>x&&(A=v.attribute.x,x=S.attribute.x);const T=A===x?b:g>=A&&g<=x?x-A:Math.min(Math.abs(A-g),Math.abs(x-g));u.AABBBounds.width()>T&&adjustMaxLineWidth(u,T,i)}else u.AABBBounds.width()>b&&adjustMaxLineWidth(u,b,i)}else g>d.x&&y.x2>o.x2?(adjustMaxLineWidth(u,o.x2-g,i),l&&adjustMaxHeight(r,f,o)):g<d.x&&y.x1<o.x1&&(adjustMaxLineWidth(u,g-o.x1,i),l&&adjustMaxHeight(r,f,o))})}var __rest$t=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};loadCircleAxisComponent();class CircleAxis extends AxisBase{constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},CircleAxis.defaultAttributes,e))}renderLine(e){const{startAngle:i=POLAR_START_ANGLE$1,endAngle:n=POLAR_END_ANGLE$1,radius:o,center:l,innerRadius:d=0,line:u={},inside:f=!1,sides:g}=this.attribute;let _,y=o,b=d;if(f&&d>0&&(y=d,b=0),isValidNumber(g)&&g>=3){const S=getCirclePoints(l,g,y,i,n);_=graphicCreator.path(Object.assign(Object.assign({},u.style),{path:getPolygonPath(S,!0)}))}else{const S=Object.assign(Object.assign(Object.assign({},l),{startAngle:i,endAngle:n,radius:y,innerRadius:b}),u.style);_=graphicCreator.circle(S)}_.name=AXIS_ELEMENT_NAME.line,_.id=this._getNodeId("line"),isEmpty(u.state)||(_.states=merge$1({},DEFAULT_STATES$1,u.state)),e.add(_)}getTitleAttribute(){var e,i,n;const{center:o,radius:l,innerRadius:d=0}=this.attribute,u=this.attribute.title,{space:f=4,textStyle:g={},shape:_,background:y,state:b={}}=u,S=__rest$t(u,["space","textStyle","shape","background","state"]);let v=o,A=0;!((e=this.attribute.label)===null||e===void 0)&&e.visible&&this.attribute.label.inside===!1&&(A=get(this.attribute.label,"style.fontSize",12)+get(this.attribute.label,"space",4));let x=0;!((i=this.attribute.tick)===null||i===void 0)&&i.visible&&this.attribute.tick.inside===!1&&(x=this.attribute.tick.length||4),!((n=this.attribute.subTick)===null||n===void 0)&&n.visible&&this.attribute.subTick.inside===!1&&(x=Math.max(x,this.attribute.subTick.length||2));const T=l+x+A+f;let C="middle",{position:E}=this.attribute.title;isNil(E)&&(E=d===0?"end":"middle"),E==="start"?(C="bottom",v={x:o.x,y:o.y-T}):E==="end"&&(C="top",v={x:o.x,y:o.y+T});const P=Object.assign(Object.assign(Object.assign({},v),S),{textStyle:Object.assign({textBaseline:C,textAlign:"center"},g),state:{text:merge$1({},DEFAULT_STATES$1,b.text),shape:merge$1({},DEFAULT_STATES$1,b.shape),panel:merge$1({},DEFAULT_STATES$1,b.background)}}),{angle:R}=S;return P.angle=R,_&&_.visible&&(P.shape=Object.assign({visible:!0},_.style),_.space&&(P.space=_.space)),y&&y.visible&&(P.panel=Object.assign({visible:!0},y.style)),P}getSubTickLineItems(){var e,i;const{subTick:n}=this.attribute,o=[],{count:l=4,inside:d=!1,length:u=2}=n,f=this.tickLineItems,g=f.length;if(g>=2){const _=this.data[1].value-this.data[0].value,y=(i=(e=this.attribute)===null||e===void 0?void 0:e.tick)===null||i===void 0?void 0:i.alignWithLabel;for(let b=0;b<g;b++){const S=f[b],v=f[b+1];for(let A=0;A<l;A++){const x=(A+1)/(l+1),T=(1-x)*S.value+x*(v?v.value:y?1:S.value+_),C=this.getTickCoord(T),E=this.getVerticalCoord(C,u,d);o.push({start:C,end:E,value:T})}}}return o}beforeLabelsOverlap(e,i,n,o,l){}handleLabelsOverlap(e,i,n,o,l){if(isEmpty(e))return;const{inside:d,radius:u,center:f,size:g,label:_,orient:y}=this.attribute,b=g?{x1:0,y1:0,x2:g.width,y2:g.height}:{x1:f.x-u,y1:f.y-u,x2:f.x+u,y2:f.y+u},{layoutFunc:S,autoLimit:v,limitEllipsis:A,autoHide:x,autoHideMethod:T,autoHideSeparation:C,autoWrap:E}=_;isFunction(S)?S(e,i,o,this):((v||E)&&circleAutoLimit(e,{inside:d,autoWrap:E,bounds:b,ellipsis:A,center:f}),x&&autoHide(e,{method:T,separation:C}))}afterLabelsOverlap(e,i,n,o,l){}getTextBaseline(e){return Math.abs(e[1]/e[0])<.3?"middle":e[1]<0?"bottom":e[1]>0?"top":"middle"}getLabelAlign(e,i,n){return isNumberClose(e[0],0)?{textAlign:"center",textBaseline:e[1]>0?"top":"bottom"}:e[0]<0?{textAlign:"right",textBaseline:this.getTextBaseline(e)}:e[0]>0?{textAlign:"left",textBaseline:this.getTextBaseline(e)}:{textAlign:"center",textBaseline:"middle"}}getLabelPosition(e,i,n,o){return e}}CircleAxis.defaultAttributes=DEFAULT_AXIS_THEME,mixin(CircleAxis,CircleAxisMixin);class GroupTransition extends ACustomAnimate{constructor(){super(...arguments),this.mode=AnimateMode.NORMAL}onBind(){const e=this.target.getInnerView(),i=this.target.getPrevInnerView();i&&(this._newElementAttrMap={},traverseGroup(e,n=>{var o,l,d,u,f,g;if(n.type!=="group"&&n.id){const _=i[n.id];if(_){if(!isEqual(n.attribute,_.attribute)){const y=cloneDeep(n.attribute);this._newElementAttrMap[n.id]={state:"update",node:n,attrs:Object.assign(Object.assign({},y),{opacity:(o=y.opacity)!==null&&o!==void 0?o:1,fillOpacity:(l=y.fillOpacity)!==null&&l!==void 0?l:1,strokeOpacity:(d=y.strokeOpacity)!==null&&d!==void 0?d:1})},n.setAttributes(_.attribute)}}else{const y={opacity:(u=n.attribute.opacity)!==null&&u!==void 0?u:1,fillOpacity:(f=n.attribute.fillOpacity)!==null&&f!==void 0?f:1,strokeOpacity:(g=n.attribute.strokeOpacity)!==null&&g!==void 0?g:1};this._newElementAttrMap[n.id]={state:"enter",node:n,attrs:y},n.setAttributes({opacity:0,fillOpacity:0,strokeOpacity:0})}}}))}onStart(){let e=this.duration,i=this.easing;this._newElementAttrMap&&Object.keys(this._newElementAttrMap).forEach(n=>{var o;const{node:l,attrs:d,state:u}=this._newElementAttrMap[n];if(u==="enter"){const{enter:f={}}=(o=this.params)!==null&&o!==void 0?o:{};e=isValidNumber(f.duration)?f.duration:e,i=f.easing?f.easing:i}l.type==="path"?l.animate({interpolate:(f,g,_,y,b)=>f==="path"&&(b.path=interpolateString(_,y)(g),!0)}).to(d,e,i):l.animate().to(d,e,i)})}onUpdate(e,i,n){}}const convertDomainToTickData=r=>r.map((e,i)=>({index:i,value:e})),labelOverlap=(r,e,i=0)=>{const n=new AABBBounds(r).expand(i/2),o=new AABBBounds(e).expand(i/2);return n.intersects(o)},MIN_TICK_GAP=12,calculateFlushPos=(r,e,i,n)=>i<r?Math.max(r-e/2,i):i>r?Math.min(r-e/2,i-e):i<n?i:i-e,getCartesianLabelBounds=(r,e,i)=>{var n;const{labelStyle:o,axisOrientType:l,labelFlush:d,labelFormatter:u,startAngle:f=0}=i;let g=(n=o.angle)!==null&&n!==void 0?n:0;o.direction==="vertical"&&(g+=degreeToRadian(90));const _=["bottom","top"].includes(l),y=["left","right"].includes(l);let b=1,S=0;_||(y?(b=0,S=1):f&&(b=Math.cos(f),S=-Math.sin(f)));const v=initTextMeasure$1(o),A=r.range();return e.map((T,C)=>{var E,P;const R=u?u(T):`${T}`,{width:L,height:w}=v.quickMeasure(R),B=Math.max(L,12),I=Math.max(w,12),D=r.scale(T),O=b*D,N=S*D;let V,H,F=O,$=N;d&&_&&C===0?F=calculateFlushPos(O,B,A[0],A[A.length-1]):d&&_&&C===e.length-1?F=calculateFlushPos(O,B,A[A.length-1],A[0]):V=(E=o.textAlign)!==null&&E!==void 0?E:"center",V==="right"?F-=B:V==="center"&&(F-=B/2),d&&y&&C===0?$=calculateFlushPos(N,I,A[0],A[A.length-1]):d&&y&&C===e.length-1?$=calculateFlushPos(N,I,A[A.length-1],A[0]):H=(P=o.textBaseline)!==null&&P!==void 0?P:"middle",H==="bottom"?$-=I:H==="middle"&&($-=I/2);const G=new AABBBounds().set(F,$,F+B,$+I);return g&&G.rotate(g,O,N),G})},isAxisHorizontal=r=>["bottom","top","z"].includes(r);var ScaleEnum;(function(r){r.Identity="identity",r.Linear="linear",r.Log="log",r.Pow="pow",r.Sqrt="sqrt",r.Symlog="symlog",r.Time="time",r.Quantile="quantile",r.Quantize="quantize",r.Threshold="threshold",r.Ordinal="ordinal",r.Point="point",r.Band="band"})(ScaleEnum||(ScaleEnum={}));const EnableScaleMap={};Object.values(ScaleEnum).forEach(r=>{EnableScaleMap[r]=!0});function isContinuous(r){switch(r){case ScaleEnum.Linear:case ScaleEnum.Log:case ScaleEnum.Pow:case ScaleEnum.Sqrt:case ScaleEnum.Symlog:case ScaleEnum.Time:return!0;default:return!1}}function isValidScaleType(r){return!!EnableScaleMap[r]}function isDiscrete(r){switch(r){case ScaleEnum.Ordinal:case ScaleEnum.Point:case ScaleEnum.Band:return!0;default:return!1}}function identity(r){return r}const sqrt$1=r=>r<0?-Math.sqrt(-r):Math.sqrt(r),square=r=>r<0?-r*r:r*r,logNegative=r=>-Math.log(-r),expNegative=r=>-Math.exp(-r),pow10=r=>isFinite(r)?Math.pow(10,r):r<0?0:r,powp=r=>r===10?pow10:r===Math.E?Math.exp:e=>Math.pow(r,e),logp=r=>r===Math.E?Math.log:r===10?Math.log10:r===2?Math.log2:(r=Math.log(r),e=>Math.log(e)/r),symlog=r=>e=>Math.sign(e)*Math.log1p(Math.abs(e/r)),symexp=r=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*r;function normalize(r,e){if(r=Number(r),e=Number(e),e-=r)return n=>(n-r)/e;const i=Number.isNaN(e)?NaN:.5;return()=>i}function bimap(r,e,i){const n=r[0],o=r[1],l=e[0],d=e[1];let u,f;return o<n?(u=normalize(o,n),f=i(d,l)):(u=normalize(n,o),f=i(l,d)),g=>f(u(g))}function bandSpace(r,e,i){let n;return n=r===1?r+2*i:r-e+2*i,r?n>0?n:1:0}function scaleWholeRangeSize(r,e,i,n){return i===1&&(i=0),bandSpace(r,i,n)*(e/(1-i))}function calculateBandwidthFromWholeRangeSize(r,e,i,n,o){const l=bandSpace(r,i,n);let d=e/Math.max(1,l||1);o&&(d=Math.floor(d));let u=d*(1-i);return o&&(u=Math.round(u)),u}function calculateWholeRangeFromRangeFactor(r,e){const i=(r[1]-r[0])/(e[1]-e[0]),n=r[0]-i*e[0];return[n,i+n]}function polymap(r,e,i){const n=Math.min(r.length,e.length)-1,o=new Array(n),l=new Array(n);let d=-1;for(r[n]<r[0]&&(r=r.slice().reverse(),e=e.slice().reverse());++d<n;)o[d]=normalize(r[d],r[d+1]),l[d]=i(e[d],e[d+1]);return function(u){const f=bisect(r,u,1,n)-1;return l[f](o[f](u))}}const nice=(r,e)=>{const i=r.slice();let n=0,o=i.length-1,l=i[n],d=i[o];return d<l&&([n,o]=[o,n],[l,d]=[d,l]),i[n]=e.floor(l),i[o]=e.ceil(d),i},niceNumber=(r,e=!1)=>{const i=Math.floor(Math.log10(r)),n=r/Math.pow(10,i);let o;return o=e?n<1.5?1:n<3?2:n<7?5:10:n<=1?1:n<=2?2:n<=5?5:10,o*Math.pow(10,i)},restrictNumber=(r,e)=>{let i,n;return e[0]<e[1]?(i=e[0],n=e[1]):(i=e[1],n=e[0]),Math.min(Math.max(r,i),n)};class BaseScale{constructor(){this._rangeFactorStart=null,this._rangeFactorEnd=null}_calculateWholeRange(e){return this._wholeRange?this._wholeRange:isValid(this._rangeFactorStart)&&isValid(this._rangeFactorEnd)&&e.length===2?(this._wholeRange=calculateWholeRangeFromRangeFactor(e,[this._rangeFactorStart,this._rangeFactorEnd]),this._wholeRange):e}rangeFactor(e,i,n){return e?(e.length===2&&e.every(o=>o>=0&&o<=1)&&(this._wholeRange=null,e[0]===0&&e[1]===1?(this._rangeFactorStart=null,this._rangeFactorEnd=null):(this._rangeFactorStart=e[0],this._rangeFactorEnd=e[1])),this):n?(this._wholeRange=null,this._rangeFactorStart=null,this._rangeFactorEnd=null,this):isValid(this._rangeFactorStart)&&isValid(this._rangeFactorEnd)?[this._rangeFactorStart,this._rangeFactorEnd]:null}rangeFactorStart(e,i){var n;return isNil(e)?this._rangeFactorStart:(e>=0&&e<=1&&(this._wholeRange=null,e!==0||!isNil(this._rangeFactorEnd)&&this._rangeFactorEnd!==1?(this._rangeFactorStart=e,this._rangeFactorEnd=(n=this._rangeFactorEnd)!==null&&n!==void 0?n:1):(this._rangeFactorStart=null,this._rangeFactorEnd=null)),this)}rangeFactorEnd(e,i){var n;return isNil(e)?this._rangeFactorEnd:(e>=0&&e<=1&&(this._wholeRange=null,e!==0||!isNil(this._rangeFactorStart)&&this._rangeFactorStart!==0?(this._rangeFactorEnd=e,this._rangeFactorStart=(n=this._rangeFactorStart)!==null&&n!==void 0?n:0):(this._rangeFactorStart=null,this._rangeFactorEnd=null)),this)}generateFishEyeTransform(){var e;if(!this._fishEyeOptions)return void(this._fishEyeTransform=null);const{distortion:i=2,radiusRatio:n=.1,radius:o}=this._fishEyeOptions,l=this.range(),d=l[0],u=l[l.length-1],f=Math.min(d,u),g=Math.max(d,u),_=clamp((e=this._fishEyeOptions.focus)!==null&&e!==void 0?e:0,f,g),y=isNil(o)?(g-f)*n:o;let b=Math.exp(i);b=b/(b-1)*y;const S=i/y;this._fishEyeTransform=v=>{const A=Math.abs(v-_);if(A>=y)return v;if(A<=1e-6)return _;const x=b*(1-Math.exp(-A*S))/A*.75+.25;return _+(v-_)*x}}unknown(e){return arguments.length?(this._unknown=e,this):this._unknown}get(e,i){var n;return(n=this==null?void 0:this[e])!==null&&n!==void 0?n:i}}const implicit=Symbol("implicit");class OrdinalScale extends BaseScale{specified(e){var i;return e?(this._specified=Object.assign((i=this._specified)!==null&&i!==void 0?i:{},e),this):Object.assign({},this._specified)}_getSpecifiedValue(e){if(this._specified)return this._specified[e]}constructor(){super(),this.type=ScaleEnum.Ordinal,this._index=new Map,this._domain=[],this._ordinalRange=[],this._unknown=implicit}clone(){const e=new OrdinalScale().domain(this._domain).range(this._ordinalRange).unknown(this._unknown);return this._specified&&e.specified(this._specified),e}calculateVisibleDomain(e){return isValid(this._rangeFactorStart)&&isValid(this._rangeFactorEnd)&&e.length===2?[this.invert(e[0]),this.invert(e[1])]:this._domain}scale(e){const i=`${e}`,n=this._getSpecifiedValue(i);if(n!==void 0)return n;let o=this._index.get(i);if(!o){if(this._unknown!==implicit)return this._unknown;o=this._domain.push(e),this._index.set(i,o)}const l=this._ordinalRange[(o-1)%this._ordinalRange.length];return this._fishEyeTransform?this._fishEyeTransform(l):l}invert(e){let i=0;for(;i<this._ordinalRange.length&&this._ordinalRange[i]!==e;)i++;return this._domain[(i-1)%this._domain.length]}domain(e){if(!e)return this._domain.slice();this._domain=[],this._index=new Map;for(const i of e){const n=`${i}`;this._index.has(n)||this._index.set(n,this._domain.push(i))}return this}range(e){if(!e)return this._ordinalRange.slice();const i=Array.from(e);return this._ordinalRange=i,this}index(e){var i;return this._index&&(i=this._index.get(`${e}`))!==null&&i!==void 0?i:-1}}function generateTicks(r,e,i,n){const o=[];let l=r;for(;l<=e;)o.push(l),l+=i;return n&&o.reverse(),o}function ticks$1(r,e,i,n){let o,l;if(e=Math.floor(+e),r=Math.floor(+r),!(i=Math.floor(+i)))return[];if(r===e)return[r];if(o=e<r){const u=r;r=e,e=u}let d=clamper(1,e-r+1)(i);if(l=Math.floor((e-r+1)/d),!n)for(;Math.ceil((e-r+1)/l)>i&&d>1;)d-=1,l=Math.floor((e-r)/d);return generateTicks(r,e,l,o)}function stepTicks$1(r,e,i){let n;if(e=Math.floor(+e),r=Math.floor(+r),i=clamper(1,e-r+1)(Math.floor(+i)),n=e<r){const o=r;r=e,e=o}return generateTicks(r,e,i,n)}class BandScale extends OrdinalScale{constructor(e){super(),this.type=ScaleEnum.Band,this._range=[0,1],this._step=void 0,this._bandwidth=void 0,this._isFixed=!1,this._round=!1,this._paddingInner=0,this._paddingOuter=0,this._align=.5,this._unknown=void 0,delete this.unknown,this.rescale(e)}rescale(e,i){if(e)return this;this._wholeRange=null;const n=this._calculateWholeRange(this._range,i),o=super.domain().length,l=n[1]<n[0];let d=n[Number(l)-0];const u=n[1-Number(l)],f=bandSpace(o,this._paddingInner,this._paddingOuter);return this._step=(u-d)/Math.max(1,f||1),this._round&&(this._step=Math.floor(this._step)),d+=(u-d-this._step*(o-this._paddingInner))*this._align,this.isBandwidthFixed()||(this._bandwidth=this._step*(1-this._paddingInner)),this._round&&(d=Math.round(d),this.isBandwidthFixed()||(this._bandwidth=Math.round(this._bandwidth))),this._bandRangeState={reverse:l,start:l?d+this._step*(o-1):d,count:o},this.generateFishEyeTransform(),this}scale(e){if(!this._bandRangeState)return;const i=`${e}`,n=this._getSpecifiedValue(i);if(n!==void 0)return n;let o=this._index.get(i);if(!o){if(this._unknown!==implicit)return this._unknown;o=this._domain.push(e),this._index.set(i,o)}const{count:l,start:d,reverse:u}=this._bandRangeState,f=d+(u?-1:1)*((o-1)%l)*this._step;return this._fishEyeTransform?this._fishEyeTransform(f):f}_calculateWholeRange(e,i){if(this._wholeRange)return this._wholeRange;if((this._minBandwidth||this._maxBandwidth)&&!this._isBandwidthFixedByUser()){let n;if(isValid(this._rangeFactorStart)&&isValid(this._rangeFactorEnd)&&e.length===2){const l=calculateWholeRangeFromRangeFactor(e,[this._rangeFactorStart,this._rangeFactorEnd]);n=Math.abs(l[1]-l[0])}else n=Math.abs(e[1]-e[0]);const o=calculateBandwidthFromWholeRangeSize(super.domain().length,n,this._paddingInner,this._paddingOuter,this._round);o<this._minBandwidth?(this._bandwidth=this._minBandwidth,this._isFixed=!0):o>this._maxBandwidth?(this._bandwidth=this._maxBandwidth,this._isFixed=!0):(this._bandwidth=o,this._isFixed=!1)}if(this.isBandwidthFixed()){const n=scaleWholeRangeSize(super.domain().length,this._bandwidth,this._paddingInner,this._paddingOuter)*Math.sign(e[1]-e[0]),o=Math.min((e[1]-e[0])/n,1);if(isValid(this._rangeFactorStart)&&isValid(this._rangeFactorEnd)){const l=this._rangeFactorStart+o<=1,d=this._rangeFactorEnd-o>=0;if(i==="rangeFactorStart"&&l?this._rangeFactorEnd=this._rangeFactorStart+o:i==="rangeFactorEnd"&&d?this._rangeFactorStart=this._rangeFactorEnd-o:e[0]<=e[1]?l?this._rangeFactorEnd=this._rangeFactorStart+o:d?this._rangeFactorStart=this._rangeFactorEnd-o:(this._rangeFactorStart=0,this._rangeFactorEnd=o):d?this._rangeFactorStart=this._rangeFactorEnd-o:l?this._rangeFactorEnd=this._rangeFactorStart+o:(this._rangeFactorStart=1-o,this._rangeFactorEnd=1),n>0){const u=e[0]-n*this._rangeFactorStart,f=u+n;this._wholeRange=[u,f]}else{const u=e[1]+n*(1-this._rangeFactorEnd),f=u-n;this._wholeRange=[f,u]}}else this._rangeFactorStart=0,this._rangeFactorEnd=o,this._wholeRange=[e[0],e[0]+n];return this._wholeRange}return super._calculateWholeRange(e)}calculateWholeRangeSize(){const e=this._calculateWholeRange(this._range);return Math.abs(e[1]-e[0])}calculateVisibleDomain(e){const i=this._domain;if(isValid(this._rangeFactorStart)&&isValid(this._rangeFactorEnd)&&i.length){const n=this._getInvertIndex(e[0]),o=this._getInvertIndex(e[1]);return i.slice(Math.min(n,o),Math.max(n,o)+1)}return i}domain(e,i){return e?(super.domain(e),this.rescale(i)):super.domain()}range(e,i){return e?(this._range=[toNumber(e[0]),toNumber(e[1])],this.rescale(i)):this._range}rangeRound(e,i){return this._range=[toNumber(e[0]),toNumber(e[1])],this._round=!0,this.rescale(i)}ticks(e=10){const i=this.calculateVisibleDomain(this._range);return e===-1?i:ticks$1(0,i.length-1,e,!1).map(n=>i[n])}tickData(e=10){return this.ticks(e).map((i,n)=>({index:n,tick:i,value:(this.scale(i)-this._range[0]+this._bandwidth/2)/(this._range[1]-this._range[0])}))}forceTicks(e=10){const i=this.calculateVisibleDomain(this._range);return ticks$1(0,i.length-1,e,!0).filter(n=>n<i.length).map(n=>i[n])}stepTicks(e){const i=this.calculateVisibleDomain(this._range);return stepTicks$1(0,i.length-1,e).map(n=>i[n])}_getInvertIndex(e){let i=0;const n=this.step()/2,o=this.bandwidth()/2,l=this._domain.length,d=this.range(),u=d[0]>d[d.length-1];for(i=0;i<l;i++){const f=this.scale(this._domain[i])+o;if(i===0&&(!u&&!isGreater(e,f+n)||u&&!isLess(e,f-n))||i===l-1||!isLess(e,f-n)&&!isGreater(e,f+n))break}return i>=0&&i<=l-1?i:l-1}invert(e){return this._domain[this._getInvertIndex(e)]}padding(e,i){return e!==void 0?(this._paddingOuter=Math.max(0,Math.min(Array.isArray(e)?Math.min.apply(null,e):e)),this._paddingInner=this._paddingOuter,this.rescale(i)):this._paddingInner}paddingInner(e,i){return e!==void 0?(this._paddingInner=Math.max(0,Math.min(1,e)),this.rescale(i)):this._paddingInner}paddingOuter(e,i){return e!==void 0?(this._paddingOuter=Math.max(0,Math.min(1,e)),this.rescale(i)):this._paddingOuter}step(){return this._step}round(e,i){return e!==void 0?(this._round=e,this.rescale(i)):this._round}align(e,i){return e!==void 0?(this._align=Math.max(0,Math.min(1,e)),this.rescale(i)):this._align}rangeFactor(e,i){return e?(super.rangeFactor(e),this.rescale(i)):super.rangeFactor()}rangeFactorStart(e,i){return isNil(e)?super.rangeFactorStart():(super.rangeFactorStart(e),this.rescale(i,"rangeFactorStart"))}rangeFactorEnd(e,i){return isNil(e)?super.rangeFactorEnd():(super.rangeFactorEnd(e),this.rescale(i,"rangeFactorEnd"))}bandwidth(e,i){return e?(e==="auto"?(this._bandwidth=void 0,this._isFixed=!1):(this._bandwidth=e,this._isFixed=!0),this._userBandwidth=e,this.rescale(i)):this._bandwidth}maxBandwidth(e,i){return e?(this._maxBandwidth=e==="auto"?void 0:e,this.rescale(i)):this._maxBandwidth}minBandwidth(e,i){return e?(this._minBandwidth=e==="auto"?void 0:e,this.rescale(i)):this._minBandwidth}fishEye(e,i,n){return e||n?(this._fishEyeOptions=e,this._fishEyeTransform=null,this.rescale(i)):this._fishEyeOptions}isBandwidthFixed(){return this._isFixed&&!!this._bandwidth}_isBandwidthFixedByUser(){return this._isFixed&&this._userBandwidth&&isNumber(this._userBandwidth)}clone(){var e,i,n;return new BandScale(!0).domain(this._domain,!0).range(this._range,!0).round(this._round,!0).paddingInner(this._paddingInner,!0).paddingOuter(this._paddingOuter,!0).align(this._align,!0).bandwidth((e=this._userBandwidth)!==null&&e!==void 0?e:"auto",!0).maxBandwidth((i=this._maxBandwidth)!==null&&i!==void 0?i:"auto",!0).minBandwidth((n=this._maxBandwidth)!==null&&n!==void 0?n:"auto")}}const{interpolateRgb}=ColorUtil;function interpolate(r,e){const i=typeof e;let n;if(isNil(e)||i==="boolean")return()=>e;if(i==="number")return interpolateNumber(r,e);if(i==="string"){if(n=Color.parseColorString(e)){const o=interpolateRgb(Color.parseColorString(r),n);return l=>o(l).formatRgb()}return interpolateNumber(Number(r),Number(e))}return e instanceof RGB?interpolateRgb(r,e):e instanceof Color?interpolateRgb(r.color,e.color):e instanceof Date?interpolateDate(r,e):interpolateNumber(Number(r),Number(e))}class ContinuousScale extends BaseScale{constructor(e=identity,i=identity){super(),this._unknown=void 0,this.transformer=e,this.untransformer=i,this._forceAlign=!0,this._domain=[0,1],this._range=[0,1],this._clamp=identity,this._piecewise=bimap,this._interpolate=interpolate}calculateVisibleDomain(e){var i;return isValid(this._rangeFactorStart)&&isValid(this._rangeFactorEnd)&&e.length===2?[this.invert(e[0]),this.invert(e[1])]:(i=this._niceDomain)!==null&&i!==void 0?i:this._domain}fishEye(e,i,n){return e||n?(this._fishEyeOptions=e,this._fishEyeTransform=null,this.rescale(i)):this._fishEyeOptions}scale(e){var i;if(e=Number(e),Number.isNaN(e)||this._domainValidator&&!this._domainValidator(e))return this._unknown;this._output||(this._output=this._piecewise(((i=this._niceDomain)!==null&&i!==void 0?i:this._domain).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));const n=this._output(this.transformer(this._clamp(e)));return this._fishEyeTransform?this._fishEyeTransform(n):n}invert(e){var i;return this._input||(this._input=this._piecewise(this._calculateWholeRange(this._range),((i=this._niceDomain)!==null&&i!==void 0?i:this._domain).map(this.transformer),interpolateNumber)),this._clamp(this.untransformer(this._input(e)))}domain(e,i){var n;if(!e)return((n=this._niceDomain)!==null&&n!==void 0?n:this._domain).slice();this._domainValidator=null,this._niceType=null,this._niceDomain=null;const o=Array.from(e,toNumber);return this._domain=o,this.rescale(i)}range(e,i){if(!e)return this._range.slice();const n=Array.from(e);return this._range=n,this.rescale(i)}rangeRound(e,i){const n=Array.from(e);return this._range=n,this._interpolate=interpolateNumberRound,this.rescale(i)}rescale(e){var i;if(e)return this;const n=(i=this._niceDomain)!==null&&i!==void 0?i:this._domain,o=n.length,l=this._range.length;let d=Math.min(o,l);if(o&&o<l&&this._forceAlign){const u=l-o+1,f=n[o-1],g=o>=2?(f-n[o-2])/u:0;for(let _=1;_<=u;_++)n[o-2+_]=f-g*(u-_);d=l}return this._autoClamp&&(this._clamp=clamper(n[0],n[d-1])),this._piecewise=d>2?polymap:bimap,this._output=this._input=null,this._wholeRange=null,this.generateFishEyeTransform(),this}clamp(e,i,n){return arguments.length?(i?(this._autoClamp=!1,this._clamp=i):(this._autoClamp=!!e,this._clamp=e?void 0:identity),this.rescale(n)):this._clamp!==identity}interpolate(e,i){return arguments.length?(this._interpolate=e,this.rescale(i)):this._interpolate}ticks(e=10){return[]}tickData(e=10){const i=this.ticks(e);return(i??[]).map((n,o)=>({index:o,tick:n,value:(this.scale(n)-this._range[0])/(this._range[1]-this._range[0])}))}rangeFactor(e,i){return e?(super.rangeFactor(e),this._output=this._input=null,this):super.rangeFactor()}rangeFactorStart(e,i){return isNil(e)?super.rangeFactorStart():(super.rangeFactorStart(e),this._output=this._input=null,this)}rangeFactorEnd(e,i){return isNil(e)?super.rangeFactorEnd():(super.rangeFactorEnd(e),this._output=this._input=null,this)}forceAlignDomainRange(e){return arguments.length?(this._forceAlign=e,this):this._forceAlign}}const e10$1=Math.sqrt(50),e5$1=Math.sqrt(10),e2$1=Math.sqrt(2),niceNumbers=[1,2,5,10],calculateTicksOfSingleValue=(r,e,i)=>{let n=1,o=r;const l=Math.floor((e-1)/2),d=Math.abs(r);return r>=0&&r<=Number.MIN_VALUE?o=0:r<0&&r>=-Number.MIN_VALUE?o=-(e-1):!i&&d<1?n=getNickStep(d).step:(i||d>1)&&(o=Math.floor(r)-l*n),n>0?(r>0?o=Math.max(o,0):r<0&&(o=Math.min(o,-(e-1)*n)),range(0,e).map(u=>o+u*n)):r>0?calculateTicksByStep(0,-(e-1)/n,n):calculateTicksByStep((e-1)/n,0,n)},d3Ticks=memoize((r,e,i,n)=>{let o,l,d,u,f=-1;if(i=+i,(r=+r)==(e=+e))return[r];if(Math.abs(r-e)<=Number.MIN_VALUE&&i>0)return[r];if((o=e<r)&&(l=r,r=e,e=l),u=tickIncrement(r,e,i).step,!isFinite(u))return[];if(u>0){let g=Math.round(r/u),_=Math.round(e/u);for(g*u<r&&++g,_*u>e&&--_,d=new Array(l=_-g+1);++f<l;)d[f]=(g+f)*u}else if(u<0&&(n!=null&&n.noDecimals)){u=1;const g=Math.ceil(r),_=Math.floor(e);if(!(g<=_))return[];for(d=new Array(l=_-g+1);++f<l;)d[f]=g+f}else{u=-u;let g=Math.round(r*u),_=Math.round(e*u);for(g/u<r&&++g,_/u>e&&--_,d=new Array(l=_-g+1);++f<l;)d[f]=(g+f)/u}return o&&d.reverse(),d}),calculateTicksByStep=(r,e,i)=>{let n,o,l=-1;if(i>0){let d=Math.floor(r/i),u=Math.ceil(e/i);for((d+1)*i<r&&++d,(u-1)*i>e&&--u,o=new Array(n=u-d+1);++l<n;)o[l]=(d+l)*i}else{i=-i;let d=Math.floor(r*i),u=Math.ceil(e*i);for((d+1)/i<r&&++d,(u-1)/i>e&&--u,o=new Array(n=u-d+1);++l<n;)o[l]=(d+l)/i}return o},appendTicksToCount=(r,e,i)=>{let n;const o=r[0],l=r[r.length-1],d=e-r.length;if(l<=0){const g=[];for(n=d;n>=1;n--)g.push(o-n*i);return g.concat(r)}if(o>=0){for(n=1;n<=d;n++)r.push(l+n*i);return r}let u=[];const f=[];for(n=1;n<=d;n++)n%2==0?u=[o-Math.floor(n/2)*i].concat(u):f.push(l+Math.ceil(n/2)*i);return u.concat(r).concat(f)},ticks=memoize((r,e,i,n)=>{let o,l,d;if(i=+i,(r=+r)==(e=+e)||Math.abs(r-e)<=Number.MIN_VALUE&&i>0)return calculateTicksOfSingleValue(r,i,n==null?void 0:n.noDecimals);(o=e<r)&&(d=r,r=e,e=d);const u=tickIncrement(r,e,i);let f=u.step;if(!isFinite(f))return[];if(f>0){let g=1;const{power:_,gap:y}=u,b=y===10?2*10**_:1*10**_;for(;g<=5&&(l=calculateTicksByStep(r,e,f),l.length>i+1)&&i>2;)f+=b,g+=1;i>2&&l.length<i-1&&(l=appendTicksToCount(l,i,f))}else n!=null&&n.noDecimals&&f<0&&(f=1),l=calculateTicksByStep(r,e,f);return o&&l.reverse(),l}),getNickStep=r=>{const e=Math.floor(Math.log(r)/Math.LN10),i=r/10**e;let n=niceNumbers[0];return i>=e10$1?n=niceNumbers[3]:i>=e5$1?n=niceNumbers[2]:i>=e2$1&&(n=niceNumbers[1]),e>=0?{step:n*10**e,gap:n,power:e}:{step:-(10**-e)/n,gap:n,power:e}};function tickIncrement(r,e,i){const n=(e-r)/Math.max(0,i);return getNickStep(n)}function forceTicks(r,e,i){let n;if(i=+i,(r=+r)==(e=+e)&&i>0)return[r];if(i<=0||(n=forceTickIncrement(r,e,i))===0||!isFinite(n))return[];const o=new Array(i);for(let l=0;l<i;l++)o[l]=r+l*n;return o}function forceTickIncrement(r,e,i){return(e-r)/Math.max(1,i-1)}function stepTicks(r,e,i){let n,o,l=-1;if(i=+i,(o=(e=+e)<(r=+r))&&(n=r,r=e,e=n),!isFinite(i)||e-r<=i)return[r];const d=Math.floor((e-r)/i+1),u=new Array(d);for(;++l<d;)u[l]=r+l*i;return o&&u.reverse(),u}function niceLinear(r,e=10){let i,n,o=0,l=r.length-1,d=r[o],u=r[l],f=10;for(u<d&&(n=d,d=u,u=n,n=o,o=l,l=n);f-- >0;){if(n=tickIncrement(d,u,e).step,n===i)return r[o]=d,r[l]=u,r;if(n>0)d=Math.floor(d/n)*n,u=Math.ceil(u/n)*n;else{if(!(n<0))break;d=Math.ceil(d*n)/n,u=Math.floor(u*n)/n}i=n}}function parseNiceOptions(r,e){const i=isNumber(e.forceMin),n=isNumber(e.forceMax);let o=null;const l=[];let d=null;const u=i&&n?f=>f>=e.forceMin&&f<=e.forceMax:i?f=>f>=e.forceMin:n?f=>f<=e.forceMax:null;return i?l[0]=e.forceMin:isNumber(e.min)&&e.min<=Math.min(r[0],r[r.length-1])&&(l[0]=e.min),n?l[1]=e.forceMax:isNumber(e.max)&&e.max>=Math.max(r[0],r[r.length-1])&&(l[1]=e.max),isNumber(l[0])&&isNumber(l[1])?(d=r.slice(),d[0]=l[0],d[d.length-1]=l[1]):o=isNumber(l[0])||isNumber(l[1])?isNumber(l[0])?"max":"min":"all",{niceType:o,niceDomain:d,niceMinMax:l,domainValidator:u}}const fixPrecision=(r,e,i)=>Math.abs(e-r)<1?+i.toFixed(1):Math.round(+i),d3TicksForLog=memoize((r,e,i,n,o,l,d)=>{let u=r,f=e;const g=f<u;g&&([u,f]=[f,u]);let _,y,b=o(u),S=o(f),v=[];if(!(n%1)&&S-b<i){if(b=Math.floor(b),S=Math.ceil(S),u>0){for(;b<=S;++b)for(_=1;_<n;++_)if(y=b<0?_/l(-b):_*l(b),!(y<u)){if(y>f)break;v.push(y)}}else for(;b<=S;++b)for(_=n-1;_>=1;--_)if(y=b>0?_/l(-b):_*l(b),!(y<u)){if(y>f)break;v.push(y)}2*v.length<i&&(v=ticks(u,f,i))}else v=ticks(b,S,Math.min(S-b,i)).map(l);return v=v.filter(A=>A!==0),d!=null&&d.noDecimals&&(v=Array.from(new Set(v.map(A=>Math.floor(A))))),g?v.reverse():v}),ticksBaseTransform=memoize((r,e,i,n,o,l)=>{const d=[],u={},f=o(r),g=o(e);let _=[];if(Number.isInteger(n))_=ticks(f,g,i);else{const y=(g-f)/(i-1);for(let b=0;b<i;b++)_.push(f+b*y)}return _.forEach(y=>{const b=l(y),S=Number.isInteger(n)?fixPrecision(r,e,b):fixPrecision(r,e,niceNumber(b)),v=fixPrecision(r,e,restrictNumber(S,[r,e]));!u[v]&&!isNaN(v)&&_.length>1&&(u[v]=1,d.push(v))}),d}),forceTicksBaseTransform=memoize((r,e,i,n,o)=>forceTicks(n(r),n(e),i).map(l=>niceNumber(o(l))));class LinearScale extends ContinuousScale{constructor(){super(...arguments),this.type=ScaleEnum.Linear}clone(){return new LinearScale().domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate)}tickFormat(){return()=>{}}d3Ticks(e=10,i){const n=this.calculateVisibleDomain(this._range);return d3Ticks(n[0],n[n.length-1],e,i)}ticks(e=10,i){var n;if(isFunction(i==null?void 0:i.customTicks))return i.customTicks(this,e);if(isValid(this._rangeFactorStart)&&isValid(this._rangeFactorEnd)&&(this._rangeFactorStart>0||this._rangeFactorEnd<1)&&this._range.length===2||!this._niceType)return this.d3Ticks(e,i);const o=(n=this._niceDomain)!==null&&n!==void 0?n:this._domain,l=this._domain,d=o[0],u=o[o.length-1];let f=ticks(l[0],l[l.length-1],e,i);if(!f.length)return f;if(this._domainValidator)f=f.filter(this._domainValidator);else if((f[0]!==d||f[f.length-1]!==u)&&this._niceType){const g=o.slice();if(this._niceType==="all"?(g[0]=f[0],g[g.length-1]=f[f.length-1],this._niceDomain=g,this.rescale()):this._niceType==="min"&&f[0]!==d?(g[0]=f[0],this._niceDomain=g,this.rescale()):this._niceType==="max"&&f[f.length-1]!==u&&(g[g.length-1]=f[f.length-1],this._niceDomain=g,this.rescale()),this._niceType!=="all"){const _=Math.min(g[0],g[g.length-1]),y=Math.max(g[0],g[g.length-1]);f=f.filter(b=>b>=_&&b<=y)}}return f}forceTicks(e=10){const i=this.calculateVisibleDomain(this._range);return forceTicks(i[0],i[i.length-1],e)}stepTicks(e){const i=this.calculateVisibleDomain(this._range);return stepTicks(i[0],i[i.length-1],e)}nice(e=10,i){var n,o;const l=this._domain;let d=[];if(i){const u=parseNiceOptions(l,i);if(d=u.niceMinMax,this._domainValidator=u.domainValidator,this._niceType=u.niceType,u.niceDomain)return this._niceDomain=u.niceDomain,this.rescale(),this}else this._niceType="all";if(this._niceType){const u=niceLinear(l.slice(),e);this._niceType==="min"?u[u.length-1]=(n=d[1])!==null&&n!==void 0?n:u[u.length-1]:this._niceType==="max"&&(u[0]=(o=d[0])!==null&&o!==void 0?o:u[0]),this._niceDomain=u,this.rescale()}return this}niceMin(e=10){this._niceType="min";const i=this._domain[this._domain.length-1],n=niceLinear(this.domain(),e);return n&&(n[n.length-1]=i,this._niceDomain=n,this.rescale()),this}niceMax(e=10){this._niceType="max";const i=this._domain[0],n=niceLinear(this._domain.slice(),e);return n&&(n[0]=i,this._niceDomain=n,this.rescale()),this}}class LogNiceMixin{nice(e=10,i){var n,o,l,d;const u=this._domain;let f=[],g=null;if(i){const _=parseNiceOptions(u,i);if(f=_.niceMinMax,this._domainValidator=_.domainValidator,g=_.niceType,_.niceDomain)return this._niceDomain=_.niceDomain,this.rescale(),this}else g="all";if(g){const _=nice(u.slice(),(o=(n=this.getNiceConfig)===null||n===void 0?void 0:n.call(this))!==null&&o!==void 0?o:{floor:y=>Math.floor(y),ceil:y=>Math.ceil(y)});return g==="min"?_[_.length-1]=(l=f[1])!==null&&l!==void 0?l:_[_.length-1]:g==="max"&&(_[0]=(d=f[0])!==null&&d!==void 0?d:_[0]),this._niceDomain=_,this.rescale(),this}return this}niceMin(){const e=this._domain[this._domain.length-1];this.nice();const i=this._domain.slice();return this._domain&&(i[i.length-1]=e,this._niceDomain=i,this.rescale()),this}niceMax(){const e=this._domain[0];this.nice();const i=this._domain.slice();return this._domain&&(i[0]=e,this._niceDomain=i,this.rescale()),this}}function reflect(r){return e=>-r(-e)}function limitPositiveZero(r=Number.EPSILON){return e=>Math.max(e,r)}function limitNegativeZero(r=Number.EPSILON){return e=>Math.min(e,-r)}class LogScale extends ContinuousScale{constructor(){super(logp(10),powp(10)),this.type=ScaleEnum.Log,this._limit=limitPositiveZero(),this._logs=this.transformer,this._pows=this.untransformer,this._domain=[1,10],this._base=10}clone(){return new LogScale().domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate,!0).base(this._base)}rescale(e){var i;if(e)return this;super.rescale();const n=logp(this._base),o=powp(this._base);return((i=this._niceDomain)!==null&&i!==void 0?i:this._domain)[0]<0?(this._logs=reflect(n),this._pows=reflect(o),this._limit=limitNegativeZero(),this.transformer=logNegative,this.untransformer=expNegative):(this._logs=n,this._pows=o,this._limit=limitPositiveZero(),this.transformer=this._logs,this.untransformer=o),this}scale(e){var i;if(e=Number(e),Number.isNaN(e)||this._domainValidator&&!this._domainValidator(e))return this._unknown;this._output||(this._output=this._piecewise(((i=this._niceDomain)!==null&&i!==void 0?i:this._domain).map(this._limit).map(this.transformer),this._calculateWholeRange(this._range),this._interpolate));const n=this._output(this.transformer(this._limit(this._clamp(e))));return this._fishEyeTransform?this._fishEyeTransform(n):n}base(e,i){return arguments.length?(this._base=e,this.rescale(i)):this._base}tickFormat(){return identity}d3Ticks(e=10,i){const n=this.domain(),o=this._limit(n[0]),l=this._limit(n[n.length-1]);return d3TicksForLog(o,l,e,this._base,this.transformer,this.untransformer,i)}ticks(e=10){const i=this.calculateVisibleDomain(this._range);return ticksBaseTransform(this._limit(i[0]),this._limit(i[i.length-1]),e,this._base,this.transformer,this.untransformer)}forceTicks(e=10){const i=this.calculateVisibleDomain(this._range);return forceTicksBaseTransform(i[0],i[i.length-1],e,this.transformer,this.untransformer)}stepTicks(e){const i=this.calculateVisibleDomain(this._range);return forceTicksBaseTransform(this._limit(i[0]),this._limit(i[i.length-1]),e,this.transformer,this.untransformer)}getNiceConfig(){return{floor:e=>this._pows(Math.floor(this._logs(this._limit(e)))),ceil:e=>Math.abs(e)>=1?Math.ceil(e):this._pows(Math.ceil(this._logs(this._limit(e))))}}}mixin(LogScale,LogNiceMixin);class PointScale extends BandScale{constructor(e){super(!1),this.type=ScaleEnum.Point,this._padding=0,this.paddingInner(1,e),this.padding=this.paddingOuter,this.paddingInner=void 0,this.paddingOuter=void 0}}class SqrtScale extends LinearScale{constructor(){super(sqrt$1,square),this.type=ScaleEnum.Sqrt}clone(){return new SqrtScale().domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate)}}class SymlogScale extends LinearScale{constructor(){super(symlog(1),symexp(1)),this.type=ScaleEnum.Symlog,this._const=1}clone(){return new SymlogScale().domain(this._domain,!0).range(this._range,!0).unknown(this._unknown).clamp(this.clamp(),null,!0).interpolate(this._interpolate,!0).constant(this._const)}constant(e,i){return arguments.length?(this._const=e,this.transformer=symlog(e),this.untransformer=symexp(e),this.rescale(i)):this._const}d3Ticks(e=10,i){const n=this.domain(),o=n[0],l=n[n.length-1];return d3TicksForLog(o,l,e,this._const,this.transformer,this.untransformer,i)}ticks(e=10){const i=this.calculateVisibleDomain(this._range);return ticksBaseTransform(i[0],i[i.length-1],e,this._const,this.transformer,this.untransformer)}forceTicks(e=10){const i=this.calculateVisibleDomain(this._range);return forceTicksBaseTransform(i[0],i[i.length-1],e,this.transformer,this.untransformer)}stepTicks(e){const i=this.calculateVisibleDomain(this._range);return forceTicksBaseTransform(i[0],i[i.length-1],e,this.transformer,this.untransformer)}}mixin(SymlogScale,LogNiceMixin);class ThresholdScale{constructor(){this.type=ScaleEnum.Threshold,this._range=[0,1],this._domain=[.5],this.n=1}unknown(e){return arguments.length?(this._unknown=e,this):this._unknown}scale(e){return!isNil(e)&&isValidNumber(+e)?this._range[bisect(this._domain,e,0,this.n)]:this._unknown}invertExtent(e){const i=this._range.indexOf(e);return[this._domain[i-1],this._domain[i]]}domain(e){return e?(this._domain=Array.from(e),this.n=Math.min(this._domain.length,this._range.length-1),this):this._domain.slice()}range(e){return e?(this._range=Array.from(e),this.n=Math.min(this._domain.length,this._range.length-1),this):this._range.slice()}clone(){return new ThresholdScale().domain(this._domain).range(this._range).unknown(this._unknown)}}function getScaleTicks(r,e,i,n){let o;const{breakData:l}=r;if(l&&l()){const{breakDomains:d}=l(),u=e.domain();o=[];for(let f=0;f<u.length-1;f++)n(i,[u[f],u[f+1]]).forEach(g=>{d.some(_=>g>=_[0]&&g<=_[1])||o.push(g)});e.domain(u)}else o=n(i);return o}function forceItemVisible(r,e,i,n,o=!1){if(i&&!e.includes(r)){let l=e.length;if(l>1){o?e.push(r):e.unshift(r);for(let d=0;d<l;d++){const u=o?l-1-d:d;if(!n(e[u]))break;e.splice(u,1),d--,l--}}}}const continuousTicks=(r,e)=>{var i,n;if(!isContinuous(r.type))return convertDomainToTickData(r.domain());const o=r.range(),l=Math.abs(o[o.length-1]-o[0]);if(l<2)return convertDomainToTickData([r.domain()[0]]);const{tickCount:d,forceTickCount:u,tickStep:f,noDecimals:g=!1,labelStyle:_,breakData:y}=e;let b;if(isValid(f))S=r.stepTicks(f),v=y&&y()?y().breakDomains:null,b=v&&v.length?S.filter(x=>v.every(T=>x<T[0]||x>T[1])):S;else if(isValid(u))b=getScaleTicks(e,r,u,(x,T)=>T&&T.length?r.domain(T,!0).forceTicks(x):r.forceTicks(x));else if(e.tickMode==="d3"){const x=(i=isFunction(d)?d({axisLength:l,labelStyle:_}):d)!==null&&i!==void 0?i:5;b=getScaleTicks(e,r,x,(T,C)=>C&&C.length?r.domain(C,!0).d3Ticks(T,{noDecimals:g}):r.d3Ticks(T,{noDecimals:g}))}else{const x=(n=isFunction(d)?d({axisLength:l,labelStyle:_}):d)!==null&&n!==void 0?n:5,T=isFunction(e.tickMode)?e.tickMode:void 0;b=getScaleTicks(e,r,x,(C,E)=>E&&E.length?r.domain(E,!0).ticks(C,{noDecimals:g,customTicks:T}):r.ticks(C,{noDecimals:g,customTicks:T}))}var S,v;const A=r.domain();if(e.labelFirstVisible&&A[0]!==b[0]&&!b.includes(A[0])&&b.unshift(A[0]),e.labelLastVisible&&A[A.length-1]!==b[b.length-1]&&!b.includes(A[A.length-1])&&b.push(A[A.length-1]),e.sampling&&b.length>1&&(e.coordinateType==="cartesian"||e.coordinateType==="polar"&&e.axisOrientType==="radius")){const{labelGap:x=4,labelFlush:T}=e,C=6;let E;if(b.length*C>l){const D=[],O=Math.floor(b.length*C/l);b.forEach((N,V)=>{V%O!=0&&V!==b.length-1||D.push(N)}),E=getCartesianLabelBounds(r,D,e).map((N,V)=>({AABBBounds:N,value:D[V]}))}else E=getCartesianLabelBounds(r,b,e).map((D,O)=>({AABBBounds:D,value:b[O]}));const P=E[0],R=last(E),L=y&&y()?methods$1.greedy:methods$1.parity;for(;E.length>=3&&hasOverlap$1(E,x);)E=L(E,x);const w=e.labelFirstVisible;let B=e.labelLastVisible;textIntersect(P,R,x)&&E.includes(R)&&E.length>1&&w&&B&&(E.splice(E.indexOf(R),1),B=!1),forceItemVisible(P,E,w,D=>textIntersect(D,P,x)),forceItemVisible(R,E,B,D=>textIntersect(D,R,x)||!(!w||D===P)&&textIntersect(D,P,x),!0);const I=E.map(D=>D.value);I.length<3&&T&&(I.length>1&&I.pop(),last(I)!==last(b)&&I.push(last(b))),b=I}return convertDomainToTickData(b)},methods$1={parity:function(r){return r.filter((e,i)=>i%2==0)},greedy:function(r,e){let i;return r.filter((n,o)=>(!o||!textIntersect(i,n,e))&&(i=n,!0))}},getOneDimensionalLabelBounds=(r,e,i,n)=>getCartesianLabelBounds(r,e,i).map(o=>n?[o.x1,o.x2,o.width()]:[o.y1,o.y2,o.height()]),boundsOverlap=(r,e,i=0)=>Math.max(r[0],e[0])-i/2<=Math.min(r[1],e[1])+i/2,boundsDistance=(r,e)=>r[1]<e[0]?e[0]-r[1]:e[1]<r[0]?r[0]-e[1]:0,linearDiscreteTicks=(r,e)=>{var i;const n=r.domain();if(!n.length)return[];const{tickCount:o,forceTickCount:l,tickStep:d,labelGap:u=4,axisOrientType:f,labelStyle:g}=e,_=isAxisHorizontal(f),y=r.range(),b=r.calculateWholeRangeSize();if(b<2)return e.labelLastVisible?convertDomainToTickData([n[n.length-1]]):convertDomainToTickData([n[0]]);let S;if(isValid(d))S=r.stepTicks(d);else if(isValid(l))S=r.forceTicks(l);else if(isValid(o)){const v=isFunction(o)?o({axisLength:b,labelStyle:g}):o;S=r.ticks(v)}else if(e.sampling){const v=((i=e.labelStyle.fontSize)!==null&&i!==void 0?i:12)+2,A=minInArray(y),x=maxInArray(y);if(n.length<=b/v){const T=(x-A)/n.length,C=getOneDimensionalLabelBounds(r,n,e,_),E=Math.min(...C.map(R=>R[2])),P=getStep$1(n,C,u,e.labelLastVisible,Math.floor(E/T));S=r.stepTicks(P.step),e.labelLastVisible&&(P.delCount&&(S=S.slice(0,S.length-P.delCount)),S.push(n[n.length-1]))}else{const T=[n[0],n[Math.floor(n.length/2)],n[n.length-1]],C=getOneDimensionalLabelBounds(r,T,e,_);let E=null;C.forEach(R=>{E?E[2]<R[2]&&(E=R):E=R});const P=x-A-u>0?Math.ceil(n.length*(u+E[2])/(x-A-u)):n.length-1;S=r.stepTicks(P),!e.labelLastVisible||S.length&&S[S.length-1]===n[n.length-1]||(S.length&&Math.abs(r.scale(S[S.length-1])-r.scale(n[n.length-1]))<E[2]&&(S=S.slice(0,-1)),S.push(n[n.length-1]))}}else S=r.domain();return convertDomainToTickData(S)},getStep$1=(r,e,i,n,o,l)=>{let d=0,u=0,f=-1,g=Number.MAX_VALUE;const _=S=>{let v=!0,A=0;do A+S<r.length&&boundsOverlap(e[A],e[A+S],i)&&(v=!1),A+=S;while(v&&A<r.length);return v},y=binaryFuzzySearchInNumberRange(o,r.length,S=>_(S)?1:-1);let b=y;do if(b>y&&!_(b))b++;else{if(!n){u=b;break}{const S=r.length-1;let v,A=0;v=r.length%b>0?r.length-r.length%b+b:r.length;do{if(v-=b,v!==S&&!boundsOverlap(e[v],e[S],i))break;A++}while(v>0);if(v===S){u=b,d=A;break}{const x=Math.floor(r.length/b)-A+1;if(x<f)break;{f=x;const T=boundsDistance(e[v],e[S]),C=v-b>=0?boundsDistance(e[v-b],e[v]):T,E=Math.abs(T-C);if(E<g&&(g=E,u=b,d=A),T<=C)break}}}b++}while(b<=r.length);return{step:u,delCount:d}},getPolarAngleLabelBounds=(r,e,i)=>{var n;const{labelStyle:o,getRadius:l,labelOffset:d,labelFormatter:u,inside:f}=i,g=l==null?void 0:l(),_=(n=o.angle)!==null&&n!==void 0?n:0,y=initTextMeasure$1(o);return e.map(b=>{const S=u?u(b):`${b}`,{width:v,height:A}=y.quickMeasure(S),x=Math.max(v,MIN_TICK_GAP),T=Math.max(A,MIN_TICK_GAP),C=r.scale(b),E={x:0,y:0};let P=0,R=0;const L={align:o.textAlign,baseline:o.textBaseline},{x:w,y:B}=getPolarAngleLabelPosition(C,E,g,d,f);return L.align||(isNumberClose(w,E.x)?L.baseline||(L.baseline=B>E.y?"top":"bottom"):w>E.x?L.align="left":w<E.x&&(L.align="right")),P=w+(L.align==="right"?-x:L.align==="left"?0:-x/2),R=B+(L.baseline==="bottom"?-T:L.baseline==="top"?0:-T/2),new AABBBounds().set(P,R,P+x,R+T).rotate(_,P+x/2,R+T/2)})},polarAngleAxisDiscreteTicks=(r,e)=>{const{tickCount:i,forceTickCount:n,tickStep:o,getRadius:l,labelOffset:d,labelGap:u=0,labelStyle:f}=e,g=l==null?void 0:l();if(!g)return convertDomainToTickData(r.domain());let _;if(isValid(o))_=r.stepTicks(o);else if(isValid(n))_=r.forceTicks(n);else if(isValid(i)){const y=r.range(),b=Math.abs(y[y.length-1]-y[0]),S=isFunction(i)?i({axisLength:b,labelStyle:f}):i;_=r.ticks(S)}else if(e.sampling){const y=r.domain(),b=r.range(),S=getPolarAngleLabelBounds(r,y,e),v=minInArray(b),A=maxInArray(b),x=Math.abs(A-v)*(g+d)/y.length,{step:T,delCount:C}=getStep(y,S,u,Math.floor(S.reduce((E,P)=>Math.min(E,P.width(),P.height()),Number.MAX_VALUE)/x));_=r.stepTicks(T),_=_.slice(0,_.length-C)}else _=r.domain();return convertDomainToTickData(_)},getStep=(r,e,i,n)=>{let o=n;do{let d=!0;o++;let u=0;do u+o<r.length&&labelOverlap(e[u],e[u+o],i)&&(d=!1),u+=o;while(d&&u<r.length);if(d)break}while(o<=r.length);let l=0;if(r.length>2){let d=r.length-r.length%o;for(d>=r.length&&(d-=o);d>0&&labelOverlap(e[0],e[d]);)l++,d-=o}return{step:o,delCount:l}},RIGHT0=new Uint32Array(33),RIGHT1=new Uint32Array(33);RIGHT1[0]=0,RIGHT0[0]=~RIGHT1[0];for(let r=1;r<=32;++r)RIGHT1[r]=RIGHT1[r-1]<<1|1,RIGHT0[r]=~RIGHT1[r];function bitmap(r,e){const i=new Uint32Array(~~((r*e+32)/32));function n(l,d){i[l]|=d}function o(l,d){i[l]&=d}return{array:i,get:(l,d)=>{const u=d*r+l;return i[u>>>5]&1<<(31&u)},set:(l,d)=>{const u=d*r+l;n(u>>>5,1<<(31&u))},clear:(l,d)=>{const u=d*r+l;o(u>>>5,~(1<<(31&u)))},getRange:({x1:l,y1:d,x2:u,y2:f})=>{if(u<0||f<0||l>r||d>e)return!0;let g,_,y,b,S=f;for(;S>=d;--S)if(g=S*r+l,_=S*r+u,y=g>>>5,b=_>>>5,y===b){if(i[y]&RIGHT0[31&g]&RIGHT1[1+(31&_)])return!0}else{if(i[y]&RIGHT0[31&g]||i[b]&RIGHT1[1+(31&_)])return!0;for(let v=y+1;v<b;++v)if(i[v])return!0}return!1},setRange:({x1:l,y1:d,x2:u,y2:f})=>{if(u<0||f<0||l>r||d>e)return;let g,_,y,b,S;for(;d<=f;++d)if(g=d*r+l,_=d*r+u,y=g>>>5,b=_>>>5,y===b)n(y,RIGHT0[31&g]&RIGHT1[1+(31&_)]);else for(n(y,RIGHT0[31&g]),n(b,RIGHT1[1+(31&_)]),S=y+1;S<b;++S)n(S,4294967295)},clearRange:({x1:l,y1:d,x2:u,y2:f})=>{let g,_,y,b,S;for(;d<=f;++d)if(g=d*r+l,_=d*r+u,y=g>>>5,b=_>>>5,y===b)o(y,RIGHT1[31&g]|RIGHT0[1+(31&_)]);else for(o(y,RIGHT1[31&g]),o(b,RIGHT0[1+(31&_)]),S=y+1;S<b;++S)o(S,0)},outOfBounds:({x1:l,y1:d,x2:u,y2:f})=>l<0||d<0||f>=e||u>=r,toImageData:l=>{const d=l.createImageData(r,e),u=d.data;for(let f=0;f<e;++f)for(let g=0;g<r;++g){const _=f*r+g,y=4*_,b=i[_>>>5]&1<<(31&_);u[y+0]=255*b,u[y+1]=255*b,u[y+2]=255*b,u[y+3]=31}return d}}}function bitmapTool(r,e,i={top:0,left:0,right:0,bottom:0}){const{top:n=0,left:o=0,right:l=0,bottom:d=0}=i,u=Math.max(1,Math.sqrt(r*e/1e6)),f=~~((r+o+l+u)/u),g=~~((e+n+d+u)/u),_=y=>~~(y/u);return _.bitmap=()=>bitmap(f,g),_.x=y=>~~((y+o)/u),_.y=y=>~~((y+n)/u),_.ratio=u,_.padding=i,_.width=r,_.height=e,_}function clampRangeByBitmap(r,e){const{x1:i,x2:n,y1:o,y2:l}=e,d=clamp(i,0,r.width),u=clamp(n,0,r.width),f=clamp(o,0,r.height),g=clamp(l,0,r.height);return{x1:r.x(d),x2:r.x(u),y1:r.y(f),y2:r.y(g)}}function boundToRange(r,e,i=!1){return i?clampRangeByBitmap(r,e):{x1:r.x(e.x1),x2:r.x(e.x2),y1:r.y(e.y1),y2:r.y(e.y2)}}function canPlace(r,e,i,n=!0,o=0){let l=i;o>0&&(l={x1:i.x1-o,x2:i.x2+o,y1:i.y1-o,y2:i.y2+o}),l=boundToRange(r,l);const d=e.outOfBounds(l);return(!n||!d)&&(d&&(l=clampRangeByBitmap(r,l)),!e.getRange(l))}function placeToCandidates(r,e,i,n=[],o=!0,l=0,d=!1){const u=n.filter(f=>isValid(f));for(let f=0;f<u.length;f++){let g;if(g=d?i:i.clone(),g.setAttributes(u[f]),canPlace(r,e,g.AABBBounds,o,l))return e.setRange(boundToRange(r,g.AABBBounds,!0)),u[f]}return!1}function place$2(r,e,i,n,o,l,d){var u,f;const g=(u=n.overlap)===null||u===void 0?void 0:u.clampForce,_=(f=n.overlap)===null||f===void 0?void 0:f.overlapPadding;if(i.type==="bound"||i.type==="position"){if(isFunction(d)){const y=((isFunction(i.position)?i.position(o.attribute):i.position)||defaultLabelPosition(n.type)).map(S=>d(o.AABBBounds,l,S,n.offset)),b=i.restorePosition===!1;return placeToCandidates(r,e,o,y,g,_,b)}return!1}if(i.type==="moveY"){const y=(i.offset?isFunction(i.offset)?i.offset(o.attribute):i.offset:[]).map(b=>({x:o.attribute.x,y:o.attribute.y+b}));return placeToCandidates(r,e,o,y,g,_)}if(i.type==="moveX"){const y=(i.offset?isFunction(i.offset)?i.offset(o.attribute):i.offset:[]).map(b=>({x:o.attribute.x+b,y:o.attribute.y}));return placeToCandidates(r,e,o,y,g,_)}return!1}const DefaultPositions=["top","bottom","right","left","top-right","bottom-right","top-left","bottom-left"],DefaultRectPositions=["top","inside-top","inside"];function defaultLabelPosition(r){return r==="rect"?DefaultRectPositions:DefaultPositions}function clampText(r,e,i,n={}){const{x1:o,x2:l,y1:d,y2:u}=r.AABBBounds,{top:f=0,left:g=0,right:_=0,bottom:y=0}=n,b=Math.min(o,l),S=Math.max(o,l),v=Math.min(d,u),A=Math.max(d,u),x=e+_,T=i+y;let C=0,E=0;return b<0-g?C=-b:S>x&&(C=x-S),v<0-f?E=-v:A>T&&(E=T-A),{dx:C,dy:E}}const fadeIn$1=(r={})=>{var e,i,n;return{from:{opacity:0,fillOpacity:0,strokeOpacity:0},to:{opacity:(e=r.opacity)!==null&&e!==void 0?e:1,fillOpacity:(i=r.fillOpacity)!==null&&i!==void 0?i:1,strokeOpacity:(n=r.strokeOpacity)!==null&&n!==void 0?n:1}}},fadeOut$1=(r={})=>{var e,i,n;return{from:{opacity:(e=r.opacity)!==null&&e!==void 0?e:1,fillOpacity:(i=r.fillOpacity)!==null&&i!==void 0?i:1,strokeOpacity:(n=r.strokeOpacity)!==null&&n!==void 0?n:1},to:{opacity:0,fillOpacity:0,strokeOpacity:0}}},animationEffects={fadeIn:fadeIn$1,fadeOut:fadeOut$1};function getAnimationAttributes(r,e){var i,n;return(n=(i=animationEffects[e])===null||i===void 0?void 0:i.call(animationEffects,r))!==null&&n!==void 0?n:{from:{},to:{}}}function updateAnimation(r,e,i){if(!isArray(i)){const{duration:n,easing:o,increaseEffect:l=!0}=i;return r.animate().to(e.attribute,n,o),void(l&&r.type==="text"&&e.type==="text"&&playIncreaseCount(r,e,n,o))}i.forEach(n=>{const{duration:o,easing:l,increaseEffect:d=!0,channel:u}=n,{to:f}=update$1(r,e,u,n.options);isEmpty(f)||r.animate().to(f,o,l),d&&r.type==="text"&&e.type==="text"&&playIncreaseCount(r,e,o,l)})}const update$1=(r,e,i,n)=>{const o=Object.assign({},r.attribute),l=Object.assign({},e.attribute);return array(n==null?void 0:n.excludeChannels).forEach(d=>{delete l[d]}),Object.keys(l).forEach(d=>{i&&!i.includes(d)&&delete l[d]}),{from:o,to:l}};function playIncreaseCount(r,e,i,n){r.attribute.text!==e.attribute.text&&isValidNumber(Number(r.attribute.text)*Number(e.attribute.text))&&r.animate().play(new IncreaseCount({text:r.attribute.text},{text:e.attribute.text},i,n))}const DefaultLabelAnimation={mode:"same-time",duration:300,easing:"linear"};function isQuadrantLeft(r){return r===3||r===4}function isQuadrantRight(r){return r===1||r===2}function lineCirclePoints(r,e,i,n,o,l){if(r===0&&e===0||l<=0)return[];if(r===0){const b=-i/e,S=l**2-(b-o)**2;return S<0?[]:S===0?[{x:n,y:b}]:[{x:Math.sqrt(S)+n,y:b},{x:-Math.sqrt(S)+n,y:b}]}if(e===0){const b=-i/r,S=l**2-(b-n)**2;return S<0?[]:S===0?[{x:b,y:o}]:[{x:b,y:Math.sqrt(S)+o},{x:b,y:-Math.sqrt(S)+o}]}const d=(e/r)**2+1,u=2*((i/r+n)*(e/r)-o),f=u**2-4*d*((i/r+n)**2+o**2-l**2);if(f<0)return[];const g=(-u+Math.sqrt(f))/(2*d),_=(-u-Math.sqrt(f))/(2*d),y=-(e*g+i)/r;return f===0?[{x:y,y:g}]:[{x:y,y:g},{x:-(e*_+i)/r,y:_}]}function connectLineRadian(r,e){return e>2*r?NaN:2*Math.asin(e/2/r)}function checkBoundsOverlap(r,e){const{x1:i,y1:n,x2:o,y2:l}=r,{x1:d,y1:u,x2:f,y2:g}=e;return!(i<=d&&o<=d||i>=f&&o>=f||n<=u&&l<=u||n>=g&&l>=g)}const labelingPoint=(r,e,i="top",n=0)=>{if(!r)return;const{x1:o,y1:l,x2:d,y2:u}=r,f=Math.abs(d-o),g=Math.abs(u-l),_=(e.x1+e.x2)/2,y=(e.y1+e.y2)/2;let b=0,S=0,v=0,A=0;e&&(v=Math.abs(e.x1-e.x2)/2,A=Math.abs(e.y1-e.y2)/2);const x={"top-right":-235,"top-left":235,"bottom-right":45,"bottom-left":-45};switch(i){case"top":S=-1;break;case"bottom":S=1;break;case"left":b=-1;break;case"right":b=1;break;case"bottom-left":case"bottom-right":case"top-left":case"top-right":b=Math.sin(x[i]*(Math.PI/180)),S=Math.cos(x[i]*(Math.PI/180));break;case"center":b=0,S=0}return{x:_+b*(n+v)+Math.sign(b)*(f/2),y:y+S*(n+A)+Math.sign(S)*(g/2)}},getPointsOfLineArea=r=>{if(!r||!r.attribute)return[];const{points:e,segments:i}=r.attribute;if(i&&i.length){const n=[];return i.forEach(o=>{o.points.forEach(l=>{n.push(l)})}),n}return e};function labelingLineOrArea(r,e,i="end",n=0){if(!r||!e)return{x:1/0,y:1/0};const{x1:o,x2:l}=r,d=Math.abs(l-o),u=e.x1;let f=u;return i==="end"?f=u+d/2+n:i==="start"&&(f=u-d/2-n),{x:f,y:e.y1}}function connectLineBetweenBounds(r,e){if(!r||!e||isRectIntersect(r,e,!0))return;const i=Math.min(r.x1,r.x2),n=Math.min(r.y1,r.y2),o=Math.min(e.x1,e.x2),l=Math.min(e.y1,e.y2),d=Math.abs(r.x2-i)/2,u=Math.abs(r.y2-n)/2,f=Math.abs(e.x2-o)/2,g=Math.abs(e.y2-l)/2,_=i+d,y=n+u,b=o+f,S=l+g,v=b-_,A=S-y;return[getIntersection(v,A,_,y,d,u),getIntersection(-v,-A,b,S,f,g)]}function getIntersection(r,e,i,n,o,l){return Math.abs(e/r)<l/o?{x:i+(r>0?o:-o),y:n+e*o/Math.abs(r)}:{x:i+r*l/Math.abs(e),y:n+(e>0?l:-l)}}function getAlignOffset(r){return r==="left"?0:r==="right"?1:.5}function loadLabelComponent(){registerGroup(),registerText(),registerRichtext(),registerLine()}const isIntersect=(r,e)=>Math.ceil(r)>Math.floor(e),isXIntersect=([r,e],[i,n])=>n>r&&e>i;function getIntersectionLength(r,e){const[i,n]=r,[o,l]=e,d=Math.max(i,o),u=Math.min(n,l);return Math.max(0,u-d)}function shiftY(r,e){const{maxY:i=Number.MAX_VALUE,labelling:n,globalShiftY:o={enable:!0,maxIterations:10,maxError:.1,padding:1}}=e,l=r.length;if(l<=1)return r;const d=new Map,u=new Map,f=R=>u.get(R).y1Initial,g=R=>u.get(R).height,_=R=>u.get(R).y1,y=R=>u.get(R).x,b=R=>u.get(R).x1,S=R=>u.get(R).x2,v=R=>u.get(R).attempts,A=(R,L)=>{u.get(R).y1=L},x=(R,L)=>{u.get(R).attempts=L};function T(R){for(let w=R.length-1;w>=0;w--){const B=R[w],I=R[w-1],D=R[w+1];if(I&&isIntersect(_(I)+g(I),_(B))||_(B)===0&&B._isClamped){const{y:O}=n(B);D&&isIntersect(O+g(B)/2,_(D))||O+g(B)/2<=i&&A(B,_(B)+O-(L=B,u.get(L).y))}}var L}r.sort((R,L)=>R.attribute.x-L.attribute.x);for(const R of r){const{y1:L,y2:w,x1:B,x2:I}=R.AABBBounds,{x:D,y:O}=R.attribute;u.set(R,{y1Initial:L,y1:L,y2:w,y:O,height:w-L,x1:B,x2:I,x:D,attempts:0});let N=!1;for(const[V,H]of d){const{start:F,end:$}=V;if(B>=F&&I<=$)H.push(R),N=!0;else if(isNumberClose(D,y(H[0]),void 0,5)){const G={start:Math.min(F,B),end:Math.max($,I)};H.push(R),d.set(G,H),d.delete(V),N=!0}else if(getIntersectionLength([F,$],[B,I])/($-F)>.5){const G={start:Math.min(F,B),end:Math.max($,I)};H.push(R),d.set(G,H),d.delete(V),N=!0}if(N)break}N||d.set({start:B,end:I},[R])}for(const R of d.values())R.sort((L,w)=>f(L)-f(w)),T(R);if(o.enable!==!1){const{maxIterations:R=10,maxError:L=.1,padding:w=1,maxAttempts:B=1e3,deltaYTolerance:I=Number.MAX_VALUE}=o;for(let D=0;D<R;D++){r.sort((N,V)=>f(N)-f(V));let O=0;for(let N=0;N<l-1;N++){const V=r[N];if(v(V)>=B)continue;let H,F=N+1;for(;(H=r[F])&&!isXIntersect([b(V),S(V)],[b(H),S(H)]);)F+=1;if(H){const $=_(V),G=g(V),Y=_(H),Q=Y-($+G);if(Q<w){const q=(w-Q)/2;if(O=Math.max(O,q),$+q+g(H)>i){const te=$-(w-Q),ue=f(V)-te;Math.abs(ue)<=I&&(A(V,te),x(V,v(V)+1))}else if($-q<0){const te=Y+(w-Q),ue=f(H)-te;Math.abs(ue)<=I&&(A(H,te),x(H,v(H)+1))}else{const te=$-q,ue=f(V)-te,he=Y+q,fe=f(H)-he;Math.abs(ue)<=I&&Math.abs(fe)<=I&&(A(V,te),A(H,he),x(V,v(V)+1),x(H,v(H)+1))}}}}if(O<L)break}}for(const R of r){const L=R.attribute.y+_(R)-f(R);R.setAttribute("y",L)}const C=[];r.sort((R,L)=>R.attribute.x-L.attribute.x);let E=0,P=r.length-1;for(;E<=P;)E===P?C.push(r[E]):(C.push(r[E]),C.push(r[P])),E++,P--;return C}var __rest$s=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};loadLabelComponent();class LabelBase extends AbstractComponent{setBitmap(e){this._bitmap=e}setBitmapTool(e){this._bmpTool=e}constructor(e,i){const{data:n}=e,o=__rest$s(e,["data"]);super(i!=null&&i.skipDefault?e:Object.assign({data:n},merge$1({},LabelBase.defaultAttributes,o))),this.name="label",this._onHover=l=>{const d=l.target;d===this._lastHover||isEmpty(d.states)||(d.addState(StateValue.hover,!0),traverseGroup(this,u=>{u===d||isEmpty(u.states)||u.addState(StateValue.hoverReverse,!0)}),this._lastHover=d)},this._onUnHover=l=>{this._lastHover&&(traverseGroup(this,d=>{isEmpty(d.states)||(d.removeState(StateValue.hoverReverse),d.removeState(StateValue.hover))}),this._lastHover=null)},this._onClick=l=>{const d=l.target;if(this._lastSelect===d&&d.hasState("selected"))return this._lastSelect=null,void traverseGroup(this,u=>{isEmpty(u.states)||(u.removeState(StateValue.selectedReverse),u.removeState(StateValue.selected))});isEmpty(d.states)||(d.addState(StateValue.selected,!0),traverseGroup(this,u=>{u===d||isEmpty(u.states)||u.addState(StateValue.selectedReverse,!0)}),this._lastSelect=d)},this._handleRelatedGraphicSetState=l=>{var d,u,f,g,_;if(((d=l.detail)===null||d===void 0?void 0:d.type)===AttributeUpdateType.STATE||((u=l.detail)===null||u===void 0?void 0:u.type)===AttributeUpdateType.ANIMATE_UPDATE&&(!((f=l.detail.animationState)===null||f===void 0)&&f.isFirstFrameOfStep)){const y=(_=(g=l.target)===null||g===void 0?void 0:g.currentStates)!==null&&_!==void 0?_:[],b=this._isCollectionBase?[...this._graphicToText.values()]:[this._graphicToText.get(l.target)];this.updateStatesOfLabels(b,y)}}}labeling(e,i,n,o){}_getLabelLinePoints(e,i){return connectLineBetweenBounds(e.AABBBounds,i==null?void 0:i.AABBBounds)}_createLabelLine(e,i){const n=this._getLabelLinePoints(e,i);if(n){const o=graphicCreator.line({points:n}),{line:l={}}=e.attribute;if(l.customShape){const d=l.customShape;o.pathProxy=u=>d({text:e,baseMark:i},u,new CustomPath2D)}return i&&i.attribute.fill&&o.setAttribute("stroke",i.attribute.fill),this.attribute.line&&!isEmpty(this.attribute.line.style)&&o.setAttributes(this.attribute.line.style),this._setStatesOfLabelLine(o),o}}render(){if(this._prepare(),isNil(this._idToGraphic)||this._isCollectionBase&&isNil(this._idToPoint))return;const{overlap:e,smartInvert:i,dataFilter:n,customLayoutFunc:o,customOverlapFunc:l}=this.attribute;let d=this.attribute.data;if(isFunction(n)&&(d=n(d)),d&&d.length){const f=new Set;d=d.filter(g=>!f.has(g.id)&&f.add(g.id))}let u=this._initText(d);u=isFunction(o)?o(d,u,this.getRelatedGraphic.bind(this),this._isCollectionBase?f=>this._idToPoint.get(f.id):null):this._layout(u),isFunction(l)?u=l(u,this.getRelatedGraphic.bind(this),this._isCollectionBase?f=>this._idToPoint.get(f.id):null):e!==!1&&(u=this._overlapping(u)),isFunction(this.attribute.onAfterOverlapping)&&this.attribute.onAfterOverlapping(u,this.getRelatedGraphic.bind(this),this._isCollectionBase?f=>this._idToPoint.get(f.id):null),u&&u.length&&u.forEach(f=>{this._bindEvent(f),this._setStatesOfText(f)}),i!==!1&&this._smartInvert(u),this._renderLabels(u)}_bindEvent(e){if(this.attribute.disableTriggerEvent||!e)return;const{hover:i,select:n}=this.attribute;i&&(e.addEventListener("pointermove",this._onHover),e.addEventListener("pointerout",this._onUnHover)),n&&e.addEventListener("pointerdown",this._onClick)}_setStatesOfText(e){if(!e)return;const i=this.attribute.state;i&&!isEmpty(i)&&(e.states=i)}_setStatesOfLabelLine(e){if(!e)return;const i=this.attribute.labelLineState;i&&!isEmpty(i)&&(e.states=i)}_createLabelText(e){var i,n;const o=Object.assign(Object.assign({},(n=(i=this.stage)===null||i===void 0?void 0:i.getTheme())===null||n===void 0?void 0:n.text),e);return createTextGraphicByType(o,"textType")}_prepare(){var e,i;const n=[];let o;if(o=isFunction(this.attribute.getBaseMarks)?this.attribute.getBaseMarks():getMarksByName(this.getRootNode(),this.attribute.baseMarkGroupName),o.forEach(d=>{d.releaseStatus!=="willRelease"&&n.push(d)}),(e=this._idToGraphic)===null||e===void 0||e.clear(),(i=this._idToPoint)===null||i===void 0||i.clear(),this._baseMarks=n,this._isCollectionBase=this.attribute.type==="line-data",!n||n.length===0)return;const{data:l}=this.attribute;if(l&&l.length!==0){if(this._idToGraphic||(this._idToGraphic=new Map),this._isCollectionBase){this._idToPoint||(this._idToPoint=new Map);let d=0;for(let u=0;u<n.length;u++){const f=n[u],g=getPointsOfLineArea(f);if(g&&g.length)for(let _=0;_<g.length;_++){const y=l[d];y&&g[_]&&(isValid(y.id)||(y.id=`vrender-component-${this.name}-${d}`),this._idToPoint.set(y.id,g[_]),this._idToGraphic.set(y.id,f)),d++}}}else for(let d=0;d<n.length;d++){const u=l[d],f=n[d];u&&f&&(isValid(u.id)||(u.id=`vrender-component-${this.name}-${d}`),this._idToGraphic.set(u.id,f))}if(this.attribute.animation!==!1){const{animation:d,animationEnter:u,animationExit:f,animationUpdate:g}=this.attribute,_=isObject$1(d)?d:{};this._animationConfig={enter:u!==!1&&merge$1({},DefaultLabelAnimation,_,u??{}),exit:f!==!1&&merge$1({},DefaultLabelAnimation,_,f??{}),update:g!==!1&&(isArray(g)?g:merge$1({},DefaultLabelAnimation,_,g??{}))}}else this._animationConfig={enter:!1,exit:!1,update:!1}}}getRelatedGraphic(e){return this._idToGraphic.get(e.id)}_initText(e=[]){const{textStyle:i={}}=this.attribute,n=[];for(let o=0;o<e.length;o++){const l=e[o],d=this.getRelatedGraphic(l);if(!d)continue;const u=Object.assign(Object.assign({fill:this._isCollectionBase?isArray(d.attribute.stroke)?d.attribute.stroke.find(g=>!!g&&g!==!0):d.attribute.stroke:d.attribute.fill},i),l),f=this._createLabelText(u);n.push(f)}return n}_layout(e){const{position:i,offset:n}=this.attribute;for(let o=0;o<e.length;o++){const l=e[o];if(!l)return;const d=l.attribute,u=this.getRelatedGraphic(d);if(!u)continue;l.attachedThemeGraphic=this;const f=this.getGraphicBounds(l);l.attachedThemeGraphic=null;const g=isFunction(i)?i(d):i,_=this._isCollectionBase?this.getGraphicBounds(null,this._idToPoint.get(d.id),g):this.getGraphicBounds(u,{x:d.x,y:d.y},g),y=this.labeling(f,_,g,n);y&&l.setAttributes(y)}return e}_overlapping(e){var i,n,o;if(e.length===0)return[];const l=isObject$1(this.attribute.overlap)?this.attribute.overlap:{},d=this.getBaseMarkGroup(),u=(i=l.size)!==null&&i!==void 0?i:{width:(n=d==null?void 0:d.AABBBounds.width())!==null&&n!==void 0?n:0,height:(o=d==null?void 0:d.AABBBounds.height())!==null&&o!==void 0?o:0};if(u.width===0||u.height===0)return e;const{strategy:f,priority:g}=l,_=this._bmpTool||bitmapTool(u.width,u.height),y=this._bitmap||_.bitmap();return g&&(e=e.sort((b,S)=>g(S.attribute.data)-g(b.attribute.data))),(f==null?void 0:f.type)==="shiftY"?this._overlapGlobal(e,l,_,y):this._overlapByStrategy(e,l,_,y)}_overlapGlobal(e,i,n,o){let l=e.filter(_=>_.attribute.visible&&_.attribute.opacity!==0);const{clampForce:d=!0,hideOnHit:u=!0,overlapPadding:f,strategy:g}=i;if(d)for(let _=0;_<l.length;_++){const y=e[_],{dx:b=0,dy:S=0}=clampText(y,n.width,n.height,n.padding);b===0&&S===0||(y.setAttributes({x:y.attribute.x+b,y:y.attribute.y+S}),y._isClamped=!0)}l=shiftY(l,Object.assign(Object.assign({maxY:n.height},g),{labelling:_=>{const y=this.getRelatedGraphic(_.attribute),b=this._isCollectionBase?this.getGraphicBounds(null,this._idToPoint.get(_.attribute.id)):this.getGraphicBounds(y,_);return this.labeling(_.AABBBounds,b,"bottom",this.attribute.offset)}}));for(let _=0;_<l.length;_++){const y=l[_],b=y.AABBBounds,S=boundToRange(n,b,!0);if(canPlace(n,o,b,d,f))o.setRange(S);else{if(d&&this._processClampForce(y,n,o,f))continue;u?y.setAttributes({visible:!1}):o.setRange(S)}}return l}_processClampForce(e,i,n,o=0){const{dy:l=0,dx:d=0}=clampText(e,i.width,i.height,i.padding);if(d===0&&l===0){if(canPlace(i,n,e.AABBBounds,!1,o))return n.setRange(boundToRange(i,e.AABBBounds,!0)),!0}else if(canPlace(i,n,{x1:e.AABBBounds.x1+d,x2:e.AABBBounds.x2+d,y1:e.AABBBounds.y1+l,y2:e.AABBBounds.y2+l}))return e.setAttributes({x:e.attribute.x+d,y:e.attribute.y+l}),n.setRange(boundToRange(i,e.AABBBounds,!0)),!0;return!1}_overlapByStrategy(e,i,n,o){var l;const{avoidBaseMark:d,strategy:u=[],hideOnHit:f=!0,clampForce:g=!0,avoidMarks:_=[],overlapPadding:y}=i,b=[],S=u.some(v=>v.type==="bound");d&&((l=this._baseMarks)===null||l===void 0||l.forEach(v=>{v.AABBBounds&&o.setRange(boundToRange(n,v.AABBBounds,!0))})),_.length>0&&_.forEach(v=>{isString(v)?getNoneGroupMarksByName(this.getRootNode(),v).forEach(A=>{A.AABBBounds&&o.setRange(boundToRange(n,A.AABBBounds,!0))}):v.AABBBounds&&o.setRange(boundToRange(n,v.AABBBounds,!0))});for(let v=0;v<e.length;v++){if(e[v].attribute.visible===!1)continue;const A=e[v],x=this.getRelatedGraphic(A.attribute);if(A.update(),!isRectIntersect(x.AABBBounds,{x1:0,x2:n.width,y1:0,y2:n.height},!0))continue;if(canPlace(n,o,A.AABBBounds,g,y)){if(!S){o.setRange(boundToRange(n,A.AABBBounds,!0)),b.push(A);continue}if(S&&x&&x.AABBBounds&&this._canPlaceInside(A.AABBBounds,x.AABBBounds)){o.setRange(boundToRange(n,A.AABBBounds,!0)),b.push(A);continue}}let T=!1;for(let C=0;C<u.length;C++)if(T=place$2(n,o,u[C],this.attribute,A,this._isCollectionBase?this.getGraphicBounds(null,this._idToPoint.get(e[v].attribute.id)):this.getGraphicBounds(x,e[v].attribute),this.labeling),T!==!1){A.setAttributes({x:T.x,y:T.y}),b.push(A);break}if(!T&&g&&this._processClampForce(A,n,o,y)){b.push(A);continue}!T&&!f&&b.push(A)}return b}getBaseMarkGroup(){const{baseMarkGroupName:e}=this.attribute;if(e)return this.getRootNode().find(i=>i.name===e,!0)}getGraphicBounds(e,i={},n){if(e){if(e.attribute.visible!==!1)return e.AABBBounds;const{x:d,y:u}=e.attribute;return{x1:d,x2:d,y1:u,y2:u}}if(i&&n&&n==="inside-middle"){const{x:d,y:u,x1:f=d,y1:g=u}=i;return{x1:(d+f)/2,x2:(d+f)/2,y1:(u+g)/2,y2:(u+g)/2}}const{x:o,y:l}=i;return{x1:o,x2:o,y1:l,y2:l}}_renderLabels(e){var i;const{syncState:n}=this.attribute,o=new Map,l=this._graphicToText||new Map,d=[],u=[],{visible:f}=(i=this.attribute.line)!==null&&i!==void 0?i:{};e&&e.forEach((g,_)=>{var y;const b=this.getRelatedGraphic(g.attribute),S=this._isCollectionBase?g.attribute.id:b,v=l!=null&&l.get(S)?"update":"enter";let A;if(f&&(A=this._createLabelLine(g,b)),n&&this.updateStatesOfLabels([A?{text:g,labelLine:A}:{text:g}],(y=b.currentStates)!==null&&y!==void 0?y:[]),v==="enter")d.push(g),o.set(S,A?{text:g,labelLine:A}:{text:g}),this._addLabel({text:g,labelLine:A},d,u,_);else if(v==="update"){const x=l.get(S);l.delete(S),o.set(S,x),this._updateLabel(x,{text:g,labelLine:A})}}),this._removeLabel(l),this._graphicToText=o}_addLabel(e,i,n,o){const{text:l,labelLine:d}=e,u=this.getRelatedGraphic(l.attribute);if(this._syncStateWithRelatedGraphic(u),this._enableAnimation!==!1&&this._animationConfig.enter!==!1){if(u){const{from:f,to:g}=getAnimationAttributes(l.attribute,"fadeIn");l&&this.add(l),d&&(n.push(d),this.add(d)),this._animationConfig.enter.duration>0&&u.once("animate-bind",_=>{l.setAttributes(f),d&&d.setAttributes(f);const y=this._afterRelatedGraphicAttributeUpdate(l,i,d,n,o,u,g,this._animationConfig.enter);u.on("afterAttributeUpdate",y)})}}else l&&this.add(l),d&&this.add(d)}_updateLabel(e,i){const{text:n,labelLine:o}=e,{text:l,labelLine:d}=i;if(this._enableAnimation!==!1&&this._animationConfig.update!==!1){const{duration:u,easing:f}=this._animationConfig.update;updateAnimation(n,l,this._animationConfig.update),o&&d&&e.labelLine.animate().to(d.attribute,u,f)}else e.text.setAttributes(l.attribute),o&&d&&e.labelLine.setAttributes(d.attribute)}_removeLabel(e){const i=n=>{this.removeChild(n.text),n.labelLine&&this.removeChild(n.labelLine)};if(this._enableAnimation!==!1&&this._animationConfig.exit!==!1){const{duration:n,easing:o}=this._animationConfig.exit;e.forEach(l=>{var d;(d=l.text)===null||d===void 0||d.animate().to(getAnimationAttributes(l.text.attribute,"fadeOut").to,n,o).onEnd(()=>{i(l)})})}else e.forEach(n=>{i(n)})}updateStatesOfLabels(e,i){e.forEach(n=>{n&&(n.text&&n.text.useStates(i),n.labelLine&&n.labelLine.useStates(i))})}_syncStateWithRelatedGraphic(e){this.attribute.syncState&&e&&e.on("afterAttributeUpdate",this._handleRelatedGraphicSetState)}_afterRelatedGraphicAttributeUpdate(e,i,n,o,l,d,u,{mode:f,duration:g,easing:_,delay:y}){const b=S=>{var v,A,x;const{detail:T}=S;if(!T)return{};const C=(v=T.animationState)===null||v===void 0?void 0:v.step;if(!(T.type===AttributeUpdateType.ANIMATE_UPDATE&&C&&!(C.type==="wait"&&((A=C.prev)===null||A===void 0?void 0:A.type)==null)))return{};if(T.type===AttributeUpdateType.ANIMATE_END)return e.setAttributes(u),void(n&&n.setAttributes(u));const E=()=>{d&&(d.onAnimateBind=void 0,d.removeEventListener("afterAttributeUpdate",b))};switch(f){case"after":T.animationState.end&&(e.animate({onStart:E}).wait(y).to(u,g,_),n&&n.animate().wait(y).to(u,g,_));break;case"after-all":l===i.length-1&&T.animationState.end&&(i.forEach(P=>{P.animate({onStart:E}).wait(y).to(u,g,_)}),o.forEach(P=>{P.animate().wait(y).to(u,g,_)}));break;default:if(this._isCollectionBase){const P=this._idToPoint.get(e.attribute.id);!P||e.animates&&e.animates.has("label-animate")||!d.containsPoint(P.x,P.y,IContainPointMode.LOCAL,(x=this.stage)===null||x===void 0?void 0:x.getPickerService())||(e.animate({onStart:E}).wait(y).to(u,g,_),n&&n.animate().wait(y).to(u,g,_))}else T.animationState.isFirstFrameOfStep&&(e.animate({onStart:E}).wait(y).to(u,g,_),n&&n.animate().wait(y).to(u,g,_))}};return b}_smartInvert(e){var i,n,o,l,d,u,f;const g=isObject$1(this.attribute.smartInvert)?this.attribute.smartInvert:{},{textType:_,contrastRatiosThreshold:y,alternativeColors:b,mode:S,interactInvertType:v}=g,A=(i=g.fillStrategy)!==null&&i!==void 0?i:"invertBase",x=(n=g.strokeStrategy)!==null&&n!==void 0?n:"base",T=(o=g.brightColor)!==null&&o!==void 0?o:"#ffffff",C=(l=g.darkColor)!==null&&l!==void 0?l:"#000000",E=(d=g.outsideEnable)!==null&&d!==void 0&&d;if(A!=="null"||x!=="null")for(let P=0;P<e.length;P++){const R=e[P];if(!R)continue;const L=this.getRelatedGraphic(R.attribute);let w=L.attribute.fill,B=R.attribute.fill;if(isObject$1(w)&&w.gradient){const V=(f=(u=w.stops)===null||u===void 0?void 0:u[0])===null||f===void 0?void 0:f.color;V&&(w=V,B=V)}const I=labelSmartInvert(B,w,_,y,b,S),D=contrastAccessibilityChecker(I,T)?T:C,O=this._canPlaceInside(R.AABBBounds,L.AABBBounds),N=!O&&R.AABBBounds&&L.AABBBounds&&L.AABBBounds.intersects(R.AABBBounds);if(O||E||N&&v==="inside"){const V=smartInvertStrategy(A,w,I,D);if(V&&R.setAttributes({fill:V}),R.attribute.lineWidth===0||R.attribute.strokeOpacity===0)continue;const H=smartInvertStrategy(x,w,I,D);H&&R.setAttributes({stroke:H})}else if(N&&v!=="none"){if(R.attribute.lineWidth===0||R.attribute.strokeOpacity===0)continue;if(R.attribute.stroke){R.setAttributes({fill:labelSmartInvert(R.attribute.fill,R.attribute.stroke,_,y,b,S)});continue}const V=smartInvertStrategy(A,w,I,D);V&&R.setAttributes({fill:V});const H=smartInvertStrategy(x,w,I,D);H&&R.setAttributes({stroke:H})}}}_canPlaceInside(e,i){return!(!e||!i)&&i.encloses(e)}setLocation(e){this.translateTo(e.x,e.y)}disableAnimation(){this._enableAnimation=!1}enableAnimation(){this._enableAnimation=!0}}LabelBase.defaultAttributes={textStyle:{fontSize:12,textAlign:"center",textBaseline:"middle",boundsPadding:[-2,-1,-2,-1]},offset:0,pickable:!1};const labelComponentMap={},registerLabelComponent=(r,e)=>{labelComponentMap[r]=e},getLabelComponent=r=>labelComponentMap[r];var __rest$r=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};class SymbolLabel extends LabelBase{constructor(e,i){const{data:n}=e,o=__rest$r(e,["data"]);super(i!=null&&i.skipDefault?e:Object.assign({data:n},merge$1({},SymbolLabel.defaultAttributes,o))),this.name="symbol-label"}labeling(e,i,n="top",o=0){return labelingPoint(e,i,n,o)}}SymbolLabel.defaultAttributes={textStyle:{fill:"#000"},position:"top",offset:5};const registerSymbolDataLabel=()=>{registerLabelComponent("symbol",SymbolLabel),registerLabelComponent("line-data",SymbolLabel)};var __rest$q=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};class RectLabel extends LabelBase{constructor(e,i){const{data:n}=e,o=__rest$q(e,["data"]);super(i!=null&&i.skipDefault?e:Object.assign({data:n},merge$1({},RectLabel.defaultAttributes,o)))}labeling(e,i,n="top",o=0){if(!e||!i)return;const{x1:l,y1:d,x2:u,y2:f}=e,g=Math.abs(u-l),_=Math.abs(f-d),{x:y,y:b}=calculateAnchorOfBounds(i,n);let S=0,v=0;const A=n.includes("inside");switch(n.includes("top")?v=A?1:-1:n.includes("bottom")?v=A?-1:1:n.includes("left")?S=A?1:-1:n.includes("right")&&(S=A?-1:1),n){case"top-right":case"bottom-right":S=-1;break;case"top-left":case"bottom-left":S=1}return{x:y+S*o+S*g/2,y:b+v*o+v*_/2}}}RectLabel.tag="rect-label",RectLabel.defaultAttributes={textStyle:{fill:"#000"},position:"top",offset:5};const registerRectDataLabel=()=>{registerLabelComponent("rect",RectLabel)};var __rest$p=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};let LineLabel$1=class Ve extends LabelBase{constructor(e,i){const{data:n}=e,o=__rest$p(e,["data"]);super(i!=null&&i.skipDefault?e:Object.assign({data:n},merge$1({},Ve.defaultAttributes,o))),this.name="line-label"}getGraphicBounds(e,i={},n="end"){if(!e||e.type!=="line"&&e.type!=="area")return super.getGraphicBounds(e,i);let o=e.attribute.points;const l=e.attribute.segments;!o&&l&&l.length&&(o=l.reduce((u,f)=>{var g;return u.concat((g=f.points)!==null&&g!==void 0?g:[])},[])),o&&o.length!==0||(o=[i]);const d=n==="start"?0:o.length-1;return o[d]?{x1:o[d].x,x2:o[d].x,y1:o[d].y,y2:o[d].y}:void 0}labeling(e,i,n="end",o=0){return labelingLineOrArea(e,i,n,o)}};LineLabel$1.defaultAttributes={textStyle:{fill:"#000"},position:"end",offset:6};const registerLineDataLabel=()=>{registerLabelComponent("line",LineLabel$1),registerLabelComponent("area",LineLabel$1)};var __rest$o=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};class ArcInfo{constructor(e,i,n,o,l,d,u,f,g){this.refDatum=e,this.center=i,this.outerCenter=n,this.quadrant=o,this.radian=l,this.middleAngle=d,this.innerRadius=u,this.outerRadius=f,this.circleCenter=g,this.labelVisible=!0}getLabelBounds(){return this.labelPosition&&this.labelSize?{x1:this.labelPosition.x-this.labelSize.width/2,y1:this.labelPosition.y-this.labelSize.height/2,x2:this.labelPosition.x+this.labelSize.width/2,y2:this.labelPosition.y+this.labelSize.height/2}:{x1:0,x2:0,y1:0,y2:0}}}class ArcLabel extends LabelBase{constructor(e,i){const{data:n}=e,o=__rest$o(e,["data"]);super(i!=null&&i.skipDefault?e:Object.assign({data:n},merge$1({},ArcLabel.defaultAttributes,o))),this.name="arc-label",this._ellipsisWidth=0,this._arcLeft=new Map,this._arcRight=new Map,this._line2MinLength=0,this._alignOffset=0}_overlapping(e){return["inside","inside-center"].includes(this.attribute.position)?super._overlapping(e):e}labeling(e,i,n="outside",o=0){if(e&&i)return{x:0,y:0}}_layout(e){var i,n,o;if(!e||!e.length)return;const l=super._layout(e),d=l.map(b=>this.getGraphicBounds(b)),u=Object.assign(Object.assign({},this.attribute.textStyle),{text:""});let f=1/0;if(u.ellipsis!==!1){const b=this._createLabelText(u),S=this.getGraphicBounds(b);f=S.x2-S.x1}const g=l.map(b=>b.attribute),_=Array.from(this._idToGraphic.values());this._line2MinLength=isFunction(this.attribute.line.line2MinLength)?this.attribute.line.line2MinLength(e,_,this.attribute):this.attribute.line.line2MinLength,this._alignOffset=(i=isFunction(this.attribute.layout.alignOffset)?this.attribute.layout.alignOffset(e,_,this.attribute):this.attribute.layout.alignOffset)!==null&&i!==void 0?i:0;const y=this.layoutArcLabels(this.attribute.position,this.attribute,_,g,d,f);for(let b=0;b<g.length;b++){const S=g[b],v=y.find(A=>{var x;return((x=A.refDatum)===null||x===void 0?void 0:x.id)===S.id});if(v){const A={visible:v.labelVisible,x:v.labelPosition.x,y:v.labelPosition.y,angle:v.angle,points:v.pointA&&v.pointB&&v.pointC?[v.pointA,v.pointB,v.pointC]:void 0,line:v.labelLine};l[b].type==="richtext"?A.width=(n=v.labelLimit)!==null&&n!==void 0?n:l[b].attribute.width:A.maxLineWidth=(o=v.labelLimit)!==null&&o!==void 0?o:l[b].attribute.maxLineWidth,v.refArc&&v.refArc.type==="arc3d"&&(A.anchor3d=[v.circleCenter.x-A.x,v.circleCenter.y-A.y],A.beta=v.refArc.attribute.beta),l[b].setAttributes(A)}}return l}layoutArcLabels(e,i,n,o,l,d){this._arcLeft.clear(),this._arcRight.clear(),this._ellipsisWidth=d;let u=0;n.forEach(y=>{y.attribute.outerRadius>u&&(u=y.attribute.outerRadius)}),o.forEach((y,b)=>{var S,v;const A=this._idToGraphic.get(y.id),x=A.attribute,T={x:(S=x==null?void 0:x.x)!==null&&S!==void 0?S:0,y:(v=x==null?void 0:x.y)!==null&&v!==void 0?v:0};if(!isNil(o[b])&&!isNil(l[b])){const C=o[b]?o[b]:null,E=l[b]?l[b]:{x1:0,x2:0,y1:0,y2:0},P=(x.startAngle+x.endAngle)/2,R=x.endAngle-x.startAngle,L=computeQuadrant(x.endAngle-R/2),w=polarToCartesian(T,x.outerRadius,P),B=polarToCartesian(T,u+i.line.line1MinLength,P),I=new ArcInfo(C,w,B,L,R,P,x.innerRadius,x.outerRadius,T);I.refArc=A,I.pointA=polarToCartesian(T,this.computeDatumRadius(2*T.x,2*T.y,x.outerRadius),I.middleAngle),I.labelSize={width:E.x2-E.x1,height:E.y2-E.y1},isQuadrantRight(I.quadrant)?this._arcRight.set(I.refDatum,I):isQuadrantLeft(I.quadrant)&&this._arcLeft.set(I.refDatum,I)}});const f=Array.from(this._arcLeft.values()),g=Array.from(this._arcRight.values()),_=[];switch(e){case"inside":case"inside-inner":case"inside-outer":case"inside-center":_.push(...this._layoutInsideLabels(g,i,n)),_.push(...this._layoutInsideLabels(f,i,n));break;default:_.push(...this._layoutOutsideLabels(g,i,n)),_.push(...this._layoutOutsideLabels(f,i,n))}return _}_layoutInsideLabels(e,i,n){var o,l;const d=i,u=d.spaceWidth,f=(o=d.position)!==null&&o!==void 0?o:"inside",g=(l=d.offsetRadius)!==null&&l!==void 0?l:-u;return e.forEach(_=>{var y,b,S;const{labelSize:v,radian:A}=_,x=_.innerRadius,T=_.outerRadius;let C;if(A<connectLineRadian(T,v.height))C=0;else{let B;B=A>=Math.PI?x:Math.max(x,v.height/2/Math.tan(A/2)),C=T-B-u}d.rotate!==!0&&(C=T-u);const E=this._getFormatLabelText(_.refDatum,C);_.labelText=E;const P=Math.min(C,_.labelSize.width),R=this._computeAlign(_,i);let L,w=0;if(f==="inside"&&(w=R==="left"?P:R==="right"?0:P/2),L=f==="inside-inner"?x-g+w:f==="inside-center"?x+(T-x)/2:T+g-w,_.labelPosition=polarToCartesian(_.circleCenter,L,_.middleAngle),_.labelLimit=P,isGreater(P,0)||(_.labelVisible=!1),d.rotate!==!1){_.angle=(b=(y=i.textStyle)===null||y===void 0?void 0:y.angle)!==null&&b!==void 0?b:_.middleAngle;let B=(S=d.offsetAngle)!==null&&S!==void 0?S:0;["inside-inner","inside-outer"].includes(f)&&(B+=Math.PI/2),_.angle+=B}}),e}_layoutOutsideLabels(e,i,n){var o,l,d;const u=(o=n[0].attribute.x)!==null&&o!==void 0?o:0,f=2*((l=n[0].attribute.y)!==null&&l!==void 0?l:0),g=i.layout,_=i.spaceWidth;if(e.forEach(b=>{const S=isQuadrantLeft(b.quadrant)?-1:1;b.labelPosition={x:b.outerCenter.x+S*(b.labelSize.width/2+this._line2MinLength+_),y:b.outerCenter.y}}),e.sort((b,S)=>b.labelPosition.y-S.labelPosition.y),i.coverEnable!==!1||g.strategy==="none"){for(const b of e){const{labelPosition:S,labelSize:v}=b;b.labelLimit=v.width,b.pointB=isQuadrantLeft(b.quadrant)?{x:S.x+v.width/2+this._line2MinLength+_,y:S.y}:{x:S.x-v.width/2-this._line2MinLength-_,y:S.y},this._computeX(b,i,n)}i.coverEnable===!1&&g.strategy==="none"&&this._coverLabels(e)}else{const b=f/(((d=i.textStyle)===null||d===void 0?void 0:d.fontSize)||16);this._adjustY(e,b,i,n);const{minY:S,maxY:v}=e.reduce((T,C)=>{const{y1:E,y2:P}=C.getLabelBounds();return T.minY=Math.max(0,Math.min(E,T.minY)),T.maxY=Math.min(f,Math.max(P,T.maxY)),T},{minY:1/0,maxY:-1/0}),A=Math.max(Math.abs(f/2-S),Math.abs(v-f/2)),x=this._computeLayoutRadius(A,i,n);for(const T of e)this._computePointB(T,x,i,n),this._computeX(T,i,n)}const y=2*u;return e.forEach(b=>{var S,v;b.labelVisible&&(isLess(b.pointB.x,this._line2MinLength+_)||isGreater(b.pointB.x,y-this._line2MinLength-_))&&(b.labelVisible=!1),b.angle=(v=(S=i.textStyle)===null||S===void 0?void 0:S.angle)!==null&&v!==void 0?v:0,i.offsetAngle&&(b.angle+=i.offsetAngle),b.labelLine=Object.assign(Object.assign({},i.line),{visible:b.labelVisible})}),e}_computeX(e,i,n){var o;const l=e.circleCenter,d=0,u=this.attribute.width;this.attribute.height;let f=0;n.forEach(I=>{I.attribute.outerRadius>f&&(f=I.attribute.outerRadius)});const g=this.computeLayoutOuterRadius(f,i.width,i.height),_=i.line.line1MinLength,y=(o=i.layout)===null||o===void 0?void 0:o.align,b=i.spaceWidth,{labelPosition:S,quadrant:v,pointB:A}=e;isValidNumber(A.x*A.y)||(e.pointC={x:NaN,y:NaN},S.x=NaN,e.labelLimit=0);const x=this.computeRadius(g,i.width,i.height),T=isQuadrantLeft(v)?-1:1;let C=0,E=(T>0?u-A.x:A.x-d)+this._alignOffset-this._line2MinLength-b;y==="labelLine"&&(C=(x+_+this._line2MinLength)*T+l.x,E=(T>0?u-C:C-d)-b);const P=this._getFormatLabelText(e.refDatum,E);e.labelText=P;let R=Math.min(E,e.labelSize.width);switch(y){case"labelLine":break;case"edge":C=T>0?u-R-b:d+R+b;break;default:C=A.x+T*this._line2MinLength}R=Math.max(this._ellipsisWidth,R);const L=R<e.labelSize.width-1;e.labelLimit=L?R:null,e.pointC={x:C,y:S.y};const w=this._computeAlign(e,i),B=getAlignOffset(w)*(L?R:e.labelSize.width);y==="edge"?(S.x=(T>0?u:d)-T*B+T*this._alignOffset,e.pointC.x+=T*this._alignOffset):S.x=C+T*(this._alignOffset+b+B)}_computeAlign(e,i){var n,o,l,d,u,f;const g=i,_=(o=(n=g.textStyle)===null||n===void 0?void 0:n.textAlign)!==null&&o!==void 0?o:(l=g.textStyle)===null||l===void 0?void 0:l.align,y=(u=(d=g.layout)===null||d===void 0?void 0:d.textAlign)!==null&&u!==void 0?u:(f=g.layout)===null||f===void 0?void 0:f.align;return g.position!=="inside"?isNil(_)||_==="auto"?y==="edge"?isQuadrantLeft(e.quadrant)?"left":"right":isQuadrantLeft(e.quadrant)?"right":"left":_:isNil(_)||_==="auto"?"center":_}_getFormatLabelText(e,i){var n;return(n=e==null?void 0:e.text)!==null&&n!==void 0?n:""}_adjustY(e,i,n,o){var l;o[0].attribute.x;const d=2*((l=o[0].attribute.y)!==null&&l!==void 0?l:0),u=n.layout;if(u.strategy==="vertical"){let f,g=0;const _=e.length;if(_<=0)return;for(let b=0;b<_;b++){const{y1:S}=e[b].getLabelBounds();if(f=S-g,isLess(f,0)){const A=this._shiftY(e,b,_-1,-f);this._shiftY(e,A,0,f/2)}const{y2:v}=e[b].getLabelBounds();g=v}const{y1:y}=e[0].getLabelBounds();f=y-0,isLess(f,0)&&this._shiftY(e,0,_-1,-f);for(let b=e.length-1;b>=0&&e[b].getLabelBounds().y2>d;b--)e[b].labelVisible=!1}else if(u.strategy!=="none"){const f=e.map((y,b)=>({arc:y,originIndex:b,priorityIndex:0}));f.sort((y,b)=>b.arc.radian-y.arc.radian),f.forEach((y,b)=>{y.priorityIndex=b,y.arc.labelVisible=!1});let g=1/0,_=-1/0;for(let y=0;y<i&&y<e.length;y++){this._storeY(e);const b=f[y].arc;this._computeYRange(b,n,o),b.labelVisible=!0;const S=b.labelPosition.y,{lastIndex:v,nextIndex:A}=this._findNeighborIndex(e,f[y]),x=e[v],T=e[A];if(v===-1&&A!==-1){const R=T.labelPosition.y;S>R?b.labelPosition.y=R-T.labelSize.height/2-b.labelSize.height/2:this._twoWayShift(e,b,T,A)}else if(v!==-1&&A===-1){const R=x.labelPosition.y;S<R?b.labelPosition.y=R+x.labelSize.height/2+b.labelSize.height/2:this._twoWayShift(e,x,b,f[y].originIndex)}else if(v!==-1&&A!==-1){const R=x.labelPosition.y,L=T.labelPosition.y;S>L?(b.labelPosition.y=L-T.labelSize.height/2-b.labelSize.height/2,this._twoWayShift(e,x,b,f[y].originIndex)):S<R?(b.labelPosition.y=R+x.labelSize.height/2+b.labelSize.height/2,this._twoWayShift(e,b,T,A)):(this._twoWayShift(e,x,b,f[y].originIndex),this._twoWayShift(e,b,T,A))}const C=Math.min(g,f[y].originIndex),E=Math.max(_,f[y].originIndex);let P;if(P=e[E].getLabelBounds().y2-d,isGreater(P,0)&&this._shiftY(e,E,0,-P),P=e[C].getLabelBounds().y1-0,isLess(P,0)&&this._shiftY(e,C,e.length-1,-P),P=e[E].getLabelBounds().y2-d,isGreater(P,0)){b.labelVisible=!1,this._restoreY(e);break}u.tangentConstraint&&!this._checkYRange(e)?(b.labelVisible=!1,this._restoreY(e)):(g=C,_=E)}}}_shiftY(e,i,n,o){const l=i<n?1:-1;let d=i;for(;d!==-1;){e[d].labelPosition.y+=o;const u=this._findNextVisibleIndex(e,d,n,l);if(u>=0&&u<e.length){const{y1:f,y2:g}=e[d].getLabelBounds(),{y1:_,y2:y}=e[u].getLabelBounds();if(l>0&&g<_||l<0&&f>y)return d}d=u}return n}_findNextVisibleIndex(e,i,n,o){const l=(n-i)*o;for(let d=1;d<=l;d++){const u=i+d*o;if(e[u].labelVisible)return u}return-1}_computePointB(e,i,n,o){const l=n;let d=0;o.forEach(g=>{g.attribute.outerRadius>d&&(d=g.attribute.outerRadius)});const u=this.computeLayoutOuterRadius(d,n.width,n.height),f=l.line.line1MinLength;if(l.layout.strategy==="none")e.pointB={x:e.outerCenter.x,y:e.outerCenter.y};else{const g=e.circleCenter,_=this.computeRadius(u,n.width,n.height),{labelPosition:y,quadrant:b}=e,S=i-Math.max(_+f,e.outerRadius),v=Math.sqrt(i**2-Math.abs(g.y-y.y)**2)-S;isValidNumber(v)?e.pointB={x:g.x+v*(isQuadrantLeft(b)?-1:1),y:y.y}:e.pointB={x:NaN,y:NaN}}}_storeY(e){for(const i of e)i.labelVisible&&(i.lastLabelY=i.labelPosition.y)}_computeYRange(e,i,n){const o=e.circleCenter,l={width:2*o.x,height:2*o.y};let d=0;n.forEach(R=>{R.attribute.outerRadius>d&&(d=R.attribute.outerRadius)});const u=this.computeLayoutOuterRadius(d,i.width,i.height),f=i.line.line1MinLength,{width:g,height:_}=l,y=this.computeRadius(u,i.width,i.height),b=this._computeLayoutRadius(_/2,i,n),S=Math.abs(e.center.x-g/2),v=e.center.y-_/2;let A,x,T;if(isNumberClose(g/2,S))A=0,x=1,T=-v;else if(isNumberClose(_/2,v))A=1,x=0,T=-S;else{const R=-1/(v/S);A=R,x=-1,T=v-R*S}const C=lineCirclePoints(A,x,T,f+y-b,0,b);if(C.length<2)return;let E,P;C[0].x>C[1].x&&C.reverse(),C[0].x<0?isNumberClose(C[0].y,C[1].y)?isGreater(e.middleAngle,-Math.PI)&&isLess(e.middleAngle,0)||isGreater(e.middleAngle,Math.PI)&&isLess(e.middleAngle,2*Math.PI)?(E=0,P=C[1].y+_/2):(E=C[1].y+_/2,P=_):C[0].y<C[1].y?(E=0,P=C[1].y+_/2):(E=C[1].y+_/2,P=l.height):(E=Math.min(C[0].y,C[1].y)+_/2,P=Math.max(C[0].y,C[1].y)+_/2),e.labelYRange=[E,P]}_computeLayoutRadius(e,i,n){const o=i,l=o.layoutArcGap,d=o.line.line1MinLength;let u=0;n.forEach(y=>{y.attribute.outerRadius>u&&(u=y.attribute.outerRadius)});const f=this.computeLayoutOuterRadius(u,i.width,i.height),g=this.computeRadius(f,i.width,i.height)+d,_=g-l;return Math.max((_**2+e**2)/(2*_),g)}_findNeighborIndex(e,i){const n=i.originIndex;let o=-1,l=-1;for(let d=n-1;d>=0;d--)if(e[d].labelVisible){o=d;break}for(let d=n+1;d<e.length;d++)if(e[d].labelVisible){l=d;break}return{lastIndex:o,nextIndex:l}}_twoWayShift(e,i,n,o){const l=n.getLabelBounds().y1-i.getLabelBounds().y2;if(isLess(l,0)){const d=this._shiftY(e,o,e.length-1,-l);this._shiftY(e,d,0,l/2)}}_restoreY(e){for(const i of e)i.labelVisible&&(i.labelPosition.y=i.lastLabelY)}_checkYRange(e){for(const i of e){const{labelYRange:n,labelPosition:o}=i;if(i.labelVisible&&n&&(isLess(o.y,n[0])||isGreater(o.y,n[1])))return!1}return!0}_coverLabels(e){if(e.length<=1)return;let i=e[0].getLabelBounds();for(let n=1;n<e.length;n++){const o=e[n].getLabelBounds();checkBoundsOverlap(i,o)?e[n].labelVisible=!1:i=o}}_getLabelLinePoints(e,i){return e.attribute.points}_createLabelLine(e,i){var n,o,l,d,u;const{line:f={},visible:g}=e.attribute,_=super._createLabelLine(e,i);if(_&&(_.setAttributes({visible:(l=(n=f.visible&&g)!==null&&n!==void 0?n:(o=e.attribute)===null||o===void 0?void 0:o.visible)===null||l===void 0||l,lineWidth:(u=(d=f.style)===null||d===void 0?void 0:d.lineWidth)!==null&&u!==void 0?u:1}),f.smooth&&_.setAttributes({curveType:"basis"}),i.type==="arc3d"&&i)){const{beta:y,x:b,y:S}=i.attribute;_.setAttributes({beta:y,anchor3d:[b,S]})}return _}computeRadius(e,i,n,o){return this.computeLayoutRadius(i||0,n||0)*e*(isNil(o)?1:o)}computeLayoutRadius(e,i){return Math.min(e/2,i/2)}_canPlaceInside(e,i){return this.attribute.position==="inside"||this.attribute.position==="inside-center"}computeLayoutOuterRadius(e,i,n){return e/(Math.min(i,n)/2)}computeDatumRadius(e,i,n){const o=this.computeLayoutOuterRadius(n,e,i);return this.computeLayoutRadius(e||0,i||0)*o}}ArcLabel.defaultAttributes={coverEnable:!1,spaceWidth:5,layoutArcGap:6,textStyle:{visible:!0,fontSize:14,fontWeight:"normal",fillOpacity:1,boundsPadding:[-1,0,-1,0],ellipsis:!0},position:"outside",line:{visible:!0,line1MinLength:20,line2MinLength:10},layout:{align:"arc",strategy:"priority",tangentConstraint:!0}};const registerArcDataLabel=()=>{registerLabelComponent("arc",ArcLabel)};var __rest$n=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};class DataLabel extends AbstractComponent{constructor(e,i){const{dataLabels:n}=e,o=__rest$n(e,["dataLabels"]);super(i!=null&&i.skipDefault?e:Object.assign({dataLabels:n},merge$1({},DataLabel.defaultAttributes,o))),this.name="data-label"}render(){var e;const{dataLabels:i,size:n}=this.attribute;if(!i||i.length===0)return;const{width:o=0,height:l=0,padding:d}=n||{};if(!o||!l||!isValidNumber(l*o))return;this._componentMap||(this._componentMap=new Map);const u=bitmapTool(o,l,d),f=u.bitmap(),g=new Map,_=this._componentMap;for(let y=0;y<i.length;y++){const b=i[y],S=getLabelComponent(b.type)||LabelBase;if(S){const{baseMarkGroupName:v,type:A}=b,x=(e=b.id)!==null&&e!==void 0?e:`${v}-${A}-${y}`;b.type==="arc"&&(b.width=n.width,b.height=n.height);let T=this._componentMap.get(x);T?(T.setBitmapTool(u),T.setBitmap(f),T.setAttributes(b),g.set(x,T)):(T=new S(b),T.setBitmap(f),T.setBitmapTool(u),this.add(T),g.set(x,T))}}_.forEach((y,b)=>{g.get(b)||this.removeChild(y)}),this._componentMap=g}setLocation(e){this.translateTo(e.x,e.y)}disableAnimation(){this._componentMap.forEach(e=>{e.disableAnimation()})}enableAnimation(){this._componentMap.forEach(e=>{e.enableAnimation()})}}DataLabel.defaultAttributes={pickable:!1};function getArcPath(r,e,i,n){let o="";if(!r||e.length===0)return o;const l=e[0],d=PointService.distancePP(r,l),u=i?0:1;return n?o+=`M${r.x},${r.y-d}A${d},${d},0,0,${u},${r.x},${r.y+d}A${d},${d},0,0,${u},${r.x},${r.y-d}Z`:e.forEach((f,g)=>{g===0?o=`M${f.x},${f.y}`:o+=`A${d},${d},0,0,${u},${f.x},${f.y}`}),o}function getRegionPath(r,e,i){const{type:n,closed:o}=i,l=e.slice(0).reverse();let d="",u="";if(n==="line"&&i.smoothLink&&i.center){const f=r[0],g=l[0],_=i.center;d=getPolygonPath(r,!!o),u=getPolygonPath(l,!!o);const y=PointService.distancePP(g,_),b=PointService.distancePP(f,_);d+=`A${y},${y},0,0,1,${g.x},${g.y}L${g.x},${g.y}`,u+=`A${b},${b},0,0,0,${f.x},${f.y}`}else if(n==="circle"){const{center:f}=i;d=getArcPath(f,r,!1,!!o),u=getArcPath(f,l,!0,!!o)}else n!=="line"&&n!=="polygon"||(d=getPolygonPath(r,!!o),u=getPolygonPath(l,!!o));return o?d+=u:(u="L"+u.substring(1),d+=u,d+="Z"),d}class BaseGrid extends AbstractComponent{constructor(){super(...arguments),this.name="axis-grid",this.data=[]}getInnerView(){return this._innerView}getPrevInnerView(){return this._prevInnerView}render(){this._prevInnerView=this._innerView&&getElMap(this._innerView),this.removeAllChild(!0),this._innerView=graphicCreator.group({x:0,y:0,pickable:!1}),this.add(this._innerView);const{items:e,visible:i}=this.attribute;e&&e.length&&i!==!1&&(this.data=this._transformItems(e),this._renderGrid(this._innerView))}getVerticalCoord(e,i,n){return getVerticalCoord(e,this.getVerticalVector(i,n,e))}_transformItems(e){const i=[];return e.forEach(n=>{var o;i.push(Object.assign(Object.assign({},n),{point:this.getTickCoord(n.value),id:(o=n.id)!==null&&o!==void 0?o:n.label}))}),i}_renderGrid(e){const{visible:i}=this.attribute.subGrid||{};i&&this._renderGridByType(!0,e),this._renderGridByType(!1,e)}_renderGridByType(e,i){const n=merge$1({},this.attribute,this.getGridAttribute(e)),{type:o,items:l,style:d,closed:u,alternateColor:f,depth:g=0}=n,_=e?`${AXIS_ELEMENT_NAME.grid}-sub`:`${AXIS_ELEMENT_NAME.grid}`;if(l.forEach((y,b)=>{const{id:S,points:v}=y;let A="";if(o==="line"||o==="polygon")A=getPolygonPath(v,!!u);else if(o==="circle"){const{center:T}=this.attribute;A=getArcPath(T,v,!1,!!u)}const x=graphicCreator.path(Object.assign({path:A,z:g},isFunction(d)?merge$1({},this.skipDefault?null:BaseGrid.defaultAttributes.style,d(y,b)):d));x.name=`${_}-line`,x.id=this._getNodeId(`${_}-path-${S}`),i.add(x)}),g&&o==="line"&&l.forEach((y,b)=>{const{id:S,points:v}=y,A=[];A.push(v[0]);const x=v[1].x-v[0].x,T=v[1].y-v[0].y,C=Math.sqrt(x*x+T*T),E=g/C;A.push({x:v[0].x+x*E,y:v[0].y+T*E});const P=getPolygonPath(A,!!u),R=abs$1(A[0].x-A[1].x),L=abs$1(A[0].y-A[1].y),w=graphicCreator.path(Object.assign({path:P,z:0,alpha:R>L?(v[1].x-v[0].x>0?-1:1)*pi$1/2:0,beta:R<L?-pi$1/2:0,anchor3d:R>L?[A[0].x,0]:[0,A[0].y]},isFunction(d)?merge$1({},this.skipDefault?null:BaseGrid.defaultAttributes.style,d(y,b)):d));w.name=`${_}-line`,w.id=this._getNodeId(`${_}-path-${S}`),i.add(w)}),l.length>1&&f){const y=isArray(f)?f:[f,"transparent"],b=P=>y[P%y.length],S=this.attribute.items,v=S[0],A=S[S.length-1],x=!isNumberClose(v.value,0)&&!isNumberClose(A.value,0),T=!isNumberClose(v.value,1)&&!isNumberClose(A.value,1),C=[],E=v.value>A.value;(E&&T||!E&&x)&&C.push(this.getGridPointsByValue(E?1:0)),l.forEach(P=>{C.push(P.points)}),(E&&x||!E&&T)&&C.push(this.getGridPointsByValue(E?0:1));for(let P=0;P<C.length-1;P++){const R=getRegionPath(C[P],C[P+1],n),L=graphicCreator.path({path:R,fill:b(P)});L.name=`${_}-region`,L.id=this._getNodeId(`${_}-region-${P}`),i.add(L)}}}_getNodeId(e){return`${this.id}-${e}`}_parseTickSegment(){let e=1;return this.data.length>=2&&(e=this.data[1].value-this.data[0].value),e}_getPointsOfSubGrid(e,i){const n=this.data.length,o=[];return n>=2&&this.data.forEach(l=>{let d=l.value;if(!i){const u=l.value-e/2;if(this.isInValidValue(u))return;d=u}o.push({value:d})}),o}release(){super.release(),this._prevInnerView=null,this._innerView=null}}BaseGrid.defaultAttributes={style:{lineWidth:1,stroke:"#999",strokeOpacity:1,lineDash:[4,4]},subGrid:{visible:!1,style:{lineWidth:1,stroke:"#999",strokeOpacity:1,lineDash:[4,4]}}};loadLineAxisGridComponent();class LineAxisGrid extends BaseGrid{constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},BaseGrid.defaultAttributes,e),i)}_getGridPoint(e,i){let n;if(e==="line"){const{length:o}=this.attribute;n=[i,this.getVerticalCoord(i,o,!0)]}else if(e==="circle"||e==="polygon"){const{center:o,sides:l=6,startAngle:d=POLAR_START_ANGLE$1,endAngle:u=POLAR_END_ANGLE$1}=this.attribute,f=PointService.distancePP(o,i);n=getCirclePoints(o,l,f,d,u)}return n}getGridPointsByValue(e){const i=this.getTickCoord(e);return this._getGridPoint(this.attribute.type,i)}getGridAttribute(e){const{type:i,alignWithLabel:n=!0}=this.attribute,o=this._parseTickSegment();let l,d=[];if(e){l=merge$1({},this.attribute,this.attribute.subGrid);const u=[],{count:f=4}=l;if(this.data.length>=2){const g=this._getPointsOfSubGrid(o,n);for(let _=0;_<g.length-1;_++){const y=g[_],b=g[_+1];u.push({id:`sub-${_}-0`,points:this.getGridPointsByValue(y.value),datum:{}});for(let S=0;S<f;S++){const v=(S+1)/(f+1),A=(1-v)*y.value+v*b.value;u.push({id:`sub-${_}-${S+1}`,points:this.getGridPointsByValue(A),datum:{}})}_===g.length-2&&u.push({id:`sub-${_}-${f+1}`,points:this.getGridPointsByValue(b.value),datum:{}})}d=u}}else{l=this.attribute;const u=[];this.data.forEach(f=>{let{point:g}=f;if(!n){const _=f.value-o/2;if(this.isInValidValue(_))return;g=this.getTickCoord(_)}u.push({id:f.label,datum:f,points:this._getGridPoint(i,g)})}),d=u}return Object.assign(Object.assign({},l),{items:d})}}mixin(LineAxisGrid,LineAxisMixin);var __rest$m=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};loadCircleAxisGridComponent();class CircleAxisGrid extends BaseGrid{constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},BaseGrid.defaultAttributes,e),i)}getGridPointsByValue(e){const i=this.getTickCoord(e),{radius:n,innerRadius:o=0}=this.attribute;return[i,this.getVerticalCoord(i,n-o,!0)]}getGridAttribute(e){let i,n=[];const o=this.attribute,{radius:l,innerRadius:d=0,startAngle:u=POLAR_START_ANGLE$1,endAngle:f=POLAR_END_ANGLE$1,center:g,subGrid:_}=o,y=__rest$m(o,["radius","innerRadius","startAngle","endAngle","center","subGrid"]),{alignWithLabel:b=!0}=y||{},S=l-d,v=this._parseTickSegment();if(e){i=merge$1({},y,_);const A=[],{count:x=4}=_||{},T=this.data.length;if(T>=2){const C=this._getPointsOfSubGrid(v,b);for(let E=0;E<T;E++){const P=C[E],R=C[E+1];A.push({id:`sub-${E}-0`,points:[this.getTickCoord(P.value),this.getVerticalCoord(this.getTickCoord(P.value),S,!0)],datum:{}});for(let L=0;L<x;L++){const w=(L+1)/(x+1),B=(1-w)*P.value+w*(R?R.value:b?1:P.value+v),I=this.getTickCoord(B),D=this.getVerticalCoord(I,S,!0);A.push({id:`sub-${E}-${L+1}`,points:[I,D],datum:{}})}}Math.abs(f-u)%(2*Math.PI)==0&&A.push(A[0]),n=A}}else{i=y;const A=[];let x;x=Math.abs(f-u)%(2*Math.PI)==0?[...this.data].concat(this.data[0]):this.data,x.forEach(T=>{let{point:C}=T;if(!b){const P=T.value-v/2;if(this.isInValidValue(P))return;C=this.getTickCoord(P)}const E=this.getVerticalCoord(C,S,!0);A.push({id:T.id,points:[C,E],datum:T})}),n=A}return Object.assign(Object.assign({},i),{items:n,center:g,type:"line"})}}mixin(CircleAxisGrid,CircleAxisMixin);const DEFAULT_HANDLER_PATH="M -0.0544 0.25 C -0.0742 0.25 -0.0901 0.234 -0.0901 0.2143 L -0.0901 -0.1786 C -0.0901 -0.1983 -0.0742 -0.2143 -0.0544 -0.2143 L -0.0187 -0.2143 L -0.0187 -0.5 L 0.017 -0.5 L 0.017 -0.2143 L 0.0527 -0.2143 C 0.0724 -0.2143 0.0884 -0.1983 0.0884 -0.1786 L 0.0884 0.2143 C 0.0884 0.234 0.0724 0.25 0.0527 0.25 L 0.017 0.25 L 0.017 0.5 L -0.0187 0.5 L -0.0187 0.25 L -0.0544 0.25 Z M -0.0187 -0.1429 L -0.0544 -0.1429 L -0.0544 0.1786 L -0.0187 0.1786 L -0.0187 -0.1429 Z M 0.0527 -0.1429 L 0.017 -0.1429 L 0.017 0.1786 L 0.0527 0.1786 L 0.0527 -0.1429 Z",DEFAULT_DATA_ZOOM_ATTRIBUTES={orient:"bottom",showDetail:"auto",brushSelect:!0,zoomLock:!1,minSpan:0,maxSpan:1,delayType:"throttle",delayTime:0,realTime:!0,backgroundStyle:{fill:"white",stroke:"#D1DBEE",lineWidth:1,cornerRadius:2},dragMaskStyle:{fill:"#B0C8F9",fillOpacity:.2},backgroundChartStyle:{area:{visible:!0,stroke:"#D1DBEE",lineWidth:1,fill:"#F6F8FC"},line:{visible:!0,stroke:"#D1DBEE",lineWidth:1}},selectedBackgroundStyle:{fill:"#B0C8F9",fillOpacity:.5},selectedBackgroundChartStyle:{area:{visible:!0,stroke:"#B0C8F9",lineWidth:1,fill:"#fbb934"},line:{visible:!0,stroke:"#fbb934",lineWidth:1}},middleHandlerStyle:{visible:!0,background:{size:8,style:{fill:"white",stroke:"#B0C8F9",cornerRadius:2}},icon:{size:6,fill:"white",stroke:"#B0C8F9",symbolType:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",lineWidth:.5}},startHandlerStyle:{visible:!0,triggerMinSize:0,symbolType:DEFAULT_HANDLER_PATH,fill:"white",stroke:"#B0C8F9",lineWidth:.5},endHandlerStyle:{visible:!0,triggerMinSize:0,symbolType:DEFAULT_HANDLER_PATH,fill:"white",stroke:"#B0C8F9",lineWidth:.5},startTextStyle:{padding:4,textStyle:{fontSize:10,fill:"#6F6F6F"}},endTextStyle:{padding:4,textStyle:{fontSize:10,fill:"#6F6F6F"}}},DEFAULT_HANDLER_ATTR_MAP={horizontal:{angle:0,strokeBoundsBuffer:0,boundsPadding:2,pickMode:"imprecise",cursor:"ew-resize"},vertical:{angle:Math.PI/180*90,cursor:"ns-resize",boundsPadding:2,pickMode:"imprecise",strokeBoundsBuffer:0}};var DataZoomActiveTag;(function(r){r.startHandler="startHandler",r.endHandler="endHandler",r.middleHandler="middleHandler",r.background="background"})(DataZoomActiveTag||(DataZoomActiveTag={}));function loadDataZoomComponent(){loadTagComponent(),registerRect(),registerSymbol(),registerArea(),registerLine()}var __rest$l=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};const delayMap$2={debounce,throttle};loadDataZoomComponent();let DataZoom$1=class $e extends AbstractComponent{setPropsFromAttrs(){const{start:e,end:i,orient:n,previewData:o,previewPointsX:l,previewPointsY:d,previewPointsX1:u,previewPointsY1:f}=this.attribute;e&&(this.state.start=e),i&&(this.state.end=i);const{width:g,height:_}=this.getLayoutAttrFromConfig();this._spanCache=this.state.end-this.state.start,this._isHorizontal=n==="top"||n==="bottom",this._layoutCache.max=this._isHorizontal?g:_,this._layoutCache.attPos=this._isHorizontal?"x":"y",this._layoutCache.attSize=this._isHorizontal?"width":"height",o&&(this._previewData=o),isFunction(l)&&(this._previewPointsX=l),isFunction(d)&&(this._previewPointsY=d),isFunction(u)&&(this._previewPointsX1=u),isFunction(f)&&(this._previewPointsY1=f)}constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},$e.defaultAttributes,e)),this.name="dataZoom",this._previewData=[],this._activeState=!1,this._activeCache={startPos:{x:0,y:0},lastPos:{x:0,y:0}},this._layoutCache={attPos:"x",attSize:"width",max:0},this.state={start:0,end:1},this._statePointToData=l=>l,this._onHandlerPointerDown=(l,d)=>{l.stopPropagation(),d==="start"?(this._activeTag=DataZoomActiveTag.startHandler,this._activeItem=this._startHandlerMask):d==="end"?(this._activeTag=DataZoomActiveTag.endHandler,this._activeItem=this._endHandlerMask):d==="middleRect"?(this._activeTag=DataZoomActiveTag.middleHandler,this._activeItem=this._middleHandlerRect):d==="middleSymbol"?(this._activeTag=DataZoomActiveTag.middleHandler,this._activeItem=this._middleHandlerSymbol):d==="background"&&(this._activeTag=DataZoomActiveTag.background,this._activeItem=this._background),this._activeState=!0,this._activeCache.startPos=this.eventPosToStagePos(l),this._activeCache.lastPos=this.eventPosToStagePos(l),vglobal.env==="browser"&&(vglobal.addEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),vglobal.addEventListener("pointerup",this._onHandlerPointerUp)),this.addEventListener("pointermove",this._onHandlerPointerMove,{capture:!0})},this._pointerMove=l=>{l.stopPropagation();const{start:d,end:u,brushSelect:f,realTime:g=!0}=this.attribute,_=this.eventPosToStagePos(l),{attPos:y,max:b}=this._layoutCache,S=(_[y]-this._activeCache.lastPos[y])/b;let{start:v,end:A}=this.state;this._activeState&&(this._activeTag===DataZoomActiveTag.middleHandler?this.moveZoomWithMiddle((this.state.start+this.state.end)/2+S):this._activeTag===DataZoomActiveTag.startHandler?v+S>A?(v=A,A=v+S,this._activeTag=DataZoomActiveTag.endHandler):v+=S:this._activeTag===DataZoomActiveTag.endHandler&&(A+S<v?(A=v,v=A+S,this._activeTag=DataZoomActiveTag.startHandler):A+=S),this._activeCache.lastPos=_,f&&this.renderDragMask()),v=Math.min(Math.max(v,0),1),A=Math.min(Math.max(A,0),1),d===v&&u===A||(this.setStateAttr(v,A,!0),g&&this._dispatchEvent("change",{start:v,end:A,tag:this._activeTag}))},this._onHandlerPointerMove=this.attribute.delayTime===0?this._pointerMove:delayMap$2[this.attribute.delayType](this._pointerMove,this.attribute.delayTime),this._onHandlerPointerUp=l=>{l.preventDefault();const{start:d,end:u,brushSelect:f,realTime:g=!0}=this.attribute;if(this._activeState&&this._activeTag===DataZoomActiveTag.background){const _=this.eventPosToStagePos(l);this.backgroundDragZoom(this._activeCache.startPos,_)}this._activeState=!1,f&&this.renderDragMask(),d===this.state.start&&u===this.state.end||(this.setStateAttr(this.state.start,this.state.end,!0),this._dispatchEvent("change",{start:this.state.start,end:this.state.end,tag:this._activeTag})),vglobal.env==="browser"&&(vglobal.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),vglobal.removeEventListener("pointerup",this._onHandlerPointerUp)),this.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),this.removeEventListener("pointerup",this._onHandlerPointerUp)};const{position:n,showDetail:o}=e;this._activeCache.startPos=n,this._activeCache.lastPos=n,this._showText=o!=="auto"&&o,this.setPropsFromAttrs()}setAttributes(e,i){super.setAttributes(e,i),this.setPropsFromAttrs()}bindEvents(){if(this.attribute.disableTriggerEvent)return void this.setAttribute("childrenPickable",!1);const{showDetail:e,brushSelect:i}=this.attribute;this._startHandlerMask&&this._startHandlerMask.addEventListener("pointerdown",o=>this._onHandlerPointerDown(o,"start")),this._endHandlerMask&&this._endHandlerMask.addEventListener("pointerdown",o=>this._onHandlerPointerDown(o,"end")),this._middleHandlerSymbol&&this._middleHandlerSymbol.addEventListener("pointerdown",o=>this._onHandlerPointerDown(o,"middleSymbol")),this._middleHandlerRect&&this._middleHandlerRect.addEventListener("pointerdown",o=>this._onHandlerPointerDown(o,"middleRect"));const n=i?"background":"middleRect";this._selectedBackground&&this._selectedBackground.addEventListener("pointerdown",o=>this._onHandlerPointerDown(o,n)),i&&this._background&&this._background.addEventListener("pointerdown",o=>this._onHandlerPointerDown(o,"background")),i&&this._previewGroup&&this._previewGroup.addEventListener("pointerdown",o=>this._onHandlerPointerDown(o,"background")),this._selectedPreviewGroup&&this._selectedPreviewGroup.addEventListener("pointerdown",o=>this._onHandlerPointerDown(o,n)),this.addEventListener("pointerup",this._onHandlerPointerUp),this.addEventListener("pointerupoutside",this._onHandlerPointerUp),e==="auto"&&(this.addEventListener("pointerenter",this._onHandlerPointerEnter),this.addEventListener("pointerleave",this._onHandlerPointerLeave))}dragMaskSize(){const{position:e}=this.attribute,{attPos:i,max:n}=this._layoutCache;return this._activeCache.lastPos[i]-e[i]>n?n+e[i]-this._activeCache.startPos[i]:this._activeCache.lastPos[i]-e[i]<0?e[i]-this._activeCache.startPos[i]:this._activeCache.lastPos[i]-this._activeCache.startPos[i]}setStateAttr(e,i,n){const{zoomLock:o=!1,minSpan:l=0,maxSpan:d=1}=this.attribute,u=i-e;u!==this._spanCache&&(o||u<l||u>d)||(this._spanCache=u,this.state.start=e,this.state.end=i,n&&this.setAttributes({start:e,end:i}))}eventPosToStagePos(e){return this.stage.eventPointTransform(e)}_onHandlerPointerEnter(e){e.stopPropagation(),this._showText=!0,this.renderText()}_onHandlerPointerLeave(e){e.stopPropagation(),this._showText=!1,this.renderText()}backgroundDragZoom(e,i){const{attPos:n,max:o}=this._layoutCache,{position:l}=this.attribute,d=e[n]-l[n],u=i[n]-l[n],f=Math.min(Math.max(Math.min(d,u)/o,0),1),g=Math.min(Math.max(Math.max(d,u)/o,0),1);Math.abs(f-g)<.01?this.moveZoomWithMiddle(f):this.setStateAttr(f,g,!1)}moveZoomWithMiddle(e){let i=e-(this.state.start+this.state.end)/2;i!==0&&(i>0?this.state.end+i>1&&(i=1-this.state.end):i<0&&this.state.start+i<0&&(i=-this.state.start),this.setStateAttr(this.state.start+i,this.state.end+i,!1))}renderDragMask(){const{dragMaskStyle:e}=this.attribute,{position:i,width:n,height:o}=this.getLayoutAttrFromConfig();this._isHorizontal?this._dragMask=this._container.createOrUpdateChild("dragMask",Object.assign({x:clamp(this.dragMaskSize()<0?this._activeCache.lastPos.x:this._activeCache.startPos.x,i.x,i.x+n),y:i.y,width:this._activeState&&this._activeTag===DataZoomActiveTag.background&&Math.abs(this.dragMaskSize())||0,height:o},e),"rect"):this._dragMask=this._container.createOrUpdateChild("dragMask",Object.assign({x:i.x,y:clamp(this.dragMaskSize()<0?this._activeCache.lastPos.y:this._activeCache.startPos.y,i.y,i.y+o),width:n,height:this._activeState&&this._activeTag===DataZoomActiveTag.background&&Math.abs(this.dragMaskSize())||0},e),"rect")}isTextOverflow(e,i,n){if(!i)return!1;if(this._isHorizontal){if(n==="start"){if(i.x1<e.x1)return!0}else if(i.x2>e.x2)return!0}else if(n==="start"){if(i.y1<e.y1)return!0}else if(i.y2>e.y2)return!0;return!1}setTextAttr(e,i){var n,o,l,d,u,f,g,_;const{startTextStyle:y,endTextStyle:b}=this.attribute,{formatMethod:S}=y,v=__rest$l(y,["formatMethod"]),{formatMethod:A}=b,x=__rest$l(b,["formatMethod"]),{start:T,end:C}=this.state;this._startValue=this._statePointToData(T),this._endValue=this._statePointToData(C);const{position:E,width:P,height:R}=this.getLayoutAttrFromConfig(),L=S?S(this._startValue):this._startValue,w=A?A(this._endValue):this._endValue,B={x1:E.x,y1:E.y,x2:E.x+P,y2:E.y+R};let I,D,O,N;this._isHorizontal?(I={x:E.x+T*P,y:E.y+R/2},D={x:E.x+C*P,y:E.y+R/2},O={textAlign:this.isTextOverflow(B,e,"start")?"left":"right",textBaseline:(o=(n=v==null?void 0:v.textStyle)===null||n===void 0?void 0:n.textBaseline)!==null&&o!==void 0?o:"middle"},N={textAlign:this.isTextOverflow(B,i,"end")?"right":"left",textBaseline:(d=(l=x==null?void 0:x.textStyle)===null||l===void 0?void 0:l.textBaseline)!==null&&d!==void 0?d:"middle"}):(I={x:E.x+P/2,y:E.y+T*R},D={x:E.x+P/2,y:E.y+C*R},O={textAlign:(f=(u=v==null?void 0:v.textStyle)===null||u===void 0?void 0:u.textAlign)!==null&&f!==void 0?f:"center",textBaseline:this.isTextOverflow(B,e,"start")?"top":"bottom"},N={textAlign:(_=(g=x==null?void 0:x.textStyle)===null||g===void 0?void 0:g.textAlign)!==null&&_!==void 0?_:"center",textBaseline:this.isTextOverflow(B,i,"end")?"bottom":"top"}),this._startText=this.maybeAddLabel(this._container,merge$1({},v,{text:L,x:I.x,y:I.y,visible:this._showText,pickable:!1,childrenPickable:!1,textStyle:O}),`data-zoom-start-text-${E}`),this._endText=this.maybeAddLabel(this._container,merge$1({},x,{text:w,x:D.x,y:D.y,visible:this._showText,pickable:!1,childrenPickable:!1,textStyle:N}),`data-zoom-end-text-${E}`)}renderText(){let e=null,i=null;this.setTextAttr(e,i),e=this._startText.AABBBounds,i=this._endText.AABBBounds,this.setTextAttr(e,i),e=this._startText.AABBBounds,i=this._endText.AABBBounds;const{x1:n,x2:o,y1:l,y2:d}=e,{dx:u=0,dy:f=0}=this.attribute.startTextStyle;if(new Bounds().set(n,l,o,d).intersects(i)){const g=this.attribute.orient==="bottom"||this.attribute.orient==="right"?-1:1;this._isHorizontal?this._startText.setAttribute("dy",f+g*Math.abs(i.y1-i.y2)):this._startText.setAttribute("dx",u+g*Math.abs(i.x1-i.x2))}else this._isHorizontal?this._startText.setAttribute("dy",f):this._startText.setAttribute("dx",u)}getLayoutAttrFromConfig(){var e,i,n,o,l,d;if(this._layoutAttrFromConfig)return this._layoutAttrFromConfig;const{position:u,size:f,orient:g,middleHandlerStyle:_={},startHandlerStyle:y={},endHandlerStyle:b={},backgroundStyle:S={}}=this.attribute,{width:v,height:A}=f,x=(i=(e=_.background)===null||e===void 0?void 0:e.size)!==null&&i!==void 0?i:10;let T,C,E;_.visible?this._isHorizontal?(T=v,C=A-x,E={x:u.x,y:u.y+x}):(T=v-x,C=A,E={x:u.x+(g==="left"?x:0),y:u.y}):(T=v,C=A,E=u);const P=(n=y.size)!==null&&n!==void 0?n:this._isHorizontal?C:T,R=(o=b.size)!==null&&o!==void 0?o:this._isHorizontal?C:T;return y.visible&&(this._isHorizontal?(T-=(P+R)/2,E={x:E.x+P/2,y:E.y}):(C-=(P+R)/2,E={x:E.x,y:E.y+P/2})),C+=(l=S.lineWidth/2)!==null&&l!==void 0?l:1,T+=(d=S.lineWidth/2)!==null&&d!==void 0?d:1,this._layoutAttrFromConfig={position:E,width:T,height:C},this._layoutAttrFromConfig}render(){var e,i,n,o,l,d,u,f,g,_,y,b,S,v,A,x,T,C,E,P,R,L,w,B,I,D,O,N,V,H,F,$,G,Y;this._layoutAttrFromConfig=null;const{orient:Q,backgroundStyle:q,backgroundChartStyle:te={},selectedBackgroundStyle:ue={},selectedBackgroundChartStyle:he={},middleHandlerStyle:fe={},startHandlerStyle:pe={},endHandlerStyle:me={},brushSelect:ee,zoomLock:J}=this.attribute,{start:ie,end:le}=this.state,{position:ce,width:j,height:W}=this.getLayoutAttrFromConfig(),K=(e=pe.triggerMinSize)!==null&&e!==void 0?e:40,ne=(i=me.triggerMinSize)!==null&&i!==void 0?i:40,re=this.createOrUpdateChild("dataZoom-container",{},"group");if(this._container=re,this._background=re.createOrUpdateChild("background",Object.assign(Object.assign({x:ce.x,y:ce.y,width:j,height:W,cursor:ee?"crosshair":"auto"},q),{pickable:!J&&((n=q.pickable)===null||n===void 0||n)}),"rect"),!((o=te.line)===null||o===void 0)&&o.visible&&this.setPreviewAttributes("line",re),!((l=te.area)===null||l===void 0)&&l.visible&&this.setPreviewAttributes("area",re),ee&&this.renderDragMask(),this._isHorizontal?this._selectedBackground=re.createOrUpdateChild("selectedBackground",Object.assign(Object.assign({x:ce.x+ie*j,y:ce.y,width:(le-ie)*j,height:W,cursor:ee?"crosshair":"move"},ue),{pickable:!J&&((d=he.pickable)===null||d===void 0||d)}),"rect"):this._selectedBackground=re.createOrUpdateChild("selectedBackground",Object.assign(Object.assign({x:ce.x,y:ce.y+ie*W,width:j,height:(le-ie)*W,cursor:ee?"crosshair":"move"},ue),{pickable:!J&&((u=ue.pickable)===null||u===void 0||u)}),"rect"),!((f=he.line)===null||f===void 0)&&f.visible&&this.setSelectedPreviewAttributes("line",re),!((g=he.area)===null||g===void 0)&&g.visible&&this.setSelectedPreviewAttributes("area",re),this._isHorizontal){if(fe.visible){const se=((_=fe.background)===null||_===void 0?void 0:_.size)||10;this._middleHandlerRect=re.createOrUpdateChild("middleHandlerRect",Object.assign(Object.assign({x:ce.x+ie*j,y:ce.y-se,width:(le-ie)*j,height:se},(y=fe.background)===null||y===void 0?void 0:y.style),{pickable:!J&&((v=(S=(b=fe.background)===null||b===void 0?void 0:b.style)===null||S===void 0?void 0:S.pickable)===null||v===void 0||v)}),"rect"),this._middleHandlerSymbol=re.createOrUpdateChild("middleHandlerSymbol",Object.assign(Object.assign({x:ce.x+(ie+le)/2*j,y:ce.y-se/2,strokeBoundsBuffer:0,angle:0,symbolType:(x=(A=fe.icon)===null||A===void 0?void 0:A.symbolType)!==null&&x!==void 0?x:"square"},fe.icon),{pickable:!J&&((T=fe.icon.pickable)===null||T===void 0||T)}),"symbol")}this._startHandler=re.createOrUpdateChild("startHandler",Object.assign(Object.assign(Object.assign({x:ce.x+ie*j,y:ce.y+W/2,size:W,symbolType:(C=pe.symbolType)!==null&&C!==void 0?C:"square"},DEFAULT_HANDLER_ATTR_MAP.horizontal),pe),{pickable:!J&&((E=pe.pickable)===null||E===void 0||E)}),"symbol"),this._endHandler=re.createOrUpdateChild("endHandler",Object.assign(Object.assign(Object.assign({x:ce.x+le*j,y:ce.y+W/2,size:W,symbolType:(P=me.symbolType)!==null&&P!==void 0?P:"square"},DEFAULT_HANDLER_ATTR_MAP.horizontal),me),{pickable:!J&&((R=me.pickable)===null||R===void 0||R)}),"symbol");const ae=Math.max(this._startHandler.AABBBounds.width(),K),z=Math.max(this._startHandler.AABBBounds.height(),K),U=Math.max(this._endHandler.AABBBounds.width(),ne),X=Math.max(this._endHandler.AABBBounds.height(),ne);this._startHandlerMask=re.createOrUpdateChild("startHandlerMask",Object.assign(Object.assign({x:ce.x+ie*j-ae/2,y:ce.y+W/2-z/2,width:ae,height:z,fill:"white",fillOpacity:0,zIndex:999},DEFAULT_HANDLER_ATTR_MAP.horizontal),{pickable:!J}),"rect"),this._endHandlerMask=re.createOrUpdateChild("endHandlerMask",Object.assign(Object.assign({x:ce.x+le*j-U/2,y:ce.y+W/2-X/2,width:U,height:X,fill:"white",fillOpacity:0,zIndex:999},DEFAULT_HANDLER_ATTR_MAP.horizontal),{pickable:!J}),"rect")}else{if(fe.visible){const se=((L=fe.background)===null||L===void 0?void 0:L.size)||10;this._middleHandlerRect=re.createOrUpdateChild("middleHandlerRect",Object.assign(Object.assign({x:Q==="left"?ce.x-se:ce.x+j,y:ce.y+ie*W,width:se,height:(le-ie)*W},(w=fe.background)===null||w===void 0?void 0:w.style),{pickable:!J&&((D=(I=(B=fe.background)===null||B===void 0?void 0:B.style)===null||I===void 0?void 0:I.pickable)===null||D===void 0||D)}),"rect"),this._middleHandlerSymbol=re.createOrUpdateChild("middleHandlerSymbol",Object.assign(Object.assign({x:Q==="left"?ce.x-se/2:ce.x+j+se/2,y:ce.y+(ie+le)/2*W,angle:Math.PI/180*90,symbolType:(N=(O=fe.icon)===null||O===void 0?void 0:O.symbolType)!==null&&N!==void 0?N:"square",strokeBoundsBuffer:0},fe.icon),{pickable:!J&&((H=(V=fe.icon)===null||V===void 0?void 0:V.pickable)===null||H===void 0||H)}),"symbol")}this._startHandler=re.createOrUpdateChild("startHandler",Object.assign(Object.assign(Object.assign({x:ce.x+j/2,y:ce.y+ie*W,size:j,symbolType:(F=pe.symbolType)!==null&&F!==void 0?F:"square"},DEFAULT_HANDLER_ATTR_MAP.vertical),pe),{pickable:!J&&(($=pe.pickable)===null||$===void 0||$)}),"symbol"),this._endHandler=re.createOrUpdateChild("endHandler",Object.assign(Object.assign(Object.assign({x:ce.x+j/2,y:ce.y+le*W,size:j,symbolType:(G=me.symbolType)!==null&&G!==void 0?G:"square"},DEFAULT_HANDLER_ATTR_MAP.vertical),me),{pickable:!J&&((Y=me.pickable)===null||Y===void 0||Y)}),"symbol");const ae=Math.max(this._startHandler.AABBBounds.width(),K),z=Math.max(this._startHandler.AABBBounds.height(),K),U=Math.max(this._endHandler.AABBBounds.width(),ne),X=Math.max(this._endHandler.AABBBounds.height(),ne);this._startHandlerMask=re.createOrUpdateChild("startHandlerMask",Object.assign(Object.assign({x:ce.x+j/2+ae/2,y:ce.y+ie*W-z/2,width:X,height:U,fill:"white",fillOpacity:0,zIndex:999},DEFAULT_HANDLER_ATTR_MAP.vertical),{pickable:!J}),"rect"),this._endHandlerMask=re.createOrUpdateChild("endHandlerMask",Object.assign(Object.assign({x:ce.x+j/2+U/2,y:ce.y+le*W-X/2,width:X,height:U,fill:"white",fillOpacity:0,zIndex:999},DEFAULT_HANDLER_ATTR_MAP.vertical),{pickable:!J}),"rect")}this._showText&&this.renderText()}computeBasePoints(){const{orient:e}=this.attribute,{position:i,width:n,height:o}=this.getLayoutAttrFromConfig();let l,d;return this._isHorizontal?(l=[{x:i.x,y:i.y+o}],d=[{x:i.x+n,y:i.y+o}]):e==="left"?(l=[{x:i.x+n,y:i.y}],d=[{x:i.x+n,y:i.y+o}]):(l=[{x:i.x,y:i.y+o}],d=[{x:i.x,y:i.y}]),{basePointStart:l,basePointEnd:d}}simplifyPoints(e){var i;if(e.length>1e4){const n=(i=this.attribute.tolerance)!==null&&i!==void 0?i:this._previewData.length/1e4;return flatten_simplify(e,n)}return e}getPreviewLinePoints(){let e=this._previewData.map(o=>({x:this._previewPointsX&&this._previewPointsX(o),y:this._previewPointsY&&this._previewPointsY(o)}));if(e.length===0)return e;e=this.simplifyPoints(e);const{basePointStart:i,basePointEnd:n}=this.computeBasePoints();return i.concat(e).concat(n)}getPreviewAreaPoints(){let e=this._previewData.map(o=>({x:this._previewPointsX&&this._previewPointsX(o),y:this._previewPointsY&&this._previewPointsY(o),x1:this._previewPointsX1&&this._previewPointsX1(o),y1:this._previewPointsY1&&this._previewPointsY1(o)}));if(e.length===0)return e;e=this.simplifyPoints(e);const{basePointStart:i,basePointEnd:n}=this.computeBasePoints();return i.concat(e).concat(n)}setPreviewAttributes(e,i){this._previewGroup||(this._previewGroup=i.createOrUpdateChild("previewGroup",{pickable:!1},"group")),e==="line"?this._previewLine=this._previewGroup.createOrUpdateChild("previewLine",{},"line"):this._previewArea=this._previewGroup.createOrUpdateChild("previewArea",{curveType:"basis"},"area");const{backgroundChartStyle:n={}}=this.attribute;e==="line"&&this._previewLine.setAttributes(Object.assign({points:this.getPreviewLinePoints(),curveType:"basis",pickable:!1},n.line)),e==="area"&&this._previewArea.setAttributes(Object.assign({points:this.getPreviewAreaPoints(),curveType:"basis",pickable:!1},n.area))}setSelectedPreviewAttributes(e,i){this._selectedPreviewGroupClip||(this._selectedPreviewGroupClip=i.createOrUpdateChild("selectedPreviewGroupClip",{pickable:!1},"group"),this._selectedPreviewGroup=this._selectedPreviewGroupClip.createOrUpdateChild("selectedPreviewGroup",{},"group")),e==="line"?this._selectedPreviewLine=this._selectedPreviewGroup.createOrUpdateChild("selectedPreviewLine",{},"line"):this._selectedPreviewArea=this._selectedPreviewGroup.createOrUpdateChild("selectedPreviewArea",{curveType:"basis"},"area");const{selectedBackgroundChartStyle:n={}}=this.attribute,{start:o,end:l}=this.state,{position:d,width:u,height:f}=this.getLayoutAttrFromConfig();this._selectedPreviewGroupClip.setAttributes({x:this._isHorizontal?d.x+o*u:d.x,y:this._isHorizontal?d.y:d.y+o*f,width:this._isHorizontal?(l-o)*u:u,height:this._isHorizontal?f:(l-o)*f,clip:!0,pickable:!1}),this._selectedPreviewGroup.setAttributes({x:-(this._isHorizontal?d.x+o*u:d.x),y:-(this._isHorizontal?d.y:d.y+o*f),width:this._isHorizontal?(l-o)*u:u,height:this._isHorizontal?f:(l-o)*f,pickable:!1}),e==="line"&&this._selectedPreviewLine.setAttributes(Object.assign({points:this.getPreviewLinePoints(),curveType:"basis",pickable:!1},n.line)),e==="area"&&this._selectedPreviewArea.setAttributes(Object.assign({points:this.getPreviewAreaPoints(),curveType:"basis",pickable:!1},n.area))}maybeAddLabel(e,i,n){let o=this.find(l=>l.name===n,!0);return o?o.setAttributes(i):(o=new Tag(i),o.name=n),e.add(o),o}setStartAndEnd(e,i){const{start:n,end:o}=this.attribute;isValid(e)&&isValid(i)&&(e!==this.state.start||i!==this.state.end)&&(this.state.start=e,this.state.end=i,n===this.state.start&&o===this.state.end||(this.setStateAttr(e,i,!0),this._dispatchEvent("change",{start:e,end:i,tag:this._activeTag})))}setPreviewData(e){this._previewData=e}setText(e,i){i==="start"?this._startText.setAttribute("text",e):this._endText.setAttribute("text",e)}getStartValue(){return this._startValue}getEndTextValue(){return this._endValue}getMiddleHandlerSize(){var e,i,n,o;const{middleHandlerStyle:l={}}=this.attribute,d=(i=(e=l.background)===null||e===void 0?void 0:e.size)!==null&&i!==void 0?i:10,u=(o=(n=l.icon)===null||n===void 0?void 0:n.size)!==null&&o!==void 0?o:10;return Math.max(d,...array(u))}setPreviewPointsX(e){isFunction(e)&&(this._previewPointsX=e)}setPreviewPointsY(e){isFunction(e)&&(this._previewPointsY=e)}setPreviewPointsX1(e){isFunction(e)&&(this._previewPointsX1=e)}setPreviewPointsY1(e){isFunction(e)&&(this._previewPointsY1=e)}setStatePointToData(e){isFunction(e)&&(this._statePointToData=e)}};DataZoom$1.defaultAttributes=DEFAULT_DATA_ZOOM_ATTRIBUTES;var IMarkLineLabelPosition;(function(r){r.start="start",r.startTop="startTop",r.startBottom="startBottom",r.insideStart="insideStart",r.insideStartTop="insideStartTop",r.insideStartBottom="insideStartBottom",r.middle="middle",r.insideMiddleTop="insideMiddleTop",r.insideMiddleBottom="insideMiddleBottom",r.end="end",r.endTop="endTop",r.endBottom="endBottom",r.insideEnd="insideEnd",r.insideEndTop="insideEndTop",r.insideEndBottom="insideEndBottom"})(IMarkLineLabelPosition||(IMarkLineLabelPosition={}));var IMarkAreaLabelPosition;(function(r){r.left="left",r.right="right",r.top="top",r.bottom="bottom",r.topLeft="topLeft",r.topRight="topRight",r.bottomLeft="bottomLeft",r.bottomRight="bottomRight",r.middle="middle",r.insideLeft="insideLeft",r.insideRight="insideRight",r.insideTop="insideTop",r.insideBottom="insideBottom",r.insideTopLeft="insideTopLeft",r.insideTopRight="insideTopRight",r.insideBottomLeft="insideBottomLeft",r.insideBottomRight="insideBottomRight"})(IMarkAreaLabelPosition||(IMarkAreaLabelPosition={}));var IMarkCommonArcLabelPosition;(function(r){r.arcInnerStart="arcInnerStart",r.arcInnerEnd="arcInnerEnd",r.arcInnerMiddle="arcInnerMiddle",r.arcOuterStart="arcOuterStart",r.arcOuterEnd="arcOuterEnd",r.arcOuterMiddle="arcOuterMiddle",r.center="center"})(IMarkCommonArcLabelPosition||(IMarkCommonArcLabelPosition={}));var IMarkPointItemPosition;(function(r){r.top="top",r.bottom="bottom",r.middle="middle",r.insideTop="insideTop",r.insideBottom="insideBottom",r.insideMiddle="insideMiddle"})(IMarkPointItemPosition||(IMarkPointItemPosition={}));function loadBaseMarker(){registerGroup(),loadTagComponent()}function loadMarkLineComponent(){loadBaseMarker(),loadSegmentComponent()}function loadMarkArcLineComponent(){loadBaseMarker(),loadArcSegmentComponent()}function loadMarkAreaComponent(){loadBaseMarker(),registerPolygon()}function loadMarkArcAreaComponent(){loadBaseMarker(),registerArc()}function loadMarkPointComponent(){loadBaseMarker(),loadSegmentComponent(),loadArcSegmentComponent(),registerSymbol(),registerImage(),registerLine()}class Marker extends AbstractComponent{constructor(){super(...arguments),this.name="marker",this._onHover=e=>{this._lastHover=dispatchHoverState(e,this._container,this._lastHover)},this._onUnHover=e=>{this._lastHover=dispatchUnHoverState(e,this._container,this._lastHover)},this._onClick=e=>{this._lastSelect=dispatchClickState(e,this._container,this._lastSelect)}}transAnimationConfig(){var e,i,n;if(this.attribute.animation!==!1){const o=isObject$1(this.attribute.animation)?this.attribute.animation:{};this._animationConfig={enter:merge$1({},this.defaultUpdateAnimation,o,(e=this.attribute.animationEnter)!==null&&e!==void 0?e:{}),exit:merge$1({},this.defaultExitAnimation,o,(i=this.attribute.animationExit)!==null&&i!==void 0?i:{}),update:merge$1({},this.defaultUpdateAnimation,o,(n=this.attribute.animationUpdate)!==null&&n!==void 0?n:{})}}}setAttribute(e,i,n){super.setAttribute(e,i,n),e==="visible"&&this.render()}_bindEvent(){var e,i,n;if(!this.attribute.interactive)return;const{hover:o,select:l}=this.attribute;o&&((e=this._container)===null||e===void 0||e.addEventListener("pointermove",this._onHover),(i=this._container)===null||i===void 0||i.addEventListener("pointerout",this._onUnHover)),l&&((n=this._container)===null||n===void 0||n.addEventListener("pointerdown",this._onClick))}_releaseEvent(){var e,i,n;(e=this._container)===null||e===void 0||e.removeEventListener("pointermove",this._onHover),(i=this._container)===null||i===void 0||i.removeEventListener("pointerout",this._onUnHover),(n=this._container)===null||n===void 0||n.removeEventListener("pointerdown",this._onClick)}_initContainer(){var e,i;const{limitRect:n={},clipInRange:o}=this.attribute;let l;if(o){const d=graphicCreator.group(Object.assign(Object.assign({},n),{clip:!0,pickable:!1}));l=graphicCreator.group({x:-((e=n.x)!==null&&e!==void 0?e:0),y:-((i=n.y)!==null&&i!==void 0?i:0),pickable:!1}),d.add(l),this._containerClip=d,this.add(d)}else l=graphicCreator.group({x:0,y:0,pickable:!1}),this.add(l);l.name="marker-container",this._container=l}_updateContainer(){var e,i;const{limitRect:n={},clipInRange:o}=this.attribute;this._containerClip&&this._containerClip.setAttributes(Object.assign({},n)),this._container.setAttributes({x:o?-((e=n.x)!==null&&e!==void 0?e:0):0,y:o?-((i=n.y)!==null&&i!==void 0?i:0):0})}render(){var e;this.transAnimationConfig(),this.setAttribute("pickable",!1);const i=(e=this.attribute.visible)===null||e===void 0||e;this.attribute.interactive===!1&&this.setAttribute("childrenPickable",!1),i&&this.isValidPoints()?this._container?(this._updateContainer(),this.updateMarker(),this.markerAnimate("update")):(this._initContainer(),this.initMarker(this._container),this.markerAnimate("enter")):(this.markerAnimate("exit"),this._container=null,this.removeAllChild(!0)),this._releaseEvent(),this._bindEvent()}release(){this.markerAnimate("exit"),super.release(),this._releaseEvent(),this._container=null}}function graphicFadeIn(r,e,i,n){var o,l,d,u,f;if(!r)return;(o=r==null?void 0:r.animates)===null||o===void 0||o.forEach(y=>y.stop("end"));const g=(d=(l=r.attribute)===null||l===void 0?void 0:l.fillOpacity)!==null&&d!==void 0?d:1,_=(f=(u=r.attribute)===null||u===void 0?void 0:u.strokeOpacity)!==null&&f!==void 0?f:1;r.setAttributes({fillOpacity:0,strokeOpacity:0}),r.animate().wait(e).to({fillOpacity:g,strokeOpacity:_},i,n)}function segmentFadeIn(r,e,i,n){r&&(graphicFadeIn(r.startSymbol,e,i,n),r.lines.forEach(o=>graphicFadeIn(o,e,i,n)),graphicFadeIn(r.line,e,i,n),graphicFadeIn(r.endSymbol,e,i,n))}function tagFadeIn(r,e,i,n){r&&(graphicFadeIn(r.getTextShape(),e,i,n),graphicFadeIn(r.getBgRect(),e,i,n))}function graphicFadeOut(r,e,i,n){var o,l,d,u;r&&(r.setAttributes({fillOpacity:(l=(o=r.attribute)===null||o===void 0?void 0:o.fillOpacity)!==null&&l!==void 0?l:1,strokeOpacity:(u=(d=r.attribute)===null||d===void 0?void 0:d.strokeOpacity)!==null&&u!==void 0?u:1}),r.animate().wait(e).to({fillOpacity:0,strokeOpacity:0},i,n))}function segmentFadeOut(r,e,i,n){r&&(graphicFadeOut(r.startSymbol,e,i,n),r.lines.forEach(o=>graphicFadeOut(o,e,i,n)),graphicFadeOut(r.line,e,i,n),graphicFadeOut(r.endSymbol,e,i,n))}function tagFadeOut(r,e,i,n){r&&(graphicFadeOut(r.getTextShape(),e,i,n),graphicFadeOut(r.getBgRect(),e,i,n))}function commonLineClipIn(r,e,i,n,o){const l=.1*i,d=.7*i,u=.1*i,f=.1*i;graphicFadeIn(r.startSymbol,n,l,o),r.lines.forEach(g=>g.setAttribute("clipRange",0)),r.lines.forEach((g,_)=>{const y=d/r.lines.length;g.animate().wait(n+l+_*y).to({clipRange:1},y,o)}),graphicFadeIn(r.endSymbol,n+l+d,u,o),graphicFadeIn(e.getTextShape(),n+l+d+u,f,o),graphicFadeIn(e.getBgRect(),n+l+d+u,f,o)}function commonLineFadeIn(r,e,i,n,o){segmentFadeIn(r,n,i,o),tagFadeIn(e,n,i,o)}function areaFadeIn(r,e,i,n,o){graphicFadeIn(r,n,i,o),tagFadeIn(e,n,i,o)}function arcAreaFadeIn(r,e,i,n,o){graphicFadeIn(r,n,i,o),tagFadeIn(e,n,i,o)}function pointFadeIn(r,e,i,n,o,l){var d;segmentFadeIn(r,o,n,l),graphicFadeIn(e,o,n,l),!((d=i.getTextShape)===null||d===void 0)&&d.call(i)?tagFadeIn(i,o,n,l):graphicFadeIn(i,o,n,l)}function commonLineFadeOut(r,e,i,n,o){segmentFadeOut(r,n,i,o),tagFadeOut(e,n,i,o)}function areaFadeOut(r,e,i,n,o){graphicFadeOut(r,n,i,o),tagFadeOut(e,n,i,o)}function arcAreaFadeOut(r,e,i,n,o){graphicFadeOut(r,n,i,o),tagFadeOut(e,n,i,o)}function pointFadeOut(r,e,i,n,o,l){var d;segmentFadeOut(r,o,n,l),graphicFadeOut(e,o,n,l),!((d=i.getTextShape)===null||d===void 0)&&d.call(i)?tagFadeOut(i,o,n,l):graphicFadeOut(i,o,n,l)}function pointCallIn(r,e,i,n,o,l){var d;const u=.1*n,f=.65*n,g=.05*n,_=.1*n,y=.1*n;graphicFadeIn(r.startSymbol,o,u,l),r.lines.forEach(b=>b.setAttribute("clipRange",0)),r.lines.forEach((b,S)=>{const v=f/r.lines.length;b.animate().wait(o+u+S*v).to({clipRange:1},v,l)}),graphicFadeIn(e,o+u+f,g,l),graphicFadeIn(r.endSymbol,o+u+f+g,_,l),!((d=i.getTextShape)===null||d===void 0)&&d.call(i)?(graphicFadeIn(i.getTextShape(),o+u+f+g+_,y,l),graphicFadeIn(i.getBgRect(),o+u+f+_,y,l)):graphicFadeIn(i,o+u+f+_,y,l)}function markCommonLineAnimate(r,e,i,n){const{enter:o,update:l,exit:d}=i;if(n==="enter"){const{type:u,duration:f,delay:g,easing:_}=o;u==="clipIn"?commonLineClipIn(r,e,f,g,_):u==="fadeIn"&&commonLineFadeIn(r,e,f,g,_)}else if(n==="update"){const{type:u,duration:f,delay:g,easing:_}=l;u==="clipIn"?commonLineClipIn(r,e,f,g,_):u==="fadeIn"&&commonLineFadeIn(r,e,f,g,_)}else if(n==="exit"){const{duration:u,delay:f,easing:g}=d;commonLineFadeOut(r,e,u,f,g)}}function markAreaAnimate(r,e,i,n){const{enter:o,update:l,exit:d}=i;if(n==="enter"){const{type:u,duration:f,delay:g,easing:_}=o;u==="fadeIn"&&areaFadeIn(r,e,f,g,_)}else if(n==="update"){const{type:u,duration:f,delay:g,easing:_}=l;u==="fadeIn"&&areaFadeIn(r,e,f,g,_)}else if(n==="exit"){const{duration:u,delay:f,easing:g}=d;areaFadeOut(r,e,u,f,g)}}function markArcAreaAnimate(r,e,i,n){const{enter:o,update:l,exit:d}=i;if(n==="enter"){const{type:u,duration:f,delay:g,easing:_}=o;u==="fadeIn"&&arcAreaFadeIn(r,e,f,g,_)}else if(n==="update"){const{type:u,duration:f,delay:g,easing:_}=l;u==="fadeIn"&&arcAreaFadeIn(r,e,f,g,_)}else if(n==="exit"){const{duration:u,delay:f,easing:g}=d;arcAreaFadeOut(r,e,u,f,g)}}function markPointAnimate(r,e,i,n){const[o,l]=r,{enter:d,update:u,exit:f}=i;if(n==="enter"){const{type:g,duration:_,delay:y,easing:b}=d;g==="fadeIn"?pointFadeIn(o,l,e,_,y,b):g==="callIn"&&pointCallIn(o,l,e,_,y,b)}else if(n==="update"){const{type:g,duration:_,delay:y,easing:b}=u;g==="fadeIn"?pointFadeIn(o,l,e,_,y,b):g==="callIn"&&pointCallIn(o,l,e,_,y,b)}else if(n==="exit"){const{duration:g,delay:_,easing:y}=f;pointFadeOut(o,l,e,g,_,y)}}const DefaultUpdateMarkLineAnimation={type:"clipIn",duration:500,easing:"linear",delay:0},DefaultUpdateMarkAreaAnimation={type:"fadeIn",duration:500,easing:"linear",delay:0},DefaultUpdateMarkPointAnimation={type:"callIn",duration:500,easing:"linear",delay:0},DefaultExitMarkerAnimation={type:"fadeOut",duration:500,easing:"linear",delay:0};class MarkCommonLine extends Marker{constructor(){super(...arguments),this.name="markCommonLine",this.defaultUpdateAnimation=DefaultUpdateMarkLineAnimation,this.defaultExitAnimation=DefaultExitMarkerAnimation}getLine(){return this._line}getLabel(){return this._label}setLabelPos(){const{label:e={},limitRect:i}=this.attribute,{position:n,confine:o,autoRotate:l}=e,d=this.getPointAttrByPosition(n),u=n.toString().toLocaleLowerCase().includes("start")?this._line.getStartAngle()||0:this._line.getEndAngle()||0;if(this._label.setAttributes(Object.assign(Object.assign({},d.position),{angle:l?this.getRotateByAngle(d.angle):0,textStyle:Object.assign(Object.assign({},this.getTextStyle(n,u,l)),e.textStyle)})),i&&o){const{x:f,y:g,width:_,height:y}=i;limitShapeInBounds(this._label,{x1:f,y1:g,x2:f+_,y2:g+y})}}initMarker(e){const{label:i,state:n}=this.attribute,o=this.createSegment();o.name="mark-common-line-line",this._line=o,e.add(o);const l=new Tag(Object.assign(Object.assign({},i),{state:{panel:merge$1({},DEFAULT_STATES$2,n==null?void 0:n.labelBackground),text:merge$1({},DEFAULT_STATES$2,n==null?void 0:n.label)}}));l.name="mark-common-line-label",this._label=l,e.add(l),this.setLabelPos()}updateMarker(){const{label:e,state:i}=this.attribute;this.setLineAttributes(),this._label&&(this._label.setAttributes(Object.assign(Object.assign({dx:0,dy:0},e),{state:{panel:merge$1({},DEFAULT_STATES$2,i==null?void 0:i.labelBackground),text:merge$1({},DEFAULT_STATES$2,i==null?void 0:i.label)}})),this.setLabelPos())}}const FUZZY_EQUAL_DELTA=.001,DEFAULT_MARK_LINE_THEME={interactive:!0,startSymbol:{visible:!1,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},endSymbol:{visible:!0,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},label:{position:IMarkLineLabelPosition.end,refX:0,refY:0,refAngle:0,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},DEFAULT_CARTESIAN_MARK_LINE_TEXT_STYLE_MAP={postiveXAxis:{start:{textAlign:"left",textBaseline:"middle"},startTop:{textAlign:"left",textBaseline:"bottom"},startBottom:{textAlign:"left",textBaseline:"top"},insideStart:{textAlign:"right",textBaseline:"middle"},insideStartTop:{textAlign:"right",textBaseline:"bottom"},insideStartBottom:{textAlign:"right",textBaseline:"top"},middle:{textAlign:"center",textBaseline:"middle"},insideMiddleTop:{textAlign:"center",textBaseline:"bottom"},insideMiddleBottom:{textAlign:"center",textBaseline:"top"},end:{textAlign:"left",textBaseline:"middle"},endTop:{textAlign:"left",textBaseline:"bottom"},endBottom:{textAlign:"left",textBaseline:"top"},insideEnd:{textAlign:"right",textBaseline:"middle"},insideEndTop:{textAlign:"right",textBaseline:"bottom"},insideEndBottom:{textAlign:"right",textBaseline:"top"}},negativeXAxis:{start:{textAlign:"right",textBaseline:"middle"},startTop:{textAlign:"right",textBaseline:"bottom"},startBottom:{textAlign:"right",textBaseline:"top"},insideStart:{textAlign:"left",textBaseline:"middle"},insideStartTop:{textAlign:"left",textBaseline:"bottom"},insideStartBottom:{textAlign:"left",textBaseline:"top"},middle:{textAlign:"center",textBaseline:"middle"},insideMiddleTop:{textAlign:"center",textBaseline:"bottom"},insideMiddleBottom:{textAlign:"center",textBaseline:"top"},end:{textAlign:"right",textBaseline:"middle"},endTop:{textAlign:"right",textBaseline:"bottom"},endBottom:{textAlign:"right",textBaseline:"top"},insideEnd:{textAlign:"left",textBaseline:"middle"},insideEndTop:{textAlign:"left",textBaseline:"bottom"},insideEndBottom:{textAlign:"left",textBaseline:"top"}}},DEFAULT_MARK_ARC_LINE_THEME={interactive:!0,startSymbol:{visible:!1,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},endSymbol:{visible:!0,symbolType:"triangle",size:12,fill:"rgba(46, 47, 50)",lineWidth:0},label:{position:IMarkCommonArcLabelPosition.arcOuterMiddle,refX:0,refY:0,refAngle:0,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},lineStyle:{stroke:"#b2bacf",lineWidth:1,lineDash:[2]}},DEFAULT_MARK_AREA_THEME={interactive:!0,label:{position:IMarkAreaLabelPosition.right,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},areaStyle:{fill:"#b2bacf",visible:!0}},DEFAULT_MARK_ARC_AREA_THEME={interactive:!0,label:{position:IMarkCommonArcLabelPosition.arcOuterMiddle,textStyle:{fill:"#fff",stroke:"#fff",lineWidth:0,fontSize:10,fontWeight:"normal",fontStyle:"normal"},padding:[2,2,4,4],panel:{visible:!0,cornerRadius:0,fill:"rgb(48, 115, 242)",fillOpacity:.8}},areaStyle:{fill:"#b2bacf",visible:!0}},DEFAULT_POLAR_MARKER_TEXT_STYLE_MAP={arcInnerStart:{textAlign:"center",textBaseline:"bottom"},arcInnerEnd:{textAlign:"center",textBaseline:"bottom"},arcInnerMiddle:{textAlign:"center",textBaseline:"bottom"},arcOuterStart:{textAlign:"center",textBaseline:"top"},arcOuterEnd:{textAlign:"center",textBaseline:"top"},arcOuterMiddle:{textAlign:"center",textBaseline:"top"},center:{textAlign:"center",textBaseline:"middle"}},DEFAULT_CARTESIAN_MARK_AREA_TEXT_STYLE_MAP={left:{textAlign:"right",textBaseline:"middle"},insideLeft:{textAlign:"left",textBaseline:"middle"},right:{textAlign:"left",textBaseline:"middle"},insideRight:{textAlign:"right",textBaseline:"middle"},top:{textAlign:"center",textBaseline:"bottom"},insideTop:{textAlign:"center",textBaseline:"top"},bottom:{textAlign:"center",textBaseline:"top"},insideBottom:{textAlign:"center",textBaseline:"bottom"},middle:{textAlign:"center",textBaseline:"middle"},topLeft:{textAlign:"right",textBaseline:"top"},insideTopLeft:{textAlign:"left",textBaseline:"top"},topRight:{textAlign:"left",textBaseline:"top"},insideTopRight:{textAlign:"right",textBaseline:"top"},bottomLeft:{textAlign:"right",textBaseline:"bottom"},insideBottomLeft:{textAlign:"left",textBaseline:"bottom"},bottomRight:{textAlign:"left",textBaseline:"bottom"},insideBottomRight:{textAlign:"right",textBaseline:"bottom"}},DEFAULT_MARK_POINT_THEME={interactive:!0,targetSymbol:{visible:!1,offset:0,style:{symbolType:"circle",size:20,fill:!1,stroke:"rgba(46, 47, 50)"}},itemLine:{visible:!0,decorativeLine:{visible:!1,length:30},startSymbol:{visible:!0,clip:!0,symbolType:"circle",size:20,style:{fill:!1,stroke:"rgba(46, 47, 50)"}},endSymbol:{visible:!1,clip:!0,symbolType:"triangle",size:12,style:{fill:!1,stroke:"rgba(46, 47, 50)"}},lineStyle:{stroke:"#000",lineWidth:1}},itemContent:{type:"text",position:"middle",refX:10,symbolStyle:{symbolType:"star",fill:"rgb(48, 115, 242)",fillOpacity:.8,size:20},textStyle:{dx:0,dy:0},imageStyle:{width:80,height:80},richTextStyle:{width:100,height:100}}},DEFAULT_MARK_POINT_TEXT_STYLE_MAP={postiveXAxis:{top:{textAlign:"left",textBaseline:"bottom"},bottom:{textAlign:"left",textBaseline:"top"},middle:{textAlign:"left",textBaseline:"middle"},insideTop:{textAlign:"right",textBaseline:"bottom"},insideBottom:{textAlign:"right",textBaseline:"top"},insideMiddle:{textAlign:"right",textBaseline:"middle"}},negativeXAxis:{top:{textAlign:"right",textBaseline:"bottom"},bottom:{textAlign:"right",textBaseline:"top"},middle:{textAlign:"right",textBaseline:"middle"},insideTop:{textAlign:"left",textBaseline:"bottom"},insideBottom:{textAlign:"left",textBaseline:"top"},insideMiddle:{textAlign:"left",textBaseline:"middle"}}};loadMarkLineComponent();function registerMarkLineAnimate(){MarkLine._animate=markCommonLineAnimate}class MarkLine extends MarkCommonLine{markerAnimate(e){MarkLine._animate&&this._animationConfig&&MarkLine._animate(this._line,this._label,this._animationConfig,e)}constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},MarkLine.defaultAttributes,e)),this.name="markLine"}getPointAttrByPosition(e){var i;const{label:n={}}=this.attribute,{refX:o=0,refY:l=0}=n,d=this._line.getMainSegmentPoints(),u=(i=this._line.getEndAngle())!==null&&i!==void 0?i:0,f=u,g=o*Math.cos(f)+l*Math.cos(f-Math.PI/2),_=o*Math.sin(f)+l*Math.sin(f-Math.PI/2);return e.includes("start")||e.includes("Start")?{position:{x:d[0].x+g,y:d[0].y+_},angle:f}:e.includes("middle")||e.includes("Middle")?{position:{x:(d[0].x+d[d.length-1].x)/2+g,y:(d[0].y+d[d.length-1].y)/2+_},angle:f}:{position:{x:d[d.length-1].x+g,y:d[d.length-1].y+_},angle:f}}getRotateByAngle(e){var i;return(isPostiveXAxis(e)?e:e-Math.PI)+((i=this.attribute.label.refAngle)!==null&&i!==void 0?i:0)}getTextStyle(e,i,n){return fuzzyEqualNumber(Math.abs(i),Math.PI/2,FUZZY_EQUAL_DELTA)||fuzzyEqualNumber(Math.abs(i),3*Math.PI/2,FUZZY_EQUAL_DELTA)?getTextAlignAttrOfVerticalDir(n,i,e):isPostiveXAxis(i)?DEFAULT_CARTESIAN_MARK_LINE_TEXT_STYLE_MAP.postiveXAxis[e]:DEFAULT_CARTESIAN_MARK_LINE_TEXT_STYLE_MAP.negativeXAxis[e]}createSegment(){const{points:e,startSymbol:i,endSymbol:n,lineStyle:o,mainSegmentIndex:l,multiSegment:d,state:u}=this.attribute;return new Segment({points:e,startSymbol:i,endSymbol:n,lineStyle:o,mainSegmentIndex:l,multiSegment:d,pickable:!1,state:{line:merge$1({},DEFAULT_STATES$2,u==null?void 0:u.line),startSymbol:merge$1({},DEFAULT_STATES$2,u==null?void 0:u.lineStartSymbol),endSymbol:merge$1({},DEFAULT_STATES$2,u==null?void 0:u.lineEndSymbol)}})}setLineAttributes(){const{points:e,startSymbol:i,endSymbol:n,lineStyle:o,mainSegmentIndex:l,multiSegment:d,state:u}=this.attribute;this._line&&this._line.setAttributes({points:e,startSymbol:i,endSymbol:n,lineStyle:o,mainSegmentIndex:l,multiSegment:d,state:{line:merge$1({},DEFAULT_STATES$2,u==null?void 0:u.line),startSymbol:merge$1({},DEFAULT_STATES$2,u==null?void 0:u.lineStartSymbol),endSymbol:merge$1({},DEFAULT_STATES$2,u==null?void 0:u.lineEndSymbol)}})}isValidPoints(){const{points:e}=this.attribute;if(!e||e.length<2)return!1;let i=!0;return e.forEach(n=>{if(n.length)n.forEach(o=>{isValidNumber(o.x)&&isValidNumber(o.y)||(i=!1)});else if(!isValidNumber(n.x)||!isValidNumber(n.y))return void(i=!1)}),i}}MarkLine.defaultAttributes=DEFAULT_MARK_LINE_THEME;loadMarkAreaComponent();function registerMarkAreaAnimate(){MarkArea._animate=markAreaAnimate}class MarkArea extends Marker{markerAnimate(e){MarkArea._animate&&this._animationConfig&&MarkArea._animate(this._area,this._label,this._animationConfig,e)}getArea(){return this._area}getLabel(){return this._label}constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},MarkArea.defaultAttributes,e)),this.name="markArea",this.defaultUpdateAnimation=DefaultUpdateMarkAreaAnimation,this.defaultExitAnimation=DefaultExitMarkerAnimation}getPointAttrByPosition(e){const{x1:i,x2:n,y1:o,y2:l}=this._area.AABBBounds,d={x:(i+n)/2,y:(o+l)/2};return(e.includes("left")||e.includes("Left"))&&(d.x=i),(e.includes("right")||e.includes("Right"))&&(d.x=n),(e.includes("top")||e.includes("Top"))&&(d.y=o),(e.includes("bottom")||e.includes("Bottom"))&&(d.y=l),d}setLabelPos(){var e;if(this._label&&this._area){const{label:i={}}=this.attribute,n=(e=i.position)!==null&&e!==void 0?e:"middle",o=this.getPointAttrByPosition(n);if(this._label.setAttributes(Object.assign(Object.assign({},o),{textStyle:Object.assign(Object.assign({},DEFAULT_CARTESIAN_MARK_AREA_TEXT_STYLE_MAP[n]),i.textStyle)})),this.attribute.limitRect&&i.confine){const{x:l,y:d,width:u,height:f}=this.attribute.limitRect;limitShapeInBounds(this._label,{x1:l,y1:d,x2:l+u,y2:d+f})}}}initMarker(e){const{points:i,label:n,areaStyle:o,state:l}=this.attribute,d=graphicCreator.polygon(Object.assign({points:i},o));d.states=merge$1({},DEFAULT_STATES$2,l==null?void 0:l.area),d.name="mark-area-polygon",this._area=d,e.add(d);const u=new Tag(Object.assign(Object.assign({},n),{state:{panel:merge$1({},DEFAULT_STATES$2,l==null?void 0:l.labelBackground),text:merge$1({},DEFAULT_STATES$2,l==null?void 0:l.label)}}));u.name="mark-area-label",this._label=u,e.add(u),this.setLabelPos()}updateMarker(){const{points:e,label:i,areaStyle:n,state:o}=this.attribute;this._area&&(this._area.setAttributes(Object.assign({points:e},n)),this._area.states=merge$1({},DEFAULT_STATES$2,o==null?void 0:o.area)),this._label&&this._label.setAttributes(Object.assign(Object.assign({dx:0,dy:0},i),{state:{panel:merge$1({},DEFAULT_STATES$2,o==null?void 0:o.labelBackground),text:merge$1({},DEFAULT_STATES$2,o==null?void 0:o.label)}})),this.setLabelPos()}isValidPoints(){const{points:e}=this.attribute;if(!e||e.length<3)return!1;let i=!0;return e.forEach(n=>{isValidNumber(n.x)&&isValidNumber(n.y)||(i=!1)}),i}}MarkArea.defaultAttributes=DEFAULT_MARK_AREA_THEME;loadMarkArcLineComponent();function registerMarkArcLineAnimate(){MarkArcLine._animate=markCommonLineAnimate}class MarkArcLine extends MarkCommonLine{markerAnimate(e){MarkArcLine._animate&&this._animationConfig&&MarkArcLine._animate(this._line,this._label,this._animationConfig,e)}constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},MarkArcLine.defaultAttributes,e,{label:{autoRotate:!0}})),this.name="markArcLine"}getPointAttrByPosition(e){const{center:i,radius:n,startAngle:o,endAngle:l,label:d}=this.attribute,{refX:u=0,refY:f=0}=d;let g;switch(e){case IMarkCommonArcLabelPosition.arcInnerStart:g=o;case IMarkCommonArcLabelPosition.arcOuterStart:g=o;break;case IMarkCommonArcLabelPosition.arcInnerEnd:g=l;case IMarkCommonArcLabelPosition.arcOuterEnd:g=l;break;case IMarkCommonArcLabelPosition.center:case IMarkCommonArcLabelPosition.arcInnerMiddle:case IMarkCommonArcLabelPosition.arcOuterMiddle:default:g=(o+l)/2}return{position:{x:i.x+(n+f)*Math.cos(g)+u*Math.cos(g-Math.PI/2),y:i.y+(n+f)*Math.sin(g)+u*Math.sin(g-Math.PI/2)},angle:g}}getTextStyle(e){return DEFAULT_POLAR_MARKER_TEXT_STYLE_MAP[e]}getRotateByAngle(e){var i;return e-Math.PI/2+((i=this.attribute.label.refAngle)!==null&&i!==void 0?i:0)}createSegment(){const{center:e,radius:i,startAngle:n,endAngle:o,startSymbol:l,endSymbol:d,lineStyle:u,state:f}=this.attribute;return new ArcSegment({center:e,radius:i,startAngle:n,endAngle:o,startSymbol:l,endSymbol:d,lineStyle:u,state:{line:merge$1({},DEFAULT_STATES$2,f==null?void 0:f.line),startSymbol:merge$1({},DEFAULT_STATES$2,f==null?void 0:f.lineStartSymbol),endSymbol:merge$1({},DEFAULT_STATES$2,f==null?void 0:f.lineEndSymbol)}})}setLineAttributes(){const{center:e,radius:i,startAngle:n,endAngle:o,startSymbol:l,endSymbol:d,lineStyle:u,state:f}=this.attribute;this._line&&this._line.setAttributes({center:e,radius:i,startAngle:n,endAngle:o,startSymbol:l,endSymbol:d,lineStyle:u,state:{line:merge$1({},DEFAULT_STATES$2,f==null?void 0:f.line),startSymbol:merge$1({},DEFAULT_STATES$2,f==null?void 0:f.lineStartSymbol),endSymbol:merge$1({},DEFAULT_STATES$2,f==null?void 0:f.lineEndSymbol)}})}isValidPoints(){return!0}}MarkArcLine.defaultAttributes=DEFAULT_MARK_ARC_LINE_THEME;loadMarkArcAreaComponent();function registerMarkArcAreaAnimate(){MarkArcArea._animate=markArcAreaAnimate}class MarkArcArea extends Marker{markerAnimate(e){MarkArcArea._animate&&this._animationConfig&&MarkArcArea._animate(this._area,this._label,this._animationConfig,e)}getArea(){return this._area}getLabel(){return this._label}constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},MarkArcArea.defaultAttributes,e,{label:{autoRotate:!0}})),this.name="markArcArea",this.defaultUpdateAnimation=DefaultUpdateMarkAreaAnimation,this.defaultExitAnimation=DefaultExitMarkerAnimation}getPointAttrByPosition(e){const{center:i,innerRadius:n,outerRadius:o,startAngle:l,endAngle:d,label:u}=this.attribute,{refX:f=0,refY:g=0}=u;let _,y;switch(e){case IMarkCommonArcLabelPosition.center:_=(n+o)/2,y=(l+d)/2;break;case IMarkCommonArcLabelPosition.arcInnerStart:_=n,y=l;break;case IMarkCommonArcLabelPosition.arcOuterStart:_=o,y=l;break;case IMarkCommonArcLabelPosition.arcInnerEnd:_=n,y=d;break;case IMarkCommonArcLabelPosition.arcOuterEnd:_=o,y=d;break;case IMarkCommonArcLabelPosition.arcInnerMiddle:_=n,y=(l+d)/2;break;case IMarkCommonArcLabelPosition.arcOuterMiddle:_=o,y=(l+d)/2;break;default:_=n,y=(l+d)/2}return{position:{x:i.x+(_+g)*Math.cos(y)+f*Math.cos(y-Math.PI/2),y:i.y+(_+g)*Math.sin(y)+f*Math.sin(y-Math.PI/2)},angle:y}}setLabelPos(){var e;if(this._label&&this._area){const{label:i={}}=this.attribute,{position:n="arcInnerMiddle",autoRotate:o}=i,l=this.getPointAttrByPosition(n);if(this._label.setAttributes(Object.assign(Object.assign({},l.position),{angle:o?l.angle-Math.PI/2+((e=i.refAngle)!==null&&e!==void 0?e:0):0,textStyle:Object.assign(Object.assign({},DEFAULT_POLAR_MARKER_TEXT_STYLE_MAP[n]),i.textStyle)})),this.attribute.limitRect&&i.confine){const{x:d,y:u,width:f,height:g}=this.attribute.limitRect;limitShapeInBounds(this._label,{x1:d,y1:u,x2:d+f,y2:u+g})}}}initMarker(e){const{center:i,innerRadius:n,outerRadius:o,startAngle:l,endAngle:d,areaStyle:u,label:f,state:g}=this.attribute,_=graphicCreator.arc(Object.assign({x:i.x,y:i.y,innerRadius:n,outerRadius:o,startAngle:l,endAngle:d},u));_.states=merge$1({},DEFAULT_STATES$2,g==null?void 0:g.area),_.name="polar-mark-area-area",this._area=_,e.add(_);const y=new Tag(Object.assign(Object.assign({},f),{state:{panel:merge$1({},DEFAULT_STATES$2,g==null?void 0:g.labelBackground),text:merge$1({},DEFAULT_STATES$2,g==null?void 0:g.label)}}));y.name="mark-area-label",this._label=y,e.add(y),this.setLabelPos()}updateMarker(){const{center:e,innerRadius:i,outerRadius:n,startAngle:o,endAngle:l,areaStyle:d,label:u,state:f}=this.attribute;this._area&&(this._area.setAttributes(Object.assign({x:e.x,y:e.y,innerRadius:i,outerRadius:n,startAngle:o,endAngle:l},d)),this._area.states=merge$1({},DEFAULT_STATES$2,f==null?void 0:f.area)),this._label&&(this._label.setAttributes(Object.assign(Object.assign({dx:0,dy:0},u),{state:{panel:merge$1({},DEFAULT_STATES$2,f==null?void 0:f.labelBackground),text:merge$1({},DEFAULT_STATES$2,f==null?void 0:f.label)}})),this.setLabelPos())}isValidPoints(){return!0}}MarkArcArea.defaultAttributes=DEFAULT_MARK_ARC_AREA_THEME;loadMarkPointComponent();function registerMarkPointAnimate(){MarkPoint._animate=markPointAnimate}class MarkPoint extends Marker{markerAnimate(e){MarkPoint._animate&&this._animationConfig&&MarkPoint._animate([this._line,this._decorativeLine],this._item,this._animationConfig,e)}constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},MarkPoint.defaultAttributes,e)),this.name="markPoint",this.defaultUpdateAnimation=DefaultUpdateMarkPointAnimation,this.defaultExitAnimation=DefaultExitMarkerAnimation,this._isArcLine=!1,this._isStraightLine=!1}setLabelPos(){}getTextAlignAttr(e,i,n,o,l){return fuzzyEqualNumber(Math.abs(o),Math.PI/2,FUZZY_EQUAL_DELTA)||fuzzyEqualNumber(Math.abs(o),3*Math.PI/2,FUZZY_EQUAL_DELTA)?getTextAlignAttrOfVerticalDir(e,o,l):isPostiveXAxis(o)?DEFAULT_MARK_POINT_TEXT_STYLE_MAP.postiveXAxis[l]:DEFAULT_MARK_POINT_TEXT_STYLE_MAP.negativeXAxis[l]}setItemAttributes(e,i,n,o,l){var d,u;if(!e)return;const{autoRotate:f=!0,refX:g=0,refY:_=0,refAngle:y=0,textStyle:b={},richTextStyle:S={},imageStyle:v={},position:A=IMarkPointItemPosition.middle}=i,{state:x}=this.attribute,T=((d=this._line)===null||d===void 0?void 0:d.getEndAngle())||0,C=g*Math.cos(T)+_*Math.cos(T-Math.PI/2),E=g*Math.sin(T)+_*Math.sin(T-Math.PI/2);if(l==="text"){const R=o.x-n.x,L=o.y-n.y;e.setAttributes(Object.assign(Object.assign({},b),{textStyle:Object.assign(Object.assign({},this.getTextAlignAttr(f,R,L,T,(u=i.position)!==null&&u!==void 0?u:"end")),b.textStyle),state:{panel:merge$1({},DEFAULT_STATES$2,x==null?void 0:x.textBackground),text:merge$1({},DEFAULT_STATES$2,x==null?void 0:x.text)}}))}else l==="richText"?(e.setAttributes({dx:this.getItemDx(e,A,S)+(S.dx||0),dy:this.getItemDy(e,A,S)+(S.dy||0)}),e.states=merge$1({},DEFAULT_STATES$2,x==null?void 0:x.richText)):l==="image"&&(e.setAttributes({dx:this.getItemDx(e,A,v)+(v.dx||0),dy:this.getItemDy(e,A,v)+(v.dy||0)}),e.states=merge$1({},DEFAULT_STATES$2,x==null?void 0:x.image));const P=isPostiveXAxis(T)?T:T-Math.PI;e.setAttributes({x:o.x+(C||0),y:o.y+(E||0),angle:f&&P+y})}getItemDx(e,i,n){var o,l;const d=(l=(o=e==null?void 0:e.AABBBounds)===null||o===void 0?void 0:o.width())!==null&&l!==void 0?l:(n==null?void 0:n.width)||0;return i.includes("inside")?-d:0}getItemDy(e,i,n){var o,l;const d=(l=(o=e==null?void 0:e.AABBBounds)===null||o===void 0?void 0:o.height())!==null&&l!==void 0?l:(n==null?void 0:n.height)||0;return i.includes("top")||i.includes("Top")?-d:i.includes("middle")||i.includes("Middle")?-d/2:0}initItem(e,i,n){const{state:o}=this.attribute,{type:l="text",symbolStyle:d,richTextStyle:u,imageStyle:f,renderCustomCallback:g}=e;let _;return l==="symbol"?(_=graphicCreator.symbol(Object.assign(Object.assign({},n),d)),_.states=merge$1({},DEFAULT_STATES$2,o==null?void 0:o.symbol)):l==="text"?_=new Tag(Object.assign(Object.assign({},n),{state:{panel:merge$1({},DEFAULT_STATES$2,o==null?void 0:o.textBackground),text:merge$1({},DEFAULT_STATES$2,o==null?void 0:o.text)}})):l==="richText"?(_=graphicCreator.richtext(Object.assign(Object.assign({},n),u)),_.states=merge$1({},DEFAULT_STATES$2,o==null?void 0:o.richText)):l==="image"?(_=graphicCreator.image(Object.assign(Object.assign({},n),f)),_.states=merge$1({},DEFAULT_STATES$2,o==null?void 0:o.image)):l==="custom"&&g&&(_=g(),_.states=merge$1({},DEFAULT_STATES$2,o==null?void 0:o.customMark)),_.name=`mark-point-${l}`,this.setItemAttributes(_,e,i,n,l),_}getItemLineAttr(e,i,n){let o=[],l={x:0,y:0},d=0,u=0,f=0;const{type:g="type-s",arcRatio:_=.8}=e,y=n.x-i.x,b=n.y-i.y;if(this._isStraightLine=fuzzyEqualNumber(y,0,FUZZY_EQUAL_DELTA)||fuzzyEqualNumber(b,0,FUZZY_EQUAL_DELTA),this._isArcLine){const{x:S,y:v}=this.attribute.position,{x:A,y:x}=n,T=(S+A)/2,C=(v+x)/2,E=v===x?0:-(S-A)/(v-x),P=T+_*(x>v?-1:1)*T,R=(B=>E*(B-T)+C)(P);u=deltaXYToAngle(v-R,S-P),f=deltaXYToAngle(x-R,A-P),l={x:P,y:R};const L=Math.sqrt((P-S)*(P-S)+(R-v)*(R-v)),w=this.attribute.targetSymbol.style.size/2;u+=2*Math.acos(Math.sqrt(1-w*w/(4*L*L))),_>0?f<u&&(f+=2*Math.PI):u<f&&(u+=2*Math.PI),d=Math.sqrt((P-S)*(P-S)+(R-v)*(R-v))}else o=g!=="type-do"||this._isStraightLine?g!=="type-po"||this._isStraightLine?g!=="type-op"||this._isStraightLine?[i,n]:[i,{x:i.x,y:n.y},n]:[i,{x:n.x,y:i.y},n]:[i,{x:(i.x+n.x)/2,y:n.y},n];return o=removeRepeatPoint(o),{points:o,center:l,radius:d,startAngle:u,endAngle:f}}reDrawLine(e,i){this._line.release();const{startSymbol:n,endSymbol:o,lineStyle:l,type:d="type-s"}=e,{state:u}=this.attribute,f=this._isArcLine?ArcSegment:Segment;this._container.removeChild(this._line),this._line=new f(Object.assign(Object.assign({},i),{pickable:!1,startSymbol:n,endSymbol:o,lineStyle:l,visible:e.visible,state:{line:merge$1({},DEFAULT_STATES$2,u==null?void 0:u.line),startSymbol:merge$1({},DEFAULT_STATES$2,u==null?void 0:u.lineStartSymbol),endSymbol:merge$1({},DEFAULT_STATES$2,u==null?void 0:u.lineEndSymbol)}})),this._container.add(this._line)}setItemLineAttr(e,i,n){if(this._line){const{startSymbol:o,endSymbol:l,lineStyle:d,type:u="type-s"}=e,{state:f}=this.attribute,g=this.getItemLineAttr(e,i,n);this._isArcLine&&this._line.key==="arc-segment"||!this._isArcLine&&this._line.key==="segment"?this._line.setAttributes(Object.assign(Object.assign({},g),{startSymbol:o,endSymbol:l,lineStyle:d,visible:e.visible,state:{line:merge$1({},DEFAULT_STATES$2,f==null?void 0:f.line),startSymbol:merge$1({},DEFAULT_STATES$2,f==null?void 0:f.lineStartSymbol),endSymbol:merge$1({},DEFAULT_STATES$2,f==null?void 0:f.lineEndSymbol)}})):this.reDrawLine(e,g)}}getDecorativeLineAttr(e){var i;const n=((i=e==null?void 0:e.decorativeLine)===null||i===void 0?void 0:i.length)||10,o=this._line.getEndAngle()||0;return{startPointOffsetX:n/2*Math.cos(o-Math.PI/2),startPointOffsetY:n/2*Math.sin(o-Math.PI/2),endPointOffsetX:-n/2*Math.cos(o-Math.PI/2),endPointOffsetY:-n/2*Math.sin(o-Math.PI/2)}}setDecorativeLineAttr(e,i,n){var o;if(this._decorativeLine){const{lineStyle:l}=e,{startPointOffsetX:d,startPointOffsetY:u,endPointOffsetX:f,endPointOffsetY:g}=this.getDecorativeLineAttr(e);this._decorativeLine.setAttributes(Object.assign(Object.assign({points:[{x:i.x+d,y:i.y+u},{x:i.x+f,y:i.y+g}]},l),{visible:n})),this._decorativeLine.states=merge$1({},DEFAULT_STATES$2,(o=this.attribute.state)===null||o===void 0?void 0:o.line)}}setTargetItemAttributes(e,i){var n,o;this._targetItem&&(this._targetItem.setAttributes(Object.assign({x:i.x,y:i.y,visible:(n=e.visible)!==null&&n!==void 0&&n,size:e.size},e.style)),this._targetItem.states=merge$1({},DEFAULT_STATES$2,(o=this.attribute.state)===null||o===void 0?void 0:o.targetItem))}setAllOfItemsAttr(e,i){var n;const{position:o,itemLine:l={},itemContent:d={},limitRect:u,targetSymbol:f}=this.attribute,{type:g="text",confine:_}=d;if(u&&_){const{x:y,y:b,width:S,height:v}=u,{dx:A,dy:x}=computeOffsetForlimit(this._item,{x1:y,y1:b,x2:y+S,y2:b+v});i.x=i.x+A,i.y=i.y+x}this.setTargetItemAttributes(f,o),this.setItemLineAttr(l,e,i),this.setItemAttributes(this._item,d,e,i,g),this.setDecorativeLineAttr(l,i,(n=l.decorativeLine)===null||n===void 0?void 0:n.visible)}computeNewPositionAfterTargetItem(e){var i,n;const{itemContent:o={},targetSymbol:l,itemLine:d}=this.attribute,{offsetX:u=0,offsetY:f=0}=o,{offset:g=0,style:_,visible:y=!1,size:b}=l,S=y?(n=(i=_.size)!==null&&i!==void 0?i:b)!==null&&n!==void 0?n:20:0;let v;return v=d.type==="type-do"?deltaXYToAngle(f,u/2):d.type==="type-po"?deltaXYToAngle(0,u):d.type==="type-op"?deltaXYToAngle(f,0):deltaXYToAngle(f,u),{newPosition:{x:e.x+(S/2+g)*Math.cos(v),y:e.y+(S/2+g)*Math.sin(v)},newItemPosition:{x:e.x+(S/2+g)*Math.cos(v)+u,y:e.y+(S/2+g)*Math.sin(v)+f}}}initMarker(e){const{position:i,itemContent:n={},itemLine:o}=this.attribute,{type:l="type-s",arcRatio:d=.8}=o,{offsetX:u=0,offsetY:f=0}=n;this._isStraightLine=fuzzyEqualNumber(u,0,FUZZY_EQUAL_DELTA)||fuzzyEqualNumber(f,0,FUZZY_EQUAL_DELTA),this._isArcLine=l==="type-arc"&&d!==0&&!this._isStraightLine;const{newPosition:g,newItemPosition:_}=this.computeNewPositionAfterTargetItem(i),y=new(this._isArcLine?ArcSegment:Segment)({points:[],pickable:!1,center:{x:0,y:0},radius:0,startAngle:0,endAngle:0});y.name="mark-point-line",this._line=y,e.add(y);const b=graphicCreator.line({points:[]});b.name="mark-point-decorativeLine",this._decorativeLine=b,e.add(b);const S=graphicCreator.symbol({});S.name="mark-point-targetItem",this._targetItem=S,e.add(this._targetItem);const v=this.initItem(n,g,_);this._item=v,e.add(v),this.setAllOfItemsAttr(g,_)}updateMarker(){const{position:e,itemContent:i={},itemLine:n}=this.attribute,{type:o="text"}=i,{type:l="type-s",arcRatio:d=.8}=n,{offsetX:u=0,offsetY:f=0}=i;this._isStraightLine=fuzzyEqualNumber(u,0,FUZZY_EQUAL_DELTA)||fuzzyEqualNumber(f,0,FUZZY_EQUAL_DELTA);const g=l==="type-arc"&&d!==0&&!this._isStraightLine,{newPosition:_,newItemPosition:y}=this.computeNewPositionAfterTargetItem(e);g!==this._isArcLine?(this._isArcLine=g,this.reDrawLine(n,{points:[{x:0,y:0}],pickable:!1,center:{x:0,y:0},radius:0,startAngle:0,endAngle:0})):this._isArcLine=g,this.setItemAttributes(this._item,i,_,y,o),this.setAllOfItemsAttr(_,y)}isValidPoints(){const{position:e}=this.attribute;return!(!isValidNumber(e.x)||!isValidNumber(e.y))}}MarkPoint.defaultAttributes=DEFAULT_MARK_POINT_THEME;function loadPagerComponent(){registerGroup(),registerSymbol(),registerText()}const DEFAULT_HANDLER_STYLE={space:8,style:{fill:"rgb(47, 69, 84)",cursor:"pointer",size:15},state:{disable:{fill:"rgb(170, 170, 170)",cursor:"not-allowed"},hover:{}}};loadPagerComponent();class Pager extends AbstractComponent{getCurrent(){return this._current}constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},Pager.defaultAttributes,e)),this.name="pager",this._current=1,this._onHover=n=>{const o=n.target;o.hasState("disable")||o.addState("hover")},this._onUnHover=n=>{n.target.removeState("hover")},this._onClick=n=>{const o=n.target;if(o.name==="preHandler"){if(this._current===1)return;this._current-=1,this._current===1?o.addState("disable"):o.removeState("disable"),this._dispatchEvent("toPrev",{current:this._current,total:this._total,direction:"pre",event:n})}if(o.name==="nextHandler"){if(this._current===this._total)return;this._current+=1,this._current===this._total?o.addState("disable"):o.removeState("disable"),this._dispatchEvent("toNext",{current:this._current,total:this._total,direction:"next",event:n})}this._current>1&&this.preHandler.removeState("disable"),this._current<this._total&&this.nextHandler.removeState("disable"),this.text.setAttribute("text",this._getPageText(this._current))}}render(){var e,i,n;this._reset();const{layout:o="horizontal",handler:l=DEFAULT_HANDLER_STYLE,total:d,defaultCurrent:u=1,textStyle:f,padding:g=0}=this.attribute;this._current=u;const _=normalizePadding$1(g),y=o==="horizontal",b=graphicCreator.group({x:0,y:0}),S=l.style||{},v=S.size||15,A=(e=l.space)!==null&&e!==void 0?e:8,x=l.state||{};let{preShape:T,nextShape:C}=l;T||(T=y?"triangleLeft":"triangleUp"),C||(C=y?"triangleRight":"triangleDown");const E=graphicCreator.symbol(Object.assign(Object.assign({strokeBoundsBuffer:0,pickMode:"imprecise"},S),{x:0,y:0,symbolType:T,size:v}));E.states=x,E.name="preHandler",this.preHandler=E,b.add(E);const{width:P,height:R}=measureTextSize(this._getPageText(d),Object.assign({textAlign:"center",textBaseline:"middle"},f),(n=(i=this.stage)===null||i===void 0?void 0:i.getTheme())===null||n===void 0?void 0:n.text),L=isNumber(v)?v:v[0],w=isNumber(v)?v:v[1],B=graphicCreator.text(Object.assign({x:y?L/2+A+P/2:0,y:y?0:w/2+A+R/2,text:this._getPageText(u),textAlign:"center",textBaseline:"middle",lineHeight:f==null?void 0:f.fontSize},f));this.text=B,b.add(B);const I=graphicCreator.symbol(Object.assign(Object.assign({strokeBoundsBuffer:0,pickMode:"imprecise"},S),{x:y?L+2*A+P:0,y:y?0:w+2*A+R,symbolType:C,size:v}));I.name="nextHandler",I.states=x,this.nextHandler=I,b.add(I),this._total===1?(E.addState("disable"),I.addState("disable")):this._current===1?E.addState("disable"):this._current===d&&I.addState("disable");const D=b.AABBBounds,O=D.width(),N=D.height();b.translateTo(0-D.x1+_[3],0-D.y1+_[0]),this.add(b),this.attribute.width=O+_[1]+_[3],this.attribute.height=N+_[0]+_[2],this._bindEvents()}_bindEvents(){this.attribute.disableTriggerEvent||(this.preHandler&&(this.preHandler.addEventListener("pointerenter",this._onHover),this.preHandler.addEventListener("pointerleave",this._onUnHover),this.preHandler.addEventListener("pointerdown",this._onClick)),this.nextHandler&&(this.nextHandler.addEventListener("pointerenter",this._onHover),this.nextHandler.addEventListener("pointerleave",this._onUnHover),this.nextHandler.addEventListener("pointerdown",this._onClick)))}_reset(){this.removeAllChild(!0),this._current=1,this._total=this.attribute.total,this.preHandler=this.nextHandler=this.text=null}_getPageText(e){const{pageFormatter:i}=this.attribute;return i?isFunction(i)?i(e,this._total):`${i}`.replace("{current}",`${e}`).replace("{total}",`${this._total}`):`${e}/${this._total}`}setTotal(e){e!==this.attribute.total&&(this._total=e,this._current!==1&&this._current<=e?this.setAttributes({total:e,defaultCurrent:this._current}):this.setAttribute("total",e))}}Pager.defaultAttributes={handler:DEFAULT_HANDLER_STYLE,textStyle:{fill:"rgb(51, 51, 51)",fontSize:12}};const DEFAULT_SHAPE_SIZE=10,DEFAULT_SHAPE_SPACE=8,DEFAULT_LABEL_SPACE=8,DEFAULT_VALUE_SPACE=8,DEFAULT_ITEM_SPACE_COL=16,DEFAULT_ITEM_SPACE_ROW=8,DEFAULT_TITLE_SPACE=12,DEFAULT_PAGER_SPACE=12;var LegendStateValue;(function(r){r.selected="selected",r.unSelected="unSelected",r.selectedHover="selectedHover",r.unSelectedHover="unSelectedHover",r.focus="focus"})(LegendStateValue||(LegendStateValue={}));var LegendEvent;(function(r){r.legendItemHover="legendItemHover",r.legendItemUnHover="legendItemUnHover",r.legendItemClick="legendItemClick",r.legendItemAttributeUpdate="legendItemAttributeUpdate"})(LegendEvent||(LegendEvent={}));var LEGEND_ELEMENT_NAME;(function(r){r.innerView="innerView",r.title="legendTitle",r.item="legendItem",r.itemShape="legendItemShape",r.itemLabel="legendItemLabel",r.itemValue="legendItemValue",r.focus="legendItemFocus"})(LEGEND_ELEMENT_NAME||(LEGEND_ELEMENT_NAME={}));class LegendBase extends AbstractComponent{constructor(){super(...arguments),this.name="legend",this._title=null}render(){this.removeAllChild(!0);const{interactive:e=!0,title:i,padding:n=0}=this.attribute;this._parsedPadding=normalizePadding$1(n);const o=graphicCreator.group({x:this._parsedPadding[3],y:this._parsedPadding[0],pickable:e,childrenPickable:e});o.name=LEGEND_ELEMENT_NAME.innerView,this.add(o),this._innerView=o,i!=null&&i.visible&&this._renderTitle(i),this._renderContent(),this._adjustLayout(),e&&this._bindEvents();const l=this._innerView.AABBBounds;this.attribute.width=l.width()+this._parsedPadding[1]+this._parsedPadding[3],this.attribute.height=l.height()+this._parsedPadding[0]+this._parsedPadding[2]}_renderTitle(e){const{text:i="",textStyle:n,padding:o=0,background:l,minWidth:d,maxWidth:u,shape:f}=e,g={x:0,y:0,text:i,textStyle:n,padding:normalizePadding$1(o),minWidth:d,maxWidth:u};f&&f.visible&&(g.shape=Object.assign({visible:!0},f.style),isValid(f.space)&&(g.space=f.space)),l&&l.visible&&(g.panel=Object.assign({visible:!0},l.style));const _=new Tag(g);_.name=LEGEND_ELEMENT_NAME.title,this._title=_,this._innerView.add(_)}_adjustLayout(){var e;if(this._title){const i=this._innerView.AABBBounds.width(),n=this._title.AABBBounds.width(),o=(e=this.attribute.title)===null||e===void 0?void 0:e.align;o==="center"?this._title.setAttribute("x",(i-n)/2):o==="end"&&this._title.setAttribute("x",i-n)}}}function loadSliderComponent(){registerGroup(),registerText(),registerRect(),registerSymbol()}function loadBaseLegend(){registerGroup(),loadTagComponent()}function loadDiscreteLegendComponent(){loadBaseLegend(),loadPagerComponent(),loadScrollbarComponent()}function loadColorContinuousLegendComponent(){loadBaseLegend(),loadSliderComponent()}function loadSizeContinuousLegendComponent(){loadBaseLegend(),loadSliderComponent(),registerPath()}var __rest$k=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};const DEFAULT_STATES={[LegendStateValue.focus]:{},[LegendStateValue.selected]:{},[LegendStateValue.selectedHover]:{},[LegendStateValue.unSelected]:{},[LegendStateValue.unSelectedHover]:{}};loadDiscreteLegendComponent();let DiscreteLegend$1=class He extends LegendBase{constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},He.defaultAttributes,e)),this.name="discreteLegend",this._itemsContainer=null,this._itemHeightByUser=void 0,this._itemHeight=0,this._itemMaxWidth=0,this._contentMaxHeight=0,this._onHover=n=>{const o=n.target;if(o&&o.name&&o.name.startsWith(LEGEND_ELEMENT_NAME.item)){const l=o.delegate;if(this._lastActiveItem){if(this._lastActiveItem.id===l.id)return;this._unHover(this._lastActiveItem,n)}this._hover(l,n)}else this._lastActiveItem&&(this._unHover(this._lastActiveItem,n),this._lastActiveItem=null)},this._onUnHover=n=>{this._lastActiveItem&&(this._unHover(this._lastActiveItem,n),this._lastActiveItem=null)},this._onClick=n=>{var o,l,d,u;const f=n.target;if(f&&f.name&&f.name.startsWith(LEGEND_ELEMENT_NAME.item)){const g=f.delegate,{selectMode:_="multiple"}=this.attribute;if(f.name===LEGEND_ELEMENT_NAME.focus||_==="focus"){const y=g.hasState(LegendStateValue.focus);g.toggleState(LegendStateValue.focus),y?(o=this._itemsContainer)===null||o===void 0||o.getChildren().forEach(b=>{this._removeLegendItemState(b,[LegendStateValue.unSelected,LegendStateValue.unSelectedHover,LegendStateValue.focus],n),this._setLegendItemState(b,LegendStateValue.selected,n)}):(this._setLegendItemState(g,LegendStateValue.selected,n),this._removeLegendItemState(g,[LegendStateValue.unSelected,LegendStateValue.unSelectedHover],n),(l=this._itemsContainer)===null||l===void 0||l.getChildren().forEach(b=>{g!==b&&(this._removeLegendItemState(b,[LegendStateValue.selected,LegendStateValue.selectedHover,LegendStateValue.focus],n),this._setLegendItemState(b,LegendStateValue.unSelected,n))}))}else{(d=this._itemsContainer)===null||d===void 0||d.getChildren().forEach(v=>{v.removeState(LegendStateValue.focus)});const{allowAllCanceled:y=!0}=this.attribute,b=g.hasState(LegendStateValue.selected),S=this._getSelectedLegends();if(_==="multiple"){if(y===!1&&b&&S.length===1)return void this._dispatchLegendEvent(LegendEvent.legendItemClick,g,n);b?(this._removeLegendItemState(g,[LegendStateValue.selected,LegendStateValue.selectedHover],n),this._setLegendItemState(g,LegendStateValue.unSelected,n)):(this._setLegendItemState(g,LegendStateValue.selected,n),this._removeLegendItemState(g,[LegendStateValue.unSelected,LegendStateValue.unSelectedHover],n))}else this._setLegendItemState(g,LegendStateValue.selected,n),this._removeLegendItemState(g,[LegendStateValue.unSelected,LegendStateValue.unSelectedHover],n),(u=this._itemsContainer)===null||u===void 0||u.getChildren().forEach(v=>{g!==v&&(this._removeLegendItemState(v,[LegendStateValue.selected,LegendStateValue.selectedHover],n),this._setLegendItemState(v,LegendStateValue.unSelected,n))})}this._dispatchLegendEvent(LegendEvent.legendItemClick,g,n)}}}render(){super.render(),this._lastActiveItem=null}setSelected(e){var i;((i=this._itemsContainer)===null||i===void 0?void 0:i.getChildren()).forEach(n=>{const o=n.data;e.includes(o.label)?(this._setLegendItemState(n,LegendStateValue.selected),this._removeLegendItemState(n,[LegendStateValue.unSelected,LegendStateValue.unSelectedHover])):(this._removeLegendItemState(n,[LegendStateValue.selected,LegendStateValue.selectedHover]),this._setLegendItemState(n,LegendStateValue.unSelected))})}_renderItems(){const{item:e={},maxCol:i=1,maxRow:n=2,maxWidth:o,defaultSelected:l,lazyload:d,autoPage:u}=this.attribute,{spaceCol:f=DEFAULT_ITEM_SPACE_COL,spaceRow:g=DEFAULT_ITEM_SPACE_ROW,verticalAlign:_="middle"}=e,y=this._itemsContainer,{items:b,isHorizontal:S,startIndex:v,isScrollbar:A}=this._itemContext,x=A?1:S?n:i,T=this._contentMaxHeight;let C,{doWrap:E,maxWidthInCol:P,startX:R,startY:L,pages:w}=this._itemContext,B=0,I=0;const D=[];for(let O=v,N=b.length;O<N&&!(d&&w>this._itemContext.currentPage*x);O++){d&&(this._itemContext.startIndex=O+1),C=b[O],C.id||(C.id=C.label),C.index=O;let V=!0;isArray(l)&&(V=l.includes(C.label));const H=this._renderEachItem(C,V,O,b),F=H.attribute.width,$=H.attribute.height;this._itemHeight=Math.max(this._itemHeight,$),P=Math.max(F,P),this._itemMaxWidth=Math.max(F,this._itemMaxWidth),S?(isValid(o)&&(A&&u?(w=Math.ceil((R+F)/o),E=w>1):R+F>o&&(E=!0,R>0&&(_!=="middle"&&_!=="bottom"||D.forEach(G=>{G.setAttributes({y:G.attribute.y+(I-G.attribute.height)/(_==="middle"?2:1)})}),w+=1,R=0,L+=I+g,I=0,D.length=0))),R===0&&L===0||H.setAttributes({x:R,y:L}),R+=f+F,I=Math.max(I,$),D.push(H)):(isValid(T)&&(A&&u?(w=Math.ceil((L+$)/T),E=w>1):T<=$?(w+=1,E=!0,L=0,O>0&&(R+=B+f)):T<L+$&&(w+=1,E=!0,L=0,R+=P+f,P=0)),R===0&&L===0||H.setAttributes({x:R,y:L}),L+=g+$),y.add(H),B=F}return!S||_!=="middle"&&_!=="bottom"||D.forEach(O=>{O.setAttributes({y:O.attribute.y+(I-O.attribute.height)/(_==="middle"?2:1)})}),this._itemContext.doWrap=E,this._itemContext.startX=R,this._itemContext.startY=L,this._itemContext.maxWidthInCol=P,this._itemContext.pages=w,this._itemContext.maxPages=x,A&&(this._itemContext.totalPage=w),d||(this._itemContext.startIndex=b.length),this._itemContext}_renderContent(){const{item:e={},items:i,reversed:n,maxWidth:o,maxHeight:l}=this.attribute;if(e.visible===!1||isEmpty(i))return;let d=i;n&&(d=i==null?void 0:i.reverse()),this._contentMaxHeight=Math.max(0,l-this._parsedPadding[0]-this._parsedPadding[2]);const u=graphicCreator.group({x:0,y:0});this._itemsContainer=u;const{layout:f,autoPage:g}=this.attribute,_=f==="horizontal",{maxWidth:y,width:b,height:S}=e,v=[];isValid(y)&&v.push(y),isValid(b)&&v.push(b),v.length&&(isValid(o)&&v.push(o),this._itemWidthByUser=minInArray(v)),isValid(S)&&(this._itemHeightByUser=S);const A=this.attribute.pager;this._itemContext={currentPage:A&&A.defaultCurrent||1,doWrap:!1,maxWidthInCol:0,maxPages:1,pages:1,startX:0,startY:0,startIndex:0,items:d,isHorizontal:_,totalPage:1/0,isScrollbar:A&&A.type==="scrollbar",clipContainer:void 0},this._itemContext=this._renderItems();let x=!1;this._itemContext.doWrap&&g&&this._itemContext.pages>this._itemContext.maxPages&&(x=this._renderPagerComponent()),x||(u.setAttribute("y",this._title?this._title.AABBBounds.height()+get(this.attribute,"title.space",8):0),this._innerView.add(u))}_bindEvents(){if(this.attribute.disableTriggerEvent||!this._itemsContainer)return;const{hover:e=!0,select:i=!0}=this.attribute;if(e){let n="pointermove",o="pointerleave";isObject$1(e)&&(e.trigger&&(n=e.trigger),e.triggerOff&&(o=e.triggerOff)),this._itemsContainer.addEventListener(n,this._onHover),this._itemsContainer.addEventListener(o,this._onUnHover)}if(i){let n="pointerdown";isObject$1(i)&&i.trigger&&(n=i.trigger),this._itemsContainer.addEventListener(n,this._onClick)}}_autoEllipsis(e,i,n,o){var l,d;const{label:u,value:f}=this.attribute.item,g=o.AABBBounds,_=n.AABBBounds,y=g.width(),b=_.width();let S=!1;e==="labelFirst"?b>i?S=!0:o.setAttribute("maxLineWidth",i-b):e==="valueFirst"?y>i?S=!0:n.setAttribute("maxLineWidth",i-y):y+b>i&&(S=!0),S&&(o.setAttribute("maxLineWidth",Math.max(i*((l=u.widthRatio)!==null&&l!==void 0?l:.5),i-b)),n.setAttribute("maxLineWidth",Math.max(i*((d=f.widthRatio)!==null&&d!==void 0?d:.5),i-y)))}_renderEachItem(e,i,n,o){var l,d;const{id:u,label:f,value:g,shape:_}=e,{padding:y=0,focus:b,focusIconStyle:S,align:v,autoEllipsisStrategy:A}=this.attribute.item,{shape:x,label:T,value:C,background:E}=this.attribute.item,P=this._handleStyle(x,e,i,n,o),R=this._handleStyle(T,e,i,n,o),L=this._handleStyle(C,e,i,n,o),w=this._handleStyle(E,e,i,n,o),B=normalizePadding$1(y);let I;E.visible===!1?(I=graphicCreator.group({x:0,y:0,cursor:(l=w.style)===null||l===void 0?void 0:l.cursor}),this._appendDataToShape(I,LEGEND_ELEMENT_NAME.item,e,I)):(I=graphicCreator.group(Object.assign({x:0,y:0},w.style)),this._appendDataToShape(I,LEGEND_ELEMENT_NAME.item,e,I,w.state)),I.id=`${u??f}-${n}`,I.addState(i?LegendStateValue.selected:LegendStateValue.unSelected);const D=graphicCreator.group({x:0,y:0,pickable:!1});I.add(D);let O,N=0,V=0,H=0;if(x&&x.visible!==!1){const pe=get(P,"style.size",DEFAULT_SHAPE_SIZE);V=isArray(pe)?pe[0]||0:pe,H=get(x,"space",DEFAULT_SHAPE_SPACE);const me=graphicCreator.symbol(Object.assign(Object.assign({x:0,y:0,symbolType:"circle",strokeBoundsBuffer:0},_),P.style));Object.keys(P.state||{}).forEach(ee=>{const J=P.state[ee].fill||P.state[ee].stroke;_.fill&&isNil(P.state[ee].fill)&&J&&(P.state[ee].fill=J),_.stroke&&isNil(P.state[ee].stroke)&&J&&(P.state[ee].stroke=J)}),this._appendDataToShape(me,LEGEND_ELEMENT_NAME.itemShape,e,I,P.state),me.addState(i?LegendStateValue.selected:LegendStateValue.unSelected),D.add(me)}let F=0;if(b){const pe=get(S,"size",DEFAULT_SHAPE_SIZE);O=graphicCreator.symbol(Object.assign(Object.assign({x:0,y:-pe/2-1,strokeBoundsBuffer:0,boundsPadding:B},S),{visible:!0,pickMode:"imprecise"})),this._appendDataToShape(O,LEGEND_ELEMENT_NAME.focus,e,I),F=pe}const $=T.formatMethod?T.formatMethod(f,e,n):f,G=Object.assign(Object.assign({x:V/2+H,y:0,textAlign:"start",textBaseline:"middle",lineHeight:(d=R.style)===null||d===void 0?void 0:d.fontSize},R.style),{text:$,_originText:T.formatMethod?f:void 0}),Y=createTextGraphicByType(G);this._appendDataToShape(Y,LEGEND_ELEMENT_NAME.itemLabel,e,I,R.state),Y.addState(i?LegendStateValue.selected:LegendStateValue.unSelected),D.add(Y);const Q=get(T,"space",DEFAULT_LABEL_SPACE);if(isValid(g)){const pe=get(C,"space",b?DEFAULT_VALUE_SPACE:0),me=C.formatMethod?C.formatMethod(g,e,n):g,ee=Object.assign(Object.assign({x:0,y:0,textAlign:"start",textBaseline:"middle",lineHeight:L.style.fontSize},L.style),{text:me,_originText:C.formatMethod?g:void 0}),J=createTextGraphicByType(ee);if(this._appendDataToShape(J,LEGEND_ELEMENT_NAME.itemValue,e,I,L.state),J.addState(i?LegendStateValue.selected:LegendStateValue.unSelected),this._itemWidthByUser){const ie=this._itemWidthByUser-B[1]-B[3]-V-H-Q-F-pe;this._autoEllipsis(A,ie,Y,J),C.alignRight?J.setAttributes({textAlign:"right",x:this._itemWidthByUser-V/2-B[1]-B[3]-F-pe}):J.setAttribute("x",Q+(Y.AABBBounds.empty()?0:Y.AABBBounds.x2))}else J.setAttribute("x",Q+(Y.AABBBounds.empty()?0:Y.AABBBounds.x2));N=pe+(J.AABBBounds.empty()?0:J.AABBBounds.x2),D.add(J)}else this._itemWidthByUser&&Y.setAttribute("maxLineWidth",this._itemWidthByUser-B[1]-B[3]-V-H-F),N=Q+(Y.AABBBounds.empty()?0:Y.AABBBounds.x2);O&&(O.setAttribute("x",N),D.add(O));const q=D.AABBBounds,te=q.width();if(v==="right"){const pe=q.x2,me=q.x1;D.forEachChildren((ee,J)=>{ee.type!=="symbol"&&ee.attribute.textAlign!=="right"||ee===O?ee.setAttribute("x",me+pe-ee.attribute.x-ee.AABBBounds.width()):ee.type!=="symbol"?ee.setAttributes({x:me+pe-ee.attribute.x,textAlign:"left"}):ee.setAttribute("x",me+pe-ee.attribute.x)})}const ue=q.height(),he=isValid(this.attribute.item.width)?this.attribute.item.width:te+B[1]+B[3],fe=this._itemHeightByUser||ue+B[0]+B[2];return I.attribute.width=he,I.attribute.height=fe,O&&O.setAttribute("visible",!1),D.translateTo(-q.x1+B[3],-q.y1+B[0]),I}_createPager(e){var i,n;const{disableTriggerEvent:o,maxRow:l}=this.attribute,d=u=>u<=99?99:u<=999?999:9999;return this._itemContext.isHorizontal?new Pager(Object.assign(Object.assign({layout:l===1?"horizontal":"vertical",total:d(this._itemContext.pages)},merge$1({handler:{preShape:"triangleUp",nextShape:"triangleDown"}},e)),{defaultCurrent:(i=this.attribute.pager)===null||i===void 0?void 0:i.defaultCurrent,disableTriggerEvent:o})):new Pager(Object.assign({layout:"horizontal",total:d(this._itemContext.pages),disableTriggerEvent:o,defaultCurrent:(n=this.attribute.pager)===null||n===void 0?void 0:n.defaultCurrent},e))}_createScrollbar(e,i){const{disableTriggerEvent:n}=this.attribute;return this._itemContext.isHorizontal?new ScrollBar$1(Object.assign(Object.assign({direction:"horizontal",disableTriggerEvent:n,range:[0,.5],height:e.visible===!1?0:12},e),{width:i})):new ScrollBar$1(Object.assign(Object.assign({direction:"vertical",width:e.visible===!1?0:12,range:[0,.5]},e),{height:i,disableTriggerEvent:n}))}_updatePositionOfPager(e,i,n){const{pager:o}=this.attribute,{totalPage:l,isHorizontal:d}=this._itemContext,u=o&&o.position||"middle";if(this._pagerComponent.setTotal(l),d){let f;f=u==="start"?e:u==="end"?e+n-this._pagerComponent.AABBBounds.height()/2:e+n/2-this._pagerComponent.AABBBounds.height()/2,this._pagerComponent.setAttributes({x:i-this._pagerComponent.AABBBounds.width(),y:f})}else{let f;f=u==="start"?0:u==="end"?i-this._pagerComponent.AABBBounds.width():(i-this._pagerComponent.AABBBounds.width())/2,this._pagerComponent.setAttributes({x:f,y:n-this._pagerComponent.AABBBounds.height()})}}_computeScrollbarDelta(){const{isHorizontal:e,clipContainer:i}=this._itemContext,n=this._itemsContainer.AABBBounds,o=i.AABBBounds;let l,d;return e?(d=o.width(),l=d/n.width()):(d=o.height(),l=d/n.height()),l}_updatePositionOfScrollbar(e,i,n){const{isHorizontal:o,currentPage:l,totalPage:d}=this._itemContext,u=(l-1)/d;this._pagerComponent.setScrollRange([u,u+this._computeScrollbarDelta()]),o?this._pagerComponent.setAttributes({x:0,y:n+i}):this._pagerComponent.setAttributes({x:e,y:n})}_bindEventsOfPager(e,i){const n=this.attribute.pager||{},{animation:o=!0,animationDuration:l=450,animationEasing:d="quadIn"}=n,u=this._itemContext.isScrollbar?_=>{const{value:y}=_.detail;let b;return b=y[0]===0?1:y[1]===1?this._itemContext.totalPage:y[0]*this._itemContext.totalPage+1,b}:_=>_.detail.current,f=_=>{const y=this._pagerComponent,b=y.getScrollRange(),{direction:S}=y.attribute,{width:v,height:A}=y.getSliderRenderBounds(),x=S==="vertical"?_.deltaY/A:_.deltaX/v;y.setScrollRange([b[0]+x,b[1]+x],!0),this.updateScrollMask()},g=_=>{const y=u(_);if(y!==this._itemContext.currentPage){if(this._itemContext.currentPage=y,this._itemContext&&this._itemContext.startIndex<this._itemContext.items.length){this._renderItems();const b=Math.ceil(this._itemContext.pages/this._itemContext.maxPages);if(this._itemContext.totalPage=b,this._itemContext.isScrollbar&&this._pagerComponent){const S=this._computeScrollbarDelta(),[v]=this._pagerComponent.getScrollRange();this._pagerComponent.setScrollRange([v,v+S])}}if(this._itemContext.isScrollbar){const[b]=this._pagerComponent.getScrollRange();let S;S=this._itemContext.isHorizontal?this._itemsContainer.AABBBounds.width():this._itemsContainer.AABBBounds.height();const v=S*b;this.updateScrollMask(),o?this._itemsContainer.animate().to({[i]:-v},l,d):this._itemsContainer.setAttribute(i,-v)}else o?this._itemsContainer.animate().to({[i]:-(y-1)*e},l,d):this._itemsContainer.setAttribute(i,-(y-1)*e)}};this._itemContext.isScrollbar?(this._pagerComponent.addEventListener("scrollDrag",g),this._pagerComponent.addEventListener("scrollUp",g),this.attribute.pager.roamScroll&&(this.addEventListener("wheel",y=>y.nativeEvent.preventDefault()),this.addEventListener("wheel",throttle(f,50)))):(this._pagerComponent.addEventListener("toPrev",g),this._pagerComponent.addEventListener("toNext",g))}_renderPager(){const e=this._title?this._title.AABBBounds.height()+get(this.attribute,"title.space",8):0,{maxWidth:i,maxCol:n=1,maxRow:o=2,item:l={},pager:d={}}=this.attribute,{spaceCol:u=DEFAULT_ITEM_SPACE_COL,spaceRow:f=DEFAULT_ITEM_SPACE_ROW}=l,g=this._itemsContainer,{space:_=DEFAULT_PAGER_SPACE,defaultCurrent:y=1}=d,b=__rest$k(d,["space","defaultCurrent"]),{isHorizontal:S}=this._itemContext,v=this._contentMaxHeight;let A,x=0,T=0,C=0,E=0,P=0,R=0,L=1;if(S){if(T=(o-1)*f+this._itemHeight*o,x=i,A=this._createPager(b),this._pagerComponent=A,this._innerView.add(A),C=i-A.AABBBounds.width()-_,C<=0)return this._innerView.removeChild(A),!1;g.getChildren().forEach((I,D)=>{const{width:O,height:N}=I.attribute;C<P+O&&(P=0,R+=N+f,L+=1),D>0&&I.setAttributes({x:P,y:R}),P+=u+O}),this._itemContext.startX=P,this._itemContext.startY=R,this._itemContext.pages=L;const B=Math.ceil(L/o);this._itemContext.totalPage=B,this._updatePositionOfPager(e,x,T)}else{if(x=this._itemMaxWidth*n+(n-1)*u,T=v,C=x,A=this._createPager(b),this._pagerComponent=A,this._innerView.add(A),E=v-A.AABBBounds.height()-_-e,E<=0)return this._innerView.removeChild(A),!1;g.getChildren().forEach((I,D)=>{const{height:O}=I.attribute;E<R+O&&(R=0,P+=this._itemMaxWidth+u,L+=1),D>0&&I.setAttributes({x:P,y:R}),R+=f+O});const B=Math.ceil(L/n);this._itemContext.totalPage=B,this._updatePositionOfPager(e,x,T)}y>1&&(S?g.setAttribute("y",-(y-1)*(T+f)):g.setAttribute("x",-(y-1)*(x+u)));const w=graphicCreator.group({x:0,y:e,width:S?C:x,height:S?T:E,clip:!0,pickable:!1});return w.add(g),this._innerView.add(w),this._itemContext.clipContainer=w,this._bindEventsOfPager(S?T+f:x+u,S?"y":"x"),!0}_renderScrollbar(){var e;const i=this._title?this._title.AABBBounds.height()+get(this.attribute,"title.space",8):0,{maxWidth:n,item:o={},pager:l={}}=this.attribute,{spaceCol:d=DEFAULT_ITEM_SPACE_COL,spaceRow:u=DEFAULT_ITEM_SPACE_ROW}=o,f=this._itemsContainer,{space:g=DEFAULT_PAGER_SPACE,defaultCurrent:_=1}=l,y=__rest$k(l,["space","defaultCurrent"]),{isHorizontal:b}=this._itemContext,S=this._contentMaxHeight;let v,A=0,x=0,T=0,C=1;if(b)A=n,x=this._itemHeight,v=this._createScrollbar(y,A),this._pagerComponent=v,this._innerView.add(v);else{if(x=S-i,A=this._itemMaxWidth,v=this._createScrollbar(y,x),this._pagerComponent=v,this._innerView.add(v),x<=0)return this._innerView.removeChild(v),!1;const P=f.getChildren(),R=P.map(L=>L.attribute.height);if(R.length===1||R.every(L=>L===R[0])){const L=R[0],w=x,B=Math.floor(w/(u+L));x=B*(u+L),C=Math.ceil(P.length/B)}else P.forEach((L,w)=>{const{height:B}=L.attribute,I=C,D=T;C=Math.floor((T+B)/x)+1,T+=u+B,I!==C&&w===f.getChildren().length-1&&T-x>=1/3*B&&(x=D+B,C-=1)});this._itemContext.totalPage=C,this._itemContext.pages=C}if(_>1)if(b){const P=this._itemsContainer.AABBBounds.width()-A;f.setAttribute("x",-Math.min((_-1)*(A+d),P))}else{const P=this._itemsContainer.AABBBounds.height()-x;f.setAttribute("y",-Math.min((_-1)*(x+u),P))}const E=graphicCreator.group({x:0,y:i,width:A,height:x,clip:!0,pickable:!1});return E.add(f),this._innerView.add(E),this._itemContext.clipContainer=E,this._updatePositionOfScrollbar(A,x,i),!((e=l.scrollMask)===null||e===void 0)&&e.visible&&this.renderScrollMask(E),this._bindEventsOfPager(b?A:x,b?"x":"y"),!0}renderScrollMask(e){const{scrollMask:i={}}=this.attribute.pager,{visible:n=!0,gradientLength:o=16,gradientStops:l}=i;if(!n||!l)return;const d=e.AABBBounds.width(),u=e.AABBBounds.height(),f=this._itemContext.isHorizontal?d:u,g=l.map(b=>({offset:o*b.offset/f,color:b.color})),_=l.map(b=>({offset:(f-o*b.offset)/f,color:b.color})),y=graphicCreator.rect({x:0,y:0,width:d,height:u});this._scrollMask=y,this._scrollMaskContext={startStops:g,endStops:_},this.updateScrollMask(),e.add(y)}updateScrollMask(){if(!this._scrollMask||!this._pagerComponent||!this._itemContext.isScrollbar)return;const[e,i]=this._pagerComponent.getScrollRange(),n=[];isNumberClose(clamp(i,0,1),1)||n.push(...this._scrollMaskContext.endStops),isNumberClose(clamp(e,0,1),0)||n.push(...this._scrollMaskContext.startStops),n.length&&(this._itemContext.isHorizontal?this._scrollMask.setAttributes({fill:{gradient:"linear",x0:0,y0:0,x1:1,y1:0,stops:n}}):this._scrollMask.setAttributes({fill:{gradient:"linear",x0:0,y0:0,x1:0,y1:1,stops:n}}))}_renderPagerComponent(){return this._itemContext.isScrollbar?this._renderScrollbar():this._renderPager(),!0}_hover(e,i){this._lastActiveItem=e,e.hasState(LegendStateValue.selected)?this._setLegendItemState(e,LegendStateValue.selectedHover,i):this._setLegendItemState(e,LegendStateValue.unSelectedHover,i);const n=e.getChildren()[0].find(o=>o.name===LEGEND_ELEMENT_NAME.focus,!1);n&&n.setAttribute("visible",!0),this._dispatchLegendEvent(LegendEvent.legendItemHover,e,i)}_unHover(e,i){let n=!1;(e.hasState(LegendStateValue.unSelectedHover)||e.hasState(LegendStateValue.selectedHover))&&(n=!0),e.removeState(LegendStateValue.unSelectedHover),e.removeState(LegendStateValue.selectedHover),e.getChildren()[0].getChildren().forEach(l=>{n||!l.hasState(LegendStateValue.unSelectedHover)&&!l.hasState(LegendStateValue.selectedHover)||(n=!0),l.removeState(LegendStateValue.unSelectedHover),l.removeState(LegendStateValue.selectedHover)});const o=e.getChildren()[0].find(l=>l.name===LEGEND_ELEMENT_NAME.focus,!1);o&&o.setAttribute("visible",!1),n&&this._dispatchLegendEvent(LegendEvent.legendItemAttributeUpdate,e,i),this._dispatchLegendEvent(LegendEvent.legendItemUnHover,e,i)}_setLegendItemState(e,i,n){let o=!1;e.hasState(i)||(o=!0),e.addState(i,!0),e.getChildren()[0].getChildren().forEach(l=>{l.name!==LEGEND_ELEMENT_NAME.focus&&(o||l.hasState(i)||(o=!0),l.addState(i,!0))}),o&&this._dispatchLegendEvent(LegendEvent.legendItemAttributeUpdate,e,n)}_removeLegendItemState(e,i,n){let o=!1;i.forEach(l=>{!o&&e.hasState(l)&&(o=!0),e.removeState(l)}),e.getChildren()[0].getChildren().forEach(l=>{l.name!==LEGEND_ELEMENT_NAME.focus&&i.forEach(d=>{!o&&l.hasState(d)&&(o=!0),l.removeState(d)})}),o&&this._dispatchLegendEvent(LegendEvent.legendItemAttributeUpdate,e,n)}_getSelectedLegends(){var e;const i=[];return(e=this._itemsContainer)===null||e===void 0||e.getChildren().forEach(n=>{n.hasState(LegendStateValue.selected)&&i.push(n.data)}),i}_appendDataToShape(e,i,n,o,l={}){e.name=i,e.data=n,e.delegate=o,e.states=merge$1({},DEFAULT_STATES,l)}_dispatchLegendEvent(e,i,n){const o=this._getSelectedLegends();o.sort((d,u)=>d.index-u.index);const l=o.map(d=>d.label);this._dispatchEvent(e,{item:i,data:i.data,selected:i.hasState(LegendStateValue.selected),currentSelectedItems:o,currentSelected:l,event:n})}_handleStyle(e,i,n,o,l){const d={};return e.style&&(isFunction(e.style)?d.style=e.style(i,n,o,l):d.style=e.style),e.state&&(d.state={},Object.keys(e.state).forEach(u=>{e.state[u]&&(isFunction(e.state[u])?d.state[u]=e.state[u](i,n,o,l):d.state[u]=e.state[u])})),d}release(){super.release(),this.removeAllEventListeners()}};DiscreteLegend$1.defaultAttributes={layout:"horizontal",title:{align:"start",space:DEFAULT_TITLE_SPACE,textStyle:{fontSize:12,fontWeight:"bold",fill:"#2C3542"}},item:{spaceCol:DEFAULT_ITEM_SPACE_COL,spaceRow:DEFAULT_ITEM_SPACE_ROW,shape:{space:DEFAULT_SHAPE_SPACE,style:{size:DEFAULT_SHAPE_SIZE,cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{opacity:.5}}},label:{space:DEFAULT_LABEL_SPACE,style:{fontSize:12,fill:"#2C3542",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},value:{alignRight:!1,style:{fontSize:12,fill:"#ccc",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},background:{style:{cursor:"pointer"}},focus:!1,focusIconStyle:{size:DEFAULT_SHAPE_SIZE,symbolType:"M8 1C11.866 1 15 4.13401 15 8C15 11.866 11.866 15 8 15C4.13401 15 1 11.866 1 8C1 4.13401 4.13401 1 8 1ZM8.75044 2.55077L8.75 3.75H7.25L7.25006 2.5507C4.81247 2.88304 2.88304 4.81247 2.5507 7.25006L3.75 7.25V8.75L2.55077 8.75044C2.8833 11.1878 4.81264 13.117 7.25006 13.4493L7.25 12.25H8.75L8.75044 13.4492C11.1876 13.1167 13.1167 11.1876 13.4492 8.75044L12.25 8.75V7.25L13.4493 7.25006C13.117 4.81264 11.1878 2.8833 8.75044 2.55077ZM8 5.5C9.38071 5.5 10.5 6.61929 10.5 8C10.5 9.38071 9.38071 10.5 8 10.5C6.61929 10.5 5.5 9.38071 5.5 8C5.5 6.61929 6.61929 5.5 8 5.5ZM8 7C7.44772 7 7 7.44772 7 8C7 8.55228 7.44772 9 8 9C8.55228 9 9 8.55228 9 8C9 7.44772 8.55228 7 8 7Z",fill:"#333",cursor:"pointer"}},autoPage:!0,pager:{space:DEFAULT_PAGER_SPACE,handler:{style:{size:10},space:4}},hover:!0,select:!0,selectMode:"multiple",allowAllCanceled:!0};var SLIDER_ELEMENT_NAME;(function(r){r.innerView="innerView",r.railContainer="sliderRailContainer",r.rail="sliderRail",r.startText="sliderStartText",r.endText="sliderEndText",r.startHandler="sliderStartHandler",r.startHandlerText="startHandlerText",r.endHandler="sliderEndHandler",r.endHandlerText="sliderEndHandlerText",r.track="sliderTrack",r.trackContainer="sliderTrackContainer"})(SLIDER_ELEMENT_NAME||(SLIDER_ELEMENT_NAME={}));function convertValueToRange(r){return isArray(r)?r:[r,r]}function getDefaultCursor(r){return r?"ew-resize":"ns-resize"}loadSliderComponent();class Slider extends AbstractComponent{get track(){return this._track}get currentValue(){return this._currentValue}get startHandler(){return this._startHandler}get endHandler(){return this._endHandler}get tooltipShape(){return this._tooltipShape}constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},Slider.defaultAttributes,e)),this.name="slider",this._isHorizontal=!0,this._startHandler=null,this._endHandler=null,this._startHandlerText=null,this._endHandlerText=null,this._currentHandler=null,this._currentValue={},this._onTooltipShow=n=>{this._isChanging||this._tooltipState&&this._tooltipState.isActive||(this._tooltipState?this._tooltipState.isActive=!0:this._tooltipState={isActive:!0},this._onTooltipUpdate(n),this._dispatchTooltipEvent("sliderTooltipShow"))},this._onTooltipUpdate=n=>{if(this._isChanging||!this._tooltipState||!this._tooltipState.isActive)return;const o=this._isHorizontal?this._rail.globalAABBBounds.width():this._rail.globalAABBBounds.height(),l=clamp(this._isHorizontal?(n.viewX-this._rail.globalAABBBounds.x1)/o:(n.viewY-this._rail.globalAABBBounds.y1)/o,0,1);l!==this._tooltipState.pos&&(this._tooltipState.pos=l,this._tooltipState.value=this.calculateValueByPos(l*o),this._updateTooltip(),this._dispatchTooltipEvent("sliderTooltipUpdate"))},this._onTooltipHide=()=>{const{tooltip:n}=this.attribute;n&&n.alwaysShow||(this._tooltipState=null,this._tooltipShape&&this._tooltipShape.setAttribute("visible",!1),this._tooltipText&&this._tooltipText.setAttribute("visible",!1),this._dispatchTooltipEvent("sliderTooltipHide"))},this._onHandlerPointerdown=n=>{n.stopPropagation(),this._isChanging=!0;const{x:o,y:l}=this.stage.eventPointTransform(n);this._currentHandler=n.target,this._prePos=this._isHorizontal?o:l,vglobal.env==="browser"?(vglobal.addEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),vglobal.addEventListener("pointerup",this._onHandlerPointerUp)):(this.stage.addEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),this.stage.addEventListener("pointerup",this._onHandlerPointerUp),this.stage.addEventListener("pointerupoutside",this._onHandlerPointerUp))},this._onHandlerPointerMove=n=>{var o,l;n.stopPropagation(),this._isChanging=!0;const{railWidth:d,railHeight:u,min:f,max:g}=this.attribute;if(g===f)return;const{x:_,y}=this.stage.eventPointTransform(n);let b,S,v,A=0;this._isHorizontal?(b=_,A=b-this._prePos,S=(l=this._currentHandler)===null||l===void 0?void 0:l.attribute.x,v=d):(b=y,A=b-this._prePos,S=(o=this._currentHandler)===null||o===void 0?void 0:o.attribute.y,v=u);const x=clamp(S+A,0,v),T=this.calculateValueByPos(x);this._currentHandler.type==="text"?this._updateHandlerText(this._currentHandler,x,T):this._updateHandler(this._currentHandler,x,T),this._updateTrack(),this._prePos=b,this._dispatchChangeEvent()},this._onHandlerPointerUp=n=>{n.preventDefault(),this._isChanging=!1,this._currentHandler=null,vglobal.env==="browser"?(vglobal.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),vglobal.removeEventListener("pointerup",this._onHandlerPointerUp)):(this.stage.removeEventListener("pointermove",this._onHandlerPointerMove,{capture:!0}),this.stage.removeEventListener("pointerup",this._onHandlerPointerUp),this.stage.removeEventListener("pointerupoutside",this._onHandlerPointerUp))},this._onTrackPointerdown=n=>{n.stopPropagation(),this._isChanging=!0;const{x:o,y:l}=this.stage.eventPointTransform(n);this._prePos=this._isHorizontal?o:l,vglobal.env==="browser"?(vglobal.addEventListener("pointermove",this._onTrackPointerMove,{capture:!0}),vglobal.addEventListener("pointerup",this._onTrackPointerUp)):(this.stage.addEventListener("pointermove",this._onTrackPointerMove,{capture:!0}),this.stage.addEventListener("pointerup",this._onTrackPointerUp),this.stage.addEventListener("pointerupoutside",this._onTrackPointerUp))},this._onTrackPointerMove=n=>{n.stopPropagation(),this._isChanging=!0;const{railWidth:o,railHeight:l,min:d,max:u,inverse:f}=this.attribute;if(u===d)return;const{startHandler:g,endHandler:_}=this._getHandlers();let y,b,S;const{x:v,y:A}=this.stage.eventPointTransform(n);this._isHorizontal?(y=v,b=this._track.attribute.width,S=o):(y=A,b=this._track.attribute.height,S=l);const x=y-this._prePos;if(g){const T=this._isHorizontal?g.attribute.x:g.attribute.y,C=f?clamp(T+x,b,S):clamp(T+x,0,S-b),E=this.calculateValueByPos(C);this._updateHandler(g,C,E)}if(_){const T=this._isHorizontal?_.attribute.x:_.attribute.y,C=f?clamp(T+x,0,S-b):clamp(T+x,b,S),E=this.calculateValueByPos(C),P=g==null?void 0:g.attribute;this._updateHandler(_,C,E),this._track.setAttributes(this._isHorizontal?{x:Math.min(P.x,_.attribute.x),width:Math.abs(P.x-_.attribute.x)}:{y:Math.min(P.y,_.attribute.y),height:Math.abs(P.y-_.attribute.y)})}this._prePos=y,this._dispatchChangeEvent()},this._onTrackPointerUp=n=>{n.preventDefault(),this._isChanging=!1,vglobal.env==="browser"?(vglobal.removeEventListener("pointermove",this._onTrackPointerMove,{capture:!0}),vglobal.removeEventListener("pointerup",this._onTrackPointerUp)):(this.stage.removeEventListener("pointermove",this._onTrackPointerMove,{capture:!0}),this.stage.removeEventListener("pointerup",this._onTrackPointerUp),this.stage.removeEventListener("pointerupoutside",this._onTrackPointerUp))},this._onRailPointerDown=n=>{n.stopPropagation(),this._isChanging=!0;const{railWidth:o,railHeight:l,min:d,max:u}=this.attribute;if(u===d)return;const f=this._startHandler,g=this._endHandler;let _,y,b;this._isHorizontal?(_=n.viewX-this._rail.globalAABBBounds.x1,y=f==null?void 0:f.attribute.x,b=g==null?void 0:g.attribute.x):(_=n.viewY-this._rail.globalAABBBounds.y1,y=f==null?void 0:f.attribute.y,b=g==null?void 0:g.attribute.y);const S=this.calculateValueByPos(_);if(isValid(b)){const v=Math.abs(_-y)>Math.abs(_-b)?g:f;this._updateHandler(v,_,S)}else this._updateHandler(f,_,S);this._updateTrack(),this._dispatchChangeEvent()}}calculatePosByValue(e,i){const{layout:n,railWidth:o,railHeight:l,min:d,max:u,inverse:f}=this.attribute;let g=0;return g=d===u?i==="start"?0:i==="end"?1:0:(e-d)/(u-d),(f?1-g:g)*(n==="vertical"?l:o)}calculateValueByPos(e){const{layout:i,railWidth:n,railHeight:o,min:l,max:d,inverse:u}=this.attribute,f=i==="vertical"?o:n;return l+(d-l)*(u?1-e/f:e/f)}setValue(e){const{min:i,max:n}=this.attribute;if(n===i)return;const[o,l]=array(e),{startHandler:d,endHandler:u}=this._getHandlers();d&&this._updateHandler(d,this.calculatePosByValue(o),o),u&&this._updateHandler(u,this.calculatePosByValue(l),l),this._updateTrack()}render(){var e,i;this.removeAllChild(!0);const{layout:n="horizontal",railWidth:o,railHeight:l,startText:d,endText:u,min:f,max:g,showHandler:_=!0,showTooltip:y}=this.attribute;let{value:b}=this.attribute;isNil(b)&&(b=[f,g]),this._currentValue={startValue:convertValueToRange(b)[0],endValue:convertValueToRange(b)[1]};const S=n==="horizontal";this._isHorizontal=S;const v=graphicCreator.group({x:0,y:0});v.name=SLIDER_ELEMENT_NAME.innerView,this.add(v),this._innerView=v;let A,x=0;if(d&&d.visible){A=graphicCreator.text(Object.assign({x:S?0:o/2,y:S?l/2:0,textAlign:S?"start":"center",textBaseline:S?"middle":"top",text:d.text,lineHeight:(e=d.style)===null||e===void 0?void 0:e.fontSize},d.style)),A.name=SLIDER_ELEMENT_NAME.startText,v.add(A);const P=isValid(d.space)?d.space:0;x+=(S?A.AABBBounds.width():A.AABBBounds.height())+P}const T=graphicCreator.group({x:S?x:0,y:S?0:x});v.add(T);const C=graphicCreator.group({x:0,y:0});let E;if(C.name=SLIDER_ELEMENT_NAME.railContainer,this._railContainer=C,T.add(C),this._mainContainer=T,this._renderRail(C),x+=S?o:l,u&&u.visible){const P=isValid(u.space)?u.space:0;E=graphicCreator.text(Object.assign({x:S?x+P:o/2,y:S?l/2:x+P,textAlign:S?"start":"center",textBaseline:S?"middle":"top",text:u.text,lineHeight:(i=u.style)===null||i===void 0?void 0:i.fontSize},u.style)),E.name=SLIDER_ELEMENT_NAME.endText,v.add(E)}this._renderTrack(C),_&&(this._renderHandlers(T),this._bindEvents()),y&&(this._renderTooltip(),this._bindTooltipEvents())}_renderRail(e){const{railWidth:i,railHeight:n,railStyle:o,slidable:l}=this.attribute;let d="default";l!==!1&&(d="pointer");const u=graphicCreator.rect(Object.assign({x:0,y:0,width:i,height:n,cursor:d},o));return u.name=SLIDER_ELEMENT_NAME.rail,e.add(u),this._rail=u,u}_renderHandlers(e){const{range:i,min:n,max:o,handlerSize:l=14,handlerStyle:d,handlerText:u,railHeight:f,railWidth:g,slidable:_}=this.attribute;let{value:y}=this.attribute;isNil(y)&&(y=[n,o]);const b=u&&u.visible,S=this._isHorizontal,[v,A]=convertValueToRange(y),x=this.calculatePosByValue(v,i?"start":"end"),T=this._renderHandler(Object.assign({x:S?x:g/2,y:S?f/2:x,size:l,strokeBoundsBuffer:0,cursor:_===!1?"default":getDefaultCursor(S)},d));if(T.name=SLIDER_ELEMENT_NAME.startHandler,this._startHandler=T,e.add(T),this._currentValue.startPos=x,b){const C=this._renderHandlerText(v,i?"start":"end");C.name=SLIDER_ELEMENT_NAME.startHandlerText,e.add(C),this._startHandlerText=C}if(i){const C=this.calculatePosByValue(A,"end"),E=this._renderHandler(Object.assign({x:S?C:g/2,y:S?f/2:C,size:l,strokeBoundsBuffer:0,cursor:_===!1?"default":getDefaultCursor(S)},d));if(E.name=SLIDER_ELEMENT_NAME.endHandler,this._endHandler=E,e.add(E),this._currentValue.endPos=C,b){const P=this._renderHandlerText(A,"end");P.name=SLIDER_ELEMENT_NAME.endHandlerText,e.add(P),this._endHandlerText=P}}}_renderTrack(e){const{range:i,min:n,max:o,railHeight:l,railWidth:d,trackStyle:u,railStyle:f,slidable:g,value:_}=this.attribute;let y,b;if(isNil(_))i?(y=n,b=o):y=b=n;else if(i){const P=clampRange(_,n,o);y=P[0],b=P[1]}else y=n,b=clamp(_,n,o);const S=this._isHorizontal;i||(y=n);const v=graphicCreator.group({x:0,y:0,width:d,height:l,cornerRadius:f==null?void 0:f.cornerRadius,clip:!0,pickable:!1});v.name=SLIDER_ELEMENT_NAME.trackContainer;const A=isObject$1(i)&&i.draggableTrack===!0;let x;x=g===!1?"default":i===!1||A===!1?"pointer":getDefaultCursor(S);const T=this.calculatePosByValue(y,"start"),C=this.calculatePosByValue(b,i?"end":"start"),E=graphicCreator.rect(Object.assign({x:S?Math.min(T,C):0,y:S?0:Math.min(T,C),width:S?Math.abs(C-T):d,height:S?l:Math.abs(C-T),cursor:x},u));E.name=SLIDER_ELEMENT_NAME.track,this._track=E,v.add(E),e.add(v)}_renderHandler(e){return graphicCreator.symbol(e)}_renderHandlerText(e,i){var n,o,l;const{align:d,handlerSize:u=14,handlerText:f={},railHeight:g,railWidth:_,slidable:y}=this.attribute,b=this._isHorizontal,S=this.calculatePosByValue(e,i),v=(n=f.space)!==null&&n!==void 0?n:4,A={text:f.formatter?f.formatter(e):e.toFixed((o=f.precision)!==null&&o!==void 0?o:0),lineHeight:(l=f.style)===null||l===void 0?void 0:l.lineHeight,cursor:y===!1?"default":getDefaultCursor(b)};return b?d==="top"?(A.textBaseline="bottom",A.textAlign="center",A.x=S,A.y=(g-u)/2-v):(A.textBaseline="top",A.textAlign="center",A.x=S,A.y=(g+u)/2+v):d==="left"?(A.textBaseline="middle",A.textAlign="end",A.x=(_-u)/2-v,A.y=S):(A.textBaseline="middle",A.textAlign="start",A.x=(_+u)/2+v,A.y=S),graphicCreator.text(Object.assign(Object.assign({},A),f.style))}_renderTooltip(){var e;const{tooltip:i,railHeight:n,railWidth:o,align:l}=this.attribute;i&&i.alwaysShow?this._tooltipState={value:this._currentValue.startValue,pos:this._currentValue.startPos}:this._tooltipState=null;const d=this._isHorizontal?0:o/2,u=this._isHorizontal?n/2:0;if(i&&i.shape){const b=graphicCreator.symbol(Object.assign({pickable:!1,visible:!!this._tooltipState,x:d,y:u,symbolType:"circle"},i.shapeStyle));this._tooltipShape=b,this._mainContainer.add(b)}const f=i&&i.text||{},g=(e=f.space)!==null&&e!==void 0?e:6,_={pickable:!1,visible:!!this._tooltipState,text:""};this._isHorizontal?(_.x=d,_.y=l==="top"?u-n/2-g:u+n/2+g,_.textAlign="center",_.textBaseline=l==="top"?"bottom":"top"):(_.y=u,_.x=l==="left"?d-o/2-g:u+o/2+g,_.textAlign=l==="left"?"end":"start",_.textBaseline="middle");const y=graphicCreator.text(Object.assign(Object.assign({},_),f.style));this._mainContainer.add(y),this._tooltipText=y,this._tooltipState&&this._updateTooltip()}_updateTooltip(){var e,i;if(!this._tooltipShape&&!this._tooltipText||!this._tooltipState)return;const{railWidth:n,railHeight:o}=this.attribute,l=this._isHorizontal?n:o,d=this._tooltipState.pos*l,u=this._isHorizontal?"x":"y";this._tooltipShape&&this._tooltipShape.setAttributes({visible:!0,[u]:d});const{align:f}=this.attribute;if(this._tooltipText){const g=this.attribute.tooltip&&this.attribute.tooltip.text||{};this._tooltipText.setAttributes({visible:!0,[u]:d,text:g.formatter?g.formatter(this._tooltipState.value):this._isHorizontal||f!=="left"?` ${this._tooltipState.value.toFixed((i=g.precision)!==null&&i!==void 0?i:0)}`:`${this._tooltipState.value.toFixed((e=g.precision)!==null&&e!==void 0?e:0)} `})}}_bindEvents(){if(this.attribute.disableTriggerEvent)return;const{slidable:e,range:i}=this.attribute;e&&(this._startHandler&&this._startHandler.addEventListener("pointerdown",this._onHandlerPointerdown),this._startHandlerText&&this._startHandlerText.addEventListener("pointerdown",this._onHandlerPointerdown),this._endHandler&&this._endHandler.addEventListener("pointerdown",this._onHandlerPointerdown),this._endHandlerText&&this._endHandlerText.addEventListener("pointerdown",this._onHandlerPointerdown),isObject$1(i)&&i.draggableTrack&&this._track.addEventListener("pointerdown",this._onTrackPointerdown),this._railContainer.addEventListener("pointerdown",this._onRailPointerDown))}_bindTooltipEvents(){this.attribute.disableTriggerEvent||(this._mainContainer.addEventListener("pointerenter",this._onTooltipShow),this._mainContainer.addEventListener("pointermove",this._onTooltipUpdate),this._mainContainer.addEventListener("pointerleave",this._onTooltipHide))}_updateTrack(){const{inverse:e,railWidth:i,railHeight:n}=this.attribute,o=this._startHandler,l=this._endHandler;if(this._isHorizontal){const d=o==null?void 0:o.attribute.x;if(l){const u=l==null?void 0:l.attribute.x;this._track.setAttributes({x:Math.min(d,u),width:Math.abs(d-u)})}else e?this._track.setAttributes({x:d,width:i-d}):this._track.setAttributes({width:d})}else{const d=o==null?void 0:o.attribute.y;if(l){const u=l==null?void 0:l.attribute.y;this._track.setAttributes({y:Math.min(d,u),height:Math.abs(d-u)})}else e?this._track.setAttributes({y:d,height:n-d}):this._track.setAttributes({height:d})}}_updateHandler(e,i,n){var o;const l=this._isHorizontal;e.setAttribute(l?"x":"y",i);const d=e.name===SLIDER_ELEMENT_NAME.startHandler?this._startHandlerText:this._endHandlerText;if(d){const{handlerText:u={}}=this.attribute;d.setAttributes({text:u.formatter?u.formatter(n):n.toFixed((o=u.precision)!==null&&o!==void 0?o:0),[l?"x":"y"]:i})}e.name===SLIDER_ELEMENT_NAME.startHandler?(this._currentValue.startValue=n,this._currentValue.startPos=i):(this._currentValue.endValue=n,this._currentValue.endPos=i)}_updateHandlerText(e,i,n){var o;const l=this._isHorizontal,{handlerText:d={}}=this.attribute;e.setAttributes({[l?"x":"y"]:i,text:d.formatter?d.formatter(n):n.toFixed((o=d.precision)!==null&&o!==void 0?o:0)});const u=e.name===SLIDER_ELEMENT_NAME.startHandlerText?this._startHandler:this._endHandler;u&&u.setAttributes({[l?"x":"y"]:i}),e.name===SLIDER_ELEMENT_NAME.startHandlerText?(this._currentValue.startValue=n,this._currentValue.startPos=i):(this._currentValue.endValue=n,this._currentValue.endPos=i)}_dispatchChangeEvent(){const e=!!this.attribute.range,i=this._currentValue;this._dispatchEvent("change",{value:e?[Math.min(i.endValue,i.startValue),Math.max(i.endValue,i.startValue)]:i.startValue,position:e?[Math.min(i.endPos,i.startPos),Math.max(i.endPos,i.startPos)]:i.startPos})}_dispatchTooltipEvent(e){this._dispatchEvent("sliderTooltip",{type:e,position:this._tooltipState&&this._tooltipState.pos,value:this._tooltipState&&this._tooltipState.value})}_getHandlers(){const{inverse:e}=this.attribute;let i=this._startHandler,n=this._endHandler;return n?(this._isHorizontal?(!e&&n.attribute.x<(i==null?void 0:i.attribute.x)||e&&n.attribute.x>(i==null?void 0:i.attribute.x))&&([i,n]=[n,i]):(!e&&n.attribute.y<(i==null?void 0:i.attribute.y)||e&&n.attribute.y>(i==null?void 0:i.attribute.y))&&([i,n]=[n,i]),{startHandler:i,endHandler:n}):{startHandler:i,endHandler:n}}}Slider.defaultAttributes={slidable:!0,layout:"horizontal",align:"bottom",height:8,showHandler:!0,handlerSize:14,handlerStyle:{symbolType:"circle",fill:"#fff",stroke:"#91caff",lineWidth:2},tooltip:{shapeStyle:{symbolType:"circle",fill:"#fff",stroke:"#91caff",lineWidth:2},text:{style:{fill:"#2C3542",fontSize:12}}},railStyle:{fill:"rgba(0,0,0,.04)"},trackStyle:{fill:"#91caff"},showValue:!0,valueStyle:{fill:"#2C3542",fontSize:12},startText:{style:{fill:"#2C3542",fontSize:12}},endText:{style:{fill:"#2C3542",fontSize:12}},handlerText:{visible:!0,space:4,precision:0,style:{fill:"#2C3542",fontSize:12}}};loadColorContinuousLegendComponent();class ColorContinuousLegend extends LegendBase{constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},ColorContinuousLegend.defaultAttributes,e)),this.name="colorLegend",this._onSliderToolipChange=n=>{const o=this._slider.tooltipShape;if(o&&n.detail&&!isNil(n.detail.value)){const l=this._colorScale.scale(n.detail.value);o.setAttribute("fill",l)}this.dispatchEvent(n)},this._onSliderChange=n=>{this._updateColor(),this.dispatchEvent(n)}}setSelected(e){this._slider&&(this._slider.setValue(e),this._updateColor())}_renderContent(){const{colors:e,slidable:i,layout:n,align:o,min:l,max:d,value:u,railWidth:f,railHeight:g,showHandler:_=!0,handlerSize:y,handlerStyle:b,railStyle:S,trackStyle:v,startText:A,endText:x,handlerText:T,showTooltip:C,tooltip:E,inverse:P,disableTriggerEvent:R}=this.attribute,L=[],w=(d-l)/(e.length-1);for(let I=0;I<e.length;I++)L.push(l+w*I);this._colorScale=new LinearScale().domain(L,!0).range(e),this._color=this._getTrackColor();const B=new Slider({x:0,y:0,range:{draggableTrack:!0},slidable:i,layout:n,align:o,min:l,max:d,value:u,railWidth:f,railHeight:g,showHandler:_,handlerSize:y,handlerStyle:b,railStyle:S,trackStyle:Object.assign({fill:this._color},v),startText:A,endText:x,handlerText:T,showTooltip:C,tooltip:E,disableTriggerEvent:R,inverse:P});this._innerView.add(B),this._slider=B,B.translateTo(0-B.AABBBounds.x1,(this._title?this._title.AABBBounds.height()+get(this.attribute,"title.space",DEFAULT_TITLE_SPACE):0)-B.AABBBounds.y1),this._updateColor()}_bindEvents(){this.attribute.disableTriggerEvent||this._slider&&(this._slider.addEventListener("change",this._onSliderChange),this._slider.addEventListener("sliderTooltip",this._onSliderToolipChange))}_getTrackColor(){const{colors:e,layout:i,inverse:n}=this.attribute;if(isEmpty(e))return;const o=e.length;if(o===1)return e[0];const l=[];for(let f=0;f<o;f++){const g=f/(o-1);l.push({offset:g,color:e[f]})}const d=i==="horizontal",u={gradient:"linear",stops:l,x0:0,y0:0,x1:d?1:0,y1:d?0:1};return n&&(d?(u.x0=1,u.x1=0):(u.y0=1,u.y1=0)),u}_updateColor(){var e;const{layout:i="horizontal",colors:n,railWidth:o,railHeight:l}=this.attribute,{startHandler:d,endHandler:u,track:f,attribute:g}=this._slider,{startValue:_,endValue:y,startPos:b,endPos:S}=this._slider.currentValue,v=(e=g.handlerStyle)===null||e===void 0?void 0:e.fill;if(d&&!v){const x=this._colorScale.scale(_);d.setAttribute("fill",x)}if(u&&!v){const x=this._colorScale.scale(y);u.setAttribute("fill",x)}const A=i==="horizontal"?o:l;if(Math.abs(b-S)!==A&&n&&n.length>1){const x=this._color.stops,T=Math.min(b,S),C=Math.max(b,S),E=T/A,P=C/A,R=P-E,L=x.filter(N=>N.offset>E&&N.offset<P),w=Math.min(_,y),B=Math.max(_,y),I=this._colorScale.scale(w),D=this._colorScale.scale(B),O=[{offset:0,color:I}];L.forEach(N=>{O.push({offset:(N.offset-E)/R,color:N.color})}),O.push({offset:1,color:D}),f.setAttribute("fill",Object.assign(Object.assign({},this._color),{stops:O}))}}}ColorContinuousLegend.defaultAttributes={layout:"horizontal",title:{align:"start",space:DEFAULT_TITLE_SPACE,textStyle:{fontSize:12,fontWeight:"bold",fill:"rgba(46, 47, 50, 1)"}},handlerSize:10,handlerStyle:{fill:null,lineWidth:4,stroke:"#fff",outerBorder:{distance:2,lineWidth:1,stroke:"#ccc"}},tooltip:{shapeStyle:{lineWidth:4,stroke:"#fff"}}};function getSizeHandlerPath(r="bottom"){let e=0;return r==="top"?`
    M${e},-6L${e-3.5},-2.5
    v5
    h7
    v-5
    Z
`:r==="left"?(e=1,`
    M${e-6},0L${e-6+2.5},-3.5
    h5
    v7
    h-5
    Z
`):r==="right"?(e=-1,`
    M${e+6},0L${e+6-2.5},-3.5
    h-5
    v7
    h5
    Z
  `):`
    M${e},6L${e-3.5},2.5
    v-5
    h7
    v5
    Z
`}loadSizeContinuousLegendComponent();class SizeContinuousLegend extends LegendBase{constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},SizeContinuousLegend.defaultAttributes,e)),this.name="sizeLegend",this._onSliderChange=n=>{this.dispatchEvent(n)},this._onSliderToolipChange=n=>{this.dispatchEvent(n)}}setSelected(e){this._slider&&this._slider.setValue(e)}_renderContent(){const{slidable:e,layout:i,align:n,min:o,max:l,value:d,railWidth:u,railHeight:f,showHandler:g=!0,handlerSize:_,handlerStyle:y,railStyle:b,trackStyle:S,startText:v,endText:A,handlerText:x,showTooltip:T,tooltip:C,sizeBackground:E,disableTriggerEvent:P,inverse:R}=this.attribute,L=graphicCreator.group({x:0,y:0});this._innerView.add(L);const w=new Slider({x:0,y:0,zIndex:1,range:{draggableTrack:!0},slidable:e,layout:i,align:n,min:o,max:l,value:d,railWidth:u,railHeight:f,showHandler:g,handlerSize:_,handlerStyle:Object.assign({symbolType:getSizeHandlerPath(n)},y),railStyle:b,trackStyle:S,startText:v,endText:A,handlerText:x,showTooltip:T,tooltip:C,disableTriggerEvent:P,inverse:R});L.add(w);let B,I=0;i==="horizontal"?n==="top"?(B=`M0,0L${u},0L${R?0:u},12Z`,I=f):(B=`M0,12L${u},12L${R?0:u},0Z`,w.setAttribute("y",12)):n==="left"?B=`M${u},0L${u+12},${R?0:f}L${u},${f}Z`:(B=`M0,${R?0:f}L12,${f}L12,0Z`,w.setAttribute("x",12));const D=graphicCreator.path(Object.assign(Object.assign({x:0,y:I,path:B},E),{zIndex:0}));L.add(D);const O=this._title?this._title.AABBBounds.height()+get(this.attribute,"title.space",DEFAULT_TITLE_SPACE):0;L.translate(0-L.AABBBounds.x1,O-L.AABBBounds.y1),this._slider=w}_bindEvents(){this.attribute.disableTriggerEvent||this._slider&&(this._slider.addEventListener("change",this._onSliderChange),this._slider.addEventListener("sliderTooltip",this._onSliderToolipChange))}}SizeContinuousLegend.defaultAttributes={layout:"horizontal",title:{align:"start",space:DEFAULT_TITLE_SPACE,textStyle:{fontSize:12,fontWeight:"bold",fill:"rgba(46, 47, 50, 1)"}},handlerSize:10,handlerStyle:{lineWidth:1,stroke:"#ccc",fill:"#fff"},sizeBackground:{fill:"rgba(20,20,20,0.1)"}};function loadTitleComponent(){registerGroup(),registerText(),registerRichtext()}loadTitleComponent();let Title$1=class Ge extends AbstractComponent{constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},Ge.defaultAttributes,e)),this.name="title"}render(){var e,i,n,o,l,d,u,f,g,_,y,b,S,v,A,x,T,C,E;const{textType:P,text:R,subtextType:L,textStyle:w={},subtext:B,subtextStyle:I={},width:D,height:O,minWidth:N,maxWidth:V,minHeight:H,maxHeight:F,align:$,verticalAlign:G,padding:Y=0}=this.attribute,Q=normalizePadding$1(Y),q=this.createOrUpdateChild("title-container",{x:Q[3],y:Q[0],zIndex:1},"group"),te=(e=w.height)!==null&&e!==void 0?e:O;if(this.attribute.visible!==!1&&w.visible!==!1){const{width:J,maxHeight:ie,maxWidth:le,x:ce=0,y:j=0,ellipsis:W=!0,wordBreak:K="break-word",maxWidth:ne,lineClamp:re}=w;if(P==="rich"||isValid(w.character)){const ae=Object.assign({x:ce,y:j,width:(i=J??D)!==null&&i!==void 0?i:0,height:te??0,ellipsis:W==null||W,wordBreak:K??"break-word",maxHeight:ie??F,maxWidth:le??ne,textConfig:(n=w.character)!==null&&n!==void 0?n:R},w);this._mainTitle=q.createOrUpdateChild("mainTitle",ae,"richtext")}else if(P==="html"){const ae=Object.assign({html:Object.assign(Object.assign({dom:R},DEFAULT_HTML_TEXT_SPEC),w),x:ce,y:j,width:(o=J??D)!==null&&o!==void 0?o:0,height:te??0,ellipsis:W,wordBreak:K,maxHeight:ie??F,maxWidth:le??ne,textConfig:[]},w);this._mainTitle=q.createOrUpdateChild("mainTitle",ae,"richtext")}else isValid(R)&&(this._mainTitle=q.createOrUpdateChild("mainTitle",Object.assign(Object.assign({text:isArray(R)?R:[R],whiteSpace:"normal"},w),{maxLineWidth:(d=(l=w.maxLineWidth)!==null&&l!==void 0?l:J)!==null&&d!==void 0?d:D,heightLimit:(u=w.height)!==null&&u!==void 0?u:F,lineClamp:re,ellipsis:W,x:ce,y:j}),"text"))}const ue=this._mainTitle?this._mainTitle.AABBBounds.height():0,he=this._mainTitle?this._mainTitle.AABBBounds.width():0;if(this.attribute.visible!==!1&&I.visible!==!1){const{width:J,height:ie,maxWidth:le,maxHeight:ce,x:j=0,y:W=0,ellipsis:K=!0,wordBreak:ne="break-word",lineClamp:re}=I,ae=Math.max(Number.MIN_VALUE,F-ue);if(L==="rich"||isValid(I.character)){const z=Object.assign({x:j,y:W,width:(f=J??D)!==null&&f!==void 0?f:0,height:(g=ie??O)!==null&&g!==void 0?g:0,ellipsis:K,wordBreak:ne,maxHeight:ce??ae,maxWidth:le??V,textConfig:(_=I.character)!==null&&_!==void 0?_:B},I);this._subTitle=q.createOrUpdateChild("subTitle",z,"richtext")}else if(L==="html"){const z=Object.assign({html:Object.assign(Object.assign({dom:B},DEFAULT_HTML_TEXT_SPEC),I),x:j,y:W,width:(y=J??D)!==null&&y!==void 0?y:0,height:(b=ie??O)!==null&&b!==void 0?b:0,ellipsis:K,wordBreak:ne,maxHeight:ce??ae,maxWidth:le??V,textConfig:[]},I);this._subTitle=q.createOrUpdateChild("subTitle",z,"richtext")}else isValid(B)&&(this._subTitle=q.createOrUpdateChild("subTitle",Object.assign(Object.assign({text:isArray(B)?B:[B],whiteSpace:"normal"},I),{maxLineWidth:(S=I.maxLineWidth)!==null&&S!==void 0?S:D,heightLimit:(v=I.heightLimit)!==null&&v!==void 0?v:ae,lineClamp:re,ellipsis:K,x:0,y:ue}),"text"))}const fe=this._subTitle?this._subTitle.AABBBounds.height():0,pe=this._subTitle?this._subTitle.AABBBounds.width():0;let me=Math.max(he,pe),ee=ue+((A=I.height)!==null&&A!==void 0?A:fe);if(isValid(D)&&(me=D),isValid(O)&&(ee=O),isValid(N)&&me<N&&(me=N),isValid(V)&&me>V&&(me=V),isValid(H)&&ee<H&&(ee=H),isValid(F)&&ee>F&&(ee=F),q.attribute.width=me,q.attribute.height=ee,q.attribute.boundsPadding=Q,this._mainTitle){if(isValid($)||isValid(w.align)){const J=w.align?w.align:$,ie=(x=w.width)!==null&&x!==void 0?x:me;J==="center"?(this._mainTitle.setAttribute("x",ie/2),this._mainTitle.setAttribute("textAlign","center")):J==="right"?(this._mainTitle.setAttribute("x",ie),this._mainTitle.setAttribute("textAlign","right")):(this._mainTitle.setAttribute("x",0),this._mainTitle.setAttribute("textAlign","left"))}if(isValid(G)||isValid(w.verticalAlign)){const J=w.verticalAlign?w.verticalAlign:G;J==="middle"&&isValid(te)?(this._mainTitle.setAttribute("y",te/2),this._mainTitle.setAttribute("textBaseline","middle")):J==="bottom"&&isValid(te)?(this._mainTitle.setAttribute("y",te),this._mainTitle.setAttribute("textBaseline","bottom")):(this._mainTitle.setAttribute("y",0),this._mainTitle.setAttribute("textBaseline","top"))}}if(this._subTitle){if(isValid($)||isValid(I.align)){const J=I.align?I.align:$,ie=(C=(T=I.width)!==null&&T!==void 0?T:w.width)!==null&&C!==void 0?C:me;J==="center"?(this._subTitle.setAttribute("x",ie/2),this._subTitle.setAttribute("textAlign","center")):J==="right"?(this._subTitle.setAttribute("x",ie),this._subTitle.setAttribute("textAlign","right")):(this._subTitle.setAttribute("x",0),this._subTitle.setAttribute("textAlign","left"))}if(isValid(G)||isValid(w.verticalAlign)){const J=I.verticalAlign?I.verticalAlign:G,ie=this._mainTitle?isValid(te)?this._mainTitle.AABBBounds.y1+Math.max(this._mainTitle.AABBBounds.height(),te):this._mainTitle.AABBBounds.y2:0,le=(E=I.height)!==null&&E!==void 0?E:O;J==="middle"&&isValid(le)?(this._subTitle.setAttribute("y",ie+le/2),this._subTitle.setAttribute("textBaseline","middle")):J==="bottom"&&isValid(le)?(this._subTitle.setAttribute("y",ie+le),this._subTitle.setAttribute("textBaseline","bottom")):(this._subTitle.setAttribute("y",ie),this._subTitle.setAttribute("textBaseline","top"))}}}};Title$1.defaultAttributes={textStyle:{ellipsis:"...",fill:"#333",fontSize:20,fontWeight:"bold",textAlign:"left",textBaseline:"top"},subtextStyle:{ellipsis:"...",fill:"#6F6F6F",fontSize:16,fontWeight:"normal",textAlign:"left",textBaseline:"top"}};const DEFAULT_INDICATOR_THEME={title:{style:{text:"",fontSize:20,fill:"black",fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}},content:{style:{text:"",fontSize:16,fill:"black",fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}}};function loadIndicatorComponent(){registerGroup(),registerText(),registerRichtext()}loadIndicatorComponent();let Indicator$1=class extends AbstractComponent{constructor(){super(...arguments),this.name="indicator"}_renderText(e,i,n,o,l,d){if(i.visible!==!1){const u=merge$1({},get(DEFAULT_INDICATOR_THEME,l),i.style,{visible:i.visible});u.lineHeight=isValid(u.lineHeight)?u.lineHeight:u.fontSize,i.formatMethod&&(u._originText=u.text,u.text=i.formatMethod(u.text,u));const f=createTextGraphicByType(u);return f.name=d,e.appendChild(f),i.autoFit&&isValidNumber(n)&&this._setLocalAutoFit(n,f,i),i.autoLimit&&isValidNumber(o)&&f.setAttribute("maxLineWidth",n),f}}render(){var e,i;if(this.removeAllChild(!0),this.attribute.visible!==!0)return;const{title:n={},content:o,size:l,limitRatio:d=1/0}=this.attribute,u=Math.min(l.width,l.height)*d,f=this.createOrUpdateChild("indicator-container",{x:0,y:0,zIndex:1,pickable:(e=this.attribute.pickable)===null||e===void 0||e},"group");if(isValid(n)&&(this._title=this._renderText(f,n,u,d,"title.style","indicator-title")),isValid(o)){const _=array(o),y=[];_.forEach((b,S)=>{b.visible!==!1&&y.push(this._renderText(f,b,u,d,"content.style","indicator-content-"+S))}),this._content=y}this._setGlobalAutoFit(u),this._setYPosition();const g=(i=f==null?void 0:f.AABBBounds.height())!==null&&i!==void 0?i:0;f.setAttribute("y",l.height/2-g/2),f.setAttribute("x",l.width/2)}_setLocalAutoFit(e,i,n){var o,l,d,u,f,g,_,y,b;if(((o=n.fitStrategy)!==null&&o!==void 0?o:"default")!=="default")return;const S=measureTextSize((d=(l=n.style)===null||l===void 0?void 0:l.text)!==null&&d!==void 0?d:"",(u=n.style)!==null&&u!==void 0?u:{},(g=(f=this.stage)===null||f===void 0?void 0:f.getTheme())===null||g===void 0?void 0:g.text).width;if(S>0){const v=e*((_=n.fitPercent)!==null&&_!==void 0?_:.5)/S,A=Math.floor(((b=(y=n.style)===null||y===void 0?void 0:y.fontSize)!==null&&b!==void 0?b:20)*v);i.setAttribute("fontSize",A),i.setAttribute("lineHeight",isValid(n.style.lineHeight)?n.style.lineHeight:A)}}_setGlobalAutoFit(e){var i,n,o,l,d,u,f;const g=e/2,_=[];let y=0;const b=(i=this.attribute.title)!==null&&i!==void 0?i:{};b.autoFit&&b.fitStrategy==="inscribed"?(this._title.setAttribute("fontSize",12),_.push({text:this._title,spec:(n=this.attribute.title)!==null&&n!==void 0?n:{}})):y+=(u=(d=(l=(o=this._title)===null||o===void 0?void 0:o.AABBBounds)===null||l===void 0?void 0:l.height)===null||d===void 0?void 0:d.call(l))!==null&&u!==void 0?u:0;const S=(f=b.space)!==null&&f!==void 0?f:0;if(y+=S,array(this.attribute.content).filter(R=>R.visible!==!1).forEach((R,L)=>{var w,B,I,D;const O=this._content[L];R.autoFit&&R.fitStrategy==="inscribed"?(O.setAttribute("fontSize",12),_.push({text:O,spec:R})):y+=(I=(B=(w=O==null?void 0:O.AABBBounds)===null||w===void 0?void 0:w.height)===null||B===void 0?void 0:B.call(w))!==null&&I!==void 0?I:0;const N=(D=R.space)!==null&&D!==void 0?D:0;y+=N}),_.length<=0)return;const v=12/_.reduce((R,L)=>Math.max(R,L.text.AABBBounds.width()),0)*_.length,A=y/2,x=v**2+1,T=2*A*v,C=A**2-g**2,E=2*(v*((-T+Math.sqrt(T**2-4*x*C))/(2*x))+A),P=(E-y)/_.length;isValidNumber(E)&&_.forEach(R=>{var L;const w=(L=R.spec.style)===null||L===void 0?void 0:L.lineHeight;R.text.setAttribute("fontSize",P),R.text.setAttribute("lineHeight",isValid(w)?w:P)})}_setYPosition(){var e,i,n,o,l,d;let u=0;const f=(o=(n=(i=(e=this._title)===null||e===void 0?void 0:e.AABBBounds)===null||i===void 0?void 0:i.height)===null||n===void 0?void 0:n.call(i))!==null&&o!==void 0?o:0,g=(d=(l=this.attribute.title)===null||l===void 0?void 0:l.space)!==null&&d!==void 0?d:0;array(this.attribute.content).filter(_=>_.visible!==!1).forEach((_,y)=>{var b;const S=this._content[y];S.setAttribute("y",f+g+u);const v=(b=_.space)!==null&&b!==void 0?b:0;u+=S.AABBBounds.height()+v})}};const iconPlay="M 414.5 0.0238 c 228.9128 0 414.4762 185.5634 414.4762 414.4762 s -185.5634 414.4762 -414.4762 414.4762 S 0.0238 643.4128 0.0238 414.5 S 185.5872 0.0238 414.5 0.0238 z m 0 73.1429 C 225.9865 73.1667 73.1667 225.9865 73.1667 414.5 s 152.8198 341.3333 341.3333 341.3333 s 341.3333 -152.8198 341.3333 -341.3333 S 603.0135 73.1667 414.5 73.1667 z m -73.1429 161.4994 a 48.7619 48.7619 0 0 1 25.9901 7.5093 l 201.7524 127.1223 a 48.7619 48.7619 0 0 1 0.3657 82.2613 l -201.7524 129.6335 A 48.7619 48.7619 0 0 1 292.5952 540.1838 v -256.7314 a 48.7619 48.7619 0 0 1 48.7619 -48.7619 z m 24.381 92.9402 v 167.9116 l 131.9497 -84.7726 L 365.7381 327.6063 z",iconPause="M 414.5 0.0238 c 228.9128 0 414.4762 185.5634 414.4762 414.4762 s -185.5634 414.4762 -414.4762 414.4762 S 0.0238 643.4128 0.0238 414.5 S 185.5872 0.0238 414.5 0.0238 z m 0 73.1429 C 225.9865 73.1667 73.1667 225.9865 73.1667 414.5 s 152.8198 341.3333 341.3333 341.3333 s 341.3333 -152.8198 341.3333 -341.3333 S 603.0135 73.1667 414.5 73.1667 z m -48.7619 195.0476 v 316.9524 h -73.1429 V 268.2143 h 73.1429 z m 158.4762 0 v 316.9524 h -73.1429 V 268.2143 h 73.1429 z",iconLeft="M 521.29 734.276 L 230.929 448.019 L 521.29 161.762 c 37.685 -37.153 38.003 -97.625 0.707 -134.384 c -37.297 -36.758 -98.646 -36.435 -136.331 0.718 l -357.43 352.378 c -0.155 0.153 -0.297 0.314 -0.451 0.468 c -0.084 0.082 -0.172 0.157 -0.256 0.239 c -18.357 18.092 -27.581 41.929 -27.743 65.902 c -0.004 0.311 -0.017 0.623 -0.018 0.934 c 0.001 0.316 0.014 0.632 0.018 0.948 c 0.165 23.97 9.389 47.803 27.743 65.892 c 0.083 0.082 0.171 0.157 0.255 0.239 c 0.154 0.154 0.296 0.315 0.452 0.468 l 357.43 352.378 c 37.685 37.153 99.034 37.476 136.331 0.718 c 37.297 -36.758 36.979 -97.231 -0.707 -134.384 z",iconDown="M 734.276 28.71 L 448.019 319.071 L 161.762 28.71 c -37.153 -37.685 -97.625 -38.003 -134.384 -0.707 c -36.758 37.297 -36.435 98.646 0.718 136.331 l 352.378 357.43 c 0.153 0.155 0.314 0.297 0.468 0.451 c 0.082 0.084 0.157 0.172 0.239 0.256 c 18.092 18.357 41.929 27.581 65.902 27.743 c 0.311 0.004 0.623 0.017 0.934 0.018 c 0.316 -0.001 0.632 -0.014 0.948 -0.018 c 23.97 -0.165 47.803 -9.389 65.892 -27.743 c 0.082 -0.083 0.157 -0.171 0.239 -0.255 c 0.154 -0.154 0.315 -0.296 0.468 -0.452 l 352.378 -357.43 c 37.153 -37.685 37.476 -99.034 0.718 -136.331 c -36.758 -37.297 -97.231 -36.979 -134.384 0.707 z",iconUp="m 161.724 521.29 l 286.257 -290.361 l 286.257 290.361 c 37.153 37.685 97.625 38.003 134.384 0.707 c 36.758 -37.297 36.435 -98.646 -0.718 -136.331 l -352.378 -357.43 c -0.153 -0.155 -0.314 -0.297 -0.468 -0.451 c -0.082 -0.084 -0.157 -0.172 -0.239 -0.256 c -18.092 -18.357 -41.929 -27.581 -65.902 -27.743 c -0.311 -0.004 -0.623 -0.017 -0.934 -0.018 c -0.316 0.001 -0.632 0.014 -0.948 0.018 c -23.97 0.165 -47.803 9.389 -65.892 27.743 c -0.082 0.083 -0.157 0.171 -0.239 0.255 c -0.154 0.154 -0.315 0.296 -0.468 0.452 l -352.378 357.43 c -37.153 37.685 -37.476 99.034 -0.718 136.331 c 36.758 37.297 97.231 36.979 134.384 -0.707 z",iconRight="M 30 163 L 320.361 449.257 L 30 735.514 c -37.685 37.153 -38.003 97.625 -0.707 134.384 c 37.297 36.758 98.646 36.435 136.331 -0.718 l 357.43 -352.378 c 0.155 -0.153 0.297 -0.314 0.451 -0.468 c 0.084 -0.082 0.172 -0.157 0.256 -0.239 c 18.357 -18.092 27.581 -41.929 27.743 -65.902 c 0.004 -0.311 0.017 -0.623 0.018 -0.934 c -0.001 -0.316 -0.014 -0.632 -0.018 -0.948 c -0.165 -23.97 -9.389 -47.803 -27.743 -65.892 c -0.083 -0.082 -0.171 -0.157 -0.255 -0.239 c -0.154 -0.154 -0.296 -0.315 -0.452 -0.468 l -357.43 -352.378 c -37.685 -37.153 -99.034 -37.476 -136.331 -0.718 c -37.297 36.758 -36.979 97.231 0.707 134.384 z";class PlayerIcon extends Symbol$1{constructor(e){super(e)}}var ControllerEventEnum;(function(r){r.OnPlay="onPlay",r.OnPause="onPause",r.OnForward="onForward",r.OnBackward="onBackward"})(ControllerEventEnum||(ControllerEventEnum={}));var ControllerTypeEnum;(function(r){r.Start="start",r.Pause="pause",r.Forward="forward",r.Backward="backward"})(ControllerTypeEnum||(ControllerTypeEnum={}));class Controller extends AbstractComponent{constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},Controller.defaultAttributes,e)),this._isPaused=!0,this.updateAttributes=()=>{this._startAttr={style:Object.assign(Object.assign(Object.assign({symbolType:iconPlay},Controller.defaultControllerAttr),{visible:this.attribute.start.visible}),this.attribute.start.style)},this._pauseAttr={style:Object.assign(Object.assign(Object.assign({symbolType:iconPause},Controller.defaultControllerAttr),{visible:this.attribute.pause.visible}),this.attribute.pause.style)},this._forwardAttr={style:Object.assign(Object.assign(Object.assign({},Controller.defaultControllerAttr),{visible:this.attribute.forward.visible}),this.attribute.forward.style)},this._backwardAttr={style:Object.assign(Object.assign(Object.assign({},Controller.defaultControllerAttr),{visible:this.attribute.backward.visible}),this.attribute.backward.style)},this.updateLayout()},this.updateLayout=()=>{var n,o,l,d;this._layout=this.attribute.layout,this._layout==="horizontal"?(this._backwardAttr.style.symbolType=(n=this._backwardAttr.style.symbolType)!==null&&n!==void 0?n:iconLeft,this._forwardAttr.style.symbolType=(o=this._forwardAttr.style.symbolType)!==null&&o!==void 0?o:iconRight):this._layout==="vertical"&&(this._backwardAttr.style.symbolType=(l=this._backwardAttr.style.symbolType)!==null&&l!==void 0?l:iconUp,this._forwardAttr.style.symbolType=(d=this._forwardAttr.style.symbolType)!==null&&d!==void 0?d:iconDown)},this._initPlay=()=>{isNil(this._playController)&&(this._playController=new PlayerIcon(Object.assign({},this._startAttr.style)),this.add(this._playController))},this._initBackward=()=>{isNil(this._backwardController)&&(this._backwardController=new PlayerIcon(Object.assign({},this._backwardAttr.style)),this.add(this._backwardController))},this._initForward=()=>{isNil(this._forwardController)&&(this._forwardController=new PlayerIcon(Object.assign({},this._forwardAttr.style)),this.add(this._forwardController))},this._initEvents=()=>{this.attribute.disableTriggerEvent||(this._playController.addEventListener("pointerdown",n=>{n.stopPropagation(),this._isPaused===!0?this.play():this.pause()}),this._backwardController.addEventListener("pointerdown",n=>{n.stopPropagation(),this.backward()}),this._forwardController.addEventListener("pointerdown",n=>{n.stopPropagation(),this.forward()}))},this.renderPlay=()=>{this._isPaused?this._playController.setAttributes(Object.assign({symbolType:this._playController.getComputedAttribute("symbolType")},this._startAttr.style)):this._playController.setAttributes(Object.assign({symbolType:this._playController.getComputedAttribute("symbolType")},this._pauseAttr.style))},this.renderBackward=()=>{this._backwardController.setAttributes(this._backwardAttr.style)},this.renderForward=()=>{this._forwardController.setAttributes(this._forwardAttr.style)},this.play=()=>{this._dispatchEvent(ControllerEventEnum.OnPlay)},this.pause=()=>{this._dispatchEvent(ControllerEventEnum.OnPause)},this.forward=()=>{this._dispatchEvent(ControllerEventEnum.OnForward)},this.backward=()=>{this._dispatchEvent(ControllerEventEnum.OnBackward)},this.togglePlay=()=>{this._playController.setAttributes(this._startAttr.style),this._isPaused=!0},this.togglePause=()=>{this._playController.setAttributes(this._pauseAttr.style),this._isPaused=!1},this.updateAttributes(),this._initPlay(),this._initBackward(),this._initForward(),this._initEvents()}render(){this.updateAttributes(),this.renderPlay(),this.renderBackward(),this.renderForward()}}Controller.defaultControllerAttr={visible:!0,x:0,y:0,size:20,fill:"#91caff",pickMode:"imprecise",cursor:"pointer"},Controller.defaultAttributes={[ControllerTypeEnum.Start]:{},[ControllerTypeEnum.Pause]:{},[ControllerTypeEnum.Backward]:{},[ControllerTypeEnum.Forward]:{}};const defaultControllerAttributes={visible:!0,style:{x:0,y:0,dx:0,dy:0,size:20},order:0,space:10},RailDefaultSize=[200,10];var DirectionEnum;(function(r){r.Default="default",r.Reverse="reverse"})(DirectionEnum||(DirectionEnum={}));var PlayerEventEnum;(function(r){r.change="change",r.play="play",r.pause="pause",r.backward="backward",r.forward="forward",r.end="end",r.OnChange="change",r.OnPlay="play",r.OnPause="pause",r.OnBackward="backward",r.OnForward="forward",r.OnEnd="end"})(PlayerEventEnum||(PlayerEventEnum={}));const isReachEndByDefault=({direction:r,maxIndex:e,dataIndex:i})=>r===DirectionEnum.Default&&i===e,isReachEndByReverse=({direction:r,minIndex:e,dataIndex:i})=>r===DirectionEnum.Reverse&&i===e,isReachEnd=({direction:r,maxIndex:e,minIndex:i,dataIndex:n})=>isReachEndByDefault({direction:r,maxIndex:e,dataIndex:n})||isReachEndByReverse({direction:r,minIndex:i,dataIndex:n}),isReachStartByDefault=({direction:r,minIndex:e,dataIndex:i})=>r===DirectionEnum.Default&&i===e,isReachStartByReverse=({direction:r,maxIndex:e,dataIndex:i})=>r===DirectionEnum.Reverse&&i===e,isReachStart=({direction:r,maxIndex:e,minIndex:i,dataIndex:n})=>isReachStartByDefault({direction:r,minIndex:i,dataIndex:n})||isReachStartByReverse({direction:r,maxIndex:e,dataIndex:n}),isHorizontal$1=r=>r==="top"||r==="bottom",forwardStep=(r,e,i,n)=>r==="default"?Math.min(e+1,n):Math.max(e-1,i);class BasePlayer extends AbstractComponent{getMinIndex(){return this._minIndex}getMaxIndex(){return this._maxIndex}getDataIndex(){return this._dataIndex}constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},BasePlayer.defaultAttributes,e)),this._data=[],this._dataIndex=0,this._layoutInfo={},this._updateSliderAttrs=()=>{var n,o;let l;isValidNumber(this._handlerStyle.size)?l=this._handlerStyle.size:this._handlerStyle.size&&this._handlerStyle.size.length&&(l=max$1(this._handlerStyle.size[0],this._handlerStyle.size[1]));const d={visible:this._sliderVisible,min:this._minIndex,max:this._maxIndex,value:this._dataIndex,railWidth:this._railStyle.width,railHeight:this._railStyle.height,railStyle:this._railStyle,trackStyle:this._trackStyle,handlerSize:isValidNumber(l)?l:void 0,handlerStyle:this._handlerStyle,dy:this.attribute.slider.dy,dx:this.attribute.slider.dx,slidable:!0,range:!1,handlerText:{visible:!1},startText:{visible:!1},endText:{visible:!1},disableTriggerEvent:this.attribute.disableTriggerEvent};if(isHorizontal$1(this._orient)){const u=Math.max(0,this._layoutInfo.slider.size),f=(n=this._railStyle.height)!==null&&n!==void 0?n:RailDefaultSize[1];d.layout="horizontal",d.railHeight=f,d.railWidth=u,d.x=this._layoutInfo.slider.x,d.y=this._layoutInfo.slider.y}else{const u=Math.max(0,this._layoutInfo.slider.size),f=(o=this._railStyle.width)!==null&&o!==void 0?o:RailDefaultSize[1];d.layout="vertical",d.railWidth=f,d.railHeight=u,d.x=this._layoutInfo.slider.x,d.y=this._layoutInfo.slider.y}return d},this._initSlider=()=>{const n=this._updateSliderAttrs();this._slider=new Slider(n),this._sliderVisible&&this.add(this._slider)},this._updateControllerAttrs=()=>{const n={start:this._start,pause:this._pause,forward:this._forward,backward:this._backward,disableTriggerEvent:this.attribute.disableTriggerEvent};return n.layout=isHorizontal$1(this._orient)?"horizontal":"vertical",n.start=Object.assign(Object.assign({},n.start),{style:Object.assign(Object.assign({},n.start.style),{x:this._layoutInfo.start.x,y:this._layoutInfo.start.y})}),n.pause=Object.assign(Object.assign({},n.pause),{style:Object.assign(Object.assign({},n.pause.style),{x:this._layoutInfo.start.x,y:this._layoutInfo.start.y})}),n.backward=Object.assign(Object.assign({},n.backward),{style:Object.assign(Object.assign({},n.backward.style),{x:this._layoutInfo.backward.x,y:this._layoutInfo.backward.y})}),n.forward=Object.assign(Object.assign({},n.forward),{style:Object.assign(Object.assign({},n.forward.style),{x:this._layoutInfo.forward.x,y:this._layoutInfo.forward.y})}),n},this._initController=()=>{const n=this._updateControllerAttrs();this._controller=new Controller(n),this._controllerVisible&&this.add(this._controller)},this._initAttributes(),this._initDataIndex(),this._initLayoutInfo(),this._initController(),this._initSlider()}_initAttributes(){this._size=this.attribute.size,this._orient=this.attribute.orient,this._data=this.attribute.data,this._minIndex=0,this._maxIndex=this._data.length-1;const{slider:e={},controller:i={}}=this.attribute;this._sliderVisible=e.visible,this._railStyle=Object.assign({},e.railStyle),this._trackStyle=Object.assign({},e.trackStyle),this._handlerStyle=Object.assign({},e.handlerStyle),this._controllerVisible=i.visible,this._start=Object.assign({},i.start),this._pause=Object.assign({},i.pause),this._forward=Object.assign({},i.forward),this._backward=Object.assign({},i.backward)}_initDataIndex(){var e;this._dataIndex=(e=this.attribute.dataIndex)!==null&&e!==void 0?e:0}_initLayoutInfo(){var e,i,n;const o=[this._start,this._backward,this._forward].sort((b,S)=>b.order-S.order),l=o.filter(b=>b.position!=="end"),d=o.filter(b=>b.position==="end"),u=(e=isHorizontal$1(this._orient)?this._railStyle.height:this._railStyle.width)!==null&&e!==void 0?e:RailDefaultSize[1],f=o.reduce((b,S)=>{const v=S.style.size,A=isNumber(v)?v:max$1(v[0],v[1]);return b+S.space+A},0),g=this._sliderVisible?(isHorizontal$1(this._orient)?(i=this._size)===null||i===void 0?void 0:i.width:(n=this._size)===null||n===void 0?void 0:n.height)-f:0,_=g-this.attribute.slider.space,y=l.reduce((b,S)=>{const{key:v,space:A,style:{size:x}}=S,T=isNumber(x)?x:max$1(x[0],x[1]);return this._layoutInfo[v]=Object.assign(Object.assign({},this._layoutInfo[v]),{size:T,x:isHorizontal$1(this._orient)?b+A:(this._size.width-T)/2,y:isHorizontal$1(this._orient)?(this._size.height-T)/2:b+A}),b+A+T},0);this._layoutInfo.slider=Object.assign(Object.assign({},this._layoutInfo.slider),{size:_,x:isHorizontal$1(this._orient)?y+this.attribute.slider.space:(this._size.width-u)/2,y:isHorizontal$1(this._orient)?(this._size.height-u)/2:y+this.attribute.slider.space}),d.reduce((b,S)=>{const{key:v,space:A,style:{size:x}}=S,T=isNumber(x)?x:max$1(x[0],x[1]);return this._layoutInfo[v]=Object.assign(Object.assign({},this._layoutInfo[v]),{size:T,x:isHorizontal$1(this._orient)?b+A:(this._size.width-T)/2,y:isHorizontal$1(this._orient)?(this._size.height-T)/2:b+A}),b+A+T},y+g)}render(){this._initLayoutInfo(),this.renderSlider(),this.renderController()}renderSlider(){const e=this._updateSliderAttrs();this._slider.setAttributes(e)}renderController(){const e=this._updateControllerAttrs();this._controller.setAttributes(e)}dispatchCustomEvent(e,i){this._dispatchEvent(e,{eventType:e,index:i,value:this._data[i]})}}BasePlayer.defaultAttributes={visible:!0,data:[],interval:1e3,orient:"bottom",align:"center",size:{height:20,width:300},slider:{visible:!0,space:10,dx:0,dy:0,railStyle:{cornerRadius:5},trackStyle:{},handlerStyle:{}},controller:{visible:!0,start:Object.assign(Object.assign({},defaultControllerAttributes),{key:"start",position:"start",space:0}),pause:Object.assign(Object.assign({},defaultControllerAttributes),{key:"pause",position:"start"}),forward:Object.assign(Object.assign({},defaultControllerAttributes),{key:"forward",position:"end"}),backward:Object.assign(Object.assign({},defaultControllerAttributes),{key:"backward",position:"start"})}};function loadBasePlayer(){loadSliderComponent(),registerGroup(),registerSymbol()}function loadDiscretePlayerComponent(){loadBasePlayer()}function loadContinuousPlayerComponent(){loadBasePlayer()}loadDiscretePlayerComponent();class DiscretePlayer extends BasePlayer{constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},e)),this._activeIndex=-1,this._isReachEnd=!1,this._initAttributes=()=>{var n,o,l;super._initAttributes(),this._alternate=(n=this.attribute.alternate)!==null&&n!==void 0&&n,this._interval=(o=this.attribute.interval)!==null&&o!==void 0?o:1e3,this._direction=(l=this.attribute.direction)!==null&&l!==void 0?l:DirectionEnum.Default},this._initDataIndex=()=>{var n;this._dataIndex=isNil(this.attribute.dataIndex)?this._direction==="default"?this._minIndex:this._maxIndex:(n=this.attribute.dataIndex)!==null&&n!==void 0?n:0,this._slider.setAttribute("value",this._dataIndex)},this._initEvents=()=>{this.attribute.disableTriggerEvent||(this._controller.addEventListener(ControllerEventEnum.OnPlay,n=>{n.stopPropagation(),this.play()}),this._controller.addEventListener(ControllerEventEnum.OnPause,n=>{n.stopPropagation(),this.pause()}),this._controller.addEventListener(ControllerEventEnum.OnForward,n=>{n.stopPropagation(),this.forward()}),this._controller.addEventListener(ControllerEventEnum.OnBackward,n=>{n.stopPropagation(),this.backward()}),this._slider.addEventListener("change",n=>{const o=Math.floor(n.detail.value)+.5;this._dataIndex=n.detail.value>=o?Math.ceil(n.detail.value):Math.floor(n.detail.value),this._slider.setValue(this._dataIndex),this.dispatchCustomEvent(PlayerEventEnum.change)}))},this.play=()=>{this._isPlaying||this._data.length!==1&&(this._controller.togglePause(),this._isPlaying=!0,(isReachEnd({dataIndex:this._dataIndex,maxIndex:this._maxIndex,minIndex:this._minIndex,direction:this._direction})||isReachStart({dataIndex:this._dataIndex,maxIndex:this._maxIndex,minIndex:this._minIndex,direction:this._direction}))&&(this._direction===DirectionEnum.Default?this._updateDataIndex(this._minIndex):this._updateDataIndex(this._maxIndex)),this.dispatchCustomEvent(PlayerEventEnum.play),this._isReachEnd=!1,this._tickTime=Date.now(),this._rafId=vglobal.getRequestAnimationFrame()(this._play.bind(this,!0)))},this._play=n=>{const o=Date.now();if(this._isReachEnd&&o-this._tickTime>=this._interval)return this._isReachEnd=!1,void this._playEnd();n&&this._activeIndex!==this._dataIndex?(this.dispatchCustomEvent(PlayerEventEnum.change),this._activeIndex=this._dataIndex):o-this._tickTime>=this._interval&&(this._tickTime=o,this._updateDataIndex(forwardStep(this._direction,this._dataIndex,this._minIndex,this._maxIndex)),this._activeIndex=this._dataIndex,this.dispatchCustomEvent(PlayerEventEnum.change)),(this._direction==="default"&&this._dataIndex>=this._maxIndex||this._direction==="reverse"&&this._dataIndex<=this._minIndex)&&(this._isReachEnd=!0),this._rafId=vglobal.getRequestAnimationFrame()(this._play.bind(this,!1))},this._updateDataIndex=n=>{this._dataIndex=n,this._slider.setValue(this._dataIndex)},this._playEnd=()=>{this._isPlaying=!1,this._controller.togglePlay(),vglobal.getCancelAnimationFrame()(this._rafId),this._activeIndex=-1,this.dispatchCustomEvent(PlayerEventEnum.end)},this.pause=()=>{this._isPlaying&&(this._isPlaying=!1,vglobal.getCancelAnimationFrame()(this._rafId),this._controller.togglePlay(),this.dispatchCustomEvent(PlayerEventEnum.pause))},this.backward=()=>{const{loop:n=!1}=this.attribute;let o;o=n?this._dataIndex-1<this._minIndex?this._maxIndex:this._dataIndex-1:Math.max(this._dataIndex-1,this._minIndex),this._updateDataIndex(o),this.dispatchCustomEvent(PlayerEventEnum.change),this.dispatchCustomEvent(PlayerEventEnum.backward)},this.forward=()=>{const{loop:n=!1}=this.attribute;let o;o=n?this._dataIndex+1>this._maxIndex?this._minIndex:this._dataIndex+1:Math.min(this._dataIndex+1,this._maxIndex),this._updateDataIndex(o),this.dispatchCustomEvent(PlayerEventEnum.change),this.dispatchCustomEvent(PlayerEventEnum.forward)},this._initAttributes(),this._initDataIndex(),this._initEvents()}setAttributes(e,i){super.setAttributes(e,i),this._initAttributes()}dispatchCustomEvent(e){super.dispatchCustomEvent(e,this._dataIndex)}}var __awaiter$2=function(r,e,i,n){return new(i||(i=Promise))(function(o,l){function d(g){try{f(n.next(g))}catch(_){l(_)}}function u(g){try{f(n.throw(g))}catch(_){l(_)}}function f(g){var _;g.done?o(g.value):(_=g.value,_ instanceof i?_:new i(function(y){y(_)})).then(d,u)}f((n=n.apply(r,e||[])).next())})};loadContinuousPlayerComponent();class ContinuousPlayer extends BasePlayer{constructor(e){super(e),this._isPlaying=!1,this._startTime=Date.now(),this._initAttributes=()=>{var i;super._initAttributes(),this._maxIndex=this._data.length,this._slider.setAttribute("max",this._maxIndex),this._isPlaying=!1,this._elapsed=0,this._interval=(i=this.attribute.interval)!==null&&i!==void 0?i:1e3;const n=this._data.length;this.attribute.totalDuration&&this._data.length?(this._totalDuration=this.attribute.totalDuration,this._interval=this._totalDuration/(n??1)):(this._totalDuration=this._interval*n,this._interval=this.attribute.interval)},this._initDataIndex=()=>{var i;this._dataIndex=(i=this.attribute.dataIndex)!==null&&i!==void 0?i:this._minIndex},this._initEvents=()=>{this.attribute.disableTriggerEvent||(this._controller.addEventListener(ControllerEventEnum.OnPlay,i=>{i.stopPropagation(),this.play()}),this._controller.addEventListener(ControllerEventEnum.OnPause,i=>{i.stopPropagation(),this.pause()}),this._controller.addEventListener(ControllerEventEnum.OnForward,i=>{i.stopPropagation(),this.forward()}),this._controller.addEventListener(ControllerEventEnum.OnBackward,i=>{i.stopPropagation(),this.backward()}),this._slider.addEventListener("change",i=>{var n;i.stopPropagation();const o=(n=i.detail)===null||n===void 0?void 0:n.value,l=o/this._maxIndex;this._elapsed=l*this._totalDuration,this._startTime=Date.now()-this._elapsed,this._dispatchChange(o)}))},this._getSliderValue=()=>{const i=this._elapsed/this._totalDuration;return Math.min(i*this._maxIndex,this._maxIndex)},this._updateSlider=()=>{const i=this._getSliderValue();this._dataIndex=Math.floor(i),this._slider.setValue(Math.min(i,this._maxIndex)),this._dispatchChange(Math.floor(i))},this._dispatchChange=i=>{const n=Math.floor(i);n!==this._activeIndex&&(this._dataIndex=n,this._activeIndex=n,n!==this._maxIndex&&this.dispatchCustomEvent(PlayerEventEnum.change))},this.play=()=>__awaiter$2(this,void 0,void 0,function*(){this._isPlaying||(this._controller.togglePause(),this._isPlaying=!0,this._elapsed>=this._totalDuration&&(this._elapsed=0),this._startTime=Date.now()-this._elapsed,this.dispatchCustomEvent(PlayerEventEnum.play),this._rafId=vglobal.getRequestAnimationFrame()(this._play.bind(this)))}),this._play=()=>{this._elapsed=Date.now()-this._startTime;const i=this._getSliderValue();this._updateSlider(),i>=this._maxIndex?this._playEnd():this._rafId=vglobal.getRequestAnimationFrame()(this._play.bind(this))},this._playEnd=()=>{this._isPlaying=!1,vglobal.getCancelAnimationFrame()(this._rafId),this._controller.togglePlay(),this.dispatchCustomEvent(PlayerEventEnum.end)},this.pause=()=>{this._isPlaying&&(this._isPlaying=!1,this._elapsed=Date.now()-this._startTime,vglobal.getCancelAnimationFrame()(this._rafId),this._controller.togglePlay(),this.dispatchCustomEvent(PlayerEventEnum.pause))},this.backward=()=>{const i=Date.now(),n=1*this._interval,o=this._elapsed-n;o<=0?(this._elapsed=0,this._startTime=i):(this._elapsed=o,this._startTime=this._startTime+this._interval),this._updateSlider(),this.dispatchCustomEvent(PlayerEventEnum.backward)},this.forward=()=>{const i=Date.now(),n=1*this._interval,o=this._elapsed+n;o>=this._totalDuration?(this._startTime=i-this._totalDuration,this._elapsed=this._totalDuration):(this._startTime=this._startTime-n,this._elapsed=o),this._updateSlider(),this.dispatchCustomEvent(PlayerEventEnum.forward)},this._initAttributes(),this._initDataIndex(),this._initEvents()}dispatchCustomEvent(e){super.dispatchCustomEvent(e,this._dataIndex)}render(){super.render()}}var IOperateType;(function(r){r.drawStart="drawStart",r.drawEnd="drawEnd",r.drawing="drawing",r.moving="moving",r.moveStart="moveStart",r.moveEnd="moveEnd",r.brushClear="brushClear"})(IOperateType||(IOperateType={}));const DEFAULT_BRUSH_ATTRIBUTES={trigger:"pointerdown",updateTrigger:"pointermove",endTrigger:"pointerup",resetTrigger:"pointerupoutside",hasMask:!0,brushMode:"single",brushType:"rect",brushStyle:{fill:"#B0C8F9",fillOpacity:.2,stroke:"#B0C8F9",strokeWidth:2},brushMoved:!0,removeOnClick:!0,delayType:"throttle",delayTime:10,interactiveRange:{y1:-1/0,y2:1/0,x1:-1/0,x2:1/0}},DEFAULT_SIZE_THRESHOLD=5;function loadBrushComponent(){registerGroup(),registerPolygon()}const delayMap$1={debounce,throttle};loadBrushComponent();let Brush$1=class ze extends AbstractComponent{constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},ze.defaultAttributes,e)),this.name="brush",this._activeDrawState=!1,this._cacheDrawPoints=[],this._isDrawedBeforeEnd=!1,this._activeMoveState=!1,this._operatingMaskMoveDx=0,this._operatingMaskMoveDy=0,this._operatingMaskMoveRangeX=[-1/0,1/0],this._operatingMaskMoveRangeY=[-1/0,1/0],this._brushMaskAABBBoundsDict={},this._onBrushStart=n=>{var o;if(this._outOfInteractiveRange(n))return;n.stopPropagation();const l=(o=this.attribute.brushMoved)===null||o===void 0||o;this._activeMoveState=l&&this._isPosInBrushMask(n),this._activeDrawState=!this._activeMoveState,this._activeDrawState&&this._initDraw(n),this._activeMoveState&&this._initMove(n)},this._onBrushing=n=>{this._outOfInteractiveRange(n)||((this._activeDrawState||this._activeMoveState)&&n.stopPropagation(),this._activeDrawState&&this._drawing(n),this._activeMoveState&&this._moving(n))},this._onBrushingWithDelay=this.attribute.delayTime===0?this._onBrushing:delayMap$1[this.attribute.delayType](this._onBrushing,this.attribute.delayTime),this._onBrushEnd=n=>{var o;if(!this._activeDrawState&&!this._activeMoveState)return;n.preventDefault();const{removeOnClick:l=!0}=this.attribute;this._activeDrawState&&!this._isDrawedBeforeEnd&&l?(!((o=this._operatingMask)===null||o===void 0)&&o._AABBBounds.empty()&&this._dispatchEvent(IOperateType.brushClear,{operateMask:this._operatingMask,operatedMaskAABBBounds:this._brushMaskAABBBoundsDict,event:n}),this._container.incrementalClearChild(),this._brushMaskAABBBoundsDict={}):(this._activeDrawState&&this._dispatchEvent(IOperateType.drawEnd,{operateMask:this._operatingMask,operatedMaskAABBBounds:this._brushMaskAABBBoundsDict,event:n}),this._activeMoveState&&this._dispatchEvent(IOperateType.moveEnd,{operateMask:this._operatingMask,operatedMaskAABBBounds:this._brushMaskAABBBoundsDict,event:n})),this._activeDrawState=!1,this._activeMoveState=!1,this._isDrawedBeforeEnd=!1,this._operatingMask&&this._operatingMask.setAttribute("pickable",!1)}}_bindBrushEvents(){if(this.attribute.disableTriggerEvent)return;const{trigger:e=DEFAULT_BRUSH_ATTRIBUTES.trigger,updateTrigger:i=DEFAULT_BRUSH_ATTRIBUTES.updateTrigger,endTrigger:n=DEFAULT_BRUSH_ATTRIBUTES.endTrigger,resetTrigger:o=DEFAULT_BRUSH_ATTRIBUTES.resetTrigger}=this.attribute;this.stage.addEventListener(e,this._onBrushStart),this.stage.addEventListener(i,this._onBrushingWithDelay),this.stage.addEventListener(n,this._onBrushEnd),this.stage.addEventListener(o,this._onBrushEnd)}_isPosInBrushMask(e){const i=this.eventPosToStagePos(e),n=this._container.getChildren();for(let o=0;o<n.length;o++){const{points:l=[],dx:d=0,dy:u=0}=n[o].attribute,f=l.map(g=>({x:g.x+d,y:g.y+u}));if(polygonContainPoint(f,i.x,i.y))return this._operatingMask=n[o],!0}return!1}_initDraw(e){const{brushMode:i}=this.attribute,n=this.eventPosToStagePos(e);this._cacheDrawPoints=[n],this._isDrawedBeforeEnd=!1,i==="single"&&(this._brushMaskAABBBoundsDict={},this._container.incrementalClearChild()),this._addBrushMask(),this._dispatchEvent(IOperateType.drawStart,{operateMask:this._operatingMask,operatedMaskAABBBounds:this._brushMaskAABBBoundsDict,event:e})}_initMove(e){var i,n;this._cacheMovePoint=this.eventPosToStagePos(e),this._operatingMaskMoveDx=(i=this._operatingMask.attribute.dx)!==null&&i!==void 0?i:0,this._operatingMaskMoveDy=(n=this._operatingMask.attribute.dy)!==null&&n!==void 0?n:0;const{interactiveRange:o}=this.attribute,{minY:l=-1/0,maxY:d=1/0,minX:u=-1/0,maxX:f=1/0}=o,{x1:g,x2:_,y1:y,y2:b}=this._operatingMask.globalAABBBounds,S=u-g,v=f-_,A=l-y,x=d-b;this._operatingMaskMoveRangeX=[S,v],this._operatingMaskMoveRangeY=[A,x],this._operatingMask.setAttribute("pickable",!0),this._dispatchEvent(IOperateType.moveStart,{operateMask:this._operatingMask,operatedMaskAABBBounds:this._brushMaskAABBBoundsDict,event:e})}_drawing(e){var i,n;const o=this.eventPosToStagePos(e),{sizeThreshold:l=DEFAULT_SIZE_THRESHOLD,brushType:d}=this.attribute,u=this._cacheDrawPoints.length;if(u>0){const S=(i=this._cacheDrawPoints[this._cacheDrawPoints.length-1])!==null&&i!==void 0?i:{};if(o.x===S.x&&o.y===S.y)return}d==="polygon"||u<=1?this._cacheDrawPoints.push(o):this._cacheDrawPoints[u-1]=o;const f=this._computeMaskPoints();this._operatingMask.setAttribute("points",f);const{x1:g=0,x2:_=0,y1:y=0,y2:b=0}=(n=this._operatingMask)===null||n===void 0?void 0:n._AABBBounds;this._isDrawedBeforeEnd=!this._operatingMask._AABBBounds.empty()&&(Math.abs(_-g)>l||Math.abs(y-b)>l),this._isDrawedBeforeEnd&&(this._brushMaskAABBBoundsDict[this._operatingMask.name]=this._operatingMask.AABBBounds,this._dispatchEvent(IOperateType.drawing,{operateMask:this._operatingMask,operatedMaskAABBBounds:this._brushMaskAABBBoundsDict,event:e}))}_moving(e){const i=this._cacheMovePoint,n=this.eventPosToStagePos(e);if(n.x===(i==null?void 0:i.x)&&n.y===(i==null?void 0:i.y))return;const o=n.x-i.x,l=n.y-i.y,d=Math.min(this._operatingMaskMoveRangeX[1],Math.max(this._operatingMaskMoveRangeX[0],o))+this._operatingMaskMoveDx,u=Math.min(this._operatingMaskMoveRangeY[1],Math.max(this._operatingMaskMoveRangeY[0],l))+this._operatingMaskMoveDy;this._operatingMask.setAttributes({dx:d,dy:u}),this._brushMaskAABBBoundsDict[this._operatingMask.name]=this._operatingMask.AABBBounds,this._dispatchEvent(IOperateType.moving,{operateMask:this._operatingMask,operatedMaskAABBBounds:this._brushMaskAABBBoundsDict,event:e})}_computeMaskPoints(){const{brushType:e,xRange:i=[0,0],yRange:n=[0,0]}=this.attribute;let o=[];const l=this._cacheDrawPoints[0],d=this._cacheDrawPoints[this._cacheDrawPoints.length-1];return o=e==="rect"?[l,{x:d.x,y:l.y},d,{x:l.x,y:d.y}]:e==="x"?[{x:l.x,y:n[0]},{x:d.x,y:n[0]},{x:d.x,y:n[1]},{x:l.x,y:n[1]}]:e==="y"?[{x:i[0],y:l.y},{x:i[0],y:d.y},{x:i[1],y:d.y},{x:i[1],y:l.y}]:cloneDeep(this._cacheDrawPoints),o}_addBrushMask(){var e;const{brushStyle:i,hasMask:n}=this.attribute,o=graphicCreator.polygon(Object.assign(Object.assign({points:cloneDeep(this._cacheDrawPoints),cursor:"move",pickable:!1},i),{opacity:n?(e=i.opacity)!==null&&e!==void 0?e:1:0}));o.name=`brush-${Date.now()}`,this._operatingMask=o,this._container.add(o),this._brushMaskAABBBoundsDict[o.name]=o.AABBBounds}_outOfInteractiveRange(e){const{interactiveRange:i}=this.attribute,{minY:n=-1/0,maxY:o=1/0,minX:l=-1/0,maxX:d=1/0}=i,u=this.eventPosToStagePos(e);return u.x>d||u.x<l||u.y>o||u.y<n}eventPosToStagePos(e){return this.stage.eventPointTransform(e)}render(){this._bindBrushEvents();const e=this.createOrUpdateChild("brush-container",{},"group");this._container=e}releaseBrushEvents(){const{delayType:e="throttle",delayTime:i=0,trigger:n=DEFAULT_BRUSH_ATTRIBUTES.trigger,updateTrigger:o=DEFAULT_BRUSH_ATTRIBUTES.updateTrigger,endTrigger:l=DEFAULT_BRUSH_ATTRIBUTES.endTrigger,resetTrigger:d=DEFAULT_BRUSH_ATTRIBUTES.resetTrigger}=this.attribute;this.stage.removeEventListener(n,this._onBrushStart),this.stage.removeEventListener(o,this._onBrushingWithDelay),this.stage.removeEventListener(l,this._onBrushEnd),this.stage.removeEventListener(d,this._onBrushEnd)}};Brush$1.defaultAttributes=DEFAULT_BRUSH_ATTRIBUTES;const mergeRowAttrs=(r,...e)=>{const i=[r.shape,...e.map(l=>l==null?void 0:l.shape)],n=[r.key,...e.map(l=>l==null?void 0:l.key)],o=[r.value,...e.map(l=>l==null?void 0:l.value)];return merge$1(r,...e,{shape:i.every(isNil)?void 0:merge$1({},...i),key:n.every(isNil)?void 0:merge$1({},...n),value:o.every(isNil)?void 0:merge$1({},...o)})},getRichTextAttribute=r=>{const{width:e,height:i,wordBreak:n="break-word",textAlign:o,textBaseline:l,text:d}=r;return Array.isArray(d)?{width:e,height:i,wordBreak:n,textAlign:o,textBaseline:l,singleLine:!1,textConfig:array(d).map(u=>Object.assign(Object.assign({},r),{text:u}))}:{width:e,height:i,wordBreak:n,textAlign:o,textBaseline:l,singleLine:!1,textConfig:d==null?void 0:d.text}},defaultAttributes={panel:{visible:!0,cornerRadius:[3,3,3,3],fill:"white",shadow:!0,shadowBlur:12,shadowColor:"rgba(0, 0, 0, 0.1)",shadowOffsetX:0,shadowOffsetY:4,shadowSpread:0,stroke:"white"},titleStyle:{value:{fill:"#4E5969",fontFamily:DEFAULT_TEXT_FONT_FAMILY,fontSize:14,lineHeight:18,textAlign:"left",textBaseline:"middle"},spaceRow:6},contentStyle:{shape:{fill:"black",size:8,symbolType:"circle",spacing:6},key:{fill:"#4E5969",fontFamily:DEFAULT_TEXT_FONT_FAMILY,fontSize:12,lineHeight:18,textAlign:"left",textBaseline:"middle",spacing:26},value:{fill:"#4E5969",fontFamily:DEFAULT_TEXT_FONT_FAMILY,fontSize:12,lineHeight:18,textAlign:"right",textBaseline:"middle",spacing:0},spaceRow:6},padding:10,positionX:"right",positionY:"bottom",offsetX:10,offsetY:10,parentBounds:new AABBBounds().setValue(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),autoCalculatePosition:!0,autoMeasure:!0,pickable:!1,childrenPickable:!1,zIndex:500},TOOLTIP_POSITION_ATTRIBUTES=["pointerX","pointerY","offsetX","offsetY","positionX","positionY","parentBounds"];function loadTooltipComponent(){registerGroup(),registerRect(),registerSymbol(),registerText(),registerRichtext()}loadTooltipComponent();let Tooltip$1=class Ee extends AbstractComponent{constructor(e,i){super(i!=null&&i.skipDefault?e:merge$1({},Ee.defaultAttributes,e),i),this.name="tooltip"}render(){var e;const{visible:i,content:n,panel:o,keyWidth:l,valueWidth:d,hasContentShape:u,autoCalculatePosition:f,autoMeasure:g,align:_}=this.attribute;if(!i)return void this.hideAll();g&&Ee.measureTooltip(this.attribute),f&&Ee.calculateTooltipPosition(this.attribute);const y=normalizePadding$1(this.attribute.padding);this._tooltipPanel=this.createOrUpdateChild("tooltip-background",Object.assign({visible:!0},o),"rect"),this._tooltipTitleContainer=this.createOrUpdateChild("tooltip-title",{visible:!0,x:y[3],y:y[0]},"group");const b=Ee.getTitleAttr(this.attribute);this._tooltipTitleSymbol=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-shape",merge$1({symbolType:"circle"},b.shape,{visible:isVisible(b)&&isVisible(b.shape)}),"symbol"),typeof b.value.text!="object"||b.value.text===null||b.value.text.type!=="rich"&&b.value.text.type!=="html"?b.value.multiLine?this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({visible:isVisible(b)&&isVisible(b.value)},getRichTextAttribute(b.value)),"richtext"):this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({text:(e=b.value.text)!==null&&e!==void 0?e:"",visible:isVisible(b)&&isVisible(b.value)},b.value),"text"):b.value.text.type==="rich"?this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({visible:isVisible(b)&&isVisible(b.value)},getRichTextAttribute(b.value)),"richtext"):b.value.text.type==="html"&&(this._tooltipTitle=this._tooltipTitleContainer.createOrUpdateChild("tooltip-title-value",Object.assign({html:Object.assign(Object.assign({dom:b.value.text.text},DEFAULT_HTML_TEXT_SPEC),b.value),visible:isVisible(b)&&isVisible(b.value),width:b.value.width,height:b.value.height,wordBreak:b.value.wordBreak,textAlign:b.value.textAlign,textBaseline:b.value.textBaseline,singleLine:!1,textConfig:[]},b.value),"richtext"));const S=isVisible(b.shape)?b.shape.size+b.shape.spacing:0,{textAlign:v,textBaseline:A}=b.value,x=o.width-y[3]-y[0]-S;v==="center"?this._tooltipTitle.setAttribute("x",S+x/2):v==="right"||v==="end"?this._tooltipTitle.setAttribute("x",S+x):this._tooltipTitle.setAttribute("x",S),A==="bottom"?this._tooltipTitle.setAttribute("y",b.height):A==="middle"?this._tooltipTitle.setAttribute("y",b.height/2):this._tooltipTitle.setAttribute("y",0);const T=isVisible(b)?b.height+b.spaceRow:0;if(this._tooltipContent=this.createOrUpdateChild("tooltip-content",{visible:!0},"group"),this._tooltipContent.removeAllChild(!0),n&&n.length){this._tooltipContent.setAttribute("x",y[3]),this._tooltipContent.setAttribute("y",y[0]+T);let C=0;n.forEach((E,P)=>{const R=Ee.getContentAttr(this.attribute,P);if(!isVisible(R))return;const L=`tooltip-content-${P}`,w=this._tooltipContent.createOrUpdateChild(L,{visible:!0,x:0,y:C},"group"),B=R.shape.size+R.shape.spacing;let I=_==="right"?(u?B:0)+(isVisible(R.key)?l+R.key.spacing:0)+(isVisible(R.value)?d:0):0;this._createShape(_==="right"?I-R.shape.size/2:I+R.shape.size/2,R,w,L),u&&(_==="right"?I-=B:I+=B);const D=this._createKey(R,w,L);D&&(alignTextInLine(_,D,R.key.textAlign,I,l),D.setAttribute("y",0),_==="right"?I-=l+R.key.spacing:I+=l+R.key.spacing);const O=this._createValue(R,w,L);if(O){let N="right";isValid(R.value.textAlign)?N=R.value.textAlign:isVisible(R.key)||_==="right"||(N="left"),O.setAttribute("textAlign",N),alignTextInLine(_,O,N,I,d),O.setAttribute("y",0)}C+=R.height+R.spaceRow})}}_createShape(e,i,n,o){var l;if(isVisible(i.shape))return n.createOrUpdateChild(`${o}-shape`,Object.assign({visible:!0,x:e,y:i.shape.size/2+(((l=calculateLineHeight(i.key.lineHeight,i.key.fontSize))!==null&&l!==void 0?l:i.key.fontSize)-i.shape.size)/2},i.shape),"symbol")}_createKey(e,i,n){var o;if(isVisible(e.key)){let l;return l=e.key.multiLine?i.createOrUpdateChild(`${n}-key`,Object.assign(Object.assign({visible:!0},getRichTextAttribute(e.key)),{textBaseline:"top"}),"richtext"):typeof e.key.text!="object"||e.key.text===null||e.key.text.type!=="rich"&&e.key.text.type!=="html"?i.createOrUpdateChild(`${n}-key`,Object.assign(Object.assign({visible:!0,text:(o=e.key.text)!==null&&o!==void 0?o:""},e.key),{textBaseline:"top"}),"text"):e.key.text.type==="rich"?i.createOrUpdateChild(`${n}-value`,Object.assign(Object.assign({visible:!0},getRichTextAttribute(e.key)),{textBaseline:"top"}),"richtext"):i.createOrUpdateChild(`${n}-value`,{html:Object.assign(Object.assign({dom:e.key.text.text},DEFAULT_HTML_TEXT_SPEC),e.key)},"richtext"),l}}_createValue(e,i,n){var o;if(isVisible(e.value)){let l;return l=e.value.multiLine?i.createOrUpdateChild(`${n}-value`,Object.assign(Object.assign({visible:!0},getRichTextAttribute(e.value)),{textBaseline:"top"}),"richtext"):typeof e.value.text!="object"||e.value.text===null||e.value.text.type!=="rich"&&e.value.text.type!=="html"?i.createOrUpdateChild(`${n}-value`,Object.assign(Object.assign({visible:!0,text:(o=e.value.text)!==null&&o!==void 0?o:""},e.value),{textBaseline:"top"}),"text"):e.value.text.type==="rich"?i.createOrUpdateChild(`${n}-value`,Object.assign(Object.assign({visible:!0},getRichTextAttribute(e.value)),{textBaseline:"top"}),"richtext"):i.createOrUpdateChild(`${n}-value`,{html:Object.assign({dom:e.value.text.text,container:"",width:30,height:30,style:{}},e.value)},"richtext"),l}}setAttributes(e,i){const n=Object.keys(e);this.attribute.autoCalculatePosition&&n.every(o=>TOOLTIP_POSITION_ATTRIBUTES.includes(o))?(this._mergeAttributes(e,n),isNil(this.attribute.panel.width)&&this.attribute.autoMeasure&&Ee.measureTooltip(this.attribute),Ee.calculateTooltipPosition(this.attribute),super.setAttributes({x:this.attribute.x,y:this.attribute.y},i)):super.setAttributes(e,i)}static calculateTooltipPosition(e){const{width:i=0,height:n=0}=e.panel,{offsetX:o,offsetY:l,pointerX:d,pointerY:u,positionX:f,positionY:g,parentBounds:_}=e;let y=d,b=u;return f==="left"?y-=i+o:f==="center"?y-=i/2:y+=o,g==="top"?b-=n+l:g==="middle"?b-=n/2:b+=l,y+i>_.x2&&(y-=i+o),b+n>_.y2&&(b-=n+l),y<_.x1&&(y=_.x1),b<_.y1&&(b=_.y1),e.x=y,e.y=b,e}static measureTooltip(e){const{content:i,contentStyle:n}=e,o=normalizePadding$1(e.padding),l=Ee.getTitleAttr(e);let d=0,u=o[0]+o[2],f=0;const{value:g,shape:_}=l,{visible:y=!1,symbolType:b=""}=_??{};if(isValid(g)&&typeof l.value.text!="object"){const{width:S,height:v}=initTextMeasure$1(g).quickMeasure(g.text);d=S,f=v}if(y&&builtinSymbolsMap[b]&&(d+=_.size+_.spacing,f=Math.max(_.size,f)),e.title&&(e.title.width=d,e.title.height=f),isVisible(l)&&(u+=f+l.spaceRow),i&&i.length){const S=[];if(i.forEach((v,A)=>{const x=Ee.getContentAttr(e,A);(v.key||v.value)&&isVisible(x)&&S.push([v,x])}),S.length){let v=!1;const A=[],x=[],T=[];S.forEach(([R,L],w)=>{var B;const{key:I,value:D,shape:O,spaceRow:N}=L,V=isVisible(O),H=(B=O==null?void 0:O.symbolType)!==null&&B!==void 0?B:"",F=initTextMeasure$1(I),$=initTextMeasure$1(D);let G=0;if(isVisible(I)){const{width:Y,height:Q}=F.quickMeasure(I.text);x.push(Y),G=Math.max(G,Q)}if(isVisible(D)){const{width:Y,height:Q}=$.quickMeasure(D.text);T.push(Y),G=Math.max(G,Q)}V&&builtinSymbolsMap[H]&&(v=!0,A.push(O.size),G=Math.max(O.size,G)),R.height=G,u+=G,w<S.length-1&&(u+=N??n.spaceRow)});const C=A.length?Math.max(...A):0,E=x.length?Math.max(...x):0,P=T.length?Math.max(...T):0;d=Math.max(E+P+n.key.spacing+n.value.spacing+(v?C+n.shape.spacing:0),d),i.forEach(R=>{R.width=d}),e.hasContentShape=v,e.keyWidth=E,e.valueWidth=P}}return e.panel.width=d+o[1]+o[3],e.panel.height=u,e}static getTitleAttr(e){return mergeRowAttrs({},Ee.defaultAttributes.titleStyle,Ee.defaultAttributes.title,e.titleStyle,e.title)}static getContentAttr(e,i){return mergeRowAttrs({},Ee.defaultAttributes.contentStyle,e.contentStyle,e.content[i])}};Tooltip$1.defaultAttributes=defaultAttributes;const isClose=isNumberClose;function normalizeStartEndAngle(r,e){let i=0,n=2*Math.PI;const o=isValid(r),l=isValid(e);for(o||l?l?o?(i=r,n=e):(i=e-2*Math.PI,n=e):(i=r,n=r+2*Math.PI):(i=0,n=2*Math.PI);n<=i;)n+=2*Math.PI;for(;i>2*Math.PI;)i-=2*Math.PI,n-=2*Math.PI;for(;n<0;)i+=2*Math.PI,n+=2*Math.PI;return{startAngle:i,endAngle:n}}function outOfBounds(r,e,i){return r.x1>e||r.x2<e||r.y1>i||r.y2<i}function min(r,e){const i=[];return r.forEach(n=>{const o=+n[e];isValidNumber(o)&&i.push(o)}),i.length===0?null:minInArray(i)}function max(r,e){const i=[];return r.forEach(n=>{const o=+n[e];isValidNumber(o)&&i.push(o)}),i.length===0?null:maxInArray(i)}function sum$1(r,e){return r.reduce((i,n)=>{const o=e?+n[e]:+n;return isValidNumber(o)&&(i+=o),i},0)}function average$1(r,e){let i=0,n=0;return r.forEach(o=>{const l=e?+o[e]:+o;isValidNumber(l)&&(i+=l,n++)}),i/n}function variance(r,e){const i=average$1(r,e);return r.length<=1?0:r.reduce((o,l)=>o+(e?+l[e]:+l-i)**2,0)/(r.length-1)}function standardDeviation(r,e){return Math.sqrt(variance(r,e))}function median(r,e){return median$1(r.map(i=>i[e]))}function regression(r,e,i){const{predict:n}=regressionLinear(r,f=>f[e],f=>f[i]),o=min(r,e),l=max(r,e),d=n(o),u=n(l);return[{[e]:o,[i]:d},{[e]:l,[i]:u}]}function radiusLabelOrientAttribute(r){let e="center",i="middle";return e=(r=normalizeAngle(r))>=Math.PI*(7/6)&&r<=Math.PI*(11/6)?"right":r>=Math.PI*(1/6)&&r<=Math.PI*(5/6)?"left":"center",i=r>=Math.PI*(5/3)||r<=Math.PI*(1/3)?"bottom":r>=Math.PI*(2/3)&&r<=Math.PI*(4/3)?"top":"middle",{align:e,baseline:i}}function vectorAngle(r,e){const i=distance(r),n=distance(e),o=Math.asin((r.x*e.y-e.x*r.y)/i/n),l=Math.acos((r.x*e.x+r.y*e.y)/i/n);return o<0?-l:l}function distance(r,e={x:0,y:0}){return PointService.distancePP(r,e)}function getPercentValue(r,e=2){const i=r.reduce((g,_)=>g+(isNaN(_)?0:_),0);if(i===0)return 0;const n=Math.pow(10,e),o=r.map(g=>(isNaN(g)?0:g)/i*n*100),l=100*n,d=o.map(g=>Math.floor(g));let u=d.reduce((g,_)=>g+_,0);const f=o.map((g,_)=>g-d[_]);for(;u<l;){let g=Number.NEGATIVE_INFINITY,_=null;for(let y=0;y<f.length;y++)f[y]>g&&(g=f[y],_=y);++d[_],f[_]=0,++u}return d.map(g=>g/n)}function isValidPoint(r){return isValidNumber(r.x)&&isValidNumber(r.y)}function eachSeries(r,e,i){let n=!1;if(e&&isFunction(e)){for(const o of r)for(const l of o.getSeries(i))if(n=!!e.call(null,l),n)return n}return n}function getSeries(r,e){const i=[];for(const n of r)for(const o of n.getSeries(e))i.push(o);return i}const getFirstSeries=(r,e)=>{for(let i=0;i<r.length;i++){const n=r[i].getSeries();for(let o=0;o<n.length;o++){const l=n[o];if(e&&l&&l.coordinate===e||!e&&l)return l}}return null};function field$2(r){return function(e){let i;return i=isArray(r)?r.reduce((n,o)=>n==null?void 0:n[o],e):e==null?void 0:e[r],i}}var SeriesTypeEnum;(function(r){r.area="area",r.line="line",r.bar="bar",r.bar3d="bar3d",r.rangeColumn="rangeColumn",r.rangeColumn3d="rangeColumn3d",r.rangeArea="rangeArea",r.dot="dot",r.geo="geo",r.link="link",r.map="map",r.pie="pie",r.pie3d="pie3d",r.radar="radar",r.rose="rose",r.scatter="scatter",r.circularProgress="circularProgress",r.wordCloud="wordCloud",r.wordCloud3d="wordCloud3d",r.funnel="funnel",r.funnel3d="funnel3d",r.linearProgress="linearProgress",r.boxPlot="boxPlot",r.sankey="sankey",r.gaugePointer="gaugePointer",r.gauge="gauge",r.treemap="treemap",r.sunburst="sunburst",r.circlePacking="circlePacking",r.waterfall="waterfall",r.heatmap="heatmap",r.correlation="correlation",r.liquid="liquid",r.venn="venn",r.mosaic="mosaic",r.pictogram="pictogram"})(SeriesTypeEnum||(SeriesTypeEnum={}));var SeriesMarkNameEnum;(function(r){r.label="label",r.point="point",r.line="line",r.area="area",r.bar="bar",r.bar3d="bar3d",r.boxPlot="boxPlot",r.outlier="outlier",r.circlePacking="circlePacking",r.group="group",r.gridBackground="gridBackground",r.grid="grid",r.dot="dot",r.title="title",r.subTitle="subTitle",r.symbol="symbol",r.funnel="funnel",r.funnel3d="funnel3d",r.transform="transform",r.transform3d="transform3d",r.transformLabel="transformLabel",r.outerLabel="outerLabel",r.outerLabelLine="outerLabelLine",r.pin="pin",r.pinBackground="pinBackground",r.pointer="pointer",r.segment="segment",r.track="track",r.cell="cell",r.cellBackground="cellBackground",r.link="link",r.arrow="arrow",r.pie="pie",r.pie3d="pie3d",r.labelLine="labelLine",r.progress="progress",r.minLabel="minLabel",r.maxLabel="maxLabel",r.rose="rose",r.node="node",r.sunburst="sunburst",r.nonLeaf="nonLeaf",r.leaf="leaf",r.nonLeafLabel="nonLeafLabel",r.leaderLine="leaderLine",r.stackLabel="stackLabel",r.word="word",r.fillingWord="fillingWord",r.wordMask="wordMask",r.nodePoint="nodePoint",r.ripplePoint="ripplePoint",r.centerPoint="centerPoint",r.centerLabel="centerLabel",r.barBackground="barBackground",r.lineLabel="lineLabel",r.areaLabel="areaLabel",r.liquidGroup="liquidGroup",r.liquid="liquid",r.liquidBackground="liquidBackground",r.liquidOutline="liquidOutline",r.circle="circle",r.overlap="overlap",r.overlapLabel="overlapLabel",r.pictogram="pictogram"})(SeriesMarkNameEnum||(SeriesMarkNameEnum={}));function getDirectionFromSeriesSpec(r){var e,i;const{type:n}=r;return n===SeriesTypeEnum.sankey?(e=r.direction)!==null&&e!==void 0?e:"horizontal":(i=r.direction)!==null&&i!==void 0?i:"vertical"}const newTokenToLegacyToken={primaryFontColor:"titleFontColor",tertiaryFontColor:"labelFontColor",axisLabelFontColor:"axisFontColor",axisMarkerFontColor:"labelReverseFontColor",dataZoomHandleStrokeColor:"dataZoomHandlerStrokeColor",sliderHandleColor:"dataZoomHandlerFillColor",sliderRailColor:"dataZoomBackgroundColor",sliderTrackColor:"dataZoomSelectedColor",playerControllerColor:"dataZoomSelectedColor",popupBackgroundColor:"tooltipBackgroundColor",hoverBackgroundColor:"axisGridColor"},legacyTokenToNewToken={titleFontColor:"primaryFontColor",labelFontColor:"tertiaryFontColor",axisFontColor:"axisLabelFontColor",labelReverseFontColor:"axisMarkerFontColor",dataZoomHandlerStrokeColor:"dataZoomHandleStrokeColor",dataZoomHandlerFillColor:"sliderHandleColor",dataZoomBackgroundColor:"sliderRailColor",dataZoomSelectedColor:"sliderTrackColor",tooltipBackgroundColor:"popupBackgroundColor"};function getUpgradedTokenValue(r,e){const i=newTokenToLegacyToken[e];if(i&&r[i])return r[i];if(r[e])return r[e];const n=legacyTokenToNewToken[e];return n?r[n]:void 0}function getDataScheme(r,e){var i;if(!r)return[];const n=getColorSchemeBySeries(r,e);if(!n||isArray(n))return(i=n)!==null&&i!==void 0?i:[];if(isObject$1(n)){const{dataScheme:o}=n;return o?isProgressiveDataColorScheme(o)?o.map(l=>Object.assign(Object.assign({},l),{scheme:l.scheme.map(d=>isColorKey(d)?queryColorFromColorScheme(r,d,e):d).filter(isValid)})):o.map(l=>isColorKey(l)?queryColorFromColorScheme(r,l,e):l).filter(isValid):[]}return[]}function computeActualDataScheme(r,e){var i,n;return isProgressiveDataColorScheme(r)?(n=(i=r.find(o=>isValid(o.isAvailable)?isFunction(o.isAvailable)?o.isAvailable(e):!!o.isAvailable:!isValid(o.maxDomainLength)||(e==null?void 0:e.length)<=o.maxDomainLength))===null||i===void 0?void 0:i.scheme)!==null&&n!==void 0?n:r[r.length-1].scheme:r}function queryColorFromColorScheme(r,e,i){var n;const o=getColorSchemeBySeries(r,i);if(!o)return;let l;const{palette:d}=o;if(isObject$1(d)&&(l=(n=getUpgradedTokenValue(d,e.key))!==null&&n!==void 0?n:e.default),!l)return;if(isNil(e.a)&&isNil(e.l)||!isString(l))return l;let u=new Color(l);if(isValid(e.l)){const{r:f,g,b:_}=u.color,{h:y,s:b}=rgbToHsl(f,g,_),S=hslToRgb(y,b,e.l),v=new Color(`rgb(${S.r}, ${S.g}, ${S.b})`);v.setOpacity(u.color.opacity),u=v}return isValid(e.a)&&u.setOpacity(e.a),u.toRGBA()}const getActualColor=(r,e,i)=>{if(e&&isColorKey(r)){const n=queryColorFromColorScheme(e,r,i);if(n)return n}return r};function isColorKey(r){return r&&r.type==="palette"&&!!r.key}function isProgressiveDataColorScheme(r){return!(!isArray(r)||r.length===0)&&r.every(e=>isValid(e.scheme))}function transformColorSchemeToStandardStruct(r){return isArray(r)?{dataScheme:r}:r}function getColorSchemeBySeries(r,e){var i,n;const{type:o}=e??{};let l;if(!e||isNil(o))l=r==null?void 0:r.default;else{const d=getDirectionFromSeriesSpec(e);l=(n=(i=r==null?void 0:r[`${o}_${d}`])!==null&&i!==void 0?i:r==null?void 0:r[o])!==null&&n!==void 0?n:r==null?void 0:r.default}return l}class ColorOrdinalScale extends OrdinalScale{range(e){return e?(this._range=e,this._resetRange(),this):super.range()}domain(e){return e?(super.domain(e),this._resetRange(),this):super.domain()}_resetRange(){if(!isProgressiveDataColorScheme(this._range))return void super.range(this._range);const e=computeActualDataScheme(this._range,this._domain);super.range(e)}}const defaultScaleMap={linear:LinearScale,band:BandScale,point:PointScale,ordinal:OrdinalScale,threshold:ThresholdScale,colorOrdinal:ColorOrdinalScale};function createScale(r){const e=defaultScaleMap[r];return e?new e:null}function createScaleWithSpec(r,e){if("scale"in r&&r.scale)return isString(r.scale)&&(e!=null&&e.globalScale)?e.globalScale.registerMarkAttributeScale(r,e.seriesId):r.scale;const i=createScale(r.type);return i&&initScaleWithSpec(i,r),i}function initScaleWithSpec(r,e){r&&e&&(e.domain&&r.domain(e.domain),e.range&&r.range(e.range),e.specified&&r.specified&&r.specified(e.specified))}function valueInScaleRange(r,e,i){if(!e)return r;const n=e.range(),o=i&&e._calculateWholeRange?e._calculateWholeRange(n):e.range(),l=Math.min(o[0],o[o.length-1]),d=Math.max(o[0],o[o.length-1]);return Math.min(Math.max(l,r),d)}function isSpecValueWithScale(r){return isValid(r==null?void 0:r.field)&&isValid(r==null?void 0:r.scale)}function isValidOrient(r){switch(r){case"left":case"right":case"top":case"bottom":return!0;default:return!1}}function isPercent(r){return!!isString(r)&&!!r.endsWith("%")&&couldBeValidNumber(r.substring(0,r.length-1))}function isPercentOffset(r){return!!isObject$1(r)&&("percent"in r||"offset"in r)}function calcLayoutNumber(r,e,i,n=0){var o,l;return isNumber(r)?r:isPercent(r)?Number(r.substring(0,r.length-1))*e/100:isFunction(r)?r(i):isObject$1(r)?e*((o=r.percent)!==null&&o!==void 0?o:0)+((l=r.offset)!==null&&l!==void 0?l:0):n}function calcPadding(r,e,i){var n,o,l,d;const u={top:0,bottom:0,left:0,right:0};return Object.values(r).every(f=>isNumber(f))?(u.top=(n=r.top)!==null&&n!==void 0?n:0,u.right=(o=r.right)!==null&&o!==void 0?o:0,u.bottom=(l=r.bottom)!==null&&l!==void 0?l:0,u.left=(d=r.left)!==null&&d!==void 0?d:0,u):([{orients:["left","right"],size:e.width},{orients:["top","bottom"],size:e.height}].forEach(f=>{f.orients.forEach(g=>{u[g]=calcLayoutNumber(r[g],f.size,i)})}),u)}function boundsInRect(r,e){return r?{width:Math.ceil(Math.min(r.x2-r.x1,e.width)),height:Math.ceil(Math.min(r.y2-r.y1,e.height))}:{width:0,height:0}}function normalizeLayoutPaddingSpec(r){let e={};return isArray(r)?(isNil(r[0])||(e.top=e.left=e.bottom=e.right=r[0]),isNil(r[1])||(e.left=e.right=r[1]),isNil(r[2])||(e.bottom=r[2]),isNil(r[3])||(e.left=r[3]),e):isNumber(r)||isPercent(r)||isFunction(r)||isPercentOffset(r)?(e.top=e.left=e.bottom=e.right=r,e):(isObject$1(r)&&(e=Object.assign({},r)),e)}function convertPoint(r,e,i){return i?{x:r.x+e.x,y:r.y+e.y}:r}const getActualNumValue=(r,e)=>{const i=Number(r),n=r.toString();return isNaN(i)&&n[n.length-1]==="%"?e*(Number(n.slice(0,n.length-1))/100):i},dataScheme=[{maxDomainLength:10,scheme:["#1664FF","#1AC6FF","#FF8A00","#3CC780","#7442D4","#FFC400","#304D77","#B48DEB","#009488","#FF7DDA"]},{scheme:["#1664FF","#B2CFFF","#1AC6FF","#94EFFF","#FF8A00","#FFCE7A","#3CC780","#B9EDCD","#7442D4","#DDC5FA","#FFC400","#FAE878","#304D77","#8B959E","#B48DEB","#EFE3FF","#009488","#59BAA8","#FF7DDA","#FFCFEE"]}],colorScheme$1={default:{dataScheme,palette:{backgroundColor:"#ffffff",borderColor:"#e3e5e8",shadowColor:"rgba(33,37,44,0.1)",hoverBackgroundColor:"#f1f2f5",sliderRailColor:"#f1f3f4",sliderHandleColor:"#ffffff",sliderTrackColor:"#0040ff",popupBackgroundColor:"#ffffff",primaryFontColor:"#21252c",secondaryFontColor:"#606773",tertiaryFontColor:"#89909d",axisLabelFontColor:"#89909d",disableFontColor:"#bcc1cb",axisMarkerFontColor:"#ffffff",axisGridColor:"#f1f2f5",axisDomainColor:"#d9dde4",dataZoomHandleStrokeColor:"#aeb5be",dataZoomChartColor:"#c9ced8",playerControllerColor:"#0040ff",scrollBarSliderColor:"rgba(0,0,0,0.3)",axisMarkerBackgroundColor:"#21252c",markLabelBackgroundColor:"#f1f2f5",markLineStrokeColor:"#606773",dangerColor:"#e33232",warningColor:"#ffc528",successColor:"#07a35a",infoColor:"#3073f2",discreteLegendPagerTextColor:"rgb(51, 51, 51)",discreteLegendPagerHandlerColor:"rgb(47, 69, 84)",discreteLegendPagerHandlerDisableColor:"rgb(170, 170, 170)",emptyCircleColor:"#e3e5e8",linearProgressTrackColor:"#E7EBED"}}},area={label:{visible:!1,offset:5,position:"top",style:{stroke:{type:"palette",key:"backgroundColor"},lineWidth:2}},point:{style:{symbolType:"circle"}},seriesMark:"area"},bar={label:{visible:!1,position:"outside",offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}}},bar3d={bar3d:{style:{length:3}},label:{visible:!1,style:{offset:12,position:"outside"}}},circularProgress={outerRadius:.8,innerRadius:.6,progress:{style:{fillOpacity:1}},track:{style:{fillOpacity:.2}},tickMask:{visible:!1,angle:3,offsetAngle:0,forceAlign:!0}},dot={dot:{style:{size:10,fillOpacity:1}},symbol:{style:{size:10}},title:{style:{textAlign:"left",textBaseline:"middle",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}},subTitle:{style:{textAlign:"left",textBaseline:"top",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}},getFunnelTheme=r=>{const e={label:{style:{fill:"white",textBaseline:"middle",lineWidth:2}},outerLabel:{style:{fontSize:{type:"token",key:"l4FontSize"},fill:{type:"palette",key:"secondaryFontColor"}},line:{style:{stroke:{type:"palette",key:"axisDomainColor"}}}},transformLabel:{style:{fontSize:{type:"token",key:"l4FontSize"},fill:{type:"palette",key:"secondaryFontColor"},textBaseline:"middle"}}};return e[r?"transform3d":"transform"]={style:{fill:{type:"palette",key:"axisGridColor"}}},e},funnel$1=getFunnelTheme(),funnel3d=getFunnelTheme(!0),gauge={outerRadius:.8,innerRadius:.6,padAngle:1.146,segment:{style:{fillOpacity:1}},tickMask:{visible:!1,angle:3,offsetAngle:0,forceAlign:!0}},pointerPath="M-0.020059 -0.978425 C-0.018029 -0.9888053 -0.013378 -1 0 -1 C0.01342 -1 0.01812 -0.989146 0.0201 -0.978425 C0.02161 -0.9702819 0.0692 -0.459505 0.09486 -0.184807 C0.10298 -0.097849 0.1089 -0.034548 0.11047 -0.018339 C0.11698 0.04908 0.07373 0.11111 0.00002 0.11111 C-0.07369 0.11111 -0.117184 0.04991 -0.110423 -0.018339 C-0.103662 -0.086591 -0.022089 -0.9680447 -0.020059 -0.978425Z",circlePath="M1 0 C1 0.55228 0.55228 1 0 1 C-0.552285 1 -1 0.55228 -1 0 C-1 -0.552285 -0.552285 -1 0 -1 C0.55228 -1 1 -0.552285 1 0Z",gaugePointer={pointer:{type:"path",width:.4,height:.4,style:{path:pointerPath}},pin:{width:.025,height:.025,style:{path:circlePath,fill:"#888"}},pinBackground:{width:.06,height:.06,style:{path:circlePath,fill:"#ddd"}}},line={label:{visible:!1,position:"top",offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}},point:{style:{symbolType:"circle"}}},linearProgress={bandWidth:30,progress:{style:{fillOpacity:1}},track:{style:{fill:{type:"palette",key:"linearProgressTrackColor"},fillOpacity:1}}},link={arrow:{style:{size:10}}},map$1={defaultFillColor:"#f3f3f3",area:{style:{lineWidth:.5,strokeOpacity:1,stroke:"black",fillOpacity:1}},label:{interactive:!1,style:{fontSize:{type:"token",key:"l6FontSize"},lineHeight:{type:"token",key:"l6LineHeight"},textBaseline:"middle",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"},stroke:{type:"palette",key:"backgroundColor"}}}},pie$1={outerRadius:.6,pie:{style:{fillOpacity:1}},label:{visible:!1,interactive:!0,position:"outside",style:{fontWeight:"normal",stroke:{type:"palette",key:"backgroundColor"},fillOpacity:1}},innerLabel:{style:{lineWidth:2}},emptyCircle:{style:{fill:{type:"palette",key:"emptyCircleColor"},fillOpacity:1}}},pie3d={outerRadius:.6,pie3d:{style:{height:10,fillOpacity:1}},label:{visible:!1,interactive:!0,position:"outside"}},radar={label:{visible:!1,offset:5,style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}},point:{style:{symbolType:"circle"}}},scatter={point:{style:{size:8,symbolType:"circle",lineWidth:0,fillOpacity:.8}},label:{visible:!1,offset:5,position:"top",style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}}},waterfall$1={seriesFieldName:{total:"total",increase:"increase",decrease:"decrease"},leaderLine:{style:{stroke:"black",lineWidth:1,lineDash:[4,4]}},stackLabel:{visible:!0,offset:12,position:"withChange",style:{fill:"black",fontSize:{type:"token",key:"l4FontSize"}}},label:{visible:!1,offset:12,position:"inside",style:{lineWidth:2}}},wordCloud={word:{padding:1,style:{textAlign:"center",textBaseline:"alphabetic"}}},wordCloud3d={word:{padding:1,style:{textAlign:"center",textBaseline:"alphabetic"}}},treemap={gapWidth:1,nodePadding:[5],nonLeaf:{visible:!1,style:{fillOpacity:.5}},label:{style:{fill:"white",textBaseline:"middle",textAlign:"center",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}},nonLeafLabel:{padding:24,style:{fill:"black",stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},textBaseline:"middle",textAlign:"center"}}},PREFIX="__VCHART",DEFAULT_CHART_WIDTH=500,DEFAULT_CHART_HEIGHT=500,ARC_TRANSFORM_VALUE=`${PREFIX}_ARC_TRANSFORM_VALUE`,ARC_RATIO=`${PREFIX}_ARC_RATIO`,ARC_START_ANGLE=`${PREFIX}_ARC_START_ANGLE`,ARC_END_ANGLE=`${PREFIX}_ARC_END_ANGLE`,ARC_K=`${PREFIX}_ARC_K`,ARC_MIDDLE_ANGLE=`${PREFIX}_ARC_MIDDLE_ANGLE`,ARC_QUADRANT=`${PREFIX}_ARC_QUADRANT`,ARC_RADIAN=`${PREFIX}_ARC_RADIAN`,POLAR_START_RADIAN=-Math.PI/2,POLAR_END_RADIAN=3*Math.PI/2,POLAR_START_ANGLE=-90,POLAR_END_ANGLE=270,POLAR_DEFAULT_RADIUS=.6,sunburst={innerRadius:0,outerRadius:1,startAngle:POLAR_START_ANGLE,endAngle:POLAR_END_ANGLE,gap:0,labelLayout:{align:"center",offset:0,rotate:"radial"},sunburst:{style:{stroke:{type:"palette",key:"backgroundColor"},fillOpacity:1,cursor:"pointer"}},label:{visible:!0,style:{cursor:"pointer",fill:{type:"palette",key:"primaryFontColor"},fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}},rangeColumn={label:{visible:!1,offset:5,position:"inside",style:{lineWidth:2,fill:{type:"palette",key:"axisMarkerFontColor"}},minLabel:{position:"end"},maxLabel:{position:"start"}}},circlePacking={layoutPadding:5,circlePacking:{visible:!0,style:{cursor:"pointer",stroke:{type:"palette",key:"backgroundColor"}}},label:{visible:!0,style:{cursor:"pointer",fill:"black",stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}},heatmap={cell:{style:{shape:"square",fillOpacity:1}},cellBackground:{visible:!1}},sankey={link:{style:{fillOpacity:.15,round:!0}}},rose={rose:{style:{fillOpacity:1}},label:{style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"},textAlign:"center",textBaseline:"middle"}}},boxPlot={boxPlot:{style:{lineWidth:1}},label:{style:{lineWidth:2}}},correlation$1={centerLabel:{visible:!0,position:"center",style:{fill:"#fff",text:""}},label:{visible:!0,position:"bottom",style:{fill:"#000"}}},liquid={outlinePadding:10,liquidBackground:{style:{lineWidth:0,fillOpacity:.2}},liquidOutline:{style:{lineWidth:2}}},venn={circle:{style:{opacity:.8},state:{hover:{opacity:1}}},overlap:{style:{opacity:.8},state:{hover:{opacity:1,stroke:"white",lineWidth:2}}},label:{visible:!0,style:{fill:"white",textBaseline:"middle",textAlign:"center",fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"}}},overlapLabel:{visible:!0,style:{textBaseline:"middle",textAlign:"center",fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"}}}},mosaic={label:{visible:!1,position:"center",style:{lineWidth:2,stroke:{type:"palette",key:"backgroundColor"}}},bar:{style:{lineWidth:1,stroke:{type:"palette",key:"backgroundColor"}}}},series={scatter,line,area,bar,bar3d,pie:pie$1,pie3d,map:map$1,radar,dot,link,wordCloud,wordCloud3d,funnel:funnel$1,funnel3d,linearProgress,circularProgress,waterfall:waterfall$1,gauge,gaugePointer,treemap,sunburst,rangeColumn,circlePacking,heatmap,sankey,rose,boxPlot,correlation:correlation$1,liquid,venn,mosaic},markByType={text:{style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fillOpacity:1}}},markByName={label:{style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fillOpacity:1,lineJoin:"bevel"}},area:{style:{fillOpacity:.2}},line:{style:{lineWidth:2,lineCap:"round",lineJoin:"round"}},point:{style:{size:8,stroke:{type:"palette",key:"backgroundColor"},lineWidth:1,fillOpacity:1}},word:{style:{fontWeight:null,fontSize:null}},fillingWord:{style:{fontWeight:null,fontSize:null}},sunburst:{style:{lineWidth:1,stroke:{type:"palette",key:"backgroundColor"}}},circlePacking:{style:{lineWidth:1,stroke:{type:"palette",key:"backgroundColor"}}},funnel3d:{style:{stroke:!1}},barBackground:{visible:!1,style:{fill:{type:"palette",key:"primaryFontColor",a:.06},stroke:"transparent"}}},axisBand={domainLine:{visible:!0},grid:{visible:!1},subGrid:{visible:!1},tick:{visible:!0},subTick:{visible:!1}},axisX={label:{space:8},title:{space:8},maxHeight:"30%",unit:{visible:!1,style:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}}},axisY={label:{space:12,autoLimit:!0},title:{space:12,autoRotate:!0},maxWidth:"30%",unit:{visible:!1,style:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}}},axisZ=Object.assign(Object.assign({},axisX),{label:{space:0}}),commonAxis={domainLine:{visible:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},grid:{visible:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisGridColor"},strokeOpacity:1,lineDash:[]}},subGrid:{visible:!1,style:{lineWidth:1,stroke:{type:"palette",key:"axisGridColor"},strokeOpacity:1,lineDash:[4,4]}},tick:{visible:!0,inside:!1,tickSize:4,alignWithLabel:!0,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},subTick:{visible:!1,tickSize:2,style:{lineWidth:1,stroke:{type:"palette",key:"axisDomainColor"},strokeOpacity:1}},label:{visible:!0,inside:!1,space:10,style:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"axisLabelFontColor"},fontWeight:"normal",fillOpacity:1}},title:{space:10,padding:0,style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"secondaryFontColor"},fontWeight:"normal",fillOpacity:1}}},axisLinear={domainLine:{visible:!1},grid:{visible:!0},subGrid:{visible:!1},tick:{visible:!1},subTick:{visible:!1}},axisRadius={grid:{smooth:!0,visible:!0},subGrid:{smooth:!0,visible:!1}},axisAngle={grid:{visible:!0,style:{lineDash:[6,6]}},label:{space:5}},brush={style:{fill:"#B0C8F9",fillOpacity:.2,stroke:"#B0C8F9",lineWidth:2},brushMode:"single",brushType:"rect",brushMoved:!0,removeOnClick:!0,delayType:"throttle",delayTime:0},crosshair={trigger:"hover",bandField:{visible:!1,line:{type:"rect",visible:!0,style:{fill:{type:"palette",key:"axisGridColor"},opacity:.7,lineWidth:0,stroke:{type:"palette",key:"markLineStrokeColor"},lineDash:[2,3]}},label:{visible:!1,style:{fontWeight:"normal",fill:{type:"palette",key:"axisMarkerFontColor"},fontSize:{type:"token",key:"l5FontSize"}},labelBackground:{padding:{bottom:0,top:0,left:2,right:2},style:{fill:{type:"palette",key:"axisMarkerBackgroundColor"},cornerRadius:1}}}},linearField:{visible:!1,line:{type:"line",visible:!0,style:{stroke:{type:"palette",key:"markLineStrokeColor"},fill:"transparent",opacity:.7,lineDash:[2,3]}},label:{visible:!1,style:{fontWeight:"normal",fill:{type:"palette",key:"axisMarkerFontColor"},fontSize:{type:"token",key:"l5FontSize"}},labelBackground:{padding:{bottom:0,top:0,left:2,right:2},style:{fill:{type:"palette",key:"axisMarkerBackgroundColor"},cornerRadius:1}}}}},DataZoomHandlerSymbolType=`M-0.5-2.4h0.9c0.4,0,0.7,0.3,0.7,0.7v3.3c0,0.4-0.3,0.7-0.7,0.7h-0.9c-0.4,0-0.7-0.3-0.7-0.7v-3.3
C-1.2-2-0.9-2.4-0.5-2.4z M-0.4-1.4L-0.4-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6
C-0.4-1.4-0.4-1.4-0.4-1.4z M0.3-1.4L0.3-1.4c0,0,0,0.1,0,0.1v2.6c0,0.1,0,0.1,0,0.1l0,0c0,0,0-0.1,0-0.1v-2.6
C0.3-1.4,0.3-1.4,0.3-1.4z;`,getHandlerTheme=()=>({style:{symbolType:DataZoomHandlerSymbolType,fill:{type:"palette",key:"sliderHandleColor"},scaleX:1.2,scaleY:1.2,stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},lineWidth:1}}),getBackgroundChartTheme=r=>({area:{style:{visible:r,stroke:!1,fill:{type:"palette",key:"dataZoomChartColor"}}},line:{style:{visible:r,stroke:{type:"palette",key:"dataZoomChartColor"},lineWidth:1}}}),dataZoom={padding:[12,0],showDetail:"auto",brushSelect:!1,middleHandler:{visible:!1,background:{size:6,style:{stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},cornerRadius:2}},icon:{style:{size:4,fill:{type:"palette",key:"sliderHandleColor"},stroke:{type:"palette",key:"dataZoomHandleStrokeColor"},symbolType:"M 0.3 -0.5 C 0.41 -0.5 0.5 -0.41 0.5 -0.3 C 0.5 -0.3 0.5 0.3 0.5 0.3 C 0.5 0.41 0.41 0.5 0.3 0.5 C 0.3 0.5 -0.3 0.5 -0.3 0.5 C -0.41 0.5 -0.5 0.41 -0.5 0.3 C -0.5 0.3 -0.5 -0.3 -0.5 -0.3 C -0.5 -0.41 -0.41 -0.5 -0.3 -0.5 C -0.3 -0.5 0.3 -0.5 0.3 -0.5 Z",lineWidth:.5}}},background:{size:20,style:{fill:{type:"palette",key:"sliderRailColor"},lineWidth:0}},selectedBackground:{style:{fill:{type:"palette",key:"sliderTrackColor"},fillOpacity:.1,outerBorder:{stroke:{type:"palette",key:"sliderTrackColor"},strokeOpacity:.2,distance:-.5,lineWidth:1}}},selectedBackgroundChart:getBackgroundChartTheme(!1),startHandler:getHandlerTheme(),endHandler:getHandlerTheme(),startText:{padding:8,style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}}},endText:{padding:8,style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}}},backgroundChart:getBackgroundChartTheme(!0)},getTextStyle$1=(r,e)=>({fontSize:{type:"token",key:r},fill:{type:"palette",key:e},fontWeight:"normal",fillOpacity:1,textBaseline:"top",textAlign:"center"}),indicator={title:{visible:!0,autoLimit:!1,autoFit:!1,style:getTextStyle$1("l1FontSize","primaryFontColor")},content:{visible:!0,style:getTextStyle$1("l2FontSize","tertiaryFontColor")}},DEFAULT_CONTINUOUS_LEGEND_THEME={orient:"right",position:"middle",padding:[16,24],title:{visible:!1,padding:0,textStyle:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"primaryFontColor"}},space:12},handler:{visible:!0},startText:{style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6},endText:{style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6},handlerText:{style:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fontWeight:"normal",fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"}},space:6}},getColorLegendTheme=r=>{const e={width:200,height:8,style:{fill:{type:"palette",key:"sliderRailColor"}}};return r?(e.width=200,e.height=8):(e.width=8,e.height=200),Object.assign(Object.assign({},DEFAULT_CONTINUOUS_LEGEND_THEME),{rail:e,handler:{style:{symbolType:"circle",lineWidth:0,outerBorder:{lineWidth:2,distance:.8,stroke:"#ffffff"},shadowBlur:12,shadowOffsetX:0,shadowOffsetY:4,shadowColor:{type:"palette",key:"shadowColor"}}}})},colorLegend$1={horizontal:getColorLegendTheme(!0),vertical:getColorLegendTheme(!1)},discreteLegend$1={orient:"bottom",position:"middle",padding:[16,24],title:{visible:!1,padding:0,textStyle:{fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},fill:{type:"palette",key:"primaryFontColor"},fontWeight:"normal"},space:12},pager:{textStyle:{fill:{type:"palette",key:"discreteLegendPagerTextColor"}},handler:{style:{fill:{type:"palette",key:"discreteLegendPagerHandlerColor"}},state:{disable:{fill:{type:"palette",key:"discreteLegendPagerHandlerDisableColor"}}}}},item:{visible:!0,spaceCol:10,spaceRow:6,padding:2,background:{state:{selectedHover:{fill:{type:"palette",key:"hoverBackgroundColor"}},unSelectedHover:{fill:{type:"palette",key:"hoverBackgroundColor"}}}},shape:{space:6,style:{lineWidth:0,fillOpacity:1,opacity:1},state:{unSelected:{fillOpacity:.2,opacity:1}}},label:{space:6,style:{fill:{type:"palette",key:"secondaryFontColor",default:"#89909d"},fontSize:{type:"token",key:"l5FontSize"},lineHeight:{type:"token",key:"l5LineHeight"},opacity:1},state:{unSelected:{fill:{type:"palette",key:"disableFontColor"},opacity:1}}}},allowAllCanceled:!1},getSizeLegendTheme=r=>{const e={style:{fill:{type:"palette",key:"sliderRailColor"}}};return r?(e.width=200,e.height=4):(e.height=200,e.width=4),Object.assign(Object.assign({},DEFAULT_CONTINUOUS_LEGEND_THEME),{sizeBackground:{fill:{type:"palette",key:"dataZoomChartColor"}},track:{style:{fill:{type:"palette",key:"sliderTrackColor",a:.8}}},rail:e,handler:{style:{symbolType:"circle",lineWidth:0,outerBorder:{lineWidth:2,distance:.8,stroke:{type:"palette",key:"sliderTrackColor"}},fill:{type:"palette",key:"sliderHandleColor"}}}})},sizeLegend$1={horizontal:getSizeLegendTheme(!0),vertical:getSizeLegendTheme(!1)},mapLabel={visible:!0,offset:12,position:"top",space:10,nameLabel:{visible:!0,style:{textBaseline:"middle",textAlign:"left",fill:"black",fontSize:{type:"token",key:"l6FontSize"}}},valueLabel:{visible:!0,style:{textBaseline:"middle",textAlign:"left",fill:"black",fontSize:{type:"token",key:"l6FontSize"}}},background:{visible:!0,padding:{top:4,bottom:4,left:6,right:6},style:{cornerRadius:2,lineWidth:1,fill:"white",stroke:"grey"}},leader:{visible:!1,style:{lineWidth:1,stroke:"red"}}},getCommonLabelTheme=()=>({style:{fontSize:{type:"token",key:"l4FontSize"},fontWeight:"normal",fontStyle:"normal",fill:{type:"palette",key:"primaryFontColor"}},labelBackground:{padding:{top:2,bottom:2,right:4,left:4},style:{cornerRadius:3,fill:{type:"palette",key:"markLabelBackgroundColor"}}}}),markArea={area:{style:{fill:{type:"palette",key:"axisDomainColor",a:.25}}},label:getCommonLabelTheme()},getSymbolTheme=r=>({visible:r,symbolType:"triangle",size:10,style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}}),labelTheme=getCommonLabelTheme();labelTheme.refY=5;const markLine={line:{style:{lineDash:[3,3],stroke:{type:"palette",key:"markLineStrokeColor"}}},startSymbol:getSymbolTheme(!1),endSymbol:getSymbolTheme(!0),label:labelTheme},markPoint={itemLine:{decorativeLine:{visible:!1},startSymbol:{size:5,visible:!0,style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}},endSymbol:{style:{fill:{type:"palette",key:"markLineStrokeColor"},stroke:null,lineWidth:0}},line:{style:{stroke:{type:"palette",key:"markLineStrokeColor"}}}},itemContent:{offsetY:-50}},player={visible:!0,position:"start",padding:{top:20,bottom:20},slider:{space:10,trackStyle:{fill:{type:"palette",key:"sliderTrackColor"},fillOpacity:.8},railStyle:{fill:{type:"palette",key:"sliderRailColor"}},handlerStyle:{size:15,stroke:{type:"palette",key:"backgroundColor"},lineWidth:2,fill:{type:"palette",key:"playerControllerColor"}}},controller:{start:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},pause:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},backward:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}},forward:{order:0,space:10,position:"start",style:{size:12,fill:{type:"palette",key:"playerControllerColor"},fillOpacity:.8}}}},title$1={padding:{top:4,bottom:20},textStyle:{fontSize:{type:"token",key:"l3FontSize"},lineHeight:{type:"token",key:"l3LineHeight"},fill:{type:"palette",key:"primaryFontColor"}},subtextStyle:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fill:{type:"palette",key:"tertiaryFontColor"}}},tooltip$1={offset:{x:10,y:10},panel:{padding:{top:10,left:10,right:10,bottom:10},backgroundColor:{type:"palette",key:"popupBackgroundColor"},border:{color:{type:"palette",key:"popupBackgroundColor"},width:0,radius:3},shadow:{x:0,y:4,blur:12,spread:0,color:{type:"palette",key:"shadowColor"}}},spaceRow:6,titleLabel:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fontColor:{type:"palette",key:"primaryFontColor"},fontWeight:"bold",textBaseline:"middle",spacing:0},shape:{size:8,spacing:6},keyLabel:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fontColor:{type:"palette",key:"secondaryFontColor"},textBaseline:"middle",spacing:26},valueLabel:{fontSize:{type:"token",key:"l4FontSize"},lineHeight:{type:"token",key:"l4LineHeight"},fontColor:{type:"palette",key:"primaryFontColor"},fontWeight:"bold",textBaseline:"middle",spacing:0}},poptip={visible:!0,position:"auto",padding:8,titleStyle:{fontSize:{type:"token",key:"l5FontSize"},fontWeight:"bold",fill:{type:"palette",key:"primaryFontColor"}},contentStyle:{fontSize:{type:"token",key:"l5FontSize"},fill:{type:"palette",key:"primaryFontColor"}},panel:{visible:!0,fill:{type:"palette",key:"popupBackgroundColor"},cornerRadius:3,lineWidth:0,shadowBlur:12,shadowOffsetX:0,shadowOffsetY:4,shadowColor:{type:"palette",key:"shadowColor"},size:0,space:12}},totalLabel={visible:!1,offset:5,overlap:{clampForce:!0,strategy:[]},smartInvert:!1,animation:!1,style:{fontSize:{type:"token",key:"l4FontSize"},fill:{type:"palette",key:"primaryFontColor"}}},scrollBar={horizontal:{height:10,slider:{style:{fill:{type:"palette",key:"scrollBarSliderColor"}}}},vertical:{width:10,slider:{style:{fill:{type:"palette",key:"scrollBarSliderColor"}}}}},component={discreteLegend:discreteLegend$1,colorLegend:colorLegend$1,sizeLegend:sizeLegend$1,axis:commonAxis,axisBand,axisLinear,axisX,axisY,axisZ,axisAngle,axisRadius,markLine,markArea,markPoint,polarMarkLine:markLine,polarMarkArea:markArea,polarMarkPoint:markPoint,geoMarkPoint:markPoint,tooltip:tooltip$1,dataZoom,crosshair,player,brush,indicator,title:title$1,mapLabel,poptip,totalLabel,scrollBar};function queryToken(r,e){return r&&e.key in r?r[e.key]:e.default}function isTokenKey(r){return r&&r.type==="token"&&!!r.key}const token={fontFamily:"PingFang SC,Helvetica Neue,Microsoft Yahei,system-ui,-apple-system,segoe ui,Roboto,Helvetica,Arial,sans-serif,apple color emoji,segoe ui emoji,segoe ui symbol",fontSize:14,l1FontSize:32,l1LineHeight:"150%",l2FontSize:20,l2LineHeight:"140%",l3FontSize:16,l3LineHeight:"150%",l4FontSize:14,l4LineHeight:"150%",l5FontSize:12,l5LineHeight:"130%",l6FontSize:10,l6LineHeight:"120%"},lightTheme={name:"light",background:{type:"palette",key:"backgroundColor"},padding:20,fontFamily:{type:"token",key:"fontFamily"},colorScheme:colorScheme$1,token,mark:markByType,markByName,series,component,animationThreshold:2e3},colorScheme={default:{dataScheme,palette:{backgroundColor:"#202226",borderColor:"#404349",shadowColor:"rgba(0,0,0,0.1)",hoverBackgroundColor:"#404349",sliderRailColor:"#404349",sliderHandleColor:"#202226",sliderTrackColor:"#4284FF",popupBackgroundColor:"#404349",primaryFontColor:"#fdfdfd",secondaryFontColor:"#bbbdc3",tertiaryFontColor:"#888c93",axisLabelFontColor:"#888c93",disableFontColor:"#55595f",axisMarkerFontColor:"#202226",axisGridColor:"#404349",axisDomainColor:"#4b4f54",dataZoomHandleStrokeColor:"#bbbdc3",dataZoomChartColor:"#55595F",playerControllerColor:"#4284FF",scrollBarSliderColor:"rgba(255,255,255,0.3)",axisMarkerBackgroundColor:"#fdfdfd",markLabelBackgroundColor:"#404349",markLineStrokeColor:"#bbbdc3",dangerColor:"#eb4b4b",warningColor:"#f0bd30",successColor:"#14b267",infoColor:"#4284ff",discreteLegendPagerTextColor:"#BBBDC3",discreteLegendPagerHandlerColor:"#BBBDC3",discreteLegendPagerHandlerDisableColor:"#55595F",emptyCircleColor:"#bbbdc3",linearProgressTrackColor:"#404349"}}},darkTheme$1={name:"dark",colorScheme,component:{dataZoom:{selectedBackground:{style:{fillOpacity:.4,outerBorder:{strokeOpacity:.4}}}}}},setProperty=(r,e,i)=>{if(isNil(e))return r;const n=e[0];return isNil(n)?r:e.length===1?(r[n]=i,r):(isNil(r[n])&&(typeof e[1]=="number"?r[n]=[]:r[n]={}),setProperty(r[n],e.slice(1),i))},getProperty=(r,e,i)=>{if(!isNil(e))return get(r,e,i)};function mergeSpec(r,...e){let i=-1;const n=e.length;for(;++i<n;){const o=e[i];baseMerge(r,o,!0,!0)}return r}function mergeSpecWithFilter(r,e,i,n){Object.keys(r).forEach(o=>{if(isObject$1(e))e.type===o&&(isArray(r[o])?r[o].length>=e.index&&(r[o][e.index]=n?mergeSpec({},r[o][e.index],i):i):r[o]=n?mergeSpec({},r[o],i):i);else if(isArray(r[o])){const l=r[o].findIndex(d=>d.id===e);l>=0&&(r[o][l]=n?mergeSpec({},r[o][l],i):i)}else r.id===e&&(r[o]=n?mergeSpec({},r[o],i):i)})}let Factory$1=class be{static registerChart(e,i){be._charts[e]=i}static registerSeries(e,i){be._series[e]=i}static registerComponent(e,i,n){be._components[e]={cmp:i,alwaysCheck:n}}static registerMark(e,i){be._marks[e]=i}static registerRegion(e,i){be._regions[e]=i}static registerTransform(e,i){be.transforms[e]=i}static registerLayout(e,i){be._layout[e]=i}static registerAnimation(e,i){be._animations[e]=i}static registerImplement(e,i){be._implements[e]=i}static registerChartPlugin(e,i){be._chartPlugin[e]=i}static registerComponentPlugin(e,i){be._componentPlugin[e]=i}static createChart(e,i,n){return be._charts[e]?new be._charts[e](i,n):null}static createChartSpecTransformer(e,i){if(!be._charts[e])return null;const n=be._charts[e];return new n.transformerConstructor(Object.assign({seriesType:n.seriesType},i))}static createRegion(e,i,n){return be._regions[e]?new be._regions[e](i,n):null}static createRegionSpecTransformer(e,i){return be._regions[e]?new be._regions[e].transformerConstructor(i):null}static createSeries(e,i,n){return be._series[e]?new be._series[e](i,n):null}static createSeriesSpecTransformer(e,i){return be._series[e]?new be._series[e].transformerConstructor(i):null}static createMark(e,i,n){if(!be._marks[e])return null;const o=new be._marks[e](i,n);return o.type==="group"&&o.setMarkConfig({interactive:!1}),o}static getComponents(){return Object.values(be._components)}static getComponentInKey(e){return be._components[e].cmp}static getLayout(){return Object.values(be._layout)}static getLayoutInKey(e){return be._layout[e]}static getSeries(){return Object.values(be._series)}static getSeriesInType(e){return be._series[e]}static getRegionInType(e){return be._regions[e]}static getAnimationInKey(e){return be._animations[e]}static getImplementInKey(e){return be._implements[e]}static getSeriesMarkMap(e){return be._series[e]?be._series[e].mark:{}}static getChartPlugins(){return Object.values(be._chartPlugin)}static getComponentPlugins(){return Object.values(be._componentPlugin)}static getComponentPluginInType(e){return be._componentPlugin[e]}static registerFormatter(e){this._formatter=e}static getFormatter(){return this._formatter}};Factory$1._charts={},Factory$1._series={},Factory$1._components={},Factory$1._marks={},Factory$1._regions={},Factory$1._animations={},Factory$1._implements={},Factory$1._chartPlugin={},Factory$1._componentPlugin={},Factory$1.transforms={fields,filter,fold},Factory$1.dataParser={csv:csvParser,dsv:dsvParser,tsv:tsvParser},Factory$1._layout={};function mergeTheme(r,...e){return mergeSpec(transformThemeToMerge(r),...e.map(transformThemeToMerge))}function transformThemeToMerge(r){var e;if(!r)return r;const i=transformColorSchemeToMerge(r.colorScheme);return Object.assign({},r,{colorScheme:i,token:(e=r.token)!==null&&e!==void 0?e:{},series:Object.assign({},r.series)})}function transformColorSchemeToMerge(r){return r&&(r=Object.keys(r).reduce((e,i)=>{const n=r[i];return e[i]=transformColorSchemeToStandardStruct(n),e},{})),r}function transformSeriesThemeToMerge(r,e,i,n){const o=Factory$1.getSeriesMarkMap(e);if(!o)return r;const l={};return Object.values(o).forEach(({type:d,name:u})=>{l[u]=mergeSpec({},i==null?void 0:i[array(d)[0]],n==null?void 0:n[u],r==null?void 0:r[u])}),Object.assign(Object.assign({},r),l)}const IGNORE_KEYS=["animationThreshold","colorScheme","name","padding"];function preprocessTheme(r,e,i,n){if(!r)return r;e||(e=r.colorScheme),i||(i=r.token);const o={};return Object.keys(r).forEach(l=>{const d=r[l];IGNORE_KEYS.includes(l)?o[l]=d:isPlainObject(d)?isColorKey(d)?o[l]=getActualColor(d,e,n):isTokenKey(d)?o[l]=queryToken(i,d):o[l]=preprocessTheme(d,e,i,n):o[l]=d}),o}const builtinThemes={[lightTheme.name]:lightTheme},defaultThemeName=lightTheme.name,themes=new Map(Object.keys(builtinThemes).map(r=>[r,builtinThemes[r]])),transformedThemes=new Map(Object.keys(builtinThemes).map(r=>[r,preprocessTheme(builtinThemes[r])])),hasThemeMerged=new Map(Object.keys(builtinThemes).map(r=>[r,r===defaultThemeName])),registerTheme=(r,e)=>{if(!r)return;const i=getMergedTheme(e);themes.set(r,i),transformedThemes.set(r,preprocessTheme(i)),hasThemeMerged.set(r,!0)},getTheme=(r=defaultThemeName,e=!1)=>(hasThemeMerged.has(r)&&!hasThemeMerged.get(r)&&registerTheme(r,themes.get(r)),e?transformedThemes.get(r):themes.get(r)),removeTheme=r=>themes.delete(r)&&transformedThemes.delete(r)&&hasThemeMerged.delete(r),themeExist=r=>!!isString(r)&&themes.has(r),getMergedTheme=r=>{var e;const i=(e=r.type)!==null&&e!==void 0?e:defaultThemeName,n=getTheme(i);return mergeTheme({},n,r)};class InstanceManager{static registerInstance(e){InstanceManager.instances.set(e.id,e)}static unregisterInstance(e){InstanceManager.instances.delete(e.id)}static getInstance(e){return InstanceManager.instances.get(e)}static instanceExist(e){return InstanceManager.instances.has(e)}static forEach(e,i=[],n){const o=array(i);return InstanceManager.instances.forEach((l,d,u)=>{o.includes(d)||e(l,d,u)},n)}}InstanceManager.instances=new Map;let ThemeManager$1=class Re{static registerTheme(e,i){registerTheme(e,i)}static getTheme(e,i=!1){return getTheme(e,i)}static removeTheme(e){return removeTheme(e)}static themeExist(e){return themeExist(e)}static getDefaultTheme(){return Re.themes.get(defaultThemeName)}static setCurrentTheme(e){Re.themeExist(e)&&(Re._currentThemeName=e,InstanceManager.forEach(i=>i==null?void 0:i.setCurrentTheme(e)))}static getCurrentTheme(e=!1){return Re.getTheme(Re._currentThemeName,e)}static getCurrentThemeName(){return Re._currentThemeName}};ThemeManager$1.themes=themes,ThemeManager$1._currentThemeName=defaultThemeName;function getThemeObject(r,e){return isString(r)?ThemeManager$1.themeExist(r)?ThemeManager$1.getTheme(r,e):{}:isObject$1(r)?r:{}}function specTransform(r,e={data:i=>i}){if(!r)return r;if(r.constructor===Object){const i={};for(const n in r)if(Object.prototype.hasOwnProperty.call(r,n)){if(e[n]){i[n]=e[n](r[n]);continue}i[n]=specTransform(r[n],e)}return i}return isArray(r)?r.map(i=>specTransform(i,e)):r}function functionTransform(r,e){if(!r)return r;if(isPlainObject(r)){const i={};for(const n in r)if(Object.prototype.hasOwnProperty.call(r,n)){if(isString(r[n])&&e.getFunction(r[n])){i[n]=e.getFunction(r[n]);continue}i[n]=functionTransform(r[n],e)}return i}return isArray(r)?r.map(i=>functionTransform(i,e)):r}const initTextMeasure=(r,e,i)=>initTextMeasure$1(r,e,i,{fontFamily:token.fontFamily,fontSize:token.fontSize}),measureText=(r,e,i,n)=>initTextMeasure(e,i,n).measure(r),DEFAULT_DATA_INDEX=`${PREFIX}_DEFAULT_DATA_INDEX`,DEFAULT_DATA_KEY=`${PREFIX}_DEFAULT_DATA_KEY`,DEFAULT_DATA_SERIES_FIELD=`${PREFIX}_DEFAULT_DATA_SERIES_FIELD`,DEFAULT_SERIES_STYLE_NAME=`${PREFIX}_DEFAULT_SERIES_STYLE_NAME`,STACK_FIELD_KEY=`${PREFIX}_STACK_KEY`,STACK_FIELD_START=`${PREFIX}_STACK_START`,STACK_FIELD_END=`${PREFIX}_STACK_END`,STACK_FIELD_START_PERCENT=`${PREFIX}_STACK_START_PERCENT`,STACK_FIELD_END_PERCENT=`${PREFIX}_STACK_END_PERCENT`,STACK_FIELD_START_OffsetSilhouette=`${PREFIX}_STACK_START_OffsetSilhouette`,STACK_FIELD_END_OffsetSilhouette=`${PREFIX}_STACK_END_OffsetSilhouette`,STACK_FIELD_TOTAL=`${PREFIX}_STACK_TOTAL`,STACK_FIELD_TOTAL_PERCENT=`${PREFIX}_STACK_TOTAL_PERCENT`,STACK_FIELD_TOTAL_TOP=`${PREFIX}_STACK_TOTAL_TOP`,STACK_FIELD_TOTAL_BOTTOM=`${PREFIX}_STACK_TOTAL_BOTTOM`,SEGMENT_FIELD_START=`${PREFIX}_SEGMENT_START`,SEGMENT_FIELD_END=`${PREFIX}_SEGMENT_END`;function mergeFields(r,e){for(let i=0;i<e.length;i++){const n=e[i],o=findFields(r,n.key);o?o.operations=[...new Set(o.operations.concat(n.operations))]:r.push(n)}return r}function findFields(r,e){return r.find(i=>i.key===e)}function getFieldAlias(r,e){var i;if(!r)return e??null;const n=r.getFields();return n&&n[e]?(i=n[e].alias)!==null&&i!==void 0?i:e:e??null}function getRegionStackGroup(r,e,i){const n=r.getStackSort(),o={};let l=null;return n&&(l={},r.getSeries().forEach(d=>{const u=d.getSeriesField();if(u){const f=d.getRawDataStatisticsByField(u);f.values&&(l[u]||(l[u]={lastIndex:0,sort:{}}),f.values.forEach((g,_)=>{g in l[u].sort||(l[u].sort[g]=l[u].lastIndex,l[u].lastIndex++)}))}})),r.getSeries().forEach(d=>{var u;const f=d.getStackData(),g=d.getStackValue(),_=d.getStackValueField(),y=!i||i(d);f&&_&&y&&(o[g]=(u=o[g])!==null&&u!==void 0?u:{groupField:f.groupField,nodes:{}},stackGroup(d,f,o[g],_,e,l))}),n?sortStackValueGroup(o):o}function sortStackValueGroup(r,e){var i;for(const n in r)!((i=r[n].sortDatums)===null||i===void 0)&&i.length?(r[n].sortDatums.sort((o,l)=>o.index-l.index),r[n].values=r[n].sortDatums.map(o=>o.datum)):sortStackValueGroup(r[n].nodes);return r}function stackTotal(r,e){if("values"in r&&r.values.length){const i=sum$1(r.values,e),n=max(r.values,STACK_FIELD_END_PERCENT);r.values.forEach(o=>{o[STACK_FIELD_TOTAL]=i,o[STACK_FIELD_TOTAL_PERCENT]=n})}else for(const i in r.nodes)stackTotal(r.nodes[i],e)}function stackOffsetSilhouette(r){if(!r.values.length)return;const e=r.values[r.values.length-1][STACK_FIELD_END]/2;for(let i=0;i<r.values.length;i++)r.values[i][STACK_FIELD_START_OffsetSilhouette]=r.values[i][STACK_FIELD_START]-e,r.values[i][STACK_FIELD_END_OffsetSilhouette]=r.values[i][STACK_FIELD_END]-e}function stack(r,e,i,n,o={key:STACK_FIELD_KEY,start:STACK_FIELD_START,end:STACK_FIELD_END,startPercent:STACK_FIELD_START_PERCENT,endPercent:STACK_FIELD_END_PERCENT,max:STACK_FIELD_TOTAL_TOP,min:STACK_FIELD_TOTAL_BOTTOM}){const l=n&&isValid(o.min),d=n&&isValid(o.max);if(r.values.length>0){let u=0,f=0,g=1,_=0,y=null,b=null;const S=r.values.length;for(let v=0;v<S;v++){const A=r.values[e?S-1-v:v];_=A[o.end],_>=0?(A[o.start]=u,u+=A[o.end],A[o.end]=u):(A[o.start]=f,f+=A[o.end],A[o.end]=f),A[o.key]=r.key,d&&(delete A[o.max],(!b||A[o.end]>b[o.end])&&(b=A)),l&&(delete A[o.min],(!y||A[o.start]<y[o.start])&&(y=A))}if(d&&b&&(b[o.max]=!0),l&&y&&(y[o.min]=!0),i)for(let v=0;v<S;v++){const A=r.values[e?S-1-v:v];_=A[o.end];const x=_>=0?u:f;g=_>=0?1:-1,A[o.startPercent]=x===0?0:Math.min(1,A[o.start]/x)*g,A[o.endPercent]=x===0?0:Math.min(1,A[o.end]/x)*g}}for(const u in r.nodes)stack(r.nodes[u],e,i,n,o)}function stackGroup(r,e,i,n,o,l,d){var u;if("values"in e)if(o&&e.values.forEach(f=>f[STACK_FIELD_END]=toValidNumber(f[n])),i.series.push({s:r,values:e.values}),l){const f=r.getSeriesField();e.values.forEach(g=>{i.sortDatums.push({series:r,datum:g,index:f?l[f].sort[g[f]]:0})})}else i.values.push(...e.values);else for(const f in e.nodes){const g=d?`${d}_${f}`:f;i.nodes[f]||(i.nodes[f]={values:[],series:[],nodes:{},sortDatums:[],key:g},isValid((u=e.nodes[f])===null||u===void 0?void 0:u.groupField)&&(i.nodes[f].groupField=e.nodes[f].groupField)),stackGroup(r,e.nodes[f],i.nodes[f],n,o,l,g)}}const findHierarchyNode=(r,e,i="key",n="children")=>{for(let o=0;o<r.length;o++){const l=r[o];if(l[i]===e)return l;if(l[n]){const d=findHierarchyNode(l[n],e,i,n);if(d)return d}}return null},findHierarchyNodeParent=(r,e,i="key",n="children")=>{for(let o=0;o<r.length;o++){const l=r[o];if(l[n])for(let d=0;d<l[n].length;d++){const u=l[n][d];if(u[i]===e)return l;const f=findHierarchyNodeParent([u],e,i,n);if(f)return f}}return null},findHierarchyPath=(r,e,i="key",n="children")=>{const o=[],l=(d,u)=>{for(const f of d){if(f[i]===e)return o.push(...u,f[i].toString()),!0;if(f[n]){const g=l(f[n],[...u,f[i]]);if(g===!0)return g}}return!1};return l(r,[]),o};function isHierarchyItem(r,e="value",i="children"){return!!isObject$1(r)&&!!r.hasOwnProperty(i)&&Array.isArray(r[i])}function filterHierarchyDataByRange(r,e,i,n="value",o="children"){return Array.isArray(r)?r.map(l=>{const d=Object.assign({},l);return Array.isArray(d[o])&&(d[o]=filterHierarchyDataByRange(d[o],e,i,n,o)),d}).filter(l=>+l[n]>=e&&+l[n]<=i||l[o]&&l[o].length>0):r}function transformComponentStyle(r={}){const e=Object.assign({},r);if(isFunction(r.style)?e.style=(i,n,o,l)=>transformToGraphic(r.style(i,n,o,l)):isEmpty(r.style)||(e.style=transformToGraphic(r.style)),!isEmpty(r.state)){const i={};Object.keys(r.state).forEach(n=>{isFunction(r.state[n])?i[n]=(o,l,d,u)=>transformToGraphic(r.state[n](o,l,d,u)):isEmpty(r.state[n])||(i[n]=transformToGraphic(r.state[n]))}),e.state=i}return e}function transformStateStyle(r){if(isEmpty(r))return null;const e={};return Object.keys(r).forEach(i=>{isFunction(r[i])?e[i]=(n,o,l,d)=>transformToGraphic(r[i](n,o,l,d)):isEmpty(r[i])||(e[i]=transformToGraphic(r[i]))}),e}function transformAxisLabelStateStyle(r){if(isEmpty(r))return null;const e={};return Object.keys(r).forEach(i=>{isFunction(r[i])?e[i]=(n,o,l,d)=>transformToGraphic(r[i](n.rawValue,o,n,l,d)):isEmpty(r[i])||(e[i]=transformToGraphic(r[i]))}),e}function transformIndicatorStyle(r,e){if(isEmpty(r))return null;const i={};return Object.keys(r).forEach(n=>{isFunction(r[n])?i[n]=r[n](e):i[n]=r[n]}),transformToGraphic(i)}function transformToGraphic(r){return r!=null&&r.angle&&(r.angle=degreeToRadian(r.angle)),r}var BuiltInEncodeNames;(function(r){r.enter="enter",r.update="update",r.exit="exit",r.group="group",r.connectNulls="connectNulls"})(BuiltInEncodeNames||(BuiltInEncodeNames={}));var DiffState;(function(r){r.enter="enter",r.update="update",r.exit="exit",r.unChange="unChange"})(DiffState||(DiffState={}));var GrammarMarkType;(function(r){r.arc="arc",r.arc3d="arc3d",r.area="area",r.image="image",r.line="line",r.path="path",r.rect="rect",r.rect3d="rect3d",r.rule="rule",r.shape="shape",r.symbol="symbol",r.text="text",r.richtext="richtext",r.polygon="polygon",r.pyramid3d="pyramid3d",r.circle="circle",r.cell="cell",r.interval="interval",r.group="group",r.glyph="glyph",r.component="component",r.largeRects="largeRects",r.largeSymbols="largeSymbols"})(GrammarMarkType||(GrammarMarkType={}));var ComponentEnum;(function(r){r.axis="axis",r.grid="grid",r.legend="legend",r.slider="slider",r.label="label",r.datazoom="datazoom",r.player="player",r.title="title",r.scrollbar="scrollbar"})(ComponentEnum||(ComponentEnum={}));var DataFilterRank;(function(r){r[r.player=1]="player",r[r.rollUp=2]="rollUp",r[r.drillDown=3]="drillDown",r[r.slider=4]="slider",r[r.datazoom=5]="datazoom",r[r.legend=6]="legend",r[r.scrollbar=7]="scrollbar",r[r.brush=8]="brush",r[r.normal=9]="normal"})(DataFilterRank||(DataFilterRank={}));var AxisEnum;(function(r){r.lineAxis="lineAxis",r.circleAxis="circleAxis"})(AxisEnum||(AxisEnum={}));var GridEnum;(function(r){r.lineAxisGrid="lineAxisGrid",r.circleAxisGrid="circleAxisGrid"})(GridEnum||(GridEnum={}));var LegendEnum;(function(r){r.discreteLegend="discreteLegend",r.colorLegend="colorLegend",r.sizeLegend="sizeLegend"})(LegendEnum||(LegendEnum={}));var CrosshairEnum;(function(r){r.lineCrosshair="lineCrosshair",r.rectCrosshair="rectCrosshair",r.sectorCrosshair="sectorCrosshair",r.circleCrosshair="circleCrosshair",r.polygonCrosshair="polygonCrosshair",r.ringCrosshair="ringCrosshair"})(CrosshairEnum||(CrosshairEnum={}));var LabelEnum;(function(r){r.symbolLabel="symbolLabel",r.rectLabel="rectLabel",r.lineLabel="lineLabel",r.dataLabel="dataLabel"})(LabelEnum||(LabelEnum={}));var PlayerEnum;(function(r){r.continuousPlayer="continuousPlayer",r.discretePlayer="discretePlayer"})(PlayerEnum||(PlayerEnum={}));var LayoutState;(function(r){r.before="before",r.layouting="layouting",r.reevaluate="reevaluate",r.after="after"})(LayoutState||(LayoutState={}));var HOOK_EVENT;(function(r){r.BEFORE_EVALUATE_DATA="beforeEvaluateData",r.AFTER_EVALUATE_DATA="afterEvaluateData",r.BEFORE_EVALUATE_SCALE="beforeEvaluateScale",r.AFTER_EVALUATE_SCALE="afterEvaluateScale",r.BEFORE_PARSE_VIEW="beforeParseView",r.AFTER_PARSE_VIEW="afterParseView",r.BEFORE_TRANSFORM="beforeTransform",r.AFTER_TRANSFORM="afterTransform",r.BEFORE_CREATE_VRENDER_STAGE="beforeCreateVRenderStage",r.AFTER_CREATE_VRENDER_STAGE="afterCreateVRenderStage",r.BEFORE_CREATE_VRENDER_LAYER="beforeCreateVRenderLayer",r.AFTER_CREATE_VRENDER_LAYER="afterCreateVRenderLayer",r.BEFORE_STAGE_RESIZE="beforeStageResize",r.AFTER_STAGE_RESIZE="afterStageResize",r.BEFORE_VRENDER_DRAW="beforeVRenderDraw",r.AFTER_VRENDER_DRAW="afterVRenderDraw",r.BEFORE_MARK_JOIN="beforeMarkJoin",r.AFTER_MARK_JOIN="afterMarkJoin",r.BEFORE_MARK_UPDATE="beforeMarkUpdate",r.AFTER_MARK_UPDATE="afterMarkUpdate",r.BEFORE_MARK_STATE="beforeMarkState",r.AFTER_MARK_STATE="afterMarkState",r.BEFORE_MARK_ENCODE="beforeMarkEncode",r.AFTER_MARK_ENCODE="afterMarkEncode",r.BEFORE_DO_LAYOUT="beforeDoLayout",r.AFTER_DO_LAYOUT="afterDoLayout",r.BEFORE_MARK_LAYOUT_END="beforeMarkLayoutEnd",r.AFTER_MARK_LAYOUT_END="afterMarkLayoutEnd",r.BEFORE_DO_RENDER="beforeDoRender",r.AFTER_DO_RENDER="afterDoRender",r.BEFORE_MARK_RENDER_END="beforeMarkRenderEnd",r.AFTER_MARK_RENDER_END="afterMarkRenderEnd",r.BEFORE_CREATE_VRENDER_MARK="beforeCreateVRenderMark",r.AFTER_CREATE_VRENDER_MARK="afterCreateVRenderMark",r.BEFORE_ADD_VRENDER_MARK="beforeAddVRenderMark",r.AFTER_ADD_VRENDER_MARK="afterAddVRenderMark",r.AFTER_VRENDER_NEXT_RENDER="afterVRenderNextRender",r.BEFORE_ELEMENT_UPDATE_DATA="beforeElementUpdateData",r.AFTER_ELEMENT_UPDATE_DATA="afterElementUpdateData",r.BEFORE_ELEMENT_STATE="beforeElementState",r.AFTER_ELEMENT_STATE="afterElementState",r.BEFORE_ELEMENT_ENCODE="beforeElementEncode",r.AFTER_ELEMENT_ENCODE="afterElementEncode",r.ANIMATION_START="animationStart",r.ANIMATION_END="animationEnd",r.ELEMENT_ANIMATION_START="elementAnimationStart",r.ELEMENT_ANIMATION_END="elementAnimationEnd",r.ALL_ANIMATION_START="allAnimationStart",r.ALL_ANIMATION_END="allAnimationEnd"})(HOOK_EVENT||(HOOK_EVENT={}));var GrammarTypeEnum;(function(r){r.signal="signal",r.data="data",r.scale="scale",r.coordinate="coordinate",r.mark="mark"})(GrammarTypeEnum||(GrammarTypeEnum={}));var InteractionStateEnum;(function(r){r.active="active",r.selected="selected",r.highlight="highlight",r.blur="blur"})(InteractionStateEnum||(InteractionStateEnum={}));const BridgeElementKey="__vgrammar_scene_item__",CollectionMarkType=[GrammarMarkType.line,GrammarMarkType.area],Mark3DType=[GrammarMarkType.arc3d,GrammarMarkType.rect3d,GrammarMarkType.pyramid3d],DefaultKey="key",DefaultMarkData=[{}],DefaultGroupKeys=["key"],DefaultReuse=!0,DefaultMorph=!0,DefaultMorphAll=!1,DefaultSplitPath=null,DefaultEnableExitAnimation=!0,ImmediateAnimationState="VGRAMMAR_IMMEDIATE_ANIMATION",DefaultAnimationStartTime=0,DefaultAnimationDuration=1e3,DefaultAnimationDelay=0,DefaultAnimationDelayAfter=0,DefaultAnimationLoop=!1,DefaultAnimationOneByOne=!1,DefaultAnimationEasing="quintInOut",DefaultAnimationControlOptions={stopWhenStateChange:!1,immediatelyApply:!0},DefaultAnimationParameters="VGRAMMAR_ANIMATION_PARAMETERS",MARK_OVERLAP_HIDE_KEY="_mo_hide_";function parseReference(r,e){return array(r).reduce((i,n)=>{const o=isString(n)?e.getGrammarById(n):n;return o&&i.push(o),i},[])}function isSignalReferenceType(r){return!isFunction(r)&&!!(r!=null&&r.signal)}function isSignalFunctionType(r){return!isFunction(r)&&!!(r!=null&&r.callback)}function parseFunctionType(r,e){if(isNil(r))return[];if(isSignalReferenceType(r)){const i=r.signal;if(isString(i))return array(e.getGrammarById(i));if((i==null?void 0:i.grammarType)==="signal")return[i]}else if(isSignalFunctionType(r))return parseReference(r.dependency,e);return[]}function isFunctionType(r){return isFunction(r)||(r==null?void 0:r.signal)||!!(r!=null&&r.callback)}function invokeFunctionType(r,e,i,n){if(isNil(r))return r;if(isFunction(r))return n?r.call(null,i,n,e):r.call(null,i,e);if(r.signal){const o=r.signal;return isString(o)?e==null?void 0:e[o]:o.output()}return r.callback?n?r.callback.call(null,i,n,e):r.callback.call(null,i,e):r}function invokeParameterFunctionType(r,e){if(isNil(r))return r;if(isFunction(r))return r.call(null,e);if(r.signal){const i=r.signal;return isString(i)?e==null?void 0:e[i]:i.output()}return r.callback?r.callback.call(null,e):r}function getGrammarOutput(r,e){return isGrammar(r)?r.output():e[r]}function isSignal(r){return r&&(r.signal||r.callback)}const isGrammar=r=>r&&!isNil(r.grammarType),parseField=r=>isFunction(r)?r:e=>e[r];function isScaleEncode(r){return!!(r!=null&&r.scale)}function isFieldEncode(r){return!!(r!=null&&r.field)}function parseEncodeType(r,e){if(!r)return[];let i=[];return r.scale&&(i=isGrammar(r.scale)?[r.scale]:array(e.getScaleById(r.scale))),i.concat(parseFunctionType(r,e))}function isValidPointsChannel(r,e){switch(e){case"line":return r.some(i=>["x","y","defined"].includes(i));case"area":return r.some(i=>["x","y","x1","y1","defined"].includes(i));case"largeRects":return r.some(i=>["x","y","width","y1"].includes(i));case"largeSymbols":return r.some(i=>["x","y"].includes(i))}return!1}function getRulePoints(r){const{x:e,y:i,x1:n,y1:o}=r;return isValidNumber(e)&&isValidNumber(i)&&isValidNumber(n)&&isValidNumber(o)?[{x:e,y:i},{x:n,y:o}]:[]}function getLinePoints(r,e,i,n){return!r||!r.length||r.length===1&&!1?[]:r.some(o=>isValidPointsChannel(Object.keys(o.nextAttrs),"line"))?r.map((o,l)=>{var d;const u=o.nextAttrs,{x:f,y:g,x1:_,y1:y,defined:b}=(d=i==null?void 0:i[l])!==null&&d!==void 0?d:{};return isNil(u.x)&&(u.x=f),isNil(u.y)&&(u.y=g),isNil(u.defined)&&b===!1&&(u.defined=!1),u.context=o.key,n&&(isNil(u.x1)&&(u.x1=_),isNil(u.y1)&&(u.y1=y)),u}):i??[]}function getLargeRectsPoints(r,e,i=[]){if(!r||!r.length||r.length===1&&!1)return[];const n=new Float32Array(4*r.length);return r.forEach((o,l)=>{var d,u,f,g;const _=o.nextAttrs,y=(d=_.x)!==null&&d!==void 0?d:i[4*l],b=(u=_.y)!==null&&u!==void 0?u:i[4*l+1],S=(f=_.width)!==null&&f!==void 0?f:i[4*l+2],v=(g=_.y1)!==null&&g!==void 0?g:i[4*l+3];n[4*l]=y,n[4*l+1]=b,n[4*l+2]=S,n[4*l+3]=v-b}),n}function getLargeSymbolsPoints(r,e,i=[]){if(!r||!r.length||r.length===1&&!1)return[];const n=new Float32Array(2*r.length);return r.forEach((o,l)=>{var d,u;const f=o.nextAttrs,g=(d=f.x)!==null&&d!==void 0?d:i[2*l],_=(u=f.y)!==null&&u!==void 0?u:i[2*l+1];n[2*l]=g,n[2*l+1]=_}),n}function isPositionOrSizeChannel(r,e){if(["x","y","dx","dy"].includes(e))return!0;switch(r){case GrammarMarkType.arc:return["innerRadius","outerRadius","startAngle","endAngle"].includes(e);case GrammarMarkType.group:case GrammarMarkType.rect:case GrammarMarkType.image:return["width","height","y1"].includes(e);case GrammarMarkType.path:case GrammarMarkType.shape:return["path","customPath"].includes(e);case GrammarMarkType.line:return e==="defined";case GrammarMarkType.area:return["x1","y1","defined"].includes(e);case GrammarMarkType.rule:return["x1","y1"].includes(e);case GrammarMarkType.symbol:return e==="size";case GrammarMarkType.polygon:return e==="points";case GrammarMarkType.text:return e==="text"}return!1}function isPointsMarkType(r){return[GrammarMarkType.line,GrammarMarkType.area,GrammarMarkType.largeRects,GrammarMarkType.largeSymbols].includes(r)}function invokeEncoderToItems(r,e,i,n,o){i&&(isFunctionType(i)?e.forEach(l=>{const d=invokeFunctionType(i,n,l.datum,r);Object.assign(l.nextAttrs,d)}):Object.keys(i).forEach(l=>{var d,u;const f=i[l],g=o&&!isPositionOrSizeChannel(r.mark.markType,l)?[e[0]]:e;if(isScaleEncode(f)){const _=getGrammarOutput(f.scale,n),y=(d=f==null?void 0:f.offset)!==null&&d!==void 0?d:0,b=!isNil(f.band)&&_.bandwidth?_.bandwidth()*f.band:null,S=isString(f==null?void 0:f.field),v=S?field$3(f.field):null;let A=S?null:isNil(f==null?void 0:f.value)?0:(u=_.scale)===null||u===void 0?void 0:u.call(_,f.value);g.forEach(x=>{var T;S&&(A=(T=_.scale)===null||T===void 0?void 0:T.call(_,v(x.datum))),x.nextAttrs[l]=isNumber(A)||isNumber(b)?A+y+b:A})}else if(isFieldEncode(f)){const _=field$3(f.field);g.forEach(y=>{y.nextAttrs[l]=_(y.datum)})}else g.forEach(_=>{_.nextAttrs[l]=invokeFunctionType(f,n,_.datum,r)})}))}function invokeEncoder(r,e,i,n){if(!r)return null;if(isFunctionType(r))return invokeFunctionType(r,n,e,i);const o={};return Object.keys(r).forEach(l=>{var d,u,f;const g=r[l];if(isScaleEncode(g)){const _=getGrammarOutput(g.scale,n),y=(d=g==null?void 0:g.offset)!==null&&d!==void 0?d:0,b=!isNil(g.band)&&_.bandwidth?_.bandwidth()*g.band:null,S=isString(g==null?void 0:g.field),v=S?field$3(g.field):null,A=S?(u=_.scale)===null||u===void 0?void 0:u.call(_,v(e)):isNil(g==null?void 0:g.value)?0:(f=_.scale)===null||f===void 0?void 0:f.call(_,g.value);o[l]=isNumber(A)||isNumber(b)?A+y+b:A}else if(isFieldEncode(g)){const _=field$3(g.field);o[l]=_(e)}else o[l]=invokeFunctionType(g,n,e,i)}),o}class GlyphMeta{constructor(e,i,n,o){this.channelEncoder={},this.marks=e,i&&this.registerChannelEncoder(i),n&&this.registerDefaultEncoder(n),this.progressiveChannels&&this.registerProgressiveChannels(o)}getMarks(){return this.marks}registerChannelEncoder(e,i){return isString(e)?this.channelEncoder[e]=i:Object.assign(this.channelEncoder,e),this}registerFunctionEncoder(e){return this.functionEncoder=e,this}registerDefaultEncoder(e){return this.defaultEncoder=e,this}registerProgressiveChannels(e){return this.progressiveChannels=array(e),this}getChannelEncoder(){return this.channelEncoder}getFunctionEncoder(){return this.functionEncoder}getDefaultEncoder(){return this.defaultEncoder}getProgressiveChannels(){return this.progressiveChannels}}class Factory{static registerPlotMarks(e,i){Factory._plotMarks[e]=i}static createPlotMark(e,i){return Factory._plotMarks[e]?new Factory._plotMarks[e](i):null}static registerMark(e,i){Factory._marks[e]=i}static createMark(e,i,n){return Factory._marks[e]?new Factory._marks[e](i,e,n):null}static hasMark(e){return!!Factory._marks[e]}static getMark(e){return Factory._marks[e]}static registerComponent(e,i){Factory._components[e]=i}static createComponent(e,i,n,o){const l=Factory._components[e];return l?new l(i,n,o):null}static hasComponent(e){return!!Factory._components[e]}static registerGraphicComponent(e,i){Factory._graphicComponents[e]=i}static createGraphicComponent(e,i,n){const o=Factory._graphicComponents[e];return o?o(i,n):null}static registerTransform(e,i,n){Factory._transforms[e]=Object.assign(i,{type:e,isBuiltIn:!!n})}static getTransform(e){return Factory._transforms[e]}static unregisterRuntimeTransforms(){Object.keys(Factory._transforms).forEach(e=>{Factory._transforms[e]&&!Factory._transforms[e].isBuiltIn&&(Factory._transforms[e]=null)})}static registerGrammar(e,i,n){Factory._grammars[e]={grammarClass:i,specKey:n??e}}static createGrammar(e,i,n){var o;const l=(o=Factory._grammars[e])===null||o===void 0?void 0:o.grammarClass;return l?new l(i,n):null}static getGrammars(){return this._grammars}static getGlyph(e){return Factory._glyphs[e]}static createInteraction(e,i,n){const o=Factory._interactions[e];return o?new o(i,n):null}static hasInteraction(e){return!!Factory._interactions[e]}}Factory._plotMarks={},Factory._marks={},Factory._components={},Factory._graphicComponents={},Factory._transforms={},Factory._grammars={},Factory._glyphs={},Factory._animations={},Factory._interactions={},Factory._graphics={},Factory._stageEventPlugins={},Factory.registerGlyph=(r,e,i,n,o)=>(Factory._glyphs[r]=new GlyphMeta(e,i,n,o),Factory._glyphs[r]),Factory.registerAnimationType=(r,e)=>{Factory._animations[r]=e},Factory.getAnimationType=r=>Factory._animations[r],Factory.registerInteraction=(r,e)=>{Factory._interactions[r]=e},Factory.registerGraphic=(r,e)=>{Factory._graphics[r]=e},Factory.getGraphicType=r=>Factory._graphics[r],Factory.createGraphic=(r,e)=>{const i=Factory._graphics[r];return i?i(e):null},Factory.registerDefaultLayout=r=>{Factory.defaultLayout=r},Factory.getDefaultLayout=()=>Factory.defaultLayout,Factory.registerStageEventPlugin=(r,e)=>{Factory._stageEventPlugins[r]=e},Factory.getStageEventPlugin=r=>Factory._stageEventPlugins[r];const isMarkType=r=>!!GrammarMarkType[r];function createGraphicItem(r,e,i={}){var n;const o=Factory.getGraphicType(e)?Factory.createGraphic(e,i):Factory.createGraphicComponent(e,i,{skipDefault:(n=r==null?void 0:r.spec)===null||n===void 0?void 0:n.skipTheme});return o||Logger.getInstance().error(`create ${e} graphic failed!`),o}function createGlyphGraphicItem(r,e,i={}){if(!Factory.getGraphicType(GrammarMarkType.glyph))return;const n=Factory.createGraphic(GrammarMarkType.glyph,i),o=e.getMarks(),l=Object.keys(o).map(d=>{if(Factory.getGraphicType(o[d])){const u=Factory.createGraphic(o[d]);if(u)return u.name=d,u}});return n.setSubGraphic(l),n}const removeGraphicItem=r=>{r&&(r[BridgeElementKey]=null,r.release(),r.parent&&r.parent.removeChild(r))},commonAttributes=["fillOpacity"],transformCommonAttribute=(r,e,i)=>{var n;return e==="fillOpacity"?(r.fillOpacity=(n=i.fillOpacity)!==null&&n!==void 0?n:1,["fillOpacity"]):[]};function storeOriginAttributes(r,e,i,n,o,l){const d=o.getGraphicAttribute(r,!1,l);if(d)return e.forEach(f=>{f in n&&(d[f]=n[f])}),d;const u={};return e.forEach(f=>{u[f]=n[f]}),i[r]=u,u}const transformsByType={rect3d:[{channels:["x","y","z","x1","y1","width","height","length"],transform:(r,e,i)=>{var n,o,l,d,u,f,g,_,y,b,S,v;isValidNumber(e.width)||!isValidNumber(e.x1)&&isValidNumber(i.width)?(r.x=Math.min((n=i.x)!==null&&n!==void 0?n:0,(o=i.x1)!==null&&o!==void 0?o:1/0),r.width=i.width):isValidNumber(e.x1)||!isValidNumber(e.width)&&isValidNumber(i.x1)?(r.x=Math.min(i.x,i.x1),r.width=Math.abs(i.x1-i.x)):(r.x=Math.min((l=i.x)!==null&&l!==void 0?l:0,(d=i.x1)!==null&&d!==void 0?d:1/0),r.width=i.width),isValidNumber(e.height)||!isValidNumber(e.y1)&&isValidNumber(i.height)?(r.y=Math.min((u=i.y)!==null&&u!==void 0?u:0,(f=i.y1)!==null&&f!==void 0?f:1/0),r.height=i.height):isValidNumber(e.y1)||!isValidNumber(e.height)&&isValidNumber(i.y1)?(r.y=Math.min(i.y,i.y1),r.height=Math.abs(i.y1-i.y)):(r.y=Math.min((g=i.y)!==null&&g!==void 0?g:0,(_=i.y1)!==null&&_!==void 0?_:1/0),r.height=i.height),isValidNumber(e.length)||!isValidNumber(e.z1)&&isValidNumber(i.length)?(r.z=Math.min((y=i.z)!==null&&y!==void 0?y:0,(b=i.z1)!==null&&b!==void 0?b:1/0),r.length=i.length):isValidNumber(e.z1)||!isValidNumber(e.length)&&isValidNumber(i.z1)?(r.z=Math.min(i.z,i.z1),r.length=Math.abs(i.z1-i.z)):(r.z=Math.min((S=i.z)!==null&&S!==void 0?S:0,(v=i.z1)!==null&&v!==void 0?v:1/0),r.length=i.length)},storedAttrs:"sizeAttrs"}],[GrammarMarkType.text]:[{channels:["text","limit","autoLimit","maxLineWidth","textType","_originText"],transform:(r,e,i)=>{var n,o,l,d;const u=(n=i.limit)!==null&&n!==void 0?n:1/0,f=(o=i.autoLimit)!==null&&o!==void 0?o:1/0,g=Math.min(u,f),_=isPlainObject(i.text)&&!isNil(i.text.text),y=_?i.text.text:i.text;r.maxLineWidth=g===1/0?i.maxLineWidth:g,_||i.textType?i.text.type==="rich"||i.textType==="rich"?r.textConfig=y:i.text.type==="html"?(r.html=y,r.text=(l=i._originText)!==null&&l!==void 0?l:"",r.renderable=!1):i.text.type==="react"?(r.react=y,r.text=(d=i._originText)!==null&&d!==void 0?d:"",r.renderable=!1):r.text=y:r.text=y},storedAttrs:"limitAttrs"}],[GrammarMarkType.rule]:[{channels:["x","y","x1","y1"],transform:(r,e,i)=>{const n=getRulePoints(i);r.points=n,r.x=0,r.y=0},storedAttrs:"pointAttrs"}],[GrammarMarkType.symbol]:[{channels:["shape","symbolType"],transform:(r,e,i)=>{var n;r.symbolType=(n=e.shape)!==null&&n!==void 0?n:e.symbolType}},{channels:["image","fill","background"],transform:(r,e,i)=>{e.image?(r.background=e.image,r.fill=!1):i.image?(r.background=i.image,r.fill=!1):(r.fill=i.fill,r.background=i.background)},storedAttrs:"imageAttrs"}]};function cloneTransformAttributes(r,e){var i;return((i=transformsByType[r])!==null&&i!==void 0?i:[]).reduce((n,o)=>(o.channels.forEach(l=>{has(e,l)&&(n[l]=e[l])}),n),{})}const transformAttributes=(r,e,i,n)=>{const o={},l=e?Object.keys(e):[],d=isString(r)?transformsByType[r]:r;if(d&&d.length){const u=[];l.forEach(f=>{let g=!1;d.forEach((_,y)=>{if(_.channels.includes(f)){if(!u[y])if(_.storedAttrs){const b=storeOriginAttributes(_.storedAttrs,_.channels,o,e,i,n);_.transform(o,e,b)}else _.transform(o,e,null);u[y]=!0,g=!0}}),g||(commonAttributes.includes(f)?transformCommonAttribute(o,f,e):o[f]=e[f])})}else l.forEach(u=>{commonAttributes.includes(u)?transformCommonAttribute(o,u,e):o[u]=e[u]});return o},isStopsEqual=(r,e)=>{var i,n;if(r===e)return!0;const o=(i=r&&r.length)!==null&&i!==void 0?i:0;return o===((n=e&&e.length)!==null&&n!==void 0?n:0)&&o!==0&&r.every((l,d)=>!l&&!e[d]||l&&e[d]&&l.color===e[d].color&&l.offset===e[d].offset)},isColorAttrEqual=(r,e)=>{if(r===e)return!0;if(typeof r!=typeof e||isString(r)||r.gradient!==e.gradient)return!1;const i=Object.keys(r),n=Object.keys(e);return i.length===n.length&&i.every(o=>o==="stops"?isStopsEqual(r[o],e[o]):r[o]===e[o])},isLineDashEqual=(r,e)=>r.length===e.length&&r.join("-")===e.join("-"),isSegmentAttrEqual=(r,e,i)=>!(!isNil(r)||!isNil(e))||!isNil(r)&&!isNil(e)&&(i==="lineDash"?isLineDashEqual(r,e):i==="stroke"||i==="fill"?isColorAttrEqual(r,e):r===e),fillAttrs=["fill","fillOpacity","background","texture","texturePadding","textureSize","textureColor"],strokeAttrs=["stroke","strokeOpacity","lineDash","lineDashOffset","lineCap","lineJoin","lineWidth","miterLimit"],areaAttrs=fillAttrs.concat(strokeAttrs);function getLineSegmentConfigs(r,e,i){var n;if(!r||r.length<=1)return null;const o=((n=i==null?void 0:i.mark)===null||n===void 0?void 0:n.markType)==="area"?areaAttrs:strokeAttrs,l=[];let d=null;return r.forEach((u,f)=>{d&&o.every(g=>isSegmentAttrEqual(d[g],u[g],g))||(l.length&&(l[l.length-1].endIndex=f),d=u,l.push({attrs:d,startIndex:f}))}),l.length>=2?l.map(u=>{const f=parseCollectionMarkAttributes(u.attrs);return f.points=e.slice(u.startIndex,isNil(u.endIndex)?e.length:u.endIndex),f}):null}function getConnectLineSegmentConfigs(r,e,i){if(!r||r.length<=1)return null;const n=!!i&&i.mark.getSpec().enableSegments;let o,l,d=[],u=null;if(r.forEach((f,g)=>{u=e[g],u&&u.defined!==!1?(o||(l={items:[],points:[]},d.push(l)),l.points.push(u),l.items.push(f),o===!1&&(l.isConnect=!0,l={items:[],points:[]},d.push(l)),o=!0):o=!1}),d=d.filter(f=>f.points.length>0),d.length>=2){const f=[];return d.forEach(g=>{if(g.isConnect)return void f.push({points:g.points,isConnect:!0});if(n){const y=getLineSegmentConfigs(g.items,g.points,i);if(y)return void y.forEach(b=>{f.push(b)})}const _=parseCollectionMarkAttributes(g.items[0]);_.points=g.points,f.push(_)}),f}return n?getLineSegmentConfigs(r,e,i):null}function getLinePointsFromSegments(r){return r?r.reduce((e,i)=>e.concat(i.points),[]):null}function parseCollectionMarkAttributes(r){const e={};if(!r)return e;const i=["x","y","x1","y1","defined","size","width","height","context"];return Object.keys(r).forEach(n=>{i.includes(n)||(e[n]=r[n])}),e}function removeSegmentAttrs(r,e){var i;if(!r||!r.segments||!r.segments.length)return r;const n=((i=e==null?void 0:e.mark)===null||i===void 0?void 0:i.markType)==="area"?["fillOpacity","strokeOpacity"]:["strokeOpacity"],o={};return Object.keys(r).forEach(l=>{n.includes(l)||(o[l]=r[l])}),o}let Element$1=class{constructor(e){this.data=null,this.states=[],this.diffState=DiffState.enter,this.isReserved=!1,this.runtimeStatesEncoder=null,this.items=[],this.getStateAttrs=(i,n)=>{var o,l,d,u;const f=!isNil((o=this.runtimeStatesEncoder)===null||o===void 0?void 0:o[i]),g=f?Object.assign(Object.assign({},(l=this.mark.getSpec().encode)===null||l===void 0?void 0:l[i]),this.runtimeStatesEncoder[i]):(d=this.mark.getSpec().encode)===null||d===void 0?void 0:d[i];if(!g)return{};if(isFunction(g))return g(this.getDatum(),this,i,n);if(!f&&(!((u=this.graphicItem.states)===null||u===void 0)&&u[i]))return this.graphicItem.states[i];const _=this.items.map(b=>Object.assign({},b,{nextAttrs:{}}));invokeEncoderToItems(this,_,g,this.mark.parameters());const y=this.transformElementItems(_,this.mark.markType);return this.graphicItem.states?this.graphicItem.states[i]||(this.graphicItem.states[i]=y):this.graphicItem.states={[i]:y},y},this.mark=e}initGraphicItem(e={}){if(this.graphicItem)return;const i=this.mark.getAttributeTransforms();if(this.graphicItem=this.mark.addGraphicItem(i?transformAttributes(i,e,this):e,this.groupKey),!this.graphicItem)return;const{graphicName:n}=this.mark.getSpec();isString(n)?this.graphicItem.name=n:isFunction(n)&&(this.graphicItem.name=n(this)),this.graphicItem[BridgeElementKey]=this,i&&(this.graphicItem.onBeforeAttributeUpdate=o=>this.mark?transformAttributes(i,o,this):o),this.clearGraphicAttributes(),this.mark.needAnimate()&&(this.setPrevGraphicAttributes(null),this.setNextGraphicAttributes(Object.assign({},e)),this.setFinalGraphicAttributes(Object.assign({},e)))}updateGraphicItem(){var e;if(!this.graphicItem)return;this.diffState===DiffState.exit?this.graphicItem.releaseStatus="willRelease":this.graphicItem.releaseStatus=void 0;const i=(e=this.mark.animate)===null||e===void 0?void 0:e.getAnimationConfigs("state");i&&i.length!==0&&(this.graphicItem.stateAnimateConfig=i[0].originConfig)}getGraphicItem(){return this.graphicItem}removeGraphicItem(){var e,i;this.graphicItem&&((i=(e=this.graphicItem.animates)===null||e===void 0?void 0:e.forEach)===null||i===void 0||i.call(e,n=>n.stop())),this.graphicItem&&(removeGraphicItem(this.graphicItem),this.graphicItem[BridgeElementKey]=null,this.graphicItem=null)}resetGraphicItem(){this.graphicItem&&(this.graphicItem=null)}getBounds(){var e;return(e=this.graphicItem)===null||e===void 0?void 0:e.AABBBounds}getStates(){return this.states}updateData(e,i,n){var o;this.mark.emit(HOOK_EVENT.BEFORE_ELEMENT_UPDATE_DATA,{groupKey:e,data:i,key:n},this),this.data=i;const l=parseField(n);return this.items=i.map(d=>({datum:d,key:l(d),view:this.mark.view,nextAttrs:{}})),this.groupKey=e,this.key=this.mark.isCollectionMark()?e:(o=this.items)===null||o===void 0?void 0:o[0].key,this.mark.emit(HOOK_EVENT.AFTER_ELEMENT_UPDATE_DATA,{groupKey:e,data:i,key:n},this),this.items}state(e,i){var n;const o=this.mark.isCollectionMark(),l=this.states,d=array(invokeFunctionType(e,i,this.getDatum(),this)),u=(n=this.mark.getSpec())===null||n===void 0?void 0:n.stateSort;u&&d.length&&d.sort(u);const f=d.length!==l.length||d.some((g,_)=>g!==l[_]);this.states=d,!o&&f&&this.diffState===DiffState.unChange&&(this.diffState=DiffState.update)}encodeGraphic(e){this.coordinateTransformEncode(this.items);const i=this.transformElementItems(this.items,this.mark.markType);e&&Object.assign(i,e),this.graphicItem?(this.graphicItem.clearStates(),this.graphicItem.states={},this.graphicItem.stateProxy=null,MARK_OVERLAP_HIDE_KEY in this.graphicItem.attribute&&"visible"in i&&delete this.graphicItem.attribute[MARK_OVERLAP_HIDE_KEY],this.applyGraphicAttributes(i)):this.initGraphicItem(i),this.diffState!==DiffState.enter&&this.diffState!==DiffState.update||!this.states.length||this.useStates(this.states),this.mark.markType===GrammarMarkType.shape&&(this.graphicItem.datum=this.items[0].datum),this.items.forEach(n=>{n.nextAttrs={}}),this._setCustomizedShape()}_setCustomizedShape(){var e;if(!this.graphicItem)return;const i=(e=this.mark.getSpec())===null||e===void 0?void 0:e.setCustomizedShape;i&&(this.graphicItem.pathProxy=n=>i(this.data,n,new CustomPath2D))}encodeItems(e,i,n=!1,o){const l=this.mark.isCollectionMark(),d=i[BuiltInEncodeNames.update],u=i[BuiltInEncodeNames.enter],f=i[BuiltInEncodeNames.exit],g=this.mark.isLargeMode()||l&&!this.mark.getSpec().enableSegments;this.diffState===DiffState.enter?(u&&invokeEncoderToItems(this,e,u,o,g),d&&invokeEncoderToItems(this,e,d,o,g)):this.diffState===DiffState.update?((l&&u||n)&&invokeEncoderToItems(this,e,u,o,g),d&&invokeEncoderToItems(this,e,d,o,g)):this.diffState===DiffState.exit&&f&&(n&&invokeEncoderToItems(this,e,u,o,g),invokeEncoderToItems(this,e,f,o,g))}coordinateTransformEncode(e){if(!this.mark.coord||this.mark.markType==="arc"||this.mark.disableCoordinateTransform===!0)return;const i=this.mark.coord.output();e.forEach(n=>{const o=n.nextAttrs,l=i.convert(o);Object.assign(o,l)})}hasStateAnimation(){var e;const i=(e=this.mark.animate)===null||e===void 0?void 0:e.getAnimationConfigs("state");return i&&i.length>0}clearStates(e){const i=isBoolean(e)?e:this.hasStateAnimation();this.states=[],this.graphicItem&&this.graphicItem.clearStates(i),this.runtimeStatesEncoder&&(this.runtimeStatesEncoder={})}_updateRuntimeStates(e,i){this.runtimeStatesEncoder||(this.runtimeStatesEncoder={}),this.runtimeStatesEncoder[e]=i}hasState(e){return this.states&&e&&this.states.includes(e)}updateStates(e){if(!this.graphicItem)return!1;let i=this.states.slice();const n=this.mark.getSpec().encode;let o=!1,l=!1;return Object.keys(e).forEach(d=>{var u;if(!d)return;const f=e[d];if(isObject$1(f)&&!isEqual(f,(u=this.runtimeStatesEncoder)===null||u===void 0?void 0:u[d]))i.includes(d)?o=!0:i.push(d),this._updateRuntimeStates(d,f),l=!0;else if(f)!i.includes(d)&&(n!=null&&n[d])&&(i.push(d),l=!0);else if(i.length){const g=i.filter(_=>_!==d);g.length!==i.length&&(l=!0,i=g),this.runtimeStatesEncoder&&this.runtimeStatesEncoder[d]&&(this.runtimeStatesEncoder[d]=null)}}),o&&this.graphicItem.clearStates(),!!l&&(this.useStates(i),!0)}addState(e,i){var n;if(!this.graphicItem)return!1;if(i&&isString(e)&&!isEqual(i,(n=this.runtimeStatesEncoder)===null||n===void 0?void 0:n[e])){const d=this.states.slice();return d.includes(e)?this.graphicItem.clearStates():d.push(e),this._updateRuntimeStates(e,i),this.useStates(d),!0}const o=this.mark.getSpec().encode,l=array(e).reduce((d,u)=>(u&&!d.includes(u)&&(o!=null&&o[u])&&d.push(u),d),this.states.slice());return l.length!==this.states.length&&(this.useStates(l),!0)}removeState(e){if(!this.graphicItem)return!1;const i=array(e);if(!i.length)return!1;const n=this.states.filter(o=>!i.includes(o));return n.length!==this.states.length&&(this.runtimeStatesEncoder&&i.forEach(o=>{this.runtimeStatesEncoder[o]=null}),this.useStates(n),!0)}useStates(e,i){var n;if(!this.graphicItem)return!1;this.mark.emit(HOOK_EVENT.BEFORE_ELEMENT_STATE,{states:e},this);const o=(n=this.mark.getSpec())===null||n===void 0?void 0:n.stateSort;o&&e.sort(o),this.states=e;const l=isBoolean(i)?i:this.hasStateAnimation();return this.graphicItem.stateProxy=this.getStateAttrs,this.graphicItem.useStates(this.states,l),this.mark.emit(HOOK_EVENT.AFTER_ELEMENT_STATE,{states:e},this),!0}diffAttributes(e){const i={},n=this.getFinalGraphicAttributes();for(const o in e)has(n,o)&&isEqual(n[o],e[o])||(i[o]=e[o]);return i}transformElementItems(e,i,n){var o,l,d,u,f;const g=e[0];if(!g.nextAttrs||Object.keys(g.nextAttrs).length===0)return{};let _=g.nextAttrs;if(isPointsMarkType(i)&&e&&e.length&&isNil((o=g.nextAttrs)===null||o===void 0?void 0:o.points)&&(n===!0||isValidPointsChannel(Object.keys(g.nextAttrs),this.mark.markType))){const y=this.mark.getSpec(),b=this.getGraphicAttribute("points",!1),S=this.getGraphicAttribute("segments",!1),v=y.enableSegments,A=(l=this.mark.getSpec().encode)===null||l===void 0?void 0:l[BuiltInEncodeNames.connectNulls],x=e.map(C=>C.nextAttrs),T=this.mark.isProgressive();if(_=parseCollectionMarkAttributes(_),i===GrammarMarkType.line||i===GrammarMarkType.area){const C=getLinePoints(e,!0,b,i===GrammarMarkType.area);if(T)_.segments=((f=(u=(d=this.graphicItem)===null||d===void 0?void 0:d.attribute)===null||u===void 0?void 0:u.segments)!==null&&f!==void 0?f:[]).concat([{points:C}]);else if(A){if(_.segments=getConnectLineSegmentConfigs(x,C,this),_.segments&&_.segments.some(E=>E.isConnect)){const E=invokeEncoder(A,this.getDatum(),this,this.mark.parameters());E&&_.segments.forEach(P=>{P.isConnect&&Object.assign(P,E)})}_.points=C}else if(v){const E=C&&C.length!==0?C:getLinePointsFromSegments(S),P=getLineSegmentConfigs(x,E,this);P?(_.segments=P,_.points=null):(_.segments=null,_.points=E),_=removeSegmentAttrs(_,this)}else _.points=C,_.segments=null}else i===GrammarMarkType.largeRects?_.points=getLargeRectsPoints(e,!0,b):i===GrammarMarkType.largeSymbols&&(_.points=getLargeSymbolsPoints(e,!0,b))}return _}applyGraphicAttributes(e){var i,n,o;if(!isEmpty(e))if(this.mark.needAnimate()){const l=this.diffAttributes(e),d=(i=this.getPrevGraphicAttributes())!==null&&i!==void 0?i:{},u=(n=this.getFinalGraphicAttributes())!==null&&n!==void 0?n:{};Object.keys(l).forEach(y=>{d[y]=this.getGraphicAttribute(y),u[y]=l[y]}),this.setNextGraphicAttributes(l),this.setPrevGraphicAttributes(d),this.setFinalGraphicAttributes(u);const f=(o=this.mark.animate)===null||o===void 0?void 0:o.getElementAnimators(this).filter(y=>{var b;return!(!((b=y.animationOptions.timeline.controlOptions)===null||b===void 0)&&b.ignoreLoopFinalAttributes)||!y.animationOptions.timeline.loop}),g=(f||[]).reduce((y,b)=>Object.assign(y,b.getEndAttributes()),{}),_=Object.assign({},g,u);this.graphicItem.setAttributes(_)}else this.graphicItem.setAttributes(e)}getGraphicAttribute(e,i=!1){var n;if(!this.graphicItem)return;if(i){let d;const u=this.getPrevGraphicAttributes();if(!isNil(d=get(u,e)))return d}const o=this.mark.getAttributeTransforms();let l=[e];if(o&&o.length){const d=o.find(u=>u.storedAttrs&&u.channels.includes(e));d&&(l=[d.storedAttrs,e])}return get((n=this.graphicItem)===null||n===void 0?void 0:n.attribute,l)}setGraphicAttribute(e,i,n=!0){if(!this.graphicItem)return;const o=this.getFinalGraphicAttributes(),l=this.getPrevGraphicAttributes();n&&o&&(o[e]=i),l&&!has(l,e)&&(l[e]=this.graphicItem.attribute[e]),this.graphicItem.setAttribute(e,i)}setGraphicAttributes(e,i=!0){if(!this.graphicItem)return;const n=this.getFinalGraphicAttributes(),o=this.getPrevGraphicAttributes();Object.keys(e).forEach(l=>{n&&i&&(n[l]=e[l]),o&&!has(o,l)&&(o[l]=this.graphicItem.attribute[l])}),this.graphicItem.setAttributes(e)}getFinalGraphicAttributes(){return this.graphicItem.finalAttrs}setFinalGraphicAttributes(e){this.graphicItem.finalAttrs=e}getPrevGraphicAttributes(){return this.graphicItem.prevAttrs}setPrevGraphicAttributes(e){this.graphicItem.prevAttrs=e}getNextGraphicAttributes(){return this.graphicItem.nextAttrs}getFinalAnimationAttribute(e){var i,n;return(n=(i=this.getFinalGraphicAttributes())===null||i===void 0?void 0:i[e])!==null&&n!==void 0?n:this.getGraphicAttribute(e)}getFinalAnimationAttributes(){var e;return(e=this.getFinalGraphicAttributes())!==null&&e!==void 0?e:this.graphicItem.attribute}setNextGraphicAttributes(e){this.graphicItem.nextAttrs=e}clearChangedGraphicAttributes(){this.graphicItem&&(this.setPrevGraphicAttributes(null),this.setNextGraphicAttributes(null))}clearGraphicAttributes(){this.graphicItem&&(this.graphicItem.prevAttrs&&this.setPrevGraphicAttributes(null),this.graphicItem.nextAttrs&&this.setNextGraphicAttributes(null),this.graphicItem.finalAttrs&&this.setFinalGraphicAttributes(null))}remove(){this.graphicItem&&(removeGraphicItem(this.graphicItem),this.graphicItem=null)}release(){this.removeGraphicItem(),this.mark=null,this.data=null,this.items=null}getItemAttribute(e){var i,n;if(!((i=this.items)===null||i===void 0)&&i.length)return this.mark.isCollectionMark()?isNil(e)?this.items.map(o=>o.nextAttrs):this.items.map(o=>{var l;return(l=o.nextAttrs)===null||l===void 0?void 0:l[e]}):isNil(e)?this.items[0].nextAttrs:(n=this.items[0].nextAttrs)===null||n===void 0?void 0:n[e]}setItemAttributes(e){var i;!((i=this.items)===null||i===void 0)&&i.length&&(this.mark.isCollectionMark()?isArray(e)&&this.items.forEach((n,o)=>{Object.assign(n.nextAttrs,e[o])}):Object.assign(this.items[0].nextAttrs,e))}getItem(){var e,i;return this.mark&&this.mark.isCollectionMark()?(e=this.items)!==null&&e!==void 0?e:[]:(i=this.items)===null||i===void 0?void 0:i[0]}getDatum(){var e,i;return this.mark&&this.mark.isCollectionMark()?(e=this.data)!==null&&e!==void 0?e:[]:(i=this.data)===null||i===void 0?void 0:i[0]}};class BaseInteraction{constructor(e,i){this.references=new Map,this.view=e,this.depend(i==null?void 0:i.dependency)}getStartState(){return null}depend(e){this.references.clear(),array(e).map(i=>isString(i)?this.view.getGrammarById(i):i).filter(i=>!isNil(i)).forEach(i=>{var n;this.references.set(i,((n=this.references.get(i))!==null&&n!==void 0?n:0)+1)})}parameters(){const e={};return this.references.forEach((i,n)=>{isValid(n.id())&&(e[n.id()]=n.output())}),e}bind(){const e=this.getEvents();(e??[]).forEach(i=>{i.type&&i.handler&&(isArray(i.type)?i.type.forEach(n=>{n&&n!=="none"&&this.view.addEventListener(n,i.handler)}):i.type!=="none"&&this.view.addEventListener(i.type,i.handler))})}unbind(){const e=this.getEvents();(e??[]).forEach(i=>{i.type&&i.handler&&(isArray(i.type)?i.type.forEach(n=>{n&&n!=="none"&&this.view.removeEventListener(n,i.handler)}):i.type!=="none"&&this.view.removeEventListener(i.type,i.handler))})}start(e){}reset(e){}dispatchEvent(e,i){this.view.emit(`${this.type}:${e}`,i),e==="start"&&this.options.onStart?this.options.onStart(i):e==="reset"&&this.options.onReset?this.options.onReset(i):e==="update"&&this.options.onUpdate?this.options.onUpdate(i):e==="end"&&this.options.onEnd&&this.options.onEnd(i)}}class ElementActive extends BaseInteraction{constructor(e,i){super(e,i),this.type=ElementActive.type,this.handleStart=n=>{this.start(n.element)},this.handleReset=n=>{this.reset(n.element)},this.options=Object.assign({},ElementActive.defaultOptions,i),this._marks=e.getMarksBySelector(this.options.selector)}getEvents(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]}getStartState(){return this.options.state}start(e){e&&this._marks&&this._marks.includes(e.mark)&&(e.addState(this.options.state),this._prevActiveElement=e)}reset(e){const i=e??this._prevActiveElement;i&&this._marks&&this._marks.includes(i.mark)&&i.removeState(this.options.state)}}ElementActive.type="element-active",ElementActive.defaultOptions={state:InteractionStateEnum.active,trigger:"pointerover",triggerOff:"pointerout"};const generateFilterValue=r=>r.filterField?e=>{var i;return(i=e.getDatum())===null||i===void 0?void 0:i[r.filterField]}:e=>e[r.filterType],groupMarksByState=(r,e)=>{if(!e||!r)return null;const i={};return r.forEach(n=>{const o=n&&n.getSpec(),l=o&&o.encode;l&&e.forEach(d=>{d&&l[d]&&(i[d]||(i[d]=[]),i[d].push(n))})}),i},parseTriggerOffOfSelect=r=>{const e=array(r),i=[],n=[];return e.forEach(o=>{o==="empty"?i.push("view"):isString(o)&&o!=="none"?o.includes("view:")?(n.push(o.replace("view:","")),i.push("view")):(n.push(o),i.push("self")):isNumber(o)&&i.push("timeout")}),{eventNames:n,resetType:i}};class ElementSelect extends BaseInteraction{constructor(e,i){super(e,i),this.type=ElementSelect.type,this._resetType=[],this.resetAll=()=>{const{state:n,reverseState:o}=this.options;this._statedElements&&this._statedElements.length&&(this.clearAllStates(n,o),this.dispatchEvent("reset",{elements:this._statedElements,options:this.options}),this._statedElements=[])},this.handleStart=n=>{this.start(n.element)},this.handleReset=n=>{if(!this._statedElements||!this._statedElements.length)return;const o=n.element,l=o&&this._marks&&this._marks.includes(o.mark);(this._resetType.includes("view")&&!l||this._resetType.includes("self")&&l)&&this.resetAll()},this.options=Object.assign({},ElementSelect.defaultOptions,i),this._marks=e.getMarksBySelector(this.options.selector),this._stateMarks=groupMarksByState(this._marks,[this.options.state,this.options.reverseState])}getStartState(){return this.options.state}getEvents(){const e=this.options.triggerOff,i=this.options.trigger,n=[{type:i,handler:this.handleStart}],{eventNames:o,resetType:l}=parseTriggerOffOfSelect(e);return o.forEach(d=>{d&&(isArray(i)?!i.includes(d):d!==i)&&n.push({type:d,handler:this.handleReset})}),this._resetType=l,n}start(e){const{state:i,reverseState:n,isMultiple:o}=this.options;if(e&&this._marks&&this._marks.includes(e.mark))if(e.hasState(i)){if(this._resetType.includes("self")){const l=this._statedElements&&this._statedElements.filter(d=>d!==e);l&&l.length?this._statedElements=this.updateStates(l,this._statedElements,i,n):this.resetAll()}}else this._timer&&clearTimeout(this._timer),e.addState(i),this._statedElements=this.updateStates(o&&this._statedElements?[...this._statedElements,e]:[e],this._statedElements,i,n),this.dispatchEvent("start",{elements:this._statedElements,options:this.options}),this._resetType.includes("timeout")&&(this._timer=setTimeout(()=>{this.resetAll()},this.options.triggerOff));else this._resetType.includes("view")&&this._statedElements&&this._statedElements.length&&this.resetAll()}reset(e){e?this._marks&&this._marks.includes(e.mark)&&e.removeState([this.options.state,this.options.reverseState]):this.resetAll()}}ElementSelect.type="element-select",ElementSelect.defaultOptions={state:InteractionStateEnum.selected,trigger:"click"};class ElementHighlight extends BaseInteraction{constructor(e,i){super(e,i),this.type=ElementHighlight.type,this.handleStart=n=>{this.start(n.element)},this.handleReset=n=>{if(!this._statedElements||!this._statedElements.length)return;const o=n.element;if(o){const l=this._marks&&this._marks.includes(o.mark);this._resetType!=="view"||l?this._resetType==="self"&&l&&this.resetAll():this.resetAll()}},this.options=Object.assign({},ElementHighlight.defaultOptions,i),this._marks=e.getMarksBySelector(this.options.selector),this._stateMarks=groupMarksByState(this._marks,[this.options.highlightState,this.options.blurState])}getStartState(){return this.options.highlightState}getEvents(){const e=this.options.triggerOff,i=[{type:this.options.trigger,handler:this.handleStart}];let n=e;return isString(e)&&e.includes("view:")?(n=e.replace("view:",""),this._resetType="view"):this._resetType="self",i.push({type:n,handler:this.handleReset}),i}resetAll(){const{highlightState:e,blurState:i}=this.options;this._lastElement&&(this.clearAllStates(e,i),this.dispatchEvent("reset",{elements:[this._lastElement],options:this.options}),this._lastElement=null,this._statedElements=null)}start(e){if(e&&this._marks&&this._marks.includes(e.mark)){const{highlightState:i,blurState:n}=this.options;if(this._lastElement===e)return;this._statedElements=this.updateStates([e],this._statedElements,i,n),this._lastElement=e,this.dispatchEvent("start",{elements:[e],options:this.options})}else this._lastElement&&this._resetType==="view"&&this.resetAll()}reset(e){e?this._marks&&this._marks.includes(e.mark)&&e.removeState([this.options.highlightState,this.options.blurState]):this.resetAll()}}ElementHighlight.type="element-highlight",ElementHighlight.defaultOptions={highlightState:InteractionStateEnum.highlight,blurState:InteractionStateEnum.blur,trigger:"pointerover",triggerOff:"pointerout"};class ElementHighlightByKey extends BaseInteraction{constructor(e,i){super(e,i),this.type=ElementHighlightByKey.type,this.handleStart=n=>{this.start(n.element)},this.handleReset=n=>{n.element&&this._marks&&this._marks.includes(n.element.mark)&&this.resetAll()},this.options=Object.assign({},ElementHighlightByKey.defaultOptions,i),this._marks=e.getMarksBySelector(this.options.selector)}getStartState(){return this.options.highlightState}getEvents(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]}resetAll(){const e=[this.options.highlightState,this.options.blurState];this._marks.forEach(i=>{i.elements.forEach(n=>{n.removeState(e)})})}start(e){if(e&&this._marks&&this._marks.includes(e.mark)){const i=e.key;if(isNil(i))return;this._marks.forEach(n=>{n.elements.forEach(o=>{o.key===i?o.updateStates({[this.options.blurState]:!1,[this.options.highlightState]:!0}):o.updateStates({[this.options.blurState]:!0,[this.options.highlightState]:!1})})})}}reset(e){e?this._marks&&this._marks.includes(e.mark)&&e.removeState([this.options.highlightState,this.options.blurState]):this.resetAll()}}ElementHighlightByKey.type="element-highlight-by-key",ElementHighlightByKey.defaultOptions={highlightState:InteractionStateEnum.highlight,blurState:InteractionStateEnum.blur,trigger:"pointerover",triggerOff:"pointerout"};class ElementHighlightByGroup extends BaseInteraction{constructor(e,i){super(e,i),this.type=ElementHighlightByGroup.type,this.handleStart=n=>{this.start(n.element)},this.handleReset=n=>{const o=n.element;o&&this._marks&&this._marks.includes(o.mark)&&this.resetAll()},this.options=Object.assign({},ElementHighlightByGroup.defaultOptions,i),this._marks=e.getMarksBySelector(this.options.selector)}getStartState(){return this.options.highlightState}getEvents(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]}resetAll(){const e=[this.options.highlightState,this.options.blurState];this._marks.forEach(i=>{i.elements.forEach(n=>{n.removeState(e)})})}start(e){if(e&&this._marks&&this._marks.includes(e.mark)){const i=e.groupKey;if(isNil(i))return;this._marks.forEach(n=>{n.elements.forEach(o=>{o.groupKey===i?o.updateStates({[this.options.blurState]:!1,[this.options.highlightState]:!0}):o.updateStates({[this.options.blurState]:!0,[this.options.highlightState]:!1})})})}}reset(e){e?this._marks&&this._marks.includes(e.mark)&&e.removeState([this.options.highlightState,this.options.blurState]):this.resetAll()}}ElementHighlightByGroup.type="element-highlight-by-group",ElementHighlightByGroup.defaultOptions={highlightState:InteractionStateEnum.highlight,blurState:InteractionStateEnum.blur,trigger:"pointerover",triggerOff:"pointerout"};class ElementActiveByLegend extends BaseInteraction{constructor(e,i){super(e,i),this.type=ElementActiveByLegend.type,this.handleStart=n=>{var o,l;this.start((l=(o=n.detail)===null||o===void 0?void 0:o.data)===null||l===void 0?void 0:l.id)},this.handleReset=n=>{this.resetAll()},this.options=Object.assign({},ElementActiveByLegend.defaultOptions,i),this._marks=e.getMarksBySelector(this.options.selector)}getEvents(){return[{type:LegendEvent.legendItemHover,handler:this.handleStart},{type:LegendEvent.legendItemUnHover,handler:this.handleReset}]}getStartState(){return this.options.state}start(e){const i=e;if(isNil(i))return;const n=generateFilterValue(this.options);this._marks.forEach(o=>{o.elements.forEach(l=>{n(l)===i?l.addState(this.options.state):l.removeState(this.options.state)})})}resetAll(){this._marks.forEach(e=>{e.elements.forEach(i=>{i.removeState(this.options.state)})})}reset(e){e?this._marks&&this._marks.includes(e.mark)&&e.removeState(this.options.state):this.resetAll()}}ElementActiveByLegend.type="element-active-by-legend",ElementActiveByLegend.defaultOptions={state:InteractionStateEnum.active,filterType:"groupKey"};class ElementHighlightByLegend extends BaseInteraction{constructor(e,i){super(e,i),this.type=ElementHighlightByLegend.type,this.handleStart=(n,o)=>{var l,d;this.start((d=(l=n.detail)===null||l===void 0?void 0:l.data)===null||d===void 0?void 0:d.id)},this.handleReset=n=>{this.resetAll()},this.options=Object.assign({},ElementHighlightByLegend.defaultOptions,i),this._marks=e.getMarksBySelector(this.options.selector)}getStartState(){return this.options.highlightState}getEvents(){return[{type:LegendEvent.legendItemHover,handler:this.handleStart},{type:LegendEvent.legendItemUnHover,handler:this.handleReset}]}start(e){if(isNil(e))return;const i=generateFilterValue(this.options);this._marks.forEach(n=>{n.elements.forEach(o=>{i(o)===e?o.updateStates({[this.options.blurState]:!1,[this.options.highlightState]:!0}):o.updateStates({[this.options.blurState]:!0,[this.options.highlightState]:!1})})})}resetAll(){const e=[this.options.highlightState,this.options.blurState];this._marks.forEach(i=>{i.elements.forEach(n=>{n.removeState(e)})})}reset(e){e?this._marks&&this._marks.includes(e.mark)&&e.removeState([this.options.highlightState,this.options.blurState]):this.resetAll()}}ElementHighlightByLegend.type="element-highlight-by-legend",ElementHighlightByLegend.defaultOptions={highlightState:InteractionStateEnum.highlight,blurState:InteractionStateEnum.blur,filterType:"groupKey"};class ElementHighlightByName extends BaseInteraction{constructor(e,i){super(e,i),this.type=ElementHighlightByName.type,this.handleStart=(n,o)=>{if(this.options.shouldStart?this.options.shouldStart(n):this._filterByName(n)){const l=this._parseTargetKey(n,o);this.start(l)}},this.handleReset=n=>{(this.options.shouldReset?this.options.shouldReset(n):this._filterByName(n))&&this.resetAll()},this.options=Object.assign({},ElementHighlightByName.defaultOptions,i),this._marks=e.getMarksBySelector(this.options.selector)}getStartState(){return this.options.highlightState}getEvents(){return[{type:this.options.trigger,handler:this.handleStart},{type:this.options.triggerOff,handler:this.handleReset}]}_filterByName(e){var i;const n=array(this.options.graphicName);return((i=e==null?void 0:e.target)===null||i===void 0?void 0:i.name)&&n.includes(e.target.name)}_parseTargetKey(e,i){return this.options.parseData?this.options.parseData(e):e.target.type==="text"?e.target.attribute.text:null}start(e){if(isNil(e))return;const i=generateFilterValue(this.options);this._marks.forEach(n=>{n.elements.forEach(o=>{i(o)===e?o.updateStates({[this.options.blurState]:!1,[this.options.highlightState]:!0}):o.updateStates({[this.options.blurState]:!0,[this.options.highlightState]:!1})})})}resetAll(){const e=[this.options.blurState,this.options.highlightState];this._marks.forEach(i=>{i.elements.forEach(n=>{n.removeState(e)})})}reset(e){e?this._marks&&this._marks.includes(e.mark)&&e.removeState([this.options.highlightState,this.options.blurState]):this.resetAll()}}ElementHighlightByName.type="element-highlight-by-name",ElementHighlightByName.defaultOptions={trigger:"pointerover",triggerOff:"pointerout",highlightState:InteractionStateEnum.highlight,blurState:InteractionStateEnum.blur,filterType:"groupKey"};function getBandWidthOfScale(r){if(r)return r.type===ScaleEnum.Band?r.bandwidth():r.type===ScaleEnum.Point?r.step():void 0}class ToggleStateMixin{updateStates(e,i,n,o){return e&&e.length?(n&&o?i&&i.length?(this.toggleReverseStateOfElements(e,i,o),this.toggleStateOfElements(e,i,n)):this.addBothStateOfElements(e,n,o):n&&(i&&i.length?this.toggleStateOfElements(e,i,n):this.addStateOfElements(e,n)),e):null}toggleReverseStateOfElements(e,i,n){i.forEach(o=>{n&&this._stateMarks[n]&&this._stateMarks[n].includes(o.mark)&&o.addState(n)}),e.forEach(o=>{n&&this._stateMarks[n]&&this._stateMarks[n].includes(o.mark)&&o.removeState(n)})}toggleStateOfElements(e,i,n){i.forEach(o=>{n&&this._stateMarks[n]&&this._stateMarks[n].includes(o.mark)&&o.removeState(n)}),e.forEach(o=>{n&&this._stateMarks[n]&&this._stateMarks[n].includes(o.mark)&&o.addState(n)})}addBothStateOfElements(e,i,n){this._marks.forEach(o=>{var l;const d=n&&this._stateMarks[n]&&this._stateMarks[n].includes(o),u=i&&this._stateMarks[i]&&this._stateMarks[i].includes(o);(d||u)&&((l=o.elements)===null||l===void 0||l.forEach(f=>{e&&e.includes(f)?u&&f.addState(i):d&&f.addState(n)}))})}addStateOfElements(e,i){this._marks.forEach(n=>{var o;const l=i&&this._stateMarks[i]&&this._stateMarks[i].includes(n);l&&((o=n.elements)===null||o===void 0||o.forEach(d=>{e&&e.includes(d)&&l&&d.addState(i)}))})}clearAllStates(e,i){this._statedElements&&this._statedElements.length&&this._marks.forEach(n=>{n&&n.elements&&(i&&this._stateMarks[i]&&this._stateMarks[i].includes(n)&&n.elements.forEach(o=>{o.removeState(i)}),e&&this._stateMarks[e]&&this._stateMarks[e].includes(n)&&n.elements.forEach(o=>{this._statedElements.includes(o)&&o.removeState(e)}))})}}const registerElementActive=()=>{Factory.registerInteraction(ElementActive.type,ElementActive)},registerElementSelect=()=>{mixin(ElementSelect,ToggleStateMixin),Factory.registerInteraction(ElementSelect.type,ElementSelect)},registerElementHighlight=()=>{mixin(ElementHighlight,ToggleStateMixin),Factory.registerInteraction(ElementHighlight.type,ElementHighlight)},registerElementHighlightByKey=()=>{Factory.registerInteraction(ElementHighlightByKey.type,ElementHighlightByKey)},registerElementHighlightByGroup=()=>{Factory.registerInteraction(ElementHighlightByGroup.type,ElementHighlightByGroup)},registerElementActiveByLegend=()=>{Factory.registerInteraction(ElementActiveByLegend.type,ElementActiveByLegend)},registerElementHighlightByLegend=()=>{Factory.registerInteraction(ElementHighlightByLegend.type,ElementHighlightByLegend)},registerElementHighlightByName=()=>{Factory.registerInteraction(ElementHighlightByName.type,ElementHighlightByName)},parseOptionValue=(r,e)=>isGrammar(r)?r.output():r&&isObject$1(r)?isFunction(r.callback)?i=>r.callback(i,e):isFunction(r.value)?r.value(e):r:r,parseOptions=(r,e)=>r&&(isObject$1(r)?Object.keys(r).reduce((i,n)=>{const o=r[n];return i[n]=parseOptionValue(o,e),i},{}):r.map(i=>parseOptionValue(i,e)));let grammarBaseId=-1;class GrammarBase extends EventEmitter{constructor(e){super(),this.spec={},this.references=new Map,this.targets=[],this.transforms=[],this.view=e,this.uid=++grammarBaseId}parse(e){return this.id(e.id),this.name(e.name),this.depend(e.dependency),this}depend(e){var i;if(!((i=this.spec)===null||i===void 0)&&i.dependency){const o=array(this.spec.dependency).map(l=>isString(l)?this.view.getGrammarById(l):l);this.detach(o)}this.spec.dependency=e;const n=array(e).map(o=>isString(o)?this.view.getGrammarById(o):o);return this.attach(n),this.commit(),this}addEventListener(e,i,n){let o=i;return n&&n.trap===!1||(o=i,o.raw=i),n&&n.target&&(o.target=n.target),this.on(e,o),this}removeEventListener(e,i){return i?this.off(e,i):this.off(e),this}emit(e,...i){var n,o;return(o=(n=this.view)===null||n===void 0?void 0:n.emit)===null||o===void 0||o.call(n,e,...i),super.emit(e,...i)}emitGrammarEvent(e,...i){return super.emit(e,...i)}evaluateTransform(e,i,n){if(!e||!e.length)return i;let o=i,l=0;const d=e.length;for(;l<d;){const u=e[l];this.emit(HOOK_EVENT.BEFORE_TRANSFORM,u.type),o=u.transform(u.isRawOptions?u.options:parseOptions(u.options,n),o,n,this.view),l++,this.emit(HOOK_EVENT.AFTER_TRANSFORM,u.type)}return o}set(e){return!1}id(e){return arguments.length?(this.view.grammars.unrecord(this),this._id=e,this.view.grammars.record(this),this):this._id}name(e){return arguments.length?(this._name=e,this):this._name}attach(e,i=1){return array(e).filter(n=>!isNil(n)).forEach(n=>{var o;isNil(e)||(n.targets.includes(this)||n.targets.push(this),this.references.set(n,((o=this.references.get(n))!==null&&o!==void 0?o:0)+i))}),this}detach(e,i=1){return array(e).filter(n=>!isNil(n)).forEach(n=>{const o=this.references.get(n)-i;o>0?this.references.set(n,o-1):(this.references.delete(n),n.targets.includes(this)&&(n.targets=n.targets.filter(l=>l!==this)))}),this}detachAll(){this.references.forEach((e,i)=>{this.detach(i,e)})}link(e){this.grammarSource=e}run(){var e;const i=(e=this.grammarSource)===null||e===void 0?void 0:e.output(),n=this.parameters();return this.evaluate(i,n)}commit(){this.view.commit(this)}parameters(){const e={};return this.references.forEach((i,n)=>{isValid(n.id())&&(e[n.id()]=n.output())}),e}getSpec(){return this.spec}reuse(e){return this}clear(){this.spec=null,this.view=null}release(){this.clear()}setFunctionSpec(e,i){return isNil(this.spec[i])||this.detach(parseFunctionType(this.spec[i],this.view)),this.spec[i]=e,this.attach(parseFunctionType(e,this.view)),this.commit(),this}}const parseSimpleOptionValue=(r,e,i)=>{var n;if(r==="callback"&&isFunction(e))return{references:[],value:{callback:e,dependency:[]}};if(!isNil(e.data)){const o=i.getDataById(e.data);return{references:[o],value:o}}if(!isNil(e.customized)){const o=i.getCustomizedById(e.customized);return{references:[o],value:o}}if(!isNil(e.scale)){const o=i.getScaleById(e.scale);return{references:[o],value:o}}if(isSignal(e)){const o=parseFunctionType(e,i);return{references:o,value:e.callback?{value:e.callback,dependency:o}:(n=o==null?void 0:o[0])!==null&&n!==void 0?n:e}}return{value:e}},parseTransformOption=(r,e,i)=>{if(isNil(e))return{value:e};if(isArray(e)){const n=e.map(o=>parseSimpleOptionValue(r,o,i));return{references:n.reduce((o,l)=>(l.references&&o.concat(l.references),o),[]),value:n.map(o=>o.value)}}return parseSimpleOptionValue(r,e,i)},parseTransform=(r,e)=>{const i=Factory.getTransform(r.type);if(!i)return;const n={};let o=[];return Object.keys(r).forEach(l=>{var d;if(l==="type")return;const u=r[l];if(l==="dependency")return void((u==null?void 0:u.length)&&(o=o.concat(parseReference(u,e))));const f=parseTransformOption(l,u,e);f&&(!((d=f.references)===null||d===void 0)&&d.length&&(o=o.concat(f.references)),n[l]=f.value)}),{markPhase:i.markPhase,transform:i.transform,canProgressive:i.canProgressive,type:i.type,options:n,references:o}},parseTransformSpec=(r,e)=>{if(r!=null&&r.length){const i=[];let n=[];return r.forEach(o=>{var l;const d=parseTransform(o,e);d&&(!((l=d.references)===null||l===void 0)&&l.length&&(n=n.concat(d.references)),i.push(d))}),{transforms:i,refs:n}}return null},jsonParser=(r,e={},i)=>{if(!isString(r))return array(r);try{return array(JSON.parse(r))}catch{return[]}},parsers={csv:csvParser,dsv:dsvParser,tsv:tsvParser,json:jsonParser},parseFormat=(r,e)=>{if(!e||!parsers[e.type])return array(r);const i=e.type==="dsv"?{delimiter:e.delimiter}:{};return parsers[e.type](r,i,new DataView(new DataSet))};class Data extends GrammarBase{constructor(e,i,n){super(e),this.grammarType="data",this.spec={},this._dataIDKey=`VGRAMMAR_DATA_ID_KEY_${this.uid}`,this._loadTasks=[],this._postFilters=[],this.ingest=o=>{const l=invokeParameterFunctionType(o.format,this.parameters());return this._input=parseFormat(o.values,l),this._input},this.load=o=>{if(o.values)return this.ingest(o)},this.relay=o=>o[0],this._loadTasks=[],isNil(i)||this.values(i,n)}parse(e){return super.parse(e),this._isLoaded=!1,this.source(e.source,e.format,!1),this.url(e.url,e.format,!1),this.values(e.values,e.format,!1),this.transform(e.transform),this.parseLoad(e),this.commit(),this}parseDataSource(e){const i=[],n=[],o=e.format?parseFunctionType(e.format,this.view)[0]:null;if(o&&i.push(o),e.values){const l=parseFunctionType(e.values,this.view)[0];l&&i.push(l),n.push({type:"ingest",transform:this.ingest,isRawOptions:!0,options:{values:e.values,format:e.format}})}else if(e.url){const l=parseFunctionType(e.url,this.view)[0];l&&i.push(l),n.push({type:"load",transform:this.load,options:{url:l??e.url,format:o??e.format}})}else if(e.source){const l=[];array(e.source).forEach(d=>{const u=isGrammar(d)?d:this.view.getDataById(d);u&&(i.push(u),l.push(u))}),l.length&&(n.push({type:"relay",transform:this.relay,options:l}),this.grammarSource=l[0])}return{transforms:n,refs:i}}evaluate(e,i){this.view.emit(HOOK_EVENT.BEFORE_EVALUATE_DATA);const n=this._isLoaded?this.transforms:this._loadTasks.concat(this.transforms);this.grammarSource&&(this._input=e);const o=this.evaluateTransform(n,this._input,i),l=this._evaluateFilter(o,i);return this.setValues(l),this._isLoaded=!0,this.view.emit(HOOK_EVENT.AFTER_EVALUATE_DATA),this}output(){return this._values}getDataIDKey(){return this._dataIDKey}values(e,i,n=!0){const o=Object.assign({},this.spec,{values:e,format:i});return isNil(e)||(o.url=void 0,o.source=void 0),n?this.parseLoad(o):this}url(e,i,n=!0){const o=Object.assign({},this.spec,{url:e,format:i});return isNil(e)||(o.values=void 0,o.source=void 0),n?this.parseLoad(o):this}source(e,i,n=!0){const o=Object.assign({},this.spec,{source:e,format:i});return isNil(e)||(o.values=void 0,o.url=void 0),n?this.parseLoad(o):this}parseLoad(e){this.detach(this.parseDataSource(this.spec).refs),this.spec=e;const i=this.parseDataSource(this.spec);return this.attach(i.refs),this._loadTasks=i.transforms,this._isLoaded=!1,this.commit(),this}setValues(e){this._values=array(e).map((i,n)=>{const o=i===Object(i)?i:{data:i};return o[this._dataIDKey]=n,o})}field(e){return this._values.map(i=>i[e])}transform(e){const i=parseTransformSpec(this.spec.transform,this.view);i&&(this.detach(i.refs),this.transforms=[]),this.spec.transform=e;const n=parseTransformSpec(this.spec.transform,this.view);return n&&(this.attach(n.refs),this.transforms=n.transforms),this.commit(),this}getValue(){return this._values}getInput(){return this._input}addDataFilter(e){return this._postFilters=this._postFilters.concat(array(e)),this._postFilters.sort((i,n)=>{var o,l;return((o=i.rank)!==null&&o!==void 0?o:0)-((l=n.rank)!==null&&l!==void 0?l:0)}),this}removeDataFilter(e){const i=array(e);return this._postFilters=this._postFilters.filter(n=>!i.includes(n)),this}_evaluateFilter(e,i){return this._postFilters.reduce((n,o)=>o.filter(n,i),e)}reuse(e){return e.grammarType!==this.grammarType||(this._isLoaded=!1,this._values=e.output()),this}clear(){super.clear(),this._input=null,this._values=null}}function moveToHead(r,e,i,n){let o,l;const d=r[e];for(;e>i&&(l=Math.floor((e-1)/2),o=r[l],d&&o&&n(d,o)<0);)r[e]=o,e=l;return r[e]=d}function moveToTail(r,e,i,n){const o=e,l=r.length,d=r[e];let u,f=2*e+1;for(;f<l;)u=f+1,u<l&&n(r[f],r[u])>=0&&(f=u),r[e]=r[f],f=2*(e=f)+1;return r[e]=d,moveToHead(r,e,o,n)}class Heap{constructor(e){this.compare=e,this.nodes=[]}size(){return this.nodes.length}last(){return this.nodes[0]}validate(){for(let e=this.nodes.length-1;e>0;e-=1){const i=Math.floor((e-1)/2);if(this.compare(this.nodes[i],this.nodes[e])>0)return!1}return!0}push(e){if(this.nodes.includes(e)){const i=this.nodes.indexOf(e);return moveToHead(this.nodes,i,0,this.compare),moveToTail(this.nodes,i,null,this.compare)}return this.nodes.push(e),moveToHead(this.nodes,this.nodes.length-1,0,this.compare)}remove(e){if(this.nodes.includes(e)){const i=this.nodes.indexOf(e);this.nodes=this.nodes.slice(0,i).concat(this.nodes.slice(i+1)),moveToHead(this.nodes,i,0,this.compare),moveToTail(this.nodes,i,null,this.compare)}}pop(){const e=this.nodes.pop();let i;return this.nodes.length?(i=this.nodes[0],this.nodes[0]=e,moveToTail(this.nodes,0,null,this.compare)):i=e,i}clear(){this.nodes=[]}}class UniqueList{constructor(e){this.list=[],this.ids={},this.idFunc=e||identity$1}add(e){const i=this.idFunc(e);return this.ids[i]||(this.ids[i]=1,this.list.push(e)),this}remove(e){const i=this.idFunc(e);return this.ids[i]&&(this.ids[i]=0,this.list=this.list.filter(n=>n!==e)),this}forEach(e,i){i?this.list.slice().reverse().forEach(e):this.list.forEach(e)}filter(e){return this.list.filter(e)}get length(){return this.list.length}getElementByIndex(e){return this.list[e]}}class Dataflow{constructor(){this.grammars=[],this.logger=Logger.getInstance(),this._curRank=0,this._committed=new UniqueList(e=>e.uid),this._heap=new Heap((e,i)=>(e==null?void 0:e.qrank)-(i==null?void 0:i.qrank)),this._beforeRunner=null,this._afterRunner=null,this._updateCounter=0,this._finishFirstRender=!1}add(e){if(e)return this._setRankOfGrammar(e),this.commit(e),!this.grammars.includes(e)&&(this.grammars.push(e),!0)}remove(e){e&&(this._committed.remove(e),this._heap.remove(e),this.grammars=this.grammars.filter(i=>i!==e))}_setRankOfGrammar(e){e&&(e.rank=++this._curRank)}_reRank(e){const i=[e];for(;i.length;){const n=i.pop();this._setRankOfGrammar(n);const o=n.targets;o&&o.forEach(l=>{i.push(l),l===e&&this.logger.error("Cycle detected in dataflow graph.")})}}_enqueue(e){e&&(e.qrank=e.rank,this._heap.push(e))}_logGrammarRunInfo(e){if(this.logger.canLogError()){const i=[{key:"id",value:e.id()},{key:"name",value:e.name()}].reduce((n,o,l)=>isNil(o.value)?n:`${n}${l?" , ":""}${o.key}: ${o.value}`,"");this.logger.debug("Run Operator: ",e,i)}}hasCommitted(){return!!this._committed.length}commit(e){return this._committed.add(e),this}_beforeEvaluate(){this.grammars.forEach(e=>{e.targets.some(i=>(i==null?void 0:i.rank)<(e==null?void 0:e.rank))&&this._reRank(e)}),this._committed.forEach(e=>this._enqueue(e)),this._committed=new UniqueList(e=>e.uid)}_enqueueTargets(e){e.targets&&e.targets.length&&this._finishFirstRender&&e.targets.forEach(i=>this._enqueue(i))}evaluate(){if(this._beforeRunner&&this._beforeRunner(this),!this._committed.length)return this.logger.info("Dataflow invoked, but nothing to do."),!1;this._updateCounter+=1;let e,i,n=0;for(this.logger.canLogInfo()&&(i=Date.now(),this.logger.debug(`-- START PROPAGATION (${this._updateCounter}) -----`)),this._beforeEvaluate();this._heap.size()>0;)e=this._heap.pop(),e&&(e.rank===e.qrank?(e.run(),this._logGrammarRunInfo(e),this._enqueueTargets(e),n+=1):this._enqueue(e));return this.logger.canLogInfo()&&(i=Date.now()-i,this.logger.info(`> ${n} grammars updated; ${i} ms`)),this._afterRunner&&this._afterRunner(this),this._finishFirstRender=!0,!0}runBefore(e){this._beforeRunner=e}runAfter(e){this._afterRunner=e}release(){this._heap&&(this._heap.clear(),this._heap=null),this.logger=null,this._committed=null}}const traverseMarkTree=(r,e,i,n,o)=>{const l=d=>{if(o||!d||n&&!n(d)||i.call(null,d),d.markType===GrammarMarkType.group){const u=d[e];u&&u.forEach(f=>{l(f)})}o&&(!d||n&&!n(d)||i.call(null,d))};l(r)};class CanvasRenderer{constructor(e){this.handleAfterNextRender=()=>{this._stage&&!this._viewOptions.disableDirtyBounds&&this._stage.enableDirtyBounds(),this._view.emit(HOOK_EVENT.AFTER_VRENDER_DRAW),this._view.emit(HOOK_EVENT.AFTER_VRENDER_NEXT_RENDER)},this._view=e}initialize(e,i,n,o){return this._width=e,this._height=i,this._viewOptions=n,this._eventConfig=o,this.initStage(),this}stage(){var e;return(e=this._stage)!==null&&e!==void 0?e:null}gestureController(){var e;return(e=this._gestureController)!==null&&e!==void 0?e:null}canvas(){return this._stage?this._stage.window.getNativeHandler().nativeCanvas:null}context(){return this._stage?this._stage.window.getContext().nativeContext:null}combineIncrementalLayers(){return this._stage&&waitForAllSubLayers(this._stage).then(()=>{this._stage&&this._stage.defaultLayer.combineSubLayer()}),this}background(e){if(this._stage)return this._stage.background=e,this}setDpr(e,i){var n,o;return(o=(n=this._stage)===null||n===void 0?void 0:n.setDpr)===null||o===void 0||o.call(n,e),i&&this.renderNextFrame(),this}shouldResize(e,i){return e!==this._width||i!==this._height}resize(e,i){return this._view.emit(HOOK_EVENT.BEFORE_STAGE_RESIZE),this.shouldResize(e,i)&&(this._width=e,this._height=i,this._stage&&this._stage.resize(e,i)),this._view.emit(HOOK_EVENT.AFTER_STAGE_RESIZE),this}setViewBox(e,i=!0){return this._stage?(!e||this._viewBox&&e.x1===this._viewBox.x1&&e.x2===this._viewBox.x2&&e.y1===this._viewBox.y1&&e.y2===this._viewBox.y2||(this._viewBox=e,this._stage.setViewBox(e.x1,e.y1,e.x2-e.x1,e.y2-e.y1,i)),this):this}render(e=!1){return this._view.emit(HOOK_EVENT.BEFORE_VRENDER_DRAW),this.initStage(),this._stage.disableDirtyBounds(),this._stage.afterNextRender(this.handleAfterNextRender),e&&(this._stage.render(),this._view.emit(HOOK_EVENT.AFTER_VRENDER_DRAW)),this}renderNextFrame(){return this.initStage(),this._stage.renderNextFrame(),this}toCanvas(){return this._stage?this._stage.toCanvas():null}preventRender(e){this._stage&&this._stage.preventRender(e)}release(){var e;this._view.traverseMarkTree(i=>{i.release()}),this._dragController&&this._dragController.release(),this._gestureController&&this._gestureController.release(),this._stage!==((e=this._viewOptions)===null||e===void 0?void 0:e.stage)&&this._stage.release(),this._stage=null,this._layer=null,this._dragController=null,this._gestureController=null}createStage(){var e,i,n,o,l;this._view.emit(HOOK_EVENT.BEFORE_CREATE_VRENDER_STAGE);const d=this._viewOptions,u=(e=d.stage)!==null&&e!==void 0?e:createStage({width:this._width,height:this._height,renderStyle:d.renderStyle,viewBox:d.viewBox,dpr:d.dpr,canvas:d.renderCanvas,canvasControled:d.canvasControled,container:d.container,title:d.rendererTitle,beforeRender:d.beforeRender,afterRender:d.afterRender,disableDirtyBounds:!0,autoRender:!0,pluginList:d.pluginList,enableHtmlAttribute:d.enableHtmlAttribute,optimize:d.optimize,ticker:d.ticker,supportsTouchEvents:d.supportsTouchEvents,supportsPointerEvents:d.supportsPointerEvents,event:{clickInterval:this._eventConfig.clickInterval,autoPreventDefault:!!this._eventConfig.autoPreventDefault},ReactDOM:d.ReactDOM,autoRefresh:d.autoRefresh});!((i=d.options3d)===null||i===void 0)&&i.enable&&u.set3dOptions(d.options3d),u.enableIncrementalAutoRender(),this._viewBox=d.viewBox,this._view.emit(HOOK_EVENT.AFTER_CREATE_VRENDER_STAGE),this._view.emit(HOOK_EVENT.BEFORE_CREATE_VRENDER_LAYER);const f=(n=d.layer)!==null&&n!==void 0?n:u.defaultLayer;if(this._view.emit(HOOK_EVENT.AFTER_CREATE_VRENDER_LAYER),!((o=this._eventConfig)===null||o===void 0)&&o.drag&&Factory.getStageEventPlugin("drag")&&(this._dragController=new(Factory.getStageEventPlugin("drag"))(u)),((l=this._eventConfig)===null||l===void 0?void 0:l.gesture)&&Factory.getStageEventPlugin("gesture")){const g=isObject$1(this._eventConfig.gesture)?this._eventConfig.gesture:{};this._gestureController=new(Factory.getStageEventPlugin("gesture"))(u,g)}return{stage:u,layer:f}}initStage(){if(!this._stage){const{stage:e,layer:i}=this.createStage();this._stage=e,this._layer=i;const n=this._view.background();this.background(n)}}}const EVENT_SOURCE_WINDOW="window",EVENT_SOURCE_VIEW="view",BROWSER="browser",SIGNAL_WIDTH="width",SIGNAL_HEIGHT="height",SIGNAL_VIEW_WIDTH="viewWidth",SIGNAL_VIEW_HEIGHT="viewHeight",SIGNAL_PADDING="padding",SIGNAL_VIEW_BOX="viewBox",SIGNAL_AUTOFIT="autoFit",NAME_PREFIX="@",ID_PREFIX="#";function getExtendedEvents(r,e,i,n){var o,l;let d=(o=e.target)===null||o===void 0?void 0:o[BridgeElementKey];if(!d&&n===EVENT_SOURCE_VIEW){let u=e.target;const f=(l=r.rootMark)===null||l===void 0?void 0:l.graphicItem;for(;u!=null&&u.parent&&u.parent!==f;)if(u=u.parent,u[BridgeElementKey]){d=u[BridgeElementKey];break}}return e.element=d,e}class Signal extends GrammarBase{constructor(){super(...arguments),this.grammarType="signal",this.spec={value:null,update:null}}parse(e){return super.parse(e),this.value(e.value),this.update(e.update),this.commit(),this}evaluate(e,i){return this._signal=this.spec.update?invokeFunctionType(this.spec.update,i,this._signal):this.spec.value,this.spec.value=this._signal,this}output(){return this._signal}getValue(){return this.output()}set(e){if(isArray(e)&&isArray(this.value)&&e.length===this.value.length){for(let i=0;i<e.length;i++)if(this.value[i]!==e[i])return this._signal=e,this.spec.value=e,!0;return!1}return this._signal!==e&&(this._signal=e,this.spec.value=e,!0)}update(e){return isNil(e)||this.value(void 0),this.setFunctionSpec(e,"update")}value(e){return isNil(e)||this.update(void 0),this.spec.value=e,this.commit(),this}reuse(e){return e.grammarType!==this.grammarType||(this._signal=e.output()),this}clear(){super.clear(),this._signal=null}}let markBaseId=-1;const BuiltInSignalID=[SIGNAL_WIDTH,SIGNAL_HEIGHT,SIGNAL_PADDING,SIGNAL_VIEW_WIDTH,SIGNAL_VIEW_HEIGHT,SIGNAL_VIEW_BOX,SIGNAL_AUTOFIT],builtInSignals=(r,e,i)=>{var n,o,l,d,u;return[{id:SIGNAL_WIDTH,value:(n=r[SIGNAL_WIDTH])!==null&&n!==void 0?n:0},{id:SIGNAL_HEIGHT,value:(o=r[SIGNAL_HEIGHT])!==null&&o!==void 0?o:0},{id:SIGNAL_PADDING,value:normalizePadding((d=(l=r[SIGNAL_PADDING])!==null&&l!==void 0?l:e[SIGNAL_PADDING])!==null&&d!==void 0?d:i==null?void 0:i.padding)},{id:SIGNAL_VIEW_WIDTH,update:{callback:(f,g)=>{const _=normalizePadding(g[SIGNAL_PADDING]);return g[SIGNAL_WIDTH]-_.left-_.right},dependency:[SIGNAL_WIDTH,SIGNAL_PADDING]}},{id:SIGNAL_VIEW_HEIGHT,update:{callback:(f,g)=>{const _=normalizePadding(g[SIGNAL_PADDING]);return g[SIGNAL_HEIGHT]-_.top-_.bottom},dependency:[SIGNAL_HEIGHT,SIGNAL_PADDING]}},{id:SIGNAL_VIEW_BOX,update:{callback:(f,g)=>{const _=normalizePadding(g[SIGNAL_PADDING]);return(f||new Bounds).setValue(_.left,_.top,_.left+g[SIGNAL_VIEW_WIDTH],_.top+g[SIGNAL_VIEW_HEIGHT])},dependency:[SIGNAL_VIEW_WIDTH,SIGNAL_VIEW_HEIGHT,SIGNAL_PADDING]}},{id:SIGNAL_AUTOFIT,value:(u=r[SIGNAL_AUTOFIT])!==null&&u!==void 0?u:e[SIGNAL_AUTOFIT]}]},normalizePadding=r=>{var e,i,n,o;return isNumber(r)?{top:r,bottom:r,left:r,right:r}:{top:(e=r==null?void 0:r.top)!==null&&e!==void 0?e:0,bottom:(i=r==null?void 0:r.bottom)!==null&&i!==void 0?i:0,left:(n=r==null?void 0:r.left)!==null&&n!==void 0?n:0,right:(o=r==null?void 0:r.right)!==null&&o!==void 0?o:0}},normalizeMarkTree=r=>{var e;const i=(n,o)=>{var l,d;n.group=o;const u=(l=n.id)!==null&&l!==void 0?l:"VGRAMMAR_MARK_"+ ++markBaseId;n.id=u,((d=n.marks)!==null&&d!==void 0?d:[]).forEach(f=>i(f,u))};return((e=r.marks)!==null&&e!==void 0?e:[]).forEach(n=>i(n,"root")),r},normalizeRunningConfig=r=>{var e,i,n,o,l;const{reuse:d=DefaultReuse,morph:u=DefaultMorph,morphAll:f=DefaultMorphAll,animation:g={},enableExitAnimation:_=DefaultEnableExitAnimation}=r??{};return{reuse:d,morph:u,morphAll:f,animation:{easing:(e=g.easing)!==null&&e!==void 0?e:DefaultAnimationEasing,delay:(i=g.delay)!==null&&i!==void 0?i:DefaultAnimationDelay,duration:(n=g.duration)!==null&&n!==void 0?n:DefaultAnimationDuration,oneByOne:(o=g.oneByOne)!==null&&o!==void 0?o:DefaultAnimationOneByOne,splitPath:(l=g.splitPath)!==null&&l!==void 0?l:DefaultSplitPath},enableExitAnimation:_}};function configureEnvironment(r){r.mode&&vglobal.setEnv(r.mode,r.modeParams||{})}function groupData(r,e,i){const n=new Map;if(!r||r.length===0)return{keys:[],data:n};if(!e)return n.set(DefaultKey,i?r.slice().sort(i):r.slice()),{keys:DefaultGroupKeys,data:n};const o=parseField(e);if(r.length===1){const d=o(r[0]);return n.set(d,[r[0]]),{keys:[d],data:n}}const l=new Set;return r.forEach(d=>{var u;const f=o(d),g=(u=n.get(f))!==null&&u!==void 0?u:[];g.push(d),n.set(f,g),l.add(f)}),i&&l.forEach(d=>{n.get(d).sort(i)}),{keys:Array.from(l),data:n}}class Differ{constructor(e,i,n){this.prevData=e!=null&&e.length?groupData(e,i??null,n):null}setCurrentData(e){this.currentData=e}getCurrentData(){return this.currentData}doDiff(){if(this.callback)if(this.currentData&&this.prevData){const e=new Map(this.prevData.data);this.currentData.keys.forEach(i=>{this.callback(i,this.currentData.data.get(i),e.get(i)),e.delete(i)}),this.prevData.keys.forEach(i=>{e.has(i)&&this.callback(i,null,e.get(i))})}else this.currentData?this.currentData.keys.forEach(e=>{this.callback(e,this.currentData.data.get(e),null)}):this.prevData&&this.prevData.keys.forEach(e=>{this.callback(e,null,this.prevData.data.get(e))})}setCallback(e){this.callback=e}updateToCurrent(){this.prevData=this.currentData,this.currentData=null}reset(){this.prevData=null}}function diffSingle(r,e,i){const n={enter:[],exit:[],update:[]},o=new Differ(r,i);return o.setCallback((l,d,u)=>{isNil(d)?n.exit.push({prev:u[0]}):isNil(u)?n.enter.push({next:d[0]}):n.update.push({next:d[0],prev:u[0]})}),o.setCurrentData(groupData(e,i)),o.doDiff(),n}class Mark extends GrammarBase{constructor(e,i,n){super(e),this.grammarType="mark",this.elements=[],this.elementMap=new Map,this.isUpdated=!0,this._isReentered=!1,this.differ=new Differ([]),this.markType=i,this.spec.type=i,this.spec.encode={update:{}},this.spec.group=n,n&&(this.group=n,this.attach(n),n.appendChild(this))}parse(e){var i,n,o;if(super.parse(e),this.spec.group){const d=isString(this.spec.group)?this.view.getMarkById(this.spec.group):this.spec.group;this.detach(d)}const l=isString(e.group)?this.view.getMarkById(e.group):e.group;return this.attach(l),this.join((i=e.from)===null||i===void 0?void 0:i.data,e.key,e.sort,e.groupBy,e.groupSort),this.coordinate(e.coordinate),this.state(e.state,this.spec.stateSort),Object.keys((n=this.spec.encode)!==null&&n!==void 0?n:{}).forEach(d=>{this.encodeState(d,{},!0)}),Object.keys((o=e.encode)!==null&&o!==void 0?o:{}).forEach(d=>{this.encodeState(d,e.encode[d])}),this.animation(e.animation),this.animationState(e.animationState),this.morph(e.morph,e.morphKey,e.morphElementKey),this.layout(e.layout),this.configure(e),this.transform(e.transform),this.parseAddition(e),this.spec=e,this.markType=e.type,this.commit(),this}parameters(){var e;return(e=this._finalParameters)!==null&&e!==void 0?e:super.parameters()}parseAddition(e){return this}reuse(e){var i;if(e.grammarType!==this.grammarType)return this;const n=e;return this.markType=n.markType,this.coord=n.coord,this.elementMap=n.elementMap,this.elements=n.elements,this.elementMap.forEach(o=>o.mark=this),this.differ=n.differ,(i=this.reuseAnimate)===null||i===void 0||i.call(this,n),this._context=n._context,this.graphicItem=n.graphicItem,this.graphicIndex=n.graphicIndex,this.graphicParent=n.graphicParent,this.needClear=n.needClear,this.isUpdated=n.isUpdated,this}needLayout(){return!isNil(this.spec.layout)}handleLayoutEnd(){}handleRenderEnd(){this.needClear&&(this.cleanExitElements(),this.elementMap.forEach(e=>{e.diffState===DiffState.exit?e.clearGraphicAttributes():e.clearChangedGraphicAttributes()}),this.differ.updateToCurrent(),this.needClear=!1)}evaluateMainTasks(e,i){var n,o;if(this.needSkipBeforeLayout()&&this.view.getLayoutState()===LayoutState.before)return this;const l=(n=this.view.renderer)===null||n===void 0?void 0:n.stage();this.init(l,i);const d=this.evaluateTransform(this._getTransformsBeforeJoin(),e??DefaultMarkData,i),u=d==null?void 0:d.progressive;if(u?this.renderContext={large:!1}:(this.evaluateGroup(d),this.renderContext=this.parseRenderContext(d,i)),(o=this.renderContext)===null||o===void 0?void 0:o.progressive)this.differ.reset(),this.elementMap.clear(),this.evaluateProgressive();else{let f=null;if(u){if(this.renderContext.parameters=i,this.renderContext.beforeTransformProgressive=d.progressive,f=d.progressive.output(),d.progressive.canAnimate&&d.progressive.unfinished())return this.update(this.spec),this}else f=d;this.emit(HOOK_EVENT.BEFORE_MARK_JOIN),this.evaluateJoin(f),this.emit(HOOK_EVENT.AFTER_MARK_JOIN),this.emit(HOOK_EVENT.BEFORE_MARK_STATE),this.evaluateState(this.elements,this.spec.state,i),this.emit(HOOK_EVENT.AFTER_MARK_STATE),this.emit(HOOK_EVENT.BEFORE_MARK_ENCODE),this.evaluateEncode(this.elements,this._getEncoders(),i),this.emit(HOOK_EVENT.AFTER_MARK_ENCODE)}return this.update(this.spec),this}evaluateGroup(e){if(this.markType===GrammarMarkType.group)return;const i=groupData(e??DefaultMarkData,this.spec.groupBy,this.spec.groupSort);this._groupEncodeResult=null,this._groupedData=i}_getTransformsAfterEncodeItems(){return this.transforms&&this.transforms.filter(e=>e.markPhase==="afterEncodeItems")}_getTransformsAfterEncode(){return this.transforms&&this.transforms.filter(e=>isNil(e.markPhase)||e.markPhase==="afterEncode")}_getTransformsBeforeJoin(){return this.transforms?this.transforms.filter(e=>e.markPhase==="beforeJoin"):[]}evaluate(e,i){var n;return this.evaluateMainTasks(e,i),!((n=this.renderContext)===null||n===void 0)&&n.progressive||this.evaluateTransform(this._getTransformsAfterEncode(),this.elements,i),this}output(){return this}join(e,i,n,o,l){return this.grammarSource&&(this.detach(this.grammarSource),this.grammarSource=null),this.spec.from=null,isNil(e)||(isString(e)?this.grammarSource=this.view.getDataById(e):this.grammarSource=e,this.spec.from={data:e},this.attach(this.grammarSource)),this.spec.key=i,this.spec.sort=n,this.spec.groupBy=o,this.spec.groupSort=l,this.commit(),this}coordinate(e){return isString(e)?this.coord=this.view.getCoordinateById(e):this.coord=e,this.attach(this.coord),this.commit(),this}state(e,i){return this.spec.stateSort=i,this.setFunctionSpec(e,"state")}encode(e,i,n){return this.encodeState(DiffState.update,e,i,n)}encodeState(e,i,n,o){if(e===DiffState.enter&&(this._isReentered=!0),this.spec.encode[e]){const l=this.spec.encode[e];if(isFunctionType(l))this.detach(parseEncodeType(l,this.view));else{const d=isString(i);d&&o||!d&&n?(Object.keys(l).forEach(u=>{this.detach(parseEncodeType(l[u],this.view))}),this.spec.encode[e]={}):d?this.detach(parseEncodeType(l[i],this.view)):Object.keys(i).forEach(u=>{this.detach(parseEncodeType(l[u],this.view))})}}return i&&(this.spec.encode[e]||(this.spec.encode[e]={}),isString(i)?(this.spec.encode[e][i]=n,this.attach(parseEncodeType(n,this.view))):isFunctionType(i)?(this.spec.encode[e]=i,this.attach(parseEncodeType(i,this.view))):i&&(Object.assign(this.spec.encode[e],i),Object.values(i).forEach(l=>{this.attach(parseEncodeType(l,this.view))}))),this.commit(),this}_getEncoders(){var e;return(e=this.spec.encode)!==null&&e!==void 0?e:{}}animation(e){return this.spec.animation=e,this}animationState(e){return this.setFunctionSpec(e,"animationState")}layout(e){return this.spec.layout=e,this.commit(),this}morph(e,i,n){return this.spec.morph=e,this.spec.morphKey=i,this.spec.morphElementKey=n,this}transform(e){const i=parseTransformSpec(this.spec.transform,this.view);i&&(this.detach(i.refs),this.transforms=[]);const n=parseTransformSpec(e,this.view);return n&&(this.attach(n.refs),this.transforms=n.transforms),this.spec.transform=e,this.commit(),this}configure(e){const i=["clip","clipPath","zIndex","interactive","context","setCustomizedShape","large","largeThreshold","progressiveStep","progressiveThreshold","support3d","morph","morphKey","morphElementKey","attributeTransforms","skipTheme","enableSegments","stateSort","graphicName","overflow"];return e===null?(i.forEach(n=>{isNil(this.spec[n])||(this.spec[n]=void 0)}),this):(i.forEach(n=>{isNil(e[n])||(this.spec[n]=e[n])}),this)}context(e){return this.spec.context=e,this._context=e,this}isCollectionMark(){return CollectionMarkType.includes(this.markType)}needAnimate(){var e;return!(!((e=this.renderContext)===null||e===void 0)&&e.progressive)&&!isNil(this.spec.animation)}getAllElements(){const e=this.elements.slice();return this.elementMap.forEach(i=>{i.diffState!==DiffState.exit||e.includes(i)||e.push(i)}),this.spec.sort&&e.sort((i,n)=>this.spec.sort(i.getDatum(),n.getDatum())),e}getScales(){const e={};return this.references.forEach((i,n)=>{n.grammarType===GrammarTypeEnum.scale&&(e[n.id()]=n.output())}),e}getScalesByChannel(){const e=this.spec.encode;if(!e)return{};const i={},n=this.parameters();return Object.keys(e).forEach(o=>{const l=e[o];l&&!isFunctionType(l)&&Object.keys(l).forEach(d=>{isScaleEncode(l[d])&&(i[d]=getGrammarOutput(l[d].scale,n))})}),i}getFieldsByChannel(){const e=this.spec.encode;if(!e)return{};const i={};return Object.keys(e).forEach(n=>{const o=e[n];isFunctionType(o)||Object.keys(o).forEach(l=>{isFieldEncode(o[l])&&(i[l]=o[l].field)})}),i}init(e,i){var n,o,l,d,u;if(this._delegateEvent||(this._delegateEvent=(_,y)=>{const b=getExtendedEvents(this.view,_,y,EVENT_SOURCE_VIEW),S=_.element;(S==null?void 0:S.mark)===this&&this.emitGrammarEvent(y,b,S)},this.initEvent()),(n=this.initAnimate)===null||n===void 0||n.call(this,this.spec),!this.group){const _=getGrammarOutput(this.spec.group,i);this.group=_,_&&_.appendChild(this)}const f=this.group?this.group.getGroupGraphicItem():e.defaultLayer,g=(d=(l=(o=this.group)===null||o===void 0?void 0:o.children)===null||l===void 0?void 0:l.indexOf(this))!==null&&d!==void 0?d:0;if(this.markType!==GrammarMarkType.group){if(!this.graphicItem){const _=createGraphicItem(this,GrammarMarkType.group,{pickable:!1,zIndex:(u=this.spec.zIndex)!==null&&u!==void 0?u:0,overflow:this.spec.overflow});(this.spec.support3d||Mark3DType.includes(this.markType))&&_.setMode("3d"),_.name=`${this.id()||this.markType}`,this.graphicItem=_}this.graphicParent=this.graphicItem,!f||this.graphicIndex===g&&this.graphicItem.parent===f||f.insertIntoKeepIdx(this.graphicItem,g)}else this.graphicParent=f,this.graphicParent.setAttributes({overflow:this.spec.overflow});this.graphicIndex=g}update(e){var i;if(this.emit(HOOK_EVENT.BEFORE_MARK_UPDATE),this._context=this.spec.context,this.isUpdated=!0,this.renderContext.progressive||(i=this.updateAnimate)===null||i===void 0||i.call(this,e),this.markType!==GrammarMarkType.group){if(isNil(e.zIndex)||this.graphicItem.setAttribute("zIndex",e.zIndex),isNil(e.clip)||this.graphicItem.setAttribute("clip",e.clip),!isNil(e.clipPath)){const n=isArray(e.clipPath)?e.clipPath:e.clipPath(this.elements);n&&n.length?this.graphicItem.setAttribute("path",n):this.graphicItem.setAttributes({path:n,clip:!1})}isNil(e.overflow)||this.graphicItem.setAttribute("overflow",e.overflow),this.elementMap.forEach(n=>{n.updateGraphicItem()})}else this.elementMap.forEach(n=>{n.updateGraphicItem()});this.emit(HOOK_EVENT.AFTER_MARK_UPDATE)}createElement(){return new Element$1(this)}evaluateJoin(e){var i,n,o,l;this.needClear=!0;const d=parseField((o=(i=this.spec.key)!==null&&i!==void 0?i:(n=this.grammarSource)===null||n===void 0?void 0:n.getDataIDKey())!==null&&o!==void 0?o:()=>DefaultKey),u=parseField((l=this.spec.groupBy)!==null&&l!==void 0?l:()=>DefaultKey),f=this.spec.sort,g=this.isCollectionMark(),_=new Set(this.elements.filter(S=>S.diffState===DiffState.enter)),y=[];this.differ.setCallback((S,v,A)=>{var x;const T=S;let C;if(isNil(v))C=this.elementMap.get(T),C&&(C.diffState=DiffState.exit);else if(isNil(A)){if(C=this.elementMap.has(T)?this.elementMap.get(T):this.createElement(),C.diffState===DiffState.exit){C.diffState=DiffState.enter;const P=(x=this.animate)===null||x===void 0?void 0:x.getElementAnimators(C,DiffState.exit);P&&P.forEach(R=>R.stop("start"))}C.diffState=DiffState.enter;const E=g?S:u(v[0]);C.updateData(E,v,d),this.elementMap.set(T,C),y.push(C)}else if(C=this.elementMap.get(T),C){C.diffState=DiffState.update;const E=g?S:u(v[0]);C.updateData(E,v,d),y.push(C)}_.delete(C)});const b=e??DefaultMarkData;g?this.differ.setCurrentData(this._groupedData):this.differ.setCurrentData(groupData(b,S=>`${u(S)}-${d(S)}`,void 0)),this.differ.doDiff(),_.forEach(S=>{this.elementMap.delete(g?S.groupKey:`${S.groupKey}-${S.key}`),S.remove(),S.release()}),this.elements=y,f&&this.elements.length>=2&&this.elements.sort((S,v)=>f(S.getDatum(),v.getDatum()))}evaluateState(e,i,n){i&&e.forEach(o=>{o.state(i,n)})}evaluateGroupEncode(e,i,n){if(!this._groupedData||!i)return;const o={};return this._groupedData.keys.forEach(l=>{const d=e.find(u=>u.groupKey===l);d&&(o[l]=invokeEncoder(i,d.items&&d.items[0]&&d.items[0].datum,d,n))}),this._groupEncodeResult=o,o}getChannelsFromConfig(e){const i=this.spec;return isNil(i.interactive)?null:{pickable:i.interactive}}evaluateEncode(e,i,n,o){const l=this.getChannelsFromConfig();if(i){this.emit(HOOK_EVENT.BEFORE_ELEMENT_ENCODE,{encoders:i,parameters:n},this);const d=o?null:this.evaluateGroupEncode(e,i[BuiltInEncodeNames.group],n);e.forEach(u=>{this.markType===GrammarMarkType.glyph&&this._groupEncodeResult?u.items.forEach(f=>{f.nextAttrs=Object.assign(f.nextAttrs,l,this._groupEncodeResult[u.groupKey])}):d!=null&&d[u.groupKey]&&!this.isCollectionMark()?u.items.forEach(f=>{f.nextAttrs=Object.assign(f.nextAttrs,l,d[u.groupKey])}):l&&u.items.forEach(f=>{f.nextAttrs=Object.assign(f.nextAttrs,l)}),u.encodeItems(u.items,i,this._isReentered,n),this.isCollectionMark()&&(d!=null&&d[u.groupKey])&&isValid(d[u.groupKey].defined)&&(u.items.forEach(f=>{f.nextAttrs.defined=d[u.groupKey].defined}),delete d[u.groupKey].defined)}),this._isReentered=!1,this.evaluateTransform(this._getTransformsAfterEncodeItems(),e,n),e.forEach(u=>{u.encodeGraphic(this.isCollectionMark()?d==null?void 0:d[u.groupKey]:null)}),this.emit(HOOK_EVENT.AFTER_ELEMENT_ENCODE,{encoders:i,parameters:n},this)}else e.forEach(d=>{d.initGraphicItem(l)})}addGraphicItem(e,i,n){var o;const l=n??createGraphicItem(this,this.markType,e);if(l){if(!((o=this.renderContext)===null||o===void 0)&&o.progressive){let d;if(this._groupedData){const u=this._groupedData.keys.indexOf(i);u>=0&&(d=this.graphicParent.getChildAt(u))}else d=this.graphicParent.at(0);this.isCollectionMark()?(l.incremental=1,d.appendChild(l)):d.incrementalAppendChild(l)}else this.graphicParent.appendChild(l);return l}}parseRenderContext(e,i){const n=this.markType!==GrammarMarkType.group&&this.spec.progressiveStep>0&&this.spec.progressiveThreshold>0&&this.spec.progressiveStep<this.spec.progressiveThreshold,o=this.spec.large&&this.spec.largeThreshold>0&&e.length>=this.spec.largeThreshold;if(n){const l=this._groupedData;return l&&l.keys&&l.keys.some(d=>l.data.get(d).length>this.spec.progressiveThreshold)?{large:o,parameters:i,progressive:{data:e,step:this.spec.progressiveStep,currentIndex:0,totalStep:l.keys.reduce((d,u)=>Math.max(Math.ceil(l.data.get(u).length/this.spec.progressiveStep),d),1),groupedData:l.data}}:{large:o}}return{large:o}}isProgressive(){return this.renderContext&&(!!this.renderContext.progressive||!!this.renderContext.beforeTransformProgressive)}canAnimateAfterProgressive(){return this.renderContext&&this.renderContext.beforeTransformProgressive&&this.renderContext.beforeTransformProgressive.canAnimate()}isDoingProgressive(){return this.renderContext&&(this.renderContext.progressive&&this.renderContext.progressive.currentIndex<this.renderContext.progressive.totalStep||this.renderContext.beforeTransformProgressive&&this.renderContext.beforeTransformProgressive.unfinished())}clearProgressive(){this.renderContext&&this.renderContext.progressive&&(this.elements=[],this.graphicParent.children.forEach(e=>{e.incrementalClearChild()}),this.graphicParent.removeAllChild()),this.renderContext&&this.renderContext.beforeTransformProgressive&&this.renderContext.beforeTransformProgressive.release(),this.renderContext=null}restartProgressive(){this.renderContext&&this.renderContext.progressive&&(this.renderContext.progressive.currentIndex=0)}evaluateJoinProgressive(){var e,i,n;const o=this.renderContext.progressive.currentIndex,l=parseField((n=(e=this.spec.key)!==null&&e!==void 0?e:(i=this.grammarSource)===null||i===void 0?void 0:i.getDataIDKey())!==null&&n!==void 0?n:()=>DefaultKey),d=[];if(this.isCollectionMark())return this._groupedData.keys.forEach((f,g)=>{const _=this.renderContext.progressive.groupedData.get(f),y=this.renderContext.progressive.step,b=_.slice(o*y,(o+1)*y);if(o===0){const S=this.createElement();S.diffState=DiffState.enter,S.updateData(f,b,l),d.push(S)}else{const S=this.elements[g];S.updateData(f,b,l),d.push(S)}}),d;const u={};return this._groupedData.keys.forEach(f=>{const g=this.renderContext.progressive.groupedData.get(f),_=this.renderContext.progressive.step,y=g.slice(o*_,(o+1)*_),b=[];y.forEach(S=>{const v=this.createElement();v.diffState=DiffState.enter,v.updateData(f,[S],l),b.push(v),d.push(v)}),u[f]=b}),{groupElements:u,elements:d}}evaluateEncodeProgressive(e,i,n){const o=this.renderContext.progressive.currentIndex;if(o===0){if(this.evaluateEncode(e,i,n),o===0&&this._groupEncodeResult&&!this.isCollectionMark()&&this.markType!==GrammarMarkType.glyph){const l=e[0],d=l.getGraphicItem(),u=d==null?void 0:d.parent;u&&this._groupEncodeResult[l.groupKey]&&u.setTheme({common:this._groupEncodeResult[l.groupKey]})}}else this.evaluateEncode(e,i,n,!0)}evaluateProgressive(){var e,i,n;if(!((e=this.renderContext)===null||e===void 0)&&e.beforeTransformProgressive){const f=this.renderContext.beforeTransformProgressive;f.progressiveRun();const g=f.output();if(f.canAnimate){if(f.unfinished())return;this.evaluateGroup(g)}return this.emit(HOOK_EVENT.BEFORE_MARK_JOIN),this.evaluateJoin(g),this.emit(HOOK_EVENT.AFTER_MARK_JOIN),this.emit(HOOK_EVENT.BEFORE_MARK_STATE),this.evaluateState(this.elements,this.spec.state,this.renderContext.parameters),this.emit(HOOK_EVENT.AFTER_MARK_STATE),this.emit(HOOK_EVENT.BEFORE_MARK_ENCODE),this.evaluateEncode(this.elements,this._getEncoders(),this.renderContext.parameters),void this.emit(HOOK_EVENT.AFTER_MARK_ENCODE)}if(!(!((i=this.renderContext)===null||i===void 0)&&i.progressive))return;const o=this.renderContext.parameters;this.emit(HOOK_EVENT.BEFORE_MARK_JOIN);const l=this.evaluateJoinProgressive(),d=Array.isArray(l)?l:l.elements;if(this.emit(HOOK_EVENT.AFTER_MARK_JOIN),this.renderContext.progressive.currentIndex===0?(this.graphicParent.removeAllChild(),this._groupedData.keys.forEach(f=>{const g=createGraphicItem(this,GrammarMarkType.group,{pickable:!1,zIndex:this.spec.zIndex});g.incremental=this.renderContext.progressive.step,this.graphicParent.appendChild(g)}),this.elements=d):this.elements=this.elements.concat(d),this.emit(HOOK_EVENT.BEFORE_MARK_STATE),this.evaluateState(d,this.spec.state,o),this.emit(HOOK_EVENT.AFTER_MARK_STATE),this.emit(HOOK_EVENT.BEFORE_MARK_ENCODE),Array.isArray(l))this.evaluateEncodeProgressive(d,this._getEncoders(),o);else{const f=l.groupElements;Object.keys(f).forEach(g=>{this.evaluateEncodeProgressive(f[g],this._getEncoders(),o)})}this.emit(HOOK_EVENT.AFTER_MARK_ENCODE);const u=(n=this._getTransformsAfterEncode())===null||n===void 0?void 0:n.filter(f=>f.canProgressive===!0);u!=null&&u.length&&this.evaluateTransform(u,this.elements,o),this.renderContext.progressive.currentIndex+=1}isLargeMode(){return this.renderContext&&this.renderContext.large}cleanExitElements(){this.elementMap.forEach((e,i)=>{e.diffState!==DiffState.exit||e.isReserved||(this.elementMap.delete(i),e.remove(),e.release())})}getGroupGraphicItem(){if(this.elements&&this.elements[0]&&this.elements[0].getGraphicItem)return this.elements[0].getGraphicItem()}getBounds(){var e;return this.graphicItem?this.graphicItem.AABBBounds:(e=this.getGroupGraphicItem())===null||e===void 0?void 0:e.AABBBounds}getMorphConfig(){var e;return{morph:(e=this.spec.morph)!==null&&e!==void 0&&e,morphKey:this.spec.morphKey,morphElementKey:this.spec.morphElementKey}}getAttributeTransforms(){var e;return(e=this.spec.attributeTransforms)!==null&&e!==void 0?e:transformsByType[this.markType]}getContext(){return this._context}needSkipBeforeLayout(){var e,i;if(((e=this.spec.layout)===null||e===void 0?void 0:e.skipBeforeLayouted)===!0)return!0;let n=this.group;for(;n;){if(((i=n.getSpec().layout)===null||i===void 0?void 0:i.skipBeforeLayouted)===!0)return!0;n=n.group}return!1}initEvent(){if(this._delegateEvent){const e=this.view.renderer.stage();e&&e.on("*",this._delegateEvent)}}releaseEvent(){if(this._delegateEvent){const e=this.view.renderer.stage();e&&e.off("*",this._delegateEvent)}}clear(){var e;this.releaseEvent(),this.transforms=null,this.elementMap=null,this.elements=null,this.graphicItem=null,this.animate=null,(e=this.group)===null||e===void 0||e.removeChild(this),this.group=null,super.clear()}prepareRelease(){var e;this.differ.setCurrentData(null),(e=this.animate)===null||e===void 0||e.stop(),this.elementMap.forEach(i=>i.diffState=DiffState.exit),this._finalParameters=this.parameters()}release(){this.releaseEvent(),this.elements.forEach(e=>e.release()),this.differ=null,this.elements=[],this.elementMap.clear(),this._finalParameters=null,this.animate&&this.animate.release(),this.graphicItem&&removeGraphicItem(this.graphicItem),this.detachAll(),super.release()}}let GroupMark$1=class extends Mark{constructor(e,i){super(e,GrammarMarkType.group,i),this.children=[]}parseRenderContext(){return{large:!1}}appendChild(e){return this.children.push(e),this}removeChild(e){return this.children=this.children.filter(i=>i!==e),this}includesChild(e,i=!0){return!!this.children.includes(e)||!!i&&this.children.some(n=>n.markType===GrammarMarkType.group&&n.includesChild(e,!0))}updateLayoutChildren(){return this.children.length?(this.layoutChildren||(this.layoutChildren=[]),this.layoutChildren=this.children.filter(e=>e.needLayout()),this):this}getAttributeTransforms(){return transformsByType.rect}evaluateJoin(e){if(!this.elements.length){const i=this.createElement();i.updateData(DefaultKey,DefaultMarkData,()=>""),this.elements=[i],this.elementMap.set(DefaultKey,i)}}getChannelsFromConfig(e){const i=this.spec,n={};if(isNil(i.clip)||(n.clip=i.clip),isNil(i.zIndex)||(n.zIndex=i.zIndex),!isNil(i.clipPath)){const o=isFunction(i.clipPath)?i.clipPath([e]):i.clipPath;o&&o.length?n.path=o:(n.path=null,n.clip=!1)}return isNil(i.interactive)||(n.pickable=i.interactive),n}evaluateGroupEncode(e,i,n){var o;const l=this.elements[0],d={},u=[Object.assign({},(o=l.items)===null||o===void 0?void 0:o[0],{nextAttrs:d})];return invokeEncoderToItems(l,u,i,n),this._groupEncodeResult=d,d}evaluateEncode(e,i,n,o){const l=this.getChannelsFromConfig();if(i){this.emit(HOOK_EVENT.BEFORE_ELEMENT_ENCODE,{encoders:i,parameters:n},this);const d=o?null:this.evaluateGroupEncode(e,i[BuiltInEncodeNames.group],n);e.forEach(u=>{u.items.forEach(f=>{f.nextAttrs=Object.assign(f.nextAttrs,l,d)}),u.encodeItems(u.items,i,this._isReentered,n)}),this._isReentered=!1,this.evaluateTransform(this._getTransformsAfterEncodeItems(),e,n),e.forEach(u=>{u.encodeGraphic()}),this.emit(HOOK_EVENT.AFTER_ELEMENT_ENCODE,{encoders:i,parameters:n},this)}else e.forEach(d=>{d.initGraphicItem(l)})}addGraphicItem(e,i,n){const o=n??createGraphicItem(this,this.markType,e);if(o)return this.emit(HOOK_EVENT.BEFORE_ADD_VRENDER_MARK,{graphicItem:o}),o.name=`${this.id()||this.markType}`,this.graphicParent.insertIntoKeepIdx(o,this.graphicIndex),this.emit(HOOK_EVENT.AFTER_ADD_VRENDER_MARK,{graphicItem:o}),o}};class RecordedGrammars{constructor(e,i){this._grammars={signal:[],data:[],scale:[],coordinate:[],mark:[],customized:[]},this._grammarMap={signal:{},data:{},scale:{},coordinate:{},mark:{},customized:{}},this._size=0,this._mapKey=isString(e)?n=>n[e]:e,this._warning=i}record(e){var i,n;const o=e.grammarType,l=this._mapKey(e);return this._grammarMap[o]?(this._grammars[o].push(e),isNil(l)||(this._grammarMap[o][l]?(i=this._warning)===null||i===void 0||i.call(this,l,e):this._grammarMap[o][l]=e)):(this._grammars.customized.push(e),isNil(l)||(this._grammarMap.customized[l]?(n=this._warning)===null||n===void 0||n.call(this,l,e):this._grammarMap.customized[l]=e)),this._size+=1,this}unrecord(e){const i=e.grammarType,n=this._mapKey(e);return this._grammarMap[i]?(this._grammars[i]=this._grammars[i].filter(o=>o!==e),isNil(n)||this._grammarMap[i][n]!==e||delete this._grammarMap[i][n]):(this._grammars.customized=this._grammars.customized.filter(o=>o!==e),isNil(n)||this._grammarMap.customized[n]!==e||delete this._grammarMap.customized[n]),this._size-=1,this}size(){return this._size}getSignal(e){var i;return(i=this._grammarMap.signal[e])!==null&&i!==void 0?i:null}getData(e){var i;return(i=this._grammarMap.data[e])!==null&&i!==void 0?i:null}getScale(e){var i;return(i=this._grammarMap.scale[e])!==null&&i!==void 0?i:null}getCoordinate(e){var i;return(i=this._grammarMap.coordinate[e])!==null&&i!==void 0?i:null}getMark(e){var i;return(i=this._grammarMap.mark[e])!==null&&i!==void 0?i:null}getCustomized(e){var i;return(i=this._grammarMap.customized[e])!==null&&i!==void 0?i:null}getGrammar(e){return this._grammarMap.data[e]?this._grammarMap.data[e]:this._grammarMap.signal[e]?this._grammarMap.signal[e]:this._grammarMap.scale[e]?this._grammarMap.scale[e]:this._grammarMap.coordinate[e]?this._grammarMap.coordinate[e]:this._grammarMap.mark[e]?this._grammarMap.mark[e]:this._grammarMap.customized[e]?this._grammarMap.customized[e]:null}getAllSignals(){return this._grammars.signal}getAllData(){return this._grammars.data}getAllScales(){return this._grammars.scale}getAllCoordinates(){return this._grammars.coordinate}getAllMarks(){return this._grammars.mark}getAllCustomized(){return this._grammars.customized}traverse(e){var i;Object.values((i=this._grammars)!==null&&i!==void 0?i:{}).forEach(n=>(n??[]).forEach(o=>{e.call(null,o)}))}find(e){let i=null;return this.traverse(n=>e.call(null,n)===!0&&(i=n,!0)),i}filter(e){const i=[];return this.traverse(n=>{e.call(null,n)===!0&&i.push(n)}),i}clear(){this._size=0,this._grammars={signal:[],data:[],scale:[],coordinate:[],mark:[],customized:[]},this._grammarMap={signal:{},data:{},scale:{},coordinate:{},mark:{},customized:{}}}release(){this._size=0,this._grammars=null,this._grammarMap=null}}class RecordedTreeGrammars extends RecordedGrammars{constructor(){super(...arguments),this._markNodes=[]}record(e){if(super.record(e),e.grammarType==="mark"){const i=e,n={mark:i,parent:null,children:[]};this._markNodes.forEach(o=>{const l=o.mark;l.markType===GrammarMarkType.group&&l.includesChild(i,!1)?(o.children.push(n),n.parent=o):i.markType===GrammarMarkType.group&&i.includesChild(l,!1)&&(n.children.push(o),o.parent=n)}),this._markNodes.push(n)}return this}unrecord(e){if(super.unrecord(e),e.grammarType==="mark"){const i=e,n=this._markNodes.find(o=>o.mark===i);this._markNodes.forEach(o=>{o.mark.markType===GrammarMarkType.group&&o.children.includes(n)?(o.children=o.children.filter(l=>l!==n),n.parent=null):i.markType===GrammarMarkType.group&&n.children.includes(o)&&(n.children=n.children.filter(l=>l!==o),o.parent=null)}),this._markNodes=this._markNodes.filter(o=>o!==n)}return this}getAllMarkNodes(){return this._markNodes}clear(){super.clear(),this._markNodes=[]}release(){super.release(),this._markNodes=null}}class Text extends Mark{addGraphicItem(e,i){const n=e&&e.limitAttrs,o=n&&(n.textType==="rich"||n.text&&n.text.type==="rich"),l=createGraphicItem(this,o?GrammarMarkType.richtext:GrammarMarkType.text,e);return super.addGraphicItem(e,i,l)}release(){super.release()}}Text.markType=GrammarMarkType.text;const axis={label:{visible:!0,inside:!1,space:4,style:{fontSize:12,fill:"#89909d",fontWeight:"normal",fillOpacity:1}},tick:{visible:!0,inside:!1,alignWithLabel:!0,length:4,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},subTick:{visible:!1,inside:!1,count:4,length:2,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},line:{visible:!0,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},items:[],start:{x:0,y:0},end:{x:100,y:0},x:0,y:0},circleAxis={title:{space:4,padding:[0,0,0,0],textStyle:{fontSize:12,fill:"#333333",fontWeight:"normal",fillOpacity:1},text:"theta"},label:{visible:!0,inside:!1,space:4,style:{fontSize:12,fill:"#6F6F6F",fontWeight:"normal",fillOpacity:1}},tick:{visible:!0,inside:!1,alignWithLabel:!0,length:4,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},subTick:{visible:!1,inside:!1,count:4,length:2,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},line:{visible:!0,style:{lineWidth:1,stroke:"#D9DDE4",strokeOpacity:1}},items:[],startAngle:0,endAngle:2*Math.PI,radius:100,innerRadius:0,center:{x:0,y:0},x:0,y:0},grid={style:{stroke:"#f1f2f5"}},circleGrid={style:{stroke:"#f1f2f5"}},discreteLegend={layout:"vertical",title:{align:"start",space:12,textStyle:{fontSize:12,fontWeight:"bold",fill:"#2C3542"}},item:{spaceCol:10,spaceRow:10,shape:{space:4,style:{size:10,cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8",stroke:"#D8D8D8",fillOpacity:.5}}},label:{space:4,style:{fontSize:12,fill:"black",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8",fillOpacity:.5}}},value:{alignRight:!1,style:{fontSize:12,fill:"#ccc",cursor:"pointer"},state:{selectedHover:{opacity:.85},unSelected:{fill:"#D8D8D8"}}},background:{style:{cursor:"pointer"},state:{selectedHover:{fillOpacity:.7,fill:"gray"},unSelectedHover:{fillOpacity:.2,fill:"gray"}}},focus:!1,focusIconStyle:{size:10,fill:"#333",cursor:"pointer"},visible:!0,padding:{top:2,bottom:2,left:2,right:2}},autoPage:!0,pager:{space:12,handler:{style:{size:10},space:4}},hover:!0,select:!0,selectMode:"multiple",allowAllCanceled:!1,items:[{index:0,id:"",label:"",shape:{fill:"#6690F2",stroke:"#6690F2",symbolType:"circle"}}]},colorLegend={title:{visible:!1,text:""},colors:[],layout:"horizontal",railWidth:200,railHeight:8,railStyle:{cornerRadius:5}},sizeLegend={title:{visible:!1,text:""},trackStyle:{fill:"#ccc"},layout:"horizontal",align:"bottom",railWidth:200,railHeight:6,min:0,max:1,value:[0,1]},lineCrosshair={start:{x:0,y:0},end:{x:0,y:0}},rectCrosshair={start:{x:0,y:0},end:{x:0,y:0},rectStyle:{width:10,height:10}},sectorCrosshair={center:{x:0,y:0},radius:100,startAngle:0,endAngle:Math.PI/6},circleCrosshair={center:{x:0,y:0},radius:100,startAngle:0,endAngle:2*Math.PI},polygonCrosshair={center:{x:0,y:0},radius:100,startAngle:0,endAngle:2*Math.PI,sides:6},slider={layout:"horizontal",railWidth:200,railHeight:10,railStyle:{cornerRadius:5},range:{draggableTrack:!0},startText:{visible:!0,text:"",space:8},endText:{visible:!0,text:"",space:8},min:0,max:1,value:[0,1]},dataLabel={size:{width:400,height:400},dataLabels:[]},lineDataLabel$1={type:"line-data",data:[{text:""}],position:"top",overlap:{avoidBaseMark:!1,clampForce:!1},smartInvert:!1},lineLabel={type:"line",data:[{text:"",data:{}}],position:"start",overlap:{avoidBaseMark:!1,clampForce:!1,size:{width:1e3,height:1e3}},smartInvert:!1},areaLabel={type:"area",data:[{text:"",data:{}}],position:"end",overlap:{avoidBaseMark:!1,clampForce:!1,size:{width:1e3,height:1e3}},smartInvert:!1},rectLabel={type:"rect",data:[{text:"",fill:"#606773",data:{}}],position:"top",overlap:{size:{width:1e3,height:1e3},strategy:[{type:"position"}]},smartInvert:!1},symbolLabel$1={type:"symbol",data:[{text:"",fill:"#606773",data:{}}],position:"top",overlap:{avoidBaseMark:!0,size:{width:1e3,height:1e3},strategy:[{type:"position"}]},smartInvert:!1},arcLabel={type:"arc",data:[{text:"",fill:"#606773",data:{}}],width:800,height:600,position:"outside",zIndex:302},pointLabel$1={data:[{text:"",fill:"#606773",data:{}}],overlap:{avoidBaseMark:!1,clampForce:!1,size:{width:1e3,height:1e3}},smartInvert:!1},datazoom={orient:"bottom",showDetail:"auto",brushSelect:!0,start:0,end:1,position:{x:0,y:0},size:{width:500,height:40},previewData:[]},continuousPlayer={},discretePlayer={},tooltip={},title={textStyle:{fill:"#21252c"},subtextStyle:{fill:"#606773"}},scrollbar={width:12,height:12,padding:[2,2],railStyle:{fill:"rgba(0, 0, 0, .1)"}},defaultComponentTheme={axis,circleAxis,grid,circleGrid,discreteLegend,colorLegend,sizeLegend,lineCrosshair,rectCrosshair,sectorCrosshair,circleCrosshair,polygonCrosshair,slider,dataLabel,pointLabel:pointLabel$1,lineLabel,areaLabel,rectLabel,symbolLabel:symbolLabel$1,arcLabel,lineDataLabel:lineDataLabel$1,datazoom,continuousPlayer,discretePlayer,tooltip,title,scrollbar},DEFAULT_PADDING=5,defaultMarkTheme={symbol:{shape:"circle",size:8},text:{fontSize:14,fill:"#000000"}},darkComponents=Object.assign({},defaultComponentTheme);darkComponents.axis=Object.assign({},darkComponents.axis,{label:{style:{fill:"#bbbdc3"}},line:{style:{stroke:"#4b4f54"}},tick:{style:{stroke:"#4b4f54"}},subTick:{style:{stroke:"#4b4f54"}}}),darkComponents.circleAxis=Object.assign({},darkComponents.circleAxis,{label:{style:{fill:"#bbbdc3"}},line:{style:{stroke:"#4b4f54"}},tick:{style:{stroke:"#4b4f54"}},subTick:{style:{stroke:"#4b4f54"}}}),darkComponents.grid=Object.assign({},darkComponents.grid,{style:{stroke:"#404349"}}),darkComponents.circleGrid=Object.assign({},darkComponents.circleGrid,{style:{stroke:"#404349"}}),darkComponents.rectLabel=Object.assign({},darkComponents.rectLabel,{data:[{text:"",fill:"#888c93",data:{}}]}),darkComponents.lineLabel=Object.assign({},darkComponents.lineLabel,{data:[{text:"",fill:"#888c93",data:{}}]}),darkComponents.symbolLabel=Object.assign({},darkComponents.symbolLabel,{data:[{text:"",fill:"#888c93",data:{}}]}),darkComponents.title=Object.assign({},darkComponents.title,{textStyle:{fill:"#fdfdfd"},subtextStyle:{fill:"#888c93"}});const darkTheme={name:"dark",padding:DEFAULT_PADDING,background:"#202226",palette:{default:["#5383F4","#7BCF8E","#FF9D2C","#FFDB26","#7568D9","#80D8FB","#1857A3","#CAB0E8","#FF8867","#B9E493","#2CB4A8","#B9E4E3"]},marks:defaultMarkTheme,components:darkComponents},defaultTheme={name:"default",padding:DEFAULT_PADDING,palette:{default:["#6690F2","#70D6A3","#B4E6E2","#63B5FC","#FF8F62","#FFDC83","#BCC5FD","#A29BFE","#63C4C7","#F68484"]},marks:defaultMarkTheme,components:defaultComponentTheme};class ThemeManager{static registerTheme(e,i){e&&ThemeManager._themes.set(e,i)}static unregisterTheme(e){ThemeManager._themes.delete(e)}static getTheme(e){return ThemeManager._themes.get(e)}static getDefaultTheme(){return ThemeManager.getTheme("default")}}ThemeManager._themes=new Map,ThemeManager.registerTheme("default",defaultTheme),ThemeManager.registerTheme("dark",darkTheme);class Component extends Mark{constructor(e,i,n,o){super(e,GrammarMarkType.component,n),this._componentDatum={[DefaultKey]:0},this.componentType=i,this.spec.type="component",this.spec.componentType=i,this.mode=o,this._updateComponentEncoders()}configureComponent(e){return this.spec.componentConfig=e,this.commit(),this}addGraphicItem(e,i,n){const o=n??Factory.createGraphicComponent(this.componentType,e,{mode:this.mode,skipDefault:this.spec.skipTheme});return o&&(this.emit(HOOK_EVENT.BEFORE_ADD_VRENDER_MARK,{graphicItem:o}),this.graphicParent.appendChild(o),this.emit(HOOK_EVENT.AFTER_ADD_VRENDER_MARK,{graphicItem:o})),o}join(e){return super.join(e,DefaultKey)}encodeState(e,i,n){return super.encodeState(e,i,n),this._updateComponentEncoders(),this}parseRenderContext(){return{large:!1}}_prepareRejoin(){this._componentDatum[DefaultKey]+=1}evaluateJoin(e){return this.spec.key=DefaultKey,e?(e[DefaultKey]=this._componentDatum[DefaultKey],this._componentDatum=e):this._componentDatum={[DefaultKey]:this._componentDatum[DefaultKey]},super.evaluateJoin([this._componentDatum])}_updateComponentEncoders(){this._encoders=this.spec.encode}_getEncoders(){var e;return(e=this._encoders)!==null&&e!==void 0?e:{}}}const EmptyKey=Symbol.for("key");class ViewDiff{diffGrammar(e,i){return diffSingle(e,i,n=>{var o;return(o=n.id())!==null&&o!==void 0?o:Symbol()})}diffMark(e,i,n){const o={enter:[],exit:[],update:[]};let l=[],d=[];e.forEach(y=>{y.markType!==GrammarMarkType.group&&(n.morph&&y.getMorphConfig().morph||n.morphAll||n.reuse)?l.push(y):o.exit.push({prev:[y]})}),i.forEach(y=>{y.markType!==GrammarMarkType.group&&(n.morph&&y.getMorphConfig().morph||n.morphAll||n.reuse)?d.push(y):o.enter.push({next:[y]})});const u=this.diffUpdateByGroup(l,d,y=>y.getMorphConfig().morphKey,y=>y.getMorphConfig().morphKey);l=u.prev,d=u.next,o.update=o.update.concat(u.update);const f=this.diffUpdateByGroup(l,d,y=>y.id(),y=>y.id());l=f.prev,d=f.next,o.update=o.update.concat(f.update);const g=groupData(l,y=>{var b,S;return(S=(b=y.group)===null||b===void 0?void 0:b.id)===null||S===void 0?void 0:S.call(b)}),_=groupData(d,y=>{var b,S;return(S=(b=y.group)===null||b===void 0?void 0:b.id)===null||S===void 0?void 0:S.call(b)});return Object.keys(_).forEach(y=>{const b=g.data.get(y),S=_.data.get(y);if(b&&S){for(let v=0;v<Math.max(b.length,S.length);v+=1){const A=b[v],x=S[v];A&&x?o.update.push({prev:[A],next:[x]}):A?o.exit.push({prev:[A]}):x&&o.enter.push({next:[x]})}l=l.filter(v=>!b.includes(v)),d=d.filter(v=>!S.includes(v))}}),l.forEach(y=>o.exit.push({prev:[y]})),d.forEach(y=>o.enter.push({next:[y]})),o}diffUpdateByGroup(e,i,n,o){const l=groupData(e,_=>{var y;return(y=n(_))!==null&&y!==void 0?y:EmptyKey}),d=groupData(i,_=>{var y;return(y=o(_))!==null&&y!==void 0?y:EmptyKey});let u=e,f=i;const g=[];return d.keys.forEach(_=>{if(_!==EmptyKey){const y=l.data.get(_),b=d.data.get(_);y&&b&&(g.push({prev:y,next:b}),u=u.filter(S=>!y.includes(S)),f=f.filter(S=>!b.includes(S)))}}),{prev:u,next:f,update:g}}}class View extends EventEmitter{static useRegisters(e){e.forEach(i=>{i()})}constructor(e={},i={}){super(),this._observer=null,this._onResize=debounce((...n)=>{const o=this._getContainerSize();o&&this.resize(o.width,o.height)},100),this.delegateEvent=(n,o)=>{const l=getExtendedEvents(this,n,o,EVENT_SOURCE_VIEW);this.emit(o,l,n.element)},this.handleProgressiveFrame=()=>{this._progressiveMarks.length&&this._progressiveMarks.forEach(n=>{n.isDoingProgressive()&&n.evaluateProgressive()}),this.doPreProgressive()},this._config=i,this._options=Object.assign({mode:BROWSER},e),this.initialize()}getGrammarById(e){return this.grammars.getGrammar(e)}getSignalById(e){return this.grammars.getSignal(e)}getDataById(e){return this.grammars.getData(e)}getScaleById(e){return this.grammars.getScale(e)}getCoordinateById(e){return this.grammars.getCoordinate(e)}getMarkById(e){return this.grammars.getMark(e)}getCustomizedById(e){return this.grammars.getCustomized(e)}getGrammarsByName(e){return this.grammars.filter(i=>i.name()===e)}getGrammarsByType(e){return this.grammars.filter(i=>i.grammarType===e)}getMarksByType(e){return this.grammars.getAllMarks().filter(i=>i.markType===e)}getMarksByName(e){return this.grammars.getAllMarks().filter(i=>i.name()===e)}getMarksBySelector(e){if(!e)return null;const i=array(e),n=[];return i.forEach(o=>{if(isGrammar(o))return void n.push(o);if(o[0]===ID_PREFIX){const d=this.getMarkById(o.slice(1));return void(d&&n.push(d))}const l=o[0]===NAME_PREFIX?this.getMarksByName(o.slice(1)):isMarkType(o)?this.getMarksByType(o):null;l&&l.length&&l.forEach(d=>{n.push(d)})}),n}updateSignal(e,i){isString(e)&&(e=this.getSignalById(e)),e.set(i),this.commit(e)}signal(e,i){const n=new Signal(this);return arguments.length>=1&&n.value(e),arguments.length>=2&&n.update(i),this.grammars.record(n),this._dataflow.add(n),n}data(e){const i=new Data(this,e);return this.grammars.record(i),this._dataflow.add(i),i}scale(e){const i=Factory.createGrammar("scale",this,e);return i&&(this.grammars.record(i),this._dataflow.add(i)),i}coordinate(e){const i=Factory.createGrammar("coordinate",this,e);return i&&(this.grammars.record(i),this._dataflow.add(i)),i}mark(e,i,n){const o=isString(i)?this.getMarkById(i):i;let l;switch(e){case GrammarMarkType.group:l=new GroupMark$1(this,o);break;case GrammarMarkType.glyph:const d=Factory.getMark(GrammarMarkType.glyph);d&&(l=new d(this,n==null?void 0:n.glyphType,o));break;case GrammarMarkType.component:l=Factory.hasComponent(n==null?void 0:n.componentType)?Factory.createComponent(n==null?void 0:n.componentType,this,o,n==null?void 0:n.mode):new Component(this,n==null?void 0:n.componentType,o,n==null?void 0:n.mode);break;case GrammarMarkType.text:l=new Text(this,e,o);break;default:l=Factory.hasMark(e)?Factory.createMark(e,this,o):new Mark(this,e,o)}return this.grammars.record(l),this._dataflow.add(l),l}group(e){return this.mark(GrammarMarkType.group,e)}glyph(e,i){return this.mark(GrammarMarkType.glyph,i,{glyphType:e})}component(e,i,n="2d"){return this.mark(GrammarMarkType.component,i,{componentType:e,mode:n})}axis(e,i="2d"){return this.mark(GrammarMarkType.component,e,{componentType:ComponentEnum.axis,mode:i})}grid(e,i="2d"){return this.mark(GrammarMarkType.component,e,{componentType:ComponentEnum.grid,mode:i})}legend(e){return this.mark(GrammarMarkType.component,e,{componentType:ComponentEnum.legend})}slider(e){return this.mark(GrammarMarkType.component,e,{componentType:ComponentEnum.slider})}label(e){return this.mark(GrammarMarkType.component,e,{componentType:ComponentEnum.label})}datazoom(e){return this.mark(GrammarMarkType.component,e,{componentType:ComponentEnum.datazoom})}player(e){return this.mark(GrammarMarkType.component,e,{componentType:ComponentEnum.player})}title(e){return this.mark(GrammarMarkType.component,e,{componentType:ComponentEnum.title})}scrollbar(e){return this.mark(GrammarMarkType.component,e,{componentType:ComponentEnum.scrollbar})}customized(e,i){const n=Factory.createGrammar(e,this,i==null?void 0:i.type);if(n)return n.parse(i),this.grammars.record(n),this._dataflow.add(n),n}addGrammar(e){return this.grammars.find(i=>i.uid===e.uid)||(this.grammars.record(e),this._dataflow.add(e),e.parse(e.getSpec()),this._needBuildLayoutTree=!0),this}removeGrammar(e){const i=isString(e)?this.getGrammarById(e):e;return i&&this.grammars.find(n=>n.uid===i.uid)?(i.grammarType==="mark"&&i.prepareRelease(),this._cachedGrammars.record(i),this._dataflow.remove(i),this.grammars.unrecord(i),this._needBuildLayoutTree=!0,this):this}removeAllGrammars(){return this.grammars.traverse(e=>{e.grammarType==="signal"&&BuiltInSignalID.includes(e.id())||e.grammarType==="mark"&&e.id()==="root"||this.removeGrammar(e)}),this}removeAllGraphicItems(){return this.traverseMarkTree(e=>{e.graphicItem&&(removeGraphicItem(e.graphicItem),e.elementMap.forEach(i=>{i.resetGraphicItem()}),e.graphicItem=null)}),this}parseSpec(e){var i,n,o,l,d,u,f,g;if(this.emit(HOOK_EVENT.BEFORE_PARSE_VIEW),this._spec=e,normalizeMarkTree(e),e.theme?this.theme(e.theme):this.theme(ThemeManager.getDefaultTheme()),e.width&&this.width(e.width),e.height&&this.height(e.height),this.padding((n=(i=e.padding)!==null&&i!==void 0?i:this._options.padding)!==null&&n!==void 0?n:this._theme.padding),!this.width()||!this.height()){const y=this._getContainerSize();y&&(this.updateSignal(SIGNAL_WIDTH,y.width),this.updateSignal(SIGNAL_HEIGHT,y.height))}!((o=e.signals)===null||o===void 0)&&o.length&&e.signals.forEach(y=>{this.signal().parse(y)}),!((l=e.data)===null||l===void 0)&&l.length&&e.data.forEach(y=>{this.data(null).parse(y)}),!((d=e.coordinates)===null||d===void 0)&&d.length&&e.coordinates.forEach(y=>{var b;(b=this.coordinate(y.type))===null||b===void 0||b.parse(y)}),!((u=e.scales)===null||u===void 0)&&u.length&&e.scales.forEach(y=>{var b;(b=this.scale(y.type))===null||b===void 0||b.parse(y)});const _=Factory.getGrammars();return Object.keys(_).forEach(y=>{const{specKey:b}=_[y];e[b]&&e[b].length&&e[b].forEach(S=>{this.customized(y,S)})}),e.marks&&e.marks.length&&e.marks.forEach(y=>{this.parseMarkSpec(y)}),e.events&&e.events.length&&e.events.forEach(y=>{var b;(b=this.event)===null||b===void 0||b.call(this,y)}),e.interactions&&e.interactions.length&&e.interactions.forEach(y=>{this.interaction(y.type,y)}),e.animation===!1?(f=this.animate)===null||f===void 0||f.disable():(g=this.animate)===null||g===void 0||g.enable(),this.emit(HOOK_EVENT.AFTER_PARSE_VIEW),this._needBuildLayoutTree=!0,this._layoutState=LayoutState.before,this}updateSpec(e){return this.removeAllInteractions(),this.removeAllGrammars(),this.parseSpec(e)}parseBuiltIn(){builtInSignals(this._options,this._config,this.getCurrentTheme()).forEach(e=>{const i=this.signal().parse(e);e.value&&i.set(e.value)}),this.parseMarkSpec({id:"root",type:"group",encode:{enter:{x:0,y:0},update:{width:{signal:"width"},height:{signal:"height"}}}}),this.rootMark=this.getMarkById("root")}parseMarkSpec(e){var i;const n=e.type===GrammarMarkType.glyph?{glyphType:e.glyphType}:e.type===GrammarMarkType.component?{componentType:e.componentType,mode:e.mode}:null;this.mark(e.type,e.group,n).parse(e),(i=e.marks)===null||i===void 0||i.forEach(o=>{this.parseMarkSpec(o)})}theme(e){var i,n,o,l,d,u;isString(e)?this._theme=(i=ThemeManager.getTheme(e))!==null&&i!==void 0?i:ThemeManager.getDefaultTheme():this._theme=e;const{background:f,padding:g}=(n=this._spec)!==null&&n!==void 0?n:{};return this._theme?(this.background((o=f??this._options.background)!==null&&o!==void 0?o:this._theme.background),this.padding((l=g??this._options.padding)!==null&&l!==void 0?l:this._theme.padding),(u=(d=this.renderer.stage())===null||d===void 0?void 0:d.setTheme)===null||u===void 0||u.call(d,Object.assign({},this._theme.marks))):(this.background(f??this._options.background),this.padding(g??this._options.padding)),this}getCurrentTheme(){return this._theme}setCurrentTheme(e,i=!0){return this.theme(e),this.grammars.getAllMarks().forEach(n=>{n.commit()}),i?(this.evaluate(),this.renderer.render(!0)):this._dataflow.evaluate(),this}background(e){return arguments.length?(this._background=e,this.renderer.background(e),e):this._background}width(e){const i=this.getSignalById(SIGNAL_WIDTH);return arguments.length?(this._options.width=e,this.updateSignal(i,e),e):i.output()}height(e){const i=this.getSignalById(SIGNAL_HEIGHT);return arguments.length?(this._options.height=e,this.updateSignal(i,e),e):i.output()}viewWidth(e){const i=this.getSignalById(SIGNAL_VIEW_WIDTH);if(arguments.length){const n=this.padding();return this.width(e+n.left+n.right),e}return i.output()}viewHeight(e){const i=this.getSignalById(SIGNAL_VIEW_HEIGHT);if(arguments.length){const n=this.padding();return this.height(e+n.top+n.bottom),e}return i.output()}padding(e){const i=this.getSignalById(SIGNAL_PADDING);if(arguments.length){const n=normalizePadding(e);return this.updateSignal(i,n),n}return normalizePadding(i.output())}autoFit(e){const i=this.getSignalById(SIGNAL_AUTOFIT);return arguments.length?(this.updateSignal(i,e),e):i.output()}getViewBox(){const e=this.getSignalById(SIGNAL_VIEW_BOX);return e==null?void 0:e.output()}updateLayoutTag(){return this._layoutState=LayoutState.before,this}getLayoutState(){return this._layoutState}buildLayoutTree(){const e={},i=[];this.traverseMarkTree(n=>{e[n.id()]=!0,n.group&&e[n.group.id()]||i.push(n),n.markType===GrammarMarkType.group&&n.updateLayoutChildren()},n=>n.needLayout()),this._layoutMarks=i}doLayout(){var e;const i=this._options.doLayout||Factory.getDefaultLayout();i&&(!((e=this._layoutMarks)===null||e===void 0)&&e.length)&&(this.emit(HOOK_EVENT.BEFORE_DO_LAYOUT),i(this._layoutMarks,this._options,this),this.emit(HOOK_EVENT.AFTER_DO_LAYOUT))}handleLayoutEnd(){this.emit(HOOK_EVENT.BEFORE_MARK_LAYOUT_END),this._layoutMarks.forEach(e=>{traverseMarkTree(e,"layoutChildren",i=>{i.handleLayoutEnd()},i=>i!==e)}),this.emit(HOOK_EVENT.AFTER_MARK_LAYOUT_END)}handleRenderEnd(){this.emit(HOOK_EVENT.BEFORE_MARK_RENDER_END),traverseMarkTree(this.rootMark,"children",e=>{e.handleRenderEnd()}),this.emit(HOOK_EVENT.AFTER_MARK_RENDER_END)}commit(e){return this._dataflow.commit(e),this}run(e){return this.evaluate(e),this}doRender(e){this.emit(HOOK_EVENT.BEFORE_DO_RENDER),this.renderer&&(!this._progressiveMarks&&this.animate?this.animate.animate():this.traverseMarkTree(i=>{i.cleanExitElements()},null,!0),this.renderer.render(e),this.handleRenderEnd()),this.emit(HOOK_EVENT.AFTER_DO_RENDER)}evaluate(e){var i,n;const o=normalizeRunningConfig(e),l=this._cachedGrammars.size()>0;l&&(this.reuseCachedGrammars(o),this.detachCachedGrammar());const d=this._resizeRenderer(),u=this._dataflow.hasCommitted();return l||u||this._layoutState||d?(this.clearProgressive(),this._dataflow.evaluate(),this._needBuildLayoutTree&&(this.buildLayoutTree(),this._needBuildLayoutTree=!1),this._layoutState&&(this._layoutState=LayoutState.layouting,this.doLayout(),this._dataflow.hasCommitted()&&(this._layoutState=LayoutState.reevaluate,this._dataflow.evaluate()),this._layoutState=LayoutState.after,!((i=this._layoutMarks)===null||i===void 0)&&i.length&&this.handleLayoutEnd()),this._layoutState=null,this.findProgressiveMarks(),this._resizeRenderer(),(n=this.morph)===null||n===void 0||n.call(this,o),this.releaseCachedGrammars(o),this.doRender(!0),this.doPreProgressive(),this):this}reuseCachedGrammars(e){if(e.reuse){const i=n=>{n.next.reuse(n.prev),n.prev.detachAll(),n.prev.clear(),this._cachedGrammars.unrecord(n.prev)};this._differ.diffGrammar(this._cachedGrammars.getAllSignals(),this.grammars.getAllSignals().filter(n=>!BuiltInSignalID.includes(n.id()))).update.forEach(i),this._differ.diffGrammar(this._cachedGrammars.getAllData(),this.grammars.getAllData()).update.forEach(i),this._differ.diffGrammar(this._cachedGrammars.getAllScales(),this.grammars.getAllScales()).update.forEach(i),this._differ.diffGrammar(this._cachedGrammars.getAllCoordinates(),this.grammars.getAllCoordinates()).update.forEach(i)}this._differ.diffMark(this._cachedGrammars.getAllMarks(),this.grammars.getAllMarks().filter(i=>i.id()!=="root"),e).update.forEach(i=>{var n;const o=i.prev.length===1&&i.next.length===1&&i.prev[0].markType===i.next[0].markType,l=i.prev.every(d=>d.getMorphConfig().morph)&&i.next.every(d=>d.getMorphConfig().morph);this.morph&&(e.morph&&l||e.morphAll)?(n=this.addMorphMarks)===null||n===void 0||n.call(this,{prev:i.prev,next:i.next}):o&&e.reuse&&(i.next[0].reuse(i.prev[0]),i.prev[0].detachAll(),i.prev[0].clear(),this._cachedGrammars.unrecord(i.prev[0]))})}detachCachedGrammar(){this._cachedGrammars.traverse(e=>{var i,n;if(e.detachAll(),e.grammarType==="mark"){const o=e;(n=(i=o.group)===null||i===void 0?void 0:i.removeChild)===null||n===void 0||n.call(i,o)}})}releaseCachedGrammars(e){this._cachedGrammars.traverse(o=>{o.grammarType!=="mark"&&o.release()});const i=this._cachedGrammars.getAllMarkNodes();i.forEach(o=>{var l;(l=o.mark.animate)===null||l===void 0||l.stop(),e.enableExitAnimation&&this.animate&&this.animate.animateAddition(o.mark)});const n=o=>{if(o.mark.view&&(!o.mark.animate||o.mark.animate.getAnimatorCount()===0)&&(!o.children||o.children.length===0)){o.mark.release();const l=o.parent;l&&(o.parent.children=o.parent.children.filter(d=>d!==o),o.parent=null,n(l))}};i.forEach(o=>{const l=o.mark;l.animate&&l.animate.getAnimatorCount()!==0?l.addEventListener("animationEnd",()=>{l.animate&&l.animate.getAnimatorCount()===0&&n(o)}):n(o)}),this._cachedGrammars.clear()}runAfter(e){return this._dataflow.runAfter(()=>{e.call(null,this)}),this}runBefore(e){return this._dataflow.runBefore(()=>{e.call(null,this)}),this}getImageBuffer(){var e,i;if(this._options.mode!=="node")return void this.logger.error(new TypeError("getImageBuffer() now only support node environment."));const n=(i=(e=this.renderer)===null||e===void 0?void 0:e.stage)===null||i===void 0?void 0:i.call(e);return n?(n.render(),n.window.getImageBuffer()):(this.logger.error(new ReferenceError("render is not defined")),null)}traverseMarkTree(e,i,n){return traverseMarkTree(this.rootMark,"children",e,i,n),this}_bindResizeEvent(){var e,i,n,o,l,d;if(this.autoFit()){const u=(l=(o=(n=(i=(e=this.renderer)===null||e===void 0?void 0:e.stage)===null||i===void 0?void 0:i.call(e))===null||n===void 0?void 0:n.window)===null||o===void 0?void 0:o.getContainer)===null||l===void 0?void 0:l.call(o);if(u){const f=window.ResizeObserver;this._observer=new f(this._onResize),(d=this._observer)===null||d===void 0||d.observe(u)}window.addEventListener("resize",this._onResize)}}_unBindResizeEvent(){this.autoFit()&&(window.removeEventListener("resize",this._onResize),this._observer&&(this._observer.disconnect(),this._observer=null))}_getContainerSize(){var e,i,n,o,l,d,u,f,g,_,y;const b=(l=(o=(n=(i=(e=this.renderer)===null||e===void 0?void 0:e.stage)===null||i===void 0?void 0:i.call(e))===null||n===void 0?void 0:n.window)===null||o===void 0?void 0:o.getContainer)===null||l===void 0?void 0:l.call(o);if(b){const{width:S,height:v}=getContainerSize(b);return{width:(f=(u=(d=this._spec)===null||d===void 0?void 0:d.width)!==null&&u!==void 0?u:this._options.width)!==null&&f!==void 0?f:S,height:(y=(_=(g=this._spec)===null||g===void 0?void 0:g.height)!==null&&_!==void 0?_:this._options.height)!==null&&y!==void 0?y:v}}return null}resize(e,i,n=!0){let o=!1;return e!==this.width()&&(o=!0,this.updateSignal(SIGNAL_WIDTH,e)),i!==this.height()&&(o=!0,this.updateSignal(SIGNAL_HEIGHT,i)),o&&(n?this.evaluate({morph:!1}):this._dataflow.evaluate()),this}_resizeRenderer(){const e=this.width(),i=this.height();return!!this.renderer.shouldResize(e,i)&&(this.renderer.resize(e,i),this.emit("resize",{},{width:e,height:i}),!0)}interaction(e,i){const n=Factory.createInteraction(e,this,i);return n&&(n.bind(),this._boundInteractions||(this._boundInteractions=[]),this._boundInteractions.push(n)),n}removeInteraction(e,i){if(this._boundInteractions){const n=this._boundInteractions.filter(o=>{var l;return isNil(i)?isString(e)?o.type===e:e?o===e:void 0:((l=o.options)===null||l===void 0?void 0:l.id)===i});n.length&&n.forEach(o=>{o.unbind()})}return this}removeAllInteractions(){return this._boundInteractions&&(this._boundInteractions.forEach(e=>{e.unbind()}),this._boundInteractions=null),this}initializeEventConfig(e){const i=Object.assign({defaults:{}},e),n=(o,l)=>{l.forEach(d=>{isArray(o[d])&&(o[d]=o[d].reduce((u,f)=>(u[f]=!0,u),{}))})};return n(i.defaults,["prevent","allow"]),n(i,[EVENT_SOURCE_VIEW,EVENT_SOURCE_WINDOW]),i}initEvent(){const e=this.renderer.stage();e&&e.on("*",this.delegateEvent)}releaseStageEvent(){const e=this.renderer.stage();e&&e.off("*",this.delegateEvent)}addEventListener(e,i,n){let o=i;return n&&n.trap===!1||(o=i,o.raw=i),n&&n.target&&(o.target=n.target),this.on(e,o),this}removeEventListener(e,i){return i?this.off(e,i):this.off(e),this}initializeRenderer(){const e=this._options.width,i=this._options.height;this.renderer=new CanvasRenderer(this),this.renderer.initialize(e,i,this._options,this._eventConfig).background(this._background)}initialize(){var e,i;this.grammars=new RecordedGrammars(n=>n.id(),(n,o)=>this.logger.warn(`Grammar id '${n}' has been occupied`,o)),this._cachedGrammars=new RecordedTreeGrammars(n=>n.id()),this._options.logger&&Logger.setInstance(this._options.logger),this.logger=Logger.getInstance((e=this._options.logLevel)!==null&&e!==void 0?e:0),this._dataflow=new Dataflow,this.animate=(i=this.initAnimate)===null||i===void 0?void 0:i.call(this,this),this._differ=new ViewDiff,this._options.hooks&&(Object.keys(this._options.hooks).forEach(n=>{this.on(n,this._options.hooks[n])}),this.hooks=this._options.hooks),this.container=null,this.renderer=null,this._eventListeners=[],this._eventConfig=this.initializeEventConfig(this._options.eventConfig),this._theme=this._options.disableTheme?null:ThemeManager.getDefaultTheme(),this.parseBuiltIn(),configureEnvironment(this._options),this.initializeRenderer(),this._eventConfig.disable||this.initEvent(),this._bindResizeEvent(),this._needBuildLayoutTree=!0,this._layoutState=LayoutState.before,this.theme(this._theme)}pauseProgressive(){return!1}resumeProgressive(){return!1}restartProgressive(){return!1}findProgressiveMarks(){const e=[];return this.traverseMarkTree(i=>{e.push(i)},i=>i.markType!==GrammarMarkType.group&&i.isProgressive()),e.length?(this._progressiveMarks=e,this.renderer&&this.renderer.combineIncrementalLayers(),e):(this._progressiveMarks=null,null)}doPreProgressive(){if(this._progressiveMarks&&this._progressiveMarks.some(e=>e.isDoingProgressive())){const e=vglobal.getRequestAnimationFrame();this._progressiveRafId=e(this.handleProgressiveFrame)}else this._progressiveMarks&&this.animate&&this._progressiveMarks.every(e=>e.canAnimateAfterProgressive())?this.animate.animate():this._progressiveMarks&&(this._progressiveMarks=null)}clearProgressive(){this._progressiveRafId&&vglobal.getCancelAnimationFrame()(this._progressiveRafId),this._progressiveMarks&&this._progressiveMarks.length&&(this._progressiveMarks.forEach(e=>{e.clearProgressive()}),this._progressiveMarks=null)}release(){var e,i,n,o;this.removeAllInteractions(),this.releaseStageEvent(),this._unBindResizeEvent(),this.clearProgressive(),Factory.unregisterRuntimeTransforms(),Logger.setInstance(null),(e=this.animate)===null||e===void 0||e.stop(),this.grammars.release(),this._cachedGrammars.release(),this._dataflow.release(),this._dataflow=null,(n=(i=this.renderer)===null||i===void 0?void 0:i.release)===null||n===void 0||n.call(i),this.renderer=null,this._boundInteractions=null,this.removeAllListeners(),(o=this._eventListeners)===null||o===void 0||o.forEach(l=>{l.source.removeEventListener(l.type,l.handler)}),this._eventListeners=null}}const registerArcGraphic=()=>{registerShadowRoot(),registerArc(),Factory.registerGraphic(GrammarMarkType.arc,createArc),registerArcDataLabel()},registerArc3dGraphic=()=>{registerShadowRoot(),registerArc3d(),Factory.registerGraphic(GrammarMarkType.arc3d,createArc3d)},registerPyramid3dGraphic=()=>{registerShadowRoot(),registerPyramid3d(),Factory.registerGraphic(GrammarMarkType.pyramid3d,createPyramid3d)},registerAreaGraphic=()=>{registerShadowRoot(),registerArea(),Factory.registerGraphic(GrammarMarkType.area,createArea),registerLineDataLabel(),registerSymbolDataLabel()},registerGroupGraphic=()=>{registerShadowRoot(),registerGroup(),Factory.registerGraphic(GrammarMarkType.group,createGroup)},registerImageGraphic=()=>{registerShadowRoot(),registerImage(),Factory.registerGraphic(GrammarMarkType.image,createImage)},registerLineGraphic=()=>{registerShadowRoot(),registerLine(),registerLineDataLabel(),registerSymbolDataLabel(),Factory.registerGraphic(GrammarMarkType.line,createLine)},registerPathGraphic=()=>{registerShadowRoot(),registerPath(),Factory.registerGraphic(GrammarMarkType.path,createPath)},registerRectGraphic=()=>{registerShadowRoot(),registerRect(),registerRectDataLabel(),Factory.registerGraphic(GrammarMarkType.rect,createRect)},registerRect3dGraphic=()=>{registerShadowRoot(),registerRect3d(),Factory.registerGraphic(GrammarMarkType.rect3d,createRect3d)},registerRuleGraphic=()=>{registerShadowRoot(),registerLine(),Factory.registerGraphic(GrammarMarkType.rule,createLine)},registerSymbolGraphic=()=>{registerShadowRoot(),registerSymbol(),registerSymbolDataLabel(),Factory.registerGraphic(GrammarMarkType.symbol,createSymbol)},registerTextGraphic=()=>{registerShadowRoot(),registerText(),registerRichtext(),Factory.registerGraphic(GrammarMarkType.text,createText)},registerPolygonGraphic=()=>{registerShadowRoot(),registerPolygon(),Factory.registerGraphic(GrammarMarkType.polygon,createPolygon)},registerRichTextGraphic=()=>{registerShadowRoot(),registerRichtext(),Factory.registerGraphic(GrammarMarkType.richtext,createRichText)},registerCellGraphic=()=>{registerShadowRoot(),registerSymbol(),registerSymbolDataLabel(),Factory.registerGraphic(GrammarMarkType.cell,createSymbol)},registerGlyphGraphic=()=>{registerShadowRoot(),registerGlyph(),Factory.registerGraphic(GrammarMarkType.glyph,createGlyph)};class GlyphElement extends Element$1{constructor(e){super(e),this.getStateAttrs=(i,n)=>{var o,l,d,u;const f=!isNil((o=this.runtimeStatesEncoder)===null||o===void 0?void 0:o[i]),g=f?Object.assign(Object.assign({},(l=this.mark.getSpec().encode)===null||l===void 0?void 0:l[i]),this.runtimeStatesEncoder[i]):(d=this.mark.getSpec().encode)===null||d===void 0?void 0:d[i],_={};if(!g)return _;if(isFunction(g))return _.attributes=g(this.getDatum(),this,i,n),_;if(!f&&(!((u=this.graphicItem.glyphStates)===null||u===void 0)&&u[i]))return this.graphicItem.glyphStates[i];if(g){const y=this.items[0],b=[Object.assign({},y,{nextAttrs:{}})];return invokeEncoderToItems(this,b,g,this.mark.parameters()),this.coordinateTransformEncode(b),_.attributes=b[0].nextAttrs,this.graphicItem.glyphStates?this.graphicItem.glyphStates[i]||(this.graphicItem.glyphStates[i]=_):this.graphicItem.glyphStates={[i]:_},_}return _},this.glyphMeta=this.mark.getGlyphMeta()}getGlyphGraphicItems(){return this.glyphGraphicItems}initGraphicItem(e={}){if(this.graphicItem)return;this.graphicItem=this.mark.addGraphicItem(e,this.groupKey),this.graphicItem[BridgeElementKey]=this,this.graphicItem.onBeforeAttributeUpdate=this._onGlyphAttributeUpdate(!1);const i=this.glyphMeta.getMarks();this.glyphGraphicItems={},this.graphicItem.getSubGraphic().forEach(n=>{const o=i[n.name];this.glyphGraphicItems[n.name]=n,n.onBeforeAttributeUpdate=l=>this.mark?transformAttributes(o,l,this,n.name):l}),this.clearGraphicAttributes()}useStates(e,i){if(!this.graphicItem)return!1;this.mark.emit(HOOK_EVENT.BEFORE_ELEMENT_STATE,{states:e},this),this.states=e.slice();const n=isBoolean(i)?i:this.hasStateAnimation();return this.graphicItem.glyphStateProxy=this.getStateAttrs,this.graphicItem.useStates(this.states,n),this.mark.emit(HOOK_EVENT.AFTER_ELEMENT_STATE,{states:e},this),!0}encodeGraphic(){this.coordinateTransformEncode(this.items);const e=this.transformElementItems(this.items,this.mark.markType),i=!this.graphicItem;this.graphicItem?(this.graphicItem.clearStates(),this.graphicItem.states={},this.graphicItem.stateProxy=null):this.initGraphicItem(),this.diffState===DiffState.enter||i?(this.graphicItem.onBeforeAttributeUpdate=this._onGlyphAttributeUpdate(!0),this.applyGraphicAttributes(e),this.graphicItem.onBeforeAttributeUpdate=this._onGlyphAttributeUpdate(!1)):this.applyGraphicAttributes(e),this.diffState!==DiffState.enter&&this.diffState!==DiffState.update||!this.states.length||(Object.values(this.glyphGraphicItems).forEach(n=>{n.states={}}),this.useStates(this.states)),this.items.map(n=>{n.nextAttrs={}})}encodeCustom(e){var i;let n={};const o=this.glyphMeta.getChannelEncoder(),l=this.glyphMeta.getFunctionEncoder();if(l&&(n=l.call(null,Object.assign({},(i=this.graphicItem)===null||i===void 0?void 0:i.attribute,e),this.getDatum(),this,this.mark.getGlyphConfig())),o){let d;Object.keys(o).forEach(u=>{var f;if(!isNil(e[u])){d||(d=Object.assign({},(f=this.graphicItem)===null||f===void 0?void 0:f.attribute,e));const g=o[u].call(null,u,e[u],d,this.getDatum(),this,this.mark.getGlyphConfig());Object.keys(g??{}).forEach(_=>{var y;n[_]=Object.assign((y=n[_])!==null&&y!==void 0?y:{},g[_])})}})}return n}encodeDefault(){const e={};if(this.glyphMeta.getDefaultEncoder()){const i=this.glyphMeta.getDefaultEncoder().call(null,this.getDatum(),this,this.mark.getGlyphConfig());Object.assign(e,i)}return e}_onGlyphAttributeUpdate(e=!1){return i=>{if(!this.mark)return i;const n=this.glyphMeta.getMarks(),o=transformAttributes(this.mark.getAttributeTransforms(),i,this),l=e?this.encodeDefault():null,d=this.encodeCustom(i);return Object.keys(n).forEach(u=>{const f=n[u],g=this.glyphGraphicItems[u],_=d==null?void 0:d[u],y=Object.assign({},_);if(e){const A=l==null?void 0:l[u];Object.keys(A??{}).forEach(x=>{has(this.items[0].nextAttrs,x)||has(y,x)||(y[x]=A[x])})}const b=Object.assign({},cloneTransformAttributes(f,i),y),S=this._generateGlyphItems(f,this.items,b);this.coordinateTransformEncode(S);const v=this.transformElementItems(S,f);this.applyGlyphGraphicAttributes(v,u,g),f===GrammarMarkType.shape&&(g.datum=S[0].datum)}),o}}_generateGlyphItems(e,i,n){const o=i.map(l=>Object.assign({},l,{nextAttrs:n}));return CollectionMarkType.includes(e)&&this.mark.getSpec().enableSegments&&o.forEach((l,d)=>{l.nextAttrs=Object.assign({},i[d].nextAttrs,n)}),o}getGraphicAttribute(e,i=!1,n){if(!this.graphicItem)return;const o=this.getPrevGraphicAttributes(n);return i&&has(o,e)?o[e]:(n?this.glyphGraphicItems[n]:this.graphicItem).attribute[e]}setGraphicAttribute(e,i,n=!0,o){if(!this.graphicItem)return;const l=o?this.glyphGraphicItems[o]:this.graphicItem,d=this.getFinalGraphicAttributes(o),u=this.getPrevGraphicAttributes(o);n&&(d[e]=i),has(u,e)||(u[e]=l.attribute[e]),l.setAttribute(e,i)}setGraphicAttributes(e,i=!0,n){if(!this.graphicItem)return;const o=n?this.glyphGraphicItems[n]:this.graphicItem,l=this.getFinalGraphicAttributes(n),d=this.getPrevGraphicAttributes(n);Object.keys(e).forEach(u=>{i&&(l[u]=e[u]),has(d,u)||(d[u]=o.attribute[u])}),o.setAttributes(e)}diffAttributes(e,i){const n={},o=this.getFinalGraphicAttributes(i);for(const l in e)has(o,l)&&isEqual(o[l],e[l])||(n[l]=e[l]);return n}applyGlyphGraphicAttributes(e,i,n){var o,l;if(this.mark.needAnimate()){const d=this.diffAttributes(e,i),u=(o=this.getPrevGraphicAttributes(i))!==null&&o!==void 0?o:{},f=(l=this.getFinalGraphicAttributes(i))!==null&&l!==void 0?l:{};Object.keys(d).forEach(g=>{u[g]=n.attribute[g],f[g]=d[g]}),this.setNextGraphicAttributes(d,i),this.setPrevGraphicAttributes(u,i),this.setFinalGraphicAttributes(f,i),n.setAttributes(d)}else n.setAttributes(e)}getFinalGraphicAttributes(e){return(e?this.glyphGraphicItems[e]:this.graphicItem).finalAttrs}setFinalGraphicAttributes(e,i){(i?this.glyphGraphicItems[i]:this.graphicItem).finalAttrs=e}getPrevGraphicAttributes(e){return(e?this.glyphGraphicItems[e]:this.graphicItem).prevAttrs}setPrevGraphicAttributes(e,i){(i?this.glyphGraphicItems[i]:this.graphicItem).prevAttrs=e}getNextGraphicAttributes(e){return(e?this.glyphGraphicItems[e]:this.graphicItem).nextAttrs}setNextGraphicAttributes(e,i){(i?this.glyphGraphicItems[i]:this.graphicItem).nextAttrs=e}clearChangedGraphicAttributes(){this.setPrevGraphicAttributes(null),this.setNextGraphicAttributes(null),Object.keys(this.glyphGraphicItems).forEach(e=>{this.setPrevGraphicAttributes(null,e),this.setNextGraphicAttributes(null,e)})}clearGraphicAttributes(){this.setPrevGraphicAttributes(null),this.setNextGraphicAttributes(null),this.setFinalGraphicAttributes(null),Object.keys(this.glyphGraphicItems).forEach(e=>{this.setPrevGraphicAttributes(null,e),this.setNextGraphicAttributes(null,e),this.setFinalGraphicAttributes(null,e)})}remove(){this.glyphGraphicItems=null,super.remove()}release(){this.glyphGraphicItems&&(Object.values(this.glyphGraphicItems).forEach(e=>{e[BridgeElementKey]=null}),this.glyphGraphicItems=null),super.release()}}class GlyphMark extends Mark{constructor(e,i,n){super(e,GrammarMarkType.glyph,n),this.glyphType=i,this.glyphMeta=Factory.getGlyph(i)}configureGlyph(e){return this.spec.glyphConfig=e,this.commit(),this}getGlyphMeta(){return this.glyphMeta}getGlyphConfig(){return this.spec.glyphConfig}addGraphicItem(e,i){const n=createGlyphGraphicItem(this,this.glyphMeta,e);return super.addGraphicItem(e,i,n)}createElement(){return new GlyphElement(this)}}GlyphMark.markType=GrammarMarkType.glyph;const registerGlyphMark=()=>{Factory.registerMark(GrammarMarkType.glyph,GlyphMark)},scaleIn$1=r=>(e,i,n)=>{var o,l,d;const u=(d=(o=e.getGraphicAttribute("direction",!1))!==null&&o!==void 0?o:(l=e.mark.getGlyphConfig())===null||l===void 0?void 0:l.direction)!==null&&d!==void 0?d:"vertical",f=r(e,u,i);if(!isValidNumber(f))return{};const g=e.getGraphicAttribute("x",!1),_=e.getGraphicAttribute("y",!1),y=e.getGraphicAttribute("min",!1),b=e.getGraphicAttribute("max",!1),S=e.getGraphicAttribute("q1",!1),v=e.getGraphicAttribute("q3",!1),A=e.getGraphicAttribute("median",!1),x={from:{x:g,y:_},to:{x:g,y:_}};return isValidNumber(y)&&(x.from.min=f,x.to.min=y),isValidNumber(b)&&(x.from.max=f,x.to.max=b),isValidNumber(S)&&(x.from.q1=f,x.to.q1=S),isValidNumber(v)&&(x.from.q3=f,x.to.q3=v),isValidNumber(A)&&(x.from.median=f,x.to.median=A),x},scaleOut$1=r=>(e,i,n)=>{var o,l,d;const u=(d=(o=e.getGraphicAttribute("direction",!1))!==null&&o!==void 0?o:(l=e.mark.getGlyphConfig())===null||l===void 0?void 0:l.direction)!==null&&d!==void 0?d:"vertical",f=r(e,u,i);if(!isValidNumber(f))return{};const g=e.getGraphicAttribute("x",!0),_=e.getGraphicAttribute("y",!0),y=e.getGraphicAttribute("min",!0),b=e.getGraphicAttribute("max",!0),S=e.getGraphicAttribute("q1",!0),v=e.getGraphicAttribute("q3",!0),A=e.getGraphicAttribute("median",!0),x={from:{x:g,y:_},to:{x:g,y:_}};return isValidNumber(y)&&(x.to.min=f,x.from.min=y),isValidNumber(b)&&(x.to.max=f,x.from.max=b),isValidNumber(S)&&(x.to.q1=f,x.from.q1=S),isValidNumber(v)&&(x.to.q3=f,x.from.q3=v),isValidNumber(A)&&(x.to.median=f,x.from.median=A),x},computeBoxplotCenter=(r,e,i)=>{var n,o,l,d,u,f,g,_,y,b,S,v;if(i&&isValidNumber(i.center))return i.center;let A,x,T,C,E;if(isHorizontal$2(e)){A=(o=(n=r.getGraphicAttribute("points",!1,"median"))===null||n===void 0?void 0:n[0])===null||o===void 0?void 0:o.x,x=(d=(l=r.getGraphicAttribute("points",!1,"max"))===null||l===void 0?void 0:l[0])===null||d===void 0?void 0:d.x,T=(f=(u=r.getGraphicAttribute("points",!1,"min"))===null||u===void 0?void 0:u[0])===null||f===void 0?void 0:f.x;const P=r.getGraphicAttribute("width",!1,"box"),R=r.getGraphicAttribute("x",!1,"box");C=R,E=R+P}else{A=(_=(g=r.getGraphicAttribute("points",!1,"median"))===null||g===void 0?void 0:g[0])===null||_===void 0?void 0:_.y,x=(b=(y=r.getGraphicAttribute("points",!1,"max"))===null||y===void 0?void 0:y[0])===null||b===void 0?void 0:b.y,T=(v=(S=r.getGraphicAttribute("points",!1,"min"))===null||S===void 0?void 0:S[0])===null||v===void 0?void 0:v.y;const P=r.getGraphicAttribute("height",!1,"box"),R=r.getGraphicAttribute("y",!1,"box");C=R,E=R+P}return isValidNumber(A)?A:isValidNumber(C)&&isValidNumber(E)?(C+E)/2:isValidNumber(x)&&isValidNumber(T)?(x+T)/2:isValidNumber(T)?T:isValidNumber(x)?x:NaN},encodeBoxplotSize=(r,e,i,n)=>{var o,l,d,u,f,g,_,y;const b={shaft:{},box:{},max:{},min:{},median:{}},S=(o=r.x)!==null&&o!==void 0?o:i.getGraphicAttribute("x",!1),v=(l=r.y)!==null&&l!==void 0?l:i.getGraphicAttribute("y",!1),A=(d=r.width)!==null&&d!==void 0?d:i.getGraphicAttribute("width",!1),x=(u=r.height)!==null&&u!==void 0?u:i.getGraphicAttribute("height",!1),T=(f=r.boxWidth)!==null&&f!==void 0?f:i.getGraphicAttribute("boxWidth",!1),C=(g=r.boxHeight)!==null&&g!==void 0?g:i.getGraphicAttribute("boxHeight",!1),E=(_=r.ruleWidth)!==null&&_!==void 0?_:i.getGraphicAttribute("ruleWidth",!1),P=(y=r.ruleHeight)!==null&&y!==void 0?y:i.getGraphicAttribute("ruleHeight",!1);return n&&isHorizontal$2(n.direction)?(isValidNumber(C)?(Object.assign(b.box,{y:v-C/2,y1:v+C/2}),Object.assign(b.median,{y:v-C/2,y1:v+C/2})):(Object.assign(b.box,{y:v-x/2,y1:v+x/2}),Object.assign(b.median,{y:v-x/2,y1:v+x/2})),isValidNumber(P)?(Object.assign(b.max,{y:v-P/2,y1:v+P/2}),Object.assign(b.min,{y:v-P/2,y1:v+P/2})):(Object.assign(b.max,{y:v-x/2,y1:v+x/2}),Object.assign(b.min,{y:v-x/2,y1:v+x/2}))):(isValidNumber(T)?(Object.assign(b.box,{x:S-T/2,x1:S+T/2}),Object.assign(b.median,{x:S-T/2,x1:S+T/2})):(Object.assign(b.box,{x:S-A/2,x1:S+A/2}),Object.assign(b.median,{x:S-A/2,x1:S+A/2})),isValidNumber(E)?(Object.assign(b.max,{x:S-E/2,x1:S+E/2}),Object.assign(b.min,{x:S-E/2,x1:S+E/2})):(Object.assign(b.max,{x:S-A/2,x1:S+A/2}),Object.assign(b.min,{x:S-A/2,x1:S+A/2}))),b},boxplotScaleIn=scaleIn$1(computeBoxplotCenter),boxplotScaleOut=scaleOut$1(computeBoxplotCenter);function registerBoxplotGlyph(){Factory.registerGlyph("boxplot",{shaft:"rule",box:"rect",max:"rule",min:"rule",median:"rule"}).registerProgressiveChannels(["x","y","q1","q3","min","max","median","angle","width","height","boxWidth","boxHeight","ruleWidth","ruleHeight"]).registerFunctionEncoder(encodeBoxplotSize).registerChannelEncoder("x",(r,e,i,n,o,l)=>l&&isHorizontal$2(l.direction)?null:{shaft:{x:e,x1:e}}).registerChannelEncoder("y",(r,e,i,n,o,l)=>l&&isHorizontal$2(l.direction)?{shaft:{y:e,y1:e}}:null).registerChannelEncoder("q1",(r,e,i,n,o,l)=>l&&isHorizontal$2(l.direction)?{box:{x:e}}:{box:{y:e}}).registerChannelEncoder("q3",(r,e,i,n,o,l)=>l&&isHorizontal$2(l.direction)?{box:{x1:e}}:{box:{y1:e}}).registerChannelEncoder("min",(r,e,i,n,o,l)=>l&&isHorizontal$2(l.direction)?{shaft:{x:e},min:{x:e,x1:e,visible:!0}}:{shaft:{y:e},min:{y:e,y1:e,visible:!0}}).registerChannelEncoder("max",(r,e,i,n,o,l)=>l&&isHorizontal$2(l.direction)?{shaft:{x1:e},max:{x:e,x1:e,visible:!0}}:{shaft:{y1:e},max:{y:e,y1:e,visible:!0}}).registerChannelEncoder("median",(r,e,i,n,o,l)=>l&&isHorizontal$2(l.direction)?{median:{x:e,x1:e,visible:!0}}:{median:{y:e,y1:e,visible:!0}}).registerChannelEncoder("angle",(r,e,i,n,o,l)=>{var d;const u=l&&isHorizontal$2(l.direction)?[(i.min+i.max)/2,i.y]:[i.x,(i.min+i.max)/2],f=(d=i.anchor)!==null&&d!==void 0?d:u;return{shaft:{angle:e,anchor:f},box:{angle:e,anchor:f},max:{angle:e,anchor:f},min:{angle:e,anchor:f},median:{angle:e,anchor:f}}}).registerDefaultEncoder(()=>({max:{visible:!1},min:{visible:!1},median:{visible:!1}})),Factory.registerAnimationType("boxplotScaleIn",boxplotScaleIn),Factory.registerAnimationType("boxplotScaleOut",boxplotScaleOut),registerGlyphMark(),registerGlyphGraphic(),registerRectGraphic(),registerRuleGraphic()}const computeBarBoxplotCenter=(r,e,i)=>{var n,o,l,d;if(isValidNumber(i==null?void 0:i.center))return i.center;let u,f,g,_,y;if(isHorizontal$2(e)){u=(o=(n=r.getGraphicAttribute("points",!1,"median"))===null||n===void 0?void 0:n[0])===null||o===void 0?void 0:o.x;const b=r.getGraphicAttribute("width",!1,"minMaxBox"),S=r.getGraphicAttribute("x",!1,"minMaxBox");g=S,f=S+b;const v=r.getGraphicAttribute("width",!1,"q1q3Box"),A=r.getGraphicAttribute("x",!1,"q1q3Box");_=A,y=A+v}else{u=(d=(l=r.getGraphicAttribute("points",!1,"median"))===null||l===void 0?void 0:l[0])===null||d===void 0?void 0:d.y;const b=r.getGraphicAttribute("height",!1,"minMaxBox"),S=r.getGraphicAttribute("y",!1,"minMaxBox");g=S,f=S+b;const v=r.getGraphicAttribute("height",!1,"q1q3Box"),A=r.getGraphicAttribute("y",!1,"q1q3Box");_=A,y=A+v}return isValidNumber(u)?u:isValidNumber(_)&&isValidNumber(y)?(_+y)/2:isValidNumber(f)&&isValidNumber(g)?(f+g)/2:isValidNumber(g)?g:isValidNumber(f)?f:NaN},encodeBarBoxplotSize=(r,e,i,n)=>{var o,l,d,u,f,g,_,y;const b={minMaxBox:{},q1q3Box:{},median:{}},S=(o=r.x)!==null&&o!==void 0?o:i.getGraphicAttribute("x",!1),v=(l=r.y)!==null&&l!==void 0?l:i.getGraphicAttribute("y",!1),A=(d=r.width)!==null&&d!==void 0?d:i.getGraphicAttribute("width",!1),x=(u=r.minMaxWidth)!==null&&u!==void 0?u:i.getGraphicAttribute("minMaxWidth",!1),T=(f=r.q1q3Width)!==null&&f!==void 0?f:i.getGraphicAttribute("q1q3Width",!1),C=(g=r.height)!==null&&g!==void 0?g:i.getGraphicAttribute("height",!1),E=(_=r.minMaxHeight)!==null&&_!==void 0?_:i.getGraphicAttribute("minMaxHeight",!1),P=(y=r.q1q3Height)!==null&&y!==void 0?y:i.getGraphicAttribute("q1q3Height",!1);return n&&isHorizontal$2(n.direction)?(isValidNumber(E)?Object.assign(b.minMaxBox,{y:v-E/2,y1:v+E/2}):Object.assign(b.minMaxBox,{y:v-C/2,y1:v+C/2}),isValidNumber(P)?(Object.assign(b.q1q3Box,{y:v-P/2,y1:v+P/2}),Object.assign(b.median,{y:v-P/2,y1:v+P/2})):(Object.assign(b.q1q3Box,{y:v-C/2,y1:v+C/2}),Object.assign(b.median,{y:v-C/2,y1:v+C/2}))):(isValidNumber(x)?Object.assign(b.minMaxBox,{x:S-x/2,x1:S+x/2}):Object.assign(b.minMaxBox,{x:S-A/2,x1:S+A/2}),isValidNumber(T)?(Object.assign(b.q1q3Box,{x:S-T/2,x1:S+T/2}),Object.assign(b.median,{x:S-T/2,x1:S+T/2})):(Object.assign(b.q1q3Box,{x:S-A/2,x1:S+A/2}),Object.assign(b.median,{x:S-A/2,x1:S+A/2}))),b},barBoxplotScaleIn=scaleIn$1(computeBarBoxplotCenter),barBoxplotScaleOut=scaleOut$1(computeBarBoxplotCenter);function registerBarBoxplotGlyph(){Factory.registerGlyph("barBoxplot",{minMaxBox:"rect",q1q3Box:"rect",median:"rule"}).registerProgressiveChannels(["x","y","q1","q3","min","max","median","angle","width","height","minMaxWidth","q1q3Width","minMaxHeight","q1q3Height"]).registerFunctionEncoder(encodeBarBoxplotSize).registerChannelEncoder("q1",(r,e,i,n,o,l)=>l&&isHorizontal$2(l.direction)?{q1q3Box:{x:e}}:{q1q3Box:{y:e}}).registerChannelEncoder("q3",(r,e,i,n,o,l)=>l&&isHorizontal$2(l.direction)?{q1q3Box:{x1:e}}:{q1q3Box:{y1:e}}).registerChannelEncoder("min",(r,e,i,n,o,l)=>l&&isHorizontal$2(l.direction)?{minMaxBox:{x:e}}:{minMaxBox:{y:e}}).registerChannelEncoder("max",(r,e,i,n,o,l)=>l&&isHorizontal$2(l.direction)?{minMaxBox:{x1:e}}:{minMaxBox:{y1:e}}).registerChannelEncoder("median",(r,e,i,n,o,l)=>l&&isHorizontal$2(l.direction)?{median:{x:e,x1:e,visible:!0}}:{median:{y:e,y1:e,visible:!0}}).registerChannelEncoder("angle",(r,e,i,n,o,l)=>{var d;const u=(d=i.anchor)!==null&&d!==void 0?d:[i.x,(i.min+i.max)/2];return{minMaxBox:{angle:e,anchor:u},q1q3Box:{angle:e,anchor:u},median:{angle:e,anchor:u}}}).registerChannelEncoder("lineWidth",(r,e,i,n,o,l)=>({minMaxBox:{lineWidth:0},q1q3Box:{lineWidth:0}})).registerChannelEncoder("minMaxFillOpacity",(r,e,i,n,o,l)=>({minMaxBox:{fillOpacity:e}})).registerChannelEncoder("stroke",(r,e,i,n,o,l)=>({minMaxBox:{stroke:!1},q1q3Box:{stroke:!1}})).registerDefaultEncoder(()=>({minMaxBox:{lineWidth:0},q1q3Box:{lineWidth:0},median:{visible:!1}})),Factory.registerAnimationType("barBoxplotScaleIn",barBoxplotScaleIn),Factory.registerAnimationType("barBoxplotScaleOut",barBoxplotScaleOut),registerGlyphMark(),registerGlyphGraphic(),registerRectGraphic(),registerRuleGraphic()}const registerRippleGlyph=()=>{Factory.registerGlyph("ripplePoint",{symbol:"symbol",ripple0:"symbol",ripple1:"symbol",ripple2:"symbol"}).registerFunctionEncoder((r,e,i,n)=>{var o;const l=Math.max(0,Math.min(r.ripple,1)),d=(o=r.size)!==null&&o!==void 0?o:i.getGraphicAttribute("size"),u=.5*d;return{ripple0:{size:d+u*l,fillOpacity:.75-.25*l},ripple1:{size:d+u*(1+l),fillOpacity:.5-.25*l},ripple2:{size:d+u*(2+l),fillOpacity:.25-.25*l}}}).registerDefaultEncoder(()=>({ripple0:{fillOpacity:.75},ripple1:{fillOpacity:.5},ripple2:{fillOpacity:.25}})),registerGlyphMark(),registerGlyphGraphic(),registerSymbolGraphic()},getHorizontalPath=(r,e)=>{var i;const n=(i=r.curvature)!==null&&i!==void 0?i:.5,o=typeof e=="number"?r.thickness*e:r.thickness;let l=r.x0,d=r.x1,u=r.y0,f=r.y1,g=l+n*(d-l),_=d+n*(l-d),y=T=>T;r.round!==!1&&(l=Math.round(l),d=Math.round(d),u=Math.round(u),f=Math.round(f),g=Math.round(g),_=Math.round(_),y=Math.round),r.pathType==="line"||r.pathType,r.align==="center"?(u=y(r.y0-o/2),f=y(r.y1-o/2)):r.align==="end"?(u=y(r.y0+r.thickness/2-o),f=y(r.y1+r.thickness/2-o)):(u=y(r.y0-r.thickness/2),f=y(r.y1-r.thickness/2));const b=y(u+o),S=y(f+o),v=Math.abs(d-l)>1e-6,A=r.endArrow&&v?`L${d},${y(f-o/2)}L${y(d+o)},${y((f+S)/2)}L${d},${y(S+o/2)}`:"",x=r.startArrow&&v?`L${l},${y(b+o/2)}L${y(l-o)},${y((u+b)/2)}L${l},${y(u-o/2)}`:"";return r.pathType==="line"?`M${l},${u}L${d},${f}${A}L${d},${S}L${l},${b}${x}Z`:r.pathType==="polyline"?`M${l},${u}L${g},${u}L${g},${f}L${d},${f}
    ${A}L${d},${S}L${g},${S}L${g},${b}L${l},${b}${x}Z`:`M${l},${u}C${g},${u},${_},${f},${d},${f}
  ${A}L${d},${S}C${_},${S},${g},${b},${l},${b}${x}Z`},getVerticalPath=(r,e)=>{var i;const n=(i=r.curvature)!==null&&i!==void 0?i:.5,o=typeof e=="number"?r.thickness*e:r.thickness;let l=r.y0,d=r.y1,u=r.x0,f=r.x1,g=l+n*(d-l),_=d+n*(l-d),y=T=>T;r.round!==!1&&(y=Math.round,l=Math.round(l),d=Math.round(d),u=Math.round(u),f=Math.round(f),g=Math.round(g),_=Math.round(_)),r.pathType==="line"||r.pathType,r.align==="center"?(u=y(r.x0-o/2),f=y(r.x1-o/2)):r.align==="end"?(u=y(r.x0+r.thickness/2-o),f=y(r.x1+r.thickness/2-o)):(u=y(r.x0-r.thickness/2),f=y(r.x1-r.thickness/2));const b=y(u+o),S=y(f+o),v=Math.abs(d-l)>1e-6,A=r.endArrow&&v?`L${y(f-o/2)},${d}L${y((f+S)/2)},${y(d+o)}L${y(S+o/2)},${d}`:"",x=r.startArrow&&v?`L${y(b+o/2)},${l}L${y((b+u)/2)},${y(l-o)}L${y(u-o/2)},${l}`:"";return r.pathType==="line"?`M${u},${l}L${f},${d}${A}L${S},${d}L${b},${l}${x}Z`:r.pathType==="polyline"?`M${u},${l}L${u},${g}L${f},${g}L${f},${d}
    ${A}L${S},${d}L${S},${g}L${b},${g}L${b},${l}${x}Z`:`M${u},${l}C${u},${g},${f},${_},${f},${d}
  ${A}L${S},${d}C${S},${_},${b},${g},${b},${l}${x}Z`},encoder=(r,e,i,n)=>{var o;const l=(o=r.direction)!==null&&o!==void 0?o:n==null?void 0:n.direction,d=["vertical","TB","BT"].includes(l)?getVerticalPath:getHorizontalPath,u=typeof r.ratio=="number"&&r.ratio>=0&&r.ratio<=1,f=Object.keys(r);return["x0","y0","x1","y1"].every(g=>f.includes(g))?{back:{path:u?d(r,1):""},front:{path:d(r,u?r.ratio:1)}}:{}},linkPathGrowIn=(r,e,i)=>{const n={x0:r.getGraphicAttribute("x0",!1),x1:r.getGraphicAttribute("x1",!1),y0:r.getGraphicAttribute("y0",!1),y1:r.getGraphicAttribute("y1",!1),thickness:r.getGraphicAttribute("thickness",!1),round:r.getGraphicAttribute("round",!1),align:r.getGraphicAttribute("align",!1),pathType:r.getGraphicAttribute("pathType",!1),endArrow:r.getGraphicAttribute("endArrow",!1),startArrow:r.getGraphicAttribute("startArrow",!1)};return Object.keys(n).forEach(o=>{isNil(n[o])&&delete n[o]}),{from:Object.assign({},n,{x1:n.x0,y1:n.y0}),to:n}},linkPathGrowOut=(r,e,i)=>{const n={x0:r.getGraphicAttribute("x0",!0),x1:r.getGraphicAttribute("x1",!0),y0:r.getGraphicAttribute("y0",!0),y1:r.getGraphicAttribute("y1",!0),thickness:r.getGraphicAttribute("thickness",!0),round:r.getGraphicAttribute("round",!0),align:r.getGraphicAttribute("align",!0),pathType:r.getGraphicAttribute("pathType",!0),endArrow:r.getGraphicAttribute("endArrow",!0),startArrow:r.getGraphicAttribute("startArrow",!0)};return Object.keys(n).forEach(o=>{isNil(n[o])&&delete n[o]}),{from:n,to:Object.assign({},n,{x1:n.x0,y1:n.y0})}},linkPathUpdate=(r,e,i)=>{const n={thickness:r.getGraphicAttribute("thickness",!1),round:r.getGraphicAttribute("round",!1),align:r.getGraphicAttribute("align",!1),pathType:r.getGraphicAttribute("pathType",!1),endArrow:r.getGraphicAttribute("endArrow",!1),startArrow:r.getGraphicAttribute("startArrow",!1)};return Object.keys(n).forEach(o=>{isNil(n[o])&&delete n[o]}),{from:Object.assign(Object.assign({x0:r.getGraphicAttribute("x0",!0),x1:r.getGraphicAttribute("x1",!0),y0:r.getGraphicAttribute("y0",!0),y1:r.getGraphicAttribute("y1",!0)},n),n),to:Object.assign({x0:r.getGraphicAttribute("x0",!1),x1:r.getGraphicAttribute("x1",!1),y0:r.getGraphicAttribute("y0",!1),y1:r.getGraphicAttribute("y1",!1)},n)}},registerLinkPathGlyph=()=>{Factory.registerGlyph("linkPath",{back:"path",front:"path"}).registerFunctionEncoder(encoder).registerChannelEncoder("backgroundStyle",(r,e)=>({back:e})).registerDefaultEncoder(()=>({back:{zIndex:0},front:{zIndex:1}})),Factory.registerAnimationType("linkPathGrowIn",linkPathGrowIn),Factory.registerAnimationType("linkPathGrowOut",linkPathGrowOut),Factory.registerAnimationType("linkPathUpdate",linkPathUpdate),registerGlyphMark(),registerGlyphGraphic(),registerPathGraphic()};class ScaleComponent extends Component{parseAddition(e){return super.parseAddition(e),this.scale(e.scale),this}scale(e){if(this.spec.scale){const n=isString(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale;this.detach(n),this.spec.scale=void 0}const i=isString(e)?this.view.getScaleById(e):e;return this.spec.scale=i,this.attach(i),this._updateComponentEncoders(),this.commit(),this}getScale(){return isString(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale}}const generateLineAxisAttributes=(r,e,i,n)=>{var o,l,d,u;const f=(l=(o=e==null?void 0:e.components)===null||o===void 0?void 0:o.axis)!==null&&l!==void 0?l:{};if(!r)return merge$1({},f,i??{});const g=[((u=(d=r.tickData)===null||d===void 0?void 0:d.call(r,n))!==null&&u!==void 0?u:[]).map(_=>({id:_.index,label:_.tick,value:_.value,rawValue:_.tick}))];return merge$1({},f,{items:g},i??{})},generateCircleAxisAttributes=(r,e,i,n)=>{var o,l,d,u;const f=(l=(o=e==null?void 0:e.components)===null||o===void 0?void 0:o.circleAxis)!==null&&l!==void 0?l:{};if(!r)return merge$1({},f,i??{});const g=[((u=(d=r.tickData)===null||d===void 0?void 0:d.call(r,n))!==null&&u!==void 0?u:[]).map(_=>({id:_.index,label:_.tick,value:_.value,rawValue:_.tick}))];return merge$1({},f,{items:g},i??{})},generateCoordinateAxisAttribute=(r,e,i,n,o,l)=>{var d;const u=r.getCoordinateAxisPosition();o&&o.position==="auto"&&(o.position=i?"content":u);const f=r.getCoordinateAxisPoints(n);if(f){const y={start:f[0],end:f[1],verticalFactor:(u==="top"||u==="left"?-1:1)*(i?-1:1)*(!((d=r.getSpec().range)===null||d===void 0)&&d.reversed?-1:1)};if(l&&e.type==="polar"){const b=e.angle();y.center=e.origin(),y.startAngle=b[0],y.endAngle=b[1]}return y}const g=e.radius(),_=e.angle();return{center:e.origin(),radius:g[1],innerRadius:g[0],inside:i,startAngle:_[0],endAngle:_[1]}};class Axis extends ScaleComponent{constructor(e,i,n){super(e,ComponentEnum.axis,i),this.spec.componentType=ComponentEnum.axis,this.mode=n}parseAddition(e){return super.parseAddition(e),this.axisType(e.axisType),this.tickCount(e.tickCount),this.inside(e.inside),this.baseValue(e.baseValue),this}scale(e){return super.scale(e),this._axisComponentType=null,this}axisType(e){return this.spec.axisType=e,this._axisComponentType=null,this._prepareRejoin(),this.commit(),this}addGraphicItem(e,i){const n=merge$1({x:0,y:0,start:{x:0,y:0},end:{x:0,y:0}},e),o=Factory.createGraphicComponent(this._getAxisComponentType(),n,{mode:this.mode,skipDefault:this.spec.skipTheme});return super.addGraphicItem(n,i,o)}tickCount(e){const i=isString(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale;return i&&i.tickCount(e),this.setFunctionSpec(e,"tickCount")}inside(e){return this.setFunctionSpec(e,"inside")}baseValue(e){return this.setFunctionSpec(e,"baseValue")}getAxisComponentType(){return this._axisComponentType}_updateComponentEncoders(){const e=isString(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale,i=Object.assign({update:{}},this.spec.encode),n=Object.keys(i).reduce((o,l)=>{const d=i[l];return d&&(o[l]={callback:(u,f,g)=>{var _,y;const b=this.spec.skipTheme?null:this.view.getCurrentTheme();let S=invokeEncoder(d,u,f,g);const v=invokeFunctionType(this.spec.inside,g,u,f),A=invokeFunctionType(this.spec.baseValue,g,u,f),x=(_=e==null?void 0:e.getCoordinate)===null||_===void 0?void 0:_.call(e);x&&(S=Object.assign(generateCoordinateAxisAttribute(e,x,v,A,this.spec.layout),S));const T=(y=e==null?void 0:e.getScale)===null||y===void 0?void 0:y.call(e),C=invokeFunctionType(this.spec.tickCount,g,u,f);switch(this._getAxisComponentType()){case AxisEnum.lineAxis:return generateLineAxisAttributes(T,b,S,C);case AxisEnum.circleAxis:return generateCircleAxisAttributes(T,b,S,C)}return S}}),o},{});this._encoders=n}_getAxisComponentType(){var e;if(this._axisComponentType)return this._axisComponentType;let i=this.spec.axisType;if(isNil(i)){const n=isString(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale;i=!((e=n==null?void 0:n.getCoordinate)===null||e===void 0)&&e.call(n)?n.getCoordinateAxisPoints()?"line":"circle":"line"}return this._axisComponentType=i==="circle"?AxisEnum.circleAxis:AxisEnum.lineAxis,this._axisComponentType}}Axis.componentType=ComponentEnum.axis;const registerLineAxis=()=>{Factory.registerGraphicComponent(AxisEnum.lineAxis,(r,e)=>new LineAxis(r,e)),Factory.registerComponent(ComponentEnum.axis,Axis)},registerCircleAxis=()=>{Factory.registerGraphicComponent(AxisEnum.circleAxis,r=>new CircleAxis(r)),Factory.registerComponent(ComponentEnum.axis,Axis)};var __rest$j=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};const generateLabelAttributes=(r,e,i,n,o,l={})=>{var d;const u=(d=l.components)===null||d===void 0?void 0:d.dataLabel,f=r.map((_,y)=>{var b,S,v,A,x;const T=Object.assign(Object.assign({},o),{labelIndex:y}),C=(b=invokeFunctionType(n,T,_))!==null&&b!==void 0?b:{},{components:E={}}=l;let P={};switch(_.markType){case GrammarMarkType.line:case GrammarMarkType.area:P=C.type==="line"?E.lineLabel:C.type==="area"?E.areaLabel:E.lineDataLabel;break;case GrammarMarkType.rect:case GrammarMarkType.rect3d:case GrammarMarkType.interval:P=E.rectLabel;break;case GrammarMarkType.symbol:case GrammarMarkType.circle:case GrammarMarkType.cell:P=E.symbolLabel;break;case GrammarMarkType.arc:case GrammarMarkType.arc3d:P=E.arcLabel;break;case GrammarMarkType.polygon:case GrammarMarkType.path:default:P=E.pointLabel}const R=(S=C.data)!==null&&S!==void 0?S:[],L=(A=(v=P==null?void 0:P.data)===null||v===void 0?void 0:v[0])!==null&&A!==void 0?A:{};if(R&&R.length>0)R.forEach((I,D)=>{if(_.elements[D]){const O=invokeEncoder(i,I,_.elements[D],T);merge$1(I,L,O)}});else{const I=(D,O)=>{const{data:N}=D,V=__rest$j(D,["data"]);return Object.assign(Object.assign({},merge$1({},O,V)),{data:N})};_.elements.forEach(D=>{if(D.getGraphicItem().releaseStatus!=="willRelease")if(_.isCollectionMark())D.getDatum().forEach(O=>{const N=invokeEncoder(i,O,D,T);R.push(I(N,L))});else{const O=invokeEncoder(i,D.getDatum(),D,T);R.push(I(O,L))}})}const w=(x=_.graphicItem)===null||x===void 0?void 0:x.name,B=merge$1({},P,{baseMarkGroupName:w,getBaseMarks:()=>_.elements.map(I=>I.getGraphicItem())},C??{});return B.data=R??P.data,B}).filter(_=>!isNil(_)),g=merge$1({},u,{size:e});return g.dataLabels=f,g};let Label$1=class extends Component{constructor(e,i){super(e,ComponentEnum.label,i),this.spec.componentType=ComponentEnum.label}parseAddition(e){return super.parseAddition(e),this.labelStyle(e.labelStyle),this.size(e.size),this.target(e.target),this}labelStyle(e){return this.setFunctionSpec(e,"labelStyle")}size(e){return this.setFunctionSpec(e,"size")}target(e){if(this.spec.target){const i=array(this.spec.target).map(n=>isString(n)?this.view.getMarkById(n):n);this.detach(i)}if(this.spec.target=e,e){const i=array(e).map(n=>isString(n)?this.view.getMarkById(n):n);this.attach(i)}return this.commit(),this}_updateComponentEncoders(){const e=Object.assign({update:{}},this.spec.encode),i=Object.keys(e).reduce((n,o)=>{const l=e[o];return l&&(n[o]={callback:(d,u,f)=>{var g,_,y,b;const S=array(this.spec.target).map(T=>isString(T)?this.view.getMarkById(T):T),v=(_=(g=this.group)===null||g===void 0?void 0:g.getGroupGraphicItem)===null||_===void 0?void 0:_.call(g);let A=invokeFunctionType(this.spec.size,f);A||(A=v?{width:(y=v.attribute.width)!==null&&y!==void 0?y:v.AABBBounds.width(),height:(b=v.attribute.height)!==null&&b!==void 0?b:v.AABBBounds.height()}:{width:1/0,height:1/0});const x=this.spec.skipTheme?null:this.view.getCurrentTheme();return generateLabelAttributes(S,A,l,this.spec.labelStyle,f,x)}}),n},{});this._encoders=i}};Label$1.componentType=ComponentEnum.label;const registerLabel$1=()=>{Factory.registerGraphicComponent(ComponentEnum.label,r=>new DataLabel(r)),Factory.registerComponent(ComponentEnum.label,Label$1)},generateLineAxisGridAttributes=(r,e,i,n)=>{var o,l,d,u;const f=(l=(o=e==null?void 0:e.components)===null||o===void 0?void 0:o.grid)!==null&&l!==void 0?l:{};if(!r)return merge$1({},f,i??{});const g=((u=(d=r.tickData)===null||d===void 0?void 0:d.call(r,n))!==null&&u!==void 0?u:[]).map(_=>({id:_.index,label:_.tick,value:_.value,rawValue:_.tick}));return merge$1({},f,{items:g},i??{})},generateCircleAxisGridAttributes=(r,e,i,n)=>{var o,l,d,u;const f=(l=(o=e==null?void 0:e.components)===null||o===void 0?void 0:o.circleGrid)!==null&&l!==void 0?l:{};if(!r)return merge$1({},f,i??{});const g=((u=(d=r.tickData)===null||d===void 0?void 0:d.call(r,n))!==null&&u!==void 0?u:[]).map(_=>({id:_.index,label:_.tick,value:_.value,rawValue:_.tick}));return merge$1({},f,{items:g},i??{})};class Grid extends ScaleComponent{constructor(e,i,n){super(e,ComponentEnum.grid,i),this.spec.componentType=ComponentEnum.grid,this.mode=n}parseAddition(e){return super.parseAddition(e),this.target(e.target),this.gridType(e.gridType),this.gridShape(e.gridShape),this}scale(e){return super.scale(e),this._gridComponentType=null,this}gridType(e){return this.spec.gridType=e,this._gridComponentType=null,this._prepareRejoin(),this.commit(),this}gridShape(e){return this.spec.gridShape=e,this.commit(),this}target(e){if(this.spec.target){const n=isString(this.spec.target)?this.view.getMarkById(this.spec.target):this.spec.target;this.detach(n)}this.spec.target=e;const i=isString(e)?this.view.getMarkById(e):e;return this.attach(i),this._targetAxis=i,this._gridComponentType=null,this._updateComponentEncoders(),this.commit(),this}tickCount(e){const i=isString(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale;return i&&i.tickCount(e),this.setFunctionSpec(e,"tickCount")}inside(e){return this.setFunctionSpec(e,"inside")}baseValue(e){return this.setFunctionSpec(e,"baseValue")}addGraphicItem(e,i){const n=merge$1({x:0,y:0,start:{x:0,y:0},end:{x:0,y:0}},e),o=Factory.createGraphicComponent(this._getGridComponentType(),n,{mode:this.mode,skipDefault:this.spec.skipTheme});return super.addGraphicItem(n,i,o)}_updateComponentEncoders(){const e=Object.assign({update:{}},this.spec.encode),i=Object.keys(e).reduce((n,o)=>{const l=e[o];return l&&(n[o]={callback:(d,u,f)=>{var g,_,y,b;const S=this.spec.skipTheme?null:this.view.getCurrentTheme();let v,A=invokeEncoder(l,d,u,f);const x=invokeFunctionType(this.spec.baseValue,f,d,u);if(this._targetAxis){const E=(g=this._targetAxis.getSpec())===null||g===void 0?void 0:g.scale;v=isString(E)?this.view.getScaleById(E):E;const P=this._targetAxis.elements[0];if(P)switch(this._getGridComponentType()){case GridEnum.lineAxisGrid:A=Object.assign({x:P.getGraphicAttribute("x"),y:P.getGraphicAttribute("y"),start:P.getGraphicAttribute("start"),end:P.getGraphicAttribute("end"),verticalFactor:(_=P.getGraphicAttribute("verticalFactor"))!==null&&_!==void 0?_:1},A);break;case GridEnum.circleAxisGrid:A=Object.assign({x:P.getGraphicAttribute("x"),y:P.getGraphicAttribute("y"),center:P.getGraphicAttribute("center"),radius:P.getGraphicAttribute("radius"),innerRadius:P.getGraphicAttribute("innerRadius"),inside:P.getGraphicAttribute("inside"),startAngle:P.getGraphicAttribute("startAngle"),endAngle:P.getGraphicAttribute("endAngle")},A)}}else{v=isString(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale;const E=invokeFunctionType(this.spec.inside,f,d,u),P=(y=v==null?void 0:v.getCoordinate)===null||y===void 0?void 0:y.call(v);P&&(A=Object.assign(generateCoordinateAxisAttribute(v,P,E,x,this.spec.layout,!0),A))}this._getGridComponentType()===GridEnum.lineAxisGrid&&(A=this.spec.gridShape!=="line"&&this.spec.gridShape?Object.assign({center:A.start,closed:!0},A,{type:this.spec.gridShape}):Object.assign({},A,{type:"line"}));const T=(b=v==null?void 0:v.getScale)===null||b===void 0?void 0:b.call(v),C=invokeFunctionType(this.spec.tickCount,f,d,u);switch(this._getGridComponentType()){case GridEnum.lineAxisGrid:return generateLineAxisGridAttributes(T,S,A,C);case GridEnum.circleAxisGrid:return generateCircleAxisGridAttributes(T,S,A,C)}return A}}),n},{});this._encoders=i}_getGridComponentType(){var e;if(this._gridComponentType)return this._gridComponentType;if(this.spec.gridType)this.spec.gridType==="circle"?this._gridComponentType=GridEnum.circleAxisGrid:this._gridComponentType=GridEnum.lineAxisGrid;else if(this._targetAxis)switch(this._targetAxis.getAxisComponentType()){case AxisEnum.circleAxis:this._gridComponentType=GridEnum.circleAxisGrid;break;case AxisEnum.lineAxis:default:this._gridComponentType=GridEnum.lineAxisGrid}else if(this.spec.scale){const i=isString(this.spec.scale)?this.view.getScaleById(this.spec.scale):this.spec.scale;this._gridComponentType=!((e=i==null?void 0:i.getCoordinate)===null||e===void 0)&&e.call(i)?i.getCoordinateAxisPoints()?GridEnum.lineAxisGrid:GridEnum.circleAxisGrid:GridEnum.lineAxisGrid}else this._gridComponentType=GridEnum.lineAxisGrid;return this._gridComponentType}}Grid.componentType=ComponentEnum.grid;const registerLineGrid=()=>{Factory.registerGraphicComponent(GridEnum.lineAxisGrid,(r,e)=>new LineAxisGrid(r,e)),Factory.registerComponent(ComponentEnum.grid,Grid)},registerCircleGrid=()=>{Factory.registerGraphicComponent(GridEnum.circleAxisGrid,(r,e)=>new CircleAxisGrid(r,e)),Factory.registerComponent(ComponentEnum.grid,Grid)},transform$7=(r,e,i)=>e.filter(n=>r.callback(n,i)),transform$6=(r,e,i)=>{const n=r.callback,o=r.as;if(!r.all)return e.forEach(d=>{const u=n(d,i);if(!isNil(o)){if(isNil(d))return;d[o]=u}return u}),e;const l=n(e,i);return isNil(o)||isNil(e)?l:(e[o]=l,e)};function sum(r){return r.reduce((e,i)=>e+i,0)}function average(r){return r.length===0?0:sum(r)/r.length}const samplerMap={min:minInArray,max:maxInArray,average,sum};function lttb(r,e,i,n){const o=Math.floor(e.length/r),l=[],d=e.length;let u,f,g,_=0,y=0;l[y++]=_;for(let b=1;b<d-1;b+=o){const S=Math.min(b+o,d-1),v=Math.min(b+2*o,d),A=(v+S)/2;let x=0;for(let R=S;R<v;R++){const L=e[R][n];Number.isNaN(L)||(x+=L)}x/=v-S;const T=b,C=Math.min(b+o,d),E=b-1,P=e[_][n];u=-1,g=T;for(let R=T;R<C;R++){const L=e[R][n];Number.isNaN(n)||(f=Math.abs((E-A)*(L-P)-(E-R)*(x-P)),f>u&&(u=f,g=R))}l[y++]=g,_=g}return l[y-1]!==d-1&&(l[y++]=d-1),l.map(b=>i?e[b].i:b)}function sample(r,e,i,n,o){let l=Math.floor(e.length/r);const d=[],u=e.length;let f=0,g=[];d.push(f),e[f][o]=e[f][o];for(let _=1;_<u-1;_+=l){l>u-_&&(l=u-_,g.length=l),g=[];for(let b=0;b<l;b++)g.push(e[_+b][o]);const y=samplerMap[n](g);f=Math.min(Math.round(_+g.length/2)||0,u-1),e[f][o]=y,d.push(f)}return d.map(_=>i?e[_].i:_)}function sampleMin(r,e,i,n){return sample(r,e,i,"min",n)}function sampleMax(r,e,i,n){return sample(r,e,i,"max",n)}function sampleAverage(r,e,i,n){return sample(r,e,i,"average",n)}function sampleSum(r,e,i,n){return sample(r,e,i,"sum",n)}const transform$5=(r,e)=>{let i=r.size;const n=r.factor||1;if(Array.isArray(i)&&(i=Math.floor(i[1]-i[0])),i*=n,i<=0)return[];if(e.length<=i)return e;if(r.skipfirst)return e.slice(0,1);const{mode:o,yfield:l,groupBy:d}=r,u=l??"y";let f=lttb;if(o==="min"?f=sampleMin:o==="max"?f=sampleMax:o==="average"?f=sampleAverage:o==="sum"&&(f=sampleSum),e.length){const g={};if(d){for(let y=0,b=e.length;y<b;y++){const S=e[y],v=S[d];g[v]?g[v].push({[u]:S[u],i:y}):(g[v]=[],g[v].push({[u]:S[u],i:y}))}let _=[];return Object.keys(g).forEach(y=>{const b=g[y];if(b.length<=i){const S=b.map(v=>v.i);_=_.concat(S)}else{const S=f(i,b,!0,u);_=_.concat(S),b.forEach(v=>e[v.i][u]=v[u])}}),_.sort((y,b)=>y-b),_.map(y=>e[y])}return f(i,e,!1,u).map(_=>e[_])}return[]};function reset(r){return r.forEach(e=>{e.getGraphicAttribute(MARK_OVERLAP_HIDE_KEY)&&(e.setGraphicAttribute("visible",!0),e.setGraphicAttribute(MARK_OVERLAP_HIDE_KEY,!1))}),r}function overlapX(r,e,i,n){if(n){let o=-1/0,l=0;const d=isNil(e);let u=e;r.forEach(f=>{if(f.getGraphicAttribute("visible")===!1)return;const g=f.getGraphicAttribute("size")/2,_=f.getGraphicAttribute("x");d&&(u=(g+l)*i),Math.abs(_-o)<u+l+g?f.getGraphicAttribute("forceShow")||(f.setGraphicAttribute(MARK_OVERLAP_HIDE_KEY,!0),f.setGraphicAttribute("visible",!1)):o=_,l=g})}}function overlapY(r,e,i,n){if(n){let o=-1/0,l=0;const d=isNil(e);let u=e;r.forEach(f=>{if(f.getGraphicAttribute("visible")===!1)return;const g=f.getGraphicAttribute("size")/2,_=f.getGraphicAttribute("y");d&&(u=(g+l)*i),Math.abs(_-o)<u+l+g?f.getGraphicAttribute("forceShow")||(f.setGraphicAttribute(MARK_OVERLAP_HIDE_KEY,!0),f.setGraphicAttribute("visible",!1)):o=_,l=g})}}function overlapXY(r,e,i,n){if(n){let l=-1/0,d=0,u=0;const f=isNil(e);let g=e;r.forEach(_=>{if(_.getGraphicAttribute("visible")===!1)return;const y=_.getGraphicAttribute("size")/2,b=_.getGraphicAttribute("x"),S=_.getGraphicAttribute("y");f&&(g=(y+d)*i),u=(-1/0-b)**2+(l-S)**2,u<(g+d+y)**2?_.getGraphicAttribute("forceShow")||(_.setGraphicAttribute(MARK_OVERLAP_HIDE_KEY,!0),_.setGraphicAttribute("visible",!1)):l=S,d=y})}}const transform$4=(r,e)=>{if(!e||e.length===0)return;let{radius:i}=r;isNil(i)&&e[0].mark.markType==="symbol"&&(i=!0);const{direction:n,delta:o,deltaMul:l=1,groupBy:d}=r,u=f=>{reset(f);const g=r.sort?f.slice().sort((_,y)=>_.getGraphicAttribute("x")-y.getGraphicAttribute("x")):f;n===0?overlapXY(g,o,l,i):n===1?overlapX(g,o,l,i):overlapY(g,o,l,i)};if(d){const f=e.reduce((g,_)=>{const y=_.getDatum()[d];return g[y]?g[y].push(_):g[y]=[_],g},{});Object.keys(f).forEach(g=>{u(f[g])})}else u(e);return e},registerFilterTransform=()=>{Factory.registerTransform("filter",{transform:transform$7,markPhase:"beforeJoin"},!0)},registerMapTransform=()=>{Factory.registerTransform("map",{transform:transform$6,markPhase:"beforeJoin"},!0)},registerSampleTransform=()=>{Factory.registerTransform("sampling",{transform:transform$5,markPhase:"afterEncode"},!0)},registerMarkOverlapTransform=()=>{Factory.registerTransform("markoverlap",{transform:transform$4,markPhase:"afterEncode"},!0)},clipIn=(r,e,i)=>{var n;const o=r.getGraphicAttribute("clipRangeByDimension",!1),l=(n=r.getGraphicAttribute("clipRange",!1))!==null&&n!==void 0?n:1;return e&&e.clipDimension?{from:{clipRange:0,clipRangeByDimension:e.clipDimension},to:{clipRange:l,clipRangeByDimension:o}}:{from:{clipRange:0},to:{clipRange:l}}},clipOut=(r,e,i)=>{var n;const o=r.getGraphicAttribute("clipRangeByDimension",!0),l=(n=r.getGraphicAttribute("clipRange",!0))!==null&&n!==void 0?n:1;return e&&e.clipDimension?{from:{clipRange:l,clipRangeByDimension:e.clipDimension},to:{clipRange:0,clipRangeByDimension:o}}:{from:{clipRange:l},to:{clipRange:0}}},fadeIn=(r,e,i)=>{var n,o,l,d;const u=(n=r.getFinalAnimationAttributes())!==null&&n!==void 0?n:{};return{from:{opacity:0,fillOpacity:0,strokeOpacity:0},to:{opacity:(o=u.opacity)!==null&&o!==void 0?o:1,fillOpacity:(l=u.fillOpacity)!==null&&l!==void 0?l:1,strokeOpacity:(d=u.strokeOpacity)!==null&&d!==void 0?d:1}}},fadeOut=(r,e,i)=>{var n,o,l;return{from:{opacity:(n=r.getGraphicAttribute("opacity",!0))!==null&&n!==void 0?n:1,fillOpacity:(o=r.getGraphicAttribute("fillOpacity",!0))!==null&&o!==void 0?o:1,strokeOpacity:(l=r.getGraphicAttribute("strokeOpacity",!0))!==null&&l!==void 0?l:1},to:{opacity:0,fillOpacity:0,strokeOpacity:0}}},growCenterIn=(r,e,i)=>{switch(e==null?void 0:e.direction){case"x":{const n=r.getFinalAnimationAttribute("x"),o=r.getFinalAnimationAttribute("x1"),l=r.getFinalAnimationAttribute("width");return{from:isValid(l)?{x:n+l/2,x1:void 0,width:0}:{x:(n+o)/2,x1:(n+o)/2,width:void 0},to:{x:n,x1:o,width:l}}}case"y":{const n=r.getFinalAnimationAttribute("y"),o=r.getFinalAnimationAttribute("y1"),l=r.getFinalAnimationAttribute("height");return{from:isValid(l)?{y:n+l/2,y1:void 0,height:0}:{y:(n+o)/2,y1:(n+o)/2,height:void 0},to:{y:n,y1:o,height:l}}}default:{const n=r.getFinalAnimationAttribute("x"),o=r.getFinalAnimationAttribute("x1"),l=r.getFinalAnimationAttribute("width"),d=r.getFinalAnimationAttribute("y"),u=r.getFinalAnimationAttribute("y1"),f=r.getFinalAnimationAttribute("height"),g={};return isValid(l)?(g.x=n+l/2,g.width=0,g.x1=void 0):(g.x=(n+o)/2,g.x1=(n+o)/2,g.width=void 0),isValid(f)?(g.y=d+f/2,g.height=0,g.y1=void 0):(g.y=(d+u)/2,g.y1=(d+u)/2,g.height=void 0),{from:g,to:{x:n,y:d,x1:o,y1:u,width:l,height:f}}}}},growCenterOut=(r,e,i)=>{switch(e==null?void 0:e.direction){case"x":{const n=r.getFinalAnimationAttribute("x"),o=r.getFinalAnimationAttribute("x1"),l=r.getFinalAnimationAttribute("width");return{to:isValid(l)?{x:n+l/2,x1:void 0,width:0}:{x:(n+o)/2,x1:(n+o)/2,width:void 0}}}case"y":{const n=r.getFinalAnimationAttribute("y"),o=r.getFinalAnimationAttribute("y1"),l=r.getFinalAnimationAttribute("height");return{to:isValid(l)?{y:n+l/2,y1:void 0,height:0}:{y:(n+o)/2,y1:(n+o)/2,height:void 0}}}default:{const n=r.getFinalAnimationAttribute("x"),o=r.getFinalAnimationAttribute("y"),l=r.getFinalAnimationAttribute("x1"),d=r.getFinalAnimationAttribute("y1"),u=r.getFinalAnimationAttribute("width"),f=r.getFinalAnimationAttribute("height"),g={};return isValid(u)?(g.x=n+u/2,g.width=0,g.x1=void 0):(g.x=(n+l)/2,g.x1=(n+l)/2,g.width=void 0),isValid(f)?(g.y=o+f/2,g.height=0,g.y1=void 0):(g.y=(o+d)/2,g.y1=(o+d)/2,g.height=void 0),{to:g}}}};function growWidthInIndividual(r,e,i){const n=r.getFinalAnimationAttribute("x"),o=r.getFinalAnimationAttribute("x1"),l=r.getFinalAnimationAttribute("width");if(e&&e.orient==="negative"){const u=isValid(l)?Math.max(n,n+l):Math.max(n,o);return{from:{x:u,x1:isNil(o)?void 0:u,width:isNil(l)?void 0:0},to:{x:n,x1:o,width:l}}}const d=isValid(l)?Math.min(n,n+l):Math.min(n,o);return{from:{x:d,x1:isNil(o)?void 0:d,width:isNil(l)?void 0:0},to:{x:n,x1:o,width:l}}}function growWidthInOverall(r,e,i){var n;const o=r.getFinalAnimationAttribute("x"),l=r.getFinalAnimationAttribute("x1"),d=r.getFinalAnimationAttribute("width");let u;return e&&e.orient==="negative"?isNumber(e.overall)?u=e.overall:i.group?(u=(n=i.groupWidth)!==null&&n!==void 0?n:i.group.getBounds().width(),i.groupWidth=u):u=i.width:u=isNumber(e==null?void 0:e.overall)?e==null?void 0:e.overall:0,{from:{x:u,x1:isNil(l)?void 0:u,width:isNil(d)?void 0:0},to:{x:o,x1:l,width:d}}}const growWidthIn=(r,e,i)=>{var n;return((n=e==null?void 0:e.overall)!==null&&n!==void 0&&n)!==!1?growWidthInOverall(r,e,i):growWidthInIndividual(r,e)};function growWidthOutIndividual(r,e,i){const n=r.getFinalAnimationAttribute("x"),o=r.getFinalAnimationAttribute("x1"),l=r.getFinalAnimationAttribute("width");if(e&&e.orient==="negative"){const u=isValid(l)?Math.max(n,n+l):Math.max(n,o);return{to:{x:u,x1:isNil(o)?void 0:u,width:isNil(l)?void 0:0}}}const d=isValid(l)?Math.min(n,n+l):Math.min(n,o);return{to:{x:d,x1:isNil(o)?void 0:d,width:isNil(l)?void 0:0}}}function growWidthOutOverall(r,e,i){var n;const o=r.getFinalAnimationAttribute("x1"),l=r.getFinalAnimationAttribute("width");let d;return e&&e.orient==="negative"?isNumber(e.overall)?d=e.overall:i.group?(d=(n=i.groupWidth)!==null&&n!==void 0?n:i.group.getBounds().width(),i.groupWidth=d):d=i.width:d=isNumber(e==null?void 0:e.overall)?e.overall:0,{to:{x:d,x1:isNil(o)?void 0:d,width:isNil(l)?void 0:0}}}const growWidthOut=(r,e,i)=>{var n;return((n=e==null?void 0:e.overall)!==null&&n!==void 0&&n)!==!1?growWidthOutOverall(r,e,i):growWidthOutIndividual(r,e)};function growHeightInIndividual(r,e,i){const n=r.getFinalAnimationAttribute("y"),o=r.getFinalAnimationAttribute("y1"),l=r.getFinalAnimationAttribute("height");if(e&&e.orient==="negative"){const u=isValid(l)?Math.max(n,n+l):Math.max(n,o);return{from:{y:u,y1:isNil(o)?void 0:u,height:isNil(l)?void 0:0},to:{y:n,y1:o,height:l}}}const d=isValid(l)?Math.min(n,n+l):Math.min(n,o);return{from:{y:d,y1:isNil(o)?void 0:d,height:isNil(l)?void 0:0},to:{y:n,y1:o,height:l}}}function growHeightInOverall(r,e,i){var n;const o=r.getFinalAnimationAttribute("y"),l=r.getFinalAnimationAttribute("y1"),d=r.getFinalAnimationAttribute("height");let u;return e&&e.orient==="negative"?isNumber(e.overall)?u=e.overall:i.group?(u=(n=i.groupHeight)!==null&&n!==void 0?n:i.group.getBounds().height(),i.groupHeight=u):u=i.height:u=isNumber(e==null?void 0:e.overall)?e.overall:0,{from:{y:u,y1:isNil(l)?void 0:u,height:isNil(d)?void 0:0},to:{y:o,y1:l,height:d}}}const growHeightIn=(r,e,i)=>{var n;return((n=e==null?void 0:e.overall)!==null&&n!==void 0&&n)!==!1?growHeightInOverall(r,e,i):growHeightInIndividual(r,e)};function growHeightOutIndividual(r,e,i){const n=r.getFinalAnimationAttribute("y"),o=r.getFinalAnimationAttribute("y1"),l=r.getFinalAnimationAttribute("height");if(e&&e.orient==="negative"){const u=isValid(l)?Math.max(n,n+l):Math.max(n,o);return{to:{y:u,y1:isNil(o)?void 0:u,height:isNil(l)?void 0:0}}}const d=isValid(l)?Math.min(n,n+l):Math.min(n,o);return{to:{y:d,y1:isNil(o)?void 0:d,height:isNil(l)?void 0:0}}}function growHeightOutOverall(r,e,i){var n;const o=r.getFinalAnimationAttribute("y1"),l=r.getFinalAnimationAttribute("height");let d;return e&&e.orient==="negative"?isNumber(e.overall)?d=e.overall:i.group?(d=(n=i.groupHeight)!==null&&n!==void 0?n:i.group.getBounds().height(),i.groupHeight=d):d=i.height:d=isNumber(e==null?void 0:e.overall)?e.overall:0,{to:{y:d,y1:isNil(o)?void 0:d,height:isNil(l)?void 0:0}}}const growHeightOut=(r,e,i)=>{var n;return((n=e==null?void 0:e.overall)!==null&&n!==void 0&&n)!==!1?growHeightOutOverall(r,e,i):growHeightOutIndividual(r,e)},growAngleInIndividual=(r,e,i)=>{const n=r.getFinalAnimationAttributes();return e&&e.orient==="anticlockwise"?{from:{startAngle:n==null?void 0:n.endAngle},to:{startAngle:n==null?void 0:n.startAngle}}:{from:{endAngle:n==null?void 0:n.startAngle},to:{endAngle:n==null?void 0:n.endAngle}}},growAngleInOverall=(r,e,i)=>{const n=r.getFinalAnimationAttributes();if(e&&e.orient==="anticlockwise"){const l=isNumber(e.overall)?e.overall:2*Math.PI;return{from:{startAngle:l,endAngle:l},to:{startAngle:n==null?void 0:n.startAngle,endAngle:n==null?void 0:n.endAngle}}}const o=isNumber(e==null?void 0:e.overall)?e.overall:0;return{from:{startAngle:o,endAngle:o},to:{startAngle:n==null?void 0:n.startAngle,endAngle:n==null?void 0:n.endAngle}}},growAngleIn=(r,e,i)=>{var n;return((n=e==null?void 0:e.overall)!==null&&n!==void 0&&n)!==!1?growAngleInOverall(r,e):growAngleInIndividual(r,e)},growAngleOutIndividual=(r,e,i)=>{const n=r.getFinalAnimationAttributes();return e&&e.orient==="anticlockwise"?{from:{startAngle:r.getGraphicAttribute("startAngle",!0)},to:{startAngle:n==null?void 0:n.endAngle}}:{from:{endAngle:r.getGraphicAttribute("endAngle",!0)},to:{endAngle:n==null?void 0:n.startAngle}}},growAngleOutOverall=(r,e,i)=>{if(e&&e.orient==="anticlockwise"){const o=isNumber(e.overall)?e.overall:2*Math.PI;return{from:{startAngle:r.getGraphicAttribute("startAngle",!0),endAngle:r.getGraphicAttribute("endAngle",!0)},to:{startAngle:o,endAngle:o}}}const n=isNumber(e==null?void 0:e.overall)?e.overall:0;return{from:{startAngle:r.getGraphicAttribute("startAngle",!0),endAngle:r.getGraphicAttribute("endAngle",!0)},to:{startAngle:n,endAngle:n}}},growAngleOut=(r,e,i)=>{var n;return((n=e==null?void 0:e.overall)!==null&&n!==void 0&&n)!==!1?growAngleOutOverall(r,e):growAngleOutIndividual(r,e)},growRadiusInIndividual=(r,e,i)=>{const n=r.getFinalAnimationAttributes();return e&&e.orient==="inside"?{from:{innerRadius:n==null?void 0:n.outerRadius},to:{innerRadius:n==null?void 0:n.innerRadius}}:{from:{outerRadius:n==null?void 0:n.innerRadius},to:{outerRadius:n==null?void 0:n.outerRadius}}},growRadiusInOverall=(r,e,i)=>{const n=r.getFinalAnimationAttributes(),o=isNumber(e==null?void 0:e.overall)?e.overall:0;return{from:{innerRadius:o,outerRadius:o},to:{innerRadius:n==null?void 0:n.innerRadius,outerRadius:n==null?void 0:n.outerRadius}}},growRadiusIn=(r,e,i)=>{var n;return((n=e==null?void 0:e.overall)!==null&&n!==void 0&&n)!==!1?growRadiusInOverall(r,e):growRadiusInIndividual(r,e)},growRadiusOutIndividual=(r,e,i)=>{const n=r.getFinalAnimationAttributes();return e&&e.orient==="inside"?{from:{innerRadius:r.getGraphicAttribute("innerRadius",!0)},to:{innerRadius:n==null?void 0:n.outerRadius}}:{from:{outerRadius:r.getGraphicAttribute("outerRadius",!0)},to:{outerRadius:n==null?void 0:n.innerRadius}}},growRadiusOutOverall=(r,e,i)=>{const n=isNumber(e==null?void 0:e.overall)?e.overall:0;return{from:{innerRadius:r.getGraphicAttribute("innerRadius",!0),outerRadius:r.getGraphicAttribute("outerRadius",!0)},to:{innerRadius:n,outerRadius:n}}},growRadiusOut=(r,e,i)=>{var n;return((n=e==null?void 0:e.overall)!==null&&n!==void 0&&n)!==!1?growRadiusOutOverall(r,e):growRadiusOutIndividual(r,e)},getCenterPoints=(r,e,i)=>{const n=r.getGraphicAttribute("points",!1),o={x:0,y:0};return n.forEach(l=>{o.x+=l.x,o.y+=l.y}),o.x/=n.length,o.y/=n.length,e&&e.center&&(isValidNumber(e.center.x)&&(o.x=e.center.x),isValidNumber(e.center.y)&&(o.y=e.center.y)),r.mark.markType==="area"&&(o.x1=o.x,o.y1=o.y),n.map(l=>Object.assign({},l,o))},growPointsIn=(r,e,i)=>({from:{points:getCenterPoints(r,e)},to:{points:r.getGraphicAttribute("points",!1)}}),growPointsOut=(r,e,i)=>({from:{points:r.getGraphicAttribute("points",!0)},to:{points:getCenterPoints(r,e)}}),changePointsX=(r,e,i)=>r.getGraphicAttribute("points",!1).map(n=>{var o;if(e&&e.orient==="negative"){let l=i.width;return i.group&&(l=(o=i.groupWidth)!==null&&o!==void 0?o:i.group.getBounds().width(),i.groupWidth=l),Object.assign(Object.assign({},n),{x:l,y:n.y,x1:l,y1:n.y1,defined:n.defined!==!1})}return Object.assign(Object.assign({},n),{x:0,y:n.y,x1:0,y1:n.y1,defined:n.defined!==!1})}),growPointsXIn=(r,e,i)=>({from:{points:changePointsX(r,e,i)},to:{points:r.getGraphicAttribute("points",!1)}}),growPointsXOut=(r,e,i)=>({from:{points:r.getGraphicAttribute("points",!0)},to:{points:changePointsX(r,e,i)}}),changePointsY=(r,e,i)=>r.getGraphicAttribute("points",!1).map(n=>{var o;if(e&&e.orient==="negative"){let l=i.height;return i.group&&(l=(o=i.groupHeight)!==null&&o!==void 0?o:i.group.getBounds().height(),i.groupHeight=l),Object.assign(Object.assign({},n),{x:n.x,y:l,x1:n.x1,y1:l,defined:n.defined!==!1})}return Object.assign(Object.assign({},n),{x:n.x,y:0,x1:n.x1,y1:0,defined:n.defined!==!1})}),growPointsYIn=(r,e,i)=>({from:{points:changePointsY(r,e,i)},to:{points:r.getGraphicAttribute("points",!1)}}),growPointsYOut=(r,e,i)=>({from:{points:r.getGraphicAttribute("points",!0)},to:{points:changePointsY(r,e,i)}}),moveIn=(r,e,i)=>{var n,o;const{offset:l=0,orient:d,direction:u,point:f,excludeChannels:g=[]}=e??{};let _=0,y=0;d==="negative"&&(i.group?(_=(n=i.groupWidth)!==null&&n!==void 0?n:i.group.getBounds().width(),y=(o=i.groupHeight)!==null&&o!==void 0?o:i.group.getBounds().height(),i.groupWidth=_,i.groupHeight=y):(_=i.width,y=i.height)),_+=l,y+=l;const b=isFunction(f)?f.call(null,r.getDatum(),r,i):f,S=b&&isValidNumber(b.x)?b.x:_,v=b&&isValidNumber(b.y)?b.y:y,A=g.includes("x")?r.getGraphicAttribute("x"):r.getFinalAnimationAttribute("x"),x=g.includes("y")?r.getGraphicAttribute("y"):r.getFinalAnimationAttribute("y");switch(u){case"x":return{from:{x:S},to:{x:A}};case"y":return{from:{y:v},to:{y:x}};default:return{from:{x:S,y:v},to:{x:A,y:x}}}},moveOut=(r,e,i)=>{var n,o;const{offset:l=0,orient:d,direction:u,point:f}=e??{},g=i.group?i.group.getBounds():null,_=(n=g==null?void 0:g.width())!==null&&n!==void 0?n:i.width,y=(o=g==null?void 0:g.height())!==null&&o!==void 0?o:i.height,b=(d==="negative"?_:0)+l,S=(d==="negative"?y:0)+l,v=isFunction(f)?f.call(null,r.getDatum(),r,i):f,A=v&&isValidNumber(v.x)?v.x:b,x=v&&isValidNumber(v.y)?v.y:S;switch(u){case"x":return{from:{x:r.getGraphicAttribute("x",!0)},to:{x:A}};case"y":return{from:{y:r.getGraphicAttribute("y",!0)},to:{y:x}};default:return{from:{x:r.getGraphicAttribute("x",!0),y:r.getGraphicAttribute("y",!0)},to:{x:A,y:x}}}},scaleIn=(r,e,i)=>{var n,o,l,d;const u=r.getFinalAnimationAttributes();switch(e==null?void 0:e.direction){case"x":return{from:{scaleX:0},to:{scaleX:(n=u==null?void 0:u.scaleX)!==null&&n!==void 0?n:1}};case"y":return{from:{scaleY:0},to:{scaleY:(o=u==null?void 0:u.scaleY)!==null&&o!==void 0?o:1}};default:return{from:{scaleX:0,scaleY:0},to:{scaleX:(l=u==null?void 0:u.scaleX)!==null&&l!==void 0?l:1,scaleY:(d=u==null?void 0:u.scaleY)!==null&&d!==void 0?d:1}}}},scaleOut=(r,e,i)=>{var n,o,l,d;switch(e==null?void 0:e.direction){case"x":return{from:{scaleX:(n=r.getGraphicAttribute("scaleX",!0))!==null&&n!==void 0?n:1},to:{scaleX:0}};case"y":return{from:{scaleY:(o=r.getGraphicAttribute("scaleY",!0))!==null&&o!==void 0?o:1},to:{scaleY:0}};default:return{from:{scaleX:(l=r.getGraphicAttribute("scaleX",!0))!==null&&l!==void 0?l:1,scaleY:(d=r.getGraphicAttribute("scaleY",!0))!==null&&d!==void 0?d:1},to:{scaleX:0,scaleY:0}}}},BUILT_IN_EXCLUDE_CHANNELS={symbol:["_mo_hide_","visible"]},update=(r,e,i)=>{const n=Object.assign({},r.getPrevGraphicAttributes()),o=Object.assign({},r.getNextGraphicAttributes());let l;e&&array(e.excludeChannels).forEach(u=>{delete n[u],delete o[u]}),r.mark&&r.mark.markType&&(l=BUILT_IN_EXCLUDE_CHANNELS[r.mark.markType])&&l.forEach(u=>{delete n[u],delete o[u]}),Object.keys(o).forEach(u=>{isEqual(n[u],o[u])&&(delete n[u],delete o[u])});const d=r.getFinalGraphicAttributes();return Object.keys(n).forEach(u=>{isNil(o[u])&&(isNil(d[u])||isEqual(n[u],d[u])?delete n[u]:o[u]=d[u])}),{from:n,to:o}},rotateIn=(r,e,i)=>{var n;const o=(n=r.getFinalAnimationAttribute("angle"))!==null&&n!==void 0?n:0;let l=0;return l=isNumberClose(o/(2*Math.PI),0)?Math.round(o/(2*Math.PI))*Math.PI*2:isValidNumber(e==null?void 0:e.angle)?e.angle:(e==null?void 0:e.orient)==="anticlockwise"?Math.ceil(o/(2*Math.PI))*Math.PI*2:Math.floor(o/(2*Math.PI))*Math.PI*2,{from:{angle:l},to:{angle:o}}},rotateOut=(r,e,i)=>{var n;const o=(n=r.getGraphicAttribute("angle",!0))!==null&&n!==void 0?n:0;let l=0;return l=isNumberClose(o/(2*Math.PI),0)?Math.round(o/(2*Math.PI))*Math.PI*2:isValidNumber(e==null?void 0:e.angle)?e.angle:(e==null?void 0:e.orient)==="anticlockwise"?Math.ceil(o/(2*Math.PI))*Math.PI*2:Math.floor(o/(2*Math.PI))*Math.PI*2,{from:{angle:o},to:{angle:l}}},registerClipInAnimation=()=>{Factory.registerAnimationType("clipIn",clipIn)},registerClipOutAnimation=()=>{Factory.registerAnimationType("clipOut",clipOut)},registerFadeInAnimation=()=>{Factory.registerAnimationType("fadeIn",fadeIn)},registerFadeOutAnimation=()=>{Factory.registerAnimationType("fadeOut",fadeOut)},registerGrowCenterInAnimation=()=>{Factory.registerAnimationType("growCenterIn",growCenterIn)},registerGrowCenterOutAnimation=()=>{Factory.registerAnimationType("growCenterOut",growCenterOut)},registerGrowHeightInAnimation=()=>{Factory.registerAnimationType("growHeightIn",growHeightIn)},registerGrowHeightOutAnimation=()=>{Factory.registerAnimationType("growHeightOut",growHeightOut)},registerGrowWidthInAnimation=()=>{Factory.registerAnimationType("growWidthIn",growWidthIn)},registerGrowWidthOutAnimation=()=>{Factory.registerAnimationType("growWidthOut",growWidthOut)},registerGrowPointsInAnimation=()=>{Factory.registerAnimationType("growPointsIn",growPointsIn)},registerGrowPointsOutAnimation=()=>{Factory.registerAnimationType("growPointsOut",growPointsOut)},registerGrowPointsXInAnimation=()=>{Factory.registerAnimationType("growPointsXIn",growPointsXIn)},registerGrowPointsXOutAnimation=()=>{Factory.registerAnimationType("growPointsXOut",growPointsXOut)},registerGrowPointsYInAnimation=()=>{Factory.registerAnimationType("growPointsYIn",growPointsYIn)},registerGrowPointsYOutAnimation=()=>{Factory.registerAnimationType("growPointsYOut",growPointsYOut)},registerGrowAngleInAnimation=()=>{Factory.registerAnimationType("growAngleIn",growAngleIn)},registerGrowAngleOutAnimation=()=>{Factory.registerAnimationType("growAngleOut",growAngleOut)},registerGrowRadiusInAnimation=()=>{Factory.registerAnimationType("growRadiusIn",growRadiusIn)},registerGrowRadiusOutAnimation=()=>{Factory.registerAnimationType("growRadiusOut",growRadiusOut)},registerMoveInAnimation=()=>{Factory.registerAnimationType("moveIn",moveIn)},registerMoveOutAnimation=()=>{Factory.registerAnimationType("moveOut",moveOut)},registerScaleInAnimation=()=>{Factory.registerAnimationType("scaleIn",scaleIn)},registerScaleOutAnimation=()=>{Factory.registerAnimationType("scaleOut",scaleOut)},registerRotateInAnimation=()=>{Factory.registerAnimationType("rotateIn",rotateIn)},registerRotateOutAnimation=()=>{Factory.registerAnimationType("rotateOut",rotateOut)},registerUpdateAnimation=()=>{Factory.registerAnimationType("update",update)};class Cell extends Mark{encodeState(e,i,n){return super.encodeState(e,i,n),this._updateComponentEncoders(e),this}_updateComponentEncoders(e){this._encoders||(this._encoders={});const i=this.spec.encode[e];if(i&&e==="update"){const n=this.parameters(),o=isFunctionType(i)?null:Object.keys(i).reduce((l,d)=>(isScaleEncode(i[d])&&(l[d]=getGrammarOutput(i[d].scale,n)),l),{});this._encoders[e]={callback:(l,d,u)=>{const f=invokeEncoder(i,l,d,u);if(isNil(f.size)){const g=o.x?getBandWidthOfScale(o.x):void 0,_=o.y?getBandWidthOfScale(o.y):void 0;isNil(g)&&isNil(_)?f.size=10:isNil(g)?f.size=_:isNil(_)&&(f.size=g),f.size=[g,_]}return isNil(f.shape)&&(f.shape="rect"),f}}}else this._encoders[e]=i}_getEncoders(){var e;return(e=this._encoders)!==null&&e!==void 0?e:{}}getAttributeTransforms(){return[{channels:["size","padding"],transform:(e,i,n)=>{if(isNumber(n.padding)&&n.padding>0)e.size=isArray(n.size)?n.size.map(o=>Math.max(o-n.padding,1)):Math.max(n.size-n.padding,1);else if(isArray(n.padding)&&n.padding.length===2){const o=isArray(n.size)?n.size:[n.size,n.size];e.size=[Math.max(o[0]-n.padding[0],1),Math.max(o[1]-n.padding[1],1)]}else e.size=n.size},storedAttrs:"paddingAttrs"}].concat(transformsByType.symbol)}release(){super.release(),this._encoders=null}}Cell.markType=GrammarMarkType.cell;const registerCellMark$1=()=>{Factory.registerMark(GrammarMarkType.cell,Cell)};class ViewAnimate{constructor(e){this._animations=[],this._additionalAnimateMarks=[],this.isEnabled=!0,this._onAnimationStart=i=>{this._additionalAnimateMarks=this._additionalAnimateMarks.filter(n=>{var o;return(o=n==null?void 0:n.animate)===null||o===void 0?void 0:o.isAnimating()}),this._animations.length===0&&this._additionalAnimateMarks.length===0&&this._view.emit(HOOK_EVENT.ALL_ANIMATION_START,{}),this._animations=this._animations.concat({config:i.animationConfig,mark:i.mark})},this._onAnimationEnd=i=>{this._additionalAnimateMarks=this._additionalAnimateMarks.filter(n=>{var o;return(o=n==null?void 0:n.animate)===null||o===void 0?void 0:o.isAnimating()}),this._animations=this._animations.filter(n=>n.config!==i.animationConfig||n.mark!==i.mark),this._animations.length===0&&this._additionalAnimateMarks.length===0&&this._view.emit(HOOK_EVENT.ALL_ANIMATION_END,{})},this._view=e,this._view.addEventListener(HOOK_EVENT.ANIMATION_START,this._onAnimationStart),this._view.addEventListener(HOOK_EVENT.ANIMATION_END,this._onAnimationEnd)}stop(){return this._view.traverseMarkTree(e=>{var i,n;e.animate&&((n=(i=e.animate).stop)===null||n===void 0||n.call(i))}),this._additionalAnimateMarks.forEach(e=>{var i,n;e.view&&e.animate&&((n=(i=e.animate).stop)===null||n===void 0||n.call(i))}),this._additionalAnimateMarks=[],this}pause(){return this._view.traverseMarkTree(e=>{var i,n;e.animate&&((n=(i=e.animate).pause)===null||n===void 0||n.call(i))}),this._additionalAnimateMarks.forEach(e=>{var i,n;e.view&&e.animate&&((n=(i=e.animate).pause)===null||n===void 0||n.call(i))}),this}resume(){return this._view.traverseMarkTree(e=>{var i,n;e.animate&&((n=(i=e.animate).resume)===null||n===void 0||n.call(i))}),this._additionalAnimateMarks.forEach(e=>{var i,n;e.view&&e.animate&&((n=(i=e.animate).resume)===null||n===void 0||n.call(i))}),this}enable(){return this.isEnabled=!0,this._view.traverseMarkTree(e=>{var i,n;e.animate&&((n=(i=e.animate).enable)===null||n===void 0||n.call(i))}),this}disable(){return this.isEnabled=!1,this._view.traverseMarkTree(e=>{var i,n;e.animate&&((n=(i=e.animate).disable)===null||n===void 0||n.call(i))}),this._additionalAnimateMarks.forEach(e=>{var i,n;e.view&&e.animate&&((n=(i=e.animate).stop)===null||n===void 0||n.call(i))}),this._additionalAnimateMarks=[],this}enableAnimationState(e){return this._view.traverseMarkTree(i=>{var n,o;i.animate&&((o=(n=i.animate).enableAnimationState)===null||o===void 0||o.call(n,e))}),this}disableAnimationState(e){return this._view.traverseMarkTree(i=>{var n,o;i.animate&&((o=(n=i.animate).disableAnimationState)===null||o===void 0||o.call(n,e))}),this}isAnimating(){return this._animations.length!==0||this._additionalAnimateMarks.some(e=>{var i;return((i=e==null?void 0:e.animate)===null||i===void 0?void 0:i.isAnimating())||!1})}animate(){return this.isEnabled?(this._view.traverseMarkTree(e=>{e.isUpdated&&e.animate&&e.animate.animate(),e.cleanExitElements(),e.isUpdated=!1},null,!0),this):this}animateAddition(e){var i;const n=(i=e.animate)===null||i===void 0?void 0:i.animate();return n&&n.isAnimating()&&this._additionalAnimateMarks.push(e),this}release(){this._additionalAnimateMarks=[],this._animations=[],this._view.removeEventListener(HOOK_EVENT.ALL_ANIMATION_START,this._onAnimationStart),this._view.removeEventListener(HOOK_EVENT.ALL_ANIMATION_END,this._onAnimationEnd),this._view=null}}class ViewAnimateMixin{initAnimate(e){return this.animate=new ViewAnimate(e),this.animate}}const registerViewAnimateAPI=()=>{mixin(View,ViewAnimateMixin)},transformAnimationAttributes=(r,e)=>{if(!r)return null;if(r.from){const i=r.from,n=Object.keys(i);n.forEach(l=>{isNil(i[l])&&delete i[l]});const o=isValidPointsChannel(n,e.mark.markType)&&!isValid(i.segments);if(o){const l=e.items.map(d=>Object.assign({},d,{nextAttrs:Object.assign({},i)}));r.from=e.transformElementItems(l,e.mark.markType,o)}}if(r.to){const i=r.to,n=Object.keys(i);n.forEach(l=>{isNil(i[l])&&delete i[l]});const o=isValidPointsChannel(n,e.mark.markType)&&!isValid(i.segments);if(o){const l=e.items.map(d=>Object.assign({},d,{nextAttrs:Object.assign({},i)}));r.to=e.transformElementItems(l,e.mark.markType,o)}}return r};function typeAnimationAttributes(r,e,i,n){const o=isFunction(e.options)?e.options.call(null,r.getDatum(),r,n):e.options;if(!e.type||!Factory.getAnimationType(e.type))return null;const l=Factory.getAnimationType(e.type)(r,o,i);return transformAnimationAttributes(l,r)}const parseChannelValue=(r,e,i,n,o)=>isFunction(i)?i(r.getDatum(),r,o):i;function channelAnimationAttributes(r,e,i,n){const o=e.channel;let l=null;return isArray(o)?l=o.reduce((d,u)=>(d.from[u]=r.getGraphicAttribute(u,!0),d.to[u]=r.getGraphicAttribute(u,!1),d),{from:{},to:{}}):isObject$1(o)&&(l=Object.keys(o).reduce((d,u)=>{var f,g;const _=!isNil((f=o[u])===null||f===void 0?void 0:f.from),y=!isNil((g=o[u])===null||g===void 0?void 0:g.to);return(_||y)&&(d.from[u]=_?parseChannelValue(r,0,o[u].from,0,n):void 0,d.to[u]=y?parseChannelValue(r,0,o[u].to,0,n):r.getGraphicAttribute(u,!1)),d},{from:{},to:{}})),transformAnimationAttributes(l,r)}class CustomInterpolator extends ACustomAnimate{constructor(e,i,n,o,l){super(e,i,n,o,l),this._interpolator=l==null?void 0:l.interpolator,this._element=l==null?void 0:l.element}onBind(){var e,i;this.from=(e=this.from)!==null&&e!==void 0?e:{},this.to=(i=this.to)!==null&&i!==void 0?i:{}}getEndProps(){return this.to}onUpdate(e,i,n){this._interpolator&&this._element&&this._interpolator.call(this,i,this.from,this.to,n,this._element.getDatum(),this._element,this.params.parameters)}}class AttributeAnimate extends ACustomAnimate{getEndProps(){return this.to}onBind(){var e;const i=(e=this.target.constructor.NOWORK_ANIMATE_ATTR)!==null&&e!==void 0?e:NOWORK_ANIMATE_ATTR,n=Object.keys(i).filter(u=>i[u]!==0);this.subAnimate.animate.preventAttrs(n);const o=Object.assign({},this.from),l=Object.assign({},this.to),d=[];Object.keys(l).forEach(u=>{n.includes(u)?(o[u]=l[u],this.from[u]=l[u]):isNil(o[u])?o[u]=this.target.getComputedAttribute(u):d.push(u)}),this.target.animates.forEach(u=>{u!==this.subAnimate.animate&&u.preventAttrs(d)}),this._fromAttribute=o,this._toAttribute=l}onStart(){if(this._fromAttribute){const e={};Object.keys(this._fromAttribute).forEach(i=>{this.subAnimate.animate.validAttr(i)&&(e[i]=this._fromAttribute[i])}),this.target.setAttributes(e,!1,{type:AttributeUpdateType.ANIMATE_UPDATE,animationState:{ratio:0,end:!1}})}}onEnd(){if(this._toAttribute){const e={};Object.keys(this._toAttribute).forEach(i=>{this.subAnimate.animate.validAttr(i)&&(e[i]=this._toAttribute[i])}),this.target.setAttributes(e,!1,{type:AttributeUpdateType.ANIMATE_END})}}update(e,i,n){this.updateCount===0&&this.onFirstRun(),this.updateCount+=1;const o=this.step.getLastProps();Object.keys(o).forEach(l=>{this.subAnimate.animate.validAttr(l)&&(n[l]=o[l])}),this.onUpdate(e,i,n),e&&this.onEnd()}onUpdate(e,i,n){this.target.stepInterpolate(this.subAnimate,this.subAnimate.animate,n,this.step,i,e,this._toAttribute,this._fromAttribute)}}Animate$1.mode|=AnimateMode.SET_ATTR_IMMEDIATELY;let GlobalAnimatorId=0;const isCustomAnimateCtor=r=>{var e;if(isNil(r)||isNil(r.prototype))return!1;const i=(e=r.prototype)!==null&&e!==void 0?e:{};return i instanceof ACustomAnimate||"onBind"in i&&"onStart"in i&&"onEnd"in i&&"onUpdate"in i};class Animator{constructor(e,i,n){this.id=GlobalAnimatorId++,this.isAnimating=!1,this.runnings=[],this.element=e,this.animationOptions=n,this.unit=i}callback(e){return this.callbackFunction=e,this}animate(e,i){return this.isAnimating=!0,this.animateElement(e,i),this.runnings.length===0&&this.animationEnd(),this}stop(e,i=!0){return this.runnings.forEach(n=>n.stop(e)),this.animationEnd(i),this}pause(){return this.runnings.forEach(e=>e.pause()),this}resume(){return this.runnings.forEach(e=>e.resume()),this}startAt(e){return this.runnings.forEach(i=>{const n=this.unit.initialDelay;i.startAt(n+e)}),this}getTotalAnimationTime(){var e;const i=this.unit.initialDelay+this.unit.loopDuration*this.unit.loopCount;return(e=this.unit.totalTime)!==null&&e!==void 0?e:i}getEndAttributes(){return this.runnings.reduce((e,i)=>Object.assign(e,i.getEndProps()),{})}animationEnd(e=!0){var i;this.isAnimating=!1,this.runnings=null,e&&((i=this.callbackFunction)===null||i===void 0||i.call(null))}animateElement(e,i){const n=this.element.getGraphicItem();if(!n)return;const o=n.animate();this.runnings.push(o),o.startAt(this.unit.initialDelay),o.wait(this.unit.loopDelay),this.unit.timeSlices.forEach(l=>{this.animateTimeSlice(o,l,e,i)}),o.wait(this.unit.loopDelayAfter),o.loop(this.unit.loopCount-1),isValidNumber(this.unit.totalTime)&&setTimeout(()=>{o&&o.stop("end")},this.unit.totalTime),o.onEnd(()=>{this.runnings=this.runnings.filter(l=>l!==o),this.runnings.length===0&&this.animationEnd()})}animateTimeSlice(e,i,n,o){const l=i.delay,d=i.delayAfter,u=i.duration,f=i.effects;if(l>0&&e.wait(l),f.length<0)e.wait(u);else{const g=f.map((_,y)=>{var b;const S=(b=_.type?typeAnimationAttributes(this.element,_,n,o):_.channel?channelAnimationAttributes(this.element,_,n,o):void 0)!==null&&b!==void 0?b:{},v=S.custom||(_==null?void 0:_.custom),A=(S==null?void 0:S.customParameters)||(_==null?void 0:_.customParameters);S.from&&Object.keys(S.from).length&&this.unit&&this.animationOptions.timeline.controlOptions.immediatelyApply&&this.element.mark.markType!=="component"&&this.element.getGraphicItem().setAttributes(S.from);const x=isCustomAnimateCtor(v);return!isNil(v)&&!isCustomAnimateCtor(v)?new CustomInterpolator(S.from,S.to,u,_.easing,{interpolator:v,element:this.element,parameters:A}):x?new v(S.from,S.to,u,_.easing,A):S.to?new AttributeAnimate(S.from,S.to,u,_.easing):void 0}).filter(_=>!isNil(_));g.length===1?e.play(g[0]):g.length>1&&e.play(new AnimateGroup(u,g))}d>0&&e.wait(d)}}function transformToTimelineConfig(r){var e,i,n,o,l,d,u,f,g,_,y,b;if(isNil(r.timeSlices)){const v=r;return{startTime:(e=v.startTime)!==null&&e!==void 0?e:DefaultAnimationStartTime,totalTime:v.totalTime,oneByOne:(i=v.oneByOne)!==null&&i!==void 0?i:DefaultAnimationOneByOne,loop:(n=v.loop)!==null&&n!==void 0?n:DefaultAnimationLoop,controlOptions:merge$1({},DefaultAnimationControlOptions,(o=v.controlOptions)!==null&&o!==void 0?o:{}),timeSlices:[{duration:(l=v.duration)!==null&&l!==void 0?l:DefaultAnimationDuration,delay:(d=v.delay)!==null&&d!==void 0?d:DefaultAnimationDelay,delayAfter:(u=v.delayAfter)!==null&&u!==void 0?u:DefaultAnimationDelayAfter,effects:[{type:v.type,channel:v.channel,custom:v.custom,easing:(f=v.easing)!==null&&f!==void 0?f:DefaultAnimationEasing,customParameters:v.customParameters,options:v.options}]}]}}const S=array(r.timeSlices).filter(v=>v.effects&&array(v.effects).filter(A=>A.channel||A.type).length);if(S.length)return{startTime:(g=r.startTime)!==null&&g!==void 0?g:DefaultAnimationStartTime,totalTime:r.totalTime,oneByOne:(_=r.oneByOne)!==null&&_!==void 0?_:DefaultAnimationOneByOne,loop:(y=r.loop)!==null&&y!==void 0?y:DefaultAnimationLoop,controlOptions:merge$1({},DefaultAnimationControlOptions,(b=r.controlOptions)!==null&&b!==void 0?b:{}),timeSlices:S.map(v=>{var A,x;return{duration:v.duration,delay:(A=v.delay)!==null&&A!==void 0?A:DefaultAnimationDelay,delayAfter:(x=v.delayAfter)!==null&&x!==void 0?x:DefaultAnimationDelayAfter,effects:array(v.effects).filter(T=>T.channel||T.type).map(T=>{var C;return{type:T.type,channel:T.channel,custom:T.custom,easing:(C=T.easing)!==null&&C!==void 0?C:DefaultAnimationEasing,customParameters:T.customParameters,options:T.options}})}}),partitioner:r.partitioner,sort:r.sort}}function normalizeAnimationConfig(r){let e=[];return Object.keys(r).forEach(i=>{e=e.concat(normalizeStateAnimationConfig(i,r[i]))}),e}function normalizeStateAnimationConfig(r,e,i=0){const n=[];let o=i;return array(e).forEach(l=>{var d;const u=transformToTimelineConfig(l);u&&(n.push({state:r,id:(d=u.id)!==null&&d!==void 0?d:`${r}-${o}`,timeline:u,originConfig:l}),o+=1)}),n}function invokeAnimateSpec(r,e,i){return isFunction(r)?r.call(null,e.getDatum(),e,i):r}class Arranger{constructor(e){this.parallelArrangers=[this],this.totalTime=0,this.startTime=0,this.endTime=0,this.animators=e.filter(i=>!isNil(i)),this.totalTime=this.animators.reduce((i,n)=>Math.max(i,n.getTotalAnimationTime()),0)}parallel(e){const i=Array.from(new Set(this.parallelArrangers.concat(e.parallelArrangers)));return i.forEach(n=>{n.parallelArrangers=i}),this.arrangeTime(),this}after(e){return this.afterArranger=e,this.arrangeTime(),this}arrangeTime(){const e=this.parallelArrangers.reduce((n,o)=>Math.max(n,o.totalTime),this.totalTime),i=this.parallelArrangers.reduce((n,o)=>{var l,d;return Math.max(n,(d=(l=o.afterArranger)===null||l===void 0?void 0:l.endTime)!==null&&d!==void 0?d:0)},0);this.parallelArrangers.forEach(n=>{n.startTime=i,n.endTime=i+e,n.animators.forEach(o=>{o.startAt(i)})})}}class Animate{constructor(e,i){this.state=null,this.immediateConfigs=[],this.isEnabled=!0,this.disabledStates=[],this.animators=new Map,this.elementRecorder=new WeakMap,this.timelineCount={},this.mark=e,this.configs=normalizeAnimationConfig(i??{})}getAnimationConfigs(e){var i;return this.isEnabled?((i=this.configs)!==null&&i!==void 0?i:[]).filter(n=>n.state===e):[]}updateConfig(e){this.configs=normalizeAnimationConfig(e??{})}updateState(e){this.state=e}animate(){if(!this.isEnabled||!this.configs||!this.configs.length)return;const e=this.mark.getAllElements(),i=this.mark.parameters();return e.forEach(n=>{var o;n.isReserved&&n.diffState!==DiffState.exit&&(n.isReserved=!1);const l=(o=this.elementRecorder.get(n))===null||o===void 0?void 0:o.prevState;(this.configs.some(d=>l!==n.diffState&&d.state===l&&d.timeline.controlOptions.stopWhenStateChange)||n.diffState===DiffState.exit)&&this.clearElementAnimation(n,!1)}),this.configs.forEach(n=>{this.animateByTimeline(n,e,i)}),this.mark.cleanExitElements(),this}runAnimationByState(e){if(!this.isEnabled)return;const i=this.configs.filter(d=>d.state===e),n=this.mark.getAllElements(),o=this.mark.parameters(),l=i.reduce((d,u)=>d.concat(this.animateByTimeline(u,n,o,!0)),[]);return new Arranger(l)}stopAnimationByState(e){const i=this.animators.get(e);return i&&i.forEach(n=>n.stop()),this}pauseAnimationByState(e){const i=this.animators.get(e);return i&&i.forEach(n=>n.pause()),this}resumeAnimationByState(e){const i=this.animators.get(e);return i&&i.forEach(n=>n.resume()),this}run(e){if(!this.isEnabled)return;const i=normalizeStateAnimationConfig(ImmediateAnimationState,e,this.immediateConfigs.length);this.immediateConfigs=this.immediateConfigs.concat(i);const n=this.mark.getAllElements(),o=this.mark.parameters(),l=i.reduce((d,u)=>d.concat(this.animateByTimeline(u,n,o,!0)),[]);return new Arranger(l)}stop(){return this.animators.forEach(e=>{e.forEach(i=>i.stop())}),this}pause(){return this.animators.forEach(e=>e.forEach(i=>i.pause())),this}resume(){return this.animators.forEach(e=>e.forEach(i=>i.resume())),this}reverse(){return this}restart(){return this}record(){return this}recordEnd(){return this}isAnimating(){let e=!1;return this.animators.forEach(i=>{e=e||i.some(n=>n.isAnimating)}),e}isElementAnimating(e){var i;const n=(i=this.elementRecorder.get(e))===null||i===void 0?void 0:i.count;return isNil(n)||Object.values(n).every(o=>o===0)}getAnimatorCount(){let e=0;return this.animators.forEach(i=>e+=i.length),e}getAllAnimators(){const e=[];return this.animators.forEach(i=>{e.push(...i)}),e}getElementAnimators(e,i){var n;const o=array(e);let l=[];return i?l=(n=this.animators.get(i))!==null&&n!==void 0?n:[]:this.animators.forEach(d=>{l=l.concat(d)}),l.filter(d=>o.includes(d.element))}enable(){return this.isEnabled=!0,this}disable(){return this.isEnabled=!1,this.stop(),this.animators.clear(),this}enableAnimationState(e){const i=array(e);return this.disabledStates=this.disabledStates.filter(n=>!i.includes(n)),this}disableAnimationState(e){const i=array(e);return this.disabledStates=this.disabledStates.concat(i),this}release(){this.stop(),this.animators.clear(),this.configs=null,this.animators=null,this.elementRecorder=null,this.timelineCount=null}animateByTimeline(e,i,n,o=!1){var l;const d=[],u=i.filter(f=>{const g=!(f.isReserved&&f.diffState===DiffState.exit),_=this.getAnimationState(f),y=!this.disabledStates.includes(_),b=o||_===e.state,S=!e.timeline.partitioner||e.timeline.partitioner(f.getDatum(),f,n);return g&&y&&b&&S});if(u.length){isNil(this.timelineCount[e.id])&&(this.timelineCount[e.id]=0),e.timeline.sort&&u.sort((g,_)=>e.timeline.sort(g.getDatum(),_.getDatum(),g,_,n));const f={width:this.mark.view.width(),height:this.mark.view.height(),group:(l=this.mark.group)!==null&&l!==void 0?l:null,mark:this.mark,view:this.mark.view,elementCount:u.length,elementIndex:0};u.forEach(g=>{var _;((_=this.animators.get(e.state))!==null&&_!==void 0?_:[]).filter(y=>y.element===g&&y.animationOptions.id===e.id).forEach(y=>{y.stop(null,!1),this.handleAnimatorEnd(y,!1)})}),u.forEach((g,_)=>{f.elementIndex=_;const y=Object.assign({[DefaultAnimationParameters]:f},n),b=this.getAnimationUnit(e.timeline,g,_,u.length,y);d.push(this.animateElement(e,b,g,f,y))})}return d}animateElement(e,i,n,o,l){var d,u;const f=new Animator(n,i,e);if(f.animate(o,l),!f.isAnimating)return;n.diffState===DiffState.exit&&(n.isReserved=!0);const g=this.timelineCount[e.id]===0;this.timelineCount[e.id]+=1;const _=(d=this.elementRecorder.get(n))!==null&&d!==void 0?d:{prevState:e.state,count:{}};_.prevState=e.state,_.count[e.state]=((u=_.count[e.state])!==null&&u!==void 0?u:0)+1,this.elementRecorder.set(n,_);const y=this.animators.get(e.state);y?y.push(f):this.animators.set(e.state,[f]),f.callback(()=>{this.handleAnimatorEnd(f)});const b={mark:this.mark,animationState:e.state,animationConfig:e.originConfig};return g&&this.mark.emit(HOOK_EVENT.ANIMATION_START,b),this.mark.emit(HOOK_EVENT.ELEMENT_ANIMATION_START,b,n),f}getAnimationState(e){const i=invokeFunctionType(this.state,this.mark.parameters(),e.getDatum(),e);return i??e.diffState}getAnimationUnit(e,i,n,o,l){const d=[],u=invokeAnimateSpec(e.startTime,i,l),f=invokeAnimateSpec(e.totalTime,i,l),g=invokeAnimateSpec(e.oneByOne,i,l),_=invokeAnimateSpec(e.loop,i,l);let y=0;e.timeSlices.forEach(S=>{var v;const A=invokeAnimateSpec(S.delay,i,l),x=invokeAnimateSpec(S.delayAfter,i,l),T=(v=invokeAnimateSpec(S.duration,i,l))!==null&&v!==void 0?v:f/o,C=array(S.effects).map(E=>Object.assign({},E,{customParameters:invokeAnimateSpec(E.customParameters,i,l)}));d.push({effects:C,duration:T,delay:A,delayAfter:x}),y+=A+T+x});const b=isNumber(g)?g:g===!0?y:0;return{initialDelay:u,loopCount:isNumber(_)?_:_===!0?1/0:1,loopDelay:b*n,loopDelayAfter:b*(o-n-1),loopAnimateDuration:y,loopDuration:y+b*(o-1),totalTime:f,timeSlices:d}}clearElementAnimation(e,i=!0){this.animators.forEach(n=>{n.forEach(o=>{o.element===e&&(o.animationOptions.state===DiffState.exit?o.stop("start",!1):o.stop("end",!1),this.handleAnimatorEnd(o,i))})}),this.elementRecorder.delete(e)}clearAllElements(){const e=this.mark.getAllElements();e&&e.forEach((i,n)=>{this.clearElement(i,n===e.length-1)})}clearElement(e,i=!0){this.clearElementAnimation(e),e.getGraphicItem()&&(e.clearGraphicAttributes(),e.diffState===DiffState.exit&&(e.isReserved=!1),i&&this.mark.cleanExitElements())}handleAnimatorEnd(e,i=!0){const n=e.element,o=e.animationOptions,l=o.state,d=l===ImmediateAnimationState,u=this.elementRecorder.get(n).count;u[l]-=1,this.animators.set(l,this.animators.get(l).filter(y=>y!==e)),this.animators.get(l).length===0&&this.animators.delete(l),this.timelineCount[o.id]-=1;const f=this.timelineCount[o.id]===0,g=d?this.immediateConfigs.find(y=>y.id===o.id).originConfig:this.configs.find(y=>y.id===o.id).originConfig;f&&(delete this.timelineCount[o.id],d&&(this.immediateConfigs=this.immediateConfigs.filter(y=>y.id!==o.id))),i&&(Object.keys(this.timelineCount).length===0?this.clearAllElements():l===DiffState.exit&&u[DiffState.exit]===0&&this.clearElement(n));const _={mark:this.mark,animationState:l,animationConfig:g};f&&this.mark.emit(HOOK_EVENT.ANIMATION_END,_),this.mark.emit(HOOK_EVENT.ELEMENT_ANIMATION_END,_,n)}}class MarkAnimateMixin{constructor(){this.animate=new Animate(this,{})}initAnimate(e){this.animate||(this.animate=new Animate(this,e.animation),this.needAnimate()&&this.animate.updateState(e.animationState))}reuseAnimate(e){this.animate=e.animate,this.animate.mark=this}updateAnimate(e){this.animate.updateConfig(e.animation),this.animate.updateState(e.animationState)}}const registerMarkAnimateAPI=()=>{mixin(Mark,MarkAnimateMixin)},registerGesturePlugin=()=>{Factory.registerStageEventPlugin("gesture",Gesture)},registerAnimate$1=()=>{registerViewAnimateAPI(),registerMarkAnimateAPI()},BASE_EVENTS=["pointerdown","pointerup","pointerupoutside","pointertap","pointerover","pointermove","pointerenter","pointerleave","pointerout","mousedown","mouseup","mouseupoutside","rightdown","rightup","rightupoutside","click","dblclick","mousemove","mouseover","mouseout","mouseenter","mouseleave","wheel","touchstart","touchend","touchendoutside","touchmove","touchcancel","tap","dragstart","drag","dragenter","dragleave","dragover","dragend","drop","pan","panstart","panend","press","pressup","pressend","pinch","pinchstart","pinchend","swipe"];var ChartEvent;(function(r){r.initialized="initialized",r.rendered="rendered",r.renderFinished="renderFinished",r.animationFinished="animationFinished",r.regionSeriesDataFilterOver="regionSeriesDataFilterOver",r.afterInitData="afterInitData",r.afterInitEvent="afterInitEvent",r.afterInitMark="afterInitMark",r.rawDataUpdate="rawDataUpdate",r.viewDataFilterOver="viewDataFilterOver",r.viewDataUpdate="viewDataUpdate",r.viewDataStatisticsUpdate="viewDataStatisticsUpdate",r.markDeltaYUpdate="markDeltaYUpdate",r.viewDataLabelUpdate="viewDataLabelUpdate",r.scaleDomainUpdate="scaleDomainUpdate",r.scaleUpdate="scaleUpdate",r.dataZoomChange="dataZoomChange",r.drill="drill",r.layoutStart="layoutStart",r.layoutEnd="layoutEnd",r.layoutRectUpdate="layoutRectUpdate",r.playerPlay="playerPlay",r.playerPause="playerPause",r.playerEnd="playerEnd",r.playerChange="playerChange",r.playerForward="playerForward",r.playerBackward="playerBackward",r.scrollBarChange="scrollBarChange",r.brushStart="brushStart",r.brushChange="brushChange",r.brushEnd="brushEnd",r.brushClear="brushClear",r.legendSelectedDataChange="legendSelectedDataChange",r.legendFilter="legendFilter",r.legendItemClick="legendItemClick",r.legendItemHover="legendItemHover",r.legendItemUnHover="legendItemUnHover",r.tooltipShow="tooltipShow",r.tooltipHide="tooltipHide",r.tooltipRelease="tooltipRelease",r.afterResize="afterResize",r.afterRender="afterRender",r.afterLayout="afterLayout"})(ChartEvent||(ChartEvent={}));var Event_Source_Type;(function(r){r.chart="chart",r.window="window",r.canvas="canvas"})(Event_Source_Type||(Event_Source_Type={}));var Event_Bubble_Level;(function(r){r.vchart="vchart",r.chart="chart",r.model="model",r.mark="mark"})(Event_Bubble_Level||(Event_Bubble_Level={}));const isInBound=(r,e,i)=>r.x>=e.x&&r.x<=i.x&&r.y>=e.y&&r.y<=i.y,isInRegionBound=(r,e,i)=>{const n=r.getRegionsInIds(array(e.layout.layoutBindRegionID));return n==null?void 0:n.some(o=>{const l=o.getLayoutRect(),d=o.getLayoutStartPoint();return isInBound(i,{x:d.x,y:d.y},{x:l.width+d.x,y:l.height+d.y})})},isSameDimensionInfo=(r,e)=>{var i,n;return r===e||!isNil(r)&&!isNil(e)&&r.value===e.value&&((i=r.axis)===null||i===void 0?void 0:i.id)===((n=e.axis)===null||n===void 0?void 0:n.id)},resolveTooltipFilterRange=(r,e)=>{const i=r.tooltipFilterRange,n=typeof i=="function"?i({scale:e}):i;return isValidNumber(n)?[-n,n]:n},getDimensionData=(r,e,i,n)=>{var o;const l=e.getScale(),d=isDiscrete(l.type),u=[],f=e.getOption().getChart().getSeriesInIndex(e.getSpecInfo().seriesIndexes);for(const g of f)if(g.coordinate===i){const _=array(n(g)),y=(o=g.getViewData())===null||o===void 0?void 0:o.latestData;if(_&&y)if(d){const b=[],S=[];y.forEach((v,A)=>{var x;((x=v[_[0]])===null||x===void 0?void 0:x.toString())===(r==null?void 0:r.toString())&&(b.push(v),S.push(A))}),u.push({series:g,datum:b,key:getDimensionDataKey(g,S)})}else if(isValid(_[1])){const b=[],S=[];y.forEach((v,A)=>{var x;(((x=v[_[0]])===null||x===void 0?void 0:x.toString())===(r==null?void 0:r.toString())||isValid(v[_[0]])&&isValid(v[_[1]])&&r>=v[_[0]]&&r<v[_[1]])&&(b.push(v),S.push(A))}),u.push({series:g,datum:b,key:getDimensionDataKey(g,S)})}else{const b=e.getSpec(),S=resolveTooltipFilterRange(b,l);let v=[],A=[];if(S)y.forEach((x,T)=>{if(isValid(x[_[0]])){const C=x[_[0]]-r;C>=S[0]&&C<=S[1]&&(v.push(x),A.push(T))}});else{let x=1/0,T=0;y.forEach((C,E)=>{if(isValid(C[_[0]])){const P=Math.abs(C[_[0]]-r),R=Math.sign(C[_[0]]-r);P<x?(x=P,v=[C],A=[E],T=R):P===x&&R===T&&(v.push(C),A.push(E))}})}u.push({series:g,datum:v,key:getDimensionDataKey(g,A)})}}return u},getDimensionDataKey=(r,e)=>`${r.id}_${e.join("_")}`,getAxis=(r,e,i)=>{const n=r.getAllComponents().filter(o=>o.specKey==="axes"&&e(o)&&isInRegionBound(r,o,i));return n.length?n:null},angleStandardize=(r,e)=>{const i=2*Math.PI,n=minInArray(e),o=maxInArray(e);return r<n?r+=Math.ceil((n-r)/i)*i:r>o&&(r-=Math.ceil((r-o)/i)*i),r},getPolarDimensionInfo=(r,e)=>{if(!r)return null;const i=getAxis(r,f=>f.getOrient()==="angle",e),n=getAxis(r,f=>f.getOrient()==="radius",e);if(!(i&&i.length||n&&n.length))return null;const o=[],l=f=>f.getDimensionField()[0],{x:d,y:u}=e;return i&&i.forEach(f=>{var g;const _=f.getScale();if(_&&isDiscrete(_.type)){const y=_.domain(),b=_.range(),S=f.getCenter(),v={x:d-f.getLayoutStartPoint().x-S.x,y:u-f.getLayoutStartPoint().y-S.y};let A=vectorAngle({x:1,y:0},v);A=angleStandardize(A,b);const x=distance(v),T=(g=n[0])===null||g===void 0?void 0:g.getScale(),C=T==null?void 0:T.range();if((A-(b==null?void 0:b[0]))*(A-(b==null?void 0:b[1]))>0||(x-(C==null?void 0:C[0]))*(x-(C==null?void 0:C[1]))>0)return;const E=f.invert(A);if(isNil(E))return;let P=y.findIndex(L=>(L==null?void 0:L.toString())===E.toString());P<0&&(P=void 0);const R=getDimensionData(E,f,"polar",l);o.push({index:P,value:E,position:_.scale(E),axis:f,data:R})}}),n&&n.forEach(f=>{var g;const _=f.getScale(),y=_==null?void 0:_.range();if(_&&isDiscrete(_.type)){const b=f.getCenter(),S={x:d-f.getLayoutStartPoint().x-b.x,y:u-f.getLayoutStartPoint().y-b.y};let v=vectorAngle({x:1,y:0},S);v<-Math.PI/2&&(v=2*Math.PI+v);const A=distance(S),x=(g=i[0])===null||g===void 0?void 0:g.getScale(),T=x==null?void 0:x.range();if((v-(T==null?void 0:T[0]))*(v-(T==null?void 0:T[1]))>0||(A-(y==null?void 0:y[0]))*(A-(y==null?void 0:y[1]))>0)return;const C=_.invert(A);if(isNil(C))return;let E=_.domain().findIndex(R=>(R==null?void 0:R.toString())===C.toString());E<0&&(E=void 0);const P=getDimensionData(C,f,"polar",l);o.push({index:E,value:C,position:_.scale(C),axis:f,data:P})}}),o.length?o:null};function isXAxis(r){return r==="bottom"||r==="top"}function isYAxis(r){return r==="left"||r==="right"}function isZAxis(r){return r==="z"}function autoAxisType(r,e){return e?isXAxis(r)?"linear":"band":isXAxis(r)?"band":"linear"}function getOrient(r,e){return isValidOrient(r.orient)||e&&e.includes(r.orient)?r.orient:"left"}function getDirectionByOrient(r){return r==="top"||r==="bottom"?"horizontal":"vertical"}function transformInverse(r,e){let i=r.inverse;return e&&!isXAxis(r.orient)&&(i=!isValid(r.inverse)||!r.inverse),i}function getCartesianAxisInfo(r,e){var i;const n=(i=r.type)!==null&&i!==void 0?i:autoAxisType(r.orient,e);return{axisType:n,componentName:`${ComponentTypeEnum.cartesianAxis}-${n}`}}const discreteXAxisGetDimensionField=r=>r.fieldX[0],discreteYAxisGetDimensionField=r=>r.fieldY[0],continuousXAxisGetDimensionField=r=>{var e;return[r.fieldX[0],(e=r.fieldX2)!==null&&e!==void 0?e:r.fieldX[1]]},continuousYAxisGetDimensionField=r=>{var e;return[r.fieldY[0],(e=r.fieldY2)!==null&&e!==void 0?e:r.fieldY[1]]},getDimensionFieldFunc=(r,e)=>r?e?discreteXAxisGetDimensionField:continuousXAxisGetDimensionField:e?discreteYAxisGetDimensionField:continuousYAxisGetDimensionField,getCartesianDimensionInfo=(r,e,i)=>{var n,o;if(!r)return null;const{x:l,y:d}=e,u=(n=getAxis(r,v=>isXAxis(v.getOrient()),e))!==null&&n!==void 0?n:[],f=(o=getAxis(r,v=>isYAxis(v.getOrient()),e))!==null&&o!==void 0?o:[];if(!u.length&&!f.length)return null;const g=new Set,_=new Set,y=new Set;[u,f].forEach(v=>v.forEach(A=>{isDiscrete(A.getScale().type)?g.add(A):_.add(A),i&&A.getSpec().hasDimensionTooltip&&y.add(A)}));const b=[],S=v=>{const A=v==="x",x=A?l:d;(A?u:f).forEach(T=>{if(y.size>0){if(y.has(T)){const C=getDimensionInfoByPosition(T,x,getDimensionFieldFunc(A,isDiscrete(T.getScale().type)));C&&b.push(C)}}else{const C=g.size>0;if((C?g:_).has(T)){const E=getDimensionInfoByPosition(T,x,getDimensionFieldFunc(A,C));E&&b.push(E)}}})};return r.getSpec().direction==="horizontal"?(S("y"),b.length===0&&S("x")):(S("x"),b.length===0&&S("y")),b.length?b:null},getDimensionInfoByPosition=(r,e,i)=>{const n=r.positionToData(e,!0);return isNil(n)?null:getDimensionInfoByValue(r,n,i)},getDimensionInfoByValue=(r,e,i)=>{const n=r.getScale();if(isNil(e))return null;let o=n.domain().findIndex(d=>(d==null?void 0:d.toString())===e.toString());o<0&&(o=void 0);const l=getDimensionData(e,r,"cartesian",i??(isXAxis(r.getOrient())?discreteXAxisGetDimensionField:discreteYAxisGetDimensionField));return{index:o,value:e,position:n.scale(e),axis:r,data:l}};class DimensionEvent{constructor(e,i){this._eventDispatcher=e,this._mode=i}get chart(){var e,i;return this._chart||(this._chart=(i=(e=this._eventDispatcher.globalInstance).getChart)===null||i===void 0?void 0:i.call(e)),this._chart}register(e,i){var n,o;((o=(n=this.chart)===null||n===void 0?void 0:n.getOption().onError)!==null&&o!==void 0?o:error$1)("Method not implemented.")}unregister(){var e,i;((i=(e=this.chart)===null||e===void 0?void 0:e.getOption().onError)!==null&&i!==void 0?i:error$1)("Method not implemented.")}getTargetDimensionInfo(e,i){var n,o;const l=(n=getCartesianDimensionInfo(this.chart,{x:e,y:i}))!==null&&n!==void 0?n:[],d=(o=getPolarDimensionInfo(this.chart,{x:e,y:i}))!==null&&o!==void 0?o:[],u=[].concat(l,d);return u.length===0?null:u}dispatch(e,i){var n;const o=(n=this.chart)===null||n===void 0?void 0:n.getAllComponents().filter(f=>f.specKey==="axes"&&(!(i!=null&&i.filter)||i.filter(f))),l=o.filter(f=>{const g=f.getScale();return isDiscrete(g.type)}),d=l.length?l:o.filter(f=>{const g=f.getOrient();return isXAxis(g)||g==="angle"}),u=[];return d.forEach(f=>{const g=getDimensionInfoByValue(f,e);g&&u.push(g)}),this._callback.call(null,{action:"enter",dimensionInfo:u}),u}}class DimensionClickEvent extends DimensionEvent{constructor(){super(...arguments),this.onClick=e=>{if(!e)return;const i=e.event.viewX,n=e.event.viewY,o=this.getTargetDimensionInfo(i,n);o&&this._callback.call(null,Object.assign(Object.assign({},e),{action:"click",dimensionInfo:o.slice()}))}}register(e,i){this._callback=i.callback,this._eventDispatcher.register("pointertap",{query:Object.assign(Object.assign({},i.query),{source:Event_Source_Type.chart}),callback:this.onClick})}unregister(){this._eventDispatcher.unregister("pointertap",{query:null,callback:this.onClick})}}class DimensionHoverEvent extends DimensionEvent{constructor(){super(...arguments),this._cacheDimensionInfo=null,this.onMouseMove=e=>{if(!e)return;const i=e.event.viewX,n=e.event.viewY,o=this.getTargetDimensionInfo(i,n);o===null&&this._cacheDimensionInfo!==null?(this._callback.call(null,Object.assign(Object.assign({},e),{action:"leave",dimensionInfo:this._cacheDimensionInfo.slice()})),this._cacheDimensionInfo=o):o===null||this._cacheDimensionInfo!==null&&o.length===this._cacheDimensionInfo.length&&!o.some((l,d)=>!isSameDimensionInfo(l,this._cacheDimensionInfo[d]))?o!==null&&this._callback.call(null,Object.assign(Object.assign({},e),{action:"move",dimensionInfo:o.slice()})):(this._callback.call(null,Object.assign(Object.assign({},e),{action:"enter",dimensionInfo:o.slice()})),this._cacheDimensionInfo=o)},this.onMouseOut=e=>{e&&(this._callback.call(null,Object.assign(Object.assign({},e),{action:"leave",dimensionInfo:this._cacheDimensionInfo?this._cacheDimensionInfo.slice():[]})),this._cacheDimensionInfo=null)}}register(e,i){this._callback=i.callback,this._eventDispatcher.register("pointermove",{query:Object.assign(Object.assign({},i.query),{source:Event_Source_Type.chart}),callback:this.onMouseMove}),this._eventDispatcher.register("pointerout",{query:Object.assign(Object.assign({},i.query),{source:Event_Source_Type.canvas}),callback:this.onMouseOut}),isMobileLikeMode(this._mode)&&this._eventDispatcher.register("pointerdown",{query:Object.assign(Object.assign({},i.query),{source:Event_Source_Type.chart}),callback:this.onMouseMove})}unregister(){this._eventDispatcher.unregister("pointermove",{query:null,callback:this.onMouseMove}),isMobileLikeMode(this._mode)&&this._eventDispatcher.unregister("pointerdown",{query:null,callback:this.onMouseMove})}}var DimensionEventEnum;(function(r){r.dimensionHover="dimensionHover",r.dimensionClick="dimensionClick"})(DimensionEventEnum||(DimensionEventEnum={}));const ComposedEventMapper={[DimensionEventEnum.dimensionHover]:DimensionHoverEvent,[DimensionEventEnum.dimensionClick]:DimensionClickEvent};let Event$1=class{getComposedEventMap(){return this._composedEventMap}constructor(e,i){this._composedEventMap=new Map,this._eventDispatcher=e,this._mode=i}on(e,i,n){const o=typeof i=="function"?{query:null,callback:i}:{query:i,callback:n};if(ComposedEventMapper[e]){const l=new ComposedEventMapper[e](this._eventDispatcher,this._mode);l.register(e,o),this._composedEventMap.set(n,{eventType:e,event:l})}else this._eventDispatcher.register(e,o);return this}off(e,i,n){var o,l;const d=n??i;if(ComposedEventMapper[e])if(d)(o=this._composedEventMap.get(d))===null||o===void 0||o.event.unregister(),this._composedEventMap.delete(d);else for(const u of this._composedEventMap.entries())u[1].eventType===e&&((l=this._composedEventMap.get(u[0]))===null||l===void 0||l.event.unregister(),this._composedEventMap.delete(u[0]));else if(d){const u={callback:d,query:null,filter:{nodeName:null,type:e,level:null,source:i.source,markName:null,filter:null,userId:null}};this._eventDispatcher.unregister(e,u)}else this._eventDispatcher.unregister(e);return this}emit(e,i,n){return this._eventDispatcher.dispatch(e,i,n),this}prevent(e,i){return this._eventDispatcher.prevent(e,i),this}allow(e){return this._eventDispatcher.allow(e),this}release(){this._eventDispatcher.clear(),this._composedEventMap.clear()}};class Bubble{constructor(){this._map=new Map,this._levelNodes=new Map,this._levelNodes.set(Event_Bubble_Level.vchart,[]),this._levelNodes.set(Event_Bubble_Level.chart,[]),this._levelNodes.set(Event_Bubble_Level.model,[]),this._levelNodes.set(Event_Bubble_Level.mark,[])}addHandler(e,i){var n;const o={level:i,handler:e};return(n=this._levelNodes.get(i))===null||n===void 0||n.push(o),this._map.set(e.callback,o),this}removeHandler(e){const i=this._map.get(e.callback);if(!i)return this;this._map.delete(e.callback);const n=this._levelNodes.get(i.level),o=n==null?void 0:n.findIndex(l=>l.handler.callback===e.callback);return o!==void 0&&o>=0&&(n==null||n.splice(o,1)),this}preventHandler(e){return e&&(e.prevented=!0),this}allowHandler(e){return e&&(e.prevented=!1),this}getHandlers(e){var i;return((i=this._levelNodes.get(e))===null||i===void 0?void 0:i.map(n=>n.handler))||[]}getAllHandlers(){return Array.from(this._map.values()).map(e=>e.handler)||[]}getCount(){return this._map.size}release(){this._map.clear(),this._levelNodes.clear()}}const componentTypeMap={cartesianAxis:"axis","cartesianAxis-band":"axis","cartesianAxis-linear":"axis","cartesianAxis-time":"axis",polarAxis:"axis","polarAxis-band":"axis","polarAxis-linear":"axis",discreteLegend:"legend",continuousLegend:"legend",colorLegend:"legend",sizeLegend:"legend"};class EventDispatcher{constructor(e,i){this._viewBubbles=new Map,this._windowBubbles=new Map,this._canvasBubbles=new Map,this._viewListeners=new Map,this._windowListeners=new Map,this._canvasListeners=new Map,this._onDelegate=n=>{var o,l;const d=this.globalInstance.getChart(),u=isValid(n.modelId)&&(d==null?void 0:d.getModelById(n.modelId))||void 0,f=isValid(n.markId)&&(d==null?void 0:d.getMarkById(n.markId))||null,g=new Map;let _=(o=n.item)===null||o===void 0?void 0:o.mark;for(_&&isValid(_.id())&&g.set(_.id(),n.item);_!=null&&_.elements;){const v=_.id();isValid(v)&&!g.has(v)&&g.set(v,_.elements[0]),_=_.group}const y=get(n.event,"target");let b=n.datum;u&&u.modelType==="component"&&(b=(l=u.getDatum(y))!==null&&l!==void 0?l:b);const S={event:n.event,item:n.item,source:n.source,datum:b,itemMap:g,chart:d,model:u,mark:f??void 0,node:get(n.event,"target")};this.dispatch(n.type,S)},this._onDelegateInteractionEvent=n=>{const o=this.globalInstance.getChart(),l=n.event;let d=null;l.elements&&(d=l.elements);const u={event:n.event,chart:o,items:d,datums:d&&d.map(f=>f.getDatum())};this.dispatch(n.type,u)},this.globalInstance=e,this._compiler=i}register(e,i){var n,o,l,d,u;this._parseQuery(i);const f=this.getEventBubble(((n=i.filter)===null||n===void 0?void 0:n.source)||Event_Source_Type.chart),g=this.getEventListeners(((o=i.filter)===null||o===void 0?void 0:o.source)||Event_Source_Type.chart);if(f.get(e)||f.set(e,new Bubble),f.get(e).addHandler(i,(l=i.filter)===null||l===void 0?void 0:l.level),this._isValidEvent(e)&&!g.has(e)){const _=this._onDelegate.bind(this);this._compiler.addEventListener((d=i.filter)===null||d===void 0?void 0:d.source,e,_),g.set(e,_)}else if(this._isInteractionEvent(e)&&!g.has(e)){const _=this._onDelegateInteractionEvent.bind(this);this._compiler.addEventListener((u=i.filter)===null||u===void 0?void 0:u.source,e,_),g.set(e,_)}return this}unregister(e,i){var n,o,l,d;let u=!1;const f=this.getEventBubble(((n=i==null?void 0:i.filter)===null||n===void 0?void 0:n.source)||Event_Source_Type.chart),g=this.getEventListeners(((o=i==null?void 0:i.filter)===null||o===void 0?void 0:o.source)||Event_Source_Type.chart);if(i){const _=f.get(e);_==null||_.removeHandler(i),(_==null?void 0:_.getCount())===0&&(_==null||_.release(),f.delete(e),u=!0),!((l=i==null?void 0:i.wrappedCallback)===null||l===void 0)&&l.cancel&&i.wrappedCallback.cancel()}else{const _=f.get(e);_==null||_.release(),f.delete(e),u=!0}if(u&&this._isValidEvent(e)){const _=g.get(e);this._compiler.removeEventListener(((d=i==null?void 0:i.filter)===null||d===void 0?void 0:d.source)||Event_Source_Type.chart,e,_),g.delete(e)}return this}dispatch(e,i,n){const o=this.getEventBubble(i.source||Event_Source_Type.chart).get(e);if(!o)return this;let l=!1;if(n){const d=o.getHandlers(n);l=this._invoke(d,e,i)}else{const d=[Event_Bubble_Level.mark,Event_Bubble_Level.model,Event_Bubble_Level.chart,Event_Bubble_Level.vchart];let u=0;for(;!l&&u<d.length;)l=this._invoke(o.getHandlers(d[u]),e,i),u++}return this}prevent(e,i){return["canvas","chart","window"].forEach(n=>{const o=this.getEventBubble(n).get(e);o&&o.getAllHandlers().forEach(l=>{i&&l.callback===i||o.preventHandler(l)})}),this}allow(e){return["canvas","chart","window"].forEach(i=>{const n=this.getEventBubble(i).get(e);n&&n.getAllHandlers().forEach(o=>n.allowHandler(o))}),this}clear(){[Event_Source_Type.chart,Event_Source_Type.window,Event_Source_Type.canvas].forEach(e=>{const i=this.getEventListeners(e);for(const n of i.entries())this._compiler.removeEventListener(e,n[0],n[1]);i.clear()}),[this._viewBubbles,this._windowBubbles,this._canvasBubbles].forEach(e=>{for(const i of e.values())i.release();e.clear()})}release(){this.clear(),this.globalInstance=null,this._compiler=null}_filter(e,i,n){var o,l,d;if(isFunction(e.filter)&&!e.filter(n)||e.nodeName&&get(n,"node.name")!==e.nodeName||e.markName&&((o=n==null?void 0:n.mark)===null||o===void 0?void 0:o.name)!==e.markName)return!1;let u=(l=n.model)===null||l===void 0?void 0:l.type;return componentTypeMap[u]&&(u=componentTypeMap[u]),(!e.type||u===e.type)&&!(e.level==="mark"&&!e.type&&!(n!=null&&n.mark))&&!(e.level==="model"&&!e.type&&!(n!=null&&n.model))&&(!isValid(e.userId)||((d=n.model)===null||d===void 0?void 0:d.userId)===e.userId)}_prepareParams(e,i){if(e.markName&&i.mark&&i.itemMap){const n=i.mark.getProductId(),o=i.itemMap.get(n),l=o==null?void 0:o.getDatum();return Object.assign(Object.assign({},i),{item:o,datum:l})}return Object.assign({},i)}_invoke(e,i,n){return e.map(o=>{var l,d,u;const f=o.filter;if(!o.prevented&&(!o.query||this._filter(f,i,n))){const g=(o.wrappedCallback||o.callback).call(null,this._prepareParams(f,n)),_=g??((l=o.query)===null||l===void 0?void 0:l.consume);return _&&((d=n.event)===null||d===void 0||d.stopPropagation(),(u=n.event)===null||u===void 0||u.preventDefault()),!!_}}).some(o=>o===!0)}_getQueryLevel(e){return e?e.level?e.level:isValid(e.id)?Event_Bubble_Level.model:Event_Bubble_Level.vchart:Event_Bubble_Level.vchart}_parseQuery(e){var i;const n=e.query;n!=null&&n.throttle?e.wrappedCallback=throttle(e.callback,n.throttle):n!=null&&n.debounce&&(e.wrappedCallback=debounce(e.callback,n.debounce));let o=this._getQueryLevel(n),l=null,d=Event_Source_Type.chart,u=null,f=null,g=null;return n!=null&&n.nodeName&&(u=n.nodeName),n!=null&&n.markName&&(f=n.markName),!(n!=null&&n.type)||o!==Event_Bubble_Level.model&&o!==Event_Bubble_Level.mark||(l=n.type),n!=null&&n.source&&(d=n.source),isValid(n==null?void 0:n.id)&&(g=n==null?void 0:n.id,o=Event_Bubble_Level.model),e.filter={level:o,markName:f,type:l,source:d,nodeName:u,userId:g,filter:(i=n==null?void 0:n.filter)!==null&&i!==void 0?i:null},e}getEventBubble(e){switch(e){case Event_Source_Type.chart:return this._viewBubbles;case Event_Source_Type.window:return this._windowBubbles;case Event_Source_Type.canvas:return this._canvasBubbles;default:return this._viewBubbles}}getEventListeners(e){switch(e){case Event_Source_Type.chart:return this._viewListeners;case Event_Source_Type.window:return this._windowListeners;case Event_Source_Type.canvas:return this._canvasListeners;default:return this._viewListeners}}_isValidEvent(e){return BASE_EVENTS.includes(e)||Object.values(HOOK_EVENT).includes(e)}_isInteractionEvent(e){let i;return e&&(i=e.split(":")[0],i)&&Factory.hasInteraction(i)}}function registerDataSetInstanceTransform(r,e,i){r.getTransform(e)||r.registerTransform(e,i)}function registerDataSetInstanceParser(r,e,i){r.getParser(e)||r.registerParser(e,i)}const geoSourceMap=new Map;let mapDataSet;function initMapDataSet(){mapDataSet||(mapDataSet=new DataSet,registerDataSetInstanceParser(mapDataSet,"geojson",geoJSONParser),registerDataSetInstanceParser(mapDataSet,"topojson",topoJSONParser),registerDataSetInstanceTransform(mapDataSet,"simplify",simplify))}function registerMapSource(r,e,i={type:"geojson",centroid:!0}){geoSourceMap.has(r)&&warn(`map type of '${r}' already exists, will be overwritten.`),initMapDataSet();const n=new DataView(mapDataSet),o=merge$1({},{centroid:!0,simplify:!1},i);i.type==="topojson"?n.parse(e,{type:"topojson",options:o}):n.parse(e,{type:"geojson",options:o});const{simplify:l}=i;l===!0?n.transform({type:"simplify"}):isObject$1(l)&&n.transform({type:"simplify",options:l}),geoSourceMap.set(r,n)}function unregisterMapSource(r){geoSourceMap.has(r)?geoSourceMap.delete(r):warn(`map type of '${r}' does not exists.`)}function getMapSource(r){return geoSourceMap.get(r)}function copyOneDataView(r,e=!1){let i=e;return r.latestData instanceof DataView&&(i=!1),i?cloneDeep(r.latestData):r.latestData&&r.latestData.slice()}const copyDataView=(r,e)=>r.length===0?[]:r.length===1?copyOneDataView(r[0],e==null?void 0:e.deep):r.map(i=>copyOneDataView(i,e==null?void 0:e.deep));function dataViewFromDataView(r,e,i){e=e instanceof DataSet?e:r.dataSet,registerDataSetInstanceTransform(e,"copyDataView",copyDataView);const n=new DataView(e,i);return n.parse([r],{type:"dataview"}),n.transform({type:"copyDataView",level:TransformLevel.copyDataView}),n}function dataToDataView(r,e,i=[]){var n;if(r instanceof DataView)return r;const{id:o,values:l=[],fromDataIndex:d,fromDataId:u,transforms:f=[]}=r,g=r.parser?cloneDeep(r.parser):{clone:!0},_=cloneDeep(r.fields);let y;g.clone=g.clone!==!1;const b=i.find(S=>S.name===o);if(b)y=b;else{const S={name:o};if(_&&(S.fields=_),y=new DataView(e,S),typeof u=="string"){const v=i.find(A=>A.name===u);if(!v)return warn(`no data matches fromDataId ${u}`),null;y.parse([v],{type:"dataview"}),y.transform({type:"copyDataView"})}else if(typeof d=="number"){const v=i[d];if(!v)return warn(`no data matches fromDataIndex ${d}`),null;y.parse([v],{type:"dataview"}),y.transform({type:"copyDataView"})}else Array.isArray(l)?y.parse(l,g):!isString(l)||g&&!["csv","dsv","tsv"].includes(g.type)?(y.parse([]),warn("values should be array")):y.parse(l,(n=g)!==null&&n!==void 0?n:{type:"csv"});f&&f.length&&f.forEach(v=>{e.getTransform(v.type)&&y.transform(v)})}return y}function updateDataViewInData(r,e,i){r&&(e.fields&&r.setFields(e.fields,i),r.parseNewData(e.values,e.parser))}var TransformLevel;(function(r){r[r.copyDataView=-10]="copyDataView",r[r.treemapFilter=-8]="treemapFilter",r[r.treemapFlatten=-7]="treemapFlatten",r[r.dotObjFlat=-7]="dotObjFlat",r[r.linkDotInfo=-7]="linkDotInfo",r[r.sankeyLayout=-7]="sankeyLayout",r[r.dataZoomFilter=-6]="dataZoomFilter",r[r.legendFilter=-5]="legendFilter"})(TransformLevel||(TransformLevel={}));var AnimationStateEnum;(function(r){r.appear="appear",r.disappear="disappear",r.enter="enter",r.update="update",r.state="state",r.exit="exit",r.normal="normal",r.none="none"})(AnimationStateEnum||(AnimationStateEnum={}));var GrammarType;(function(r){r.data="data",r.signal="signal",r.mark="mark"})(GrammarType||(GrammarType={}));function toRenderMode(r){switch(r){case RenderModeEnum["desktop-browser"]:case RenderModeEnum["mobile-browser"]:return"browser";case RenderModeEnum.node:case RenderModeEnum.worker:return"node";case RenderModeEnum.miniApp:case RenderModeEnum["desktop-miniApp"]:return"feishu";case RenderModeEnum.lynx:return"lynx";case RenderModeEnum.wx:return"wx";case RenderModeEnum.tt:return"tt";case RenderModeEnum.harmony:return"harmony"}return"browser"}var __rest$i=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};class Compiler{getVGrammarView(){return this._view}getModel(){return this._model}constructor(e,i){this._viewListeners=new Map,this._windowListeners=new Map,this._canvasListeners=new Map,this.isInited=!1,this._released=!1,this._model={[GrammarType.signal]:{},[GrammarType.data]:{},[GrammarType.mark]:{}},this._compileChart=null,this.handleStageRender=()=>{var n,o;(o=(n=this._compileChart)===null||n===void 0?void 0:n.getEvent())===null||o===void 0||o.emit(ChartEvent.afterRender,{chart:this._compileChart})},this._container=e,this._option=i}getRenderer(){var e;return(e=this._view)===null||e===void 0?void 0:e.renderer}getCanvas(){var e;return(e=this._view)===null||e===void 0?void 0:e.renderer.canvas()}getStage(){var e;return(e=this._view)===null||e===void 0?void 0:e.renderer.stage()}initView(){var e,i,n,o;if(this._released||(this.isInited=!0,this._view))return;const l=new Logger((e=this._option.logLevel)!==null&&e!==void 0?e:LoggerLevel.Error);!((i=this._option)===null||i===void 0)&&i.onError&&l.addErrorHandler((...x)=>{var T,C;(C=(T=this._option)===null||T===void 0?void 0:T.onError)===null||C===void 0||C.call(T,...x)});const d=this._option,{performanceHook:u,autoRefreshDpr:f,dpr:g,mode:_,gestureConfig:y,interactive:b,clickInterval:S,autoPreventDefault:v}=d,A=__rest$i(d,["performanceHook","autoRefreshDpr","dpr","mode","gestureConfig","interactive","clickInterval","autoPreventDefault"]);this._view=new View(Object.assign(Object.assign({width:this._width,height:this._height,container:(n=this._container.dom)!==null&&n!==void 0?n:null,renderCanvas:(o=this._container.canvas)!==null&&o!==void 0?o:null,hooks:u},A),{dpr:g,autoRefresh:isValid(f)?f:!isValid(g),mode:toRenderMode(_),autoFit:!1,eventConfig:{gesture:isValid(y)?y:isMobileLikeMode(_),disable:b===!1,clickInterval:S,autoPreventDefault:v},doLayout:()=>{var x;(x=this._compileChart)===null||x===void 0||x.onLayout(this._view)},logger:l,logLevel:l.level()})),this._setCanvasStyle(),this.getStage().hooks.afterRender.tap("chart-event",this.handleStageRender),b!==!1&&this._viewListeners.forEach(x=>{var T;(T=this._view)===null||T===void 0||T.addEventListener(x.type,x.callback)})}_setCanvasStyle(){if(this._view&&this._container.dom&&!isString(this._container.dom)){this._container.dom.style.display="block",this._container.dom.style.position="relative";const e=this.getCanvas();e&&(e.style.display="block")}}compileInteractions(){var e;if(this._view.removeAllInteractions(),(e=this._interactions)===null||e===void 0?void 0:e.length){const i={};this._interactions.forEach(n=>{var o;if(n.regionId){const l=`${n.regionId}-${n.type}-${(o=n.id)!==null&&o!==void 0?o:""}`,d=i[l];i[l]=d?Object.assign(Object.assign(Object.assign({},d),n),{selector:[...d.selector,...n.selector]}):n}else this._view.interaction(n.type,n)}),Object.keys(i).forEach(n=>{const o=this._view.interaction(i[n].type,i[n]);if(this._compileChart){const l=this._compileChart.getRegionsInIds([i[n].regionId])[0];l&&l.interaction.addVgrammarInteraction(o.getStartState(),o)}})}}compile(e,i){if(this._released)return;const{chart:n}=e;this._compileChart=n,this.initView(),this._view&&(n.compile(),n.afterCompile(),this.updateDepend(),this.compileInteractions())}clearNextRender(){return!!this._nextRafId&&(vglobal.getCancelAnimationFrame()(this._nextRafId),this._nextRafId=null,!0)}clear(e,i=!1){const{chart:n}=e;this.clearNextRender(),n.clear(),this.releaseGrammar(i)}renderNextTick(e){this._released||this._nextRafId||(this._nextRafId=vglobal.getRequestAnimationFrame()(()=>{this._nextRafId=null,this.render(e)}))}render(e){var i,n;this._released||(this.initView(),this._view&&((i=this._view)===null||i===void 0||i.run(e),this.clearNextRender()&&((n=this._view)===null||n===void 0||n.run(e))))}updateViewBox(e,i=!0){this._view&&this._view.renderer.setViewBox(e,i)}resize(e,i,n=!0){this._view&&(this._width=e,this._height=i,this._view.resize(e,i),n&&this.render({morph:!1}))}setBackground(e){var i;(i=this._view)===null||i===void 0||i.background(e)}setSize(e,i){this._width=e,this._height=i,this._view&&(this._view.width(e),this._view.height(i))}setViewBox(e,i=!0){this._view&&this._view.renderer.setViewBox(e,i)}addEventListener(e,i,n){var o,l;if(this._option.interactive!==!1){if(e===Event_Source_Type.chart){const d=(function(u,f){var g,_,y;const b=(_=(g=f==null?void 0:f.mark)===null||g===void 0?void 0:g.getContext())!==null&&_!==void 0?_:{},S=isValid(b.modelId)?b.modelId:null,v=isValid(b.markId)?b.markId:null,A=isValid(b.modelUserId)?b.modelUserId:null,x=isValid(b.markUserId)?b.markUserId:null,T={event:u,type:i,source:e,item:f,datum:((y=f==null?void 0:f.getDatum)===null||y===void 0?void 0:y.call(f))||null,markId:v,modelId:S,markUserId:x,modelUserId:A};n.call(null,T)}).bind(this);this._viewListeners.set(n,{type:i,callback:d}),(o=this._view)===null||o===void 0||o.addEventListener(i,d)}else if(e===Event_Source_Type.window){const d=(function(f){const g={event:f,type:i,source:e,item:null,datum:null,markId:null,modelId:null,markUserId:null,modelUserId:null};n.call(null,g)}).bind(this);this._windowListeners.set(n,{type:i,callback:d});const u=this._getGlobalThis();u==null||u.addEventListener(i,d)}else if(e===Event_Source_Type.canvas){const d=(function(f){const g={event:f,type:i,source:e,item:null,datum:null,markId:null,modelId:null,markUserId:null,modelUserId:null};n.call(null,g)}).bind(this);this._canvasListeners.set(n,{type:i,callback:d});const u=(l=this.getStage())===null||l===void 0?void 0:l.window;u==null||u.addEventListener(i,d)}}}removeEventListener(e,i,n){var o,l,d,u,f;if(this._option.interactive!==!1){if(e===Event_Source_Type.chart){const g=(o=this._viewListeners.get(n))===null||o===void 0?void 0:o.callback;g&&((l=this._view)===null||l===void 0||l.removeEventListener(i,g)),this._viewListeners.delete(n)}else if(e===Event_Source_Type.window){const g=this._getGlobalThis(),_=(d=this._windowListeners.get(n))===null||d===void 0?void 0:d.callback;_&&(g==null||g.removeEventListener(i,_)),this._windowListeners.delete(n)}else if(e===Event_Source_Type.canvas){const g=(u=this.getStage())===null||u===void 0?void 0:u.window,_=(f=this._canvasListeners.get(n))===null||f===void 0?void 0:f.callback;g&&_&&(g==null||g.removeEventListener(i,_)),this._canvasListeners.delete(n)}}}releaseEvent(){const e=this.getStage();e&&e.hooks.afterRender.unTap("chart-event",this.handleStageRender),this._viewListeners.clear(),this._windowListeners.clear(),this._canvasListeners.clear()}release(){var e;this.clearNextRender(),this.releaseEvent(),this._option=this._container=null,this._releaseModel(),(e=this._view)===null||e===void 0||e.release(),this._view=null,this.isInited=!1,this._compileChart=null,this._released=!0}releaseGrammar(e=!1){var i,n;this._releaseModel(),e&&((i=this._view)===null||i===void 0||i.removeAllGraphicItems()),(n=this._view)===null||n===void 0||n.removeAllGrammars()}_releaseModel(){Object.keys(this._model).forEach(e=>{Object.values(this._model[e]).forEach(i=>{Object.values(i).forEach(n=>{n.removeProduct(!0)})}),this._model[e]={}})}addGrammarItem(e){const i=e.getProduct();if(isNil(i))return;const n=i.id(),o=e.grammarType;isNil(this._model[o][n])&&(this._model[o][n]={}),this._model[o][n][e.id]=e}removeGrammarItem(e,i){var n;const o=e.getProduct();if(isNil(o))return;const l=o.id(),d=e.grammarType,u=this._model[d][l];isValid(u)&&(delete u[e.id],Object.keys(u).length===0&&delete this._model[d][l]),i||(n=this._view)===null||n===void 0||n.removeGrammar(o)}addInteraction(e){this._interactions||(this._interactions=[]),this._interactions.push(e)}removeInteraction(e){this._interactions&&(this._interactions=this._interactions.filter(i=>i.seriesId!==e))}updateDepend(e){return isValid(e)&&e.length>0?e.every(i=>i.updateDepend()):(Object.values(this._model).forEach(i=>{Object.values(i).forEach(n=>{const o=Object.values(n),l=o[0].getProduct(),d=o.reduce((u,f)=>f.getDepend().length>0?u.concat(f.getDepend()):u,[]).filter(u=>!!u).map(u=>u.getProduct());l.depend(d)})}),!0)}_getGlobalThis(){var e;return isTrueBrowser(this._option.mode)?globalThis:(e=this.getStage())===null||e===void 0?void 0:e.window}}var __awaiter$1=function(r,e,i,n){return new(i||(i=Promise))(function(o,l){function d(g){try{f(n.next(g))}catch(_){l(_)}}function u(g){try{f(n.throw(g))}catch(_){l(_)}}function f(g){var _;g.done?o(g.value):(_=g.value,_ instanceof i?_:new i(function(y){y(_)})).then(d,u)}f((n=n.apply(r,e||[])).next())})};function URLToImage(r="vchart",e){const i=document.createElement("a");i.setAttribute("href",e),i.setAttribute("target","_blank"),i.setAttribute("download",`${r}.png`),i.dispatchEvent(new MouseEvent("click"))}function OffscreenCanvasToDataURL(r){return new Promise(e=>{r.convertToBlob().then(i=>{const n=new FileReader;n.readAsDataURL(i),n.onload=()=>{e(n.result)}})})}function getCanvasDataURL(r,e){var i;return __awaiter$1(this,void 0,void 0,function*(){if(!r)return"";try{if(OffscreenCanvas!==void 0&&r instanceof OffscreenCanvas)return OffscreenCanvasToDataURL(r)}catch(n){((i=e==null?void 0:e.onError)!==null&&i!==void 0?i:error$1)(`getCanvasDataURL error : ${n.toString()}`)}return r.toDataURL()})}function setDefaultCrosshairForCartesianChart(r){r.crosshair=array(r.crosshair||{}).map(e=>mergeSpec({[r.direction==="horizontal"?"yField":"xField"]:{visible:!0,line:{visible:!0,type:"rect"}}},e))}function calculateChartSize(r,e,i){var n;const{width:o,height:l}=r;if(isValid(o)&&isValid(l))return{width:o,height:l};let d=i.width,u=i.height;const f=e.container,g=e.canvas;if(f){const{width:_,height:y}=getContainerSize(f,i.width,i.height);d=_,u=y}else if(g&&isTrueBrowser(e.mode)){let _;_=isString(g)?vglobal.getElementById(g):g;const{width:y,height:b}=getContainerSize(_,i.width,i.height);d=y,u=b}else if(isMiniAppLikeMode(e.mode)&&(!((n=e.modeParams)===null||n===void 0)&&n.domref)){const _=e.modeParams.domref;d=_.width,u=_.height}return d=o??d,u=l??u,{width:d,height:u}}function mergeUpdateResult(r,...e){const i=n=>e.reduce((o,l)=>o||(l==null?void 0:l[n]),r[n]);return Object.assign(r,{change:i("change"),reCompile:i("reCompile"),reMake:i("reMake"),reRender:i("reRender"),reSize:i("reSize"),reTransformSpec:i("reTransformSpec"),changeTheme:i("changeTheme"),changeBackground:i("changeBackground")}),r}function getTrimPaddingConfig(r,e){return r==="line"||r==="area"||r==="common"&&e.series.every(i=>i.type==="area"||i.type==="line")?{paddingInner:1,paddingOuter:0}:{paddingOuter:0}}var STATE_VALUE_ENUM;(function(r){r.STATE_NORMAL="normal",r.STATE_HOVER="hover",r.STATE_HOVER_REVERSE="hover_reverse",r.STATE_DIMENSION_HOVER="dimension_hover",r.STATE_DIMENSION_HOVER_REVERSE="dimension_hover_reverse",r.STATE_SELECTED="selected",r.STATE_SELECTED_REVERSE="selected_reverse",r.STATE_SANKEY_EMPHASIS="selected",r.STATE_SANKEY_EMPHASIS_REVERSE="blur"})(STATE_VALUE_ENUM||(STATE_VALUE_ENUM={}));var STATE_VALUE_ENUM_REVERSE;(function(r){r.STATE_HOVER_REVERSE="hover_reverse",r.STATE_DIMENSION_HOVER_REVERSE="dimension_hover_reverse",r.STATE_SELECTED_REVERSE="selected_reverse"})(STATE_VALUE_ENUM_REVERSE||(STATE_VALUE_ENUM_REVERSE={}));class MarkSet{constructor(){this._children=[],this._markNameMap={},this._infoMap=new Map}getMarkNameMap(){return this._markNameMap}addMark(e,i){isNil(e)||(this._children.push(e),this._markNameMap[e.name]=e,this._infoMap.set(e,merge$1({},MarkSet.defaultMarkInfo,i)))}removeMark(e){const i=this._children.findIndex(n=>n.name===e);i>=0&&(this._infoMap.delete(this._children[i]),delete this._markNameMap[e],this._children.splice(i,1))}clear(){this._children=[],this._markNameMap={},this._infoMap.clear()}forEach(e){this._children.forEach(e)}includes(e,i){return this._children.includes(e,i)}get(e){return isNaN(Number(e))?this._markNameMap[e]:this._children[e]}getMarks(){return this._children.slice()}getMarksInType(e){const i=array(e);return this._children.filter(n=>i.includes(n.type))}getMarkInId(e){return this._children.find(i=>i.id===e)}getMarkWithInfo(e){return this._children.find(i=>Object.keys(e).every(n=>e[n]===this._infoMap.get(i)[n]))}}MarkSet.defaultMarkInfo={};class DimensionTrigger{get hover(){return this._hover}get select(){return this._select}constructor(e){this._marks=new MarkSet,this._markReverse=new MarkSet,this.onHover=i=>{switch(i.action){case"enter":this.interaction.getEventElement(STATE_VALUE_ENUM.STATE_DIMENSION_HOVER).forEach(n=>this.interaction.addEventElement(STATE_VALUE_ENUM.STATE_DIMENSION_HOVER_REVERSE,n)),this.interaction.clearEventElement(STATE_VALUE_ENUM.STATE_DIMENSION_HOVER,!1),this.getEventElement(i).forEach(n=>this.interaction.addEventElement(STATE_VALUE_ENUM.STATE_DIMENSION_HOVER,n)),this.interaction.reverseEventElement(STATE_VALUE_ENUM.STATE_DIMENSION_HOVER);break;case"leave":this.interaction.clearEventElement(STATE_VALUE_ENUM.STATE_DIMENSION_HOVER,!0),i=null}},this._option=e,this.event=this._option.model.getOption().getChart().getEvent(),this.interaction=e.interaction,this.initConfig(e.mode)}setStateKeys(e){}registerMark(e){isEmpty(e.stateStyle[STATE_VALUE_ENUM.STATE_DIMENSION_HOVER])||this._marks.addMark(e),isEmpty(e.stateStyle[STATE_VALUE_ENUM.STATE_DIMENSION_HOVER_REVERSE])||this._markReverse.addMark(e)}init(){this.initEvent()}release(){this.releaseEvent()}initEvent(){this.event.on(DimensionEventEnum.dimensionHover,this.onHover)}releaseEvent(){this.event.release()}initConfig(e){}getEventElement(e,i=!1){const n=[];return e.dimensionInfo.forEach(o=>{o.data.forEach(l=>{(i?this._markReverse:this._marks).getMarks().filter(d=>d.model===l.series&&d.getVisible()).forEach(d=>{const u=d.getProduct();if(!u||!u.elements)return;const f=u.elements.filter(g=>{const _=g.getDatum();let y;return y=isArray(_)?_.every((b,S)=>b===l.datum[S]):l.datum.some(b=>b===_),i?!y:y});n.push(...f)})})}),n}}function isStateAttrChangeable(r,e,i){var n;const o=(n=e[r])===null||n===void 0?void 0:n.style;return isGradientAttribute(r,o)||isFunction(o)?!0:!(!(o!=null&&o.scale)||o.field===i)}function isGradientAttribute(r,e){return(r==="fill"||r==="stroke")&&(e==null?void 0:e.gradient)&&(e==null?void 0:e.stops)}const DEFAULT_STATE_VALUE_ENUM={};Object.values(STATE_VALUE_ENUM).forEach(r=>{DEFAULT_STATE_VALUE_ENUM[r]=!0});function stateInDefaultEnum(r){return!!DEFAULT_STATE_VALUE_ENUM[r]}const DEFAULT_STATE_VALUE_TO_REVERSE={[STATE_VALUE_ENUM.STATE_HOVER]:STATE_VALUE_ENUM.STATE_HOVER_REVERSE,[STATE_VALUE_ENUM.STATE_SELECTED]:STATE_VALUE_ENUM.STATE_SELECTED_REVERSE,[STATE_VALUE_ENUM.STATE_DIMENSION_HOVER]:STATE_VALUE_ENUM.STATE_DIMENSION_HOVER_REVERSE};function stateToReverse(r){return DEFAULT_STATE_VALUE_TO_REVERSE[r]}class Interaction{constructor(){this._stateMarks=new Map,this._stateElements=new Map,this._vgrammarInteractions=new Map,this._disableTriggerEvent=!1}addVgrammarInteraction(e,i){e&&(this._vgrammarInteractions.get(e)?this._vgrammarInteractions.get(e).push(i):this._vgrammarInteractions.set(e,[i]))}static markStateEnable(e,i){return!isEmpty(e.stateStyle[i])}setDisableActiveEffect(e){this._disableTriggerEvent=e}registerMark(e,i){var n;this._stateMarks.has(e)||this._stateMarks.set(e,[]),(n=this._stateMarks.get(e))===null||n===void 0||n.push(i)}getStateMark(e){return this._stateMarks.get(e)}filterEventMark(e,i){var n;return!(!e.mark||!(!((n=this._stateMarks.get(i))===null||n===void 0)&&n.includes(e.mark)))}getEventElement(e){var i;return(i=this._stateElements.get(e))!==null&&i!==void 0?i:[]}getEventElementData(e){return this.getEventElement(e).map(i=>i.getDatum())}exchangeEventElement(e,i){var n;if(this._disableTriggerEvent)return;const o=stateToReverse(e);(n=this._stateElements.get(e))===null||n===void 0||n.forEach(l=>{l.removeState(e),o&&this.addEventElement(o,l)}),i.getStates().includes(e)||(i.addState(e),o&&i.removeState(o)),this._stateElements.set(e,[i])}removeEventElement(e,i){var n,o;if(this._disableTriggerEvent)return;i.removeState(e);const l=(o=(n=this._stateElements.get(e))===null||n===void 0?void 0:n.filter(u=>u!==i))!==null&&o!==void 0?o:[];this._stateElements.set(e,l);const d=stateToReverse(e);d&&(l.length===0?this.clearEventElement(d,!1):this.addEventElement(d,i))}addEventElement(e,i){var n;if(this._disableTriggerEvent)return;i.getStates().includes(e)||i.addState(e);const o=(n=this._stateElements.get(e))!==null&&n!==void 0?n:[];o.push(i),this._stateElements.set(e,o)}clearEventElement(e,i){var n;if(!this._disableTriggerEvent&&((n=this._stateElements.get(e))===null||n===void 0||n.forEach(o=>{o.removeState(e)}),this._stateElements.set(e,[]),i)){const o=stateToReverse(e);o&&this.clearEventElement(o,!1)}}clearAllEventElement(){if(!this._disableTriggerEvent)for(const[e,i]of this._stateElements)i.forEach(n=>{n.clearStates()}),this._stateElements.set(e,[])}reverseEventElement(e){if(this._disableTriggerEvent)return;const i=stateToReverse(e);if(!i)return;const n=this.getStateMark(i);if(!n)return;const o=this.getEventElement(e);o.length&&(this.getEventElement(i).length||(o.length===1?n.forEach(l=>{l.getProduct().elements.filter(d=>d!==o[0]).forEach(d=>{this.addEventElement(i,d)})}):n.forEach(l=>{l.getProduct().elements.filter(d=>!o.includes(d)).forEach(d=>{this.addEventElement(i,d)})})))}startInteraction(e,i){const n=this._vgrammarInteractions.get(e);n&&n.forEach(o=>{o.start(i)})}resetInteraction(e,i){const n=this._vgrammarInteractions.get(e);n&&n.forEach(o=>{o.reset(i)})}resetAllInteraction(){for(const[e,i]of this._vgrammarInteractions)i&&i.forEach(n=>{n.reset(null)})}}const USER_LAYOUT_RECT_LEVEL=9,DEFAULT_LAYOUT_RECT_LEVEL=0;var LayoutZIndex;(function(r){r[r.SeriesGroup=0]="SeriesGroup",r[r.Axis_Grid=50]="Axis_Grid",r[r.CrossHair_Grid=100]="CrossHair_Grid",r[r.Region=450]="Region",r[r.Mark=300]="Mark",r[r.Node=400]="Node",r[r.Axis=100]="Axis",r[r.MarkLine=500]="MarkLine",r[r.MarkArea=100]="MarkArea",r[r.MarkPoint=500]="MarkPoint",r[r.DataZoom=500]="DataZoom",r[r.ScrollBar=500]="ScrollBar",r[r.Player=500]="Player",r[r.Legend=500]="Legend",r[r.CrossHair=500]="CrossHair",r[r.Indicator=500]="Indicator",r[r.Title=500]="Title",r[r.Label=500]="Label",r[r.Brush=500]="Brush",r[r.CustomMark=500]="CustomMark",r[r.Interaction=700]="Interaction"})(LayoutZIndex||(LayoutZIndex={}));var LayoutLevel;(function(r){r[r.Indicator=10]="Indicator",r[r.Region=20]="Region",r[r.Axis=30]="Axis",r[r.DataZoom=40]="DataZoom",r[r.Player=40]="Player",r[r.ScrollBar=40]="ScrollBar",r[r.Legend=50]="Legend",r[r.Title=70]="Title",r[r.CustomMark=70]="CustomMark"})(LayoutLevel||(LayoutLevel={}));var AttributeLevel;(function(r){r[r.Default=0]="Default",r[r.Theme=1]="Theme",r[r.Chart=2]="Chart",r[r.Base_Series=3]="Base_Series",r[r.Series=4]="Series",r[r.Mark=5]="Mark",r[r.User_Chart=6]="User_Chart",r[r.User_Series=7]="User_Series",r[r.User_Mark=8]="User_Mark",r[r.User_SeriesStyle=9]="User_SeriesStyle",r[r.Built_In=99]="Built_In"})(AttributeLevel||(AttributeLevel={}));class CompilableBase{getOption(){return this._option}constructor(e){this._option=e,this.getCompiler=this._option.getCompiler}getVGrammarView(){var e;return(e=this.getCompiler())===null||e===void 0?void 0:e.getVGrammarView()}release(){this._option=null,this.getCompiler=null}}class GrammarItem extends CompilableBase{constructor(){super(...arguments),this.id=createID(),this._compiledProductId=null,this._depend=[]}getProduct(){if(isValid(this._product))return this._product;const e=this.getVGrammarView(),i=this.getProductId();return isValid(i)&&isValid(e)&&(this._product=this._lookupGrammar(i)),this._product}getProductId(){var e;return(e=this._compiledProductId)!==null&&e!==void 0?e:this.generateProductId()}getDepend(){return this._depend}setDepend(...e){this._depend=e}compile(e){this._compileProduct(e),this._afterCompile(e)}_afterCompile(e){var i;isValid(this._product)&&((i=this.getCompiler())===null||i===void 0||i.addGrammarItem(this))}updateDepend(){if(isValid(this._product)){const e=this.getDepend().map(i=>i.getProduct()).filter(isValid);return this._product.depend(e),e.length===this.getDepend().length}return!1}release(){this.removeProduct(),super.release(),this._depend=[]}removeProduct(e){this.getCompiler().removeGrammarItem(this,e),this._product=null,this._compiledProductId=null}}class CompilableSignal extends GrammarItem{getValue(){return this._value}getUpdateFunc(){return this._updateFunc}constructor(e,i,n,o){super(e),this.grammarType=GrammarType.signal,this.name=i,this._value=n,this._updateFunc=o}updateSignal(e,i){this._value=e,this._updateFunc=i,this.compile()}_compileProduct(){const e=this.getVGrammarView();if(e){if(!this.getProduct()){const i=this.getProductId();this._product=e.signal().id(i),this._compiledProductId=i}isValid(this._value)&&this._product.value(this._value),isValid(this._updateFunc)&&this._product.update(this._updateFunc)}}generateProductId(){return this.name}_lookupGrammar(e){var i;return(i=this.getCompiler().getVGrammarView())===null||i===void 0?void 0:i.getSignalById(e)}}class SignalManager extends CompilableBase{constructor(){super(...arguments),this._signalMap={}}getSignalMap(){return this._signalMap}getSignal(e){return this._signalMap[e]}updateSignal(e,i,n){this._signalMap[e]?this._signalMap[e].updateSignal(i,n):(this._signalMap[e]=new CompilableSignal(this._option,e,i,n),this._signalMap[e].compile())}compile(){Object.values(this._signalMap).forEach(e=>{e.compile()})}release(){super.release(),Object.values(this._signalMap).forEach(e=>{e.release()}),this._signalMap={}}}class StateManager extends SignalManager{getStateMap(){return this._stateMap}_getDefaultStateMap(){return{}}constructor(e){super(e),e.stateKeyToSignalName?this.stateKeyToSignalName=e.stateKeyToSignalName:this.stateKeyToSignalName=()=>"state_signal",this.initStateMap()}initStateMap(e){this._stateMap=e??this._getDefaultStateMap()}compile(e){const i=e??this._stateMap;Object.keys(i).forEach(n=>{const o=this.stateKeyToSignalName(n),l=i[n];this.updateSignal(o,l)})}updateState(e,i){if(e&&(merge$1(this._stateMap,e),this.compile(e),!i))return this.getCompiler().renderNextTick()}}class AnimateManager extends StateManager{constructor(){super(...arguments),this.id=createID(),this.stateKeyToSignalName=e=>`${PREFIX}_animate_${this.id}_${e}`}getAnimationStateSignalName(){return this.stateKeyToSignalName("animationState")}updateAnimateState(e,i){e===AnimationStateEnum.update?this.updateState({animationState:{callback:(n,o)=>o.diffState}},i):e===AnimationStateEnum.appear?this.updateState({animationState:{callback:(n,o)=>o.diffState==="exit"?AnimationStateEnum.none:AnimationStateEnum.appear}},i):this.updateState({animationState:{callback:(n,o)=>e}},i)}_getDefaultStateMap(){return{animationState:{callback:(e,i)=>i.diffState==="exit"?AnimationStateEnum.exit:i.diffState==="update"?AnimationStateEnum.update:AnimationStateEnum.appear}}}}class BaseModelSpecTransformer{constructor(e){this._option=e,this.type=e.type}_initTheme(e,i){return this._theme=this.getTheme(e,i),this._mergeThemeToSpec(e,i)}getTheme(e,i){}transformSpec(e,i,n){this._transformSpecBeforeMergingTheme(e,i,n);const o=this._initTheme(e,i);return this._transformSpecAfterMergingTheme(o.spec,i,n),o}_transformSpecBeforeMergingTheme(e,i,n){}_transformSpecAfterMergingTheme(e,i,n){}_mergeThemeToSpec(e,i){const n=this._theme;if(this._shouldMergeThemeToSpec()){const o=this._getDefaultSpecFromChart(i),l=d=>mergeSpec({},n,o,d);return isArray(e)?{spec:e.map(d=>l(d)),theme:n}:{spec:l(e),theme:n}}return{spec:e,theme:n}}_shouldMergeThemeToSpec(){return!0}_getDefaultSpecFromChart(e){}}class BaseModel extends CompilableBase{getSpec(){return this._spec||{}}getSpecPath(){var e;return(e=this._option)===null||e===void 0?void 0:e.specPath}getSpecInfoPath(){var e,i,n;return(i=(e=this._option)===null||e===void 0?void 0:e.specInfoPath)!==null&&i!==void 0?i:(n=this._option)===null||n===void 0?void 0:n.specPath}getData(){return this._data}get layout(){return this._layout}getOption(){return this._option}getMarks(){var e,i;return(i=(e=this._marks)===null||e===void 0?void 0:e.getMarks())!==null&&i!==void 0?i:[]}getMarkNameMap(){var e;return(e=this._marks)===null||e===void 0?void 0:e.getMarkNameMap()}getMarkSet(){return this._marks}getChart(){return this._option.getChart()}get _theme(){var e;return(e=this.getSpecInfo())===null||e===void 0?void 0:e.theme}constructor(e,i){var n;super(i),this.transformerConstructor=BaseModelSpecTransformer,this.type="null",this.modelType="null",this.userId=void 0,this._data=null,this._layout=null,this.specKey="",this._marks=new MarkSet,this._lastLayoutRect=null,this.id=createID(),this.userId=e.id,this._spec=e,this.effect={},this.event=new Event$1(i.eventDispatcher,i.mode),(n=i.map)===null||n===void 0||n.set(this.id,this)}_releaseEvent(){this.event.release()}created(){this.setAttrFromSpec()}init(e){}afterInit(){}getVisible(){var e;return((e=this._spec)===null||e===void 0?void 0:e.visible)!==!1}onLayoutStart(e,i,n){var o;(o=this._layout)===null||o===void 0||o.onLayoutStart(e,i,n)}onLayoutEnd(e){var i;(i=this._layout)===null||i===void 0||i.onLayoutEnd(e),this.getMarks().forEach(n=>n.updateLayoutState(!0,!0))}onEvaluateEnd(e){}onDataUpdate(){}beforeRelease(){}release(){var e;this._releaseEvent(),this._spec=void 0,this.getMarks().forEach(i=>i.release()),(e=this._data)===null||e===void 0||e.release(),this._data=null,this._marks.clear(),super.release()}updateSpec(e){const i=this._compareSpec(e,this._spec);return this._spec=e,i}_compareSpec(e,i){return{change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1}}reInit(e){e&&(this._spec=e),this.setAttrFromSpec()}updateLayoutAttribute(){}setAttrFromSpec(){var e;(e=this._layout)===null||e===void 0||e.setAttrFromSpec(this._spec,this._option.getChartViewRect())}_convertMarkStyle(e){return Object.assign({},e)}setMarkStyle(e,i,n,o){isValid(e)&&isValid(i)&&e.setStyle(this._convertMarkStyle(i),n,o)}initMarkStyleWithSpec(e,i,n){if(!isValid(e)||!isValid(i))return;const{style:o,state:l}=i,d=Object.assign({},i);o&&(d.style=this._convertMarkStyle(o)),l&&(d.state={},Object.keys(l).forEach(u=>{d.state[u]=this._convertMarkStyle(l[u])})),e.initStyleWithSpec(d,n)}stateKeyToSignalName(e,i){let n=`${PREFIX}_${this.modelType}_${this.type}_${this.id}_${e}`;return i&&(n+=`_${i}`),n}compileData(){var e;(e=this._data)===null||e===void 0||e.compile()}compileMarks(e){this.getMarks().forEach(i=>{i.compile({group:e})})}_createMark(e,i={},n){const{type:o,name:l}=e,d=Factory$1.createMark(o,l,Object.assign({model:this,map:this._option.map,getCompiler:this.getCompiler,globalScale:this._option.globalScale},i));return d&&(d.created(),n&&d.setMarkConfig(n)),d}_getDataIdKey(){}getColorScheme(){var e,i;return(i=(e=this._option).getTheme)===null||i===void 0?void 0:i.call(e).colorScheme}getSpecInfo(){var e,i,n;const o=(n=(i=(e=this._option).getSpecInfo)===null||i===void 0?void 0:i.call(e))!==null&&n!==void 0?n:{};return getProperty(o,this.getSpecInfoPath())}getSpecIndex(){const e=this.getSpecPath();if(!(e!=null&&e.length))return 0;const i=Number(e[e.length-1]);return isNaN(i)?0:i}}class LayoutItem{getSpec(){return this._spec||{}}getLayoutStartPoint(){return this._layoutStartPoint}get layoutRectLevelMap(){return this._layoutRectLevelMap}get minWidth(){return this._minWidth}set minWidth(e){this._minWidth=e}get maxWidth(){return this._maxWidth}set maxWidth(e){this._maxWidth=e}get minHeight(){return this._minHeight}set minHeight(e){this._minHeight=e}get maxHeight(){return this._maxHeight}set maxHeight(e){this._maxHeight=e}getLastComputeOutBounds(){return this._lastComputeOutBounds}get layoutOrient(){return this._layoutOrient}set layoutOrient(e){this._layoutOrient=e}get model(){return this._model}get type(){return this._model.type}constructor(e,i){var n;this.layoutClip=!1,this.autoIndent=!1,this._layoutStartPoint={x:0,y:0},this._layoutRect={width:0,height:0},this._layoutRectLevelMap={width:DEFAULT_LAYOUT_RECT_LEVEL,height:DEFAULT_LAYOUT_RECT_LEVEL},this._minWidth=null,this._maxWidth=null,this._minHeight=null,this._maxHeight=null,this._lastComputeRect=null,this._lastComputeOutBounds={x1:0,x2:0,y1:0,y2:0},this.getLayoutRect=()=>this._layoutRect,this.layoutType="normal",this._layoutOrient="left",this.layoutPaddingLeft=0,this.layoutPaddingTop=0,this.layoutPaddingRight=0,this.layoutPaddingBottom=0,this.layoutOffsetX=0,this.layoutOffsetY=0,this.layoutLevel=LayoutLevel.Region,this._model=e,this._option=i,this.layoutLevel=i.layoutLevel,this.layoutType=i.layoutType,i.layoutOrient&&(this.layoutOrient=i.layoutOrient),this._spec=(n=e==null?void 0:e.getSpec)===null||n===void 0?void 0:n.call(e)}_setLayoutAttributeFromSpec(e,i){var n,o,l,d;if(this._spec&&this._spec.visible!==!1){const u=normalizeLayoutPaddingSpec(e.padding),f=calcPadding(u,i,i);this.layoutPaddingLeft=f.left,this.layoutPaddingRight=f.right,this.layoutPaddingTop=f.top,this.layoutPaddingBottom=f.bottom,this._minHeight=isNil(e.minHeight)?(n=this._minHeight)!==null&&n!==void 0?n:null:calcLayoutNumber(e.minHeight,i.height,i),this._maxHeight=isNil(e.maxHeight)?(o=this._maxHeight)!==null&&o!==void 0?o:null:calcLayoutNumber(e.maxHeight,i.height,i),this._minWidth=isNil(e.minWidth)?(l=this._minWidth)!==null&&l!==void 0?l:null:calcLayoutNumber(e.minWidth,i.width,i),this._maxWidth=isNil(e.maxWidth)?(d=this._maxWidth)!==null&&d!==void 0?d:null:calcLayoutNumber(e.maxWidth,i.width,i),e.width&&this.setLayoutRect({width:calcLayoutNumber(e.width,i.width,i)},{width:USER_LAYOUT_RECT_LEVEL}),e.height&&this.setLayoutRect({height:calcLayoutNumber(e.height,i.height,i)},{height:USER_LAYOUT_RECT_LEVEL}),isNil(e.offsetX)||(this.layoutOffsetX=calcLayoutNumber(e.offsetX,i.width,i)),isNil(e.offsetY)||(this.layoutOffsetY=calcLayoutNumber(e.offsetY,i.height,i)),e.alignSelf&&(this.alignSelf=e.alignSelf)}}setAttrFromSpec(e,i){var n,o,l,d;this._spec=e,this.layoutType=(n=e.layoutType)!==null&&n!==void 0?n:this.layoutType,this.layoutLevel=(o=e.layoutLevel)!==null&&o!==void 0?o:this.layoutLevel,this.layoutOrient=(l=e.orient)!==null&&l!==void 0?l:this.layoutOrient,this._setLayoutAttributeFromSpec(e,i),this.layoutClip=(d=e.clip)!==null&&d!==void 0?d:this.layoutClip}onLayoutStart(e,i,n){this._setLayoutAttributeFromSpec(this._spec,i)}onLayoutEnd(e){}_getAbsoluteSpecValue(e){const i={top:null,bottom:null,left:null,right:null};return["top","bottom","left","right"].forEach(n=>{isNil(this._spec[n])||(i[n]=calcLayoutNumber(this._spec[n],n==="top"||n==="bottom"?e.height:e.width,e))}),i}absoluteLayoutInRect(e){const{top:i,bottom:n,left:o,right:l}=this._getAbsoluteSpecValue(e),d={width:e.width-this.layoutPaddingLeft-this.layoutPaddingRight,height:e.height-this.layoutPaddingTop-this.layoutPaddingBottom};isNil(o)||(d.width-=o),isNil(l)||(d.width-=l),isNil(i)||(d.height-=i),isNil(n)||(d.height-=n),this.setLayoutRect(d);const{width:u,height:f}=this.computeBoundsInRect(this.getLayoutRect());this.setLayoutRect({width:u,height:f});const g={x:e.x,y:e.y};this._spec.center===!0?(g.x=e.x+.5*e.width-.5*u,g.y=e.y+.5*e.height-.5*f):(isNil(o)?isNil(l)||(g.x=e.x+e.width-this.layoutPaddingRight-l-u):g.x=e.x+o+this.layoutPaddingLeft,isNil(i)?isNil(n)||(g.y=e.y+e.height-this.layoutPaddingBottom-n-f):g.y=e.y+i+this.layoutPaddingTop),this.setLayoutStartPosition(g)}setLayoutStartPosition(e){var i,n;this._option.transformLayoutPosition&&(e=this._option.transformLayoutPosition(e)),isValidNumber(e.x)&&(this._layoutStartPoint.x=e.x),isValidNumber(e.y)&&(this._layoutStartPoint.y=e.y),(n=(i=this._model).afterSetLayoutStartPoint)===null||n===void 0||n.call(i,this._layoutStartPoint)}setLayoutRect({width:e,height:i},n){var o,l,d,u;isValidNumber(e)&&((o=n==null?void 0:n.width)!==null&&o!==void 0?o:DEFAULT_LAYOUT_RECT_LEVEL)>=this._layoutRectLevelMap.width&&(this._layoutRect.width=e,this._layoutRectLevelMap.width=(l=n==null?void 0:n.width)!==null&&l!==void 0?l:DEFAULT_LAYOUT_RECT_LEVEL),isValidNumber(i)&&((d=n==null?void 0:n.height)!==null&&d!==void 0?d:DEFAULT_LAYOUT_RECT_LEVEL)>=this._layoutRectLevelMap.height&&(this._layoutRect.height=i,this._layoutRectLevelMap.height=(u=n==null?void 0:n.height)!==null&&u!==void 0?u:DEFAULT_LAYOUT_RECT_LEVEL),this.setRectInSpec(this._layoutRect)}getLayout(){return{x:this._layoutStartPoint.x,y:this._layoutStartPoint.y,width:this._layoutRect.width,height:this._layoutRect.height}}mergeLayoutRect({width:e,height:i}){const n={width:e,height:i};return this._layoutRectLevelMap.width>DEFAULT_LAYOUT_RECT_LEVEL&&(n.width=this._layoutRect.width),this._layoutRectLevelMap.height>DEFAULT_LAYOUT_RECT_LEVEL&&(n.height=this._layoutRect.height),n}getOrientPosAttribute(){return this._layoutOrient==="bottom"||this._layoutOrient==="top"?"x":"y"}getOrientSizeAttribute(){return this._layoutOrient==="bottom"||this._layoutOrient==="top"?"width":"height"}changeBoundsBySetting(e){return this._layoutRectLevelMap.width>DEFAULT_LAYOUT_RECT_LEVEL&&(e.x2=e.x1+this._layoutRect.width),this._layoutRectLevelMap.height>DEFAULT_LAYOUT_RECT_LEVEL&&(e.y2=e.y1+this._layoutRect.height),e.x1-=this._layoutStartPoint.x,e.x2-=this._layoutStartPoint.x,e.y1-=this._layoutStartPoint.y,e.y2-=this._layoutStartPoint.y,e}setRectInSpec(e){const i=Object.assign({},e);return this._layoutRectLevelMap.width<USER_LAYOUT_RECT_LEVEL?(isNil(this._minWidth)||(i.width=Math.max(i.width,this._minWidth)),isNil(this._maxWidth)||(i.width=Math.min(i.width,this._maxWidth))):i.width=this._layoutRect.width,this._layoutRectLevelMap.height<USER_LAYOUT_RECT_LEVEL?(isNil(this._minHeight)||(i.height=Math.max(i.height,this._minHeight)),isNil(this._maxHeight)||(i.height=Math.min(i.height,this._maxHeight))):i.height=this._layoutRect.height,i}computeBoundsInRect(e){if(this._lastComputeRect=e,!(this.layoutType!=="region-relative"&&this.layoutType!=="region-relative-overlap"||(this._layoutRectLevelMap.width!==USER_LAYOUT_RECT_LEVEL||this.layoutOrient!=="left"&&this.layoutOrient!=="right")&&(this._layoutRectLevelMap.height!==USER_LAYOUT_RECT_LEVEL||this.layoutOrient!=="bottom"&&this.layoutOrient!=="top")))return this._layoutRect;const i=Object.assign({},this._model.getBoundsInRect(this.setRectInSpec(e),e));this.changeBoundsBySetting(i),this.autoIndent&&i.x2-i.x1>0&&i.y2-i.y1>0&&(this._lastComputeOutBounds.x1=Math.ceil(-i.x1),this._lastComputeOutBounds.x2=Math.ceil(i.x2-e.width),this._lastComputeOutBounds.y1=Math.ceil(-i.y1),this._lastComputeOutBounds.y2=Math.ceil(i.y2-e.height));let n=this.setRectInSpec(boundsInRect(i,e));return this._option.transformLayoutRect&&(n=this._option.transformLayoutRect(n)),n}getModelId(){return this._model.id}getModelVisible(){return this._model.getVisible()}}class LayoutModel extends BaseModel{constructor(){super(...arguments),this.layoutType="normal",this.layoutLevel=0,this.layoutZIndex=0,this._forceLayoutTag=!1,this._layout=null,this._orient=null,this._layoutRect={width:0,height:0},this._layoutStartPos={x:0,y:0},this._isLayout=!0,this.getGraphicBounds=()=>this._layout?{x1:this._layout.getLayoutStartPoint().x,y1:this._layout.getLayoutStartPoint().y,x2:this._layout.getLayoutStartPoint().x+this._layout.getLayoutRect().width,y2:this._layout.getLayoutStartPoint().y+this._layout.getLayoutRect().height}:{x1:0,x2:0,y1:0,y2:0},this._transformLayoutRect=null,this._transformLayoutPosition=null}get layoutOrient(){return this._orient}set layoutOrient(e){this._orient=e,this._layout&&(this._layout.layoutOrient=e)}initLayout(){this.layoutType!=="none"&&(this._layout=new LayoutItem(this,{layoutType:this.layoutType,layoutLevel:this.layoutLevel,layoutOrient:this._orient,transformLayoutRect:this._transformLayoutRect,transformLayoutPosition:this._transformLayoutPosition}),this._orient&&this._orient!=="radius"&&this._orient!=="angle"&&this._layout&&(this._layout.layoutOrient=this._orient))}onLayoutStart(e,i,n){this._isLayout=!0,super.onLayoutStart(e,i,n)}onLayoutEnd(e){super.onLayoutEnd(e),this.updateLayoutAttribute();const i=this.getLayoutRect();!this._forceLayoutTag&&isEqual(this._lastLayoutRect,i)||(this._lastLayoutRect=Object.assign({},i)),this._forceLayoutTag=!1,this._isLayout=!1}afterSetLayoutStartPoint(e){}_forceLayout(){var e;this._isLayout||(this._forceLayoutTag=!0,(e=this._option.globalInstance.getChart())===null||e===void 0||e.setLayoutTag(!0))}getLayoutStartPoint(){return this._layout?this._layout.getLayoutStartPoint():this._layoutStartPos}setLayoutStartPosition(e){return this._layout?this._layout.setLayoutStartPosition(e):this._layoutStartPos=merge$1(this._layoutStartPos,e)}getLayoutRect(){return this._layout?this._layout.getLayoutRect():this._layoutRect}setLayoutRect(e,i){return this._layout?this._layout.setLayoutRect(e):this._lastLayoutRect=merge$1(this._layoutRect,e)}getLastComputeOutBounds(){var e;return(e=this._layout)===null||e===void 0?void 0:e.getLastComputeOutBounds()}setAttrFromSpec(){var e,i,n,o,l;super.setAttrFromSpec(),this.layoutClip=(e=this._spec.clip)!==null&&e!==void 0?e:this.layoutClip,this.layoutZIndex=(i=this._spec.zIndex)!==null&&i!==void 0?i:this.layoutZIndex,this.layoutType=(n=this._spec.layoutType)!==null&&n!==void 0?n:this.layoutType,this._orient=(o=this._spec.orient)!==null&&o!==void 0?o:this._orient,this.layoutLevel=(l=this._spec.layoutLevel)!==null&&l!==void 0?l:this.layoutLevel}}class RegionSpecTransformer extends BaseModelSpecTransformer{_initTheme(e,i){return{spec:e,theme:this._theme}}}class Region extends LayoutModel{getMaxWidth(){return this._layout.maxWidth}setMaxWidth(e){this._layout.maxWidth=e}getMaxHeight(){return this._layout.maxHeight}setMaxHeight(e){this._layout.maxHeight=e}getGroupMark(){return this._groupMark}getInteractionMark(){return this._interactionMark}getStackInverse(){return this._spec.stackInverse===!0}getStackSort(){return this._spec.stackSort===!0}constructor(e,i){var n;super(e,i),this.transformerConstructor=RegionSpecTransformer,this.modelType="region",this.specKey="region",this.type=Region.type,this._series=[],this.layoutType="region",this.layoutZIndex=LayoutZIndex.Region,this.interaction=new Interaction,this.seriesDataFilterOver=()=>{this.event.emit(ChartEvent.regionSeriesDataFilterOver,{model:this,chart:this.getChart()}),this._series.forEach(o=>{o.getViewDataFilter()&&o.reTransformViewData()})},this.getBoundsInRect=()=>({x1:this._layout.getLayoutStartPoint().x,y1:this._layout.getLayoutStartPoint().y,x2:this._layout.getLayoutStartPoint().x+this._layout.getLayoutRect().width,y2:this._layout.getLayoutStartPoint().y+this._layout.getLayoutRect().height}),this.userId=e.id,this.coordinate=(n=e.coordinate)!==null&&n!==void 0?n:"cartesian",this._option.animation&&(this.animate=new AnimateManager({getCompiler:i.getCompiler})),this.interaction.setDisableActiveEffect(this._option.disableTriggerEvent)}_getClipDefaultValue(){var e,i,n,o;const l=this._option.getChart().getSpec(),d=(i=(e=l.dataZoom)===null||e===void 0?void 0:e.some)===null||i===void 0?void 0:i.call(e,f=>{var g;return((g=f.filterMode)!==null&&g!==void 0?g:"filter")==="axis"}),u=(o=(n=l.scrollBar)===null||n===void 0?void 0:n.some)===null||o===void 0?void 0:o.call(n,f=>{var g;return((g=f.filterMode)!==null&&g!==void 0?g:"axis")==="axis"});return!(!d&&!u)||this._layout.layoutClip}created(){var e,i;this.initLayout(),super.created();const n=(e=this._spec.clip)!==null&&e!==void 0?e:this._getClipDefaultValue();this._groupMark=this._createGroupMark("regionGroup",this.userId,this.layoutZIndex),this._spec.roam&&this._groupMark.setMarkConfig({interactive:!0}),this._interactionMark=this._createGroupMark("regionInteractionGroup",((i=this.userId)!==null&&i!==void 0?i:this.type)+"_interaction",LayoutZIndex.Interaction),isEmpty(this._spec.style)||(this._backgroundMark=this._createMark({type:"rect",name:"regionBackground"}),n&&(this._foregroundMark=this._createMark({type:"rect",name:"regionForeground"})),[this._backgroundMark,this._foregroundMark].forEach(o=>{o&&(o.created(),this.setMarkStyle(o,{width:()=>this.getLayoutRect().width,height:()=>this.getLayoutRect().height},"normal",AttributeLevel.Built_In),this._groupMark.addMark(o))}),this._backgroundMark&&this._backgroundMark.setMarkConfig({zIndex:LayoutZIndex.SeriesGroup-1}),this._foregroundMark&&this._foregroundMark.setMarkConfig({zIndex:LayoutZIndex.Mark+1})),this.createTrigger()}_createGroupMark(e,i,n){var o,l;const d=this._createMark({type:"group",name:e});d.setUserId(i),d.setMarkConfig({zIndex:n});const u=(o=this._spec.clip)!==null&&o!==void 0?o:this._getClipDefaultValue();return this.setMarkStyle(d,{x:()=>this.getLayoutStartPoint().x,y:()=>this.getLayoutStartPoint().y,width:()=>this.getLayoutRect().width,height:()=>this.getLayoutRect().height,clip:u},"normal",AttributeLevel.Built_In),this.setMarkStyle(d,{cornerRadius:(l=this._spec.style)===null||l===void 0?void 0:l.cornerRadius},"normal",AttributeLevel.User_Mark),this._marks.addMark(d),d}init(e){super.init(e),this.initMark(),this.initSeriesDataflow(),this.initInteraction(),this.initTrigger()}initMark(){this._initBackgroundMarkStyle(),this._initForegroundMarkStyle()}_initBackgroundMarkStyle(){var e,i;this._backgroundMark&&(this.setMarkStyle(this._backgroundMark,Object.assign({fillOpacity:!((e=this._spec.style)===null||e===void 0)&&e.fill?1:0},this._spec.style),"normal",AttributeLevel.User_Mark),((i=this._spec.clip)!==null&&i!==void 0?i:this._getClipDefaultValue())&&this.setMarkStyle(this._backgroundMark,{strokeOpacity:0},"normal",AttributeLevel.Built_In))}_initForegroundMarkStyle(){this._foregroundMark&&this.setMarkStyle(this._foregroundMark,Object.assign(Object.assign({},this._spec.style),{fillOpacity:0,pickable:!1}),"normal",AttributeLevel.User_Mark)}_compareSpec(e,i){const n=super._compareSpec(e,i);return isEqual(i==null?void 0:i.style,e==null?void 0:e.style)||(n.reMake=!0),n}reInit(e){super.reInit(e),this._initBackgroundMarkStyle(),this._initForegroundMarkStyle()}addSeries(e){e&&(this._series.includes(e)||this._series.push(e))}removeSeries(e){if(!e)return;const i=this._series.findIndex(n=>n===e);i>=0&&this._series.splice(i,1)}getSeries(e={}){return this._series.filter(i=>{var n,o;return(!e.name||(i==null?void 0:i.name)===e.name)&&(!e.userId||array(e.userId).includes(i.userId))&&(!isValid(e.specIndex)||array(e.specIndex).includes(i.getSpecIndex()))&&(!e.id||i.id===e.id)&&(!e.type||i.type===e.type)&&(!e.coordinateType||i.coordinate===e.coordinateType)&&(!e.dataName||((o=(n=i.getRawData)===null||n===void 0?void 0:n.call(i))===null||o===void 0?void 0:o.name)===e.dataName)})}getSeriesInName(e){return this.getSeries({name:e})[0]}getSeriesInUserId(e){return this.getSeries({userId:e})[0]}getSeriesInId(e){return this.getSeries({id:e})[0]}getSeriesInType(e){return this.getSeries({type:e})}getSeriesInCoordinateType(e){return this.getSeries({coordinateType:e})}getSeriesInDataName(e){return this.getSeries({dataName:e})}onRender(e){}initSeriesDataflow(){const e=this._series.map(i=>{var n;return(n=i.getViewDataFilter())!==null&&n!==void 0?n:i.getViewData()}).filter(i=>!!i);this._option.dataSet.multipleDataViewAddListener(e,"change",this.seriesDataFilterOver)}release(){super.release(),this._series=[]}createTrigger(){const e=Object.assign(Object.assign({},this._option),{model:this,interaction:this.interaction});this._trigger=new DimensionTrigger(e)}initTrigger(){this._series.forEach(e=>{e.getMarksWithoutRoot().forEach(i=>{this._trigger.registerMark(i)})}),this._trigger.init()}initInteraction(){this._option.disableTriggerEvent||this._series.forEach(e=>{e.getMarksWithoutRoot().forEach(i=>{for(const n in STATE_VALUE_ENUM_REVERSE)isEmpty(i.stateStyle[STATE_VALUE_ENUM_REVERSE[n]])||this.interaction.registerMark(STATE_VALUE_ENUM_REVERSE[n],i)})})}compileMarks(e){this.getMarks().forEach(i=>{var n;i.compile({group:e,context:{model:this}}),(n=i.getProduct())===null||n===void 0||n.layout((o,l,d,u)=>{})})}compile(){var e;(e=this.animate)===null||e===void 0||e.compile(),this.compileMarks()}onLayoutEnd(e){this._series.forEach(i=>i.onLayoutEnd(e)),super.onLayoutEnd(e)}}Region.type="region",Region.transformerConstructor=RegionSpecTransformer,Region.specKey="region";function getPositionItems(r){const e=[],i=[],n=[];return r.forEach(o=>{isNil(o.getSpec().position)||o.getSpec().position==="start"?e.push(o):o.getSpec().position==="middle"?i.push(o):o.getSpec().position==="end"&&n.push(o)}),{startItems:e,endItems:n,middleItems:i}}function adjustItemsToCenter(r,e,i){e?r.forEach(n=>{const o=last(n),l=o.getLayoutStartPoint().y+o.getLayoutRect().height-n[0].getLayoutStartPoint().y,d=(i-l)/2;n.forEach(u=>{u.setLayoutStartPosition({x:u.getLayoutStartPoint().x,y:u.getLayoutStartPoint().y+d})})}):r.forEach(n=>{const o=last(n),l=o.getLayoutStartPoint().x+o.getLayoutRect().width-n[0].getLayoutStartPoint().x,d=(i-l)/2;n.forEach(u=>{u.setLayoutStartPosition({x:u.getLayoutStartPoint().x+d,y:u.getLayoutStartPoint().y})})})}function alignSelfOfItems(r,e,i,n){let o;r.forEach((l,d)=>{l.length>1&&(o=i[d],l.forEach(u=>{if(!u.alignSelf||u.alignSelf==="start")return;const f=u.getLayoutStartPoint(),g=u.alignSelf==="middle"?.5:1,_=e?o-(u.getLayoutRect().width+u.layoutPaddingLeft+u.layoutPaddingRight):o-(u.getLayoutRect().height+u.layoutPaddingTop+u.layoutPaddingBottom);e?u.setLayoutStartPosition({x:f.x+n*_*g,y:f.y}):u.setLayoutStartPosition({x:f.x,y:f.y+n*_*g})}))})}function layoutLeftRightStartOrMiddleItems(r,e,i,n,o){if(r.length){let l=0;const d=o==="right",u=d?-1:1;let f=d?e.rightCurrent:e.leftCurrent,g=e.topCurrent;const _=[];let y=[];const b=[];r.forEach(S=>{const v=e.getItemComputeLayoutRect(S),A=S.computeBoundsInRect(v);S.setLayoutRect(A);const x=A.height+S.layoutPaddingTop+S.layoutPaddingBottom,T=A.width+S.layoutPaddingLeft+S.layoutPaddingRight,C=d?-A.width-S.layoutPaddingRight:S.layoutPaddingLeft;S.setLayoutStartPosition({x:f+S.layoutOffsetX+C,y:g+S.layoutOffsetY+S.layoutPaddingTop}),g+=x,g>i&&y.length?(b.push(l),f+=u*l,l=T,g=e.topCurrent+x,S.setLayoutStartPosition({x:f+S.layoutOffsetX+C,y:e.topCurrent+S.layoutOffsetY+S.layoutPaddingTop}),_.push(y),y=[S]):(l=Math.max(l,T),y.push(S))}),b.push(l),_.push(y),alignSelfOfItems(_,!0,b,u),n&&adjustItemsToCenter(_,!0,i),d?e.rightCurrent=f+u*l:e.leftCurrent=f+u*l}}function layoutLeftRightEndItems(r,e,i,n){if(r.length){let o=0;const l=n==="right",d=l?-1:1;let u=l?e.rightCurrent:e.leftCurrent,f=e.bottomCurrent;const g=[];let _=[];const y=[];r.forEach(b=>{const S=e.getItemComputeLayoutRect(b),v=b.computeBoundsInRect(S);b.setLayoutRect(v);const A=v.height+b.layoutPaddingTop+b.layoutPaddingBottom,x=v.width+b.layoutPaddingLeft+b.layoutPaddingRight,T=l?-v.width-b.layoutPaddingRight:b.layoutPaddingLeft;f<A&&_.length?(y.push(o),u+=d*o,o=x,f=e.bottomCurrent,b.setLayoutStartPosition({x:u+b.layoutOffsetX+T,y:f+b.layoutOffsetY-v.height-b.layoutPaddingBottom}),g.push(_),_=[b]):(b.setLayoutStartPosition({x:u+b.layoutOffsetX+T,y:f+b.layoutOffsetY-v.height-b.layoutPaddingBottom}),o=Math.max(o,x),f-=A,_.push(b))}),y.push(o),g.push(_),alignSelfOfItems(g,!0,y,d),l?e.rightCurrent=u+d*o:e.leftCurrent=u+d*o}}function layoutTopBottomStartOrMiddleItems(r,e,i,n,o){if(r.length){const l=o==="top",d=l?1:-1;let u=0,f=e.leftCurrent,g=l?e.topCurrent:e.bottomCurrent;const _=[];let y=[];const b=[];r.forEach(S=>{const v=e.getItemComputeLayoutRect(S),A=S.computeBoundsInRect(v);S.setLayoutRect(A);const x=A.height+S.layoutPaddingTop+S.layoutPaddingBottom,T=A.width+S.layoutPaddingLeft+S.layoutPaddingRight,C=l?S.layoutPaddingTop:-A.height-S.layoutPaddingBottom;S.setLayoutStartPosition({x:f+S.layoutOffsetX+S.layoutPaddingLeft,y:g+S.layoutOffsetY+C}),f+=T,f>i&&y.length?(b.push(u),f=e.leftCurrent+T,g+=d*u,u=x,S.setLayoutStartPosition({x:e.leftCurrent+S.layoutOffsetX+S.layoutPaddingLeft,y:g+S.layoutOffsetY+C}),_.push(y),y=[S]):(u=Math.max(u,x),y.push(S))}),b.push(u),_.push(y),alignSelfOfItems(_,!1,b,d),n&&adjustItemsToCenter(_,!1,i),l?e.topCurrent=g+d*u:e.bottomCurrent=g+d*u}}function layoutTopBottomEndItems(r,e,i,n){if(r.length){const o=n==="top",l=o?1:-1;let d=0,u=e.rightCurrent,f=o?e.topCurrent:e.bottomCurrent;const g=[];let _=[];const y=[];r.forEach(b=>{const S=e.getItemComputeLayoutRect(b),v=b.computeBoundsInRect(S);b.setLayoutRect(v);const A=v.height+b.layoutPaddingTop+b.layoutPaddingBottom,x=v.width+b.layoutPaddingLeft+b.layoutPaddingRight,T=o?b.layoutPaddingTop:-v.height-b.layoutPaddingBottom;u<x&&_.length?(u=e.rightCurrent,f+=l*d,d=A,b.setLayoutStartPosition({x:e.rightCurrent+b.layoutOffsetX-v.width-b.layoutPaddingRight,y:f+b.layoutOffsetY+T}),g.push(_),_=[b]):(_.push(b),b.setLayoutStartPosition({x:u+b.layoutOffsetX-v.width-b.layoutPaddingRight,y:f+b.layoutOffsetY+T}),d=Math.max(d,A),u-=x)}),y.push(d),g.push(_),alignSelfOfItems(g,!1,y,l),o?e.topCurrent=f+l*d:e.bottomCurrent=f+l*d}}function layoutLeftInlineItems(r,e,i){const{startItems:n,middleItems:o,endItems:l}=getPositionItems(r);n.length&&layoutLeftRightStartOrMiddleItems(n,e,i,!1,"left"),o.length&&layoutLeftRightStartOrMiddleItems(o,e,i,!0,"left"),l.length&&layoutLeftRightEndItems(l,e,i,"left")}function layoutRightInlineItems(r,e,i){const{startItems:n,middleItems:o,endItems:l}=getPositionItems(r);n.length&&layoutLeftRightStartOrMiddleItems(n,e,i,!1,"right"),o.length&&layoutLeftRightStartOrMiddleItems(o,e,i,!0,"right"),l.length&&layoutLeftRightEndItems(l,e,i,"right")}function layoutTopInlineItems(r,e,i){const{startItems:n,middleItems:o,endItems:l}=getPositionItems(r);n.length&&layoutTopBottomStartOrMiddleItems(n,e,i,!1,"top"),o.length&&layoutTopBottomStartOrMiddleItems(o,e,i,!0,"top"),l.length&&layoutTopBottomEndItems(l,e,i,"top")}function layoutBottomInlineItems(r,e,i){const{startItems:n,middleItems:o,endItems:l}=getPositionItems(r);n.length&&layoutTopBottomStartOrMiddleItems(n,e,i,!1,"bottom"),o.length&&layoutTopBottomStartOrMiddleItems(o,e,i,!0,"bottom"),l.length&&layoutTopBottomEndItems(l,e,i,"bottom")}let Layout$1=class{constructor(e,i){this.leftCurrent=0,this.topCurrent=0,this.rightCurrent=0,this.bottomCurrent=0,this._onError=i==null?void 0:i.onError}_layoutInit(e,i,n,o){this._chartLayoutRect=n,this._chartViewBox=o,this.leftCurrent=n.x,this.topCurrent=n.y,this.rightCurrent=n.x+n.width,this.bottomCurrent=n.height+n.y,i.sort((l,d)=>d.layoutLevel-l.layoutLevel)}_layoutNormalItems(e){this.layoutNormalInlineItems(e.filter(i=>i.layoutType==="normal-inline")),this.layoutNormalItems(e.filter(i=>i.layoutType==="normal"))}_groupItems(e){const i=e.filter(u=>u.layoutType==="region"),n=e.filter(u=>u.layoutType==="region-relative"),o=e.filter(u=>u.layoutType==="region-relative-overlap"),l=n.concat(o),d={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}};return o.forEach(u=>{d[u.layoutOrient].items.push(u)}),{regionItems:i,relativeItems:n,relativeOverlapItems:o,allRelatives:l,overlapItems:d}}layoutItems(e,i,n,o){this._layoutInit(e,i,n,o),this._layoutNormalItems(i);const l={left:this.leftCurrent,top:this.topCurrent,right:this.rightCurrent,bottom:this.bottomCurrent},{regionItems:d,relativeItems:u,relativeOverlapItems:f,allRelatives:g,overlapItems:_}=this._groupItems(i);this.layoutRegionItems(d,u,f,_),this._processAutoIndent(d,u,f,_,g,l),this.layoutAbsoluteItems(i.filter(y=>y.layoutType==="absolute"))}_processAutoIndent(e,i,n,o={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}},l,d){if(l.some(u=>u.autoIndent)){const{top:u,bottom:f,left:g,right:_}=this._checkAutoIndent(l,d);(u||f||g||_)&&(this.topCurrent=d.top+u,this.bottomCurrent=d.bottom-f,this.leftCurrent=d.left+g,this.rightCurrent=d.right-_,this.layoutRegionItems(e,i,n,o))}}layoutNormalItems(e){e.forEach(i=>{const n=this.getItemComputeLayoutRect(i),o=i.computeBoundsInRect(n);i.setLayoutRect(o),i.layoutOrient==="left"?(i.setLayoutStartPosition({x:this.leftCurrent+i.layoutOffsetX+i.layoutPaddingLeft,y:this.topCurrent+i.layoutOffsetY+i.layoutPaddingTop}),this.leftCurrent+=o.width+i.layoutPaddingLeft+i.layoutPaddingRight):i.layoutOrient==="top"?(i.setLayoutStartPosition({x:this.leftCurrent+i.layoutOffsetX+i.layoutPaddingLeft,y:this.topCurrent+i.layoutOffsetY+i.layoutPaddingTop}),this.topCurrent+=o.height+i.layoutPaddingTop+i.layoutPaddingBottom):i.layoutOrient==="right"?(i.setLayoutStartPosition({x:this.rightCurrent+i.layoutOffsetX-o.width-i.layoutPaddingRight,y:this.topCurrent+i.layoutOffsetY+i.layoutPaddingTop}),this.rightCurrent-=o.width+i.layoutPaddingLeft+i.layoutPaddingRight):i.layoutOrient==="bottom"&&(i.setLayoutStartPosition({x:this.leftCurrent+i.layoutOffsetX+i.layoutPaddingRight,y:this.bottomCurrent+i.layoutOffsetY-o.height-i.layoutPaddingBottom}),this.bottomCurrent-=o.height+i.layoutPaddingTop+i.layoutPaddingBottom)})}layoutNormalInlineItems(e){const i=e.filter(f=>f.layoutOrient==="left"),n=e.filter(f=>f.layoutOrient==="right"),o=e.filter(f=>f.layoutOrient==="top"),l=e.filter(f=>f.layoutOrient==="bottom"),d=this._chartLayoutRect.width+this._chartLayoutRect.x,u=this._chartLayoutRect.height+this._chartLayoutRect.y;i.length&&layoutLeftInlineItems(i,this,u),o.length&&layoutTopInlineItems(o,this,d),n.length&&layoutRightInlineItems(n,this,u),l.length&&layoutBottomInlineItems(l,this,d)}_layoutRelativeOverlap(e,i){i.items.forEach(n=>{const o=this.getItemComputeLayoutRect(n),l=n.computeBoundsInRect(o);i.rect.width=Math.max(l.width+n.layoutPaddingLeft+n.layoutPaddingRight,i.rect.width),i.rect.height=Math.max(l.height+n.layoutPaddingTop+n.layoutPaddingBottom,i.rect.height)}),i.items.forEach(n=>{n.setLayoutRect(i.rect),e==="left"?n.setLayoutStartPosition({x:this.leftCurrent+n.layoutOffsetX}):e==="right"?n.setLayoutStartPosition({x:this.rightCurrent-i.rect.width+n.layoutOffsetX}):e==="top"?n.setLayoutStartPosition({x:this.topCurrent+n.layoutOffsetY}):n.setLayoutStartPosition({x:this.bottomCurrent-i.rect.height+n.layoutOffsetY})}),e==="left"?this.leftCurrent+=i.rect.width:e==="right"?this.rightCurrent-=i.rect.width:e==="top"?this.topCurrent+=i.rect.height:this.bottomCurrent-=i.rect.height}_layoutRelativeItem(e,i){const n=e.computeBoundsInRect(i);e.layoutOrient==="left"||e.layoutOrient==="right"?e.setLayoutRect({width:n.width}):e.setLayoutRect({height:n.height}),e.layoutOrient==="left"?(e.setLayoutStartPosition({x:this.leftCurrent+e.layoutOffsetX+e.layoutPaddingLeft}),this.leftCurrent+=n.width+e.layoutPaddingLeft+e.layoutPaddingRight):e.layoutOrient==="right"?(this.rightCurrent-=n.width+e.layoutPaddingLeft+e.layoutPaddingRight,e.setLayoutStartPosition({x:this.rightCurrent+e.layoutOffsetX+e.layoutPaddingLeft})):e.layoutOrient==="top"?(e.setLayoutStartPosition({y:this.topCurrent+e.layoutOffsetY+e.layoutPaddingTop}),this.topCurrent+=n.height+e.layoutPaddingTop+e.layoutPaddingBottom):e.layoutOrient==="bottom"&&(this.bottomCurrent-=n.height+e.layoutPaddingTop+e.layoutPaddingBottom,e.setLayoutStartPosition({y:this.bottomCurrent+e.layoutOffsetY+e.layoutPaddingTop}))}_layoutRegionItem(e,i,n){const o=Math.max(Math.min(i,...e.map(d=>{var u;return(u=d.maxWidth)!==null&&u!==void 0?u:Number.MAX_VALUE})),0),l=Math.max(Math.min(n,...e.map(d=>{var u;return(u=d.maxHeight)!==null&&u!==void 0?u:Number.MAX_VALUE})),0);return e.forEach(d=>{const u=o-d.layoutPaddingLeft-d.layoutPaddingRight,f=l-d.layoutPaddingTop-d.layoutPaddingBottom;d.setLayoutRect({width:u,height:f}),d.setLayoutStartPosition({x:this.leftCurrent+d.layoutOffsetX+d.layoutPaddingLeft,y:this.topCurrent+d.layoutOffsetY+d.layoutPaddingTop})}),{regionHeight:l,regionWidth:o}}layoutRegionItems(e,i,n,o={left:{items:[],rect:{width:0,height:0}},right:{items:[],rect:{width:0,height:0}},top:{items:[],rect:{width:0,height:0}},bottom:{items:[],rect:{width:0,height:0}},z:{items:[],rect:{width:0,height:0}}}){let l=this.rightCurrent-this.leftCurrent,d=this.bottomCurrent-this.topCurrent;i.filter(g=>g.layoutOrient==="left"||g.layoutOrient==="right").forEach(g=>{this._layoutRelativeItem(g,this.getItemComputeLayoutRect(g))}),this._layoutRelativeOverlap("left",o.left),this._layoutRelativeOverlap("right",o.right),l=this.rightCurrent-this.leftCurrent,i.filter(g=>g.layoutOrient==="top"||g.layoutOrient==="bottom").forEach(g=>{this._layoutRelativeItem(g,this.getItemComputeLayoutRect(g))}),this._layoutRelativeOverlap("top",o.top),this._layoutRelativeOverlap("bottom",o.bottom),d=this.bottomCurrent-this.topCurrent;const{regionWidth:u,regionHeight:f}=this._layoutRegionItem(e,l,d);i.concat(n).forEach(g=>{if(["left","right"].includes(g.layoutOrient)){const _=this.filterRegionsWithID(e,g.layoutBindRegionID[0]);g.setLayoutRect({height:_.getLayoutRect().height}),g.setLayoutStartPosition({y:_.getLayoutStartPoint().y+g.layoutOffsetY+g.layoutPaddingTop}),g.layoutOrient==="right"&&g.setLayoutStartPosition({x:g.getLayoutStartPoint().x+u-l})}else if(["top","bottom"].includes(g.layoutOrient)){const _=this.filterRegionsWithID(e,g.layoutBindRegionID[0]);g.setLayoutRect({width:_.getLayoutRect().width}),g.setLayoutStartPosition({x:_.getLayoutStartPoint().x+g.layoutOffsetX+g.layoutPaddingLeft}),g.layoutOrient==="bottom"&&g.setLayoutStartPosition({y:g.getLayoutStartPoint().y+f-d})}})}layoutAbsoluteItems(e){e.forEach(i=>{i.absoluteLayoutInRect(this._chartLayoutRect)})}filterRegionsWithID(e,i){var n;const o=e.find(l=>l.getModelId()===i);return o||((n=this._onError)!==null&&n!==void 0?n:error$1)("can not find target region item, invalid id"),o}getItemComputeLayoutRect(e){return{width:this.rightCurrent-this.leftCurrent-e.layoutPaddingLeft-e.layoutPaddingRight,height:this.bottomCurrent-this.topCurrent-e.layoutPaddingTop-e.layoutPaddingBottom}}_checkAutoIndent(e,i){const n={top:0,left:0,bottom:0,right:0};return e.forEach(o=>{if(!o.getModelVisible()||!o.autoIndent)return;const l=o.layoutOrient==="left"||o.layoutOrient==="right",d=o.getLastComputeOutBounds(),u=this._getOutInLayout(d,o,i);l?(n.top=Math.max(n.top,u.top),n.bottom=Math.max(n.bottom,u.bottom)):(n.left=Math.max(n.left,u.left),n.right=Math.max(n.right,u.right))}),n}_getOutInLayout(e,i,n){const{x:o,y:l}=i.getLayoutStartPoint(),{width:d,height:u}=i.getLayoutRect();return{left:n.left-(o-e.x1),right:o+d+e.x2-n.right,top:n.top-(l-e.y1),bottom:l+u+e.y2-n.bottom}}};Layout$1.type="base";const GradientType=["linear","radial","conical"],DEFAULT_LINEAR_GRADIENT_CONFIG={x0:0,y0:0,x1:1,y1:1},DEFAULT_RADIAL_GRADIENT_CONFIG={x0:0,y0:0,x1:1,y1:1,r0:0,r1:1},DEFAULT_CONICAL_GRADIENT_CONFIG={x:.5,y:.5,startAngle:0,endAngle:2*Math.PI},DEFAULT_GRADIENT_CONFIG={linear:DEFAULT_LINEAR_GRADIENT_CONFIG,radial:DEFAULT_RADIAL_GRADIENT_CONFIG,conical:DEFAULT_CONICAL_GRADIENT_CONFIG},MultiDatumMark=["line","area","trail"];function isMultiDatumMark(r){return MultiDatumMark.includes(r)}function curveTypeTransform(r,e){return r==="monotone"?e==="horizontal"?"monotoneY":"monotoneX":r}function is3DMark(r){return["arc3d","rect3d","pyramid3d"].includes(r)}class MarkStateManager extends StateManager{getStateInfoList(){return this._stateInfoList}constructor(e,i){super(e),this._stateInfoList=[],this._mark=i}_getDefaultStateMap(){return{markUpdateRank:1}}getStateInfo(e){return this._stateInfoList.find(i=>i.stateValue===e)}addStateInfo(e){if(this.getStateInfo(e.stateValue))return;e.level=e.level||0;let i=!0;for(let n=0;n<this._stateInfoList.length;n++){const o=this._stateInfoList[n].level;if(o&&o>e.level){this._stateInfoList.splice(n,0,e),i=!1;break}}i&&this._stateInfoList.push(e)}_clearStateBeforeSet(e){e.datums=null,e.items=null,e.fields=null,e.filter=null}changeStateInfo(e){const i=this.getStateInfo(e.stateValue);if(i){if(e.datums!==void 0&&(this._clearStateBeforeSet(i),i.datums=e.datums,i.datumKeys=e.datumKeys),e.items!==void 0&&(this._clearStateBeforeSet(i),i.items=e.items),e.fields!==void 0)if(this._clearStateBeforeSet(i),e.fields===null)i.fields=e.fields;else{i.fields=i.fields||{};for(const n in e.fields){const o=e.fields[n];i.fields[n]=i.fields[n]||{};const l=i.fields[n];isValid(o.domain)&&(l.domain=o.domain),isValid(o.type)&&(l.type=o.type)}}e.filter&&(this._clearStateBeforeSet(i),i.filter=e.filter)}else this.addStateInfo(e)}clearStateInfo(e){e.forEach(i=>{this.getStateInfo(i)&&this.changeStateInfo({stateValue:i,datumKeys:null,datums:null,fields:null,items:null,filter:null,cache:{}})})}checkOneState(e,i,n,o){var l;o=isBoolean(isMultiDatumMark)?o:!e.mark||isMultiDatumMark(e.mark.markType);let d=!1,u=!1;if(isValid(n.datums)&&n.datums.length>0)d=this.checkDatumState(n,i,o),u=!0;else if(n.items)d=(l=this.checkItemsState(n,e))!==null&&l!==void 0&&l,u=!0;else if(n.fields)d=this.checkFieldsState(n,i,e,o),u=!0;else if(!d&&n.filter){const f={mark:this._mark,renderNode:e,type:e.mark.markType};d=n.filter(i,f),u=!0}return u?d?"in":"out":"skip"}checkState(e,i){const n=e.getStates().filter(l=>stateInDefaultEnum(l)).map(l=>[l,10]),o=!e.mark||isMultiDatumMark(e.mark.markType);for(let l=0;l<this._stateInfoList.length;l++){const d=this._stateInfoList[l],u=this.checkOneState(e,i,d,o);u!=="skip"&&u==="in"&&n.push([d.stateValue,d.level])}return n.map(l=>l[0])}checkDatumState(e,i,n){let o=!1;const l=n?i[0]:i;if(isArray(e.datums)){const d=e.datumKeys||Object.keys(e.datums[0]).filter(u=>!u.startsWith(PREFIX));o=e.datums.some(u=>n&&isArray(u==null?void 0:u.items)?d.every(f=>{var g,_;return((_=(g=u==null?void 0:u.items)===null||g===void 0?void 0:g[0])===null||_===void 0?void 0:_[f])===(l==null?void 0:l[f])}):d.every(f=>(u==null?void 0:u[f])===(l==null?void 0:l[f])))}else isObject$1(e.datums)?o=(e.datumKeys||Object.keys(e.datums).filter(d=>!d.startsWith(PREFIX))).every(d=>{var u,f;return n?((u=e.datums.items)===null||u===void 0?void 0:u[0][d])===l[d]:((f=e.datums)===null||f===void 0?void 0:f[d])===l[d]}):o=i===e.datums;return o}checkItemsState(e,i){var n;return(n=e.items)===null||n===void 0?void 0:n.includes(i)}checkFieldsState(e,i,n,o){var l;let d=!0;for(const u in e.fields){const f=e.fields[u],g=f.type,_=f.domain,y=o?(l=i[0])===null||l===void 0?void 0:l[u]:i[u];if(isContinuous(g)&&_.length>1){if(this.checkLinearFieldState(_,u,i,n,o)){d=!1;break}d=!0}else{if(!_.some(b=>b===y)){d=!1;break}d=!0}}return d}checkLinearFieldState(e,i,n,o,l){var d;const u=l?(d=n[0])===null||d===void 0?void 0:d[i]:n[i];return u<e[0]||u>e[e.length-1]}updateLayoutState(e){return this._stateMap.markUpdateRank++,this.updateState({markUpdateRank:this._stateMap.markUpdateRank},e)}compileState(e,i){e.state({callback:(n,o)=>this.checkState(o,n)},i)}}class CompilableData extends GrammarItem{getDataView(){return this._data}setDataView(e){this._data=e}getLatestData(){var e;return(e=this._data)===null||e===void 0?void 0:e.latestData}constructor(e,i){super(e),this.grammarType=GrammarType.data,this._data=null,this._data=i}release(){super.release(),this._data=null}updateData(e){const i=this.getProduct(),n=this.getLatestData();if(i&&n&&(i.values(n),!e))return this.getCompiler().renderNextTick()}_compileProduct(){const e=this.getLatestData();isNil(e)||(isNil(this.getProduct())?this._initProduct(e):this._product.values(e))}_initProduct(e){var i,n;const o=this.getVGrammarView();if(!o||!e)return;const l=this.getProductId();this._product=(n=(i=o==null?void 0:o.data)===null||i===void 0?void 0:i.call(o,e))===null||n===void 0?void 0:n.id(l),this._compiledProductId=l}generateProductId(){var e;return`${(e=this.getDataView())===null||e===void 0?void 0:e.name}`}_lookupGrammar(e){var i,n;return(n=(i=this.getCompiler().getVGrammarView())===null||i===void 0?void 0:i.getDataById)===null||n===void 0?void 0:n.call(i,e)}}class MarkData extends CompilableData{constructor(e){super(e),this._mark=e.mark}setCompiledProductId(e){this._compiledProductId=e}generateProductId(){const e=super.generateProductId();return isValid(e)?e:`${PREFIX}_markData_${this._mark.id}`}_compileProduct(){var e;const i=(e=this._data)===null||e===void 0?void 0:e.latestData;isNil(i)||isValid(this.getProduct())||this._initProduct(i)}}var __rest$h=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};class CompilableMark extends GrammarItem{getMarkConfig(){return this._markConfig}setMarkConfig(e){Object.keys(e).forEach(i=>{this._markConfig[i]=e[i]})}getVisible(){return this._visible}setVisible(e){this._visible=e}getUserId(){return this._userId}setUserId(e){isValid(e)&&(this._userId=e)}getDataView(){var e;return(e=this._data)===null||e===void 0?void 0:e.getDataView()}setDataView(e,i){isNil(this._data)&&this.initMarkData(Object.assign(Object.assign({},this._option),{mark:this})),isValid(i)&&this._data.setCompiledProductId(i),this._data.setDataView(e)}getData(){return this._data}setData(e){this._data=e}hasState(e){return e in this.state.getStateMap()}getState(e){return this.state.getStateMap()[e]}getAnimationConfig(){return this._animationConfig}setAnimationConfig(e){this._animationConfig=e}setSkipBeforeLayouted(e){this._skipBeforeLayouted=e}getSkipBeforeLayouted(){return this._skipBeforeLayouted}getGroupKey(){return this._groupKey}setGroupKey(e){this._groupKey=e}setStateSortCallback(e){this._stateSort=e}constructor(e,i,n){super(e),this.grammarType=GrammarType.mark,this.type=void 0,this.name="mark",this._markConfig={zIndex:LayoutZIndex.Mark,morph:!1},this._visible=!0,this.stateStyle={},this._unCompileChannel={},this._skipBeforeLayouted=!1,this.name=i,this.model=n,this.key=e.key,this.state=new MarkStateManager(Object.assign(Object.assign({},e),{stateKeyToSignalName:this.stateKeyToSignalName.bind(this)}),this),this._event=new Event$1(n.getOption().eventDispatcher,n.getOption().mode)}setTransform(e){this._transform=e}initMarkData(e){this._data=new MarkData(e)}stateKeyToSignalName(e){return`${PREFIX}_${this.type}_${this.id}_${e}`}getAttribute(e,i,n,o){}_compileProduct(e){const i=this.getProduct();if(!this.getVisible())return void(isValid(i)&&this.removeProduct());isValid(i)||this.getCompiler().isInited&&(this._initProduct(e==null?void 0:e.group),isNil(this._product)||(this.compileSignal(),this.compileData(),this.compileState(),this.compileEncode(),this.compileAnimation(),this.compileContext(e==null?void 0:e.context),this.compileTransform()))}_initProduct(e){const i=this.getVGrammarView(),n=this.getProductId();this._product=i.mark(this.type,e??i.rootMark).id(n),this.name&&this._product&&this._product.name(this.name),this._compiledProductId=n}generateProductId(){return this._userId?`${this._userId}`:`${this.name}_${this.id}`}compileData(){if(isNil(this._data))return;this._data.compile();const e=this._data.getProduct();isValid(this._product)&&isValid(e)&&this._product.join(e,this.key,void 0,this.getGroupKey())}updateStaticEncode(){if(!this._product)return;const{enterStyles:e,updateStyles:i}=this._separateStyle();this._product.encodeState("group",e,!0),this._product.encode(i,!0)}_separateStyle(){const e=this.stateStyle,i=STATE_VALUE_ENUM.STATE_NORMAL,n=e[i],o=(__rest$h(e,[typeof i=="symbol"?i:i+""]),this._option.noSeparateStyle?null:{}),l={};return Object.keys(n).forEach(d=>{this._unCompileChannel[d]||(this._option.noSeparateStyle||isStateAttrChangeable(d,n,this.getGroupKey())?l[d]={callback:this.compileCommonAttributeCallback(d,"normal"),dependency:[this.stateKeyToSignalName("markUpdateRank")]}:o[d]=this.compileCommonAttributeCallback(d,"normal"))}),{enterStyles:o,updateStyles:l}}compileEncode(){const e=this.stateStyle,i=STATE_VALUE_ENUM.STATE_NORMAL,n=(e[i],__rest$h(e,[typeof i=="symbol"?i:i+""])),{enterStyles:o,updateStyles:l}=this._separateStyle();this._product.encode(l,!0),this._product.encodeState("group",o,!0),Object.keys(n).forEach(d=>{const u={};Object.keys(n[d]).forEach(f=>{this._unCompileChannel[f]||(u[f]={callback:this.compileCommonAttributeCallback(f,d),dependency:[this.stateKeyToSignalName("markUpdateRank")]})}),this._product.encodeState(d,u,!0)}),this._skipBeforeLayouted&&this._product.layout({skipBeforeLayouted:this._skipBeforeLayouted})}compileState(){this.state.compileState(this._product,this._stateSort)}compileAnimation(){var e,i,n,o;if(this._animationConfig){let l;if(this.type==="component")l=(e=this.model.animate)===null||e===void 0?void 0:e.getAnimationStateSignalName();else{const d=(n=(i=this.model).getRegion)===null||n===void 0?void 0:n.call(i);l=(o=d==null?void 0:d.animate)===null||o===void 0?void 0:o.getAnimationStateSignalName()}this._product.animation(this._animationConfig),this._product.animationState({callback:(d,u,f)=>{var g;return(g=f[l])===null||g===void 0?void 0:g.callback(d,u)},dependency:l}),this._animationConfig.normal&&(this._animationConfig.appear?this._event.on(HOOK_EVENT.ANIMATION_END,({event:d})=>{d.mark===this.getProduct()&&d.animationState===AnimationStateEnum.appear&&this.runAnimationByState(AnimationStateEnum.normal)}):this._event.on(HOOK_EVENT.AFTER_DO_RENDER,()=>{this.runAnimationByState(AnimationStateEnum.normal)}))}}compileContext(e){const i=Object.assign(Object.assign({},this._markConfig),{context:Object.assign({markId:this.id,modelId:this.model.id,markUserId:this._userId,modelUserId:this.model.userId},e)});this._product.configure(i)}compileSignal(){this.state.compile()}_computeAttribute(e,i){return(n,o)=>{}}compileCommonAttributeCallback(e,i){const n=this._computeAttribute(e,i),o={mark:null,parent:null,element:null};return(l,d)=>(o.mark=d.mark,o.parent=d.mark.group,o.element=d,n(l,o))}compileTransform(){var e;!((e=this._transform)===null||e===void 0)&&e.length&&this.getProduct().transform(this._transform)}_lookupGrammar(e){var i;return(i=this.getCompiler().getVGrammarView())===null||i===void 0?void 0:i.getMarkById(e)}updateState(e,i){return this.state.updateState(e,i)}updateLayoutState(e,i){return i&&this.getMarks().length>0&&this.getMarks().forEach(n=>n.state.updateLayoutState(!0)),this.state.updateLayoutState(e)}updateMarkState(e){if(!this._product)return;const i=this.state.getStateInfo(e);this._product.elements.forEach(n=>{this.state.checkOneState(n,n.getDatum(),i)==="in"?n.addState(e):n.removeState(e)})}getMarks(){return[]}runAnimationByState(e){var i,n;return(n=(i=this.getProduct())===null||i===void 0?void 0:i.animate)===null||n===void 0?void 0:n.runAnimationByState(e)}stopAnimationByState(e){var i,n;return(n=(i=this.getProduct())===null||i===void 0?void 0:i.animate)===null||n===void 0?void 0:n.stopAnimationByState(e)}pauseAnimationByState(e){var i,n;return(n=(i=this.getProduct())===null||i===void 0?void 0:i.animate)===null||n===void 0?void 0:n.pauseAnimationByState(e)}resumeAnimationByState(e){var i,n;return(n=(i=this.getProduct())===null||i===void 0?void 0:i.animate)===null||n===void 0?void 0:n.resumeAnimationByState(e)}getProductElements(){const e=this.getProduct();if(e)return e.elements}release(){super.release(),this.state.release()}}var __rest$g=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};class BaseMark extends CompilableMark{constructor(e,i){var n;super(i,e,i.model),this._extensionChannel={},this._computeExChannel={},this._attributeContext=i.attributeContext,(n=i.map)===null||n===void 0||n.set(this.id,this)}created(){this._initStyle()}initStyleWithSpec(e,i){e&&(isValid(e.id)&&(this._userId=e.id),isBoolean(e.interactive)&&(this._markConfig.interactive=e.interactive),isValid(e.zIndex)&&(this._markConfig.zIndex=e.zIndex),isBoolean(e.visible)&&this.setVisible(e.visible),this._initSpecStyle(e,this.stateStyle,i))}_transformStyleValue(e,i){if(e.scale){const n=e.scale,o=n.range();return n.range(o.map(i)),e}return typeof e=="function"?(...n)=>i(e(...n)):i(e)}convertAngleToRadian(e){return this._transformStyleValue(e,degreeToRadian)}isUserLevel(e){return[AttributeLevel.User_Mark,AttributeLevel.User_Series,AttributeLevel.User_Chart,AttributeLevel.User_SeriesStyle].includes(e)}setStyle(e,i="normal",n=0,o=this.stateStyle){if(isNil(e))return;o[i]===void 0&&(o[i]={});const l=this.isUserLevel(n);Object.keys(e).forEach(d=>{let u=e[d];isNil(u)||(u=this._filterAttribute(d,u,i,n,l,o),this.setAttribute(d,u,i,n,o))})}getStyle(e,i="normal"){var n;return(n=this.stateStyle[i][e])===null||n===void 0?void 0:n.style}_filterAttribute(e,i,n,o,l,d=this.stateStyle){let u=this._styleConvert(i);if(l)switch(e){case"angle":u=this.convertAngleToRadian(u);break;case"innerPadding":case"outerPadding":u=this._transformStyleValue(u,f=>-f);break;case"curveType":u=this._transformStyleValue(u,f=>curveTypeTransform(f,this._option.model.direction))}return u}setReferer(e,i,n,o=this.stateStyle){var l;if(e)if(i&&n){const d=(l=o[n])!==null&&l!==void 0?l:{[i]:{}};o[n][i]=Object.assign(Object.assign({},d[i]),{referer:e})}else Object.entries(o).forEach(([d,u])=>{Object.entries(u).forEach(([f,g])=>{o[d][f].referer=e})})}setPostProcess(e,i,n="normal"){var o;!((o=this.stateStyle[n])===null||o===void 0)&&o[e]&&(this.stateStyle[n][e].postProcess=i)}getAttribute(e,i,n="normal",o){return this._computeAttribute(e,n)(i,o)}setAttribute(e,i,n="normal",o=0,l=this.stateStyle){var d;l[n]===void 0&&(l[n]={}),l[n][e]===void 0&&(l[n][e]={level:o,style:i,referer:void 0});const u=(d=l[n][e])===null||d===void 0?void 0:d.level;isValid(u)&&u<=o&&mergeSpec(l[n][e],{style:i,level:o}),n!=="normal"&&e in this._extensionChannel&&this._extensionChannel[e].forEach(f=>{l[n][f]===void 0&&(l[n][f]=l.normal[f])})}_getDefaultStyle(){return{visible:!0,x:0,y:0}}_styleConvert(e){if(!e)return e;if(isValidScaleType(e.type)||e.scale){const i=createScaleWithSpec(e,{globalScale:this._option.globalScale,seriesId:this._option.seriesId});if(i)return{scale:i,field:e.field,changeDomain:e.changeDomain}}return e}_computeAttribute(e,i){var n;let o=(n=this.stateStyle[i])===null||n===void 0?void 0:n[e];o||(o=this.stateStyle.normal[e]);const l=this._computeStateAttribute(o,e,i),d=isFunction(o==null?void 0:o.postProcess),u=e in this._computeExChannel;if(d&&u){const f=this._computeExChannel[e];return(g,_)=>{let y=l(g,_);return y=o.postProcess(y,g,this._attributeContext,_,this.getDataView()),f(e,g,i,_,y)}}if(d)return(f,g)=>o.postProcess(l(f,g),f,this._attributeContext,g,this.getDataView());if(u){const f=this._computeExChannel[e];return(g,_)=>f(e,g,i,_,l(g,_))}return l}_computeStateAttribute(e,i,n){var o;return e?e.referer?e.referer._computeAttribute(i,n):e.style?typeof e.style=="function"?(l,d)=>e.style(l,this._attributeContext,d,this.getDataView()):GradientType.includes(e.style.gradient)?this._computeGradientAttr(e.style):["outerBorder","innerBorder"].includes(i)?this._computeBorderAttr(e.style):isValidScaleType((o=e.style.scale)===null||o===void 0?void 0:o.type)?(l,d)=>{let u=l;return this.model.modelType==="series"&&this.model.getMarkData&&(u=this.model.getMarkData(l)),e.style.scale.scale(u[e.style.field])}:(l,d)=>e.style:(l,d)=>e.style:(l,d)=>{}}_initStyle(){const e=this._getDefaultStyle();this.setStyle(e,"normal",0)}_initSpecStyle(e,i,n){e.style&&this.setStyle(e.style,"normal",AttributeLevel.User_Mark,i);const o=e.state;o&&Object.keys(o).forEach(l=>{const d=o[l];if("style"in d){const u=d.style;let f={stateValue:l};"level"in d&&(f.level=d.level),"filter"in d&&(f=isFunction(d.filter)?Object.assign({filter:d.filter},f):Object.assign(Object.assign({},d.filter),f)),this.state.addStateInfo(f),this.setStyle(u,l,AttributeLevel.User_Mark,i)}else this.setStyle(d,l,AttributeLevel.User_Mark,i)})}_computeGradientAttr(e){var i,n;const{gradient:o,scale:l,field:d}=e,u=__rest$g(e,["gradient","scale","field"]);let f=l,g=d;if(!(l&&d||this.model.modelType!=="series")){const{scale:b,field:S}=this.model.getColorAttribute();l||(f=b),g||(g=S)}const _=computeActualDataScheme(getDataScheme(this.model.getColorScheme(),this.model.modelType==="series"?(n=(i=this.model).getSpec)===null||n===void 0?void 0:n.call(i):void 0),this.model.getDefaultColorDomain()),y=Object.assign(Object.assign({},DEFAULT_GRADIENT_CONFIG[o]),u);return(b,S)=>{const v={},A=this.getDataView();return Object.keys(y).forEach(x=>{const T=y[x];x==="stops"?v.stops=T.map(C=>{const{opacity:E,color:P,offset:R}=C;let L=P??(f==null?void 0:f.scale(b[g]));return isFunction(P)&&(L=P(b,this._attributeContext,S,A)),isValid(E)&&(L=Color.SetOpacity(L,E)),{offset:isFunction(R)?R(b,this._attributeContext,S,A):R,color:L||_[0]}}):isFunction(T)?v[x]=T(b,this._attributeContext,S,A):v[x]=T}),v.gradient=o,v}}_computeBorderAttr(e){const{scale:i,field:n}=e,o=__rest$g(e,["scale","field"]);return(l,d)=>{var u,f,g;const _={};if(Object.keys(o).forEach(y=>{const b=o[y];isFunction(b)?_[y]=b(l,this._attributeContext,d,this.getDataView()):_[y]=b}),"stroke"in _)GradientType.includes((g=o.stroke)===null||g===void 0?void 0:g.gradient)&&(_.stroke=this._computeGradientAttr(o.stroke)(l,d));else{const y=computeActualDataScheme(getDataScheme(this.model.getColorScheme(),this.model.modelType==="series"?(f=(u=this.model).getSpec)===null||f===void 0?void 0:f.call(u):void 0),this.model.getDefaultColorDomain());let b=i,S=n;if(!(i&&n||this.model.modelType!=="series")){const{scale:v,field:A}=this.model.getColorAttribute();i||(b=v),S||(S=A),_.stroke=(b==null?void 0:b.scale(l[S]))||y[0]}}return _}}}class GroupMark extends BaseMark{constructor(){super(...arguments),this.type=GroupMark.type,this._marks=[]}getMarks(){return this._marks}_getDefaultStyle(){return Object.assign({},super._getDefaultStyle())}isMarkExist(e){return this._marks.find(i=>i.id===e.id)!==void 0}addMark(e){return this.isMarkExist(e)?(warn("Mark already exists, add mark failed."),!1):(this._marks.push(e),!0)}removeMark(e){const i=this._marks.findIndex(n=>n.id===e.id||n.name===e.name);return i===-1?(warn("Mark does not exists, removeMark failed."),!1):(this._marks.splice(i,1),!0)}getMarkInType(e){return this._marks.filter(i=>i.type===e)}getMarkInId(e){return this._marks.find(i=>i.id===e)}getMarkInUserId(e){let i;if(this._marks.forEach(n=>{n.getUserId()===e&&(i=n)}),!i)for(let n=0;n<this._marks.length;n++){const o=this._marks[n];if(o.type==="group"&&(i=o.getMarkInUserId(e)),i)break}return i}getMarkInName(e){return this._marks.filter(i=>i.name===e)}_compileProduct(e){super._compileProduct(e),this._product.configure({zIndex:this._markConfig.zIndex}),e!=null&&e.ignoreChildren||this.getMarks().forEach(i=>{i.getProduct()&&i.removeProduct(),i.compile({group:this._product})})}}GroupMark.type="group";const registerGroupMark=()=>{registerGroupGraphic(),Factory$1.registerMark(GroupMark.type,GroupMark)},VCHART_UTILS={measureText};class ExpressionFunction{static instance(){return ExpressionFunction.instance_||(ExpressionFunction.instance_=new ExpressionFunction),ExpressionFunction.instance_}constructor(){this.functions={}}registerFunction(e,i){e&&i&&(this.functions[e]=i)}unregisterFunction(e){e&&delete this.functions[e]}getFunction(e){return this.functions[e]||null}getFunctionNameList(){return Object.keys(this.functions)}}const registerBrowserEnv=()=>{loadBrowserEnv(container)},registerNodeEnv=()=>{loadNodeEnv(container)};class BasePluginService{constructor(){this.id=createID(),this._plugins=[]}add(e){if(!e||e.length===0)return null;const i=[];return e.forEach(n=>{this._plugins.find(o=>o.id===n.id)?warn("plugin"):(this._plugins.push(n),i.push(n),n.onAdd&&n.onAdd(this))}),i}load(e){const i=this.add(e);i&&i.length&&this.activate(e)}activate(e){e.length&&e.forEach(i=>{i.init&&i.init()})}get(e){return this._plugins.find(i=>i.id===e)}getAll(){return this._plugins.slice()}release(e){const i=this.get(e);i&&(i.release(this),this._plugins=this._plugins.filter(n=>n!==i))}releaseAll(){this._plugins.forEach(e=>{e.release(this)}),this._plugins=[]}clear(e){const i=this.get(e);i&&i.clear(this)}clearAll(){this._plugins.forEach(e=>{var i;(i=e.clear)===null||i===void 0||i.call(e,this)})}}class ChartPluginService extends BasePluginService{constructor(e){super(),this.globalInstance=e}onInit(e){this._plugins.forEach(i=>{i.onInit&&i.onInit(this,e)})}onBeforeResize(e,i){this._plugins.forEach(n=>{n.onBeforeResize&&n.onBeforeResize(this,e,i)})}onAfterChartSpecTransform(e,i){this._plugins.forEach(n=>{n.onAfterChartSpecTransform&&n.onAfterChartSpecTransform(this,e,i)})}onAfterModelSpecTransform(e,i,n){this._plugins.forEach(o=>{o.onAfterModelSpecTransform&&o.onAfterModelSpecTransform(this,e,i,n)})}onBeforeInitChart(e,i){this._plugins.forEach(n=>{n.onBeforeInitChart&&n.onBeforeInitChart(this,e,i)})}releaseAll(){super.releaseAll(),this.globalInstance=null}}const svgSourceMap=new Map;function getSVGSource(r){return svgSourceMap.get(r)}var __awaiter=function(r,e,i,n){return new(i||(i=Promise))(function(o,l){function d(g){try{f(n.next(g))}catch(_){l(_)}}function u(g){try{f(n.throw(g))}catch(_){l(_)}}function f(g){var _;g.done?o(g.value):(_=g.value,_ instanceof i?_:new i(function(y){y(_)})).then(d,u)}f((n=n.apply(r,e||[])).next())})},__rest$f=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};class VChart{static useRegisters(e){e.forEach(i=>{typeof i=="function"?i():console.error("Invalid function:",i)})}static useChart(e){e.forEach(i=>Factory$1.registerChart(i.type,i))}static useSeries(e){e.forEach(i=>Factory$1.registerSeries(i.type,i))}static useComponent(e){e.forEach(i=>Factory$1.registerComponent(i.type,i))}static useMark(e){e.forEach(i=>{var n;return Factory$1.registerMark((n=i.constructorType)!==null&&n!==void 0?n:i.type,i)})}static useLayout(e){e.forEach(i=>Factory$1.registerLayout(i.type,i))}static registerDataSetTransform(e,i){Factory$1.registerTransform(e,i)}static registerFunction(e,i){e&&i&&ExpressionFunction.instance().registerFunction(e,i)}static unregisterFunction(e){e&&ExpressionFunction.instance().unregisterFunction(e)}static getFunction(e){return e?ExpressionFunction.instance().getFunction(e):null}static getFunctionList(){return ExpressionFunction.instance().getFunctionNameList()}static registerMap(e,i,n){const o=Factory$1.getImplementInKey("registerMap");o&&o(e,i,n)}static unregisterMap(e){const i=Factory$1.getImplementInKey("unregisterMap");i&&i(e)}static getMap(e){return getMapSource(e)}static registerSVG(e,i,n){const o=Factory$1.getImplementInKey("registerSVG");o&&o(e,i,n)}static unregisterSVG(e){const i=Factory$1.getImplementInKey("unregisterSVG");i&&i(e)}static getSVG(e){return getSVGSource(e)}static hideTooltip(e=[]){InstanceManager.forEach(i=>{var n;return(n=i==null?void 0:i.hideTooltip)===null||n===void 0?void 0:n.call(i)},e)}static getLogger(){return Logger.getInstance()}getSpec(){return this._spec}getSpecInfo(){return this._specInfo}getDataSet(){return this._dataSet}constructor(e,i){var n,o,l,d,u,f,g,_;this.id=createID(),this._userEvents=[],this._autoSize=!0,this._option={mode:RenderModeEnum["desktop-browser"],onError:R=>{throw new Error(R)},optimize:{disableCheckGraphicWidthOutRange:!0}},this._observer=null,this._context={},this._doResize=()=>{const{width:R,height:L}=this.getCurrentSize();this._currentSize.width===R&&this._currentSize.height===L||(this._currentSize={width:R,height:L},this.resizeSync(R,L))},this._renderSync=(R={})=>{var L;const w=this;return this._beforeRender(R)&&((L=this._compiler)===null||L===void 0||L.render(R.morphConfig),this._afterRender()),w},this._updateSpec=(R,L=!1,w)=>{var B,I;const D=this._spec,O={changeBackground:!1,reTransformSpec:!1,change:!1,reMake:!1,reCompile:!1,reSize:!1,changeTheme:!1};if(!this._setNewSpec(R,L))return;isEqual(D.theme,this._spec.theme)?isEqual(this._spec.background,D.background)||(O.reMake=!0,O.changeBackground=!0):O.changeTheme=!0;const N=this._shouldChartResize(D);if(O.reSize=N,this._spec.type!==D.type)return(I=(B=this._compiler)===null||B===void 0?void 0:B.getVGrammarView())===null||I===void 0||I.updateLayoutTag(),O.reMake=!0,O.reTransformSpec=!0,O.change=!0,O.changeTheme=!0,O;this._initChartSpec(this._spec,"updateSpec");const V=mergeUpdateResult(this._chart.updateSpec(this._spec),O);return w?Object.assign(Object.assign({},V),w):V},this._option=merge$1(this._option,{animation:e.animation!==!1},i),this._onError=(n=this._option)===null||n===void 0?void 0:n.onError;const y=this._option,{dom:b,renderCanvas:S,mode:v,stage:A,poptip:x}=y,T=__rest$f(y,["dom","renderCanvas","mode","stage","poptip"]),C=isTrueBrowser(v);if(C?registerBrowserEnv():v==="node"&&registerNodeEnv(),C&&b&&(this._container=isString(b)?vglobal.getElementById(b):b),S&&(this._canvas=S),A&&(this._stage=A),v!=="node"&&!this._container&&!this._canvas&&!this._stage)return void((o=this._option)===null||o===void 0||o.onError("please specify container or renderCanvas!"));this._viewBox=this._option.viewBox,this._currentThemeName=ThemeManager$1.getCurrentThemeName(),this._setNewSpec(e),this._updateCurrentTheme(),this._currentSize=this.getCurrentSize();const E=[];!x&&E.push("poptipForText"),e.type==="sankey"&&E.push("scrollbar");const P=Object.assign({},T.performanceHook||{});Object.keys(P).forEach(R=>{T.performanceHook[R]=(...L)=>{P[R](...L,this)}}),this._compiler=new Compiler({dom:(l=this._container)!==null&&l!==void 0?l:"none",canvas:S},Object.assign(Object.assign({mode:this._option.mode,stage:A,pluginList:E},T),{background:this._getBackground(),onError:this._onError})),this._compiler.setSize(this._currentSize.width,this._currentSize.height),this._eventDispatcher=new EventDispatcher(this,this._compiler),this._event=new Event$1(this._eventDispatcher,v),this._compiler.initView(),this._setFontFamilyTheme((d=this._currentTheme)===null||d===void 0?void 0:d.fontFamily),this._initDataSet(this._option.dataSet),this._autoSize=!!C&&((f=(u=e.autoFit)!==null&&u!==void 0?u:this._option.autoFit)===null||f===void 0||f),this._bindResizeEvent(),this._bindVGrammarViewEvent(),this._initChartPlugin(),InstanceManager.registerInstance(this),(_=(g=this._option.performanceHook)===null||g===void 0?void 0:g.afterCreateVChart)===null||_===void 0||_.call(g,this)}_setNewSpec(e,i){return!!e&&(isString(e)&&(e=JSON.parse(e)),i&&this._originalSpec&&(e=mergeSpec({},this._originalSpec,e)),this._originalSpec=e,this._spec=this._getSpecFromOriginalSpec(),!0)}_getSpecFromOriginalSpec(){var e;const i=specTransform(this._originalSpec);return i.data=(e=i.data)!==null&&e!==void 0?e:[],i}_initChartSpec(e,i){var n,o;VChart.getFunctionList()&&VChart.getFunctionList().length&&(e=functionTransform(e,VChart)),this._spec=e,this._chartSpecTransformer||(this._chartSpecTransformer=Factory$1.createChartSpecTransformer(this._spec.type,this._getChartOption(this._spec.type))),(n=this._chartSpecTransformer)===null||n===void 0||n.transformSpec(this._spec),this._chartPluginApply("onAfterChartSpecTransform",this._spec,i),this._specInfo=(o=this._chartSpecTransformer)===null||o===void 0?void 0:o.transformModelSpec(this._spec),this._chartPluginApply("onAfterModelSpecTransform",this._spec,this._specInfo,i)}_updateSpecInfo(){var e;this._chartSpecTransformer||(this._chartSpecTransformer=Factory$1.createChartSpecTransformer(this._spec.type,this._getChartOption(this._spec.type))),this._specInfo=(e=this._chartSpecTransformer)===null||e===void 0?void 0:e.createSpecInfo(this._spec)}_initChart(e){var i,n,o;if(!this._compiler)return void((i=this._option)===null||i===void 0||i.onError("compiler is not initialized"));if(this._chart)return void((n=this._option)===null||n===void 0||n.onError("chart is already initialized"));const l=Factory$1.createChart(e.type,e,this._getChartOption(e.type));l?(this._chart=l,this._chart.setCanvasRect(this._currentSize.width,this._currentSize.height),this._chart.created(this._chartSpecTransformer),this._chart.init(),this._event.emit(ChartEvent.initialized,{chart:l,vchart:this})):(o=this._option)===null||o===void 0||o.onError("init chart fail")}_releaseData(){this._dataSet&&(this._dataSet.dataViewMap={},this._dataSet=null)}_bindVGrammarViewEvent(){if(!this._compiler)return;const e=this._compiler.getVGrammarView();e.addEventListener(HOOK_EVENT.ALL_ANIMATION_END,()=>{this._event.emit(ChartEvent.animationFinished,{chart:this._chart,vchart:this})}),e.addEventListener(HOOK_EVENT.AFTER_VRENDER_NEXT_RENDER,()=>{this._event.emit(ChartEvent.renderFinished,{chart:this._chart,vchart:this})})}_bindResizeEvent(){var e,i;if(this._autoSize){if(this._onResize=throttle(this._doResize,(e=this._option.resizeDelay)!==null&&e!==void 0?e:100),this._container){const n=window.ResizeObserver;n&&(this._observer=new n(this._onResize),(i=this._observer)===null||i===void 0||i.observe(this._container))}window.addEventListener("resize",this._onResize)}}_unBindResizeEvent(){this._autoSize&&(window.removeEventListener("resize",this._onResize),this._observer&&(this._observer.disconnect(),this._observer=null))}getCurrentSize(){var e,i,n,o;return calculateChartSize(this._spec,{container:this._container,canvas:this._canvas,mode:this._getMode(),modeParams:this._option.modeParams},{width:(i=(e=this._currentSize)===null||e===void 0?void 0:e.width)!==null&&i!==void 0?i:DEFAULT_CHART_WIDTH,height:(o=(n=this._currentSize)===null||n===void 0?void 0:n.height)!==null&&o!==void 0?o:DEFAULT_CHART_HEIGHT})}_initDataSet(e){this._dataSet=e instanceof DataSet?e:new DataSet,registerDataSetInstanceParser(this._dataSet,"dataview",dataViewParser),registerDataSetInstanceParser(this._dataSet,"array",arrayParser),registerDataSetInstanceTransform(this._dataSet,"copyDataView",copyDataView);for(const i in Factory$1.transforms)registerDataSetInstanceTransform(this._dataSet,i,Factory$1.transforms[i]);for(const i in Factory$1.dataParser)registerDataSetInstanceParser(this._dataSet,i,Factory$1.dataParser[i])}updateCustomConfigAndRerender(e,i,n={}){if(!this._isReleased&&e)return isFunction(e)&&(e=e()),e.reAnimate&&(this.stopAnimation(),this._updateAnimateState(!0)),this._reCompile(e),i?this._renderSync(n):this._renderAsync(n)}_updateCustomConfigAndRecompile(e,i={}){return!!e&&(this._reCompile(e),this._beforeRender(i))}_reCompile(e,i){var n,o,l,d,u,f,g,_,y,b;if(e.reMake&&(this._releaseData(),this._initDataSet(),(n=this._chart)===null||n===void 0||n.release(),this._chart=null),e.reTransformSpec&&(this._chartSpecTransformer=null),e.changeTheme?(this._setCurrentTheme(),this._setFontFamilyTheme((o=this._currentTheme)===null||o===void 0?void 0:o.fontFamily)):e.changeBackground&&((l=this._compiler)===null||l===void 0||l.setBackground(this._getBackground())),e.reMake)(d=this._compiler)===null||d===void 0||d.releaseGrammar(((u=this._option)===null||u===void 0?void 0:u.animation)===!1||((f=this._spec)===null||f===void 0?void 0:f.animation)===!1),this._userEvents.forEach(S=>{var v;return(v=this._event)===null||v===void 0?void 0:v.on(S.eType,S.query,S.handler)}),e.reSize&&this._doResize();else if(e.reCompile&&((g=this._compiler)===null||g===void 0||g.clear({chart:this._chart,vChart:this},((_=this._option)===null||_===void 0?void 0:_.animation)===!1||((y=this._spec)===null||y===void 0?void 0:y.animation)===!1),(b=this._compiler)===null||b===void 0||b.compile({chart:this._chart,vChart:this},{})),e.reSize){const{width:S,height:v}=this.getCurrentSize();this._chart.onResize(S,v,!1),this._compiler.resize(S,v,!1)}}_beforeRender(e={}){var i,n,o,l,d,u,f,g;if(this._isReleased)return!1;if(this._chart)return!0;const{transformSpec:_,actionSource:y}=e;return _&&this._initChartSpec(this._spec,"render"),this._chartPluginApply("onBeforeInitChart",this._spec,y),(n=(i=this._option.performanceHook)===null||i===void 0?void 0:i.beforeInitializeChart)===null||n===void 0||n.call(i,this),this._initChart(this._spec),(l=(o=this._option.performanceHook)===null||o===void 0?void 0:o.afterInitializeChart)===null||l===void 0||l.call(o,this),!(!this._chart||!this._compiler)&&((u=(d=this._option.performanceHook)===null||d===void 0?void 0:d.beforeCompileToVGrammar)===null||u===void 0||u.call(d),this._compiler.compile({chart:this._chart,vChart:this},{performanceHook:this._option.performanceHook}),(g=(f=this._option.performanceHook)===null||f===void 0?void 0:f.afterCompileToVGrammar)===null||g===void 0||g.call(f),!0)}_afterRender(){return!this._isReleased&&(this._updateAnimateState(),this._event.emit(ChartEvent.rendered,{chart:this._chart,vchart:this}),!0)}renderSync(e){return this._renderSync({morphConfig:e,transformSpec:!0,actionSource:"render"})}renderAsync(e){return __awaiter(this,void 0,void 0,function*(){return this._renderAsync({morphConfig:e,transformSpec:!0,actionSource:"render"})})}_renderAsync(e={}){return __awaiter(this,void 0,void 0,function*(){return this._renderSync(e)})}_updateAnimateState(e){var i,n;if(this._option.animation){const o=e?AnimationStateEnum.appear:AnimationStateEnum.update;(i=this._chart)===null||i===void 0||i.getAllRegions().forEach(l=>{var d;(d=l.animate)===null||d===void 0||d.updateAnimateState(o,!0)}),(n=this._chart)===null||n===void 0||n.getAllComponents().forEach(l=>{var d;(d=l.animate)===null||d===void 0||d.updateAnimateState(o,!0)})}}release(){var e,i,n,o;!((e=this._onResize)===null||e===void 0)&&e.cancel&&this._onResize.cancel(),this._chartPluginApply("releaseAll"),this._chartPlugin=null,this._chartSpecTransformer=null,(i=this._chart)===null||i===void 0||i.release(),(n=this._eventDispatcher)===null||n===void 0||n.release(),(o=this._compiler)===null||o===void 0||o.release(),this._unBindResizeEvent(),this._releaseData(),this._onError=null,this._onResize=null,this._container=null,this._currentTheme=null,this._option=null,this._chart=null,this._compiler=null,this._spec=null,this._specInfo=null,this._originalSpec=null,this._userEvents=null,this._event=null,this._eventDispatcher=null,this._isReleased=!0,InstanceManager.unregisterInstance(this)}updateData(e,i,n,o){return __awaiter(this,void 0,void 0,function*(){return this.updateDataSync(e,i,n,o)})}_updateDataById(e,i,n){const o=this._spec.data.find(l=>l.name===e||l.id===e);o?o.id===e?o.values=i:o.name===e&&o.parse(i,n):isArray(i)?this._spec.data.push({id:e,values:i}):this._spec.data.push(i)}updateDataInBatches(e){return __awaiter(this,void 0,void 0,function*(){return this._chart?(this._chart.updateFullData(e.map(({id:i,data:n,options:o})=>({id:i,values:n,parser:o}))),this._chart.updateGlobalScaleDomain(),this._compiler.render(),this):(this._spec.data=array(this._spec.data),e.forEach(({id:i,data:n,options:o})=>{this._updateDataById(i,n,o)}),this)})}updateDataSync(e,i,n,o){return isNil(this._dataSet)?this:this._chart?(o!=null&&o.reAnimate&&(this.stopAnimation(),this._updateAnimateState(!0)),this._chart.updateData(e,i,!0,n),this._compiler.render(),this):(this._spec.data=array(this._spec.data),this._updateDataById(e,i,n),this)}updateFullDataSync(e,i=!0,n){if(this._chart)return n!=null&&n.reAnimate&&(this.stopAnimation(),this._updateAnimateState(!0)),this._chart.updateFullData(e),i&&this._compiler.render(),this;const o=array(this._spec.data);return array(e).forEach(l=>{const{id:d,values:u,parser:f,fields:g}=l,_=o.find(y=>y.name===d);if(_)_ instanceof DataView?(_.setFields(cloneDeep(g)),_.parse(u,cloneDeep(f))):(_.values=u,isValid(f)&&(_.parser=f),isValid(g)&&(_.fields=g));else{const y=dataToDataView(l,this._dataSet,o);isArray(this._spec.data)&&this._spec.data.push(y)}}),this}updateFullData(e,i=!0){return __awaiter(this,void 0,void 0,function*(){return this.updateFullDataSync(e,i)})}updateSpec(e,i=!1,n,o){return __awaiter(this,void 0,void 0,function*(){const l=this._updateSpec(e,i,o);return l?(yield this.updateCustomConfigAndRerender(l,!1,{morphConfig:n,transformSpec:l.reTransformSpec,actionSource:"updateSpec"}),this):this})}updateSpecSync(e,i=!1,n,o){const l=this._updateSpec(e,i,o);return l?(this.updateCustomConfigAndRerender(l,!0,{morphConfig:n,transformSpec:l.reTransformSpec,actionSource:"updateSpec"}),this):this}updateSpecAndRecompile(e,i=!1,n={}){const o=this._updateSpec(e,i);return this._updateCustomConfigAndRecompile(o,Object.assign({actionSource:"updateSpecAndRecompile"},n))}updateModelSpec(e,i,n=!1,o){return __awaiter(this,void 0,void 0,function*(){return this.updateModelSpecSync(e,i,n,o)})}updateModelSpecSync(e,i,n=!1,o){if(!i||!this._spec)return this;if(isString(i)&&(i=JSON.parse(i)),isFunction(e)||mergeSpecWithFilter(this._spec,e,i,n),this._chart){const l=this._chart.getModelInFilter(e);if(l)return this._updateModelSpec(l,i,!0,n,o)}return this}_updateModelSpec(e,i,n=!1,o=!1,l){o&&(i=mergeSpec({},e.getSpec(),i));const d=e.updateSpec(i);return e.reInit(i),(d.change||d.reCompile||d.reMake||d.reSize||d.reRender)&&this._chart.reDataFlow(),this.updateCustomConfigAndRerender(d,n,{morphConfig:l,transformSpec:!1,actionSource:"updateModelSpec"})}resize(e,i){return __awaiter(this,void 0,void 0,function*(){return this.resizeSync(e,i)})}resizeSync(e,i){var n,o;return this._beforeResize(e,i)?((o=(n=this._compiler).resize)===null||o===void 0||o.call(n,e,i),this._afterResize()):this}_beforeResize(e,i){var n,o,l,d;if(!this._chart||!this._compiler)return!1;const u=this._chart.getCanvasRect();return(!u||u.width!==e||u.height!==i)&&(this._chartPluginApply("onBeforeResize",e,i),(o=(n=this._option.performanceHook)===null||n===void 0?void 0:n.beforeResizeWithUpdate)===null||o===void 0||o.call(n),this._chart.onResize(e,i,!1),(d=(l=this._option.performanceHook)===null||l===void 0?void 0:l.afterResizeWithUpdate)===null||d===void 0||d.call(l),!0)}_afterResize(){return this._isReleased||this._event.emit(ChartEvent.afterResize,{chart:this._chart}),this}updateViewBox(e,i=!0,n=!0){return this._chart&&this._compiler?(this._viewBox=e,this._chart.updateViewBox(e,n),n&&(this._compiler.render(),this._chart.onEvaluateEnd()),this._compiler.updateViewBox(e,i),this):this}on(e,i,n){var o;this._userEvents&&(this._userEvents.push({eType:e,query:typeof i=="function"?null:i,handler:typeof i=="function"?i:n}),(o=this._event)===null||o===void 0||o.on(e,i,n))}off(e,i){var n;if(this._userEvents&&this._userEvents.length!==0)if(i){const o=this._userEvents.findIndex(l=>l.eType===e&&l.handler===i);o>=0&&(this._userEvents.splice(o,1),(n=this._event)===null||n===void 0||n.off(e,i))}else this._userEvents.forEach(o=>{var l;o.eType===e&&((l=this._event)===null||l===void 0||l.off(e,o.handler))}),this._userEvents=this._userEvents.filter(o=>o.eType!==e)}updateState(e,i){this._chart&&this._chart.updateState(e,i)}setSelected(e,i,n){this._chart&&this._chart.setSelected(e,i,n)}setHovered(e,i,n){this._chart&&this._chart.setHovered(e,i,n)}clearState(e){this._chart&&this._chart.clearState(e)}clearAllStates(){this._chart&&this._chart.clearAllStates()}clearSelected(){this._chart&&this._chart.clearSelected()}clearHovered(){this._chart&&this._chart.clearHovered()}_updateCurrentTheme(e){var i,n,o;const l=this._option.theme,d=(i=this._spec)===null||i===void 0?void 0:i.theme,u=(n=this._spec)===null||n===void 0?void 0:n.type;e&&(this._currentThemeName=e);const f=(_,y)=>{var b;return!((b=y.chart)===null||b===void 0)&&b[_]&&(y=mergeTheme({},y,y.chart[_])),y};let g;if(isEmpty(l)&&isEmpty(d))g=getThemeObject(this._currentThemeName,!0),this._currentTheme=f(u,g);else if(isString(l)&&(!d||isString(d))||isString(d)&&(!l||isString(l))){const _=mergeTheme({},getThemeObject(this._currentThemeName,!0),getThemeObject(l,!0),getThemeObject(d,!0));this._currentTheme=f(u,_)}else{const _=mergeTheme({},getThemeObject(this._currentThemeName),getThemeObject(l),getThemeObject(d));this._currentTheme=preprocessTheme(f(u,_))}setPoptipTheme(get(this._currentTheme,"component.poptip")),(o=this._compiler)===null||o===void 0||o.setBackground(this._getBackground())}_shouldChartResize(e){var i,n;let o=!1;isNil(this._spec.width)?!isNil(e.width)&&(this._spec.width=e.width):this._spec.width!==e.width&&(o=!0),isNil(this._spec.height)?!isNil(e.height)&&(this._spec.height=e.height):this._spec.height!==e.height&&(o=!0);const l=this._autoSize;return this._autoSize=!!isTrueBrowser(this._option.mode)&&((n=(i=this._spec.autoFit)!==null&&i!==void 0?i:this._option.autoFit)===null||n===void 0||n),this._autoSize!==l&&(o=!0),o}_getBackground(){return(typeof this._spec.background=="string"||isObject$1(this._spec.background)&&this._spec.background.gradient?this._spec.background:null)||this._currentTheme.background||this._option.background}getCurrentTheme(){return getThemeObject(this._currentThemeName)}getCurrentThemeName(){return this._currentThemeName}setCurrentTheme(e){return __awaiter(this,void 0,void 0,function*(){return this.setCurrentThemeSync(e)})}setCurrentThemeSync(e){var i;if(!ThemeManager$1.themeExist(e))return this;const n=this._setCurrentTheme(e);return this._setFontFamilyTheme((i=this._currentTheme)===null||i===void 0?void 0:i.fontFamily),this.updateCustomConfigAndRerender(n,!0,{transformSpec:!1,actionSource:"setCurrentTheme"}),this}_setCurrentTheme(e){var i;return this._updateCurrentTheme(e),this._initChartSpec(this._getSpecFromOriginalSpec(),"setCurrentTheme"),(i=this._chart)===null||i===void 0||i.setCurrentTheme(),{change:!0,reMake:!1}}_setFontFamilyTheme(e){var i;e&&((i=this.getStage())===null||i===void 0||i.setTheme({text:{fontFamily:e}}))}_getTooltipComponent(){var e;return(e=this._chart)===null||e===void 0?void 0:e.getComponentsByType(ComponentTypeEnum.tooltip)[0]}setTooltipHandler(e){var i,n;this._context.tooltipHandler=e;const o=this._getTooltipComponent();o&&((n=(i=o.tooltipHandler)===null||i===void 0?void 0:i.release)===null||n===void 0||n.call(i),o.tooltipHandler=e)}getTooltipHandlerByUser(){var e;return(e=this._context)===null||e===void 0?void 0:e.tooltipHandler}getTooltipHandler(){const e=this._getTooltipComponent();return e?e.tooltipHandler:this._context.tooltipHandler}showTooltip(e,i){var n;const o=this._getTooltipComponent();return(n=isValid(e)&&(o==null?void 0:o.showTooltip(e,i))!=="none")!==null&&n!==void 0&&n}hideTooltip(){var e;const i=this._getTooltipComponent();return(e=i==null?void 0:i.hideTooltip())!==null&&e!==void 0&&e}getLegendDataById(e){var i;const n=(i=this._chart)===null||i===void 0?void 0:i.getComponentByUserId(e);return n?n.getLegendData():[]}getLegendDataByIndex(e=0){var i;const n=(i=this._chart)===null||i===void 0?void 0:i.getComponentsByType(ComponentTypeEnum.discreteLegend);return n&&n[e]?n[e].getLegendData():[]}getLegendSelectedDataById(e){var i;const n=(i=this._chart)===null||i===void 0?void 0:i.getComponentByUserId(e);return n?n.getSelectedData():[]}getLegendSelectedDataByIndex(e=0){var i;const n=(i=this._chart)===null||i===void 0?void 0:i.getComponentsByType(ComponentTypeEnum.discreteLegend);return n&&n[e]?n[e].getSelectedData():[]}setLegendSelectedDataById(e,i){var n;const o=(n=this._chart)===null||n===void 0?void 0:n.getComponentByUserId(e);o&&o.setSelectedData(i)}setLegendSelectedDataByIndex(e=0,i){var n;const o=(n=this._chart)===null||n===void 0?void 0:n.getComponentsByType(ComponentTypeEnum.discreteLegend);o&&o[e]&&o[e].setSelectedData(i)}getDataURL(){var e;return __awaiter(this,void 0,void 0,function*(){const i=this.getStage();if(this._chart&&i){i.render();const n=this._chart.getCanvas();return yield getCanvasDataURL(n,{onError:this._onError})}return(e=this._option)===null||e===void 0||e.onError(new ReferenceError("render is not defined")),null})}exportImg(e){var i,n;return __awaiter(this,void 0,void 0,function*(){if(!isTrueBrowser(this._option.mode))return void((i=this._option)===null||i===void 0||i.onError(new TypeError("non-browser environment can not export img")));const o=yield this.getDataURL();o?URLToImage(e,o):(n=this._option)===null||n===void 0||n.onError(new ReferenceError("render is not defined"))})}exportCanvas(){var e;const i=this.getStage();if(this._chart&&i)return i.toCanvas();(e=this._option)===null||e===void 0||e.onError(new ReferenceError("render is not defined"))}getImageBuffer(){var e,i;if(this._option.mode!=="node")return void((e=this._option)===null||e===void 0||e.onError(new TypeError("getImageBuffer() now only support node environment.")));const n=this.getStage();return n?(n.render(),n.window.getImageBuffer()):((i=this._option)===null||i===void 0||i.onError(new ReferenceError("render is not defined")),null)}setLayout(e){var i;this._option.layout=e,(i=this._chart)===null||i===void 0||i.setLayout(e)}reLayout(){var e;(e=this._chart)===null||e===void 0||e.setLayoutTag(!0)}getCompiler(){return this._compiler}getChart(){return this._chart}getStage(){return this._compiler.getStage()}getCanvas(){var e;return(e=this._compiler)===null||e===void 0?void 0:e.getCanvas()}getContainer(){var e;if(isValid(this._container))return this._container;let i;return i=isString(this._canvas)?vglobal.getElementById(this._canvas):this._canvas,isValid(i)?i.parentElement:(e=this.getCanvas())===null||e===void 0?void 0:e.parentElement}getComponents(){return this._chart.getAllComponents()}getScale(e){var i;const n=(i=this._chart)===null||i===void 0?void 0:i.getGlobalScale();return n==null?void 0:n.getScale(e)}setDimensionIndex(e,i={}){var n;return(n=this._chart)===null||n===void 0?void 0:n.setDimensionIndex(e,i)}stopAnimation(){var e,i,n;(n=(i=(e=this._compiler)===null||e===void 0?void 0:e.getVGrammarView())===null||i===void 0?void 0:i.animate)===null||n===void 0||n.stop()}pauseAnimation(){var e,i,n;(n=(i=(e=this._compiler)===null||e===void 0?void 0:e.getVGrammarView())===null||i===void 0?void 0:i.animate)===null||n===void 0||n.pause()}resumeAnimation(){var e,i,n;(n=(i=(e=this._compiler)===null||e===void 0?void 0:e.getVGrammarView())===null||i===void 0?void 0:i.animate)===null||n===void 0||n.resume()}convertDatumToPosition(e,i={},n=!1,o){var l;if(!this._chart||isEmpty(e))return null;const{seriesId:d,seriesIndex:u=0}=i;let f;if(isValid(d)?f=this._chart.getSeriesInUserId(d):isValid(u)&&(f=(l=this._chart.getSeriesInIndex([u]))===null||l===void 0?void 0:l[0]),f){const g=Object.keys(e),_=f.getViewData().latestData.find(S=>g.every(v=>S[v]==e[v])),y=f.getRegion().getLayoutStartPoint();let b;return b=_?f.dataToPosition(_,o):f.dataToPosition(e,o),b?convertPoint(b,y,n):null}return null}convertValueToPosition(e,i,n=!1){var o,l;if(!this._chart||isNil(e)||isEmpty(i))return null;if(!isArray(e)){const{axisId:g,axisIndex:_}=i;let y;if(isValid(g)?y=this._chart.getComponentsByKey("axes").find(S=>S.userId===g):isValid(_)&&(y=(o=this._chart.getComponentsByKey("axes"))===null||o===void 0?void 0:o[_]),!y)return warn("Please check whether the `axisId` or `axisIndex` is set!"),null;const b=y==null?void 0:y.valueToPosition(e);if(n){const S=y.getLayoutStartPoint(),v=y.getOrient();return b+(v==="bottom"||v==="top"?S.x:S.y)}return b}const{seriesId:d,seriesIndex:u}=i;let f;return isValid(d)?f=this._chart.getSeriesInUserId(d):isValid(u)&&(f=(l=this._chart.getSeriesInIndex([u]))===null||l===void 0?void 0:l[0]),f?convertPoint(f.valueToPosition(e[0],e[1]),f.getRegion().getLayoutStartPoint(),n):(warn("Please check whether the `seriesId` or `seriesIndex` is set!"),null)}getFunction(e){return ExpressionFunction.instance().getFunction(e)}registerFunction(e,i){e&&i&&ExpressionFunction.instance().registerFunction(e,i)}unregisterFunction(e){e&&ExpressionFunction.instance().unregisterFunction(e)}getFunctionList(){return ExpressionFunction.instance().getFunctionNameList()}setRuntimeSpec(e){this._spec=e,this._updateSpecInfo()}updateIndicatorDataById(e,i){var n;const o=(n=this._chart)===null||n===void 0?void 0:n.getComponentByUserId(e);o&&o.updateDatum(i)}updateIndicatorDataByIndex(e=0,i){var n;const o=(n=this._chart)===null||n===void 0?void 0:n.getComponentsByType(ComponentTypeEnum.indicator);o&&o[e]&&o[e].updateDatum(i)}geoZoomByIndex(e=0,i,n){this._geoZoomByQuery({regionIndex:e},i,n)}geoZoomById(e,i,n){this._geoZoomByQuery({regionId:e},i,n)}_geoZoomByQuery(e,i,n){var o,l;const d=(o=this._chart)===null||o===void 0?void 0:o.getRegionsInQuerier(e)[0],u=(l=this._chart)===null||l===void 0?void 0:l.getComponentsByType(ComponentTypeEnum.geoCoordinate),f=u==null?void 0:u.find(g=>{var _;return(_=g.getRegions())===null||_===void 0?void 0:_.includes(d)});f&&f.dispatchZoom(i,n)}_initChartPlugin(){const e=Factory$1.getChartPlugins();e.length>0&&(this._chartPlugin=new ChartPluginService(this),this._chartPlugin.load(e.map(i=>new i)),this._chartPluginApply("onInit",this._spec))}_chartPluginApply(e,...i){this._chartPlugin&&this._chartPlugin[e]&&this._chartPlugin[e].apply(this._chartPlugin,i)}_getMode(){return this._option.mode||RenderModeEnum["desktop-browser"]}_getChartOption(e){return{type:e,globalInstance:this,eventDispatcher:this._eventDispatcher,dataSet:this._dataSet,container:this._container,canvas:this._canvas,map:new Map,mode:this._getMode(),modeParams:this._option.modeParams,getCompiler:()=>this._compiler,performanceHook:this._option.performanceHook,viewBox:this._viewBox,animation:this._option.animation,getTheme:()=>{var i;return(i=this._currentTheme)!==null&&i!==void 0?i:{}},getSpecInfo:()=>{var i;return(i=this._specInfo)!==null&&i!==void 0?i:{}},layout:this._option.layout,onError:this._onError,disableTriggerEvent:this._option.disableTriggerEvent===!0}}}VChart.InstanceManager=InstanceManager,VChart.ThemeManager=ThemeManager$1,VChart.globalConfig={uniqueTooltip:!0},VChart.Utils=VCHART_UTILS,VChart.vglobal=vglobal;Factory$1.registerRegion("region",Region),Factory$1.registerLayout("base",Layout$1),registerGroupMark(),View.useRegisters([registerGesturePlugin]),registerElementHighlight(),registerElementSelect(),registerTheme(darkTheme$1.name,darkTheme$1),Logger.getInstance(LoggerLevel.Error);const addVChartProperty=(r,e)=>{const i=e.beforeCall();return r&&r.forEach((n,o)=>e.call(n,o,i)),i.keyMap&&(i.keyMap.clear(),i.keyMap=null),r};function getComponentThemeFromOption(r,e){return get(e,`component.${r}`)}function getFormatFunction(r,e,i,n){if(r)return{formatFunc:r,args:[i,n]};const o=Factory$1.getFormatter();return e&&o?{formatFunc:o,args:[i,n,e]}:{}}const getSpecInfo=(r,e,i,n)=>{if(isNil(r[e]))return;const o=isArray(r[e]),l=o?r[e]:[r[e]],d=[];return l.forEach((u,f)=>{!u||n&&!n(u)||d.push({spec:u,specPath:o?[e,f]:[e],specInfoPath:["component",e,f],type:i})}),d},getTooltipContentValue=(r,e,i,n)=>{let o;if(o=isFunction(r)?r(e,i):isPlainObject(r)&&isValid(r.field)?get(e,r.field):r,n){const{formatFunc:l,args:d}=getFormatFunction(void 0,n,r,e);l&&d&&(o=l(...d))}return o},getTooltipPatternValue=(r,e,i)=>isNil(r)?r:isFunction(r)?r(e,i):r;function getFirstDatumFromTooltipData(r){var e;const i=!((e=r[0])===null||e===void 0)&&e.series?[{data:r,value:""}]:r;for(const{data:n}of i)for(const{datum:o}of n)for(const l of o??[])if(l)return l}var __rest$e=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};const getTooltipActualActiveType=r=>{var e,i,n;if((r==null?void 0:r.visible)===!1)return[];const o={mark:((e=r==null?void 0:r.mark)===null||e===void 0?void 0:e.visible)!==!1,dimension:((i=r==null?void 0:r.dimension)===null||i===void 0?void 0:i.visible)!==!1,group:((n=r==null?void 0:r.group)===null||n===void 0?void 0:n.visible)!==!1};return isValid(r==null?void 0:r.activeType)&&Object.keys(o).forEach(l=>{var d;o[l]=(d=r==null?void 0:r.activeType)===null||d===void 0?void 0:d.includes(l)}),Object.keys(o).filter(l=>o[l])},isActiveTypeVisible=(r,e)=>!e||e.visible!==!1&&(!e[r]||e[r].visible!==!1)&&!(e.activeType&&!(isArray(e.activeType)?e.activeType.includes(r):e.activeType===r));function isEmptyPos(r){return isNil(r.mark)&&isNil(r.model)&&isNil(r.datum)}function addContentLine(r,e,i,n,o,l){const d=u=>{if(u){const f={datum:o},g=isNil(u.key)&&isNil(u.value)&&!isEmpty(u)?Object.assign(Object.assign(Object.assign({},n),i),u):Object.assign(Object.assign({},n),u),{key:_,keyFormatter:y,keyTimeFormat:b,keyTimeFormatMode:S,value:v,valueFormatter:A,valueTimeFormat:x,valueTimeFormatMode:T}=g,C=__rest$e(g,["key","keyFormatter","keyTimeFormat","keyTimeFormatMode","value","valueFormatter","valueTimeFormat","valueTimeFormatMode"]);f.key=getTimeString(getTooltipContentValue(_,o,l,y),b,S),f.value=getTimeString(getTooltipContentValue(v,o,l,A),x,T),Object.keys(C).forEach(E=>{f[E]=getTooltipContentValue(g[E],o,l)}),f.visible!==!1&&(isValid(f.key)||isValid(f.value))&&r.push(f)}};isArray(e)?e.forEach(u=>{d(u)}):d(e)}function parseContentFunction(r,e,i,n,o,l,d){isFunction(e)?addContentLine(r,e(o,d),i,n,l,d):e&&addContentLine(r,e,i,n,l,d)}function parseContent(r,e,i,n,o,l){if(o&&o.length){const d=[];return o.forEach(u=>{isArray(r)?r.forEach(f=>{parseContentFunction(d,f,e,i,n,u,l)}):isFunction(r)?parseContentFunction(d,r,e,i,n,u,l):r&&addContentLine(d,r,e,i,u,l)}),d}return null}function combineContents(r){if(!r||!r.length)return null;const e=[];return r.forEach(({content:i})=>{i&&i.forEach(n=>{e.push(n)})}),e.length?Object.assign(Object.assign({},r[0]),{content:e}):r[0]}const getTimeString=(r,e,i)=>{if(!e&&!i)return typeof r!="object"?r==null?void 0:r.toString():r;const n=TimeUtil.getInstance();return e=e||"%Y%m%d",((i=i||"local")==="local"?n.timeFormat:n.timeUTCFormat)(e,r)};class BaseSeriesTooltipHelper{constructor(e){this.activeTriggerSet={mark:new Set,group:new Set},this.ignoreTriggerSet={mark:new Set},this._getSeriesCacheInfo=()=>{var i,n,o;const{series:l}=this,d=l.getSeriesField();return{seriesFields:isValid(d)?array(d):(i=l.getSeriesKeys())!==null&&i!==void 0?i:[],dimensionFields:(n=l.getDimensionField())!==null&&n!==void 0?n:[],measureFields:(o=l.getMeasureField())!==null&&o!==void 0?o:[],type:l.type}},this._getDimensionData=i=>{const{dimensionFields:n}=this._seriesCacheInfo;return n[0]&&(i==null?void 0:i[n[0]])},this._getMeasureData=i=>{const{measureFields:n}=this._seriesCacheInfo;return n[0]&&(i==null?void 0:i[n[0]])},this._getSeriesFieldData=i=>{const{dimensionFields:n,seriesFields:o}=this._seriesCacheInfo;if(isValid(o[0])&&(i!=null&&i[o[0]]))return i==null?void 0:i[o[0]];const l=n[n.length-1];return n.length>1&&(o.length===0||this.series.getSeriesKeys().length),i==null?void 0:i[l]},this._getSeriesStyle=(i,n,o)=>{var l;for(const d of array(n)){const u=(l=this.series.getSeriesStyle(i))===null||l===void 0?void 0:l(d);if(isValid(u))return u}return o},this.markTooltipKeyCallback=(i,n)=>this._getSeriesFieldData(i),this.markTooltipValueCallback=(i,n)=>this._getMeasureData(i),this.shapeTypeCallback=(i,n)=>{var o;return(o=this._getSeriesStyle(i,"shape",null))!==null&&o!==void 0?o:this._getSeriesStyle(i,"symbolType",this.series.getDefaultShapeType())},this.shapeColorCallback=(i,n)=>this._getSeriesStyle(i,["fill","stroke"]),this.shapeStrokeCallback=(i,n)=>this._getSeriesStyle(i,["stroke","fill"]),this.dimensionTooltipTitleCallback=(i,n)=>this._getDimensionData(i),this.groupTooltipTitleCallback=(i,n)=>this._getSeriesFieldData(i),this.groupTooltipKeyCallback=(i,n)=>{const{seriesFields:o}=this._seriesCacheInfo;let l=this._seriesCacheInfo.dimensionFields;return o[0]&&(l=l.filter(d=>d!==o[0])),l.map(d=>i==null?void 0:i[d]).join("-")},this.getHasShape=i=>!!i,this.series=e,this.updateTooltipSpec()}updateTooltipSpec(){var e;const i=(e=this.series.getSpec())===null||e===void 0?void 0:e.tooltip;this.spec=i,this._seriesCacheInfo=this._getSeriesCacheInfo()}getShapeAttrs(e,i,n){var o,l,d,u,f,g,_,y,b,S,v,A;const x=i?"content":"title",T=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(o=n==null?void 0:n.style)===null||o===void 0?void 0:o.shape),n==null?void 0:n[e]),(l=n==null?void 0:n[e])===null||l===void 0?void 0:l[x]),(d=this.spec)===null||d===void 0?void 0:d[e]),(f=(u=this.spec)===null||u===void 0?void 0:u[e])===null||f===void 0?void 0:f[x]);return{shapeType:(g=T.shapeType)!==null&&g!==void 0?g:this.shapeTypeCallback,shapeFill:(y=(_=T.shapeFill)!==null&&_!==void 0?_:T.shapeColor)!==null&&y!==void 0?y:this.shapeColorCallback,shapeStroke:(b=T.shapeStroke)!==null&&b!==void 0?b:this.shapeStrokeCallback,shapeHollow:(S=T.shapeHollow)!==null&&S!==void 0&&S,shapeLineWidth:T.shapeLineWidth,shapeSize:(v=T.shapeSize)!==null&&v!==void 0?v:T.size,hasShape:(A=T.hasShape)!==null&&A!==void 0?A:this.getHasShape(i)}}enableByType(e){return!0}getDefaultContentList(e){return[this.getDefaultContentPattern(e)]}getContentList(e,i,n,o,l,d){var u;return parseContent((u=i==null?void 0:i.content)!==null&&u!==void 0?u:this.getDefaultContentList(e),this.getDefaultContentPattern(e),n,o,l,d)}getTitleResult(e,i,n,o,l){let d=isFunction(i)?i(o,l):i;if(d?isNil(d.value)&&(d=Object.assign(Object.assign({},this.getDefaultTitlePattern(e)),d)):d=this.getDefaultTitlePattern(e),d&&d.visible!==!1){const u=getFirstDatumFromTooltipData(o),f={visible:getTooltipContentValue(d.visible,u,l),value:getTimeString(getTooltipContentValue(d.value,u,l,d.valueFormatter),d.valueTimeFormat,d.valueTimeFormatMode),valueStyle:getTooltipContentValue(d.valueStyle,u,l),hasShape:d.hasShape};return Object.keys(n).forEach(g=>{f[g]=getTooltipContentValue(n[g],u,l)}),f}return{hasShape:!1,visible:!1}}getTooltipData(e,i,n,o,l){var d,u;if(!(this.enableByType(e)&&isActiveTypeVisible(e,this.spec)&&(e!=="dimension"||o&&o.length)))return null;const f=(u=(d=this.spec)===null||d===void 0?void 0:d[e])!==null&&u!==void 0?u:i==null?void 0:i[e],g=this.getShapeAttrs(e,!0,i),_=this.getShapeAttrs(e,!1,i);let y;return e==="dimension"?(y=[],this.getContentList(e,f,g,n,o,l).forEach(b=>{y.push(b)})):y=this.getContentList(e,f,g,n,o,l),{visible:!0,activeType:e,data:n,title:this.getTitleResult(e,f==null?void 0:f.title,_,n,l),content:y}}getDefaultTitlePattern(e){return{key:void 0,value:e==="group"?this.groupTooltipTitleCallback:this.dimensionTooltipTitleCallback}}getDefaultContentPattern(e){return{seriesId:this.series.id,key:e==="group"?this.groupTooltipKeyCallback:this.markTooltipKeyCallback,value:this.markTooltipValueCallback}}}const methods={min:r=>r.length?minInArray(r.map(e=>1*e)):0,max:r=>r.length?maxInArray(r.map(e=>1*e)):0,"array-min":r=>r.length?minInArray(r.map(e=>1*e)):0,"array-max":r=>r.length?maxInArray(r.map(e=>1*e)):0,values:r=>{const e={},i=[];for(const n of r)e[n]||(i.push(n),e[n]=1);return i}},dimensionStatistics=(r,e)=>{var i,n;let o=e.fields;if(isFunction(o)&&(o=o()),!(o!=null&&o.length)||!(r!=null&&r.length))return{};o=mergeFields([],o);const l=e.target==="parser"?"parserData":"latestData",d=r[0][l]?r[0][l]:r||[],u=(n=(i=r[0]).getFields)===null||n===void 0?void 0:n.call(i);return dimensionStatisticsOfSimpleData(d,o,u)},dimensionStatisticsOfSimpleData=(r,e,i)=>{const n={};let o=[],l=[];return e.forEach(d=>{const u=d.key;n[u]={};const f=i==null?void 0:i[u],g=d.operations,_=g.some(S=>S==="min"||S==="max"||S==="allValid");let y=!0;o.length=0,r&&r.forEach(S=>{S&&o.push(S[u])});const b=o.length;if(_){l.length=0,o.forEach((v,A)=>{couldBeValidNumber(v)&&l.push(v)});const S=o;o=l,l=S,y=o.length===b}else o=g.some(S=>S==="array-min"||S==="array-max")?o.reduce((S,v)=>(v&&v.forEach(A=>{couldBeValidNumber(A)&&S.push(A)}),S),[]):o.filter(S=>S!==void 0);d.filter&&(o=o.filter(d.filter)),g.forEach(S=>{if(d.customize)n[u][S]=d.customize;else{if(f&&f.lockStatisticsByDomain&&!isNil(f.domain)){if(S==="values")return void(n[u][S]=f.domain.slice())}else if(S==="allValid")return;n[u][S]=methods[S](o),S==="array-max"&&(n[u].max=n[u][S]),S==="array-min"&&(n[u].min=n[u][S])}}),_&&(n[u].allValid=y)}),n},invalidTravel=(r,e)=>{const{config:i}=e;if(!i)return r;const{invalidType:n,checkField:o}=i();return n!=="zero"||o&&o.length&&r.forEach(l=>{o.forEach(d=>{couldBeValidNumber(l[d])||(l[d]=0)})}),r};class SeriesData extends CompilableData{_compileProduct(){var e;const i=(e=this._data)===null||e===void 0?void 0:e.latestData;isNil(i)||isValid(this.getProduct())||this._initProduct([])}generateProductId(){var e;return(e=this._data)===null||e===void 0?void 0:e.name}}const DEFAULT_HIERARCHY_DEPTH=`${PREFIX}_HIERARCHY_DEPTH`,DEFAULT_HIERARCHY_ROOT=`${PREFIX}_HIERARCHY_ROOT`,DEFAULT_HIERARCHY_ROOT_INDEX=`${PREFIX}_HIERARCHY_ROOT_INDEX`;function initKeyMap(){return{keyMap:new Map,needDefaultSeriesField:!this._seriesField,defaultSeriesField:this._seriesField?null:this.getSeriesKeys()[0],getKey:this.generateDefaultDataKey(this._spec.dataKey)}}function addDataKey(r,e,i){r&&(i.needDefaultSeriesField&&(r[DEFAULT_DATA_SERIES_FIELD]=i.defaultSeriesField),r[DEFAULT_DATA_INDEX]=e,r[DEFAULT_DATA_KEY]=i.getKey(r,e,i))}function initHierarchyKeyMap(){return{keyMap:new Map,needDefaultSeriesField:!0,defaultSeriesField:this.getSeriesKeys()[0],getKey:this.generateDefaultDataKey(this._spec.dataKey),categoryField:this.getCategoryField()}}function addHierarchyDataKey(r,e,i,n=0,o,l){l===void 0&&(l=e),addDataKey(r,e,i),r[DEFAULT_HIERARCHY_DEPTH]=n,r[DEFAULT_HIERARCHY_ROOT]=o||r[i.categoryField],r[DEFAULT_HIERARCHY_ROOT_INDEX]=l,r.children&&r.children.length&&r.children.forEach((d,u)=>addHierarchyDataKey(d,u,i,r[DEFAULT_HIERARCHY_DEPTH]+1,r[DEFAULT_HIERARCHY_ROOT],l))}const baseSeriesMark={label:{name:"label",type:"text"}},RECT_X=`${PREFIX}_rect_x`,RECT_X1=`${PREFIX}_rect_x1`,RECT_Y=`${PREFIX}_rect_y`,RECT_Y1=`${PREFIX}_rect_y1`,defaultSeriesIgnoreCheckKeys={data:!0},defaultSeriesCompileCheckKeys={invalidType:!0,animation:!0,animationAppear:!0,animationEnter:!0,animationUpdate:!0,animationExit:!0,animationNormal:!0},Appear_ClipIn=r=>({type:"clipIn",options:{clipDimension:r.direction==="horizontal"?"y":"x"}}),Appear_FadeIn$8={type:"fadeIn"},Appear_Grow$5=r=>({type:r.direction==="horizontal"?"growPointsXIn":"growPointsYIn",options:{orient:r.direction==="horizontal"?"positive":"negative"}});function linePresetAnimation(r,e){switch(e){case"grow":return Appear_Grow$5(r);case"fadeIn":return Appear_FadeIn$8;default:return Appear_ClipIn(r)}}const DEFAULT_ANIMATION_CONFIG={appear:{duration:1e3,easing:"cubicOut"},update:{type:"update",duration:300,easing:"linear"},enter:{duration:300,easing:"linear"},exit:{duration:300,easing:"linear"},disappear:{duration:500,easing:"cubicIn"},state:{duration:300,easing:"linear"}},ScaleInOutAnimation={appear:{type:"scaleIn"},enter:{type:"scaleIn"},exit:{type:"scaleOut"},disappear:{type:"scaleOut"}},FadeInOutAnimation={appear:{type:"fadeIn"},enter:{type:"fadeIn"},exit:{type:"fadeOut"},disappear:{type:"fadeOut"}},registerScaleInOutAnimation=()=>{Factory$1.registerAnimation("scaleInOut",()=>ScaleInOutAnimation)},registerFadeInOutAnimation=()=>{Factory$1.registerAnimation("fadeInOut",()=>FadeInOutAnimation)},registerCartesianGroupClipAnimation=()=>{Factory$1.registerAnimation("cartesianGroupClip",r=>({appear:{custom:ClipDirectionAnimate,customParameters:(e,i)=>({animationType:"in",group:i.getGraphicItem(),direction:r.direction(),width:r.width(),height:r.height(),orient:r.orient()})},disappear:{custom:ClipDirectionAnimate,customParameters:(e,i)=>({animationType:"out",group:i.getGraphicItem(),direction:r.direction(),width:r.width(),height:r.height(),orient:r.orient()})}}))},lineOrAreaAnimation=(r,e)=>({appear:linePresetAnimation(r,e),enter:{type:"fadeIn"},exit:{type:"fadeOut"},update:[{type:"update",options:{excludeChannels:["points","defined","segments"]}},{channel:["points","segments"],custom:TagPointsUpdate,duration:DEFAULT_ANIMATION_CONFIG.update.duration,easing:DEFAULT_ANIMATION_CONFIG.update.easing,customParameters:{clipRangeByDimension:r.direction==="horizontal"?"y":"x"}}],disappear:{type:"clipOut"}}),registerLineAnimation=()=>{Factory$1.registerAnimation("line",lineOrAreaAnimation)},registerAreaAnimation=()=>{Factory$1.registerAnimation("area",lineOrAreaAnimation)},registerVGrammarCommonAnimation=()=>{View.useRegisters([registerScaleInAnimation,registerScaleOutAnimation,registerFadeInAnimation,registerFadeOutAnimation,registerMoveInAnimation,registerMoveOutAnimation,registerRotateInAnimation,registerRotateOutAnimation,registerUpdateAnimation])},registerVGrammarRectAnimation=()=>{View.useRegisters([registerGrowHeightInAnimation,registerGrowHeightOutAnimation,registerGrowWidthInAnimation,registerGrowWidthOutAnimation,registerGrowCenterInAnimation,registerGrowCenterOutAnimation])},registerVGrammarArcAnimation=()=>{View.useRegisters([registerGrowRadiusInAnimation,registerGrowRadiusOutAnimation,registerGrowAngleInAnimation,registerGrowAngleOutAnimation])},registerVGrammarLineOrAreaAnimation=()=>{View.useRegisters([registerGrowPointsInAnimation,registerGrowPointsOutAnimation,registerGrowPointsXInAnimation,registerGrowPointsXOutAnimation,registerGrowPointsYInAnimation,registerGrowPointsYOutAnimation,registerClipInAnimation,registerClipOutAnimation])},registerVGrammarPolygonAnimation=()=>{View.useRegisters([registerGrowPointsInAnimation,registerGrowPointsOutAnimation])},AnimationStates=[...Object.keys(DEFAULT_ANIMATION_CONFIG),"normal"];function animationConfig(r={},e,i){const n={};for(let o=0;o<AnimationStates.length;o++){const l=AnimationStates[o],d=e?e[l]:void 0;if(d===!1)continue;if(l==="normal"){d&&(n.normal=d);continue}if(l==="state"){d!==!1&&(n.state=d??DEFAULT_ANIMATION_CONFIG.state);continue}if(l!=="update"&&!d&&!r[l])continue;let u,f;u=isArray(r[l])?r[l]:[Object.assign(Object.assign({},DEFAULT_ANIMATION_CONFIG[l]),r[l])],l==="exit"&&u.forEach(g=>{g.controlOptions={stopWhenStateChange:!0}}),d?(f=isArray(d)?d.map((g,_)=>{var y;let b=g;return isChannelAnimation(b)&&delete b.type,b.oneByOne&&(b=produceOneByOne(b,(y=i==null?void 0:i.dataIndex)!==null&&y!==void 0?y:defaultDataIndex,i==null?void 0:i.dataCount)),b}):u.map((g,_)=>{var y;let b=mergeSpec({},u[_],d);return isChannelAnimation(b)&&delete b.type,b.oneByOne&&(b=produceOneByOne(b,(y=i==null?void 0:i.dataIndex)!==null&&y!==void 0?y:defaultDataIndex,i==null?void 0:i.dataCount)),b}),n[l]=f):n[l]=u}return n}function userAnimationConfig(r,e,i){var n,o,l,d,u,f;const g={};return isValid(e.animationAppear)&&(g.appear=(n=e.animationAppear[r])!==null&&n!==void 0?n:e.animationAppear),isValid(e.animationDisappear)&&(g.disappear=(o=e.animationDisappear[r])!==null&&o!==void 0?o:e.animationDisappear),isValid(e.animationEnter)&&(g.enter=(l=e.animationEnter[r])!==null&&l!==void 0?l:e.animationEnter),isValid(e.animationExit)&&(g.exit=(d=e.animationExit[r])!==null&&d!==void 0?d:e.animationExit),isValid(e.animationUpdate)&&(g.update=(u=e.animationUpdate[r])!==null&&u!==void 0?u:e.animationUpdate),isValid(e.animationState)&&(g.state=(f=e.animationState[r])!==null&&f!==void 0?f:e.animationState),e.animationNormal&&e.animationNormal[r]&&(g.normal=e.animationNormal[r]),uniformAnimationConfig(g,i)}function produceOneByOne(r,e,i){const{oneByOne:n,duration:o,delay:l,delayAfter:d}=r;return r.delay=(u,f,g)=>{const _=e(u,g),y=isFunction(o)?o(u,f,g):isValidNumber(o)?o:0,b=isFunction(l)?l(u,f,g):isValidNumber(l)?l:0;let S=isFunction(n)?n(u,f,g):n;return S===!1?b:(S=S===!0?0:S,b+_*(y+S))},r.delayAfter=(u,f,g)=>{const _=e(u,g),y=isFunction(o)?o(u,f,g):isValidNumber(o)?o:0,b=isFunction(d)?d(u,f,g):isValidNumber(d)?d:0;let S=isFunction(n)?n(u,f,g):n;return S===!1?b:(S=S===!0?0:S,b+((i?i():f.mark.elements.length)-_)*(y+S))},delete r.oneByOne,r}function defaultDataIndex(r,e){var i,n;return(i=r==null?void 0:r[DEFAULT_DATA_INDEX])!==null&&i!==void 0?i:(n=e==null?void 0:e.VGRAMMAR_ANIMATION_PARAMETERS)===null||n===void 0?void 0:n.elementIndex}function shouldMarkDoMorph(r,e){var i,n,o,l,d;if(r.animation===!1||((i=r.morph)===null||i===void 0?void 0:i.enable)===!1)return!1;const u=((o=(n=r.animationAppear)===null||n===void 0?void 0:n[e])!==null&&o!==void 0?o:r.animationAppear)!==!1,f=((d=(l=r.animationUpdate)===null||l===void 0?void 0:l[e])!==null&&d!==void 0?d:r.animationUpdate)!==!1;return!(!u||!f)}function isTimeLineAnimation(r){return isValid(r.timeSlices)}function isChannelAnimation(r){return!isTimeLineAnimation(r)&&isValid(r.channel)}function uniformAnimationConfig(r,e){if(!r)return r;const i=["custom","customParameters"];return traverseSpec(r=cloneDeep(r,null,i),n=>{var o;return isFunction(n)&&((o=n.prototype)===null||o===void 0?void 0:o.constructor)!==n?(...l)=>n(...l,e):n},i),r}function traverseSpec(r,e,i=[]){if(isArray(r))r.forEach((n,o)=>{r[o]=e(r[o],o),traverseSpec(r[o],e,i)});else if(isObject$1(r))for(const n in r)i.includes(n)||(r[n]=e(r[n],n),traverseSpec(r[n],e,i))}function isAnimationEnabledForSeries(r){var e,i,n,o;const l=r.getSpec();if(l.animation===!1||!isValid(r.getRegion().animate))return!1;let d=(e=l.animationThreshold)!==null&&e!==void 0?e:Number.MAX_SAFE_INTEGER;return(i=r.getMarks())===null||i===void 0||i.forEach(u=>{const f=u.getMarkConfig();f&&(f.large&&f.largeThreshold&&(d=Math.min(d,f.largeThreshold)),f.progressiveThreshold&&(d=Math.min(d,f.progressiveThreshold)))}),!(((o=(n=r.getRawData())===null||n===void 0?void 0:n.latestData)===null||o===void 0?void 0:o.length)>=d)}class BaseSeriesSpecTransformer extends BaseModelSpecTransformer{constructor(){super(...arguments),this.markLabelSpec={}}getLabelSpec(e){return this.markLabelSpec[e]}setLabelSpec(e,i){this.markLabelSpec[e]=array(i)}addLabelSpec(e,i,n=!1){this.markLabelSpec[e]||(this.markLabelSpec[e]=[]),n?this.markLabelSpec[e].unshift(i):this.markLabelSpec[e].push(i)}getTheme(e,i){var n,o,l;const d=getDirectionFromSeriesSpec(e),u=(n=this._option)===null||n===void 0?void 0:n.getTheme(),{markByName:f,mark:g}=u,_=this._option.type,y=Factory$1.getSeriesMarkMap(_)?transformSeriesThemeToMerge(get(u,`series.${_}`),_,g,f):{},b=get(u,`series.${_}_${d}`),S=((l=(o=this.stack)!==null&&o!==void 0?o:b==null?void 0:b.stack)!==null&&l!==void 0?l:y!=null&&y.stack)?get(u,`series.${_}_stack`):void 0;return mergeSpec({},y,b,S)}transformSpec(e,i,n){this._transformStack(e);const o=super.transformSpec(e,i,n);return this._transformLabelSpec(o.spec),Object.assign(Object.assign({},o),{markLabelSpec:this.markLabelSpec,stack:this.stack})}_transformLabelSpec(e){}_transformStack(e){isBoolean(e.stack)&&(this.stack=e.stack),isBoolean(e.percent)&&(this.stack=e.percent||this.stack),isNil(this.stack)&&this._supportStack&&e.seriesField&&(this.stack=!0)}_addMarkLabelSpec(e,i,n="label",o="initLabelMarkStyle",l=!0,d){e&&array(e[n]).forEach(u=>{var f,g,_;if(u&&u.visible){const{animation:y=!0,animationUpdate:b=!0,animationEnter:S=!0,animationExit:v=!0}=u,{animationUpdate:A=!0,animationEnter:x=!0,animationExit:T=!0}=e,C=!!((_=(g=(f=this._option)===null||f===void 0?void 0:f.animation)!==null&&g!==void 0?g:e.animation)!==null&&_!==void 0?_:u.animation)&&!!l;this.addLabelSpec(isFunction(i)?i(u):i,Object.assign(Object.assign({},u),{animation:!!C&&y,animationUpdate:!!(C&&A&&b)&&A,animationEnter:!!(C&&x&&S)&&x,animationExit:!!(C&&x&&v)&&T,getStyleHandler:E=>{var P;return(P=E[o])===null||P===void 0?void 0:P.bind(E)}}),d)}})}_getDefaultSpecFromChart(e){var i;const n=(i=super._getDefaultSpecFromChart(e))!==null&&i!==void 0?i:{},{outerRadius:o,innerRadius:l,direction:d}=e;return isValid(o)&&(n.outerRadius=o),isValid(l)&&(n.innerRadius=l),isValid(d)&&(n.direction=d),Object.keys(n).length>0?n:void 0}_mergeThemeToSpec(e,i){const n=this._theme;if(this._shouldMergeThemeToSpec()){const o=this._getDefaultSpecFromChart(i),l=d=>{const u=mergeSpec({},n,o,d),f=n.label;return f&&isObject$1(f)&&isArray(u.label)&&(u.label=u.label.map(g=>mergeSpec({},f,g))),u};return isArray(e)?{spec:e.map(d=>l(d)),theme:n}:{spec:l(e),theme:n}}return{spec:e,theme:n}}}function getDefaultInteractionConfigByMode(r){return r===RenderModeEnum["desktop-browser"]||r===RenderModeEnum["desktop-miniApp"]?{hover:{enable:!0,trigger:"pointermove",triggerOff:"view:pointerleave"},select:{enable:!0,trigger:"pointertap"}}:isMobileLikeMode(r)||isMiniAppLikeMode(r)?{hover:{enable:!0,trigger:["pointerdown","pointermove"],triggerOff:"view:pointerleave"},select:{enable:!0,trigger:"tap"}}:null}class BaseSeries extends BaseModel{getRegion(){return this._region}getLayoutStartPoint(){return this._region.getLayoutStartPoint()}getRootMark(){return this._rootMark}getSeriesMark(){return this._seriesMark}getRawData(){return this._rawData}getViewDataFilter(){return this._viewDataFilter}getViewData(){var e;return(e=this._data)===null||e===void 0?void 0:e.getDataView()}getViewDataProductId(){var e;return(e=this._data)===null||e===void 0?void 0:e.getProductId()}getViewDataStatistics(){return this._viewDataStatistics}getViewStackData(){return this._viewStackData}getSeriesField(){return this._seriesField}setSeriesField(e){isValid(e)&&(this._seriesField=e)}getGroups(){return this._groups}getStack(){var e;return(e=this.getSpecInfo())===null||e===void 0?void 0:e.stack}getStackValue(){var e;return(e=this._spec.stackValue)!==null&&e!==void 0?e:`${PREFIX}_series_${this.type}`}getPercent(){return this._spec.percent}getStackOffsetSilhouette(){return this._spec.stackOffsetSilhouette}get tooltipHelper(){return this._tooltipHelper||this.initTooltip(),this._tooltipHelper}getInvalidType(){return this._invalidType}setInvalidType(e){var i;this._invalidType=e,(i=this.getViewData())===null||i===void 0||i.reRunAllTransform()}getMarkAttributeContext(){return this._markAttributeContext}constructor(e,i){var n;super(e,i),this.specKey="series",this.type="series",this.layoutType="absolute",this.modelType="series",this.name=void 0,this.transformerConstructor=BaseSeriesSpecTransformer,this.coordinate="none",this._region=null,this._layoutStartPoint={x:0,y:0},this._layoutRect={width:null,height:null},this.getLayoutRect=()=>{var o,l;return{width:(o=this._layoutRect.width)!==null&&o!==void 0?o:this._region.getLayoutRect().width,height:(l=this._layoutRect.height)!==null&&l!==void 0?l:this._region.getLayoutRect().height}},this._rootMark=null,this._seriesMark=null,this._viewDataMap=new Map,this._viewDataFilter=null,this._data=null,this.layoutZIndex=LayoutZIndex.SeriesGroup,this._invalidType="break",this._region=i.region,this._dataSet=i.dataSet,!((n=this._spec)===null||n===void 0)&&n.name&&(this.name=this._spec.name)}created(){super.created(),this._buildMarkAttributeContext(),this.initData(),this.initGroups(),this.initStatisticalData(),this.event.emit(ChartEvent.afterInitData,{model:this}),this.initRootMark(),this.initMark();const e=isAnimationEnabledForSeries(this);this._initExtensionMark({hasAnimation:e}),this.initMarkStyle(),this.initMarkState(),e&&this.initAnimation(),this._option.disableTriggerEvent||this.initInteraction(),this.afterInitMark(),this.initEvent(),this.event.emit(ChartEvent.afterInitEvent,{model:this})}_buildMarkAttributeContext(){this._markAttributeContext={vchart:this._option.globalInstance,globalScale:(e,i)=>{var n;return(n=this._option.globalScale.getScale(e))===null||n===void 0?void 0:n.scale(i)},seriesColor:e=>{var i;return isNil(e)&&(e=this.getSeriesKeys()[0]),(i=this._option.globalScale.getScale("color"))===null||i===void 0?void 0:i.scale(e)},getRegion:()=>this._region}}setAttrFromSpec(){super.setAttrFromSpec(),this.setSeriesField(this._spec.seriesField),isValid(this._spec.invalidType)&&(this._invalidType=this._spec.invalidType)}getInvalidCheckFields(){return[this.getStackValueField()]}initInvalidDataTransform(){var e,i;this._invalidType==="zero"&&(!((e=this._rawData)===null||e===void 0)&&e.dataSet)&&(registerDataSetInstanceTransform(this._rawData.dataSet,"invalidTravel",invalidTravel),(i=this._rawData)===null||i===void 0||i.transform({type:"invalidTravel",options:{config:()=>({invalidType:this._invalidType,checkField:this.getInvalidCheckFields()})}},!1))}initData(){var e,i,n;const o=(e=this._spec.data)!==null&&e!==void 0?e:this._option.getSeriesData(this._spec.dataId,this._spec.dataIndex);if(o&&(this._rawData=dataToDataView(o,this._dataSet,this._option.sourceDataList)),(n=(i=this._rawData)===null||i===void 0?void 0:i.target)===null||n===void 0||n.addListener("change",this.rawDataUpdate.bind(this)),this._addDataIndexAndKey(),this._rawData){this.getStack()&&(this._viewDataFilter=dataViewFromDataView(this._rawData,this._dataSet,{name:`${this.type}_${this.id}_viewDataFilter`}));const l=dataViewFromDataView(this.getStack()?this._viewDataFilter:this._rawData,this._dataSet,{name:`${this.type}_${this.id}_viewData`});this._data=new SeriesData(this._option,l),this.getStack()&&this._viewDataFilter.target.removeListener("change",l.reRunAllTransform)}this.initInvalidDataTransform()}initGroups(){const e=this.getGroupFields();e&&e.length&&(this._groups={fields:e})}initStatisticalData(){this._data&&this._statisticViewData()}getRawDataStatisticsByField(e,i){var n,o,l;if(this._rawStatisticsCache||(this._rawStatisticsCache={}),!this._rawStatisticsCache[e]||i&&(isNil(this._rawStatisticsCache[e].min)||isNil(this._rawStatisticsCache[e].max))||!i&&isNil(this._rawStatisticsCache[e].values)){if(this._viewDataStatistics&&(!this._viewDataFilter||this._viewDataFilter.transformsArr.length<=1)&&this.getViewData().transformsArr.length<=1&&(!((n=this._viewDataStatistics.latestData)===null||n===void 0)&&n[e]))this._rawStatisticsCache[e]=this._viewDataStatistics.latestData[e];else if(this._rawData){const d=(o=this._rawData.getFields())===null||o===void 0?void 0:o[e];if(d&&d.lockStatisticsByDomain&&d.domain)this._rawStatisticsCache[e]={},i?(this._rawStatisticsCache[e].min=minInArray(d.domain),this._rawStatisticsCache[e].max=maxInArray(d.domain)):this._rawStatisticsCache[e].values=d.domain;else{const u=dimensionStatisticsOfSimpleData(this._rawData.latestData,[{key:e,operations:i?["min","max"]:["values"]}])[e];this._rawStatisticsCache[e]=merge$1((l=this._rawStatisticsCache[e])!==null&&l!==void 0?l:{},u)}}}return this._rawStatisticsCache[e]}_statisticViewData(){registerDataSetInstanceTransform(this._dataSet,"dimensionStatistics",dimensionStatistics);const e=`${this.type}_${this.id}_viewDataStatic`;this._viewDataStatistics=new DataView(this._dataSet,{name:e}),this._viewDataStatistics.parse([this._data.getDataView()],{type:"dataview"}),this._viewDataStatistics.transform({type:"dimensionStatistics",options:{fields:()=>{const i=this.getStatisticFields();return this._seriesField&&mergeFields(i,[{key:this._seriesField,operations:["values"]}]),i},target:"latest"}},!1),this._data.getDataView().target.removeListener("change",this._viewDataStatistics.reRunAllTransform),this.getStack()&&this.createdStackData()}createStatisticalData(e,i,n){registerDataSetInstanceTransform(this._dataSet,"dimensionStatistics",dimensionStatistics);const o=new DataView(this._dataSet,{name:e});return o.parse([i],{type:"dataview"}),o.transform({type:"dimensionStatistics",options:{operations:["max","min","values"],fields:()=>{var l;const d=mergeFields(this.getStatisticFields(),(l=n==null?void 0:n(i.name))!==null&&l!==void 0?l:[]);return this._seriesField&&mergeFields(d,[{key:this._seriesField,operations:["values"]}]),d},target:"latest"}},!1),o}createdStackData(){const e=`${this.type}_${this.id}_viewStackData`;this._viewStackData=new DataView(this._dataSet,{name:e}),this._viewStackData.parse([this._viewDataFilter],{type:"dataview"}),this._viewStackData.transform({type:"stackSplit",options:{fields:this.getStackGroupFields()}},!1)}_noAnimationDataKey(e,i){return i}generateDefaultDataKey(e){var i;return isNil(e)?(n,o,l)=>{if(this._spec.animation===!1){const f=this._noAnimationDataKey(n,o);if(f!==void 0)return f}const{keyMap:d}=l,u=this._getSeriesDataKey(n);return d.get(u)===void 0?(d.set(u,0),u):(d.set(u,d.get(u)+1),`${u}_${d.get(u)}`)}:isString(e)?n=>n[e]:isArray(e)&&e.every(n=>isString(n))?n=>e.map(o=>n[o]).join("-"):isFunction(e)?(n,o)=>e(n,o):((i=this._option)===null||i===void 0||i.onError(`invalid dataKey: ${e}`),(n,o)=>{})}_addDataIndexAndKey(){var e;!((e=this._rawData)===null||e===void 0)&&e.dataSet&&(registerDataSetInstanceTransform(this._rawData.dataSet,"addVChartProperty",addVChartProperty),this._rawData.transform({type:"addVChartProperty",options:{beforeCall:initKeyMap.bind(this),call:addDataKey}},!1))}updateRawData(e){this._rawData&&this._rawData.updateRawData(e)}rawDataUpdate(e){var i;(i=this._rawDataStatistics)===null||i===void 0||i.reRunAllTransform(),this._rawStatisticsCache=null,this.event.emit(ChartEvent.rawDataUpdate,{model:this})}viewDataFilterOver(e){this.event.emit(ChartEvent.viewDataFilterOver,{model:this})}viewDataUpdate(e){var i;this.event.emit(ChartEvent.viewDataUpdate,{model:this}),(i=this._data)===null||i===void 0||i.updateData(),this._viewDataStatistics&&this._viewDataStatistics.reRunAllTransform()}viewDataStatisticsUpdate(e){this.event.emit(ChartEvent.viewDataStatisticsUpdate,{model:this})}getDatumPositionValue(e,i){return!e||isNil(i)?null:e[i]}getDatumPositionValues(e,i){return!e||isNil(i)?[]:isString(i)?[e[i]]:i.map(n=>e[n])}setValueFieldToStack(){}setValueFieldToPercent(){}setValueFieldToStackOffsetSilhouette(){}initRootMark(){var e,i,n;this._rootMark=this._createMark({type:"group",name:`seriesGroup_${this.type}_${this.id}`},{parent:(i=(e=this._region).getGroupMark)===null||i===void 0?void 0:i.call(e),dataView:!1}),this._rootMark.setMarkConfig({zIndex:(n=this._spec.zIndex)!==null&&n!==void 0?n:this.layoutZIndex})}_getExtensionMarkNamePrefix(){return`${this.type}_${this.id}_extensionMark`}_initExtensionMark(e){var i;if(!this._spec.extensionMark)return;const n=this.getMarksWithoutRoot();e.depend=n,(i=this._spec.extensionMark)===null||i===void 0||i.forEach((o,l)=>{this._createExtensionMark(o,null,this._getExtensionMarkNamePrefix(),l,e)})}_createExtensionMark(e,i,n,o,l){var d;const u=this._createMark({type:e.type,name:isValid(e.name)?`${e.name}`:`${n}_${o}`},{skipBeforeLayouted:!0,markSpec:e,parent:i,dataView:!1,componentType:e.componentType,depend:l.depend,key:e.dataKey},{setCustomizedShape:e==null?void 0:e.customShape});if(u){if(isValid(e.id)&&u.setUserId(e.id),l.hasAnimation){const f=animationConfig({},userAnimationConfig(e.type,e,this._markAttributeContext));u.setAnimationConfig(f)}if(e.type==="group")n=`${n}_${o}`,(d=e.children)===null||d===void 0||d.forEach((f,g)=>{this._createExtensionMark(f,u,n,g,l)});else if(!(i||isNil(e.dataId)&&isNil(e.dataIndex))){const f=this._option.getSeriesData(e.dataId,e.dataIndex);f===this._rawData?u.setDataView(this.getViewData(),this.getViewDataProductId()):(u.setDataView(f),f.target.addListener("change",()=>{u.getData().updateData()}))}}}_updateExtensionMarkSpec(){var e;(e=this._spec.extensionMark)===null||e===void 0||e.forEach((i,n)=>{const o=this._marks.getMarkWithInfo({name:isValid(i.name)?`${i.name}`:`${this._getExtensionMarkNamePrefix()}_${n}`});o&&(this.initMarkStyleWithSpec(o,i),o.updateStaticEncode(),o.updateLayoutState())})}getStackData(){var e;return(e=this._viewStackData)===null||e===void 0?void 0:e.latestData}_parseSelectorOfInteraction(e,i){if(!i||!i.length)return[];const n=[];return e.markIds?i.filter(o=>{e.markIds.includes(o.getProductId())&&n.push(`#${o.getProductId()}`)}):e.markNames?i.forEach(o=>{e.markNames.includes(o.name)&&n.push(`#${o.getProductId()}`)}):i.forEach(o=>{n.push(`#${o.getProductId()}`)}),n}_parseDefaultInteractionConfig(e){if(!(e!=null&&e.length))return[];const i=getDefaultInteractionConfigByMode(this._option.mode);let n=Object.assign({},i==null?void 0:i.hover),o=Object.assign({},i==null?void 0:i.select);const l=this._spec.hover;isBoolean(l)?n.enable=l:isObject$1(l)&&(n.enable=!0,n=mergeSpec(n,l));const d=this._spec.select;isBoolean(d)?o.enable=d:isObject$1(d)&&(o.enable=!0,o=mergeSpec(o,d));const u=[];if(n.enable){const f=this._parseSelectorOfInteraction(n,e);f.length&&u.push(this._defaultHoverConfig(f,n))}if(o.enable){const f=this._parseSelectorOfInteraction(o,e);f.length&&u.push(this._defaultSelectConfig(f,o))}return u}_defaultHoverConfig(e,i){return{seriesId:this.id,regionId:this._region.id,selector:e,type:"element-highlight",trigger:i.trigger,triggerOff:i.triggerOff,blurState:STATE_VALUE_ENUM.STATE_HOVER_REVERSE,highlightState:STATE_VALUE_ENUM.STATE_HOVER}}_defaultSelectConfig(e,i){const n=i.mode==="multiple",o=isValid(i.triggerOff)?i.triggerOff:n?["empty"]:["empty",i.trigger];return{type:"element-select",seriesId:this.id,regionId:this._region.id,selector:e,trigger:i.trigger,triggerOff:o,reverseState:STATE_VALUE_ENUM.STATE_SELECTED_REVERSE,state:STATE_VALUE_ENUM.STATE_SELECTED,isMultiple:n}}_parseInteractionConfig(e){const i=this.getCompiler();if(!i)return;const{interactions:n}=this._spec,o=this._parseDefaultInteractionConfig(e);o&&o.length&&o.forEach(l=>{i.addInteraction(l)}),n&&n.length&&n.forEach(l=>{const d=this._parseSelectorOfInteraction(l,this.getMarks());d.length&&i.addInteraction(Object.assign(Object.assign({},l),{selector:d,seriesId:this.id,regionId:this._region.id}))})}initInteraction(){const e=this.getMarksWithoutRoot();this._parseInteractionConfig(e)}initAnimation(){}initMarkState(){this.initSeriesStyleState()}initSeriesStyleState(){var e;const i=this._spec.seriesStyle;if(!i||!i.length)return;const n=(e=this._seriesField)!==null&&e!==void 0?e:DEFAULT_DATA_SERIES_FIELD;this.getMarksWithoutRoot().forEach(o=>{const l={},d={},u={};i.forEach(g=>{var _;const y=(_=g[o.name])===null||_===void 0?void 0:_.style;y&&(l[g.name]=!0,u[g.name]=u[g.name]||{},Object.keys(y).forEach(b=>{d[b]=!0,u[g.name][b]=y[b]}))}),o.state.addStateInfo({stateValue:DEFAULT_SERIES_STYLE_NAME,level:-1,filter:g=>Array.isArray(g)?g.length!==0&&l[g[0][n]]===!0:l[g[n]]===!0});const f={};Object.keys(d).forEach(g=>{f[g]=_=>{var y,b;let S;if(Array.isArray(_)){if(_.length===0)return;S=(y=u[_[0][n]])===null||y===void 0?void 0:y[g]}return S=(b=u[_[n]])===null||b===void 0?void 0:b[g],isValid(S)?S:o.getAttribute(g,_)}}),this.setMarkStyle(o,f,DEFAULT_SERIES_STYLE_NAME,AttributeLevel.User_SeriesStyle)})}afterInitMark(){this.event.emit(ChartEvent.afterInitMark,{model:this}),this.setSeriesField(this._spec.seriesField),this.getMarks().forEach(e=>{var i,n;!((n=(i=e.stateStyle)===null||i===void 0?void 0:i.normal)===null||n===void 0)&&n.lineWidth&&e.setAttribute("stroke",this.getColorAttribute(),"normal",AttributeLevel.Base_Series)})}getMarksWithoutRoot(){return this.getMarks().filter(e=>{var i;return!(!((i=e.name)===null||i===void 0)&&i.includes("seriesGroup"))})}getMarksInType(e){return this._marks.getMarksInType(e)}getMarkInName(e){return this._marks.get(e)}getMarkInId(e){return this.getMarks().find(i=>i.id===e)}initEvent(){var e,i,n;(i=(e=this._data)===null||e===void 0?void 0:e.getDataView())===null||i===void 0||i.target.addListener("change",this.viewDataUpdate.bind(this)),(n=this._viewDataStatistics)===null||n===void 0||n.target.addListener("change",this.viewDataStatisticsUpdate.bind(this))}_releaseEvent(){super._releaseEvent(),this.getCompiler().removeInteraction(this.id)}initTooltip(){this._tooltipHelper=new BaseSeriesTooltipHelper(this)}_compareExtensionMarksSpec(e,i,n){e.length!==i.length||i.some((o,l)=>o.type!==e[l].type||o.id!==e[l].id||o.name!==e[l].name)?n.reMake=!0:i.some((o,l)=>o.visible!==e[l].visible)&&(n.reCompile=!0)}_compareLabelSpec(e,i,n){e.length!==i.length||i.some((o,l)=>o.labelLayout!==e[l].labelLayout||o.visible!==e[l].visible)?n.reMake=!0:!n.reCompile&&i.some((o,l)=>!isEqual(o,e[l]))&&(n.reCompile=!0)}_compareSpec(e,i,n){const o=super._compareSpec(e,i),l=Object.keys(i||{}).sort(),d=Object.keys(e||{}).sort();if(!isEqual(l,d))return o.reMake=!0,o;const u=Object.assign(Object.assign(Object.assign(Object.assign({},defaultSeriesIgnoreCheckKeys),defaultSeriesCompileCheckKeys),n),{extensionMark:!0,label:!0,totalLabel:!0});return this._compareExtensionMarksSpec(array(e.extensionMark),array(i.extensionMark),o),!o.reMake&&this._compareLabelSpec(array(e.label),array(i.label),o),!o.reMake&&this._compareLabelSpec(array(e.totalLabel),array(i.totalLabel),o),o.reMake?o:(!o.reCompile&&this._marks.getMarks().some(f=>{var g,_;return u[f.name]=!0,((g=i[f.name])===null||g===void 0?void 0:g.visible)!==((_=e[f.name])===null||_===void 0?void 0:_.visible)})&&(o.reCompile=!0),!o.reCompile&&l.some(f=>defaultSeriesCompileCheckKeys[f]&&!isEqual(e[f],i[f]))&&(o.reCompile=!0),l.some(f=>!u[f]&&!isEqual(e[f],i[f]))&&(o.reMake=!0),o)}_updateSpecData(){!this._rawData||!this._spec.data||this._spec.data instanceof DataView||updateDataViewInData(this._rawData,this._spec.data,!0)}reInit(e){super.reInit(e);const i=this.getMarksWithoutRoot();i.forEach(n=>{this._spec[n.name]&&this.initMarkStyleWithSpec(n,this._spec[n.name])}),this.initMarkStyle(),i.forEach(n=>{n.updateStaticEncode(),n.updateLayoutState(!0)}),this._updateExtensionMarkSpec(),this._updateSpecData(),this._tooltipHelper&&this._tooltipHelper.updateTooltipSpec(),isAnimationEnabledForSeries(this)&&this.initAnimation()}onEvaluateEnd(e){this._data.updateData()}onRender(e){}release(){var e,i,n;super.release(),this._viewDataMap.clear();const o=(i=(e=this._rawData)===null||e===void 0?void 0:e.transformsArr)===null||i===void 0?void 0:i.findIndex(l=>l.type==="addVChartProperty");o>=0&&this._rawData.transformsArr.splice(o,1),(n=this._data)===null||n===void 0||n.release(),this._dataSet=this._data=this._rawData=this._rawDataStatistics=this._spec=this._region=this._viewDataStatistics=this._viewStackData=null}setLayoutStartPosition(e){isValidNumber(e.x)&&(this._layoutStartPoint.x=e.x),isValidNumber(e.y)&&(this._layoutStartPoint.y=e.y)}setLayoutRect({width:e,height:i},n){isValidNumber(e)&&(this._layoutRect.width=e),isValidNumber(i)&&(this._layoutRect.height=i)}getSeriesKeys(){var e,i;return this._seriesField?(i=(e=this.getRawDataStatisticsByField(this._seriesField))===null||e===void 0?void 0:e.values)!==null&&i!==void 0?i:[]:this.name?[this.name]:this.userId?[`${this.userId}`]:[`${this.type}_${this.id}`]}getSeriesStyle(e){return i=>{var n,o;return(o=(n=this._seriesMark)===null||n===void 0?void 0:n.getAttribute(i,e))!==null&&o!==void 0?o:void 0}}_getSeriesInfo(e,i){const n=this.getDefaultShapeType();return i.map(o=>({key:o,originalKey:o,style:this.getSeriesStyle({[e]:o}),shapeType:n}))}getSeriesInfoInField(e){var i,n;return this._getSeriesInfo(e,(n=(i=this.getRawDataStatisticsByField(e))===null||i===void 0?void 0:i.values)!==null&&n!==void 0?n:[])}getSeriesInfoList(){var e;return this._getSeriesInfo((e=this._seriesField)!==null&&e!==void 0?e:DEFAULT_DATA_SERIES_FIELD,this.getSeriesKeys())}_getDefaultColorScale(){var e,i;const n=this.getDefaultColorDomain(),o=this._getDataScheme();return(i=(e=new ColorOrdinalScale().domain(n)).range)===null||i===void 0?void 0:i.call(e,o)}_getDataScheme(){return getDataScheme(this.getColorScheme(),this.type)}getDefaultColorDomain(){var e,i;return this._seriesField?(i=(e=this.getViewDataStatistics())===null||e===void 0?void 0:e.latestData[this._seriesField])===null||i===void 0?void 0:i.values:[]}getColorAttribute(){var e,i;return{scale:(e=this._option.globalScale.getScale("color"))!==null&&e!==void 0?e:this._getDefaultColorScale(),field:(i=this._seriesField)!==null&&i!==void 0?i:DEFAULT_DATA_SERIES_FIELD}}getDimensionField(){return[]}getMeasureField(){return[]}onMarkPositionUpdate(){this.onMarkTreePositionUpdate(this.getMarksWithoutRoot())}onMarkTreePositionUpdate(e){}_createMark(e,i={},n={}){var o,l,d,u,f,g;const{key:_,groupKey:y,skipBeforeLayouted:b,themeSpec:S={},markSpec:v,dataView:A,dataProductId:x,parent:T,isSeriesMark:C,depend:E,stateSort:P,noSeparateStyle:R=!1}=i,L=super._createMark(e,{key:_??this._getDataIdKey(),seriesId:this.id,attributeContext:this._markAttributeContext,componentType:i.componentType,noSeparateStyle:R});if(isValid(L)){const w=this.getSpec()||{};this._marks.addMark(L,{name:e.name}),C&&(this._seriesMark=L),isNil(T)?(o=this._rootMark)===null||o===void 0||o.addMark(L):T!==!1&&T.addMark(L),isNil(A)?(L.setDataView(this.getViewData(),this.getViewDataProductId()),L.setSkipBeforeLayouted(!0)):A!==!1&&L.setDataView(A,x),isBoolean(b)&&L.setSkipBeforeLayouted(b),isValid(E)&&L.setDepend(...array(E)),isNil(y)||L.setGroupKey(y),P&&L.setStateSortCallback(P);const B=Object.assign(Object.assign({},n),{morph:(l=n.morph)!==null&&l!==void 0&&l,support3d:is3DMark(e.type)||((d=n.support3d)!==null&&d!==void 0?d:w.support3d||!!w.zField),morphKey:((u=w.morph)===null||u===void 0?void 0:u.morphKey)||`${this.getSpecIndex()}_${this.getMarks().length}`,morphElementKey:(g=(f=w.morph)===null||f===void 0?void 0:f.morphElementKey)!==null&&g!==void 0?g:n.morphElementKey});L.setMarkConfig(B),this.initMarkStyleWithSpec(L,mergeSpec({},S,v||w[L.name]))}return L}_getDataIdKey(){var e;return(e=super._getDataIdKey())!==null&&e!==void 0?e:DEFAULT_DATA_KEY}_getSeriesDataKey(e){let i="";if(!e)return i;const n=this.getDimensionField();i=n.map(l=>e[l]).join("_");const o=this.getSeriesField();return o&&!n.includes(o)&&(i+=`_${e[o]}`),i}addViewDataFilter(e){var i,n;(n=(i=this._viewDataFilter)!==null&&i!==void 0?i:this.getViewData())===null||n===void 0||n.transform(e,!1)}reFilterViewData(){var e,i;(i=(e=this._viewDataFilter)!==null&&e!==void 0?e:this.getViewData())===null||i===void 0||i.reRunAllTransform()}reTransformViewData(){var e,i;(i=(e=this._data)===null||e===void 0?void 0:e.getDataView())===null||i===void 0||i.reRunAllTransform()}fillData(){var e;(e=this.getRawData())===null||e===void 0||e.reRunAllTransform()}compile(){this.compileData()}getDefaultShapeType(){return"circle"}getFieldAlias(e){var i;return e!==STACK_FIELD_END&&e!==STACK_FIELD_END_PERCENT&&e!==STACK_FIELD_START&&e!==STACK_FIELD_START_PERCENT||(e=this.getStackValueField()),(i=getFieldAlias(this.getRawData(),e))!==null&&i!==void 0?i:e}_getInvalidConnectType(){return this._invalidType==="zero"?"zero":this._invalidType==="link"?"connect":"none"}_getInvalidDefined(e){const i=this.getInvalidCheckFields();return!i.length||i.every(n=>couldBeValidNumber(e[n]))}_getRelatedComponentSpecInfo(e){var i;const n=this.getSpecIndex(),o=(i=this._option.getSpecInfo().component[e])===null||i===void 0?void 0:i.filter(l=>l.seriesIndexes.includes(n));return o??[]}_forEachStackGroup(e,i){var n,o;(i=i??((n=this._viewStackData)===null||n===void 0?void 0:n.latestData))&&(!((o=i.values)===null||o===void 0)&&o.length?e(i):i.nodes&&Object.values(i.nodes).forEach(l=>{this._forEachStackGroup(e,l)}))}isDatumInViewData(e){if(!e)return!1;const i=this.getViewData().latestData;return!!i&&(!!i.includes(e)||i.some(n=>Object.keys(e).every(o=>e[o]===n[o])))}getSeriesFieldValue(e,i){var n;return e[(n=i??this.getSeriesField())!==null&&n!==void 0?n:DEFAULT_DATA_SERIES_FIELD]}}BaseSeries.mark=baseSeriesMark,BaseSeries.transformerConstructor=BaseSeriesSpecTransformer;function isPolarAxisSeries(r){return[SeriesTypeEnum.rose,SeriesTypeEnum.radar,SeriesTypeEnum.circularProgress].includes(r)}function sortDataInAxisHelper(r,e,i){const n=r.getScale(0),o="isInverse"in r&&r.isInverse();isContinuous(n.type)?i.sort((l,d)=>(l[e]-d[e])*(o?-1:1)):i.sort((l,d)=>(n.index(l[e])-n.index(d[e]))*(o?-1:1))}function getGroupAnimationParams(r){return{dataIndex:e=>{var i,n;const o=r.direction==="horizontal"?r.fieldY[0]:r.fieldX[0],l=e==null?void 0:e[o],d=r.direction==="horizontal"?r.scaleY:r.scaleX;return((n=(i=d==null?void 0:d.domain)===null||i===void 0?void 0:i.call(d))!==null&&n!==void 0?n:[]).indexOf(l)||0},dataCount:()=>{var e,i,n;const o=r.direction==="horizontal"?r.scaleY:r.scaleX;return(n=((i=(e=o==null?void 0:o.domain)===null||e===void 0?void 0:e.call(o))!==null&&i!==void 0?i:[]).length)!==null&&n!==void 0?n:0}}}class CartesianSeries extends BaseSeries{constructor(){super(...arguments),this.coordinate="cartesian",this._bandPosition=.5,this._scaleConfig={bandPosition:this._bandPosition},this._direction="vertical",this._sortDataByAxis=!1,this._getPositionXEncoder=()=>{var e;return(e=this._positionXEncoder)===null||e===void 0?void 0:e.bind(this)},this._setPositionXEncoder=e=>{this._positionXEncoder=e.bind(this)},this._getPositionYEncoder=()=>{var e;return(e=this._positionYEncoder)===null||e===void 0?void 0:e.bind(this)},this._setPositionYEncoder=e=>{this._positionYEncoder=e.bind(this)}}_buildScaleConfig(){this._scaleConfig={bandPosition:this._bandPosition}}get fieldX(){return this._fieldX}setFieldX(e){this._fieldX=array(e)}get fieldY(){return this._fieldY}setFieldY(e){this._fieldY=array(e)}get fieldZ(){return this._fieldZ}setFieldZ(e){this._fieldZ=e&&array(e)}get fieldX2(){return this._fieldX2}setFieldX2(e){this._fieldX2=e}get fieldY2(){return this._fieldY2}setFieldY2(e){this._fieldY2=e}get direction(){return this._direction}get scaleX(){return this._scaleX}setScaleX(e){this._scaleX=e}get scaleY(){return this._scaleY}setScaleY(e){this._scaleY=e}get scaleZ(){return this._scaleZ}setScaleZ(e){this._scaleZ=e}getXAxisHelper(){return this._xAxisHelper}setXAxisHelper(e){this._xAxisHelper=e,this.onXAxisHelperUpdate()}getYAxisHelper(){return this._yAxisHelper}setYAxisHelper(e){this._yAxisHelper=e,this.onYAxisHelperUpdate()}getZAxisHelper(){return this._zAxisHelper}setZAxisHelper(e){this._zAxisHelper=e,this.onYAxisHelperUpdate()}get sortDataByAxis(){return this._sortDataByAxis}getStatisticFields(){const e=[];return[{axisHelper:this.getXAxisHelper(),fields:this._fieldX2?[...this._fieldX,this._fieldX2]:this._fieldX},{axisHelper:this.getYAxisHelper(),fields:this._fieldY2?[...this._fieldY,this._fieldY2]:this._fieldY},{axisHelper:this.getZAxisHelper(),fields:this._fieldZ}].forEach(i=>{i.axisHelper&&i.axisHelper.getScale&&i.fields&&i.fields.forEach(n=>{const o={key:n,operations:[]},l=i.axisHelper.getScale(0);isContinuous(l.type)?(o.operations=["max","min"],l.type==="log"&&(o.filter=d=>d>0)):o.operations=["values"],e.push(o)})}),this.getStack()&&e.push({key:this.getStackValueField(),operations:["allValid"]}),e}getGroupFields(){return this.direction==="vertical"?this._fieldX:this._fieldY}getStackGroupFields(){return this.getGroupFields()}getStackValue(){var e,i;const n=(e=this.direction==="horizontal"?this.getXAxisHelper():this.getYAxisHelper())===null||e===void 0?void 0:e.getAxisId();return(i=this._spec.stackValue)!==null&&i!==void 0?i:`${PREFIX}_series_${this.type}_${n}`}getStackValueField(){return this.direction==="horizontal"?array(this._spec.xField)[0]:array(this._spec.yField)[0]}setValueFieldToStack(){this.direction==="horizontal"?(this.setFieldX(STACK_FIELD_END),this.setFieldX2(STACK_FIELD_START)):(this.setFieldY(STACK_FIELD_END),this.setFieldY2(STACK_FIELD_START))}setValueFieldToPercent(){this.direction==="horizontal"?(this.setFieldX(STACK_FIELD_END_PERCENT),this.setFieldX2(STACK_FIELD_START_PERCENT)):(this.setFieldY(STACK_FIELD_END_PERCENT),this.setFieldY2(STACK_FIELD_START_PERCENT))}setValueFieldToStackOffsetSilhouette(){this.direction==="horizontal"?(this.setFieldX(STACK_FIELD_END_OffsetSilhouette),this.setFieldX2(STACK_FIELD_START_OffsetSilhouette)):(this.setFieldY(STACK_FIELD_END_OffsetSilhouette),this.setFieldY2(STACK_FIELD_START_OffsetSilhouette))}onXAxisHelperUpdate(){this.onMarkPositionUpdate()}onYAxisHelperUpdate(){this.onMarkPositionUpdate()}onZAxisHelperUpdate(){this.onMarkPositionUpdate()}setAttrFromSpec(){var e,i;super.setAttrFromSpec(),this.setFieldX(this._spec.xField),this.setFieldY(this._spec.yField),this.setFieldZ(this._spec.zField),this._specXField=array(this._spec.xField),this._specYField=array(this._spec.yField),isValid(this._spec.direction)&&(this._direction=this._spec.direction),this.setFieldX2((e=this._spec)===null||e===void 0?void 0:e.x2Field),this.setFieldY2((i=this._spec)===null||i===void 0?void 0:i.y2Field),this.getStack()&&this.setValueFieldToStack(),this.getPercent()&&this.setValueFieldToPercent(),this.getStackOffsetSilhouette()&&this.setValueFieldToStackOffsetSilhouette(),isValid(this._spec.sortDataByAxis)&&(this._sortDataByAxis=this._spec.sortDataByAxis===!0)}dataToPosition(e,i){return e?i&&!this.isDatumInViewData(e)?null:{x:this.dataToPositionX(e),y:this.dataToPositionY(e)}:null}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.valueToX=this.valueToPositionX.bind(this),this._markAttributeContext.valueToY=this.valueToPositionY.bind(this),this._markAttributeContext.xBandwidth=(e=0)=>{var i,n,o;return(o=(n=(i=this.getXAxisHelper()).getBandwidth)===null||n===void 0?void 0:n.call(i,e))!==null&&o!==void 0?o:0},this._markAttributeContext.yBandwidth=(e=0)=>{var i,n,o;return(o=(n=(i=this.getYAxisHelper()).getBandwidth)===null||n===void 0?void 0:n.call(i,e))!==null&&o!==void 0?o:0},this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this)}valueToPosition(e,i){return{x:this.valueToPositionX(e),y:this.valueToPositionY(i)}}_axisPosition(e,i,n){return this._scaleConfig.datum=n,e.isContinuous?e.valueToPosition(i,this._scaleConfig):e.dataToPosition(array(i),this._scaleConfig)}valueToPositionX(e,i){return this._axisPosition(this._xAxisHelper,e,i)}valueToPositionY(e,i){return this._axisPosition(this._yAxisHelper,e,i)}_dataToPosition(e,i,n,o,l,d){const u=l();if(u)return u(e);if(!i)return d(g=>Number.NaN),Number.NaN;const f=(i.getFields?i.getFields():n).slice(0,o);return f&&f.length!==0?(i.isContinuous?d(g=>(this._scaleConfig.datum=g,i.valueToPosition(this.getDatumPositionValue(g,f[0]),this._scaleConfig))):d(g=>(this._scaleConfig.datum=g,i.dataToPosition(array(this.getDatumPositionValues(g,f)),this._scaleConfig))),l()(e)):(d(g=>null),null)}dataToPositionX(e){return this._dataToPosition(e,this._xAxisHelper,this.fieldX,void 0,this._getPositionXEncoder,this._setPositionXEncoder)}dataToPositionY(e){return this._dataToPosition(e,this._yAxisHelper,this.fieldY,void 0,this._getPositionYEncoder,this._setPositionYEncoder)}dataToPositionZ(e){if(!this._zAxisHelper)return Number.NaN;const{dataToPosition:i}=this._zAxisHelper;return i(this.getDatumPositionValues(e,this._fieldZ),{bandPosition:this._bandPosition})}dataToPositionX1(e){return this._xAxisHelper?this._fieldX2&&this._fieldX2 in e?this.valueToPositionX(this.getDatumPositionValues(e,this._fieldX2)):this.valueToPositionX(0):Number.NaN}dataToPositionY1(e){return this._yAxisHelper?this._fieldY2&&this._fieldY2 in e?this.valueToPositionY(this.getDatumPositionValues(e,this._fieldY2)):this.valueToPositionY(0):Number.NaN}positionToData(e){return e?{x:this.positionToDataX(e.x),y:this.positionToDataY(e.y)}:null}positionToDataX(e){return this._scaleX?this._scaleX.invert(e):null}positionToDataY(e){return this._scaleY?this._scaleY.invert(e):null}getRegionRectLeft(){if(!this._xAxisHelper)return Number.NaN;const{getScale:e}=this._xAxisHelper;return e(0).range()[0]}getRegionRectRight(){if(!this._xAxisHelper)return Number.NaN;const{getScale:e}=this._xAxisHelper;return e(0).range()[1]}afterInitMark(){super.afterInitMark(),this.setFieldX(this._fieldX),this.setFieldY(this._fieldY),this._buildScaleConfig()}getDimensionField(){return this._direction==="horizontal"?this._specYField:this._specXField}getDimensionContinuousField(){return this._direction==="horizontal"?[this.fieldY[0],this.fieldY2]:[this.fieldX[0],this.fieldX2]}getMeasureField(){return this._direction==="horizontal"?this._specXField:this._specYField}initEvent(){super.initEvent(),this.sortDataByAxis&&this.event.on(ChartEvent.scaleDomainUpdate,{filter:e=>{var i;return e.model.id===((i=this._direction==="horizontal"?this._yAxisHelper:this._xAxisHelper)===null||i===void 0?void 0:i.getAxisId())}},()=>{this._sortDataInAxisDomain()})}_sortDataInAxisDomain(){var e,i,n;!((i=(e=this.getViewData())===null||e===void 0?void 0:e.latestData)===null||i===void 0)&&i.length&&(sortDataInAxisHelper(this._direction==="horizontal"?this._yAxisHelper:this._xAxisHelper,this._direction==="horizontal"?this._fieldY[0]:this._fieldX[0],this.getViewData().latestData),(n=this._data)===null||n===void 0||n.updateData(!0))}getInvalidCheckFields(){const e=[];return this._xAxisHelper&&this._xAxisHelper.isContinuous&&this._xAxisHelper.getAxisType()!==ComponentTypeEnum.geoCoordinate&&(this._xAxisHelper.getFields?this._xAxisHelper.getFields():this._specXField).forEach(i=>{e.push(i)}),this._yAxisHelper&&this._yAxisHelper.isContinuous&&this._yAxisHelper.getAxisType()!==ComponentTypeEnum.geoCoordinate&&(this._yAxisHelper.getFields?this._yAxisHelper.getFields():this._specYField).forEach(i=>{e.push(i)}),e}reInit(e){this._positionXEncoder&&(this._positionXEncoder=null),this._positionYEncoder&&(this._positionYEncoder=null),super.reInit(e)}}const DEFAULT_SMOOTH_INTERPOLATE="monotone",DEFAULT_LINEAR_INTERPOLATE="linear",DEFAULT_CLOSE_STROKE_JOIN="bevel",lineLikeSeriesMark={point:{name:"point",type:"symbol"},line:{name:"line",type:"line"}};class LineLikeSeriesMixin{addSamplingCompile(){if(this._spec.sampling){const{width:e,height:i}=this._region.getLayoutRect(),n=[],o=this._fieldY,l=this._fieldX;n.push({type:"sampling",size:this._direction==="horizontal"?i:e,factor:this._spec.samplingFactor,yfield:this._direction==="horizontal"?l[0]:o[0],groupBy:this._seriesField,mode:this._spec.sampling}),this._data.getProduct().transform(n)}}addOverlapCompile(){var e;if(this._spec.markOverlap){const i=[];i.push({type:"markoverlap",direction:this._direction==="horizontal"&&this.coordinate==="cartesian"?2:1,delta:this._spec.pointDis,deltaMul:this._spec.pointDisMul,groupBy:this._seriesField}),(e=this._symbolMark)===null||e===void 0||e.getProduct().transform(i)}}reCompileSampling(){this._spec.sampling&&this.compile()}initLineMark(e,i){var n,o;return this._lineMark=this._createMark(lineLikeSeriesMark.line,{groupKey:this._seriesField,isSeriesMark:i==null||i,stateSort:(n=this._spec.line)===null||n===void 0?void 0:n.stateSort},Object.assign(Object.assign({},e),{setCustomizedShape:(o=this._spec.line)===null||o===void 0?void 0:o.customShape,morphElementKey:this.getDimensionField()[0]})),this._lineMark}initLineMarkStyle(e,i){var n,o;const l=this._lineMark;if(l){if(this.setMarkStyle(l,{stroke:this.getColorAttribute()},"normal",AttributeLevel.Series),this._invalidType!=="zero"&&this.setMarkStyle(l,{defined:this._getInvalidDefined.bind(this),connectedType:this._getInvalidConnectType()},"normal",AttributeLevel.Series),this.event.on(ChartEvent.viewDataStatisticsUpdate,{filter:d=>d.model===this},()=>{this.encodeDefined(l,"defined")}),this.coordinate==="polar")this.setMarkStyle(l,{lineJoin:DEFAULT_CLOSE_STROKE_JOIN,curveType:DEFAULT_LINEAR_INTERPOLATE,closePath:!0},"normal",AttributeLevel.Series);else{const d=i??((o=(n=this.getSpec().line)===null||n===void 0?void 0:n.style)===null||o===void 0?void 0:o.curveType),u=d===DEFAULT_SMOOTH_INTERPOLATE?e==="horizontal"?"monotoneY":"monotoneX":d;this.setMarkStyle(l,{curveType:u},"normal",AttributeLevel.Built_In)}this.setMarkStyle(l,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",AttributeLevel.Series)}return l}_getEventElement(e,i=!1){let n=[];return e.dimensionInfo.some(o=>(o.data.some(l=>l.series===this&&(n=l.datum,!0)),!n.length)),n}_dimensionTrigger(e){const i=this._getEventElement(e);switch(e.action){case"enter":this._symbolActiveMark.getDataView().parse(i),this._symbolActiveMark.getData().updateData(!1);break;case"leave":this._symbolActiveMark.getDataView().parse([]),this._symbolActiveMark.getData().updateData(!1)}}initSymbolMark(e,i){const n=this._spec.point||{};if(n.visible!==!1&&(this._symbolMark=this._createMark(lineLikeSeriesMark.point,{groupKey:this._seriesField,isSeriesMark:!!i,stateSort:n.stateSort},Object.assign(Object.assign({},e),{setCustomizedShape:n.customShape,morph:shouldMarkDoMorph(this._spec,lineLikeSeriesMark.point.name),morphElementKey:this.getDimensionField()[0]}))),this._spec.activePoint===!0){const o=new DataView(this._option.dataSet,{name:`${PREFIX}_series_${this.id}_active_point`});o.parse([]),this._symbolActiveMark=this._createMark({name:`active_point_${this.id}`,type:"symbol"},{groupKey:this._seriesField,isSeriesMark:!1,dataView:o,parent:this._region.getInteractionMark(),stateSort:n.stateSort},{setCustomizedShape:n.customShape,morph:!1}),this._symbolActiveMark.setVisible(!1)}return this._symbolMark}initSymbolMarkStyle(){const e=this._symbolMark;if(!e)return this._initSymbolActiveMarkAlone(),e;if(this._initSymbolMark(e),this._symbolActiveMark&&this._symbolMark.stateStyle.dimension_hover){this._symbolActiveMark.setVisible(!0),this.event.on(DimensionEventEnum.dimensionHover,this._dimensionTrigger.bind(this));for(const i in this._symbolMark.stateStyle){this._symbolActiveMark.stateStyle[i]={};for(const n in this._symbolMark.stateStyle[i])n!=="visible"&&(this._symbolActiveMark.stateStyle[i][n]={style:null,level:AttributeLevel.Series,referer:e})}this._symbolActiveMark.state.changeStateInfo({stateValue:STATE_VALUE_ENUM.STATE_DIMENSION_HOVER,filter:()=>!0})}return e}_initSymbolMark(e){e&&(this.setMarkStyle(e,{fill:this.getColorAttribute()},"normal",AttributeLevel.Series),this.setMarkStyle(e,{x:i=>this._invalidType==="zero"||this._getInvalidDefined(i)?this.dataToPositionX(i):Number.NaN,y:i=>this._invalidType==="zero"||this._getInvalidDefined(i)?this.dataToPositionY(i):Number.NaN,z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",AttributeLevel.Series))}_initSymbolActiveMarkAlone(){var e,i;const n=this._symbolActiveMark;n&&(this._initSymbolMark(n),n&&(!((i=(e=this._spec[lineLikeSeriesMark.point.name])===null||e===void 0?void 0:e.state)===null||i===void 0)&&i.dimension_hover)&&(n.setVisible(!0),this.event.on(DimensionEventEnum.dimensionHover,this._dimensionTrigger.bind(this)),this.initMarkStyleWithSpec(n,mergeSpec({},this._spec[lineLikeSeriesMark.point.name],{visible:!0})),this._symbolActiveMark.state.changeStateInfo({stateValue:STATE_VALUE_ENUM.STATE_DIMENSION_HOVER,filter:()=>!0})))}initLabelMarkStyle(e){var i;e&&(((i=e.getTarget())===null||i===void 0?void 0:i.type)!=="symbol"&&e.setRule("line-data"),this.setMarkStyle(e,{fill:this.getColorAttribute(),text:n=>n[this.getStackValueField()],z:this._fieldZ?this.dataToPositionZ.bind(this):null}),this._invalidType!=="zero"&&this.setMarkStyle(e,{visible:this._getInvalidDefined.bind(this)},"normal",AttributeLevel.Series),this.event.on(ChartEvent.viewDataStatisticsUpdate,{filter:n=>n.model===this},()=>{this.encodeDefined(e,"visible")}))}initLineLabelMarkStyle(e){e&&this.setMarkStyle(e,{fill:this.getColorAttribute(),text:i=>i[this.getSeriesField()],z:this._fieldZ?this.dataToPositionZ.bind(this):null})}encodeDefined(e,i){var n,o,l,d;if(!e)return;const u=this._isFieldAllValid();if(this._invalidType==="zero"||u){if(((o=(n=e.stateStyle.normal)===null||n===void 0?void 0:n[i])===null||o===void 0?void 0:o.style)===!0)return;this.setMarkStyle(e,{[i]:!0},"normal",AttributeLevel.Series)}else{if(((d=(l=e.stateStyle.normal)===null||l===void 0?void 0:l[i])===null||d===void 0?void 0:d.style)!==!0)return;this.setMarkStyle(e,{[i]:this._getInvalidDefined.bind(this)},"normal",AttributeLevel.Series)}e.getProduct()&&e.compileEncode()}_isFieldAllValid(){const e=this.getViewDataStatistics(),i=this.getStackValueField();return!!(e&&e.latestData&&i)&&e.latestData[i]&&e.latestData[i].allValid}}const lineSeriesMark=Object.assign(Object.assign({},baseSeriesMark),lineLikeSeriesMark);class BaseLineMark extends BaseMark{setStyle(e,i="normal",n=0,o=this.stateStyle){if(isNil(e))return;o[i]===void 0&&(o[i]={});const l=this._getIgnoreAttributes(),d=["strokeWidth","lineWidth","lineDash","strokeDash","lineJoin","stroke","strokeOpacity","opacity","fill","fillOpacity","texture","texturePadding","textureSize","textureColor"],u=this.isUserLevel(n);let f=!1;Object.keys(e).forEach(g=>{const _=e[g];if(isNil(_)||l.includes(g))return;u&&d.includes(g)&&(isValidScaleType(_==null?void 0:_.type)||_!=null&&_.scale||isFunction(_))&&(f=!0);const y=this._filterAttribute(g,_,i,n,u,o);this.setAttribute(g,y,i,n,o)}),f&&this.setMarkConfig({enableSegments:!0})}}class LineMark extends BaseLineMark{constructor(){super(...arguments),this.type=LineMark.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{lineWidth:1})}_getIgnoreAttributes(){var e,i;return((e=this.model)===null||e===void 0?void 0:e.type)===SeriesTypeEnum.radar&&((i=this.model)===null||i===void 0?void 0:i.coordinate)==="polar"?[]:["fill","fillOpacity"]}}LineMark.type="line";const registerLineMark=()=>{Factory$1.registerMark(LineMark.type,LineMark),registerLineGraphic(),registerVGrammarLineOrAreaAnimation()};class BaseSymbolMark extends BaseMark{_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{size:1,symbolType:"circle",fill:void 0,lineWidth:0})}}class SymbolMark extends BaseSymbolMark{constructor(){super(...arguments),this.type=SymbolMark.type}}SymbolMark.type="symbol";const registerSymbolMark=()=>{Factory$1.registerMark(SymbolMark.type,SymbolMark),registerSymbolGraphic()};class LineLikeSeriesSpecTransformer extends BaseSeriesSpecTransformer{_transformLabelSpec(e){var i,n,o;((i=e.point)===null||i===void 0?void 0:i.visible)!==!1&&((o=(n=e.point)===null||n===void 0?void 0:n.style)===null||o===void 0?void 0:o.visible)!==!1?this._addMarkLabelSpec(e,"point"):this._addMarkLabelSpec(e,"line"),this._addMarkLabelSpec(e,"line","lineLabel","initLineLabelMarkStyle",void 0,!0)}}function isValidAlignDomain(r){return r.length>=2&&isValidNumber(r[0])&&isValidNumber(last(r))&&last(r)>=r[0]}function getScaleInfo(r,e){var i;const n=last(e)-e[0],o=last(e)*e[0]<0;let l=e[0]<=0?0-e[0]:0,d=last(e)>0?last(e)-0:0;n===0?e[0]<0?(l=1,d=0):e[0]>0&&(l=0,d=1):(l/=n,d/=n);const u=r.getDomainSpec(),f={total:n,negative:l,positive:d,includeZero:o,domain:e,extendable_min:!isValidNumber(u.min),extendable_max:!isValidNumber(u.max)};if(!((i=r._break)===null||i===void 0)&&i.scope){const g=e.findIndex(b=>b>=0);let _,y;g===0?(_=r._break.scope[g],y=[e[0],e[1]],f.positive=1,f.negative=0):last(e)<=0?(f.positive=0,f.negative=1,y=[e[e.length-2],e[e.length-1]]):(_=r._break.scope[g-1],y=[e[g-1],e[g]],f.negative=_[0]+(0-y[0])/(y[1]-y[0])*(_[1]-_[0]),f.positive=1-f.negative),f.break=!0,f.extendable_max=!1,f.extendable_min=!1,f.domain=y}return f}function inDifferentCrossZero(r,e){const{positive:i,negative:n,extendable_min:o,extendable_max:l,domain:d}=r,{positive:u,negative:f,extendable_min:g,extendable_max:_,domain:y}=e;if(u>0){if(!g)return!1;let b=n/i;l&&(b=n/Math.max(i,u),d[1]=-d[0]/b),y[0]=-y[1]*b}else if(f>0){if(!_)return!1;let b=i/n;o&&(b=i/Math.max(n,n),d[0]=-d[1]/b),y[1]=-y[0]*b}return!0}function inOnlyZeroDomain(r,e){const{extendable_min:i,extendable_max:n,domain:o}=r,{positive:l,negative:d,domain:u}=e;return(l!==0||d!==0)&&!(l>0&&!n)&&!(d>0&&!i)&&(o[0]=u[0],o[1]=u[1],!0)}function inAllCrossZero(r,e){const{positive:i,negative:n,extendable_max:o,domain:l}=r,{positive:d,negative:u,extendable_min:f,domain:g}=e;if(o&&f){const _=Math.max(n,u)/Math.max(i,d);l[1]=-l[0]/_,g[0]=-g[1]*_}else if(f){const _=n/i;g[0]=-g[1]*_}else{if(!o)return!1;{const _=u/d;l[1]=-l[0]/_}}return!0}function inNoCrossDifferentSide(r,e){const{extendable_min:i,domain:n}=r,{extendable_max:o,domain:l}=e;return!(!i||!o)&&(n[0]=-n[1],l[1]=-l[0],!0)}const zeroAlign=(r,e)=>{var i,n,o,l,d,u;const f=r.getScale(),g=e.getScale();if(!f||!g)return;const _=(o=(n=(i=r).getDomainAfterSpec)===null||n===void 0?void 0:n.call(i))!==null&&o!==void 0?o:[0,1],y=(u=(d=(l=e).getDomainAfterSpec)===null||d===void 0?void 0:d.call(l))!==null&&u!==void 0?u:[0,1];if(!(_&&y&&isValidAlignDomain(_)&&isValidAlignDomain(y)))return;const b=getScaleInfo(r,_),S=getScaleInfo(e,y);if(b.break===!0&&S.break===!0)return;const{positive:v,negative:A,extendable_min:x,extendable_max:T,includeZero:C}=b,{positive:E,negative:P,extendable_min:R,extendable_max:L,includeZero:w}=S;if(v===0&&A===0){if(!inOnlyZeroDomain(b,S))return}else if(E===0&&P===0){if(!inOnlyZeroDomain(S,b))return}else if(C||w)if(C&&!w){if(!inDifferentCrossZero(b,S))return}else if(w&&!C){if(!inDifferentCrossZero(S,b))return}else{if(A===P)return;if(A>P){if(!inAllCrossZero(b,S))return}else if(!inAllCrossZero(S,b))return}else{if(A===0&&E===0){if(!inNoCrossDifferentSide(b,S))return}else if(P===0&&v===0&&!inNoCrossDifferentSide(S,b))return;if(A===0&&P===0)if(_[0]===0&&y[0]>0){if(!R)return;y[0]=0}else{if(!(y[0]===0&&_[0]>0)||!x)return;_[0]=0}if(v===0&&E===0)if(_[1]===0&&y[1]>0){if(!L)return;y[1]=0}else{if(!(y[1]===0&&_[1]>0)||!T)return;_[1]=0}}f.domain(_),g.domain(y)},tickAlign=(r,e)=>{var i,n,o,l,d;if(!r)return r;const u=(i=e==null?void 0:e.targetAxis)===null||i===void 0?void 0:i.call(e);if(!u)return r;const f=(n=e==null?void 0:e.currentAxis)===null||n===void 0?void 0:n.call(e);if(!f)return r;const g=(o=f.getTickData())===null||o===void 0?void 0:o.getDataView();if(!g||!g.transformsArr.find(C=>C.type.includes("ticks")))return r;const _=f.getScale();if(!_)return r;const y=(d=(l=u.getTickData())===null||l===void 0?void 0:l.getDataView())===null||d===void 0?void 0:d.latestData;if(!(y!=null&&y.length))return r;const b=u.getScale();if(!b)return r;const S=b.domain(),v=last(S)-S[0];if(v===0)return r;const A=_.domain(),x=last(A)-A[0];if(v===0)return r;const T=y.map(C=>{const E=(C.value-S[0])/v;return x*E+A[0]});return convertDomainToTickData(T)};class BasePlugin{constructor(e){this.id=createID(),this.name=`${e}_${this.id}`}onAdd(e){this.service=e}release(){this.service=null}}class AxisSyncPlugin extends BasePlugin{constructor(){super(AxisSyncPlugin.type),this.type="AxisSyncPlugin"}_checkEnableSync(e){if(!isContinuous(e.getScale().type))return!1;const i=e.getSpec().sync;return!!(i!=null&&i.axisId)&&i}_getTargetAxis(e,i){const n=e.getOption().getChart().getComponentByUserId(i.axisId);return n!=null&&n.type.startsWith("cartesianAxis")?n:null}onInit(e,i){const n=this._checkEnableSync(i);if(!n||!n.zeroAlign)return;const o=this._getTargetAxis(i,n);o&&i.event.on(ChartEvent.scaleDomainUpdate,{filter:({model:l})=>l.id===i.id||l.id===o.id},()=>{zeroAlign(o,i)})}onDidCompile(e,i){const n=this._checkEnableSync(i);if(!n)return;const o=this._getTargetAxis(i,n);if(o&&n.tickAlign){registerDataSetInstanceTransform(i.getOption().dataSet,"tickAlign",tickAlign);const l={targetAxis:()=>o,currentAxis:()=>i};i.addTransformToTickData({type:"tickAlign",options:l,level:Number.MAX_SAFE_INTEGER},!1)}}}AxisSyncPlugin.pluginType="component",AxisSyncPlugin.type="AxisSyncPlugin";const DEFAULT_TITLE_STYLE={left:{textAlign:"center",textBaseline:"bottom"},right:{textAlign:"center",textBaseline:"bottom"},radius:{},angle:{}};function transformAxisLineStyle(r){return(r=transformComponentStyle(r)).startSymbol=transformComponentStyle(r.startSymbol),r.endSymbol=transformComponentStyle(r.endSymbol),r}function getAxisLabelOffset(r){let e=0;return get(r,"tick.visible")&&(e+=get(r,"tick.tickSize")),get(r,"label.visible")&&(e+=get(r,"label.space")),e}function getLinearAxisSpecDomain(r,e){var i,n,o,l,d,u;return{min:(o=(i=r.min)!==null&&i!==void 0?i:(n=r.range)===null||n===void 0?void 0:n.min)!==null&&o!==void 0?o:e==null?void 0:e.min,max:(u=(l=r.max)!==null&&l!==void 0?l:(d=r.range)===null||d===void 0?void 0:d.max)!==null&&u!==void 0?u:e==null?void 0:e.max}}function isValidCartesianAxis(r){const e=r==null?void 0:r.orient;return e==="top"||e==="bottom"||e==="left"||e==="right"||e==="z"}function isValidPolarAxis(r){const e=r==null?void 0:r.orient;return e==="angle"||e==="radius"}const getCartesianAxisTheme=(r,e,i)=>{var n;const o=(n=e==="band"?getComponentThemeFromOption("axisBand",i):["linear","log","symlog"].includes(e)?getComponentThemeFromOption("axisLinear",i):{})!==null&&n!==void 0?n:{},l=isXAxis(r)?getComponentThemeFromOption("axisX",i):isYAxis(r)?getComponentThemeFromOption("axisY",i):getComponentThemeFromOption("axisZ",i);return mergeSpec({},getComponentThemeFromOption("axis",i),o,l)},getPolarAxisTheme=(r,e,i)=>{var n;const o=(n=e==="band"?getComponentThemeFromOption("axisBand",i):e==="linear"?getComponentThemeFromOption("axisLinear",i):{})!==null&&n!==void 0?n:{},l=getComponentThemeFromOption(r==="angle"?"axisAngle":"axisRadius",i);return mergeSpec({},getComponentThemeFromOption("axis",i),o,l)},isDiscreteAxis=r=>r==="band"||r==="ordinal"||r==="point";function getAxisItem(r,e){return{id:r,label:r,value:e,rawValue:r}}function shouldUpdateAxis(r,e,i){return i||!r||r.getAxisId()===e.getAxisId()}class ComponentPluginService extends BasePluginService{constructor(e){super(),this.component=e}releaseAll(){super.releaseAll(),this.component=null}}function limitTagInBounds(r,e){const{x1:i,y1:n,x2:o,y2:l}=e,{x1:d,y1:u,x2:f,y2:g}=r.AABBBounds,{dx:_=0,dy:y=0}=r.attribute;let b=0,S=0;d<i&&(b=i-d),u<n&&(S=n-u),f>o&&(b=o-f),g>l&&(S=l-g),b&&r.setAttribute("dx",b+_),S&&r.setAttribute("dy",S+y)}function getDatumByValue(r,e,i,n){for(let o=0,l=r.length;o<l;o++){const d=r[o];if(d){const u=d[i],f=d[n||i];if(u<=e&&f>=e)return d}}return null}const getCartesianCrosshairTheme=(r,e)=>{var i,n;const o=array((i=e.axes)!==null&&i!==void 0?i:[]),{bandField:l,linearField:d,xField:u,yField:f}=(n=getComponentThemeFromOption(ComponentTypeEnum.crosshair,r))!==null&&n!==void 0?n:{},g=o.find(S=>isXAxis(S.orient));let _;_=isValid(g)?mergeSpec({},isDiscreteAxis(g.type)?l:d,u):u;const y=o.find(S=>isYAxis(S.orient));let b;return b=isValid(y)?mergeSpec({},isDiscrete(y.type)?l:d,f):f,{xField:_,yField:b}},getPolarCrosshairTheme=(r,e)=>{var i,n;const o=array((i=e.axes)!==null&&i!==void 0?i:[]),{bandField:l,linearField:d,categoryField:u,valueField:f}=(n=getComponentThemeFromOption(ComponentTypeEnum.crosshair,r))!==null&&n!==void 0?n:{},g=o.find(S=>S.orient==="angle");let _;_=isValid(g)?mergeSpec({},isDiscreteAxis(g.type)?l:d,u):u;const y=o.find(S=>S.orient==="radius");let b;return b=isValid(y)?mergeSpec({},isDiscrete(y.type)?l:d,f):f,{categoryField:_,valueField:b}};function getComponentThemeFromGlobalTheme(r,e,i,n){switch(r){case ComponentTypeEnum.cartesianBandAxis:return getCartesianAxisTheme(getOrient(i,["z"]),"band",e);case ComponentTypeEnum.cartesianLinearAxis:return getCartesianAxisTheme(getOrient(i,["z"]),"linear",e);case ComponentTypeEnum.cartesianLogAxis:return getCartesianAxisTheme(getOrient(i,["z"]),"log",e);case ComponentTypeEnum.cartesianSymlogAxis:return getCartesianAxisTheme(getOrient(i,["z"]),"symlog",e);case ComponentTypeEnum.cartesianAxis:case ComponentTypeEnum.cartesianTimeAxis:return getCartesianAxisTheme(getOrient(i),void 0,e);case ComponentTypeEnum.polarBandAxis:return getPolarAxisTheme(i.orient,"band",e);case ComponentTypeEnum.polarLinearAxis:return getPolarAxisTheme(i.orient,"linear",e);case ComponentTypeEnum.polarAxis:return getPolarAxisTheme(i.orient,void 0,e);case ComponentTypeEnum.cartesianCrosshair:return getCartesianCrosshairTheme(e,n);case ComponentTypeEnum.polarCrosshair:return getPolarCrosshairTheme(e,n);case ComponentTypeEnum.colorLegend:case ComponentTypeEnum.sizeLegend:case ComponentTypeEnum.discreteLegend:case ComponentTypeEnum.dataZoom:case ComponentTypeEnum.scrollBar:return getComponentThemeWithDirection(i,getComponentThemeFromOption(r,e));default:return getComponentThemeFromOption(r,e)}}const getComponentThemeWithDirection=(r,e)=>{var i;const n=(i=r.orient)!==null&&i!==void 0?i:e.orient,o=e[getDirectionByOrient(n)],l=mergeSpec({},e,o);return delete l.horizontal,delete l.vertical,l};class BaseComponentSpecTransformer extends BaseModelSpecTransformer{getTheme(e,i){return getComponentThemeFromGlobalTheme(this.type,this._option.getTheme(),e,i)}_mergeThemeToSpec(e,i){const{spec:n,theme:o}=super._mergeThemeToSpec(e,i);return this._adjustPadding(n),{spec:n,theme:o}}_adjustPadding(e){const{padding:i,noOuterPadding:n=!0,orient:o}=e;n&&i&&o&&(e.padding=Object.assign(Object.assign({},normalizeLayoutPaddingSpec(i)),{[o]:0}))}}var __rest$d=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};class BaseComponent extends LayoutModel{static createComponent(e,i){const{spec:n}=e,o=__rest$d(e,["spec"]);return new this(n,Object.assign(Object.assign({},i),o))}getRegions(){return this._regions}created(){super.created(),this.initLayout(),this.pluginService=new ComponentPluginService(this)}constructor(e,i){super(e,i),this.name="component",this.modelType="component",this.transformerConstructor=BaseComponentSpecTransformer,this._delegateEvent=(n,o,l,d=null,u=null)=>{var f,g;o instanceof CustomEvent||this.event.emit(l,{model:this,node:n,event:o,item:d,datum:u,source:Event_Source_Type.chart,chart:(g=(f=this._option)===null||f===void 0?void 0:f.globalInstance)===null||g===void 0?void 0:g.getChart()},"model")},this._option.animation&&(this.animate=new AnimateManager({getCompiler:i.getCompiler}))}initLayout(){var e;super.initLayout(),this._regions=(e=this._regions)!==null&&e!==void 0?e:this._option.getRegionsInIndex(),this._layout&&(this._layout.layoutBindRegionID=this._regions.map(i=>i==null?void 0:i.id))}changeRegions(e){throw new Error("Method not implemented.")}_getNeedClearVRenderComponents(){throw new Error("Method not implemented.")}onRender(e){throw new Error("Method not implemented.")}getVRenderComponents(){return this._getNeedClearVRenderComponents()}callPlugin(e){this.pluginService&&this.pluginService.getAll().forEach(i=>e(i))}getContainer(){var e;return this._container||(this._container=(e=this._option)===null||e===void 0?void 0:e.globalInstance.getStage().find(i=>i.name==="root",!0)),this._container}_compareSpec(e,i){const n=super._compareSpec(e,i);return n.reMake||(n.reMake=["seriesId","seriesIndex","regionId","regionIndex"].some(o=>!isEqual(i==null?void 0:i[o],e[o]))),(i==null?void 0:i.visible)!==e.visible&&(n.reCompile=!0),n}release(){var e;super.release(),this.clear(),(e=this.pluginService)===null||e===void 0||e.releaseAll(),this.pluginService=null}clear(){var e;const i=this._getNeedClearVRenderComponents();i&&i.length&&i.forEach(n=>{var o;n&&((o=this.getContainer())===null||o===void 0||o.removeChild(n),n=null)}),this._container=null,(e=this.pluginService)===null||e===void 0||e.clearAll()}compile(){this.compileMarks(),this.reAppendComponents()}compileMarks(e){this.getMarks().forEach(i=>{i.compile({group:e,context:{model:this}})})}reAppendComponents(){const e=this._getNeedClearVRenderComponents();e&&e.length&&e.forEach(i=>{var n;i&&!i.stage&&((n=this.getContainer())===null||n===void 0||n.appendChild(i))})}getBoundsInRect(e,i){return{x1:0,x2:0,y1:0,y2:0}}getDatum(e){}}BaseComponent.transformerConstructor=BaseComponentSpecTransformer;class ComponentMark extends BaseMark{constructor(e,i){super(e,i),this.type="component",this._componentType=i.componentType,this._mode=i.mode}_initProduct(e){const i=this.getVGrammarView(),n=this.getProductId();this._product=i.mark(GrammarMarkType.component,e??i.rootMark,{componentType:this._componentType,mode:this._mode}).id(n),this._compiledProductId=n}}ComponentMark.type="component";const registerComponentMark=()=>{Factory$1.registerMark(ComponentMark.type,ComponentMark)},scaleParser=r=>r;var __rest$c=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};class AxisComponent extends BaseComponent{getOrient(){return this._orient}getScale(){return this._scale}getScales(){return this._scales}getTickData(e=0){return this._tickData[e]}get visible(){return this._visible}getInverse(){return this._inverse}getCoordinateType(){return this._coordinateType}constructor(e,i){var n;super(e,i),this.specKey="axes",this._scales=[],this._tickData=[],this._visible=!0,this._tick=void 0,this._visible=(n=e.visible)===null||n===void 0||n,this._coordinateType="none"}_getNeedClearVRenderComponents(){return[]}getVRenderComponents(){var e,i,n,o;return[(i=(e=this._axisMark)===null||e===void 0?void 0:e.getProduct())===null||i===void 0?void 0:i.getGroupGraphicItem(),(o=(n=this._gridMark)===null||n===void 0?void 0:n.getProduct())===null||o===void 0?void 0:o.getGroupGraphicItem()].filter(isValid)}created(){var e,i,n,o,l,d,u,f,g,_,y,b,S,v,A,x,T,C;if(super.created(),this.setSeriesAndRegionsFromSpec(),this.initEvent(),this.initScales(),this.updateSeriesScale(),this._shouldComputeTickData()&&this._initData(),this._visible){const E=this._createMark({type:"component",name:`axis-${this.getOrient()}`},{componentType:this.getOrient()==="angle"?"circleAxis":"axis",mode:this._spec.mode,noSeparateStyle:!0},{skipTheme:!0});if(this._axisMark=E,E.setMarkConfig({zIndex:this.layoutZIndex}),isValid(this._spec.id)&&E.setUserId(this._spec.id),E.setMarkConfig({interactive:(e=this._spec.interactive)!==null&&e!==void 0?e:this.getDefaultInteractive()}),this._marks.addMark(E),(i=this._spec.grid)===null||i===void 0?void 0:i.visible){const P=this._createMark({type:"component",name:`axis-${this.getOrient()}-grid`},{componentType:this.getOrient()==="angle"?GridEnum.circleAxisGrid:GridEnum.lineAxisGrid,mode:this._spec.mode,noSeparateStyle:!0},{skipTheme:!0});P.setMarkConfig({zIndex:(u=(l=(o=(n=this._spec.grid)===null||n===void 0?void 0:n.style)===null||o===void 0?void 0:o.zIndex)!==null&&l!==void 0?l:(d=this._spec.grid)===null||d===void 0?void 0:d.zIndex)!==null&&u!==void 0?u:LayoutZIndex.Axis_Grid,interactive:!1}),this._marks.addMark(P),this._gridMark=P}if(this._option.animation!==!1&&get(this._option.getChart().getSpec(),"animation")!==!1&&this._spec.animation===!0){const P=animationConfig((f=Factory$1.getAnimationInKey("axis"))===null||f===void 0?void 0:f(),{appear:(_=(g=this._spec.animationAppear)!==null&&g!==void 0?g:get(this._option.getChart().getSpec(),"animationAppear.axis"))!==null&&_!==void 0?_:get(this._option.getChart().getSpec(),"animationAppear"),disappear:(b=(y=this._spec.animationDisappear)!==null&&y!==void 0?y:get(this._option.getChart().getSpec(),"animationDisappear.axis"))!==null&&b!==void 0?b:get(this._option.getChart().getSpec(),"animationDisappear"),enter:(v=(S=this._spec.animationEnter)!==null&&S!==void 0?S:get(this._option.getChart().getSpec(),"animationEnter.axis"))!==null&&v!==void 0?v:get(this._option.getChart().getSpec(),"animationEnter"),exit:(x=(A=this._spec.animationExit)!==null&&A!==void 0?A:get(this._option.getChart().getSpec(),"animationExit.axis"))!==null&&x!==void 0?x:get(this._option.getChart().getSpec(),"animationExit"),update:(C=(T=this._spec.animationUpdate)!==null&&T!==void 0?T:get(this._option.getChart().getSpec(),"animationUpdate.axis"))!==null&&C!==void 0?C:get(this._option.getChart().getSpec(),"animationUpdate")});P.enter&&(P.update[0].customParameters={enter:P.enter[0]}),this._marks.forEach(R=>R.setAnimationConfig(P))}}}_shouldComputeTickData(){return this.getVisible()||this._spec.forceInitTick}_initData(){const e=this._initTickDataSet(this._tickTransformOption());e.target.addListener("change",this._forceLayout.bind(this)),this._tickData=[new CompilableData(this._option,e)]}collectData(e,i){const n=[];return eachSeries(this._regions,o=>{var l;let d=this.collectSeriesField(e,o);if(d=isArray(d)?isContinuous(this._scale.type)?d:[d[0]]:[d],e||(this._dataFieldText=o.getFieldAlias(d[0])),d){const u=o.getViewData();if(i)d.forEach(f=>{n.push(o.getRawDataStatisticsByField(f,!1))});else if(u&&u.latestData&&u.latestData.length){const f=(l=o.getViewDataStatistics)===null||l===void 0?void 0:l.call(o),g=this.type===ComponentTypeEnum.cartesianLinearAxis&&this._spec.breaks&&this._spec.breaks.length;d.forEach(_=>{var y;!((y=f==null?void 0:f.latestData)===null||y===void 0)&&y[_]&&(g?n.push(Object.assign(Object.assign({},f.latestData[_]),{values:u.latestData.map(b=>b[_])})):n.push(f.latestData[_]))})}}},{userId:this._seriesUserId,specIndex:this._seriesIndex}),n}isSeriesDataEnable(){let e=!0;return eachSeries(this._regions,i=>{var n;isArray((n=i.getViewDataStatistics())===null||n===void 0?void 0:n.latestData)&&(e=!1)},{userId:this._seriesUserId,specIndex:this._seriesIndex}),e}setSeriesAndRegionsFromSpec(){const{seriesId:e,seriesIndex:i,regionId:n,regionIndex:o}=this._spec;isValid(e)&&(this._seriesUserId=array(e)),isValid(n)&&(this._regionUserId=array(n)),isValid(i)&&(this._seriesIndex=array(i)),isValid(o)&&(this._regionIndex=array(o)),this._regions=this._option.getRegionsInUserIdOrIndex(this._regionUserId,this._regionIndex),this.layout.layoutBindRegionID=this._regions.map(l=>l.id)}getBindSeriesFilter(){return{userId:this._seriesUserId,specIndex:this._seriesIndex}}initEvent(){this.event.on(ChartEvent.scaleUpdate,{filter:({model:i})=>(i==null?void 0:i.id)===this.id},this.effect.scaleUpdate.bind(this));const e=getSeries(this._regions,{userId:this._seriesUserId,specIndex:this._seriesIndex}).map(i=>i.getViewDataStatistics()).filter(i=>!!i);e.length>1?this._option.dataSet.multipleDataViewAddListener(e,"change",()=>{this.updateScaleDomain()}):e.length===1&&e[0].target.addListener("change",()=>{this.updateScaleDomain()}),eachSeries(this._regions,i=>{i.event.on(ChartEvent.rawDataUpdate,{filter:({model:n})=>(n==null?void 0:n.id)===i.id},()=>{this._clearRawDomain()})},{userId:this._seriesUserId,specIndex:this._seriesIndex})}updateScaleDomain(){}_clearRawDomain(){}onLayoutEnd(e){this.updateScaleRange(),this.event.emit(ChartEvent.scaleUpdate,{model:this,value:"range"}),super.onLayoutEnd(e)}computeData(e){e!=="force"||this._tickData&&this._tickData.length?!this._tickData||!this._tickData.length||e!=="force"&&isEqual(this._scale.range(),[0,1])||this._tickData.forEach(i=>{i.getDataView().reRunAllTransform(),i.updateData()}):eachSeries(this._regions,i=>{var n;(n=i.getViewData())===null||n===void 0||n.reRunAllTransform()},{userId:this._seriesUserId,specIndex:this._seriesIndex})}initScales(){this._scales=[this._scale];const e=[];if(eachSeries(this._regions,i=>{const n=i.getGroups();n&&e.push(n)},{userId:this._seriesUserId,specIndex:this._seriesIndex}),e.length!==0){const i=maxInArray(e.map(n=>n.fields.length));for(let n=1;n<i;n++){const o=this._scale.clone();this._scales.push(o)}}}_compareSpec(e,i){const n=super._compareSpec(e,i);return n.reMake?n:(n.reRender=!0,(i==null?void 0:i.type)!==(e==null?void 0:e.type)||(i==null?void 0:i.visible)!==(e==null?void 0:e.visible)?(n.reMake=!0,n):(n.reMake=["grid","subGrid","tick","subTick","label","domainLine","title"].some(o=>{var l,d;return((l=i==null?void 0:i[o])===null||l===void 0?void 0:l.visible)!==((d=e==null?void 0:e[o])===null||d===void 0?void 0:d.visible)}),n))}_getAxisAttributes(){const e=this._spec,i={orient:this.getOrient(),select:this._option.disableTriggerEvent!==!0&&e.select,hover:this._option.disableTriggerEvent!==!0&&e.hover};if(e.domainLine&&e.domainLine.visible?i.line=transformAxisLineStyle(e.domainLine):i.line={visible:!1},e.label&&e.label.visible){const n=pickWithout(e.label,["style","formatMethod","state"]);i.label=n,e.label.style&&(i.label.style=isFunction(e.label.style)?(o,l,d,u)=>{var f;const g=e.label.style(o.rawValue,l,o,d,u);return transformToGraphic(mergeSpec({},(f=this._theme.label)===null||f===void 0?void 0:f.style,g))}:transformToGraphic(e.label.style)),(e.label.formatMethod||e.label.formatter)&&(i.label.formatMethod=this._getLabelFormatMethod()),e.label.state&&(i.label.state=transformAxisLabelStateStyle(e.label.state))}else i.label={visible:!1};if(e.tick&&e.tick.visible?(i.tick={visible:e.tick.visible,length:e.tick.tickSize,inside:e.tick.inside,alignWithLabel:e.tick.alignWithLabel,dataFilter:e.tick.dataFilter},e.tick.style&&(i.tick.style=isFunction(e.tick.style)?(n,o,l,d)=>{var u;const f=e.tick.style(n,o,l,d);return transformToGraphic(mergeSpec({},(u=this._theme.tick)===null||u===void 0?void 0:u.style,f))}:transformToGraphic(e.tick.style)),e.tick.state&&(i.tick.state=transformStateStyle(e.tick.state))):i.tick={visible:!1},e.subTick&&e.subTick.visible?(i.subTick={visible:e.subTick.visible,length:e.subTick.tickSize,inside:e.subTick.inside,count:e.subTick.tickCount},e.subTick.style&&(i.subTick.style=isFunction(e.subTick.style)?(n,o,l,d)=>{var u;const f=e.subTick.style(n,o,l,d);return transformToGraphic(mergeSpec({},(u=this._theme.subTick)===null||u===void 0?void 0:u.style,f))}:transformToGraphic(e.subTick.style)),e.subTick.state&&(i.subTick.state=transformStateStyle(e.subTick.state))):i.subTick={visible:!1},e.title&&e.title.visible){const n=e.title,{autoRotate:o,angle:l,style:d={},background:u,state:f,shape:g}=n,_=__rest$c(n,["autoRotate","angle","style","background","state","shape"]);let y,b=l;e.orient!=="left"&&e.orient!=="right"||o&&isNil(b)&&(b=e.orient==="left"?-90:90,y=DEFAULT_TITLE_STYLE[e.orient]),i.title=Object.assign(Object.assign({},_),{autoRotate:!1,angle:b?degreeToRadian(b):null,textStyle:mergeSpec({},y,transformToGraphic(d)),pickable:d.pickable!==!1,childrenPickable:d.pickable!==!1,state:{}}),g&&g.visible?(i.title.shape=Object.assign(Object.assign({},g),{style:transformToGraphic(g.style)}),g.state&&(i.title.state.shape=transformStateStyle(g.state))):i.title.shape={visible:!1},u&&u.visible?(i.title.background=Object.assign(Object.assign({},u),{style:transformToGraphic(u.style)}),u.state&&(i.title.state.background=transformStateStyle(u.state))):i.title.background={visible:!1},f&&(i.title.state.text=transformStateStyle(f))}else i.title={visible:!1};return e.background&&e.background.visible?(i.panel={visible:!0},e.background.style&&(i.panel.style=transformToGraphic(e.background.style)),e.background.state&&(i.panel.state=transformStateStyle(e.background.state))):i.panel={visible:!1},i}_getGridAttributes(){const e=this._spec;return{alternateColor:e.grid.alternateColor,alignWithLabel:e.grid.alignWithLabel,style:isFunction(e.grid.style)?()=>(i,n)=>{var o,l;const d=e.grid.style((o=i.datum)===null||o===void 0?void 0:o.rawValue,n,i.datum);return transformToGraphic(mergeSpec({},(l=this._theme.grid)===null||l===void 0?void 0:l.style,d))}:transformToGraphic(e.grid.style),subGrid:e.subGrid.visible===!1?{visible:!1}:{type:"line",visible:e.subGrid.visible,alternateColor:e.subGrid.alternateColor,style:transformToGraphic(e.subGrid.style)}}}_getLabelFormatMethod(){const{formatMethod:e,formatter:i}=this._spec.label,{formatFunc:n}=getFormatFunction(e,i);return n?(o,l,d)=>n(l.rawValue,l,i):null}_initTickDataSet(e,i=0){registerDataSetInstanceParser(this._option.dataSet,"scale",scaleParser);const n=this.registerTicksTransform();return new DataView(this._option.dataSet,{name:`${this.type}_${this.id}_ticks_${i}`}).parse(this._scales[i],{type:"scale"}).transform({type:n,options:e},!1)}_tickTransformOption(){const e=this._tick||{},i=this._spec.label||{},{tickCount:n,forceTickCount:o,tickStep:l,tickMode:d}=e,{style:u,formatMethod:f,minGap:g}=i;return{sampling:this._spec.sampling!==!1,tickCount:n,forceTickCount:o,tickStep:l,tickMode:d,axisOrientType:this._orient,coordinateType:this._coordinateType,labelStyle:u,labelFormatter:f,labelGap:g}}addTransformToTickData(e,i){this._tickData.forEach(n=>{var o;(o=n==null?void 0:n.getDataView())===null||o===void 0||o.transform(e,i)})}dataToPosition(e){return this._scale.scale(e)}getDatum(e){var i,n;return e&&e.name===AXIS_ELEMENT_NAME.label?e.data:this._axisMark?(n=(i=this._axisMark.getProduct())===null||i===void 0?void 0:i.getGroupGraphicItem())===null||n===void 0?void 0:n.attribute.items:void 0}}AxisComponent.specKey="axes";const registerAxis=()=>{registerComponentMark(),Factory$1.registerAnimation("axis",()=>({appear:{custom:GroupFadeIn},update:{custom:GroupTransition},exit:{custom:GroupFadeOut}}))};var __rest$b=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};const CartesianAxisPlugin=[AxisSyncPlugin];class CartesianAxis extends AxisComponent{getOrient(){return this._orient}getDefaultInteractive(){return!0}set autoIndentOnce(e){this._autoIndentOnce=e}getScales(){return this._scales}constructor(e,i){super(e,i),this.type=ComponentTypeEnum.cartesianAxis,this.name=ComponentTypeEnum.cartesianAxis,this._defaultBandPosition=.5,this._defaultBandInnerPadding=.1,this._defaultBandOuterPadding=.3,this.layoutType="region-relative",this.layoutZIndex=LayoutZIndex.Axis,this.layoutLevel=LayoutLevel.Axis,this._orient="left",this._autoIndentOnce=!1,this._hasAutoIndent=!1,this._scales=[],this._tick=void 0,this._layoutCache={width:0,height:0,_lastComputeOutBounds:{x1:0,x2:0,y1:0,y2:0}},this._innerOffset={top:0,bottom:0,left:0,right:0},this.effect={scaleUpdate:n=>{this.computeData(n==null?void 0:n.value),eachSeries(this._regions,o=>{const l=this.getOrient();isXAxis(l)?shouldUpdateAxis(o.getXAxisHelper(),this.axisHelper(),isValid(this._seriesUserId)||isValid(this._seriesIndex))&&o.setXAxisHelper(this.axisHelper()):isYAxis(l)?shouldUpdateAxis(o.getYAxisHelper(),this.axisHelper(),isValid(this._seriesUserId)||isValid(this._seriesIndex))&&o.setYAxisHelper(this.axisHelper()):isZAxis(l)&&shouldUpdateAxis(o.getZAxisHelper(),this.axisHelper(),isValid(this._seriesUserId)||isValid(this._seriesIndex))&&o.setZAxisHelper(this.axisHelper())},{userId:this._seriesUserId,specIndex:this._seriesIndex})}},this._transformLayoutPosition=n=>{let{x:o,y:l}=n;return isValidNumber(o)&&(o+=+(this._orient==="left")*this.getLayoutRect().width),isValidNumber(l)&&(l+=+(this._orient==="top")*this.getLayoutRect().height),{x:o,y:l}},this._transformLayoutRect=n=>{if(!this._visible)return n;const o=this._latestBounds.clone().translate(-this.getLayoutStartPoint().x,-this.getLayoutStartPoint().y);switch(this._layout.layoutOrient){case"left":this._layout.layoutRectLevelMap.width===DEFAULT_LAYOUT_RECT_LEVEL&&(n.width=o.x1<0?-o.x1:0);break;case"right":this._layout.layoutRectLevelMap.width===DEFAULT_LAYOUT_RECT_LEVEL&&(n.width=o.x2>0?o.x2:0);break;case"top":this._layout.layoutRectLevelMap.height===DEFAULT_LAYOUT_RECT_LEVEL&&(n.height=o.y1<0?-o.y1:0);break;case"bottom":this._layout.layoutRectLevelMap.height===DEFAULT_LAYOUT_RECT_LEVEL&&(n.height=o.y2>0?o.y2:0)}return n.width=Math.ceil(n.width),n.height=Math.ceil(n.height),this._layout.setRectInSpec(this._layoutCacheProcessing(n))},this._updateAxisLayout=()=>{const n=this.getLayoutStartPoint(),o=this._getUpdateAttribute(!1),{grid:l}=o,d=__rest$b(o,["grid"]),u=this._axisMark.getProduct(),f=mergeSpec({x:n.x,y:n.y},this._axisStyle,d);u.encode(f),this._gridMark&&this._gridMark.getProduct().encode(mergeSpec({x:n.x,y:n.y},this._getGridAttributes(),l))},this._fixAxisOnZero=()=>{const{onZero:n,visible:o}=this._spec.domainLine;if(this.visible&&n&&o!==!1){const{onZeroAxisId:l,onZeroAxisIndex:d}=this._spec.domainLine,u=this._option.getComponentsByKey("axes"),f=isXAxis(this.getOrient()),g=y=>{var b;return(f?!isXAxis(y.getOrient()):isXAxis(y.getOrient()))&&isContinuous(y.getScale().type)&&(y.getTickData()?(b=y.getTickData().getLatestData())===null||b===void 0?void 0:b.find(S=>S.value===0):y.getScale().domain()[0]<=0&&last(y.getScale().domain())>=0)},_=u.filter(y=>g(y));if(_.length){let y;if(isValid(l))y=_.find(b=>b.id===l);else if(isValid(d)){const b=u[d];g(b)&&(y=b)}else y=_[0];if(y){const b=this._axisMark.getProduct(),S=y.valueToPosition(0);f?b.encode({line:Object.assign(Object.assign({},this._axisStyle.line),{dy:this._orient==="bottom"?-((y.getInverse()?y.getScale().range()[1]:y.getScale().range()[0])-S):S})}):b.encode({line:Object.assign(Object.assign({},this._axisStyle.line),{dx:this._orient==="left"?S:-((y.getInverse()?y.getScale().range()[0]:y.getScale().range()[1])-S)})})}}}},this._orient=getOrient(e,["z"]),isZAxis(this._orient)&&(this.layoutType="absolute"),this._dataSet=i.dataSet,this._coordinateType="cartesian"}static getSpecInfo(e){const i=e[this.specKey];if(!i)return null;const n=e.direction==="horizontal";if(!isArray(i)){if(!isValidCartesianAxis(i))return null;const{axisType:u,componentName:f}=getCartesianAxisInfo(i,n);return i.type=u,[{spec:i,specPath:[this.specKey],specInfoPath:["component",this.specKey,0],type:f}]}let o=!0;if(i.filter(u=>u.orient==="z")[0]){const u=i.filter(g=>g.orient==="bottom")[0],f=i.filter(g=>isYAxis(g.orient))[0];o=i.length===3&&u&&f}let l=i.map((u,f)=>({spec:u,index:f}));o||(l=l.filter(({spec:u})=>u.orient!=="z"));const d=[];return l.forEach(({spec:u,index:f})=>{if(!isValidCartesianAxis(u))return;const{axisType:g,componentName:_}=getCartesianAxisInfo(u,n);u.type=g,d.push({spec:u,specPath:[this.specKey,f],specInfoPath:["component",this.specKey,f],type:_})}),d}static createComponent(e,i){const{spec:n}=e,o=__rest$b(e,["spec"]),l=Factory$1.getComponentInKey(o.type);return l?new l(n,Object.assign(Object.assign({},i),o)):(i.onError(`Component ${o.type} not found`),null)}initLayout(){super.initLayout(),this._layout.autoIndent=this._spec.autoIndent!==!1,this._layout.layoutOrient=this._orient}setLayout3dBox(e){this.layout3dBox=e}getNewScaleRange(){const{width:e,height:i}=this.getLayoutRect(),{left:n,right:o,top:l,bottom:d}=this._innerOffset;let u=[];return isXAxis(this.getOrient())?isValidNumber(e)&&(u=this._inverse?[e-o,n]:[n,e-o]):isZAxis(this.getOrient())?isValidNumber(e)&&(u=this._inverse?[e-o,n]:[n,e-o],this._scale.range(u)):isValidNumber(i)&&(u=this._inverse?[l,i-d]:[i-d,l]),u}updateScaleRange(){let e=!1;const i=this.getNewScaleRange(),n=this._scale.range();return i.length===n.length&&i.every((o,l)=>o===n[l])?e=!1:(e=!0,this._scale.range(i)),e}init(e){var i;super.init(e),(i=this.pluginService)===null||i===void 0||i.load(CartesianAxisPlugin.map(n=>new n)),this.callPlugin(n=>{this.pluginService&&n.onInit&&n.onInit(this.pluginService,this)})}setAttrFromSpec(){var e;if(super.setAttrFromSpec(),this.visible){isXAxis(this.getOrient())?isUndefined(this._spec.maxHeight)&&(this._spec.maxHeight="30%"):isUndefined(this._spec.maxWidth)&&(this._spec.maxWidth="30%");const n=this._getAxisAttributes();n.label.formatMethod=this._getLabelFormatMethod(),n.verticalFactor=this.getOrient()==="top"||this.getOrient()==="right"?-1:1,this._axisStyle=n}this._tick=this._spec.tick;const i=(e=this._option.getChart())===null||e===void 0?void 0:e.getSpec();this._inverse=transformInverse(this._spec,(i==null?void 0:i.direction)==="horizontal")}onLayoutStart(e,i,n){if(super.onLayoutStart(e,i,n),!isZAxis(this.getOrient())&&this._spec.innerOffset){const o=this._spec;isYAxis(this.getOrient())?["top","bottom"].forEach(l=>{this._innerOffset[l]=calcLayoutNumber(o.innerOffset[l],i.height,i)}):["left","right"].forEach(l=>{this._innerOffset[l]=calcLayoutNumber(o.innerOffset[l],i.width,i)})}}getSeriesStatisticsField(e){let i;return i=isXAxis(this.getOrient())?e.fieldX:isZAxis(this.getOrient())?e.fieldZ:e.fieldY,isContinuous(this._scale.type)?i:[i[0]]}_tickTransformOption(){var e,i,n,o;return Object.assign(Object.assign({},super._tickTransformOption()),{noDecimals:(e=this._tick)===null||e===void 0?void 0:e.noDecimals,labelLastVisible:(i=this._spec.label)===null||i===void 0?void 0:i.lastVisible,labelFirstVisible:(n=this._spec.label)===null||n===void 0?void 0:n.firstVisible,labelFlush:(o=this._spec.label)===null||o===void 0?void 0:o.flush})}axisHelper(){return{isContinuous:isContinuous(this._scale.type),dataToPosition:this.dataToPosition.bind(this),getScale:(e=0)=>this._scales[e],getAxisType:()=>this.type,getAxisId:()=>this.id,isInverse:()=>this._inverse===!0,getSpec:()=>this._spec}}afterCompile(){var e;const i=(e=this._axisMark)===null||e===void 0?void 0:e.getProduct();i&&i.addEventListener(HOOK_EVENT.AFTER_ELEMENT_ENCODE,()=>{if(this._isLayout===!1&&(isXAxis(this.getOrient())?this.callPlugin(n=>{this.pluginService&&n.onDidLayoutHorizontal&&n.onDidLayoutHorizontal(this.pluginService,this)}):this.callPlugin(n=>{this.pluginService&&n.onDidLayoutVertical&&n.onDidLayoutVertical(this.pluginService,this)}),this._unitText)){const{x:n,y:o}=this.getLayoutStartPoint(),l=isXAxis(this._orient)?{x:maxInArray(this._scale.range())+n,y:o}:{x:n,y:minInArray(this._scale.range())+o};this._unitText.setAttributes(l)}}),this.callPlugin(n=>{this.pluginService&&n.onDidCompile&&n.onDidCompile(this.pluginService,this)})}onRender(e){}changeRegions(e){}update(e){}resize(e){}collectScale(){const e=[];return eachSeries(this._regions,i=>{e.push(this.getOrient()==="left"||this.getOrient()==="right"?i.scaleY:i.scaleX)},{userId:this._seriesUserId,specIndex:this._seriesIndex}),e}collectSeriesField(e,i){var n,o;let l;return l=e>0?(o=(n=i.getGroups())===null||n===void 0?void 0:n.fields)===null||o===void 0?void 0:o[e]:isXAxis(this.getOrient())?i.getSpec().x2Field?[...i.fieldX,i.fieldX2]:i.fieldX:isZAxis(this.getOrient())?i.fieldZ:i.getSpec().y2Field?[...i.fieldY,i.fieldY2]:i.fieldY,l}updateSeriesScale(){const e=this.getOrient();eachSeries(this._regions,i=>{isXAxis(e)?shouldUpdateAxis(i.getXAxisHelper(),this.axisHelper(),isValid(this._seriesUserId)||isValid(this._seriesIndex))&&(i.setScaleX(this._scale),i.setXAxisHelper(this.axisHelper())):isYAxis(e)?shouldUpdateAxis(i.getYAxisHelper(),this.axisHelper(),isValid(this._seriesUserId)||isValid(this._seriesIndex))&&(i.setScaleY(this._scale),i.setYAxisHelper(this.axisHelper())):isZAxis(e)&&shouldUpdateAxis(i.getZAxisHelper(),this.axisHelper(),isValid(this._seriesUserId)||isValid(this._seriesIndex))&&(i.setScaleZ(this._scale),i.setZAxisHelper(this.axisHelper()))},{userId:this._seriesUserId,specIndex:this._seriesIndex})}getBoundsInRect(e){var i;let n={x1:0,y1:0,x2:0,y2:0};if(!this._visible)return n;this._verticalLimitSize=isXAxis(this.getOrient())?e.height:e.width,this.setLayoutRect(e),!this.updateScaleRange()&&isArray((i=this.getTickData())===null||i===void 0?void 0:i.getLatestData())||this.computeData("range");const o={skipLayout:!1},l=isXAxis(this.getOrient());this.pluginService&&(l?this.callPlugin(f=>{f.onWillLayoutHorizontal&&f.onWillLayoutHorizontal(this.pluginService,o,this)}):this.callPlugin(f=>{f.onWillLayoutVertical&&f.onWillLayoutVertical(this.pluginService,o,this)}));const d=this._axisMark.getProduct();let u=!1;if(!o.skipLayout){const f=this._getUpdateAttribute(!0),g=d.getGroupGraphicItem(),_=mergeSpec(Object.assign({},this.getLayoutStartPoint()),this._axisStyle,f,{line:{visible:!1}});let y=g.getBoundsWithoutRender(_);y.empty()&&(y=new Bounds().set(_.x,_.y,_.x,_.y)),u=!0,this._latestBounds=y,n=this._appendAxisUnit(y,l)}return u||(this._latestBounds=d.getBounds()),n}positionToData(e,i){const n=isXAxis(this.getOrient());i&&(e-=n?this.getLayoutStartPoint().x:this.getLayoutStartPoint().y),this._innerOffset&&(e=n?clamp(e,this._innerOffset.left,this.getLayoutRect().width-this._innerOffset.right):clamp(e,this._innerOffset.top,this.getLayoutRect().height-this._innerOffset.bottom));const o=this._scale.range();return(e-o[0])*(e-last(o))>0?null:this._scale.invert(e)}_getTitleLimit(e){var i,n,o,l,d;const u=this._spec.title;if(u.visible&&isNil((i=u.style)===null||i===void 0?void 0:i.maxLineWidth)){const f=(d=(o=(n=this._axisStyle.title)===null||n===void 0?void 0:n.angle)!==null&&o!==void 0?o:(l=u.style)===null||l===void 0?void 0:l.angle)!==null&&d!==void 0?d:0;if(e){const y=this.getLayoutRect().width,b=Math.abs(Math.cos(f));return b<1e-6?1/0:y/b}const g=this.getLayoutRect().height,_=Math.abs(Math.sin(f));return _<1e-6?1/0:g/_}return null}_getUpdateAttribute(e){var i;let n=0,o=0;if(!e){const x=this.getRegions();let{x:T,y:C}=x[0].getLayoutStartPoint(),E=T+x[0].getLayoutRect().width,P=C+x[0].getLayoutRect().height;for(let R=1;R<x.length;R++){const L=x[R],{x:w,y:B}=L.getLayoutStartPoint(),{width:I,height:D}=L.getLayoutRect();T=Math.min(T,w),E=Math.max(E,I+w),C=Math.min(C,B),P=Math.max(P,D+B)}n=Math.abs(P-C),o=Math.abs(E-T)}const{width:l,height:d}=this.getLayoutRect(),u=isXAxis(this._orient),f=isYAxis(this._orient),g=isZAxis(this._orient),_=this.layout3dBox?this.layout3dBox.length:0;let y={x:0,y:0},b=n,S=l;u?y={x:l,y:0}:f?(y={x:0,y:d},b=o,S=d):g&&(y={x:_,y:0});const v=this.getLabelItems(S),A={start:{x:0,y:0},end:y,title:{text:this._spec.title.text||this._dataFieldText,maxWidth:this._getTitleLimit(u)},items:v};if(e||(A.grid={type:"line",start:{x:0,y:0},end:y,items:v[0],verticalFactor:this._axisStyle.verticalFactor,depth:_,length:b}),g){const x=(i=this.directionStr)!==null&&i!==void 0?i:"r2l",T=this.layout3dBox?this.layout3dBox.width:0;let C=[0,0],E=-Math.PI/2,P=0;x==="l2r"&&(P=this.layout3dBox.length,C=[0,0,0],E=Math.PI/2),A.z=P,A.alpha=E,A.anchor3d=C,e||(A.grid.depth=T)}else{let x=u?this.layout.minHeight:this.layout.minWidth;(u&&this._layout.layoutRectLevelMap.height===USER_LAYOUT_RECT_LEVEL||f&&this._layout.layoutRectLevelMap.width===USER_LAYOUT_RECT_LEVEL)&&(x=this._verticalLimitSize),A.verticalLimitSize=this._verticalLimitSize,A.verticalMinSize=x,A.label={overflowLimitLength:this._getLabelOverflowLimit(u)}}return A}getLabelItems(e){var i;const n=(i=this.getTickData())===null||i===void 0?void 0:i.getLatestData();return n&&n.length?[n.map(o=>{const l=this._getNormalizedValue([o.value],e);return getAxisItem(o.value,l)}).filter(o=>{const{value:l,rawValue:d}=o,u=this._scale.domain();return this.getSpec().type==="log"?l>=0&&l<=1:isContinuous(this._scale.type)?d>=u[0]&&d<=last(u):u.includes(d)})]:[]}initEvent(){super.initEvent(),this.visible&&(this.event.on(ChartEvent.layoutEnd,this._updateAxisLayout),this.event.on(ChartEvent.layoutEnd,this._fixAxisOnZero),this.event.on(ChartEvent.layoutRectUpdate,()=>{this._clearLayoutCache()}))}_getNormalizedValue(e,i){return i===0?0:this.dataToPosition(e)/i}_layoutCacheProcessing(e){return["width","height"].forEach(i=>{e[i]<this._layoutCache[i]?e[i]=this._layoutCache[i]:this._layoutCache[i]=e[i]}),this._autoIndentOnce&&this._hasAutoIndent?["x1","x2","y1","y2"].forEach(i=>{this.layout.getLastComputeOutBounds()[i]=this._layoutCache._lastComputeOutBounds[i]}):(this._hasAutoIndent=!0,["x1","x2","y1","y2"].forEach(i=>{this.layout.getLastComputeOutBounds()[i]<this._layoutCache._lastComputeOutBounds[i]?this.layout.getLastComputeOutBounds()[i]=this._layoutCache._lastComputeOutBounds[i]:this._layoutCache._lastComputeOutBounds[i]=this.layout.getLastComputeOutBounds()[i]})),e}_clearLayoutCache(){this._hasAutoIndent=!1,this._layoutCache.width=0,this._layoutCache.height=0,this._layoutCache._lastComputeOutBounds={x1:0,x2:0,y1:0,y2:0}}onDataUpdate(){this._clearLayoutCache()}_appendAxisUnit(e,i){var n;if(this._spec.unit&&this._spec.unit.visible){const{text:o,style:l}=this._spec.unit;let d,u;const{x:f,y:g}=this.getLayoutStartPoint();i?(d={x:maxInArray(this._scale.range())+f,y:g},u={textAlign:"left",textBaseline:"middle"}):(d={x:f,y:minInArray(this._scale.range())+g},u={textAlign:this._orient==="left"?"left":"right",textBaseline:"bottom"}),u=Object.assign(Object.assign(Object.assign({},u),l),{x:d.x,y:d.y,text:o}),this._unitText?this._unitText.setAttributes(u):(this._unitText=createText(u),this._unitText.name="axis-unit",(n=this.getContainer())===null||n===void 0||n.add(this._unitText));const _=this._unitText.AABBBounds;i?(e.x2+=_.x2>e.x2?_.x2-e.x2:0,e.y2+=_.y2>e.y2?_.y2-e.y2:0):(e.x1+=_.x1<e.x1?_.x1-e.x1:0,e.y1+=_.y1<e.y1?_.y1-e.y1:0)}return e}_getNeedClearVRenderComponents(){return this._unitText?[this._unitText]:[]}_getLabelOverflowLimit(e){var i,n;if(e&&((i=this._spec.label)===null||i===void 0?void 0:i.visible)!==!1&&((n=this._spec.label)===null||n===void 0?void 0:n.autoLimit)===!0){const o=this._option.getComponentsByKey("axes"),l=this.getRegions(),d=o.filter(y=>{const b=y.getOrient();return(b==="left"||b==="right")&&y.getRegions().some(S=>l.includes(S))});let u=0,f=0;const g=this.getLayoutStartPoint().x,_=g+this.getLayoutRect().width;return d.forEach(y=>{const b=y.getLayoutStartPoint().x;if(y.getOrient()==="left"&&b===g){const S=y.getLayoutRect().width;u=Math.max(u,S)}else if(b===_){const S=y.getLayoutRect().width;f=Math.max(f,S)}}),{left:u,right:f}}}}CartesianAxis.type=ComponentTypeEnum.cartesianAxis,CartesianAxis.specKey="axes";const setDomain=(r,e,i)=>i.reduce((n,o,l)=>(n.push([o,i.length===l+1?e:i[l+1]]),n),[[r,i[0]]]);function breakDomain(r,e){const i=r[0],n=r[r.length-1],o=e.filter(l=>l>i&&l<n);return o.length===0?[[i,n]]:setDomain(i,n,o)}const sorter=(r,e)=>r-e,fillBins=(r,e)=>{const i=[{count:0,sub:[],max:e[0],min:e[0]}];let n=0,o=0;for(;n<e.length;)r[o]<=e[n]?(i[n].count+=1,i[n].sub.push(r[o]),o+=1):(n+=1,i[n]={count:0,sub:[],max:e[n],min:e[n]});i.forEach(d=>{d.count&&(d.min=Math.min.apply(null,d.sub))});const l=r.slice(o);return i[n]={count:l.length,sub:l,min:e[e.length-1],max:Math.max.apply(null,l)},i};function breakScope(r,e,i="count"){const n=fillBins(r,e),o=i==="count"?r.length:n.reduce((f,g,_)=>g.count>0?f+g.max-g.min:f,0),l=[];let d=0,u=0;return n.forEach((f,g)=>{if(o===0)l.push([0,g/n.length-1]);else{const _=i==="count"?f.count:f.max-f.min,y=l[u-1]?l[u-1][1]:0,b=g===n.length-1?1:Math.min((d+_)/o,1);(y!==b||y!==0&&y!==1)&&(u+=1,l.push([y,b]),d+=_)}}),l}function breakData(r,e,i){return r.sort(sorter),e.sort(sorter),{domain:breakDomain(r,e),scope:breakScope(r,e,i)}}const e10=Math.sqrt(50),e5=Math.sqrt(10),e2=Math.sqrt(2);class LinearAxisMixin{constructor(){this._extend={},this.niceLabelFormatter=null}setExtraAttrFromSpec(){isValid(this._spec.nice)&&(this._nice=this._spec.nice),isValid(this._spec.zero)&&(this._zero=this._spec.zero),this._expand=this._spec.expand,this._domain=getLinearAxisSpecDomain(this._spec)}transformScaleDomain(){this.setScaleNice()}setLinearScaleNice(){var e;if(!this._nice)return!1;let i=5;const n=this._spec.tick||{};if(isValidNumber(n.forceTickCount))i=n.forceTickCount;else if(isFunction(n.tickCount)){const d=this._scale.range();let u=Math.abs(last(d)-d[0]);u===1&&this._option&&(u=isXAxis(this._orient)?this._option.getChartViewRect().width:this._option.getChartViewRect().height),i=n.tickCount({axisLength:u,labelStyle:this._spec.label&&this._spec.label.style})}else i=isValidNumber(n.tickCount)?n.tickCount:5;this._spec.niceType==="accurateFirst"&&(i=Math.max(5,i));const{min:o,max:l}=(e=this._domain)!==null&&e!==void 0?e:{};return isNil(o)&&isNil(l)&&isNil(this._softMaxValue)&&isNil(this._softMinValue)?this._scale.nice(i):(isValid(o)||isValid(this._softMinValue))&&isNil(l)&&isNil(this._softMaxValue)?this._scale.niceMax(i):!(!isNil(o)||!isNil(this._softMinValue)||!isValid(l)&&!isValid(this._softMaxValue))&&this._scale.niceMin(i)}setLogScaleNice(){var e;if(!this._nice)return!1;const{min:i,max:n}=(e=this._domain)!==null&&e!==void 0?e:{};return isNil(i)&&isNil(n)&&isNil(this._softMaxValue)&&isNil(this._softMinValue)?this._scale.nice():(isValid(i)||isValid(this._softMinValue))&&isNil(n)&&isNil(this._softMaxValue)?this._scale.niceMax():!(!isNil(i)||!isNil(this._softMinValue)||!isValid(n)&&!isValid(this._softMaxValue))&&this._scale.niceMin()}setScaleNice(){return this._spec.type==="log"?this.setLogScaleNice():this.setLinearScaleNice()}dataToPosition(e,i){return this.valueToPosition(e[0])}valueToPosition(e){return this._scale.scale(e)}computeLinearDomain(e){let i=[];if(e.length){const n=this._spec.breaks&&this._spec.breaks.length;let o,l,d=[];if(e.forEach(u=>{const{min:f,max:g}=u;o=o===void 0?f:Math.min(o,f),l=l===void 0?g:Math.max(l,g),n&&(d=d.concat(u.values))}),n){const u=[],f=[],g=isNil(this._domain.max)?l:this._domain.max;for(let _=0;_<this._spec.breaks.length;_++){const{range:y}=this._spec.breaks[_];y[0]<=y[1]&&y[1]<=g&&(u.push(y),f.push(this._spec.breaks[_]))}if(u.sort((_,y)=>_[0]-y[0]),u.length){const{domain:_,scope:y}=breakData(d,combineDomains(u),this._spec.breaks[0].scopeType);i=combineDomains(_),this._break={domain:_,scope:y,breakDomains:u,breaks:f}}else i=[o,l]}else i=[o,l]}else i[0]=0,i[1]=0;return this.setSoftDomainMinMax(i),this.expandDomain(i),this.includeZero(i),this.setDomainMinMax(i),i}expandDomain(e){if(!this._expand)return;let i=e[0],n=last(e);i===n&&(n===0?n=1:n>0?i=0:n<0&&(n=0)),isValid(this._expand.min)&&(e[0]=i-(n-i)*this._expand.min),isValid(this._expand.max)&&(e[e.length-1]=n+(n-i)*this._expand.max)}niceDomain(e){const{min:i,max:n}=getLinearAxisSpecDomain(this._spec);if(isValid(i)||isValid(n)||this._spec.type!=="linear")return e;if(Math.abs(minInArray(e)-maxInArray(e))<=1e-12){let o=e[0];const l=o>=0?1:-1;if(o=Math.abs(o),o<1)e[0]=0,e[e.length-1]=1;else{let d=o/5;const u=Math.floor(Math.log(d)/Math.LN10),f=d/Math.pow(10,u);d=(f>=e10?10:f>=e5?5:f>=e2?2:1)*Math.pow(10,u),e[0]=0,e[e.length-1]=10*d}l<0&&(e.reverse(),e[0]*=-1,e[e.length-1]*=-1)}return e}includeZero(e){this._zero&&(e[0]=Math.min(e[0],0),e[e.length-1]=Math.max(last(e),0))}setExtendDomain(e,i){if(i===void 0)return void delete this._extend[e];this._extend[e]=i;const n=this._scale.domain();this.extendDomain(n),this.includeZero(n),this.setDomainMinMax(n),this.niceDomain(n),this._scale.domain(n,this._nice),this._nice&&!this.setScaleNice()&&this._scale.rescale(),this.event.emit(ChartEvent.scaleUpdate,{model:this,value:"domain"})}extendDomain(e){let i;const n=e.length-1,o=e[0]-e[n]>0,l=o?n:0,d=o?0:n;for(const u in this._extend)i=this._extend[u],i>e[d]&&(e[d]=i),i<e[l]&&(e[l]=i)}getDomainSpec(){return this._domain}setDomainMinMax(e){if(!this._domain)return;const{min:i,max:n}=this._domain;isValid(i)&&(e[0]=i),isValid(n)&&(e[e.length-1]=n)}setSoftDomainMinMax(e){const{softMin:i,softMax:n}=this._spec;if(isValid(i)){let o=isFunction(i)?i(e):i;isNil(o)&&(o=e[0]),o<=e[0]&&(e[0]=o,this._softMinValue=o)}if(isValid(n)){let o=isFunction(n)?n(e):n;isNil(o)&&(o=last(e)),o>=last(e)&&(e[e.length-1]=o),this._softMaxValue=o}}setZero(e){this._zero!==e&&(this._zero=e,this.updateScaleDomain())}updateScaleDomain(){if(!this.isSeriesDataEnable())return;const e=this.collectData(),i=this.computeLinearDomain(e);this.updateScaleDomainByModel(i)}updateScaleDomainByModel(e){e=e??this._scale.domain(),this.extendDomain(e),this.includeZero(e),this.setDomainMinMax(e),this.niceDomain(e),this._scale.domain(e,this._nice),this._nice&&!this.setScaleNice()&&this._scale.rescale(),this._updateNiceLabelFormatter(e),this._domainAfterSpec=this._scale.domain(),this.event.emit(ChartEvent.scaleDomainUpdate,{model:this}),this.event.emit(ChartEvent.scaleUpdate,{model:this,value:"domain"})}getDomainAfterSpec(){return this._domainAfterSpec}_updateNiceLabelFormatter(e){const i=Math.abs(last(e)-e[0]),n=Math.max(-Math.floor(Math.log10(i)),0)+2,o=Math.pow(10,n);this.niceLabelFormatter=l=>isValidNumber(+l)?Math.round(+l*o)/o:l}}class CartesianLinearAxis extends CartesianAxis{constructor(){super(...arguments),this.type=ComponentTypeEnum.cartesianLinearAxis,this._zero=!0,this._nice=!0,this._extend={},this._scale=new LinearScale}setAttrFromSpec(){var e,i;super.setAttrFromSpec(),this.setExtraAttrFromSpec();const n=(i=(e=this._tickData)===null||e===void 0?void 0:e[0])===null||i===void 0?void 0:i.getDataView().transformsArr.find(o=>o.type===this.registerTicksTransform());n&&(n.options=this._tickTransformOption())}initScales(){var e,i;super.initScales();const n=[0,1];isValid((e=this._domain)===null||e===void 0?void 0:e.min)&&(n[0]=this._domain.min),isValid((i=this._domain)===null||i===void 0?void 0:i.max)&&(n[1]=this._domain.max),this._scale.domain(n)}_tickTransformOption(){var e;return Object.assign(Object.assign({},super._tickTransformOption()),{breakData:!((e=this._spec.breaks)===null||e===void 0)&&e.length?()=>this._break:null})}_getUpdateAttribute(e){var i,n;const o=super._getUpdateAttribute(e);if(!isZAxis(this._orient)&&(!((n=(i=this._break)===null||i===void 0?void 0:i.breaks)===null||n===void 0)&&n.length)){const{width:l,height:d}=this.getLayoutRect(),u=isXAxis(this._orient),f=u?l:d;o.breaks=this._break.breaks.map(g=>{const{range:_,breakSymbol:y,gap:b=6}=g,S=this.valueToPosition((_[0]+_[1])/2)/f;let v;v=isPercent(b)?Number(b.substring(0,b.length-1))/100:b/f;const A=isValidNumber(y==null?void 0:y.angle)?y.angle:u?60:15;return{range:[S-v/2,S+v/2],breakSymbol:Object.assign(Object.assign({visible:!0},y),{angle:A*Math.PI/180}),rawRange:_}})}return o}getNewScaleRange(){var e,i;let n=super.getNewScaleRange();return!((e=this._spec.breaks)===null||e===void 0)&&e.length&&(!((i=this._break)===null||i===void 0)&&i.scope)&&(n=combineDomains(this._break.scope).map(o=>n[0]+(last(n)-n[0])*o)),n}computeDomain(e){return this.computeLinearDomain(e)}axisHelper(){const e=super.axisHelper();return e.setExtendDomain=this.setExtendDomain.bind(this),e.valueToPosition=this.valueToPosition.bind(this),e}registerTicksTransform(){const e=`${this.type}-ticks`;return registerDataSetInstanceTransform(this._option.dataSet,e,continuousTicks),e}}CartesianLinearAxis.type=ComponentTypeEnum.cartesianLinearAxis,CartesianLinearAxis.specKey="axes",mixin(CartesianLinearAxis,LinearAxisMixin);const registerCartesianLinearAxis=()=>{registerLineAxis(),registerLineGrid(),registerAxis(),Factory$1.registerComponent(CartesianLinearAxis.type,CartesianLinearAxis)};class BandAxisMixin{constructor(){this._rawDomainIndex=[]}_initData(){var e;if(this._spec.showAllGroupLayers&&this._scales.length>1)for(let i=0;i<this._scales.length;i++){const n=((e=this._spec.layers)!==null&&e!==void 0?e:[])[this._scales.length-1-i]||{};if(n.visible!==!1&&n.tickCount!==0&&n.forceTickCount!==0){const o=this._initTickDataSet(Object.assign(Object.assign({},this._tickTransformOption()),n),i);o.target.addListener("change",this._forceLayout.bind(this));const l=new CompilableData(this._option,o);this._tickData.push(l),this._tickDataMap||(this._tickDataMap={}),this._tickDataMap[i]=l}}else{const i=this._initTickDataSet(this._tickTransformOption());i.target.addListener("change",this._forceLayout.bind(this));const n=new CompilableData(this._option,i);this._tickData=[n],this._tickDataMap={0:n}}}dataToPosition(e,i={}){var n,o;if(e.length===0||this._scales.length===0)return 0;const{position:l,bandScale:d}=this.getPosition(e);return l+d.bandwidth()*((o=(n=i.bandPosition)!==null&&n!==void 0?n:this._spec.bandPosition)!==null&&o!==void 0?o:this._defaultBandPosition)}valueToPosition(e){return this._scale.scale(e)}updateGroupScaleRange(){let e=this._scale;this._scales.forEach((i,n)=>{n>0&&(i.range([0,e.bandwidth()]),e=i)})}getPosition(e){let i=0,n=this._scale;if(this._scales.length===1||e.length===1)i=this.valueToPosition(e[0]);else{const o=Math.min(e.length,this._scales.length);for(let l=0;l<o;l++)i+=this._scales[l].scale(e[l]);n=this._scales[o-1]}return{position:i,bandScale:n}}calcScales(e,i){var n,o;const{bandPadding:l,paddingInner:d,paddingOuter:u}=this._spec,f=isArray(l),g=isArray(d),_=isArray(u);for(let y=0;y<this._scales.length;y++){const b=f?l[y]:l,S=g?d[y]:d,v=_?u[y]:u;this._scales[y].paddingInner((n=S??b)!==null&&n!==void 0?n:e,!0).paddingOuter((o=v??b)!==null&&o!==void 0?o:i,!0)}}computeBandDomain(e){if(!e.length)return[];if(e.length===1)return e[0].values;const i=new Set;for(let n=0;n<e.length;n++)for(let o=0;o<e[n].values.length;o++)i.add(e[n].values[o]);return Array.from(i)}updateScaleDomain(){var e;if(!this.isSeriesDataEnable())return;!(!((e=this._rawDomainIndex)===null||e===void 0)&&e.length)&&this._scales.length&&this._updateRawDomain();const i=this._spec.domain;for(let n=0;n<this._scales.length;n++)if(i&&i.length&&n===0)this._scales[n].domain(i);else{const o=this.collectData(n),l=this.computeBandDomain(o);this._scales[n].domain(l.sort((d,u)=>this._rawDomainIndex[n][d]-this._rawDomainIndex[n][u]))}this.transformScaleDomain(),this.event.emit(ChartEvent.scaleDomainUpdate,{model:this}),this.event.emit(ChartEvent.scaleUpdate,{model:this,value:"domain"})}getLabelItems(e){const i=[];let n=[];return this._scales.forEach((o,l)=>{var d;const u=this._tickDataMap[l],f=(d=u==null?void 0:u.getLatestData())===null||d===void 0?void 0:d.length,g=f?u.getLatestData().map(_=>_.value):o.domain();if(g&&g.length)if(n&&n.length){const _=[],y=[];n.forEach(b=>{g.forEach(S=>{const v=array(b).concat(S);if(y.push(v),f){const A=getAxisItem(S,this._getNormalizedValue(v,e));_.push(A)}})}),f&&i.push(_.filter(b=>b.value>=0&&b.value<=1)),n=y}else g.forEach(_=>{n.push(_)}),f&&i.push(u.getLatestData().map(_=>getAxisItem(_.value,this._getNormalizedValue([_.value],e))).filter(_=>_.value>=0&&_.value<=1))}),i.reverse()}_updateRawDomain(){this._rawDomainIndex=[];const e=this._spec.domain;for(let i=0;i<this._scales.length;i++)if(e&&e.length&&i===0)this._scales[i].domain(e);else{const n=this.collectData(i,!0),o=this.computeBandDomain(n);this._rawDomainIndex[i]={},o.forEach((l,d)=>this._rawDomainIndex[i][l]=d)}}_clearRawDomain(){this._rawDomainIndex=[]}}class CartesianBandAxis extends CartesianAxis{constructor(){super(...arguments),this.type=ComponentTypeEnum.cartesianBandAxis,this._scale=new BandScale}computeDomain(e){return this.computeBandDomain(e)}updateScaleRange(){const e=super.updateScaleRange();return this.updateGroupScaleRange(),e}initScales(){super.initScales(),this.calcScales(this._defaultBandInnerPadding,this._defaultBandOuterPadding)}axisHelper(){const e=(i=0)=>this._scales[i];return{isContinuous:!1,dataToPosition:this.dataToPosition.bind(this),getScale:e,getBandwidth:(i=0)=>e(i).bandwidth(),getAxisType:()=>this.type,getAxisId:()=>this.id,isInverse:()=>this._inverse,getSpec:()=>this._spec}}registerTicksTransform(){const e=`${this.type}-ticks`;return registerDataSetInstanceTransform(this._option.dataSet,e,linearDiscreteTicks),e}transformScaleDomain(){this.updateFixedWholeLength()}updateFixedWholeLength(){if(this._scale){const{bandSize:e,maxBandSize:i,minBandSize:n}=this._getOuterBandSizeFromSpec();if(e&&this._scale.bandwidth(e),i&&this._scale.maxBandwidth(i),n&&this._scale.minBandwidth(n),this._scale.isBandwidthFixed()&&this._spec.autoRegionSize&&(e||i)){const o=scaleWholeRangeSize(this._scale.domain().length,e??i,this._scale.paddingInner(),this._scale.paddingOuter());["bottom","top"].includes(this._orient)?this._regions.forEach(l=>l.setMaxWidth(o)):["left","right"].includes(this._orient)&&this._regions.forEach(l=>l.setMaxHeight(o))}}}_getOuterBandSizeFromSpec(){var e;let{bandSize:i,maxBandSize:n,minBandSize:o,bandSizeLevel:l=0}=this._spec;const{gap:d,extend:u=0}=(e=this._spec.bandSizeExtend)!==null&&e!==void 0?e:{};l=Math.min(l,this._scales.length-1);for(let f=l;f>0;f--){const g=this._scales[f],_=g.domain(),y=g.paddingInner(),b=g.paddingOuter(),S=v=>{const A=f===l?u:0;return isNil(d)||f<l?scaleWholeRangeSize(_.length,v,y,b)+A:(v+(isString(d)?v*(Number(d.substring(0,d.length-1))/100):d))*_.length/(this._scales[f-1].paddingInner()+1)+A};isValid(i)&&(i=S(i)),isValid(n)&&(n=S(n)),isValid(o)&&(o=S(o))}return{bandSize:i,maxBandSize:n,minBandSize:o}}}CartesianBandAxis.type=ComponentTypeEnum.cartesianBandAxis,CartesianBandAxis.specKey="axes",mixin(CartesianBandAxis,BandAxisMixin);const registerCartesianBandAxis=()=>{registerLineAxis(),registerLineGrid(),registerAxis(),Factory$1.registerComponent(CartesianBandAxis.type,CartesianBandAxis)};class CartesianTimeAxis extends CartesianLinearAxis{constructor(){super(...arguments),this.type=ComponentTypeEnum.cartesianTimeAxis,this._zero=!1,this.effect={scaleUpdate:e=>{this.computeData(e==null?void 0:e.value),eachSeries(this._regions,i=>{isXAxis(this.getOrient())?shouldUpdateAxis(i.getXAxisHelper(),this.axisHelper(),isValid(this._seriesUserId)||isValid(this._seriesIndex))&&i.setXAxisHelper(this.axisHelper()):shouldUpdateAxis(i.getYAxisHelper(),this.axisHelper(),isValid(this._seriesUserId)||isValid(this._seriesIndex))&&i.setYAxisHelper(this.axisHelper())},{userId:this._seriesUserId,specIndex:this._seriesIndex})}}}setAttrFromSpec(){var e;super.setAttrFromSpec(),this._tick=mergeSpec({},this._spec.tick,(e=this._spec.layers)===null||e===void 0?void 0:e[0])}_initData(){var e;if(super._initData(),(e=this._spec.layers)===null||e===void 0?void 0:e[1]){const i=new DataView(this._option.dataSet,{name:`${this.type}_${this.id}_layer_1_ticks`}).parse(this._scale,{type:"scale"}).transform({type:`${this.type}-ticks`,options:Object.assign(Object.assign({},this._tickTransformOption()),{tickCount:this._spec.layers[1].tickCount,forceTickCount:this._spec.layers[1].forceTickCount,tickStep:this._spec.layers[1].tickStep})},!1);this._layerTickData=new CompilableData(this._option,i)}}computeData(e){super.computeData(e),this._layerTickData&&(this._layerTickData.getDataView().reRunAllTransform(),this._layerTickData.updateData())}_getLabelFormatMethod(){var e,i,n,o,l,d,u,f;const g=TimeUtil.getInstance(),_=((i=(e=this._spec.layers)===null||e===void 0?void 0:e[1])===null||i===void 0?void 0:i.timeFormat)||"%Y%m%d",y=(((o=(n=this._spec.layers)===null||n===void 0?void 0:n[1])===null||o===void 0?void 0:o.timeFormatMode)||"local")==="local"?g.timeFormat:g.timeUTCFormat,b=((d=(l=this._spec.layers)===null||l===void 0?void 0:l[0])===null||d===void 0?void 0:d.timeFormat)||"%Y%m%d",S=(((f=(u=this._spec.layers)===null||u===void 0?void 0:u[0])===null||f===void 0?void 0:f.timeFormatMode)||"local")==="local"?g.timeFormat:g.timeUTCFormat;return(v,A,x,T,C)=>{var E;let P;return P=C===0?S(b,v):y(_,v),!((E=this._spec.label)===null||E===void 0)&&E.formatMethod?this._spec.label.formatMethod(P,A):P}}getLabelItems(e){var i,n;const o=[],l=(i=this.getTickData())===null||i===void 0?void 0:i.getLatestData();l&&l.length&&o.push(l.map(u=>getAxisItem(u.value,this._getNormalizedValue([u.value],e))));const d=(n=this._layerTickData)===null||n===void 0?void 0:n.getLatestData();return d&&d.length&&o.push(d.map(u=>getAxisItem(u.value,this._getNormalizedValue([u.value],e)))),o}registerTicksTransform(){const e=`${this.type}-ticks`;return registerDataSetInstanceTransform(this._option.dataSet,e,continuousTicks),e}transformScaleDomain(){}}CartesianTimeAxis.type=ComponentTypeEnum.cartesianTimeAxis,CartesianTimeAxis.specKey="axes";const registerCartesianTimeAxis=()=>{registerLineAxis(),registerLineGrid(),registerAxis(),Factory$1.registerComponent(CartesianTimeAxis.type,CartesianTimeAxis)};class CartesianLogAxis extends CartesianLinearAxis{constructor(){super(...arguments),this.type=ComponentTypeEnum.cartesianLogAxis,this._zero=!1,this._scale=new LogScale}initScales(){var e;super.initScales(),this._scale.base((e=this._spec.base)!==null&&e!==void 0?e:10),this._scale.clamp(!0,null,!1)}registerTicksTransform(){const e=`${this.type}-ticks`;return registerDataSetInstanceTransform(this._option.dataSet,e,continuousTicks),e}transformScaleDomain(){}}CartesianLogAxis.type=ComponentTypeEnum.cartesianLogAxis,CartesianLogAxis.specKey="axes",mixin(CartesianLogAxis,LinearAxisMixin);const registerCartesianLogAxis=()=>{registerLineAxis(),registerLineGrid(),registerAxis(),Factory$1.registerComponent(CartesianLogAxis.type,CartesianLogAxis)};class CartesianSymlogAxis extends CartesianLinearAxis{constructor(){super(...arguments),this.type=ComponentTypeEnum.cartesianSymlogAxis,this._zero=!1,this._scale=new SymlogScale}initScales(){var e;super.initScales(),this._scale.constant((e=this._spec.constant)!==null&&e!==void 0?e:10)}registerTicksTransform(){const e=`${this.type}-ticks`;return registerDataSetInstanceTransform(this._option.dataSet,e,continuousTicks),e}transformScaleDomain(){}}CartesianSymlogAxis.type=ComponentTypeEnum.cartesianSymlogAxis,CartesianSymlogAxis.specKey="axes",mixin(CartesianSymlogAxis,LinearAxisMixin);const registerCartesianSymlogAxis=()=>{registerLineAxis(),registerLineGrid(),registerAxis(),Factory$1.registerComponent(CartesianSymlogAxis.type,CartesianSymlogAxis)};class LineSeries extends CartesianSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.line,this.transformerConstructor=LineLikeSeriesSpecTransformer,this._sortDataByAxis=!1}compile(){super.compile(),this.addSamplingCompile(),this.addOverlapCompile()}initMark(){var e;const i={progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold},n=(e=this._spec.seriesMark)!==null&&e!==void 0?e:"line";this.initLineMark(i,n==="line"),this.initSymbolMark(i,n==="point")}initTooltip(){super.initTooltip();const{group:e,mark:i}=this._tooltipHelper.activeTriggerSet;this._lineMark&&e.add(this._lineMark),this._symbolMark&&(i.add(this._symbolMark),e.add(this._symbolMark))}initMarkStyle(){this.initLineMarkStyle(this._direction),this.initSymbolMarkStyle()}initAnimation(){var e,i,n,o;const l={direction:this.direction},d=(i=(e=this._spec)===null||e===void 0?void 0:e.animationAppear)===null||i===void 0?void 0:i.preset;if(this._lineMark.setAnimationConfig(animationConfig((n=Factory$1.getAnimationInKey("line"))===null||n===void 0?void 0:n(l,d),userAnimationConfig("line",this._spec,this._markAttributeContext))),this._symbolMark){const u=getGroupAnimationParams(this);this._symbolMark.setAnimationConfig(animationConfig((o=Factory$1.getAnimationInKey("scaleInOut"))===null||o===void 0?void 0:o(),userAnimationConfig("point",this._spec,this._markAttributeContext),u))}}onLayoutEnd(e){super.onLayoutEnd(e),this.reCompileSampling()}getSeriesStyle(e){var i;const n=((i=this._spec)===null||i===void 0?void 0:i.seriesMark)!=="point";return o=>{var l,d;return n&&o==="fill"&&(o="stroke"),(d=(l=this._seriesMark)===null||l===void 0?void 0:l.getAttribute(o,e))!==null&&d!==void 0?d:void 0}}getDefaultShapeType(){return"circle"}getActiveMarks(){return[this._lineMark,this._symbolMark]}}LineSeries.type=SeriesTypeEnum.line,LineSeries.mark=lineSeriesMark,LineSeries.transformerConstructor=LineLikeSeriesSpecTransformer,mixin(LineSeries,LineLikeSeriesMixin);const registerLineSeries=()=>{registerSampleTransform(),registerMarkOverlapTransform(),registerLineMark(),registerSymbolMark(),registerLineAnimation(),registerScaleInOutAnimation(),registerCartesianBandAxis(),registerCartesianLinearAxis(),Factory$1.registerSeries(LineSeries.type,LineSeries)};class ChartData{get dataList(){return this._dataArr}constructor(e){this._dataArr=[],this._dataSet=e}parseData(e){this._dataArr=[];const i=array(e);for(let n=0;n<i.length;n++)this._dataArr.push(dataToDataView(i[n],this._dataSet,this._dataArr))}updateData(e,i=!1,n=!0){const o=array(e);return(!i||o.length===this._dataArr.length)&&(this._dataValueForEach(o,(l,d)=>{d.markRunning()}),this._dataValueForEach(o,(l,d)=>{updateDataViewInData(d,l,n)}),!0)}_dataValueForEach(e,i){e.forEach((n,o)=>{if(n instanceof DataView)return;const l=this.getSeriesData(n.id,o);l&&i(n,l,o)})}getSeriesData(e,i){if(!this._dataArr.length)return null;if(typeof e=="string"){const n=this._dataArr.filter(o=>o.name===e);if(n[0])return n[0];warn(`no data matches dataId ${e}!`)}if(typeof i=="number"){if(this._dataArr[i])return this._dataArr[i];warn(`no data matches dataIndex ${i}!`)}return this._dataArr[0]}}class GlobalScale{constructor(e,i){this._scaleSpecMap=new Map,this._scaleMap=new Map,this._modelScaleSpecMap=new Map,this._markAttributeScaleMap=new Map,this._spec=null,this._chart=null,this.getStatisticalFields=n=>{const o=[];return this._scaleSpecMap.forEach((l,d)=>{isDataDomainSpec(l.domain)&&l.domain.forEach(u=>{u.dataId===n&&u.fields.forEach(f=>{mergeFields(o,[{key:f,operations:isContinuous(l.type)?["max","min"]:["values"]}])})})}),this._markAttributeScaleMap.forEach((l,d)=>{const u=this.getScale(d);l.forEach(f=>{this._getSeriesBySeriesId(f.seriesId).getRawData().name===n&&f.field&&mergeFields(o,[{key:f.field,operations:isContinuous(u.type)?["max","min"]:["values"]}])})}),o},this._spec=e,this._chart=i,this._setAttrFromSpec()}_createFromSpec(e){if(!e.id)return null;let i=this._scaleMap.get(e.id);return i||(i=e.type==="ordinal"&&e.id==="color"?createScale("colorOrdinal"):createScale(e.type)),i?(isArray(e.range)&&i.range(e.range),isArray(e.domain)&&(isDataDomainSpec(e.domain)||i.domain(e.domain)),e.specified&&i.specified&&i.specified(e.specified),i):null}_setAttrFromSpec(){var e;if(!(!((e=this._spec)===null||e===void 0)&&e.length))return;const i=new Map,n=new Map;this._spec.forEach(o=>{const l=this._createFromSpec(o);l&&(i.set(o.id,l),n.set(o.id,o))}),this._modelScaleSpecMap.forEach(o=>{const l=this._createFromSpec(o);l&&(i.set(o.id,l),n.set(o.id,o))}),this._scaleSpecMap=n,this._scaleMap=i}updateSpec(e){const i={change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1};if(isEqual(e,this._spec))return i;i.change=!0;for(let n=0;n<e.length;n++){const o=e[n],l=this._scaleMap.get(o.id);if(!l)return i.reMake=!0,i;const d=this._spec.find(u=>u.id===o.id);if(!d.id||d.type!==o.type||!isEqual(d.specified,o.specified))return i.reMake=!0,i;o.range&&!isEqual(o.range,l.range())&&(l.range(o.range),i.reRender=!0),isDataDomainSpec(o.domain)?i.reRender=!0:isEqual(o.domain,l.domain())||(l.domain(o.domain),i.reRender=!0),this._scaleSpecMap.set(o.id,o)}return this._spec=e,i}registerModelScale(e){const i=this._createFromSpec(e);i&&(this._modelScaleSpecMap.set(e.id,e),this._scaleSpecMap.set(e.id,e),this._scaleMap.set(e.id,i))}removeModelScale(e){this._modelScaleSpecMap.forEach(i=>{e(i)&&(this._modelScaleSpecMap.delete(i.id),this._scaleSpecMap.delete(i.id),this._scaleMap.delete(i.id))})}getScale(e){return this._scaleMap.get(e)}getScaleSpec(e){return this._scaleSpecMap.get(e)}_getSeriesByRawDataId(e){const i=this._chart.getAllSeries();for(let n=0;n<i.length;n++){const o=i[n];if(o.getRawData().name===e)return o}return null}_getSeriesBySeriesId(e){const i=this._chart.getAllSeries();for(let n=0;n<i.length;n++){const o=i[n];if(o.id===e)return o}return null}updateScaleDomain(e){this._scaleSpecMap.forEach((i,n)=>{const o=this._scaleMap.get(n);if(!o)return;if(!isDataDomainSpec(i.domain))return i.domain&&i.domain.length!==0||o.domain(e),void this._updateMarkScale(n,o,o.domain().slice());let l;l=isContinuous(i.type)?[null,null]:new Set,i.domain.forEach(u=>{const f=this._getSeriesByRawDataId(u.dataId);if(!f)return;const g=isContinuous(i.type);u.fields.forEach(_=>{const y=f.getRawDataStatisticsByField(_,g);y&&(g?(isNil(l[0])?l[0]=y.min:l[0]=Math.min(y.min,l[0]),isNil(l[1])?l[1]=y.max:l[1]=Math.max(y.max,l[1])):y.values.forEach(b=>{l.add(b)}))})});const d=l;isContinuous(i.type)||(l=Array.from(l)),o.domain(l),this._updateMarkScale(n,o,d)})}_updateMarkScale(e,i,n){const o=this._markAttributeScaleMap.get(e);o&&o.length!==0&&o.forEach(l=>{if(!l.field||!l.markScale||l.markScale===i)return;if(isNil(l.changeDomain)||l.changeDomain==="none"||isNil(l.seriesId))return void(isContinuous(i.type)?l.markScale.domain(n):i.domain(Array.from(n)));const d=this._getSeriesBySeriesId(l.seriesId),u=isContinuous(i.type),f=d.getRawDataStatisticsByField(l.field,u);if(!isEmpty(f))return l.changeDomain==="expand"?(u?(n[0]=Math.min(n[0],f.min),n[1]=Math.max(n[1],f.max)):(f.values.forEach(g=>{n.add(g)}),n=Array.from(n)),void l.markScale.domain(n)):void(l.changeDomain!=="replace"||(u?l.markScale.domain([f.min,f.max]):l.markScale.domain(f.values)));isContinuous(i.type)?l.markScale.domain(n):i.domain(Array.from(n))})}registerMarkAttributeScale(e,i){const n=this._scaleMap.get(e.scale);let o=this._markAttributeScaleMap.get(e.scale);o||(o=[],this._markAttributeScaleMap.set(e.scale,o));let l=n;return(isNil(e.field)||!isNil(e.changeDomain)&&e.changeDomain!=="none"&&!isNil(i))&&(l=n.clone()),o.push(Object.assign(Object.assign({},e),{seriesId:i,markScale:l})),l}}var __rest$a=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};class BaseChart extends CompilableBase{getSpec(){return this._spec}setSpec(e){this._spec=e}getOption(){return this._option}getLayoutRect(){return this._layoutRect}getViewRect(){return this._viewRect}getLayoutTag(){return this._layoutTag}setLayoutTag(e,i,n=!0){this._layoutTag=e;const o=this.getCompiler();return o!=null&&o.getVGrammarView()&&(o.getVGrammarView().updateLayoutTag(),e&&n&&o.renderNextTick(i)),this._layoutTag}getGlobalScale(){return this._globalScale}getEvent(){return this._event}get chartData(){return this._chartData}constructor(e,i){var n,o,l;super(i),this.type="chart",this.id=createID(),this._regions=[],this._series=[],this._components=[],this._layoutRect={x:0,y:0,width:DEFAULT_CHART_WIDTH,height:DEFAULT_CHART_HEIGHT},this._viewRect={width:DEFAULT_CHART_WIDTH,height:DEFAULT_CHART_HEIGHT},this._viewBox={x1:0,y1:0,x2:DEFAULT_CHART_WIDTH,y2:DEFAULT_CHART_HEIGHT},this._layoutTag=!0,this._idMap=new Map,this.state={layoutUpdateRank:1},this.padding={top:0,left:0,right:0,bottom:0},this.getAllSeries=()=>{var d;return(d=this._series)!==null&&d!==void 0?d:[]},this.getRegionsInIndex=d=>d&&d.length!==0?this._regions.filter((u,f)=>d.includes(f)):[this._regions[0]],this.getAllRegions=()=>this._regions,this.getRegionsInIds=d=>d?this._regions.filter(u=>d.includes(u.id)):[],this.getRegionsInQuerier=d=>d?this._regions.filter((u,f)=>array(d).some(g=>isValid(g.regionId)&&g.regionId===u.userId||g.regionIndex===f)):this._regions,this.getRegionsInUserId=d=>{if(d)return this._regions.find(u=>u.userId===d)},this.getRegionsInUserIdOrIndex=(d,u)=>this.getAllRegions().filter(f=>d!=null&&d.length?f.userId&&d.includes(f.userId):!(u!=null&&u.length)||u.includes(f.getSpecIndex())),this.getComponents=()=>this._components,this.getSeriesInIndex=d=>d&&d.length!==0?this._series.filter((u,f)=>d.includes(f)):[this._series[0]],this.getSeriesInIds=d=>d?this._series.filter(u=>d.includes(u.id)):[],this.getSeriesInUserId=d=>{if(d)return this._series.find(u=>u.userId===d)},this.getSeriesInUserIdOrIndex=(d,u)=>this.getAllSeries().filter(f=>d!=null&&d.length?f.userId&&d.includes(f.userId):!(u!=null&&u.length)||u.includes(f.getSpecIndex())),this.getComponentByIndex=(d,u)=>{const f=this._components.filter(g=>(g.specKey||g.type)===d);if(f&&f.length!==0)return f[u]},this.getComponentsByKey=d=>this._components.filter(u=>(u.specKey||u.type)===d),this.getComponentByUserId=d=>{const u=this._components.find(f=>f.userId===d);if(u)return u},this.getComponentsByType=d=>this._components.filter(u=>u.type===d),this._paddingSpec=normalizeLayoutPaddingSpec((n=e.padding)!==null&&n!==void 0?n:i.getTheme().padding),this._event=new Event$1(i.eventDispatcher,i.mode),this._dataSet=i.dataSet,this._chartData=new ChartData(this._dataSet),this._modelOption=Object.assign(Object.assign({},i),{mode:this._option.mode,map:this._idMap,getChartLayoutRect:()=>this._layoutRect,getChartViewRect:()=>this._viewRect,getChart:()=>this,globalScale:this._globalScale,onError:(o=this._option)===null||o===void 0?void 0:o.onError,disableTriggerEvent:((l=this._option)===null||l===void 0?void 0:l.disableTriggerEvent)===!0,getSeriesData:this._chartData.getSeriesData.bind(this._chartData)}),this._spec=e}created(e){this._chartData.parseData(this._spec.data),this._createGlobalScale(),this._createBackground(),this._createLayout(),e.forEachRegionInSpec(this._spec,this._createRegion.bind(this)),e.forEachSeriesInSpec(this._spec,this._createSeries.bind(this)),e.forEachComponentInSpec(this._spec,this._createComponent.bind(this),this._option.getSpecInfo())}init(){var e,i;(e=this._beforeInit)===null||e===void 0||e.call(this),this._regions.forEach(n=>n.init({})),this._series.forEach(n=>n.init({})),this._components.forEach(n=>n.init({dataSet:this._dataSet})),this._initEvent(),(i=this._initStack)===null||i===void 0||i.call(this),this.reDataFlow()}reDataFlow(){this._series.forEach(e=>{var i;return(i=e.getRawData())===null||i===void 0?void 0:i.markRunning()}),this._series.forEach(e=>e.fillData()),this.updateGlobalScaleDomain()}onResize(e,i,n=!0){const o={width:e,height:i};this._canvasRect=o,this._updateLayoutRect(this._option.viewBox),this.setLayoutTag(!0,null,n)}updateViewBox(e,i){this._option.viewBox=e,this._updateLayoutRect(e),this.setLayoutTag(!0,null,i)}_createBackground(){const e=this._spec.background;if(!e||typeof e!="object"||isValid(e.gradient))return;const i=pickWithout(e,["x","y","width","height","x1","y1","image"]);i.background=e.image,this._backgroundMark=Factory$1.createMark("group","chart-background",{model:this,map:this._option.map,getCompiler:this.getCompiler,globalScale:this._globalScale}),this._backgroundMark.created(),this._backgroundMark.setStyle(Object.assign(Object.assign({},i),{x:()=>this._viewBox.x1,y:()=>this._viewBox.y1,width:()=>this._viewBox.x2-this._viewBox.x1,height:()=>this._viewBox.y2-this._viewBox.y1})),this._backgroundMark.setMarkConfig({zIndex:LayoutZIndex.SeriesGroup-2})}_createRegion(e,i){if(!e)return;const{spec:n}=i,o=__rest$a(i,["spec"]),l=new e(n,Object.assign(Object.assign({},this._modelOption),o));l&&(l.created(),this._regions.push(l))}_createSeries(e,i){if(!e)return;const{spec:n}=i,o=__rest$a(i,["spec"]);let l;if(isValid(n.regionId)?l=this.getRegionsInUserId(n.regionId):isValid(n.regionIndex)&&(l=this.getRegionsInIndex([n.regionIndex])[0]),!l&&!(l=this._regions[0]))return;const d=new e(n,Object.assign(Object.assign(Object.assign({},this._modelOption),o),{type:n.type,region:l,globalScale:this._globalScale,sourceDataList:this._chartData.dataList}));d&&(d.created(),this._series.push(d),l.addSeries(d))}getSeriesById(e){return this._series.find(i=>i.id===e)}_createComponent(e,i){const n=e.createComponent(i,Object.assign(Object.assign({},this._modelOption),{type:e.type,getAllRegions:this.getAllRegions,getRegionsInIndex:this.getRegionsInIndex,getRegionsInIds:this.getRegionsInIds,getRegionsInUserIdOrIndex:this.getRegionsInUserIdOrIndex,getAllSeries:this.getAllSeries,getSeriesInIndex:this.getSeriesInIndex,getSeriesInIds:this.getSeriesInIds,getSeriesInUserIdOrIndex:this.getSeriesInUserIdOrIndex,getAllComponents:this.getComponents,getComponentByIndex:this.getComponentByIndex,getComponentByUserId:this.getComponentByUserId,getComponentsByKey:this.getComponentsByKey,getComponentsByType:this.getComponentsByType}));n&&(n.created(),this._components.push(n))}getAllComponents(){return this._components}getAllModels(){return[].concat(this.getAllSeries(),this.getAllComponents(),this.getAllRegions())}getModelInFilter(e){if(isString(e))return this.getAllModels().find(n=>n.userId===e);if(isFunction(e))return this.getAllModels().find(n=>e(n));let i=0;return this.getAllModels().find(n=>{var o;if(((o=n.specKey)!==null&&o!==void 0?o:n.type)===e.type){if(i===e.index)return!0;i++}return!1})}_createLayout(){this._updateLayoutRect(this._option.viewBox),this._initLayoutFunc()}setLayout(e){this._option.layout=e,this._initLayoutFunc()}_initLayoutFunc(){var e,i,n;if(this._layoutFunc=this._option.layout,!this._layoutFunc){let o=!1;(this._spec.zField||this._spec.series&&this._spec.series.some(d=>d.zField))&&(o=!0);const l=Factory$1.getLayoutInKey((i=(e=this._spec.layout)===null||e===void 0?void 0:e.type)!==null&&i!==void 0?i:o?"layout3d":"base");if(l){const d=new l(this._spec.layout,{onError:(n=this._option)===null||n===void 0?void 0:n.onError});this._layoutFunc=d.layoutItems.bind(d)}}}layout(e){var i,n,o,l;if((n=(i=this._option.performanceHook)===null||i===void 0?void 0:i.beforeLayoutWithSceneGraph)===null||n===void 0||n.call(i),this.getLayoutTag()){this._event.emit(ChartEvent.layoutStart,{chart:this,vchart:this._option.globalInstance}),this.onLayoutStart(e);const d=this.getLayoutElements();this._layoutFunc(this,d,this._layoutRect,this._viewBox),this._event.emit(ChartEvent.afterLayout,{elements:d,chart:this}),this.setLayoutTag(!1),this.onLayoutEnd(e),this._event.emit(ChartEvent.layoutEnd,{chart:this,vchart:this._option.globalInstance})}(l=(o=this._option.performanceHook)===null||o===void 0?void 0:o.afterLayoutWithSceneGraph)===null||l===void 0||l.call(o)}onLayoutStart(e){this.getAllModels().forEach(i=>i.onLayoutStart(this._layoutRect,this._viewRect,e))}onLayoutEnd(e){this.getAllModels().forEach(i=>{i.modelType!=="series"&&i.onLayoutEnd(e)})}onEvaluateEnd(e){[...this._components,...this._regions,...this._series].forEach(i=>i.onEvaluateEnd(e))}getLayoutElements(){return this.getAllModels().map(e=>e.layout).filter(e=>!!e)}getModelById(e){const i=this._idMap.get(e);if(i&&i instanceof BaseModel)return i}getModelByUserId(e){const i=this.getSeriesInUserId(e);if(i)return i;const n=this.getRegionsInUserId(e);return n||this.getComponentByUserId(e)||void 0}getAllMarks(){return Array.from(this._idMap.values()).filter(e=>e&&e instanceof BaseMark)}getMarkById(e){const i=this._idMap.get(e);if(i&&i instanceof BaseMark)return i}getMarkByUserName(e){return this.getAllMarks().filter(i=>i.name&&i.name===e)}updateData(e,i,n=!0,o){const l=this._dataSet.getDataView(e);l&&(l.markRunning(),l.parseNewData(i,o)),n&&this.updateGlobalScaleDomain(),this.getAllModels().forEach(d=>d.onDataUpdate())}updateFullData(e,i=!0){array(e).forEach(n=>{const o=this._dataSet.getDataView(n.id);o&&o.markRunning()}),array(e).forEach(n=>{const o=this._dataSet.getDataView(n.id);o&&updateDataViewInData(o,n,!0)}),i&&this.updateGlobalScaleDomain(),this.getAllModels().forEach(n=>n.onDataUpdate())}onRender(e){}setCanvasRect(e,i){this._canvasRect={width:e,height:i}}getCanvasRect(){return this._canvasRect||(this._canvasRect=calculateChartSize(this._spec,this._option,{width:DEFAULT_CHART_WIDTH,height:DEFAULT_CHART_HEIGHT})),this._canvasRect}getSeriesData(e,i){return this._chartData.getSeriesData(e,i)}_transformSpecScale(){var e;const i=this._spec.scales?[...this._spec.scales]:[];let n=i.find(l=>l.id==="color");const o=this.getColorScheme();if(!n&&(n={type:"ordinal",id:"color",domain:null,range:null},i.push(n),this._spec.color)){const l=this._spec.color;if(isArray(l))n.range=l;else{const d=l;Object.prototype.hasOwnProperty.call(d,"type")&&(n.type=d.type),Object.prototype.hasOwnProperty.call(d,"domain")&&(n.domain=d.domain),Object.prototype.hasOwnProperty.call(d,"range")&&(n.range=d.range),Object.prototype.hasOwnProperty.call(d,"specified")&&(n.specified=d.specified)}}return!((e=n.range)===null||e===void 0)&&e.length||(n.range=getDataScheme(o),n.rangeTheme=!0),i}_createGlobalScale(){this._globalScale=new GlobalScale(this._transformSpecScale(),this),this._modelOption.globalScale=this._globalScale}updateGlobalScaleDomain(){const e=new Set;this._series.forEach(n=>{const o=n.getSeriesKeys();o&&o.forEach(l=>e.add(l))});const i=Array.from(e);this._globalScale.updateScaleDomain(i)}updateGlobalScale(e){mergeUpdateResult(e,this._globalScale.updateSpec(this._transformSpecScale()))}updateGlobalScaleTheme(){const e=this._globalScale.getScaleSpec("color"),i=this.getColorScheme();e.rangeTheme&&(e.range=getDataScheme(i),this._globalScale.getScale("color").range(e.range))}_getSpecKeys(e){const i={width:!0,height:!0};return Object.keys(e).filter(n=>!i[n]).sort()}updateSpec(e){const i={change:!1,reMake:!1,reRender:!1,reSize:!1,reCompile:!1};if(this.setLayoutTag(!0,null,!1),e.type!==this.type)return i.reMake=!0,i;const n=this._getSpecKeys(this._spec),o=this._getSpecKeys(e);if(!isEqual(n,o))return i.reMake=!0,i;for(let d=0;d<n.length;d++){const u=n[d];if(isArray(this._spec[u])&&this._spec[u].length!==array(e[u]).length)return i.reMake=!0,i}const l=this._spec;return this._spec=e,this.updateChartConfig(i,l),i.reMake?i:(this.updateGlobalScale(i),i.reMake?i:(this.updateRegionSpec(i),i.reMake?i:(this.updateComponentSpec(i),i.reMake||(this.updateSeriesSpec(i),i.reMake||(this.reInit(),this.updateDataSpec(),this.updateGlobalScaleDomain())),i)))}updateChartConfig(e,i){var n,o;this._paddingSpec=normalizeLayoutPaddingSpec((n=this._spec.padding)!==null&&n!==void 0?n:(o=this._option)===null||o===void 0?void 0:o.getTheme().padding),this._updateLayoutRect(this._viewBox)}updateDataSpec(){this._spec.data&&this._chartData.updateData(this._spec.data,!1,!0)}updateRegionSpec(e){var i;!((i=this._spec)===null||i===void 0)&&i.region&&(this._spec.region.length===this._regions.length?this._regions.forEach(n=>{mergeUpdateResult(e,n.updateSpec(this._spec.region[n.getSpecIndex()]))}):e.reMake=!0)}updateComponentSpec(e){const i={},n={[ComponentTypeEnum.title]:!0,[ComponentTypeEnum.brush]:!0,[ComponentTypeEnum.mapLabel]:!0};this._components.forEach(l=>{var d,u;if(l.type===ComponentTypeEnum.label||l.type===ComponentTypeEnum.totalLabel)return;n[l.type]&&(n[l.type]=!1);const f=l.specKey||l.type,g=(d=this._spec[f])!==null&&d!==void 0?d:{};isArray(g)?(i[f]=i[f]||{specCount:g.length,componentCount:0},i[f].componentCount++,mergeUpdateResult(e,l.updateSpec((u=g[l.getSpecIndex()])!==null&&u!==void 0?u:{},g))):mergeUpdateResult(e,l.updateSpec(g))});for(const l in i)if(Object.prototype.hasOwnProperty.call(i,l)){const d=i[l];d.componentCount!==d.specCount&&(e.reMake=!0)}const o=l=>l&&l.visible!==!1;Object.keys(n).forEach(l=>{if(n[l]){const d=this._spec[l];(isArray(d)?d.some(o):o(d))&&(e.reMake=!0)}})}updateSeriesSpec(e){this._spec.series.length===this._series.length?this._series.forEach(i=>{const n=this._spec.series[i.getSpecIndex()];mergeUpdateResult(e,i.updateSpec(n))}):e.reMake=!0}getCanvas(){var e,i;return(i=(e=this.getCompiler())===null||e===void 0?void 0:e.getCanvas())!==null&&i!==void 0?i:null}_updateLayoutRect(e){let i=this.getCanvasRect();if(e){this._viewBox=e;const{x1:n=0,y1:o=0,x2:l,y2:d}=e;i={width:l-n,height:d-o}}else this._viewBox={x1:0,y1:0,x2:i.width,y2:i.height};this._viewRect=i,this.padding=calcPadding(this._paddingSpec,i,i),this._layoutRect.width=i.width-this.padding.left-this.padding.right,this._layoutRect.height=i.height-this.padding.top-this.padding.bottom,this._layoutRect.x=this.padding.left,this._layoutRect.y=this.padding.top,this._event.emit(ChartEvent.layoutRectUpdate,{chart:this})}setCurrentTheme(){this.updateChartConfig({change:!0,reMake:!1},this._spec),this.setLayoutTag(!0,null,!1),this.updateGlobalScaleTheme(),this.reInit()}reInit(){[...this._regions,...this._series,...this._components].forEach(e=>{const i=e.getSpecInfo();i&&i.spec&&e.reInit(i.spec)})}clear(){this.getAllModels().forEach(e=>{var i;return(i=e.clear)===null||i===void 0?void 0:i.call(e)})}compile(){this.compileBackground(),this.compileLayout(),this.compileRegions(),this.compileSeries(),this.compileComponents()}afterCompile(){this.getAllRegions().forEach(e=>{var i;(i=e.afterCompile)===null||i===void 0||i.call(e)}),this.getAllSeries().forEach(e=>{var i;(i=e.afterCompile)===null||i===void 0||i.call(e)}),this.getAllComponents().forEach(e=>{var i;(i=e.afterCompile)===null||i===void 0||i.call(e)})}compileLayout(){const{width:e,height:i}=this.getCanvasRect();this.getCompiler().setSize(e,i)}compileBackground(){var e;this._backgroundMark&&(this._backgroundMark.compile({context:{model:this}}),(e=this._backgroundMark.getProduct())===null||e===void 0||e.layout(()=>{}))}compileRegions(){var e,i,n,o;(i=(e=this._option.performanceHook)===null||e===void 0?void 0:e.beforeRegionCompile)===null||i===void 0||i.call(e),this.getAllRegions().forEach(l=>{l.compile()}),(o=(n=this._option.performanceHook)===null||n===void 0?void 0:n.afterRegionCompile)===null||o===void 0||o.call(n)}compileSeries(){var e,i,n,o;(i=(e=this._option.performanceHook)===null||e===void 0?void 0:e.beforeSeriesCompile)===null||i===void 0||i.call(e),this.getAllSeries().forEach(l=>{l.compile()}),(o=(n=this._option.performanceHook)===null||n===void 0?void 0:n.afterSeriesCompile)===null||o===void 0||o.call(n)}compileComponents(){var e,i,n,o;(i=(e=this._option.performanceHook)===null||e===void 0?void 0:e.beforeComponentCompile)===null||i===void 0||i.call(e),this.getAllComponents().forEach(l=>{l.compile()}),(o=(n=this._option.performanceHook)===null||n===void 0?void 0:n.afterComponentCompile)===null||o===void 0||o.call(n)}release(){[...this._components,...this._regions,...this._series].forEach(e=>{e.beforeRelease()}),super.release(),this.clear(),[...this._components,...this._regions,...this._series].forEach(e=>{e.release()}),this._components=this._regions=this._series=[],this._spec={},this._dataSet=this._globalScale=this._layoutFunc=null,this._layoutTag=!1,this._idMap.clear()}onLayout(e){const i=e.rootMark;this.layout({group:i,srView:e})}updateState(e,i){const n=this.getAllSeries();for(const o in e){if(isEmpty(e[o]))continue;const l=e[o];let d={stateValue:o};d=isFunction(l.filter)?Object.assign({filter:l.filter},d):Object.assign(Object.assign({},l.filter),d),l.level&&(d.level=l.level),n.forEach(u=>{u.getMarks().forEach(f=>{f.stateStyle[o]&&(i&&!i(u,f,o)||(f.state.changeStateInfo(d),f.updateMarkState(o)))})})}}setSelected(e,i,n){this._setStateInDatum(STATE_VALUE_ENUM.STATE_SELECTED,!0,e,i,n)}setHovered(e,i,n){this._setStateInDatum(STATE_VALUE_ENUM.STATE_HOVER,!0,e,i,n)}clearState(e){this.getAllRegions().forEach(i=>{i.interaction.clearEventElement(e,!0),i.interaction.resetInteraction(e,null)})}clearAllStates(){this.getAllRegions().forEach(e=>{e.interaction.clearAllEventElement(),e.interaction.resetAllInteraction()})}clearSelected(){this.clearState(STATE_VALUE_ENUM.STATE_SELECTED)}clearHovered(){this.clearState(STATE_VALUE_ENUM.STATE_HOVER)}_initEvent(){[ChartEvent.dataZoomChange,ChartEvent.scrollBarChange].forEach(e=>{this._event.on(e,({value:i})=>{this._disableMarkAnimation(["exit","update"]);const n=()=>{this._enableMarkAnimation(["exit","update"]),this._event.off(HOOK_EVENT.AFTER_MARK_RENDER_END,n)};this._event.on(HOOK_EVENT.AFTER_MARK_RENDER_END,n)})})}_enableMarkAnimation(e){this.getAllMarks().forEach(i=>{const n=i.getProduct();n&&n.animate&&n.animate.enableAnimationState(e)})}_disableMarkAnimation(e){this.getAllMarks().forEach(i=>{const n=i.getProduct();n&&n.animate&&n.animate.disableAnimationState(e)})}_setStateInDatum(e,i,n,o,l){const d=(n=n?array(n):null)?Object.keys(n[0]):null;this.getRegionsInQuerier(l).forEach(u=>{n?(u.getSeries().forEach(f=>{f.getMarks().forEach(g=>{if(g.getProduct()&&(!o||isFunction(o)&&o(f,g))){const _=g.getProduct().isCollectionMark(),y=g.getProduct().elements;let b=[];if(_)b=y.filter(S=>{const v=S.getDatum();n.every((A,x)=>d.every(T=>A[T]==v[x][T]))});else if(n.length>1){const S=n.slice();b=y.filter(v=>{if(S.length===0)return!1;const A=v.getDatum(),x=S.findIndex(T=>d.every(C=>T[C]==A[C]));return x>=0&&(S.splice(x,1),!0)})}else{const S=y.find(v=>d.every(A=>n[0][A]==v.getDatum()[A]));S&&(b=[S])}b.forEach(S=>{u.interaction.startInteraction(e,S)})}})}),i&&u.interaction.reverseEventElement(e)):u.interaction.clearEventElement(e,!0)})}setDimensionIndex(e,i){var n,o,l,d;let u=null;Array.from(this._event.getComposedEventMap().values()).forEach(g=>{const{eventType:_,event:y}=g;if(_===DimensionEventEnum.dimensionHover||_===DimensionEventEnum.dimensionClick){const b=y.dispatch(e,i);b!=null&&b.length&&(u=b)}});const f=isNil(e)||!u||u.every(g=>isDiscrete(g.axis.getScale().type)&&isNil(g.index));if(i.tooltip!==!1){const g=this.getComponentsByType(ComponentTypeEnum.tooltip)[0];if(g!=null&&g.getVisible())if(f)(o=(n=g).hideTooltip)===null||o===void 0||o.call(n);else{const _={};u.forEach(y=>{const{axis:b,value:S,data:v}=y,A=b.getOrient()==="left"||b.getOrient()==="right";v.forEach(x=>{var T,C,E;const P=A?x.series.fieldY[0]:x.series.fieldX[0];_[P]=(E=(C=(T=x.datum)===null||T===void 0?void 0:T[0])===null||C===void 0?void 0:C[P])!==null&&E!==void 0?E:S})}),g.showTooltip(_,i.showTooltipOption)}}if(i.crosshair!==!1){const g=this.getComponentsByType(ComponentTypeEnum.cartesianCrosshair)[0];g&&g.clearAxisValue&&g.setAxisValue&&(f?((l=g.clearAxisValue)===null||l===void 0||l.call(g),(d=g.hide)===null||d===void 0||d.call(g)):u.forEach(_=>{const{axis:y,value:b}=_;g.clearAxisValue(),g.setAxisValue(b,y),g.layoutByValue()}))}}getColorScheme(){var e,i;return(i=(e=this._option).getTheme)===null||i===void 0?void 0:i.call(e).colorScheme}}const getRelatedRegionInfo=(r,e)=>{var i;const n=r.spec,{regionId:o,regionIndex:l}=n;if(isValid(o)){const d=array(o);return(i=e.region)===null||i===void 0?void 0:i.filter(({spec:u})=>d.includes(u.id))}if(isValid(l))return array(l).map(d=>{var u;return(u=e.region)===null||u===void 0?void 0:u[d]}).filter(isValid)},getRelatedSeriesInfo=(r,e)=>{var i;const n=r.spec,{seriesId:o,seriesIndex:l}=n;if(isValid(o)){const d=array(o);return(i=e.series)===null||i===void 0?void 0:i.filter(({spec:u})=>d.includes(u.id))}if(isValid(l))return array(l).map(d=>{var u;return(u=e.series)===null||u===void 0?void 0:u[d]}).filter(isValid)};class BaseChartSpecTransformer{constructor(e){this._option=e,this.type=e.type,this.seriesType=e.seriesType}initChartSpec(e){return this.transformSpec(e),this.transformModelSpec(e)}transformSpec(e){e.region&&e.region.length!==0||(e.region=[{}]),e.tooltip===void 0&&(e.tooltip={}),isValid(e.stackInverse)&&e.region.forEach(i=>{!isValid(i.stackInverse)&&(i.stackInverse=e.stackInverse)}),isValid(e.stackSort)&&e.region.forEach(i=>{!isValid(i.stackSort)&&(i.stackSort=e.stackSort)})}generateTransform(e,i){return(n,o,l)=>{const{spec:d,specPath:u,specInfoPath:f,type:g}=o,_=new n.transformerConstructor(Object.assign(Object.assign({},this._option),{type:g})),y=_.transformSpec(d,e,l),b=Object.assign(Object.assign({},o),y);i?b.theme=_.getTheme(d,e):setProperty(e,u,y.spec),setProperty(l,f??u,b)}}transformModelSpec(e){return this.createSpecInfo(e,this.generateTransform(e,!1))}createSpecInfo(e,i){var n,o;i||(i=this.generateTransform(e,!0));const l={};return this.forEachRegionInSpec(e,i,l),this.forEachSeriesInSpec(e,i,l),(n=l.series)===null||n===void 0||n.forEach((d,u)=>{var f,g;const _=((g=(f=getRelatedRegionInfo(d,l))!==null&&f!==void 0?f:l.region)!==null&&g!==void 0?g:[])[0];_&&(_.seriesIndexes||(_.seriesIndexes=[]),_.seriesIndexes.push(u),d.regionIndexes=_.regionIndexes.slice())}),this.forEachComponentInSpec(e,i,l),Object.values((o=l.component)!==null&&o!==void 0?o:{}).forEach(d=>d.forEach((u,f)=>{var g,_,y;if(u){if(!u.regionIndexes){const b=(_=(g=getRelatedRegionInfo(u,l))!==null&&g!==void 0?g:l.region)!==null&&_!==void 0?_:[];u.regionIndexes=b.map(S=>S.regionIndexes[0])}if(!u.seriesIndexes){const b=getRelatedSeriesInfo(u,l);if(b)u.seriesIndexes=b.map(({seriesIndexes:S})=>S[0]);else{const S=new Set;((y=u.regionIndexes)!==null&&y!==void 0?y:[]).forEach(v=>{var A,x;const T=(A=l.region)===null||A===void 0?void 0:A[v];(x=T==null?void 0:T.seriesIndexes)===null||x===void 0||x.forEach(C=>S.add(C))}),u.seriesIndexes=Array.from(S)}}}})),l}_isValidSeries(e){return!0}_getDefaultSeriesSpec(e,i,n){var o,l,d,u;const f={dataKey:e.dataKey,hover:e.hover,select:e.select,label:e.label,seriesStyle:e.seriesStyle,animation:(o=e.animation)!==null&&o!==void 0?o:this._option.animation,animationThreshold:(l=e.animationThreshold)!==null&&l!==void 0?l:(u=(d=this._option).getTheme)===null||u===void 0?void 0:u.call(d).animationThreshold,animationAppear:e.animationAppear,animationDisappear:e.animationDisappear,animationEnter:e.animationEnter,animationUpdate:e.animationUpdate,animationExit:e.animationExit,animationNormal:e.animationNormal,animationState:e.animationState,extensionMark:e.extensionMark,large:e.large,largeThreshold:e.largeThreshold,progressiveStep:e.progressiveStep,progressiveThreshold:e.progressiveThreshold,background:e.seriesBackground,invalidType:e.invalidType,seriesField:e.seriesField,morph:e.morph,interactions:e.interactions},g=this.seriesType;return g&&(f.type=g,f[g]=e[g]),i&&i.length&&i.forEach(_=>{f[_]=e[_]}),n&&n.length&&n.forEach(_=>{f[_]=e[_]}),f}forEachRegionInSpec(e,i,n){var o;return((o=e.region)!==null&&o!==void 0?o:[]).map((l,d)=>i(Factory$1.getRegionInType("region"),{spec:l,specPath:["region",d],type:"region",regionIndexes:[d]},n))}forEachSeriesInSpec(e,i,n){var o;return((o=e.series)!==null&&o!==void 0?o:[]).map((l,d)=>i(Factory$1.getSeriesInType(l.type),{spec:l,specPath:["series",d],type:l.type,seriesIndexes:[d]},n))}forEachComponentInSpec(e,i,n){var o,l,d;const u=[],f=Factory$1.getComponents();let g,_,y,b;const S=[];for(let A=0;A<f.length;A++){const{cmp:x,alwaysCheck:T}=f[A];x.type.startsWith(ComponentTypeEnum.cartesianAxis)?g=x:x.type.startsWith(ComponentTypeEnum.polarAxis)?_=x:x.type===ComponentTypeEnum.geoCoordinate?y=x:(T||e[(o=x.specKey)!==null&&o!==void 0?o:x.type])&&(x.type===ComponentTypeEnum.tooltip?b=x:S.push(x))}let v=!1;if(g){const A=g.getSpecInfo(e,n);(A==null?void 0:A.length)>0&&(v=!0,A.forEach(x=>{const T=Factory$1.getComponentInKey(x.type);u.push(i(T,x,n))}))}if(_&&!v){const A=_.getSpecInfo(e,n);(A==null?void 0:A.length)>0&&(v=!0,A.forEach(x=>{const T=Factory$1.getComponentInKey(x.type);u.push(i(T,x,n))}))}return y&&!v&&((l=y.getSpecInfo(e,n))===null||l===void 0||l.forEach(A=>{u.push(i(y,A,n))})),S.forEach(A=>{var x;(x=A.getSpecInfo?A.getSpecInfo(e,n):getSpecInfo(e,A.specKey,A.type))===null||x===void 0||x.forEach(T=>{u.push(i(A,T,n))})}),b&&((d=getSpecInfo(e,b.specKey,b.type))===null||d===void 0||d.forEach(A=>{u.push(i(b,A,n))})),u}transformSeriesSpec(e){const i=this._getDefaultSeriesSpec(e);e.series&&e.series.length!==0?e.series.forEach(n=>{this._isValidSeries(n.type)&&Object.keys(i).forEach(o=>{o in n||(n[o]=i[o])})}):e.series=[i]}_findBandAxisBySeries(e,i,n){const o=(e==null?void 0:e.direction)==="horizontal"?["left","right"]:["top","bottom"];return n.find(l=>{if(!o.includes(l.orient))return!1;if(isValid(l.seriesId)){if(array(l.seriesId).includes(e==null?void 0:e.id))return!0}else if(isValid(l.seriesIndex)){if(array(l.seriesIndex).includes(i))return!0}else if(l.type==="band")return!0;return!0})}_applyAxisBandSize(e,i,n){const{barMaxWidth:o,barMinWidth:l,barWidth:d,barGapInGroup:u}=n;let f=!1;isNumber(l)?(e.minBandSize=l,f=!0):isNumber(d)?(e.minBandSize=d,f=!0):isNumber(o)&&(e.minBandSize=o,f=!0),f&&(e.bandSizeLevel=Number.MAX_VALUE,e.bandSizeExtend={extend:i,gap:isArray(u)?u[u.length-1]:u})}}class CartesianChartSpecTransformer extends BaseChartSpecTransformer{needAxes(){return!0}_isValidSeries(e){return!this.seriesType||e===this.seriesType}_getDefaultSeriesSpec(e,i){return super._getDefaultSeriesSpec(e,["xField","yField","zField","direction","stack","percent","stackOffsetSilhouette","totalLabel","sortDataByAxis"],i)}transformSpec(e){super.transformSpec(e),super.transformSeriesSpec(e),this._transformAxisSpec(e)}_setDefaultXAxisSpec(e){return{orient:"bottom"}}_setDefaultYAxisSpec(e){return{orient:"left"}}_setDefaultZAxisSpec(e){return{orient:"z"}}_transformAxisSpec(e){if(this.needAxes()){e.axes||(e.axes=[]);const i={x:!1,y:!1,z:!1};e.axes.forEach(n=>{const{orient:o}=n;let l=null;o!=="top"&&o!=="bottom"||(i.x=!0,l=this._setDefaultXAxisSpec(e)),o!=="left"&&o!=="right"||(i.y=!0,l=this._setDefaultYAxisSpec(e)),o==="z"&&(i.z=!0,l=this._setDefaultZAxisSpec(e)),l&&Object.keys(l).forEach(d=>{isNil(n[d])&&(n[d]=l[d])}),get(n,"trimPadding")&&mergeSpec(n,getTrimPaddingConfig(this.type,e))}),i.x||e.axes.push(this._setDefaultXAxisSpec(e)),i.y||e.axes.push(this._setDefaultYAxisSpec(e)),e.zField&&!i.z&&e.axes.push(this._setDefaultZAxisSpec(e))}}}class LineChartSpecTransformer extends CartesianChartSpecTransformer{_getDefaultSeriesSpec(e){var i;const n=super._getDefaultSeriesSpec(e,["point","line","activePoint","sampling","samplingFactor","pointDis","pointDisMul","markOverlap","lineLabel"]);return n.seriesMark=(i=e.seriesMark)!==null&&i!==void 0?i:"line",n}transformSpec(e){super.transformSpec(e),setDefaultCrosshairForCartesianChart(e)}}const stackSplit=(r,e)=>{const i={nodes:{}},{fields:n}=e;if(!(n!=null&&n.length))return i;const o=n.length-1;let l,d,u=i;return r.forEach(f=>{f.latestData&&f.latestData.forEach(g=>{u=i;for(let _=0;_<n.length;_++){const y=n[_],b=g[y];if(isNil(b))break;u.groupField=y,u.nodes[b]||(_===o?u.nodes[b]={values:[]}:(l={nodes:{}},u.nodes[b]=l)),_===o?(d=u.nodes[b],d.values.push(g)):u=u.nodes[b]}})}),i};class Stack{constructor(e,i){this.stackRegion=({model:n})=>{var o;const l=n.getSeries();if(!l.some(_=>_.getStack()))return;const d=l.some(_=>{var y,b;return(b=(y=_.getSpec())===null||y===void 0?void 0:y.totalLabel)===null||b===void 0?void 0:b.visible}),u=d||l.some(_=>_.getPercent()),f=l.some(_=>_.getStackOffsetSilhouette()),g=getRegionStackGroup(n,!0);for(const _ in g)for(const y in g[_].nodes)stack(g[_].nodes[y],n.getStackInverse(),u,d);if(f)for(const _ in g)for(const y in g[_].nodes)stackOffsetSilhouette(g[_].nodes[y]);d&&n.getSeries().forEach(_=>{const y=_.getStackData(),b=_.getStackValue(),S=_.getStackValueField();y&&S&&stackTotal(g[b],S)}),!((o=this._options)===null||o===void 0)&&o.afterStackRegion&&this._options.afterStackRegion(n,g)},this._chart=e,this._options=i}init(){this._chart.getAllRegions().forEach(e=>{e.event.on(ChartEvent.regionSeriesDataFilterOver,{filter:({model:i})=>(i==null?void 0:i.id)===e.id},this.stackRegion)})}stackAll(){this._chart.getAllRegions().forEach(e=>{this.stackRegion({model:e})})}}class StackChartMixin{_beforeInit(){this._dataSet&&registerDataSetInstanceTransform(this._dataSet,"stackSplit",stackSplit)}_initStack(){this._stack=new Stack(this),this._stack.init()}}class LineChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=LineChartSpecTransformer,this.type="line",this.seriesType=SeriesTypeEnum.line}}LineChart.type="line",LineChart.seriesType=SeriesTypeEnum.line,LineChart.transformerConstructor=LineChartSpecTransformer,mixin(LineChart,StackChartMixin);const registerLineChart=()=>{registerLineSeries(),Factory$1.registerChart(LineChart.type,LineChart)};class AreaMark extends BaseLineMark{constructor(){super(...arguments),this.type=AreaMark.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{lineWidth:0})}_getIgnoreAttributes(){return[]}}AreaMark.type="area";const registerAreaMark=()=>{Factory$1.registerMark(AreaMark.type,AreaMark),registerAreaGraphic(),registerVGrammarLineOrAreaAnimation()};class AreaSeriesTooltipHelper extends BaseSeriesTooltipHelper{constructor(){super(...arguments),this._getSeriesStyle=(e,i,n)=>{var o,l,d,u;for(const f of array(i)){let g=(o=this.series.getSeriesStyle(e))===null||o===void 0?void 0:o(f);if(g!==!1||f!=="fill"&&f!=="stroke"||(g=f==="fill"?(d=(l=this.series.getSeriesStyle(e))===null||l===void 0?void 0:l("stroke"))===null||d===void 0?void 0:d[0]:(u=this.series.getSeriesStyle(e))===null||u===void 0?void 0:u("fill")),isValid(g))return g}return n}}}const areaSeriesMark=Object.assign(Object.assign(Object.assign({},baseSeriesMark),lineLikeSeriesMark),{area:{name:"area",type:"area"}}),registerAreaSeriesAnimation=()=>{registerAreaAnimation(),registerLineAnimation(),registerScaleInOutAnimation()};class AreaSeriesSpecTransformer extends LineLikeSeriesSpecTransformer{constructor(){super(...arguments),this._supportStack=!0}_transformLabelSpec(e){var i,n,o;const l=((i=e.point)===null||i===void 0?void 0:i.visible)!==!1&&((o=(n=e.point)===null||n===void 0?void 0:n.style)===null||o===void 0?void 0:o.visible)!==!1;this._addMarkLabelSpec(e,d=>{const u=d.position==="inside-middle";return!l||u?"area":"point"}),this._addMarkLabelSpec(e,"area","areaLabel","initLineLabelMarkStyle",void 0,!0)}_transformSpecAfterMergingTheme(e,i,n){var o,l,d,u,f;super._transformSpecAfterMergingTheme(e,i,n);const{area:g={},line:_={},seriesMark:y}=e,b=g.visible!==!1&&((o=g.style)===null||o===void 0?void 0:o.visible)!==!1,S=_.visible!==!1&&((l=_.style)===null||l===void 0?void 0:l.visible)!==!1;g.support3d=!(!g.support3d&&!_.support3d),g.zIndex=isValid(g.zIndex)||isValid(_.zIndex)?Math.max((d=g.zIndex)!==null&&d!==void 0?d:0,(u=_.zIndex)!==null&&u!==void 0?u:0):void 0,g.style&&delete g.style.stroke,g.state&&Object.keys(g.state).forEach(x=>{"style"in g.state[x]?delete g.state[x].style.stroke:delete g.state[x].stroke});let v=g,A=_;(y==="line"||S&&!b)&&(v=_,A=g),g.style=mergeSpec({},A.style,v.style),g.state=mergeSpec({},A.state,v.state),g.interactive===!1&&(g.style.fillPickable=!1),_.interactive===!1&&(_.style.strokePickable=!1),g.interactive=!(!g.interactive&&(f=_.interactive)!==null&&f!==void 0&&!f),e.area=g,e.line=_}}class AreaSeries extends CartesianSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.area,this.transformerConstructor=AreaSeriesSpecTransformer,this._sortDataByAxis=!1}initMark(){var e;const i={progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold},n=this._spec.area||{},o=(e=this._spec.seriesMark)!==null&&e!==void 0?e:"area",l=this._isAreaVisible()||this._isLineVisible();this._areaMark=this._createMark(AreaSeries.mark.area,{groupKey:this._seriesField,isSeriesMark:l&&o!=="point",stateSort:n.stateSort},Object.assign(Object.assign({},i),{morphElementKey:this.getDimensionField()[0],setCustomizedShape:n.customShape})),this.initSymbolMark(i,o==="point")}initMarkStyle(){this.initAreaMarkStyle(),this.initSymbolMarkStyle()}initAreaMarkStyle(){var e,i,n,o,l;const d=(n=(i=(e=this.getSpec().area)===null||e===void 0?void 0:e.style)===null||i===void 0?void 0:i.curveType)!==null&&n!==void 0?n:(l=(o=this.getSpec().line)===null||o===void 0?void 0:o.style)===null||l===void 0?void 0:l.curveType,u=d===DEFAULT_SMOOTH_INTERPOLATE?this._direction==="horizontal"?"monotoneY":"monotoneX":d,f=this._areaMark;if(f){const g=this._isAreaVisible(),_=this._isLineVisible();g||_?f.setVisible(!0):f.setVisible(!1),this._direction==="horizontal"?this.setMarkStyle(this._areaMark,{x:this.dataToPositionX.bind(this),x1:y=>{var b,S;return valueInScaleRange(this.dataToPositionX1(y),(S=(b=this._xAxisHelper)===null||b===void 0?void 0:b.getScale)===null||S===void 0?void 0:S.call(b,0))},y:this.dataToPositionY.bind(this),y1:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null,orient:this._direction},"normal",AttributeLevel.Series):this.setMarkStyle(this._areaMark,{x:this.dataToPositionX.bind(this),x1:this.dataToPositionX.bind(this),y1:y=>{var b,S;return valueInScaleRange(this.dataToPositionY1(y),(S=(b=this._yAxisHelper)===null||b===void 0?void 0:b.getScale)===null||S===void 0?void 0:S.call(b,0))},y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null},"normal",AttributeLevel.Series),this.setMarkStyle(f,{fill:!!g&&this.getColorAttribute(),stroke:!!_&&this.getColorAttribute()},"normal",AttributeLevel.Series),this._invalidType!=="zero"&&this.setMarkStyle(f,{defined:this._getInvalidDefined.bind(this),connectedType:this._getInvalidConnectType()},"normal",AttributeLevel.Series),this.setMarkStyle(f,{curveType:u},"normal",AttributeLevel.Built_In),Object.keys(f.stateStyle).forEach(y=>{f.stateStyle[y].stroke&&f.setPostProcess("stroke",b=>[b,!1,!1,!1],y)})}}initAnimation(){var e,i,n,o;const l={direction:this.direction},d=(e=this._spec.animationAppear)===null||e===void 0?void 0:e.preset;if(this._lineMark&&this._lineMark.setAnimationConfig(animationConfig((i=Factory$1.getAnimationInKey("line"))===null||i===void 0?void 0:i(l,d),userAnimationConfig("line",this._spec,this._markAttributeContext))),this._areaMark&&this._areaMark.setAnimationConfig(animationConfig((n=Factory$1.getAnimationInKey("area"))===null||n===void 0?void 0:n(l,d),userAnimationConfig("area",this._spec,this._markAttributeContext))),this._symbolMark){const u=getGroupAnimationParams(this);this._symbolMark.setAnimationConfig(animationConfig((o=Factory$1.getAnimationInKey("scaleInOut"))===null||o===void 0?void 0:o(),userAnimationConfig("point",this._spec,this._markAttributeContext),u))}}_isAreaVisible(){var e;const i=this._spec.area||{};return i.visible!==!1&&((e=i.style)===null||e===void 0?void 0:e.visible)!==!1}_isLineVisible(){var e;const i=this._spec.line||{};return i.visible!==!1&&((e=i.style)===null||e===void 0?void 0:e.visible)!==!1}initTooltip(){this._tooltipHelper=new AreaSeriesTooltipHelper(this);const{group:e,mark:i}=this._tooltipHelper.activeTriggerSet;this._areaMark&&e.add(this._areaMark),this._lineMark&&e.add(this._lineMark),this._symbolMark&&(i.add(this._symbolMark),e.add(this._symbolMark))}viewDataStatisticsUpdate(e){super.viewDataStatisticsUpdate(e),this.encodeDefined(this._areaMark,"defined")}compile(){super.compile(),this.addSamplingCompile(),this.addOverlapCompile()}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._areaMark,this._symbolMark,this._lineMark]}onLayoutEnd(e){super.onLayoutEnd(e),this.reCompileSampling()}getSeriesStyle(e){return i=>{var n,o,l,d,u;const f=(n=this._spec.seriesMark)!==null&&n!==void 0?n:"area";let g=(l=(o=this._seriesMark)===null||o===void 0?void 0:o.getAttribute(i,e))!==null&&l!==void 0?l:void 0;return i!=="fill"||g&&f!=="line"||(i="stroke",g=(u=(d=this._seriesMark)===null||d===void 0?void 0:d.getAttribute(i,e))!==null&&u!==void 0?u:void 0),i==="stroke"&&isArray(g)?g[0]:g}}}AreaSeries.type=SeriesTypeEnum.area,AreaSeries.mark=areaSeriesMark,AreaSeries.transformerConstructor=AreaSeriesSpecTransformer,mixin(AreaSeries,LineLikeSeriesMixin);const registerAreaSeries=()=>{registerSampleTransform(),registerMarkOverlapTransform(),registerLineMark(),registerAreaMark(),registerSymbolMark(),registerAreaSeriesAnimation(),registerCartesianBandAxis(),registerCartesianLinearAxis(),Factory$1.registerSeries(AreaSeries.type,AreaSeries)};class AreaChartSpecTransformer extends CartesianChartSpecTransformer{_getDefaultSeriesSpec(e){return super._getDefaultSeriesSpec(e,["point","line","area","seriesMark","activePoint","sampling","samplingFactor","pointDis","pointDisMul","markOverlap","areaLabel"])}transformSpec(e){super.transformSpec(e),setDefaultCrosshairForCartesianChart(e)}}class AreaChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=AreaChartSpecTransformer,this.type="area",this.seriesType=SeriesTypeEnum.area}}AreaChart.type="area",AreaChart.seriesType=SeriesTypeEnum.area,AreaChart.transformerConstructor=AreaChartSpecTransformer,mixin(AreaChart,StackChartMixin);const registerAreaChart=()=>{registerAreaSeries(),Factory$1.registerChart(AreaChart.type,AreaChart)};function barGrowOption(r,e=!0){return(i,n,o)=>{const l=r.direction==="vertical"?r.yField:r.xField,d=i==null?void 0:i[l];return r.direction==="vertical"?{overall:e&&r.growFrom(),orient:d>0?"negative":"positive"}:{overall:!!e&&r.growFrom(),orient:d>0?"positive":"negative"}}}const barGrowIn=(r,e=!0)=>({type:r.direction==="horizontal"?"growWidthIn":"growHeightIn",options:barGrowOption(r,e)}),barGrowOut=(r,e=!0)=>({type:r.direction==="horizontal"?"growWidthOut":"growHeightOut",options:barGrowOption(r,e)}),Appear_FadeIn$7={type:"fadeIn"},Appear_ScaleIn$1={type:"growCenterIn"};function barPresetAnimation(r,e){if(e===!1)return{};switch(e){case"fadeIn":return Appear_FadeIn$7;case"scaleIn":return Appear_ScaleIn$1;default:return barGrowIn(r)}}const registerBarAnimation=()=>{Factory$1.registerAnimation("bar",(r,e)=>({appear:barPresetAnimation(r,e),enter:barGrowIn(r,!1),exit:barGrowOut(r,!1),disappear:barGrowOut(r)}))},registerBar3dAnimation=()=>{Factory$1.registerAnimation("bar3d",(r,e)=>({appear:barPresetAnimation(r,e),enter:barGrowIn(r,!1),exit:barGrowOut(r,!1),disappear:barGrowOut(r)}))};class RectMark extends BaseMark{constructor(){super(...arguments),this.type=RectMark.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{width:void 0,height:void 0,lineWidth:0})}}RectMark.type="rect";const registerRectMark=()=>{Factory$1.registerMark(RectMark.type,RectMark),registerRectGraphic(),registerVGrammarRectAnimation()},barSeriesMark=Object.assign(Object.assign({},baseSeriesMark),{bar:{name:"bar",type:"rect"},barBackground:{name:"barBackground",type:"rect"}}),bar3dSeriesMark=Object.assign(Object.assign({},baseSeriesMark),{bar3d:{name:"bar3d",type:"rect3d"}});function stackWithMinHeight(r,e,i){var n,o;if(r.values.length>0){let l;if(r.sortDatums.length){let d=r.sortDatums;e&&(d=r.sortDatums.slice().reverse());for(let u=0;u<d.length;u++)l=computeOneDatumY(d[u].datum,l,d[u].series,i,(o=(n=d[u].series[i.axisHelper]).getScale)===null||o===void 0?void 0:o.call(n,0),u===0)}else{let d=r.series;e&&(d=d.slice().reverse()),d.forEach(({s:u,values:f},g)=>{var _,y;const b=(y=(_=u[i.axisHelper]).getScale)===null||y===void 0?void 0:y.call(_,0);for(let S=0;S<f.length;S++){const v=f[e?f.length-1-S:S];l=computeOneDatumY(v,l,u,i,b,S===0&&g===0)}})}}for(const l in r.nodes)stackWithMinHeight(r.nodes[l],e,i)}function computeOneDatumY(r,e,i,n,o,l){const d=i.getSpec().barMinHeight,u=i[n.axisHelper].isInverse(),f=valueInScaleRange(i[n.startMethod](r),o);let g=valueInScaleRange(i[n.endMethod](r),o);l&&(e=f);let _=Math.abs(f-g);_<d&&(_=d);let y=1;return g<f?y=-1:g===f&&(y=n.isVertical?u?1:-1:u?-1:1),g=e+y*_,r[n.start]=e,r[n.end]=g,g}class BarSeriesSpecTransformer extends BaseSeriesSpecTransformer{constructor(){super(...arguments),this._supportStack=!0}_transformLabelSpec(e){this._addMarkLabelSpec(e,"bar")}}class BarSeries extends CartesianSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.bar,this._barMarkName="bar",this._barMarkType="rect",this.transformerConstructor=BarSeriesSpecTransformer,this._bandPosition=0,this._getBarXStart=(e,i,n)=>this._shouldDoPreCalculate()?(this._calculateStackRectPosition(!1),e[RECT_X]):this._spec.barMinHeight?this._calculateRectPosition(e,!1,n):valueInScaleRange(this._dataToPosX(e),i,n),this._getBarXEnd=(e,i,n)=>this._shouldDoPreCalculate()?(this._calculateStackRectPosition(!1),e[RECT_X1]):valueInScaleRange(this._dataToPosX1(e),i,n),this._getBarYStart=(e,i)=>this._shouldDoPreCalculate()?(this._calculateStackRectPosition(!0),e[RECT_Y]):this._spec.barMinHeight?this._calculateRectPosition(e,!0):valueInScaleRange(this._dataToPosY(e),i),this._getBarYEnd=(e,i)=>this._shouldDoPreCalculate()?(this._calculateStackRectPosition(!0),e[RECT_Y1]):valueInScaleRange(this._dataToPosY1(e),i),this._getBarBackgroundXStart=e=>{const i=e.range();return Math.min(i[0],i[i.length-1])},this._getBarBackgroundXEnd=e=>{const i=e.range();return Math.max(i[0],i[i.length-1])},this._getBarBackgroundYStart=e=>{const i=e.range();return Math.min(i[0],i[i.length-1])},this._getBarBackgroundYEnd=e=>{const i=e.range();return Math.max(i[0],i[i.length-1])},this._getBarBackgroundPositionXEncoder=()=>{var e;return(e=this._barBackgroundPositionXEncoder)===null||e===void 0?void 0:e.bind(this)},this._setBarBackgroundPositionXEncoder=e=>{this._barBackgroundPositionXEncoder=e.bind(this)},this._getBarBackgroundPositionYEncoder=()=>{var e;return(e=this._barBackgroundPositionYEncoder)===null||e===void 0?void 0:e.bind(this)},this._setBarBackgroundPositionYEncoder=e=>{this._barBackgroundPositionYEncoder=e.bind(this)}}initMark(){var e,i;this._initBarBackgroundMark(),this._barMark=this._createMark(Object.assign(Object.assign({},BarSeries.mark.bar),{name:this._barMarkName,type:this._barMarkType}),{groupKey:this._seriesField,isSeriesMark:!0,stateSort:(e=this._spec.bar)===null||e===void 0?void 0:e.stateSort},{progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold,morphElementKey:this.getDimensionField()[0],morph:shouldMarkDoMorph(this._spec,this._barMarkName),setCustomizedShape:(i=this._spec.bar)===null||i===void 0?void 0:i.customShape})}_initBarBackgroundMark(){this._spec.barBackground&&this._spec.barBackground.visible&&(this._barBackgroundMark=this._createMark(BarSeries.mark.barBackground,{dataView:this._barBackgroundViewData.getDataView(),dataProductId:this._barBackgroundViewData.getProductId(),stateSort:this._spec.barBackground.stateSort},{setCustomizedShape:this._spec.barBackground.customShape,progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold}))}initMarkStyle(){this._barMark&&this.setMarkStyle(this._barMark,{fill:this.getColorAttribute()},"normal",AttributeLevel.Series)}initLabelMarkStyle(e){e&&this.setMarkStyle(e,{fill:this.getColorAttribute(),text:i=>i[this.getStackValueField()],z:this._fieldZ?this.dataToPositionZ.bind(this):null})}initTooltip(){super.initTooltip();const{mark:e,group:i}=this._tooltipHelper.activeTriggerSet;this._barMark&&(e.add(this._barMark),i.add(this._barMark))}_statisticViewData(){var e,i;super._statisticViewData();const n=(e=this._spec.barBackground)!==null&&e!==void 0?e:{};if(!n.visible)return;const o=this._getRelatedComponentSpecInfo("axes").some(d=>d.type===ComponentTypeEnum.cartesianBandAxis);let l;if(registerDataSetInstanceTransform(this._option.dataSet,"addVChartProperty",addVChartProperty),o){const d=([u],{scaleDepth:f})=>{var g,_;let y=[{}];const b=this.getDimensionField(),S=isNil(f)?b.length:Math.min(b.length,f);for(let v=0;v<S;v++){const A=b[v],x=(g=u.latestData[A])===null||g===void 0?void 0:g.values;if(!(x!=null&&x.length))continue;const T=[],C=(_=this._spec.dataKey)!==null&&_!==void 0?_:DEFAULT_DATA_KEY;for(let E=0;E<x.length;E++)for(let P=0;P<y.length;P++)T.push(Object.assign(Object.assign({},y[P]),{[A]:x[E],[C]:x[E]}));y=T}return y};registerDataSetInstanceTransform(this._option.dataSet,"dimensionItems",d),l=new DataView(this._option.dataSet).parse([this._viewDataStatistics],{type:"dataview"}).transform({type:"dimensionItems",options:{scaleDepth:isNil(n.fieldLevel)?void 0:n.fieldLevel+1}},!1).transform({type:"addVChartProperty",options:{beforeCall:initKeyMap.bind(this),call:addDataKey}},!1),(i=this._viewDataStatistics)===null||i===void 0||i.target.addListener("change",l.reRunAllTransform)}else{const d=([f])=>{const g=[],[_,y]=this.getDimensionContinuousField(),b={};return u.latestData.forEach(S=>{const v=`${S[_]}-${S[y]}`;b[v]||(b[v]={[_]:S[_],[y]:S[y]},g.push(b[v]))}),g};registerDataSetInstanceTransform(this._option.dataSet,"dimensionItems",d);const u=this.getViewData();l=new DataView(this._option.dataSet).parse([u],{type:"dataview"}).transform({type:"dimensionItems"},!1).transform({type:"addVChartProperty",options:{beforeCall:initKeyMap.bind(this),call:addDataKey}},!1),u==null||u.target.addListener("change",l.reRunAllTransform)}this._barBackgroundViewData=new SeriesData(this._option,l)}init(e){var i,n;super.init(e),this.direction==="vertical"?((i=this._xAxisHelper)===null||i===void 0?void 0:i.getScale(0).type)==="band"?this.initBandRectMarkStyle():this.initLinearRectMarkStyle():((n=this._yAxisHelper)===null||n===void 0?void 0:n.getScale(0).type)==="band"?this.initBandRectMarkStyle():this.initLinearRectMarkStyle()}_shouldDoPreCalculate(){const e=this.getRegion();return this.getStack()&&e.getSeries().filter(i=>i.type===this.type&&i.getSpec().barMinHeight).length}_calculateStackRectPosition(e){const i=this.getRegion();if(i._bar_series_position_calculated)return;let n,o,l,d,u;i._bar_series_position_calculated=!0,e?(n=RECT_Y1,o=RECT_Y,l="_dataToPosY1",d="_dataToPosY",u="_yAxisHelper"):(n=RECT_X1,o=RECT_X,l="_dataToPosX1",d="_dataToPosX",u="_xAxisHelper");const f=getRegionStackGroup(i,!1,g=>g.type===this.type);for(const g in f)for(const _ in f[g].nodes)stackWithMinHeight(f[g].nodes[_],i.getStackInverse(),{isVertical:e,start:n,end:o,startMethod:l,endMethod:d,axisHelper:u})}_calculateRectPosition(e,i,n){var o,l;let d,u,f;i?(d="_dataToPosY1",u="_dataToPosY",f="_yAxisHelper"):(d="_dataToPosX1",u="_dataToPosX",f="_xAxisHelper");const g=(l=(o=this[f]).getScale)===null||l===void 0?void 0:l.call(o,0),_=this[f].isInverse(),y=this._spec.barMinHeight,b=valueInScaleRange(this[d](e),g,n),S=valueInScaleRange(this[u](e),g,n);let v=Math.abs(b-S);v<y&&(v=y);let A=1;return S<b?A=-1:S===b&&(A=i?_?1:-1:_?-1:1),b+A*v}_dataToPosX(e){return this.dataToPositionX(e)}_dataToPosX1(e){return this.dataToPositionX1(e)}_dataToPosY(e){return this.dataToPositionY(e)}_dataToPosY1(e){return this.dataToPositionY1(e)}initBandRectMarkStyle(){var e,i,n,o;const l=(i=(e=this._xAxisHelper)===null||e===void 0?void 0:e.getScale)===null||i===void 0?void 0:i.call(e,0),d=(o=(n=this._yAxisHelper)===null||n===void 0?void 0:n.getScale)===null||o===void 0?void 0:o.call(n,0);this.direction==="horizontal"?this.setMarkStyle(this._barMark,{x:u=>this._getBarXStart(u,l),x1:u=>this._getBarXEnd(u,l),y:u=>this._getPosition(this.direction,u),height:()=>this._getBarWidth(this._yAxisHelper),width:()=>{},y1:()=>{}},"normal",AttributeLevel.Series):this.setMarkStyle(this._barMark,{y:u=>this._getBarYStart(u,d),y1:u=>this._getBarYEnd(u,d),x:u=>this._getPosition(this.direction,u),width:()=>this._getBarWidth(this._xAxisHelper),x1:()=>{},height:()=>{}},"normal",AttributeLevel.Series),this._initStackBarMarkStyle(),this._initBandBarBackgroundMarkStyle()}_initStackBarMarkStyle(){var e,i,n,o;if(!this._spec.stackCornerRadius)return;const l=(i=(e=this._xAxisHelper)===null||e===void 0?void 0:e.getScale)===null||i===void 0?void 0:i.call(e,0),d=(o=(n=this._yAxisHelper)===null||n===void 0?void 0:n.getScale)===null||o===void 0?void 0:o.call(n,0);this._barMark.setMarkConfig({clip:!0,clipPath:()=>{const u=[];return this._forEachStackGroup(f=>{let g=1/0,_=-1/0,y=!1,b=1/0,S=-1/0;f.values.forEach(x=>{const T=x[STACK_FIELD_START],C=x[STACK_FIELD_END],E=x[STACK_FIELD_START_PERCENT],P=x[STACK_FIELD_END_PERCENT];g=Math.min(g,T,C),_=Math.max(_,T,C),isValid(E)&&isValid(P)&&(y=!0,b=Math.min(b,E,P),S=Math.max(S,E,P))});const v=Object.assign(Object.assign(Object.assign({},f.values[0]),{[STACK_FIELD_START]:g,[STACK_FIELD_END]:_}),y?{[STACK_FIELD_START_PERCENT]:b,[STACK_FIELD_END_PERCENT]:S}:void 0),A=this.direction==="horizontal"?{x:this._getBarXStart(v,l),x1:this._getBarXEnd(v,l),y:this._getPosition(this.direction,v),height:this._getBarWidth(this._yAxisHelper)}:{y:this._getBarYStart(v,d),y1:this._getBarYEnd(v,d),x:this._getPosition(this.direction,v),width:this._getBarWidth(this._xAxisHelper)};u.push(createRect(Object.assign(Object.assign({},A),{cornerRadius:isFunction(this._spec.stackCornerRadius)?this._spec.stackCornerRadius(A,v,this._markAttributeContext):this._spec.stackCornerRadius,fill:!0})))}),u}})}initLinearRectMarkStyle(){var e,i,n,o;const l=(i=(e=this._xAxisHelper)===null||e===void 0?void 0:e.getScale)===null||i===void 0?void 0:i.call(e,0),d=(o=(n=this._yAxisHelper)===null||n===void 0?void 0:n.getScale)===null||o===void 0?void 0:o.call(n,0);if(this.direction==="horizontal"){const u=isValid(this._fieldY2)?{y:f=>valueInScaleRange(this._dataToPosY(f),d,!0),y1:f=>valueInScaleRange(this._dataToPosY1(f),d,!0)}:{y:f=>valueInScaleRange(this._dataToPosY(f)-this._getBarWidth(this._yAxisHelper)/2,d,!0),height:f=>this._getBarWidth(this._yAxisHelper)};this.setMarkStyle(this._barMark,Object.assign({x:f=>this._getBarXStart(f,l,!0),x1:f=>this._getBarXEnd(f,l,!0)},u),"normal",AttributeLevel.Series),this.setMarkStyle(this._barBackgroundMark,Object.assign({x:()=>this._getBarBackgroundXStart(l),x1:()=>this._getBarBackgroundXEnd(l)},u),"normal",AttributeLevel.Series)}else{const u=isValid(this._fieldX2)?{x:f=>valueInScaleRange(this._dataToPosX(f),l,!0),x1:f=>valueInScaleRange(this._dataToPosX1(f),l,!0)}:{x:f=>valueInScaleRange(this._dataToPosX(f)-this._getBarWidth(this._xAxisHelper)/2,l,!0),width:f=>this._getBarWidth(this._xAxisHelper)};this.setMarkStyle(this._barMark,Object.assign(Object.assign({},u),{y:f=>this._getBarYStart(f,d),y1:f=>this._getBarYEnd(f,d)}),"normal",AttributeLevel.Series),this.setMarkStyle(this._barBackgroundMark,Object.assign(Object.assign({},u),{y:()=>this._getBarBackgroundYStart(d),y1:()=>this._getBarBackgroundYEnd(d)}),"normal",AttributeLevel.Series)}}_initBandBarBackgroundMarkStyle(){var e,i,n,o,l;if(!this._barBackgroundMark)return;const d=(i=(e=this._xAxisHelper)===null||e===void 0?void 0:e.getScale)===null||i===void 0?void 0:i.call(e,0),u=(o=(n=this._yAxisHelper)===null||n===void 0?void 0:n.getScale)===null||o===void 0?void 0:o.call(n,0),f=(l=this._spec.barBackground)!==null&&l!==void 0?l:{},g=isNil(f.fieldLevel)?void 0:f.fieldLevel+1;this.direction==="horizontal"?this.setMarkStyle(this._barBackgroundMark,{x:()=>this._getBarBackgroundXStart(d),x1:()=>this._getBarBackgroundXEnd(d),y:_=>this._getPosition(this.direction,_,g,"barBackground"),height:()=>this._getBarWidth(this._yAxisHelper,g),width:()=>{},y1:()=>{}},"normal",AttributeLevel.Series):this.setMarkStyle(this._barBackgroundMark,{x:_=>this._getPosition(this.direction,_,g,"barBackground"),y:()=>this._getBarBackgroundYStart(u),y1:()=>this._getBarBackgroundYEnd(u),width:()=>this._getBarWidth(this._xAxisHelper,g),x1:()=>{},height:()=>{}},"normal",AttributeLevel.Series)}initAnimation(){var e,i;const n={yField:this._fieldY[0],xField:this._fieldX[0],direction:this.direction,growFrom:()=>{var d,u;return this.direction==="horizontal"?(d=this._xAxisHelper)===null||d===void 0?void 0:d.getScale(0).scale(0):(u=this._yAxisHelper)===null||u===void 0?void 0:u.getScale(0).scale(0)}},o=(e=this._spec.animationAppear)===null||e===void 0?void 0:e.preset,l=getGroupAnimationParams(this);this._barMark.setAnimationConfig(animationConfig((i=Factory$1.getAnimationInKey("bar"))===null||i===void 0?void 0:i(n,o),userAnimationConfig(this._barMarkName,this._spec,this._markAttributeContext),l))}_getBarWidth(e,i){var n,o;const l=this._groups?this._groups.fields.length:1,d=isNil(i)?l:Math.min(l,i),u=(o=(n=e.getBandwidth)===null||n===void 0?void 0:n.call(e,d-1))!==null&&o!==void 0?o:6,f=isValid(this._spec.barWidth)&&d===l,g=isValid(this._spec.barMinWidth),_=isValid(this._spec.barMaxWidth);let y=u;return f&&(y=getActualNumValue(this._spec.barWidth,u)),g&&(y=Math.max(y,getActualNumValue(this._spec.barMinWidth,u))),_&&(y=Math.min(y,getActualNumValue(this._spec.barMaxWidth,u))),y}_getPosition(e,i,n,o){var l,d,u,f,g;let _,y,b;e==="horizontal"?(_=this.getYAxisHelper(),y="height",b=o==="barBackground"?this.dataToBarBackgroundPositionY.bind(this):this.dataToPositionY.bind(this)):(_=this.getXAxisHelper(),y="width",b=o==="barBackground"?this.dataToBarBackgroundPositionX.bind(this):this.dataToPositionX.bind(this));const S=_.getScale(0),v=this._groups?this._groups.fields.length:1,A=isNil(n)?v:Math.min(v,n),x=(d=(l=_.getBandwidth)===null||l===void 0?void 0:l.call(_,A-1))!==null&&d!==void 0?d:6,T=A===v?this._barMark.getAttribute(y,i):x;if(A>1&&isValid(this._spec.barGapInGroup)){const E=this._groups.fields,P=array(this._spec.barGapInGroup);let R=0,L=0;for(let w=E.length-1;w>=1;w--){const B=E[w],I=(f=(u=_.getScale(w))===null||u===void 0?void 0:u.domain())!==null&&f!==void 0?f:[],D=I.length,O=getActualNumValue((g=P[w-1])!==null&&g!==void 0?g:last(P),x),N=I.indexOf(i[B]);w===E.length-1?(R+=D*T+(D-1)*O,L+=N*(T+O)):(L+=N*(R+O),R+=R+(D-1)*O)}return S.scale(i[E[0]])+_.getBandwidth(0)/2-R/2+L}const C=isContinuous(S.type||"band");return b(i,A)+.5*(x-T)+(C?-x/2:0)}dataToBarBackgroundPositionX(e,i){return this._dataToPosition(e,this._xAxisHelper,this.fieldX,i,this._getBarBackgroundPositionXEncoder,this._setBarBackgroundPositionXEncoder)}dataToBarBackgroundPositionY(e,i){return this._dataToPosition(e,this._yAxisHelper,this.fieldY,i,this._getBarBackgroundPositionYEncoder,this._setBarBackgroundPositionYEncoder)}onLayoutEnd(e){super.onLayoutEnd(e),this.getRegion()._bar_series_position_calculated=!1,this._spec.sampling&&this.compile()}compile(){if(super.compile(),this._spec.sampling){const{width:e,height:i}=this._region.getLayoutRect(),n=[],o=this._fieldY,l=this._fieldX;n.push({type:"sampling",size:this._direction==="horizontal"?i:e,factor:this._spec.samplingFactor,yfield:this._direction==="horizontal"?l[0]:o[0],groupBy:this._seriesField,mode:this._spec.sampling}),this._data.getProduct().transform(n)}}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._barMark]}compileData(){var e;super.compileData(),(e=this._barBackgroundViewData)===null||e===void 0||e.compile()}fillData(){var e,i;super.fillData(),(i=(e=this._barBackgroundViewData)===null||e===void 0?void 0:e.getDataView())===null||i===void 0||i.reRunAllTransform()}viewDataUpdate(e){var i,n,o;super.viewDataUpdate(e),(n=(i=this._barBackgroundViewData)===null||i===void 0?void 0:i.getDataView())===null||n===void 0||n.reRunAllTransform(),(o=this._barBackgroundViewData)===null||o===void 0||o.updateData()}release(){var e;super.release(),(e=this._barBackgroundViewData)===null||e===void 0||e.release(),this._barBackgroundViewData=null}}BarSeries.type=SeriesTypeEnum.bar,BarSeries.mark=barSeriesMark,BarSeries.transformerConstructor=BarSeriesSpecTransformer;const registerBarSeries=()=>{registerSampleTransform(),registerRectMark(),registerBarAnimation(),registerCartesianBandAxis(),registerCartesianLinearAxis(),Factory$1.registerSeries(BarSeries.type,BarSeries)};class BarChartSpecTransformer extends CartesianChartSpecTransformer{_getDefaultSeriesSpec(e){return super._getDefaultSeriesSpec(e,["barWidth","barMaxWidth","barMinWidth","barGapInGroup","barMinHeight","sampling","samplingFactor","barBackground","stackCornerRadius"])}transformSpec(e){super.transformSpec(e),setDefaultCrosshairForCartesianChart(e)}_transformAxisSpec(e){var i,n;if(super._transformAxisSpec(e),!e.axes)return;const o=e.series.some(d=>d.direction==="horizontal"),l=(i=e.axes.find(d=>d.type==="band"))!==null&&i!==void 0?i:e.axes.find(d=>(o?["left","right"]:["top","bottom"]).includes(d.orient));if(l&&!l.bandSize&&!l.maxBandSize&&!l.minBandSize&&e.autoBandSize){const d=isObject$1(e.autoBandSize)&&(n=e.autoBandSize.extend)!==null&&n!==void 0?n:0,{barMaxWidth:u,barMinWidth:f,barWidth:g,barGapInGroup:_}=e.series.find(y=>y.type==="bar");this._applyAxisBandSize(l,d,{barMaxWidth:u,barMinWidth:f,barWidth:g,barGapInGroup:_})}}}class BarChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=BarChartSpecTransformer,this.type="bar",this.seriesType=SeriesTypeEnum.bar}}BarChart.type="bar",BarChart.seriesType=SeriesTypeEnum.bar,BarChart.transformerConstructor=BarChartSpecTransformer,mixin(BarChart,StackChartMixin);const registerBarChart=()=>{registerBarSeries(),Factory$1.registerChart(BarChart.type,BarChart)};class Rect3dMark extends BaseMark{constructor(){super(...arguments),this.type=Rect3dMark.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{width:void 0,height:void 0,length:3})}}Rect3dMark.type="rect3d";const registerRect3dMark=()=>{Factory$1.registerMark(Rect3dMark.type,Rect3dMark),registerRect3dGraphic(),registerVGrammarRectAnimation()};class Bar3dSeriesSpecTransformer extends BarSeriesSpecTransformer{_transformLabelSpec(e){this._addMarkLabelSpec(e,"bar3d")}}class Bar3dSeries extends BarSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.bar3d,this._barMarkName="bar3d",this._barMarkType="rect3d",this.transformerConstructor=Bar3dSeriesSpecTransformer}}Bar3dSeries.type=SeriesTypeEnum.bar3d,Bar3dSeries.mark=bar3dSeriesMark,Bar3dSeries.transformerConstructor=Bar3dSeriesSpecTransformer;const registerBar3dSeries=()=>{registerBar3dAnimation(),registerRect3dMark(),registerCartesianBandAxis(),registerCartesianLinearAxis(),Factory$1.registerSeries(Bar3dSeries.type,Bar3dSeries)};class Bar3dChartSpecTransformer extends BarChartSpecTransformer{_getDefaultSeriesSpec(e){const i=super._getDefaultSeriesSpec(e);return i.barWidth=e.barWidth,i.barMaxWidth=e.barMaxWidth,i.barMinWidth=e.barMinWidth,i.barGapInGroup=e.barGapInGroup,i}}const register3DPlugin=()=>{registerDirectionalLight(),registerOrthoCamera(),registerViewTransform3dPlugin()},registerAnimate=()=>{registerAnimate$1(),registerVGrammarCommonAnimation()};class Bar3dChart extends BarChart{constructor(){super(...arguments),this.transformerConstructor=Bar3dChartSpecTransformer,this.type="bar3d",this.seriesType=SeriesTypeEnum.bar3d}}Bar3dChart.type="bar3d",Bar3dChart.seriesType=SeriesTypeEnum.bar3d,Bar3dChart.transformerConstructor=Bar3dChartSpecTransformer;const registerBar3dChart=()=>{register3DPlugin(),registerBar3dSeries(),Factory$1.registerChart(Bar3dChart.type,Bar3dChart)},SCATTER_DEFAULT_SIZE=10,SCATTER_DEFAULT_RANGE_SIZE=[10,20],SCATTER_DEFAULT_SIZE_SCALE_TYPE=ScaleEnum.Linear,SCATTER_DEFAULT_SHAPE="circle",SCATTER_DEFAULT_SHAPE_SCALE_TYPE=ScaleEnum.Ordinal,SCATTER_DEFAULT_RANGE_SHAPE=["circle","square","triangle","diamond","star"],scatterPresetAnimation=(r,e)=>e==="fadeIn"?{type:"fadeIn"}:{type:"scaleIn"},registerScatterAnimation=()=>{Factory$1.registerAnimation("scatter",(r,e)=>Object.assign({appear:scatterPresetAnimation(0,e)},ScaleInOutAnimation))},scatterSeriesMark=Object.assign(Object.assign({},baseSeriesMark),{point:{name:"point",type:"symbol"}});class ScatterSeriesSpecTransformer extends BaseSeriesSpecTransformer{_transformLabelSpec(e){this._addMarkLabelSpec(e,"point")}}class ScatterSeries extends CartesianSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.scatter,this.transformerConstructor=ScatterSeriesSpecTransformer,this._invalidType="zero"}setAttrFromSpec(){super.setAttrFromSpec(),this._size=this._spec.size,this._sizeField=this._spec.sizeField,this._shape=this._spec.shape,this._shapeField=this._spec.shapeField}_getSeriesAttribute(e,i,{defaultScaleType:n,defaultRange:o},l){var d,u,f,g;if(isFunction(i))return i;if(isArray(i)){if(isNil(e))return(d=this._option)===null||d===void 0||d.onError(`${l}Field is required.`),i;if(n!=="ordinal"&&i.length>2)return(u=this._option)===null||u===void 0||u.onError(`${l} length is invalid, specify up to 2 ${l}s.`),i;const _=`${PREFIX}_series_scatter_${this.id}_scale_${l}`;return this._option.globalScale.registerModelScale({id:_,type:n,domain:[{dataId:this._rawData.name,fields:[e]}],range:i}),{scale:_,field:e}}if(isObject$1(i)){if(isNil(e))return(f=this._option)===null||f===void 0||f.onError(`${l}Field is required.`),i;const _=`${PREFIX}_series_scatter_${this.id}_scale_${l}`,y=Object.assign({id:_,type:n,domain:[{dataId:this._rawData.name,fields:[e]}],range:o},i);return this._option.globalScale.registerModelScale(y),{scale:y.id,field:e}}return(g=this._option)===null||g===void 0||g.onError(`${l} attribute is invalid.`),i}getSizeAttribute(e,i){return isNil(i)?SCATTER_DEFAULT_SIZE:isNumber(i)?i:isString(i)&&isNumeric(i)?parseFloat(i):this._getSeriesAttribute(e,i,{defaultScaleType:SCATTER_DEFAULT_SIZE_SCALE_TYPE,defaultRange:SCATTER_DEFAULT_RANGE_SIZE},"size")}getShapeAttribute(e,i){return isNil(i)?SCATTER_DEFAULT_SHAPE:isString(i)?i:this._getSeriesAttribute(e,i,{defaultScaleType:SCATTER_DEFAULT_SHAPE_SCALE_TYPE,defaultRange:SCATTER_DEFAULT_RANGE_SHAPE},"shape")}initMark(){var e,i;this._symbolMark=this._createMark(ScatterSeries.mark.point,{groupKey:this._seriesField,isSeriesMark:!0,stateSort:(e=this._spec.point)===null||e===void 0?void 0:e.stateSort},{progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold,morph:shouldMarkDoMorph(this._spec,ScatterSeries.mark.point.name),morphElementKey:this.getDimensionField()[0],setCustomizedShape:(i=this._spec.point)===null||i===void 0?void 0:i.customShape})}initMarkStyle(){this.initSymbolMarkStyle()}initAnimation(){var e,i,n;const o=getGroupAnimationParams(this),l=(i=(e=this._spec)===null||e===void 0?void 0:e.animationAppear)===null||i===void 0?void 0:i.preset;this._symbolMark.setAnimationConfig(animationConfig((n=Factory$1.getAnimationInKey("scatter"))===null||n===void 0?void 0:n({},l),userAnimationConfig("point",this._spec,this._markAttributeContext),o))}initSymbolMarkStyle(){const e=this._symbolMark;e&&(this._invalidType!=="zero"&&this.setMarkStyle(e,{visible:this._getInvalidDefined.bind(this)}),this.setMarkStyle(e,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),z:this._fieldZ?this.dataToPositionZ.bind(this):null,fill:this.getColorAttribute(),size:isNumber(this._size)||isFunction(this._size)?this._size:SCATTER_DEFAULT_SIZE,symbolType:isString(this._shape)||isFunction(this._shape)?this._shape:SCATTER_DEFAULT_SHAPE},STATE_VALUE_ENUM.STATE_NORMAL,AttributeLevel.Series),(isValid(this._sizeField)||isValid(this._size))&&this.setMarkStyle(e,{size:this.getSizeAttribute(this._sizeField,this._size)},STATE_VALUE_ENUM.STATE_NORMAL,AttributeLevel.User_Mark),(isValid(this._shapeField)||isValid(this._shape))&&this.setMarkStyle(e,{symbolType:this.getShapeAttribute(this._shapeField,this._shape)},STATE_VALUE_ENUM.STATE_NORMAL,AttributeLevel.User_Mark))}initTooltip(){super.initTooltip(),this._symbolMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._symbolMark)}viewDataStatisticsUpdate(e){super.viewDataStatisticsUpdate(e);const i=[this.getDimensionField()[0],this.getStackValueField()].every(n=>{var o,l,d;return n&&((d=(l=(o=this.getViewDataStatistics())===null||o===void 0?void 0:o.latestData)===null||l===void 0?void 0:l[n])===null||d===void 0?void 0:d.allValid)});this._invalidType==="zero"||i?this.setMarkStyle(this._symbolMark,{visible:!0},"normal",AttributeLevel.Series):this.setMarkStyle(this._symbolMark,{visible:this._getInvalidDefined.bind(this)},"normal",AttributeLevel.Series),this._symbolMark.getProduct()&&this._symbolMark.compileEncode()}initLabelMarkStyle(e){e&&(this._labelMark=e,this.setMarkStyle(e,{fill:this.getColorAttribute(),text:i=>i[this.getStackValueField()],z:this._fieldZ?this.dataToPositionZ.bind(this):null},STATE_VALUE_ENUM.STATE_NORMAL,AttributeLevel.Series),this._invalidType!=="zero"&&this.setMarkStyle(e,{visible:this._getInvalidDefined.bind(this)},STATE_VALUE_ENUM.STATE_NORMAL,AttributeLevel.Series))}handleZoom(e){var i,n;this.getMarksWithoutRoot().forEach(l=>{const d=l.getProduct();!d||!d.elements||!d.elements.length||d.elements.forEach((u,f)=>{const g=u.getGraphicItem(),_=u.getDatum(),y=this.dataToPosition(_);y&&g&&g.translateTo(y.x,y.y)})});const o=(n=(i=this._labelMark)===null||i===void 0?void 0:i.getComponent())===null||n===void 0?void 0:n.getProduct();o&&o.evaluate(null,null)}handlePan(e){this.handleZoom(e)}getDefaultShapeType(){return"circle"}getActiveMarks(){return[this._symbolMark]}}ScatterSeries.type=SeriesTypeEnum.scatter,ScatterSeries.mark=scatterSeriesMark,ScatterSeries.transformerConstructor=ScatterSeriesSpecTransformer;const registerScatterSeries=()=>{registerSymbolMark(),registerScatterAnimation(),registerCartesianBandAxis(),registerCartesianLinearAxis(),Factory$1.registerSeries(ScatterSeries.type,ScatterSeries)};class ScatterChartSpecTransformer extends CartesianChartSpecTransformer{_getDefaultSeriesSpec(e){return super._getDefaultSeriesSpec(e,["point","size","shape","shapeField","sizeField"])}}class ScatterChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=ScatterChartSpecTransformer,this.type="scatter",this.seriesType=SeriesTypeEnum.scatter}}ScatterChart.type="scatter",ScatterChart.seriesType=SeriesTypeEnum.scatter,ScatterChart.transformerConstructor=ScatterChartSpecTransformer,mixin(ScatterChart,StackChartMixin);const registerScatterChart=()=>{registerScatterSeries(),Factory$1.registerChart(ScatterChart.type,ScatterChart)};geoPath();const projections={},projectionProperties=["clipAngle","clipExtent","scale","translate","center","rotate","precision","reflectX","reflectY","parallels","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function create$1(r,e){return function i(){const n=e();return n.type=r,n.path=geoPath().projection(n),n.copy=n.copy||function(){const o=i();return projectionProperties.forEach(l=>{n[l]&&o[l](n[l]())}),o.path.pointRadius(n.path.pointRadius()),o},n}}function projection(r,e){r&&isString(r)||error("Projection type must be a name string.");const i=r.toLowerCase();return arguments.length>1&&(projections[i]=create$1(i,e)),projections[i]||null}const builtInProjections={albers:geoAlbers,albersusa:geoAlbersUsa,azimuthalequalarea:geoAzimuthalEqualArea,azimuthalequidistant:geoAzimuthalEquidistant,conicconformal:geoConicConformal,conicequalarea:geoConicEqualArea,conicequidistant:geoConicEquidistant,equalEarth:geoEqualEarth,equirectangular:geoEquirectangular,gnomonic:geoGnomonic,identity:geoIdentity,mercator:geoMercator,naturalEarth1:geoNaturalEarth1,orthographic:geoOrthographic,stereographic:geoStereographic,transversemercator:geoTransverseMercator};Object.keys(builtInProjections).forEach(r=>{projection(r,builtInProjections[r])});const Feature="Feature",FeatureCollection="FeatureCollection";function featurize(r){return r.type===FeatureCollection?r.features:array(r).filter(e=>!isNil(e)).map(e=>e.type===Feature?e:{type:Feature,geometry:e})}function collectGeoJSON(r){const e=array(r);return e.length===1?e[0]:{type:FeatureCollection,features:e.reduce((i,n)=>i.concat(featurize(n)),[])}}function create(r){const e=projection((r||"mercator").toLowerCase());return e||error("Unrecognized projection type: "+r),e()}function set(r,e,i){isFunction(r[e])&&r[e](i)}const projectionOptions=projectionProperties.concat(["pointRadius","fit","extent","size"]);function parseProjection(r,e){let i=[];return r&&Object.keys(r).forEach(n=>{projectionOptions.includes(n)&&(i=i.concat(parseFunctionType(r[n],e)))}),i}let Projection$1=class extends GrammarBase{constructor(e){super(e),this.grammarType="projection"}parse(e){return super.parse(e),this.pointRadius(e.pointRadius),this.size(e.size),this.extent(e.extent),this.fit(e.fit),this.configure(e),this.commit(),this}pointRadius(e){return isNil(this.spec.pointRadius)||this.detach(parseFunctionType(this.spec.pointRadius,this.view)),this.spec.pointRadius=e,this.attach(parseFunctionType(e,this.view)),this.commit(),this}size(e){return isNil(this.spec.size)||this.detach(parseFunctionType(this.spec.size,this.view)),this.spec.size=e,this.attach(parseFunctionType(e,this.view)),this.commit(),this}extent(e){return isNil(this.spec.extent)||this.detach(parseFunctionType(this.spec.extent,this.view)),this.spec.extent=e,this.attach(parseFunctionType(e,this.view)),this.commit(),this}fit(e){return isNil(this.spec.fit)||this.detach(parseFunctionType(this.spec.fit,this.view)),this.spec.fit=e,this.attach(parseFunctionType(e,this.view)),this.commit(),this}configure(e){return this.detach(parseProjection(this.spec,this.view)),isNil(e)?this.spec={type:this.spec.type,fit:this.spec.fit,extent:this.spec.extent,size:this.spec.size,pointRadius:this.spec.pointRadius}:(Object.assign(this.spec,e),this.attach(parseProjection(this.spec,this.view))),this.commit(),this}evaluate(e,i){if(this.projection&&this.projection.type===this.spec.type||(this.projection=create(this.spec.type),this.projection.type=this.spec.type),projectionProperties.forEach(n=>{isNil(this.spec[n])||set(this.projection,n,invokeFunctionType(this.spec[n],i,projection))}),isNil(this.spec.pointRadius)||this.projection.path.pointRadius(invokeFunctionType(this.spec.pointRadius,i,projection)),!(isNil(this.spec.fit)||isNil(this.spec.extent)&&isNil(this.spec.size))){const n=collectGeoJSON(invokeFunctionType(this.spec.fit,i,projection));this.spec.extent?this.projection.fitExtent(invokeFunctionType(this.spec.extent,i,projection),n):this.spec.size&&this.projection.fitSize(invokeFunctionType(this.spec.size,i,projection),n)}return this.projection}output(){return this.projection}};const registerProjection=()=>{Factory.registerGrammar("projection",Projection$1,"projections")},lookup=(r,e)=>{if(!e.from||!e.from())return r;const i=e.fields,n=e.key,o=e.values,l=e.default,d=e.as||[i],u=e.from().reduce(function(g,_){return _[i]&&g.set(_[i],_),g},new Map);let f;if(isFunction(e.set))f=function(g){const _=u.get(g[n]);e.set(g,_)};else if(o){const g=o.length;f=function(_){const y=u.get(_[n]);if(isNil(y))for(let b=0;b<g;++b)_[d[b]]=l;else for(let b=0;b<g;++b)_[d[b]]=y[o[b]]}}else f=function(g){const _=u.get(g[n]);g[d[0]]=isValid(_)?_:l};return r.length===0?[]:r.map(g=>(f(g),g))};class GeoSeries extends BaseSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.geo,this.coordinate="geo",this._nameProperty="name"}getMapViewData(){var e;return(e=this._mapViewData)===null||e===void 0?void 0:e.getDataView()}get nameField(){return this._nameField}set nameField(e){this._nameField=e}get valueField(){return this._valueField}set valueField(e){this._valueField=e}getNameProperty(){return this._nameProperty}getCentroidProperty(){return this._centroidProperty}getCoordinateHelper(){return this._coordinateHelper}setCoordinateHelper(e){this._coordinateHelper=e}getStatisticFields(){const e=[];return e.push({key:this._nameField,operations:["values"]}),e.push({key:this._valueField,operations:["max","min"]}),e}getGroupFields(){return null}dataToPosition(e,i){var n;let o=null;if(!e||i&&!this.isDatumInViewData(e))return o;const{dataToPosition:l,latitudeField:d,longitudeField:u}=this._coordinateHelper;if(o=this.nameToPosition(e),o===null){const f=u?e==null?void 0:e[u]:Number.NaN,g=d?e==null?void 0:e[d]:Number.NaN;o=(n=l==null?void 0:l([f,g]))!==null&&n!==void 0?n:null}return o}nameToPosition(e){const i=this.getDatumName(e);return isNil(i)?null:this.nameValueToPosition(i)}nameValueToPosition(e){var i,n;const o=(n=(i=this.getMapViewData())===null||i===void 0?void 0:i.latestData)===null||n===void 0?void 0:n.filter(f=>this.getDatumName(f)===e)[0];if(isNil(o))return null;const{dataToPosition:l}=this._coordinateHelper,d=this.getDatumCenter(o),u=l==null?void 0:l(d);return isNil(u)||isNaN(u.x)||isNaN(u.y)?null:u}dataToLatitude(e){if(!this._coordinateHelper)return Number.NaN;const{dataToLatitude:i}=this._coordinateHelper;return i(e)}dataToLongitude(e){if(!this._coordinateHelper)return Number.NaN;const{dataToLatitude:i}=this._coordinateHelper;return i(e)}valueToPosition(e,i){return{x:this.dataToLongitude(e),y:this.dataToLatitude(i)}}positionToData(e){}latitudeToData(e){}longitudeToData(e){}dataToPositionX(e){var i;return(i=this._option)===null||i===void 0||i.onError("Method not implemented."),0}dataToPositionY(e){var i;return(i=this._option)===null||i===void 0||i.onError("Method not implemented."),0}dataToPositionZ(e){var i;return(i=this._option)===null||i===void 0||i.onError("Method not implemented."),0}release(){super.release(),this._mapViewData.release(),this._mapViewData=this._mapViewDataStatistics=null}getStackGroupFields(){return[this._nameField]}getStackValueField(){return this._spec.valueField}compileData(){var e;(e=this._mapViewData)===null||e===void 0||e.compile()}initStatisticalData(){if(super.initStatisticalData(),this._mapViewData){const e=`${PREFIX}_series_${this.id}_mapViewDataStatic`;this._mapViewDataStatistics=this.createStatisticalData(e,this._mapViewData.getDataView()),this._mapViewData.getDataView().target.removeListener("change",this._mapViewDataStatistics.reRunAllTransform)}}getSeriesKeys(){var e,i,n,o,l;return this._seriesField?(l=(i=(e=this.getRawDataStatisticsByField(this._seriesField))===null||e===void 0?void 0:e.values)!==null&&i!==void 0?i:(o=(n=this._mapViewDataStatistics)===null||n===void 0?void 0:n.latestData[this._seriesField])===null||o===void 0?void 0:o.values)!==null&&l!==void 0?l:[]:this.name?[this.name]:this.userId?[`${this.userId}`]:[`${this.type}_${this.id}`]}fillData(){var e,i;super.fillData(),(e=this._mapViewData.getDataView())===null||e===void 0||e.reRunAllTransform(),(i=this._mapViewDataStatistics)===null||i===void 0||i.reRunAllTransform()}getActiveMarks(){return[]}}const DEFAULT_MAP_LOOK_UP_KEY=`${PREFIX}_MAP_LOOK_UP_KEY`,map=(r,e)=>(r.features&&r.features.forEach((i,n)=>{var o;i[DEFAULT_DATA_INDEX]=n;const l=(o=i.properties)===null||o===void 0?void 0:o[e.nameProperty];e.nameMap&&e.nameMap[l]?i[DEFAULT_MAP_LOOK_UP_KEY]=e.nameMap[l]:i[DEFAULT_MAP_LOOK_UP_KEY]=l}),r.features);class MapSeriesTooltipHelper extends BaseSeriesTooltipHelper{constructor(){super(...arguments),this.dimensionTooltipTitleCallback=e=>{var i;const n=this.series;return(i=this._getDimensionData(e))!==null&&i!==void 0?i:n.getDatumName(e)}}}class PathMark extends BaseMark{constructor(){super(...arguments),this.type=PathMark.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{lineWidth:0,path:""})}}PathMark.type="path";const registerPathMark=()=>{Factory$1.registerMark(PathMark.type,PathMark),registerPathGraphic()},mapSeriesMark=Object.assign(Object.assign({},baseSeriesMark),{area:{name:"area",type:"path"}});class Projection{constructor(e){this.projection=projection(e.type)()}fit(e,i,n){const o={type:"FeatureCollection",features:n};this.projection.fitExtent([e,i],o)}center(e){var i,n;(n=(i=this.projection)===null||i===void 0?void 0:i.center)===null||n===void 0||n.call(i,e)}project(e){var i;return(i=this.projection)===null||i===void 0?void 0:i.call(this,e)}shape(e){var i,n;return(n=(i=this.projection)===null||i===void 0?void 0:i.path)===null||n===void 0?void 0:n.call(i,e)}invert(e){var i,n;return(n=(i=this.projection)===null||i===void 0?void 0:i.invert)===null||n===void 0?void 0:n.call(i,e)}scale(e){var i;if(!((i=this.projection)===null||i===void 0)&&i.scale){if(e===void 0)return this.projection.scale();this.projection.scale(e)}}translate(e){var i;if(!((i=this.projection)===null||i===void 0)&&i.scale){if(e===void 0)return this.projection.translate();this.projection.translate(e)}}evaluate(e,i,n){const o=this.projection.copy();return o==null?void 0:o.fitExtent([e,i],{type:"FeatureCollection",features:n})}}class DeskTopTrigger{parserScrollEvent(e){return e&&!(e.ctrlKey||e.deltaY===0&&e.deltaX===0)&&(e.scrollX=e.deltaX,e.scrollY=e.deltaY,e)}parserZoomEvent(e){if(!e)return e;const i=Math.pow(1.0005,-e.deltaY*Math.pow(16,e.deltaMode));return e.zoomDelta=i,e.zoomX=e.canvasX,e.zoomY=e.canvasY,e}clearZoom(){}clearScroll(){}clearDrag(){}parserDragEvent(){return!0}}class MobileTrigger{constructor(){this._lastScale=0}clearZoom(){this._lastScale=0,this.pointerId=null}parserDragEvent(e){return!0}parserZoomEvent(e){const i=e.scale;if(this._lastScale===0)return this._lastScale=i,e;e.zoomDelta=i/this._lastScale;const n=e.center;return e.zoomX=n.x,e.zoomY=n.y,this._lastScale=i,e}parserScrollEvent(e){return e}clearScroll(){}clearDrag(){}}function getDefaultTriggerEventByMode(r){return r===RenderModeEnum["desktop-browser"]||r===RenderModeEnum["desktop-miniApp"]?{start:"pointerdown",move:"pointermove",end:["pointerup","pointerupoutside"],zoom:"wheel",zoomEnd:"pointerup",scroll:"wheel",trigger:DeskTopTrigger}:isMobileLikeMode(r)||isMiniAppLikeMode(r)?{start:"pointerdown",move:"pointermove",end:["pointerup","pointerupoutside"],zoom:"pinch",zoomEnd:"pinchend",scroll:"pan",scrollEnd:"panend",trigger:MobileTrigger}:null}const delayMap={debounce,throttle};class Zoomable{constructor(){this._isGestureListener=!1}initZoomable(e,i=RenderModeEnum["desktop-browser"]){this._eventObj=e,this._renderMode=i,this._gestureController=this._option.getChart().getVGrammarView().renderer._gestureController,this._isGestureListener=isMobileLikeMode(this._renderMode)||isMiniAppLikeMode(this._renderMode),getDefaultTriggerEventByMode(this._renderMode)&&(this._clickEnable=!0,this._zoomableTrigger=new(this._getZoomTriggerEvent("trigger")))}_getZoomTriggerEvent(e){return getDefaultTriggerEventByMode(this._renderMode)[e]}_zoomEventDispatch(e,i,n){if(!this._isGestureListener&&!e.event)return;const o=this._isGestureListener?e:e.event.clone();this._zoomableTrigger.parserZoomEvent(o);const{zoomDelta:l,zoomX:d,zoomY:u,path:f}=o;if(!f.some(_=>_.name&&_.name.includes("region"))||isNil(l)||!pointInRect({x:d,y:u},this._getRegionOrSeriesLayout(i),!1))return;let g={};n&&(g=n({zoomDelta:l,zoomX:d,zoomY:u},o)),this._eventObj.emit("zoom",Object.assign(Object.assign({scale:o.zoomDelta,scaleCenter:{x:o.zoomX,y:o.zoomY}},g),{model:this}))}_getRegionOrSeriesLayout(e){e.type!=="region"&&(e=e.getRegion());const{x:i,y:n,width:o,height:l}=e.layout.getLayout();return{x1:i,y1:n,x2:i+o,y2:n+l}}_bindZoomEventAsRegion(e,i,n,o){var l,d;const u=(l=o==null?void 0:o.delayType)!==null&&l!==void 0?l:"throttle",f=(d=o==null?void 0:o.delayTime)!==null&&d!==void 0?d:0,g=this._isGestureListener?this._gestureController:e,_=this._isGestureListener?[this._getZoomTriggerEvent("zoom")]:[this._getZoomTriggerEvent("zoom"),{level:Event_Bubble_Level.chart,consume:!0}],y=this._isGestureListener?[this._getZoomTriggerEvent("zoomEnd")]:[this._getZoomTriggerEvent("zoomEnd"),{level:Event_Bubble_Level.chart,consume:!1}];g.on(...y,delayMap[u](b=>{this._zoomableTrigger.clearZoom()},f)),g.on(..._,delayMap[u](b=>{this._zoomEventDispatch(b,i,n)},f))}initZoomEventOfSeries(e,i,n){this._option.disableTriggerEvent||getDefaultTriggerEventByMode(this._renderMode)&&this._bindZoomEventAsRegion(e.event,e,i,n)}initZoomEventOfRegions(e,i,n,o){this._option.disableTriggerEvent||getDefaultTriggerEventByMode(this._renderMode)&&e.forEach(l=>{i?l.getSeries().forEach(d=>{i(d)&&this._bindZoomEventAsRegion(d.event,d,n,o)}):this._bindZoomEventAsRegion(this._eventObj,l,n,o)})}_scrollEventDispatch(e,i,n){let o=!1;if(!this._isGestureListener&&(!e.event||this._option.disableTriggerEvent))return o;const l=this._isGestureListener?e:e.event;this._zoomableTrigger.parserScrollEvent(l);const{scrollX:d,scrollY:u,canvasX:f,canvasY:g}=l;return isNil(d)&&isNil(u)||pointInRect({x:f,y:g},this._getRegionOrSeriesLayout(i),!1)&&(n&&(o=n({scrollX:d,scrollY:u},l)),this._eventObj.emit("scroll",{scrollX:d,scrollY:u,model:this})),o}_bindScrollEventAsRegion(e,i,n,o){var l,d;const u=(l=o==null?void 0:o.delayType)!==null&&l!==void 0?l:"throttle",f=(d=o==null?void 0:o.delayTime)!==null&&d!==void 0?d:0,g=this._isGestureListener?this._gestureController:e,_=this._isGestureListener?[this._getZoomTriggerEvent("scroll")]:[this._getZoomTriggerEvent("scroll"),{level:Event_Bubble_Level.chart,consume:!0}],y=this._isGestureListener?[this._getZoomTriggerEvent("scrollEnd")]:[this._getZoomTriggerEvent("scrollEnd"),{level:Event_Bubble_Level.chart,consume:!1}];g.on(...y,delayMap[u](b=>{this._zoomableTrigger.clearScroll()},f)),g.on(..._,delayMap[u](b=>this._scrollEventDispatch(b,i,n),f))}initScrollEventOfSeries(e,i,n){getDefaultTriggerEventByMode(this._renderMode)&&this._bindScrollEventAsRegion(e.event,e,i,n)}initScrollEventOfRegions(e,i,n,o){this._option.disableTriggerEvent||getDefaultTriggerEventByMode(this._renderMode)&&e.forEach(l=>{i?l.getSeries().forEach(d=>{i(d)&&this._bindScrollEventAsRegion(d.event,d,n,o)}):this._bindScrollEventAsRegion(this._eventObj,l,n,o)})}_bindDragEventAsRegion(e,i,n,o){e.on(this._getZoomTriggerEvent("start"),{level:Event_Bubble_Level.chart},l=>{if(!l.event)return;const{event:d}=l;pointInRect({x:d.canvasX,y:d.canvasY},this._getRegionOrSeriesLayout(i),!1)&&this._handleDrag(l,n,o)}),e.on("click",{level:Event_Bubble_Level.chart},()=>!this._clickEnable)}initDragEventOfSeries(e,i,n){this._option.disableTriggerEvent||getDefaultTriggerEventByMode(this._renderMode)&&e.event.on(this._getZoomTriggerEvent("start"),{level:Event_Bubble_Level.model,filter:({model:o})=>(o==null?void 0:o.id)===e.id},o=>{this._handleDrag(o,i,n)})}initDragEventOfRegions(e,i,n,o){this._option.disableTriggerEvent||getDefaultTriggerEventByMode(this._renderMode)&&e.forEach(l=>{i?l.getSeries().forEach(d=>{i(d)&&(d.event.on(this._getZoomTriggerEvent("start"),{level:Event_Bubble_Level.model,filter:({model:u})=>(u==null?void 0:u.id)===d.id},u=>{this._handleDrag(u,n)}),d.event.on("click",{level:Event_Bubble_Level.model,filter:({model:u})=>(u==null?void 0:u.id)===d.id},()=>!this._clickEnable))}):this._bindDragEventAsRegion(this._eventObj,l,n,o)})}_handleDrag(e,i,n){var o,l,d;if(this._option.disableTriggerEvent||(this._clickEnable=!1,!this._zoomableTrigger.parserDragEvent(e.event)))return;const u=(o=n==null?void 0:n.delayType)!==null&&o!==void 0?o:"throttle",f=(l=n==null?void 0:n.delayTime)!==null&&l!==void 0?l:0,g=(d=n==null?void 0:n.realTime)===null||d===void 0||d,_=this._getZoomTriggerEvent("move"),y=this._getZoomTriggerEvent("end"),b=e.event;let S=b.canvasX,v=b.canvasY,A=b.canvasX,x=b.canvasY;const T=delayMap[u](E=>{this._clickEnable=!0;const P=E.event,R=[P.canvasX-A,P.canvasY-x];A=P.canvasX,x=P.canvasY,!g&&i&&i(R,E.event),this._eventObj.emit("panend",{delta:R,model:this}),this._zoomableTrigger.pointerId=null,this._eventObj.off(_,{level:Event_Bubble_Level.chart,source:Event_Source_Type.chart},C),y.forEach(L=>{this._eventObj.off(L,{level:Event_Bubble_Level.chart,source:Event_Source_Type.chart},T),this._eventObj.allow(L)})},f),C=delayMap[u](E=>{if(!this._zoomableTrigger.parserDragEvent(E.event))return;this._clickEnable=!1,y.forEach(L=>this._eventObj.prevent(L,T));const P=E.event,R=[P.canvasX-S,P.canvasY-v];S=P.canvasX,v=P.canvasY,g&&i&&i(R,E.event),this._eventObj.emit("panmove",{delta:R,model:this})},f);this._eventObj.on(_,{level:Event_Bubble_Level.chart,source:Event_Source_Type.chart},C),y.forEach(E=>{this._eventObj.on(E,{level:Event_Bubble_Level.chart,source:Event_Source_Type.chart},T)})}}function projectionName(r,e){return`${PREFIX}_${e}_${r}`}class GeoCoordinate extends BaseComponent{constructor(){super(...arguments),this.type=ComponentTypeEnum.geoCoordinate,this.name=ComponentTypeEnum.geoCoordinate,this.layoutType="none",this.layoutZIndex=LayoutZIndex.Mark,this._projectionSpec={name:projectionName(this.type,this.id),type:"mercator"},this._actualScale=1,this._initialScale=1,this.effect={scaleUpdate:()=>{this.coordinateHelper()}},this._handleChartZoom=(e,i)=>{var n,o,l,d,u,f;let g=e.zoomDelta;const _=this._actualScale;return this._actualScale*=g,this._actualScale<((n=this._spec.zoomLimit)===null||n===void 0?void 0:n.min)?(this._actualScale=(o=this._spec.zoomLimit)===null||o===void 0?void 0:o.min,g=((l=this._spec.zoomLimit)===null||l===void 0?void 0:l.min)/_):this._actualScale>((d=this._spec.zoomLimit)===null||d===void 0?void 0:d.max)&&(this._actualScale=(u=this._spec.zoomLimit)===null||u===void 0?void 0:u.max,g=((f=this._spec.zoomLimit)===null||f===void 0?void 0:f.max)/_),this.zoom(g,[e.zoomX,e.zoomY]),{scale:g,totalScale:this._actualScale}},this.pan=(e=[0,0])=>{var i,n,o;const l=(n=(i=this._projection)===null||i===void 0?void 0:i.translate())!==null&&n!==void 0?n:[0,0];let d=l[0],u=l[1];d+=e[0],u+=e[1],(o=this._projection)===null||o===void 0||o.translate([d,u])}}get longitudeField(){return this._longitudeField}get latitudeField(){return this._latitudeField}get projectionSpec(){return this._projectionSpec}setProjection(e){this._projectionSpec=Object.assign(Object.assign({},e),{name:this._projectionSpec.name})}getZoom(){return this._actualScale}static getSpecInfo(e){if(isNil(e))return null;const i=[];return e.region.forEach((n,o)=>{if(n.coordinate==="geo"){const l=Object.assign(Object.assign({},n),{padding:0});i.push({spec:l,regionIndex:o,type:ComponentTypeEnum.geoCoordinate,specInfoPath:["component","geoCoordinate",o]})}}),i}setAttrFromSpec(){var e,i,n;super.setAttrFromSpec(),this._spec.roam&&this.initZoomable(this.event,this._option.mode),this._projectionSpec=mergeSpec(this._projectionSpec,this._spec.projection),this._projectionSpec.zoom>((e=this._spec.zoomLimit)===null||e===void 0?void 0:e.max)&&(this._projectionSpec.zoom=this._spec.zoomLimit.max),this._projectionSpec.zoom<((i=this._spec.zoomLimit)===null||i===void 0?void 0:i.min)&&(this._projectionSpec.zoom=this._spec.zoomLimit.min),this._actualScale=(n=this._projectionSpec.zoom)!==null&&n!==void 0?n:1,this._initialScale=this._actualScale,this._longitudeField=this._spec.longitudeField,this._latitudeField=this._spec.latitudeField}created(){super.created(),this._regions=this._option.getRegionsInIndex([this._option.regionIndex]),this.initProjection(),this.coordinateHelper(),this.initEvent(),this._initCenterCache()}dispatchZoom(e,i){const n=i||{x:this.getLayoutStartPoint().x+this.getLayoutRect().width/2,y:this.getLayoutStartPoint().y+this.getLayoutRect().height/2},{scale:o,totalScale:l}=this._handleChartZoom({zoomDelta:e,zoomX:n.x,zoomY:n.y});o!==1&&this.event.emit("zoom",{scale:o,scaleCenter:n,totalScale:l,model:this})}initEvent(){this.event.on(ChartEvent.scaleUpdate,{filter:({model:i})=>(i==null?void 0:i.id)===this.id},this.effect.scaleUpdate.bind(this));const{roam:e}=this._spec;e&&(this.initZoomEventOfRegions(this._regions,null,this._handleChartZoom),this.initDragEventOfRegions(this._regions,e.blank?null:()=>!0,this.pan),this._regions.forEach(i=>{i.getSeries().forEach(n=>{n.event.on("zoom",o=>(n.handleZoom(o),!0)),n.event.on("panmove",o=>(n.handlePan(o),!0))})}))}initProjection(){var e;this._projection=new Projection(this._projectionSpec),this._projection.projection!==null||(e=this._option)===null||e===void 0||e.onError("unsupported projection type!")}coordinateHelper(){const e={longitudeField:this._longitudeField,latitudeField:this._latitudeField,dataToPosition:this.dataToPosition.bind(this),dataToLongitude:this.dataToLongitude.bind(this),dataToLatitude:this.dataToLatitude.bind(this),shape:this.shape.bind(this),getCoordinateId:()=>this.id};this._regions.forEach(i=>{i.getSeries().forEach(n=>{n.type===SeriesTypeEnum.map||n.type===SeriesTypeEnum.pictogram?n.setCoordinateHelper(e):(n.setXAxisHelper(Object.assign(Object.assign({},e),{isContinuous:!0,dataToPosition:(o,l)=>{var d;let u=o[0];if(isNil(u)&&(l!=null&&l.datum)){const f=l.datum[n.getDimensionField()[0]];u=(d=this._centerCache.get(f))===null||d===void 0?void 0:d.x}return this.dataToLongitude(u)},valueToPosition:(o,l)=>{var d;if(isNil(o)&&(l!=null&&l.datum)){const u=l.datum[n.getDimensionField()[0]];o=(d=this._centerCache.get(u))===null||d===void 0?void 0:d.x}return this.dataToLongitude(o)},getFields:()=>[this._longitudeField],getAxisType:()=>this.type,getAxisId:()=>this.id,isInverse:()=>!1})),n.setYAxisHelper(Object.assign(Object.assign({},e),{isContinuous:!0,dataToPosition:(o,l)=>{var d;let u=o[0];if(isNil(u)&&(l!=null&&l.datum)){const f=l.datum[n.getDimensionField()[0]];u=(d=this._centerCache.get(f))===null||d===void 0?void 0:d.y}return this.dataToLatitude(u)},valueToPosition:(o,l)=>{var d;if(isNil(o)&&(l!=null&&l.datum)){const u=l.datum[n.getDimensionField()[0]];o=(d=this._centerCache.get(u))===null||d===void 0?void 0:d.y}return this.dataToLatitude(o)},getFields:()=>[this._latitudeField],getAxisType:()=>this.type,getAxisId:()=>this.id,isInverse:()=>!1})))})})}onLayoutEnd(e){this.setLayoutRect(this._regions[0].getLayoutRect()),this.setLayoutStartPosition(this._regions[0].getLayoutStartPoint());const{width:i,height:n}=this.getLayoutRect(),{translate:o,scale:l,center:d}=this.evaluateProjection([0,0],[i,n]);o&&this._projection.translate(o),l&&this._projection.scale(l),d&&this._projection.center(d),eachSeries(this._regions,u=>{var f,g;if(u.type===SeriesTypeEnum.map||u.type===SeriesTypeEnum.pictogram){(f=u.areaPath)===null||f===void 0||f.clear();const _=(g=u.getRootMark().getProduct())===null||g===void 0?void 0:g.getGroupGraphicItem();_&&_.attribute.postMatrix&&_.setAttributes({postMatrix:new Matrix})}}),this._actualScale=this._initialScale,super.onLayoutEnd(e)}onRender(e){}changeRegions(e){}_getNeedClearVRenderComponents(){return[]}collectFeatures(){const e=[];return this._regions.forEach(i=>{i.getSeries().forEach(n=>{var o,l;n.type!==SeriesTypeEnum.map&&n.type!==SeriesTypeEnum.pictogram||e.push(...(l=(o=n.getMapViewData())===null||o===void 0?void 0:o.latestData)!==null&&l!==void 0?l:[])})}),e}dataToPosition(e=[]){var i;const n=(i=this._projection)===null||i===void 0?void 0:i.project([e[0],e[1]]);return{x:n==null?void 0:n[0],y:n==null?void 0:n[1]}}dataToLatitude(e){var i;const n=(i=this._projection)===null||i===void 0?void 0:i.project([0,e]);return n==null?void 0:n[1]}dataToLongitude(e){var i;const n=(i=this._projection)===null||i===void 0?void 0:i.project([e,0]);return n==null?void 0:n[0]}zoom(e,i=[0,0]){var n,o,l,d,u,f;let g=(o=(n=this._projection)===null||n===void 0?void 0:n.scale())!==null&&o!==void 0?o:0;const _=(d=(l=this._projection)===null||l===void 0?void 0:l.translate())!==null&&d!==void 0?d:[0,0];let y=_[0],b=_[1];g*=e,y-=(i[0]-y)*(e-1),b-=(i[1]-b)*(e-1),(u=this._projection)===null||u===void 0||u.scale(g),(f=this._projection)===null||f===void 0||f.translate([y,b])}shape(e){return this._projection.shape(e)}invert(e){return this._projection.invert(e)}evaluateProjection(e,i){var n;const o=this._projection.evaluate(e,i,this.collectFeatures());let l=o.translate();const d=o.scale()*this._initialScale,u=(n=this._projectionSpec.center)!==null&&n!==void 0?n:o.invert([i[0]/2,i[1]/2]);return u&&(l=[i[0]/2,i[1]/2]),{translate:l,scale:d,center:u}}_initCenterCache(){this._centerCache||(this._centerCache=new Map),this._regions.forEach(e=>{e.getSeries().forEach(i=>{var n,o;i.type==="map"&&((o=(n=i.getMapViewData())===null||n===void 0?void 0:n.latestData)!==null&&o!==void 0?o:[]).forEach((l={})=>{const d=l[i.getDimensionField()[0]]||l[DEFAULT_MAP_LOOK_UP_KEY],u=i.getDatumCenter(l);d&&isValid(u)&&this._centerCache.set(d,{x:u[0],y:u[1]})})})})}_compareSpec(e,i){const n=super._compareSpec(e,i);return n.reMake||(n.reMake=["roam","longitudeField","latitudeField","projection","zoomLimit"].some(o=>!isEqual(i==null?void 0:i[o],e[o]))),n}release(){super.release(),this._centerCache&&this._centerCache.clear(),this._centerCache=null}}GeoCoordinate.type=ComponentTypeEnum.geoCoordinate,mixin(GeoCoordinate,Zoomable);const registerGeoCoordinate=()=>{Factory$1.registerComponent(GeoCoordinate.type,GeoCoordinate)};class MapSeriesSpecTransformer extends BaseSeriesSpecTransformer{_transformLabelSpec(e){this._addMarkLabelSpec(e,"area",void 0,void 0,!1)}}class MapSeries extends GeoSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.map,this.transformerConstructor=MapSeriesSpecTransformer,this._areaCache=new Map}getNameMap(){return this._nameMap}get areaPath(){return this._areaCache}setAttrFromSpec(){var e,i;super.setAttrFromSpec(),this.map=this._spec.map,this._nameMap=this._spec.nameMap,this._nameField=this._spec.nameField,this._valueField=this._spec.valueField,this._spec.nameProperty&&(this._nameProperty=this._spec.nameProperty),this._spec.centroidProperty&&(this._centroidProperty=this._spec.centroidProperty),this.map||(e=this._option)===null||e===void 0||e.onError(`map type '${this.map}' is not specified !`),geoSourceMap.get(this.map)||(i=this._option)===null||i===void 0||i.onError(`'${this.map}' data is not registered !`)}initData(){var e,i;super.initData(),registerDataSetInstanceTransform(this._dataSet,"copyDataView",copyDataView),registerDataSetInstanceTransform(this._dataSet,"map",map),registerDataSetInstanceTransform(this._dataSet,"lookup",lookup);const n=geoSourceMap.get(this.map);n||(e=this._option)===null||e===void 0||e.onError("no valid map data found!");const o=new DataView(this._dataSet,{name:`map_${this.id}_data`});o.parse([n],{type:"dataview"}).transform({type:"copyDataView",options:{deep:!0},level:TransformLevel.copyDataView}).transform({type:"map",options:{nameMap:this._nameMap,nameProperty:this._nameProperty}}).transform({type:"lookup",options:{from:()=>{var l;return(l=this._data)===null||l===void 0?void 0:l.getLatestData()},key:DEFAULT_MAP_LOOK_UP_KEY,fields:this._nameField,set:(l,d)=>{d&&Object.keys(d).forEach(u=>{u in l||(l[u]=d[u])})}}}),(i=this._data)===null||i===void 0||i.getDataView().target.addListener("change",o.reRunAllTransform),this._mapViewData=new SeriesData(this._option,o)}compileData(){var e;super.compileData(),(e=this._mapViewData)===null||e===void 0||e.compile()}initMark(){this._pathMark=this._createMark(MapSeries.mark.area,{groupKey:this.getDimensionField()[0],isSeriesMark:!0,skipBeforeLayouted:!0,dataView:this._mapViewData.getDataView(),dataProductId:this._mapViewData.getProductId()},{morph:shouldMarkDoMorph(this._spec,MapSeries.mark.area.name),morphElementKey:this.getDimensionField()[0]})}initMarkStyle(){const e=this._pathMark;e&&(this.setMarkStyle(e,{fill:i=>{var n,o,l,d;return isValid(i[(n=this._seriesField)!==null&&n!==void 0?n:DEFAULT_DATA_SERIES_FIELD])?((o=this._option.globalScale.getScale("color"))!==null&&o!==void 0?o:this._getDefaultColorScale()).scale(i[(l=this._seriesField)!==null&&l!==void 0?l:DEFAULT_DATA_SERIES_FIELD]):(d=this._spec)===null||d===void 0?void 0:d.defaultFillColor},path:this.getPath.bind(this)},"normal",AttributeLevel.Series),e.setPostProcess("fill",i=>isValid(i)?i:this._spec.defaultFillColor),this.setMarkStyle(e,{smoothScale:!0},"normal",AttributeLevel.Built_In))}initLabelMarkStyle(e){e&&(this._labelMark=e,this.setMarkStyle(e,{text:i=>this.getDatumName(i),x:i=>{var n;return(n=this.dataToPosition(i))===null||n===void 0?void 0:n.x},y:i=>{var n;return(n=this.dataToPosition(i))===null||n===void 0?void 0:n.y}}))}initAnimation(){var e;this._pathMark.setAnimationConfig(animationConfig((e=Factory$1.getAnimationInKey("fadeInOut"))===null||e===void 0?void 0:e(),userAnimationConfig("area",this._spec,this._markAttributeContext)))}initTooltip(){this._tooltipHelper=new MapSeriesTooltipHelper(this),this._pathMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pathMark)}getPath(e){var i;const n=this._areaCache.get(e[DEFAULT_DATA_INDEX]);if(n)return n.shape;const o=(i=this._coordinateHelper)===null||i===void 0?void 0:i.shape(e);return this._areaCache.set(e[DEFAULT_DATA_INDEX],{shape:o}),o}onEvaluateEnd(){this._mapViewData.updateData()}getDimensionField(){return[this.nameField]}getMeasureField(){return[this.valueField]}release(){super.release(),this._areaCache.clear(),this._nameMap={},this._mapViewData=null}handleZoom(e){var i,n,o;const{scale:l,scaleCenter:d}=e;if(l===1)return;const u=(i=this.getRootMark().getProduct())===null||i===void 0?void 0:i.getGroupGraphicItem();u&&(u.attribute.postMatrix||u.setAttributes({postMatrix:new Matrix}),u.scale(l,l,d));const f=(o=(n=this._labelMark)===null||n===void 0?void 0:n.getComponent())===null||o===void 0?void 0:o.getProduct();f&&f.evaluate(null,null)}handlePan(e){var i,n,o;const{delta:l}=e;if(l[0]===0&&l[1]===0)return;const d=(i=this.getRootMark().getProduct())===null||i===void 0?void 0:i.getGroupGraphicItem();d&&(d.attribute.postMatrix||d.setAttributes({postMatrix:new Matrix}),d.translate(l[0],l[1]));const u=(o=(n=this._labelMark)===null||n===void 0?void 0:n.getComponent())===null||o===void 0?void 0:o.getProduct();u&&u.evaluate(null,null)}getDatumCenter(e){var i,n,o,l;return this._centroidProperty&&(!((i=e.properties)===null||i===void 0)&&i[this._centroidProperty])?(n=e.properties)===null||n===void 0?void 0:n[this._centroidProperty]:isValidNumber(e.centroidX*e.centroidY)?[e.centroidX,e.centroidY]:!((o=e.properties)===null||o===void 0)&&o.center?e.properties.center:!((l=e.properties)===null||l===void 0)&&l.centroid?e.properties.centroid:[Number.NaN,Number.NaN]}getDatumName(e){var i;if(e[this.nameField])return e[this.nameField];const n=(i=e.properties)===null||i===void 0?void 0:i[this._nameProperty];if(n){if(this._spec.nameMap&&this._spec.nameMap[n])return this._spec.nameMap[n];if(this._spec.showDefaultName||!this._spec.nameMap)return n}return""}dataToPositionX(e){var i;return(i=this._option)===null||i===void 0||i.onError("Method not implemented."),0}dataToPositionY(e){var i;return(i=this._option)===null||i===void 0||i.onError("Method not implemented."),0}viewDataUpdate(e){var i,n,o;super.viewDataUpdate(e),(n=(i=this._mapViewData)===null||i===void 0?void 0:i.getDataView())===null||n===void 0||n.reRunAllTransform(),(o=this._mapViewData)===null||o===void 0||o.updateData()}_getDataIdKey(){return DEFAULT_DATA_INDEX}getActiveMarks(){return[this._pathMark]}}MapSeries.type=SeriesTypeEnum.map,MapSeries.mark=mapSeriesMark,MapSeries.transformerConstructor=MapSeriesSpecTransformer;const registerMapSeries=()=>{registerProjection(),registerGeoCoordinate(),registerPathMark(),Factory$1.registerSeries(MapSeries.type,MapSeries),Factory$1.registerImplement("registerMap",registerMapSource),Factory$1.registerImplement("unregisterMap",unregisterMapSource),registerFadeInOutAnimation()},WaterfallDefaultSeriesField=`${PREFIX}_waterfall_default_seriesField`,waterfall=(r,e)=>{if(!r||r.length===0)return r;const{indexField:i,total:n,groupData:o}=e,l=[],{dimensionValues:d,dimensionData:u}=o().latestData,f=Array.from(d[i]);let g={start:0,end:0,positive:0,negative:0,lastIndex:null};return f.forEach((_,y)=>{const b={start:g.end,end:g.end,lastIndex:g.lastIndex,lastEnd:g.end,index:_,isTotal:!1,positive:g.end,negative:g.end},S=u[_];if(S==null||S.forEach((v,A)=>{A===S.length-1?v[STACK_FIELD_TOTAL_TOP]=!0:delete v[STACK_FIELD_TOTAL_TOP]}),S.length>1){const v=A=>{if(n&&n.type!=="end"){if(n.type==="field"||n.type==="custom")return!!A[n.tagField]}else if(y===f.length-1)return!0;return!1};if(S.some(A=>v(A)))return g=computeTotalWithMultipleData(S,_,b,l,g,f,y,e,v),void l.push(b)}g=computeNormalData(S,_,b,l,g,f,y,e),l.push(b)}),l};function computeTotalWithMultipleData(r,e,i,n,o,l,d,u,f){i.isTotal=!0;const{valueField:g,startAs:_,endAs:y,total:b}=u,S=[],v=[];if(r.forEach(R=>{f(R)?v.push(R):S.push(R)}),v.length===r.length){const R=computeNormalData([r[0]],e,i,n,o,l,d,u);return v.forEach(L=>{L[_]=r[0][_],L[y]=r[0][y],L[g]=r[0][g]}),R}const A=v[0];let{start:x,end:T}=getTotalStartEnd(A,i,n,o,b);i.start=x,i.end=T;let C=x,E=x,P=T-x;return S.forEach(R=>{const L=+R[g];L>=0?(R[_]=+C,C=precisionAdd(C,L)):(R[_]=+E,E=precisionAdd(E,L)),R[y]=precisionAdd(R[_],L),x=precisionAdd(x,L),P=precisionSub(P,L)}),v.forEach(R=>{R[_]=+x,R[y]=precisionAdd(R[_],P),R[g]=P}),Object.assign(Object.assign({},i),{lastIndex:e})}function computeNormalData(r,e,i,n,o,l,d,u){const{valueField:f,startAs:g,endAs:_,total:y,seriesField:b,seriesFieldName:S}=u;return r.forEach(v=>{let A=!1;if(y&&y.type!=="end"){if((y.type==="field"||y.type==="custom")&&v[y.tagField]){A=!0;const{start:x,end:T}=getTotalStartEnd(v,i,n,o,y);v[g]=x,v[_]=T,v[f]=T-x,i.start=x,i.end=T}}else d===l.length-1&&(i.start=0,v[g]=i.start,v[_]=i.end,A=!0);if(!A){const x=+v[f];x>=0?(v[g]=+i.positive,i.positive=precisionAdd(i.positive,x)):(v[g]=+i.negative,i.negative=precisionAdd(i.negative,x)),v[_]=precisionAdd(v[g],x),i.end=precisionAdd(i.end,x)}i.isTotal=A,(isNil(b)||b===WaterfallDefaultSeriesField)&&(v[WaterfallDefaultSeriesField]=A?S.total:+v[f]>=0?S.increase:S.decrease)}),Object.assign(Object.assign({},i),{lastIndex:e})}function getTotalStartEnd(r,e,i,n,o){return o&&o.type!=="end"?o.type==="field"||o.type==="custom"?o.type==="custom"?getTotalInCustomType(r,n,o):o.collectCountField&&!isNil(r[o.collectCountField])?getTotalInCollectField(r,i,e,o):getTotalInField(r,e,o):{start:0,end:0}:getTotalInEndType(e)}function getTotalInEndType(r){return{start:0,end:r.end}}function getTotalInCustomType(r,e,i){return i.product(r,e)}function getTotalInCollectField(r,e,i,n){let o=0,l=i.end;const d=e.length-+r[n.collectCountField],u=e.length-1;return d<0?warn("total.collectCountField error"):o=e[d].start,u<0?warn("total.collectCountField error"):l=e[u].end,{start:o,end:l}}function getTotalInField(r,e,i){let n=0,o=e.end;return i.startField&&!isNil(r[i.startField])&&(n=+r[i.startField]),i.valueField&&!isNil(r[i.valueField])&&(o=precisionAdd(n,+r[i.valueField])),{start:n,end:o}}const waterfallFillTotal=(r,e)=>{if(!r)return r;const{indexField:i,valueField:n,total:o,seriesField:l}=e,d={[i]:(o==null?void 0:o.text)||"total",[n]:r.reduce((u,f)=>precisionAdd(u,+f[n]),0)};return l&&(d[l]="total"),r.push(d),r},Appear_FadeIn$6={type:"fadeIn"},Appear_ScaleIn={type:"growCenterIn"};function waterfallPresetAnimation(r,e){switch(e){case"fadeIn":return Appear_FadeIn$6;case"scaleIn":return Appear_ScaleIn;default:return barGrowIn(r,!1)}}const registerWaterfallAnimation=()=>{Factory$1.registerAnimation("waterfall",(r,e)=>({appear:waterfallPresetAnimation(r,e),enter:barGrowIn(r,!1),exit:barGrowOut(r,!1),disappear:barGrowOut(r,!1)}))};class RuleMark extends BaseMark{constructor(){super(...arguments),this.type=RuleMark.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{x1:0,y1:0})}}RuleMark.type="rule";const registerRuleMark=()=>{Factory$1.registerMark(RuleMark.type,RuleMark),registerRuleGraphic()},waterfallSeriesMark=Object.assign(Object.assign({},barSeriesMark),{leaderLine:{name:"leaderLine",type:"rule"},stackLabel:{name:"stackLabel",type:"text"}}),dimensionTree=(r,e)=>{if(!e.fields)return r;const i={};return{dimensionValues:i,dimensionData:groups(r.map(n=>n.latestData).flat(),e.fields,i)}};function groups(r,e,i){if(e.length===0)return r;const n=e[0],o=e.slice(1);i[n]=new Set;const l=groupBy(r,n,i[n]);return o.length?mapValues(l,(d,u)=>groups(d,o,i)):l}function groupBy(r,e,i){const n={};return r.forEach(o=>{const l=o[e];n[l]||(n[l]=[],i.add(l)),n[l].push(o)}),n}function mapValues(r,e){return Object.keys(r).reduce((i,n)=>(i[n]=e(r[n],n),i),{})}class Group{get fields(){return this._fields}get groupData(){return this._groupData}constructor(e){this._fields=[],this._fields=e}initData(e,i){const n=e.name,o=new DataView(i instanceof DataSet?i:e.dataSet);o.name=n,o.parse([e],{type:"dataview"}),registerDataSetInstanceTransform(i,"dimensionTree",dimensionTree),o.transform({type:"dimensionTree",options:{fields:this._fields}},!1),o.target.addListener("change",this.groupDataUpdate.bind(this)),this._groupData=o}groupDataUpdate(){}getGroupValueInField(e){var i,n,o;const l=(o=(n=(i=this.groupData)===null||i===void 0?void 0:i.latestData)===null||n===void 0?void 0:n.dimensionValues)===null||o===void 0?void 0:o[e];return l?Array.from(l):[]}}class WaterfallSeriesSpecTransformer extends BarSeriesSpecTransformer{constructor(){super(...arguments),this._supportStack=!1}_transformLabelSpec(e){this._addMarkLabelSpec(e,"bar"),this._addMarkLabelSpec(e,"bar","stackLabel","initStackLabelMarkStyle")}}const labelRuleMap={rect:barLabel,symbol:symbolLabel,arc:pieLabel,point:pointLabel,"line-data":lineDataLabel,stackLabel,line:LineLabel,area:LineLabel,rect3d:barLabel,arc3d:pieLabel,treemap:treemapLabel,venn:vennLabel};function defaultLabelConfig(r,e){var i;const{labelSpec:n}=e;n.overlap&&!isObject$1(n.overlap)&&(n.overlap={});const o=(i=labelRuleMap[r])!==null&&i!==void 0?i:labelRuleMap.point;return e.series.type===SeriesTypeEnum.sankey?sankeyLabel(e):o(e)}function textAttribute(r,e,i,n){var o;const{labelMark:l,series:d}=r,u={text:e[d.getMeasureField()[0]],data:e,textType:(o=r.labelSpec.textType)!==null&&o!==void 0?o:"text"},f=Object.keys(l.stateStyle.normal);for(const g of f){const _=l.getAttribute(g,e);u[g]=_}if(d.type!==SeriesTypeEnum.sankey){const{formatFunc:g,args:_}=getFormatFunction(i,n,u.text,e);g&&(u._originText=u.text,u.text=g(..._,{series:d}))}return u}function uniformLabelPosition(r){return isFunction(r)?e=>r(e.data):r}function symbolLabel(r){var e,i,n;const{series:o,labelSpec:l}=r,d=o.direction==="horizontal"?"right":"top",u=(e=uniformLabelPosition(l.position))!==null&&e!==void 0?e:d;let f;return f=l.overlap!==!1&&{strategy:(n=(i=l.overlap)===null||i===void 0?void 0:i.strategy)!==null&&n!==void 0?n:symbolLabelOverlapStrategy(),avoidBaseMark:u!=="center"},{position:u,overlap:f}}function lineDataLabel(r){const e=symbolLabel(r);return isBoolean(e.overlap)||(e.overlap.avoidBaseMark=!1),e}function symbolLabelOverlapStrategy(){return[{type:"position",position:["top","bottom","right","left","top-right","top-left","bottom-left","bottom-right"]}]}function barLabel(r){var e,i,n,o,l,d;const{series:u,labelSpec:f={}}=r,g=(e=uniformLabelPosition(f.position))!==null&&e!==void 0?e:"outside",_=(i=u.direction)!==null&&i!==void 0?i:"vertical",y=u.direction==="horizontal"?(n=u.getXAxisHelper())===null||n===void 0?void 0:n.isInverse():(o=u.getYAxisHelper())===null||o===void 0?void 0:o.isInverse();let b,S=g;S=A=>{var x;const{data:T}=A,C=(x=typeof f.position=="function"?f.position(T):f.position)!==null&&x!==void 0?x:"outside";if(C==="outside"){const E=u.getMeasureField()[0],P={vertical:["top","bottom"],horizontal:["right","left"]},R=(T==null?void 0:T[E])>=0&&y||(T==null?void 0:T[E])<0&&!y?1:0;return P[_][R]}return C},b=f.overlap!==!1&&{strategy:(d=(l=f.overlap)===null||l===void 0?void 0:l.strategy)!==null&&d!==void 0?d:barLabelOverlapStrategy(u)};let v=!1;return isString(g)&&g.includes("inside")&&(v=!0),{position:S,overlap:b,smartInvert:v}}function barLabelOverlapStrategy(r){return[{type:"position",position:e=>{var i,n;const{data:o}=e,l=r.getMeasureField()[0];return(r.direction==="horizontal"?!((i=r.getXAxisHelper())===null||i===void 0)&&i.isInverse():!((n=r.getYAxisHelper())===null||n===void 0)&&n.isInverse())?(o==null?void 0:o[l])>=0?r.direction==="horizontal"?["left","inside-left"]:["bottom","inside-bottom"]:r.direction==="horizontal"?["right","inside-right"]:["top","inside-top"]:(o==null?void 0:o[l])>=0?r.direction==="horizontal"?["right","inside-right"]:["top","inside-top"]:r.direction==="horizontal"?["left","inside-left"]:["bottom","inside-bottom"]}}]}function pointLabel(r){const{labelSpec:e}=r;let i;return i=e.overlap!==!1&&{avoidBaseMark:!1},{position:"center",overlap:i}}function pieLabel(r){var e;const{labelSpec:i}=r,n=(e=uniformLabelPosition(i.position))!==null&&e!==void 0?e:"outside",o=n;let l;return l=i.smartInvert?i.smartInvert:isString(n)&&n.includes("inside"),{position:o,smartInvert:l}}function stackLabelX(r,e,i,n){return e.direction==="horizontal"?i==="middle"?.5*(e.totalPositionX(r,"end")+e.totalPositionY(r,"start")):i==="max"?e.totalPositionX(r,r.end>=r.start?"end":"start")+n:i==="min"?e.totalPositionX(r,r.end>=r.start?"start":"end")-n:e.totalPositionX(r,"end")+(r.end>=r.start?n:-n):e.totalPositionX(r,"index",.5)}function stackLabelY(r,e,i,n){return e.direction==="horizontal"?e.totalPositionY(r,"index",.5):i==="middle"?.5*(e.totalPositionY(r,"end")+e.totalPositionY(r,"start")):i==="max"?e.totalPositionY(r,r.end>=r.start?"end":"start")-n:i==="min"?e.totalPositionY(r,r.end>=r.start?"start":"end")+n:e.totalPositionY(r,"end")+(r.end>=r.start?-n:n)}function stackLabel(r,e,i){const n=r.series,o=r.labelSpec||{},l=n.getTotalData();return{customLayoutFunc:d=>d.map(u=>{const f=o.position||"withChange",g=o.offset||0,_=e?e(u.data):u.data,y=textAttribute(r,_,o.formatMethod);return y.x=stackLabelX(_,n,f,g),y.y=stackLabelY(_,n,f,g),n.direction==="horizontal"?y.textAlign=f==="middle"?"center":f==="withChange"&&_.end-_.start>=0||f==="max"?"left":"right":y.textBaseline=f==="middle"?f:f==="withChange"&&_.end-_.start>=0||f==="max"?"bottom":"top",i==null||i(u,_,y),createText(Object.assign(Object.assign({},y),{id:u.id}))}),dataFilter:d=>{const u=[];return l.forEach(f=>{const g=d.find(_=>{var y;return f.index===((y=_.data)===null||y===void 0?void 0:y[n.getDimensionField()[0]])});g&&(g.data=f,u.push(g))}),u},overlap:{strategy:[]}}}function treemapLabel(r){return{customLayoutFunc:(e,i)=>i,overlap:!1}}function vennLabel(r){return{customLayoutFunc:(e,i)=>i,smartInvert:!0}}function LineLabel(r){var e,i,n,o;const{labelSpec:l,series:d}=r,u=(n=(i=(e=d.getViewDataStatistics)===null||e===void 0?void 0:e.call(d).latestData)===null||i===void 0?void 0:i[d.getSeriesField()])===null||n===void 0?void 0:n.values,f=u?u.map((g,_)=>({[d.getSeriesField()]:g,index:_})):[];return{position:(o=l.position)!==null&&o!==void 0?o:"end",data:f}}function sankeyLabel(r){var e,i,n;const{series:o,labelSpec:l={}}=r,d=(e=uniformLabelPosition(l.position))!==null&&e!==void 0?e:"outside",u=o.direction;let f,g=d;return isString(d)&&(u==="vertical"?g=d==="inside-start"?_=>"inside-left":d==="inside-middle"?_=>"center":d==="inside-end"?_=>"inside-right":_=>"bottom":d==="inside-start"?g=_=>"inside-left":d==="inside-middle"?g=_=>"center":d==="inside-end"?g=_=>"inside-right":d==="outside"&&(g=_=>"right")),f=l.overlap!==!1&&(!isString(d)||!d.includes("inside"))&&{strategy:(n=(i=l.overlap)===null||i===void 0?void 0:i.strategy)!==null&&n!==void 0?n:sankeyLabelOverlapStrategy(o)},{position:g,overlap:f,smartInvert:!1,offset:0,syncState:!0}}function sankeyLabelOverlapStrategy(r){return[{type:"position",position:e=>r.direction==="horizontal"?["right","left"]:["bottom","top"]}]}class WaterfallSeries extends BarSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.waterfall,this.transformerConstructor=WaterfallSeriesSpecTransformer,this._leaderLineMark=null,this._stackLabelMark=null,this._labelMark=null}getTotalData(){var e;return(e=this._totalData)===null||e===void 0?void 0:e.getLatestData()}initGroups(){const e=this.getGroupFields();e&&e.length&&(this._groups=new Group(e),this._data&&this._groups.initData(this._data.getDataView(),this._dataSet))}setAttrFromSpec(){super.setAttrFromSpec(),this.setValueFieldToStack(),this._fieldX=[this._fieldX[0]],this._fieldY=[this._fieldY[0]],isNil(this._seriesField)&&(this._seriesField=WaterfallDefaultSeriesField)}getSeriesKeys(){return this._seriesField===WaterfallDefaultSeriesField?[this._theme.seriesFieldName.increase,this._theme.seriesFieldName.decrease,this._theme.seriesFieldName.total]:super.getSeriesKeys()}initData(){var e;super.initData(),registerDataSetInstanceTransform(this._dataSet,"waterfallFillTotal",waterfallFillTotal),registerDataSetInstanceTransform(this._dataSet,"waterfall",waterfall),(isNil(this._spec.total)||this._spec.total.type==="end")&&((e=this._rawData)===null||e===void 0||e.transform({type:"waterfallFillTotal",options:{indexField:this.getGroupFields()[0],valueField:this.getStackValueField(),seriesField:this.getSeriesField(),seriesFieldName:this._theme.seriesFieldName,total:this._spec.total}},!1));const i=dataViewFromDataView(this.getViewData(),this._dataSet,{name:`${PREFIX}_series_${this.id}_totalData`});this.getViewData().target.removeListener("change",i.reRunAllTransform),this._totalData=new SeriesData(this._option,i),i.transform({type:"waterfall",options:{indexField:this.getGroupFields()[0],valueField:this.getStackValueField(),seriesField:this.getSeriesField(),seriesFieldName:this._theme.seriesFieldName,startAs:STACK_FIELD_START,endAs:STACK_FIELD_END,total:this._spec.total,groupData:()=>this.getGroups().groupData}},!1)}compileData(){var e;super.compileData(),(e=this._totalData)===null||e===void 0||e.compile()}initAnimation(){var e,i,n,o;const l={yField:this.direction==="horizontal"?this._fieldY[0]:this.getStackValueField(),xField:this.direction==="horizontal"?this.getStackValueField():this._fieldX[0],direction:this.direction,growFrom:()=>{var f,g;return this.direction==="horizontal"?(f=this._xAxisHelper)===null||f===void 0?void 0:f.getScale(0).scale(0):(g=this._yAxisHelper)===null||g===void 0?void 0:g.getScale(0).scale(0)}},d=(i=(e=this._spec)===null||e===void 0?void 0:e.animationAppear)===null||i===void 0?void 0:i.preset,u=getGroupAnimationParams(this);this._barMark.setAnimationConfig(animationConfig((n=Factory$1.getAnimationInKey("waterfall"))===null||n===void 0?void 0:n(l,d),userAnimationConfig("bar",this._spec,this._markAttributeContext),u)),this._leaderLineMark&&this._leaderLineMark.setAnimationConfig(animationConfig((o=Factory$1.getAnimationInKey("fadeInOut"))===null||o===void 0?void 0:o(),userAnimationConfig("leaderLine",this._spec,this._markAttributeContext)))}viewDataUpdate(e){this._totalData.getDataView().reRunAllTransform(),this._totalData.updateData(),super.viewDataUpdate(e)}addViewDataFilter(e){}reFilterViewData(){}onEvaluateEnd(e){super.onEvaluateEnd(e),this._totalData.updateData()}initMark(){var e,i;super.initMark();const n=this._createMark(WaterfallSeries.mark.leaderLine,{key:"index",stateSort:(e=this._spec.leaderLine)===null||e===void 0?void 0:e.stateSort},{setCustomizedShape:(i=this._spec.leaderLine)===null||i===void 0?void 0:i.customShape});n&&(this._leaderLineMark=n,n.setDataView(this._totalData.getDataView(),this._totalData.getProductId()))}initLabelMarkStyle(e){var i;if(e)return!this._labelMark&&(!((i=this._spec.label)===null||i===void 0)&&i.visible)?(super.initLabelMarkStyle(e),void(this._labelMark=e)):void 0}initStackLabelMarkStyle(e){e&&(this._stackLabelMark=e,e.skipEncode=!0,e.setRule("stackLabel"),e.setDataView(this._totalData.getDataView(),this._totalData.getProductId()),this.setMarkStyle(e,{text:i=>{var n;return((n=this._spec.stackLabel)===null||n===void 0?void 0:n.valueType)==="absolute"?i.end:precisionSub(i.end,i.start)}}))}initTotalLabelMarkStyle(e){this.setMarkStyle(e,{text:i=>{var n;return"end"in i?((n=this._spec.totalLabel)===null||n===void 0?void 0:n.valueType)==="absolute"?i.end:precisionSub(i.end,i.start):this.direction==="horizontal"?i[this._fieldX[0]]:i[this._fieldY[0]]}})}getTotalLabelComponentStyle(e){return stackLabel(Object.assign(Object.assign({},e),{series:this,labelSpec:this._spec.totalLabel}),i=>{const n=this.direction==="vertical"?i[this._fieldX[0]]:i[this._fieldY[0]];return this._totalData.getLatestData().find(o=>o.index===n)})}totalPositionX(e,i,n=.5){const{dataToPosition:o,getBandwidth:l}=this._xAxisHelper;return this._direction==="horizontal"?valueInScaleRange(o([e[i]],{bandPosition:this._bandPosition})):o([e[i]],{bandPosition:this._bandPosition})+.5*l(0)-this._barMark.getAttribute("width",e)*(.5-n)}totalPositionY(e,i,n=.5){const{dataToPosition:o,getBandwidth:l}=this._yAxisHelper;return this._direction==="horizontal"?o([e[i]],{bandPosition:this._bandPosition})+.5*l(0)-this._barMark.getAttribute("height",e)*(.5-n):valueInScaleRange(o([e[i]],{bandPosition:this._bandPosition}))}initMarkStyle(){super.initMarkStyle(),this._leaderLineMark&&(this._direction==="horizontal"?this.setMarkStyle(this._leaderLineMark,{visible:e=>!isNil(e.lastIndex),x:e=>this.totalPositionX(e,"lastEnd",0),x1:e=>this.totalPositionX(e,e.isTotal?"end":"start",0),y:e=>e.lastIndex?this.totalPositionY(e,"lastIndex",1):0,y1:e=>this.totalPositionY(e,"index",0)},"normal",AttributeLevel.Series):this.setMarkStyle(this._leaderLineMark,{visible:e=>!isNil(e.lastIndex),x:e=>e.lastIndex?this.totalPositionX(e,"lastIndex",1):0,x1:e=>this.totalPositionX(e,"index",0),y:e=>this.totalPositionY(e,"lastEnd",0),y1:e=>this.totalPositionY(e,e.isTotal?"end":"start",0)},"normal",AttributeLevel.Series))}}WaterfallSeries.type=SeriesTypeEnum.waterfall,WaterfallSeries.mark=waterfallSeriesMark,WaterfallSeries.transformerConstructor=WaterfallSeriesSpecTransformer;const registerWaterfallSeries=()=>{registerRuleMark(),registerRectMark(),registerWaterfallAnimation(),registerFadeInOutAnimation(),registerCartesianBandAxis(),registerCartesianLinearAxis(),Factory$1.registerSeries(WaterfallSeries.type,WaterfallSeries)},BOX_PLOT_OUTLIER_VALUE_FIELD=`${PREFIX}_BOX_PLOT_OUTLIER_VALUE`;var BOX_PLOT_TOOLTIP_KEYS;(function(r){r.OUTLIER="outlier",r.MAX="max",r.MIN="min",r.MEDIAN="median",r.Q1="q1",r.Q3="q3",r.SERIES_FIELD="seriesField"})(BOX_PLOT_TOOLTIP_KEYS||(BOX_PLOT_TOOLTIP_KEYS={}));const foldOutlierData=(r,e)=>{const i=[],{outliersField:n,dimensionField:o}=e;return(r[0].latestData||[]).forEach(l=>{let d=l[n];isArray(d)||(d=[d]),i.push(...d.map(u=>{const f={[BOX_PLOT_OUTLIER_VALUE_FIELD]:u};return o.forEach(g=>{f[g]=l[g]}),f}))}),i};class BoxPlotSeriesTooltipHelper extends BaseSeriesTooltipHelper{constructor(){super(...arguments),this.getContentKey=e=>i=>{if(this.isOutlierMark(i))return e===BOX_PLOT_TOOLTIP_KEYS.OUTLIER?this.series.getOutliersField():e===BOX_PLOT_TOOLTIP_KEYS.SERIES_FIELD?this.series.getSeriesField():null;switch(e){case BOX_PLOT_TOOLTIP_KEYS.MIN:return this.series.getMinField();case BOX_PLOT_TOOLTIP_KEYS.MAX:return this.series.getMaxField();case BOX_PLOT_TOOLTIP_KEYS.MEDIAN:return this.series.getMedianField();case BOX_PLOT_TOOLTIP_KEYS.Q1:return this.series.getQ1Field();case BOX_PLOT_TOOLTIP_KEYS.Q3:return this.series.getQ3Field();case BOX_PLOT_TOOLTIP_KEYS.SERIES_FIELD:return this.series.getSeriesField()}return null},this.getContentValue=e=>i=>{if(this.isOutlierMark(i))return e===BOX_PLOT_TOOLTIP_KEYS.OUTLIER?i[BOX_PLOT_OUTLIER_VALUE_FIELD]:e===BOX_PLOT_TOOLTIP_KEYS.SERIES_FIELD?i[this.series.getSeriesField()]:null;switch(e){case BOX_PLOT_TOOLTIP_KEYS.MIN:return i[this.series.getMinField()];case BOX_PLOT_TOOLTIP_KEYS.MAX:return i[this.series.getMaxField()];case BOX_PLOT_TOOLTIP_KEYS.MEDIAN:return i[this.series.getMedianField()];case BOX_PLOT_TOOLTIP_KEYS.Q1:return i[this.series.getQ1Field()];case BOX_PLOT_TOOLTIP_KEYS.Q3:return i[this.series.getQ3Field()];case BOX_PLOT_TOOLTIP_KEYS.SERIES_FIELD:return i[this.series.getSeriesField()]}return null},this.shapeColorCallback=e=>this.series.getShaftShape()==="line"?this.series.getMarkInName("boxPlot").getAttribute("stroke",e):this.series.getMarkInName("boxPlot").getAttribute("fill",e),this.getOutlierFillColor=e=>{var i;const n=this.series.getOutliersStyle();return(i=n==null?void 0:n.fill)!==null&&i!==void 0?i:this.series.getMarkInName("outlier").getAttribute("fill",e)},this.isOutlierMark=e=>isValid(e[BOX_PLOT_OUTLIER_VALUE_FIELD])}getDefaultContentList(e){return[{key:this.getContentKey(BOX_PLOT_TOOLTIP_KEYS.OUTLIER),value:this.getContentValue(BOX_PLOT_TOOLTIP_KEYS.OUTLIER),shapeType:this.shapeTypeCallback,shapeColor:this.getOutlierFillColor,shapeStroke:this.getOutlierFillColor},{key:this.getContentKey(BOX_PLOT_TOOLTIP_KEYS.MAX),value:this.getContentValue(BOX_PLOT_TOOLTIP_KEYS.MAX)},{key:this.getContentKey(BOX_PLOT_TOOLTIP_KEYS.Q3),value:this.getContentValue(BOX_PLOT_TOOLTIP_KEYS.Q3)},{key:this.getContentKey(BOX_PLOT_TOOLTIP_KEYS.MEDIAN),value:this.getContentValue(BOX_PLOT_TOOLTIP_KEYS.MEDIAN)},{key:this.getContentKey(BOX_PLOT_TOOLTIP_KEYS.Q1),value:this.getContentValue(BOX_PLOT_TOOLTIP_KEYS.Q1)},{key:this.getContentKey(BOX_PLOT_TOOLTIP_KEYS.MIN),value:this.getContentValue(BOX_PLOT_TOOLTIP_KEYS.MIN)},{key:this.getContentKey(BOX_PLOT_TOOLTIP_KEYS.SERIES_FIELD),value:this.getContentValue(BOX_PLOT_TOOLTIP_KEYS.SERIES_FIELD)}]}}class BoxPlotMark extends BaseMark{constructor(){super(...arguments),this.type=BoxPlotMark.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{lineWidth:2,boxWidth:30,shaftWidth:20,shaftShape:"line"})}_initProduct(e){const i=this.getStyle("shaftShape"),n=this.getVGrammarView(),o=this.getProductId(),l=i==="bar"?"barBoxplot":"boxplot",d=this.getStyle("direction");this._product=n.glyph(l,e??n.rootMark).id(o).configureGlyph({direction:d}),this._compiledProductId=o}}BoxPlotMark.type="boxPlot";const registerBoxPlotMark=()=>{Factory$1.registerMark(BoxPlotMark.type,BoxPlotMark),registerBoxplotGlyph(),registerBarBoxplotGlyph()},boxPlotSeriesMark=Object.assign(Object.assign({},baseSeriesMark),{boxPlot:{name:"boxPlot",type:"boxPlot"},outlier:{name:"outlier",type:"symbol"}});class BoxPlotSeries extends CartesianSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.boxPlot}getMinField(){return this._minField}getMaxField(){return this._maxField}getQ1Field(){return this._q1Field}getMedianField(){return this._medianField}getQ3Field(){return this._q3Field}getOutliersField(){return this._outliersField}getShaftShape(){return this._shaftShape}getBoxFillColor(){return this._boxFillColor}getStrokeColor(){return this._strokeColor}getOutliersStyle(){return this._outliersStyle}setAttrFromSpec(){var e,i,n,o,l;super.setAttrFromSpec();const d=(i=(e=this._spec.boxPlot)===null||e===void 0?void 0:e.style)!==null&&i!==void 0?i:{};this._minField=this._spec.minField,this._maxField=this._spec.maxField,this._q1Field=this._spec.q1Field,this._medianField=this._spec.medianField,this._q3Field=this._spec.q3Field,this._outliersField=this._spec.outliersField,this._lineWidth=(n=d.lineWidth)!==null&&n!==void 0?n:2,this._boxWidth=d.boxWidth,this._shaftShape=(o=d.shaftShape)!==null&&o!==void 0?o:"line",this._shaftWidth=d.shaftWidth,this._boxFillColor=d.boxFill,this._strokeColor=d.stroke,this._shaftFillOpacity=this._shaftShape==="bar"?(l=d.shaftFillOpacity)!==null&&l!==void 0?l:.5:void 0,this._outliersStyle=this._spec.outliersStyle}initMark(){const e={progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold};this._boxPlotMark=this._createMark(BoxPlotSeries.mark.boxPlot,{groupKey:this._seriesField,isSeriesMark:!0},e),this._outlierMark=this._createMark(BoxPlotSeries.mark.outlier,{key:DEFAULT_DATA_INDEX,groupKey:this._seriesField,dataView:this._outlierDataView.getDataView(),dataProductId:this._outlierDataView.getProductId()},e)}initMarkStyle(){var e,i,n,o,l;const d=this._boxPlotMark;if(d){const f={direction:this._direction,lineWidth:this._lineWidth,shaftShape:this._shaftShape,fill:(e=this._boxFillColor)!==null&&e!==void 0?e:this._shaftShape==="line"?"#FFF":this.getColorAttribute(),minMaxFillOpacity:this._shaftFillOpacity,stroke:(i=this._strokeColor)!==null&&i!==void 0?i:this._shaftShape==="line"?this.getColorAttribute():"#000"},g=this._direction==="horizontal"?Object.assign(Object.assign({y:this.dataToPositionY.bind(this)},f),{boxHeight:()=>{var _;return(_=this._boxWidth)!==null&&_!==void 0?_:this._getMarkWidth()},ruleHeight:()=>{var _;return(_=this._shaftWidth)!==null&&_!==void 0?_:this._getMarkWidth()},q1q3Height:()=>{var _;return(_=this._boxWidth)!==null&&_!==void 0?_:this._getMarkWidth()},minMaxHeight:()=>{var _;return(_=this._shaftWidth)!==null&&_!==void 0?_:this._getMarkWidth()}}):Object.assign(Object.assign({x:this.dataToPositionX.bind(this)},f),{boxWidth:()=>{var _;return(_=this._boxWidth)!==null&&_!==void 0?_:this._getMarkWidth()},ruleWidth:()=>{var _;return(_=this._shaftWidth)!==null&&_!==void 0?_:this._getMarkWidth()},q1q3Width:()=>{var _;return(_=this._boxWidth)!==null&&_!==void 0?_:this._getMarkWidth()},minMaxWidth:()=>{var _;return(_=this._shaftWidth)!==null&&_!==void 0?_:this._getMarkWidth()}});this.setMarkStyle(d,g,STATE_VALUE_ENUM.STATE_NORMAL,AttributeLevel.Series)}const u=this._outlierMark;u&&this.setMarkStyle(u,{fill:(o=(n=this._outliersStyle)===null||n===void 0?void 0:n.fill)!==null&&o!==void 0?o:this.getColorAttribute(),size:isNumber((l=this._outliersStyle)===null||l===void 0?void 0:l.size)?this._outliersStyle.size:10,symbolType:"circle"},STATE_VALUE_ENUM.STATE_NORMAL,AttributeLevel.Series)}initBoxPlotMarkStyle(){var e,i;const n=this._boxPlotMark,o=this._direction==="horizontal"?this._xAxisHelper:this._yAxisHelper;if(n&&o){const{dataToPosition:d}=o,u=(e=o==null?void 0:o.getScale)===null||e===void 0?void 0:e.call(o,0);this.setMarkStyle(n,{min:f=>valueInScaleRange(d(this.getDatumPositionValues(f,this._minField),{bandPosition:this._bandPosition}),u),q1:f=>valueInScaleRange(d(this.getDatumPositionValues(f,this._q1Field),{bandPosition:this._bandPosition}),u),median:f=>valueInScaleRange(d(this.getDatumPositionValues(f,this._medianField),{bandPosition:this._bandPosition}),u),q3:f=>valueInScaleRange(d(this.getDatumPositionValues(f,this._q3Field),{bandPosition:this._bandPosition}),u),max:f=>valueInScaleRange(d(this.getDatumPositionValues(f,this._maxField),{bandPosition:this._bandPosition}),u)},STATE_VALUE_ENUM.STATE_NORMAL,AttributeLevel.Series)}const l=this._outlierMark;if(l&&o){const{dataToPosition:d}=o,u=(i=o==null?void 0:o.getScale)===null||i===void 0?void 0:i.call(o,0),f=this._direction==="horizontal"?{y:this.dataToPositionY.bind(this),x:g=>valueInScaleRange(d(this.getDatumPositionValues(g,BOX_PLOT_OUTLIER_VALUE_FIELD),{bandPosition:this._bandPosition}),u)}:{x:this.dataToPositionX.bind(this),y:g=>valueInScaleRange(d(this.getDatumPositionValues(g,BOX_PLOT_OUTLIER_VALUE_FIELD),{bandPosition:this._bandPosition}),u)};this.setMarkStyle(l,f,STATE_VALUE_ENUM.STATE_NORMAL,AttributeLevel.Series)}}initData(){if(super.initData(),!this._data)return;registerDataSetInstanceTransform(this._dataSet,"foldOutlierData",foldOutlierData),registerDataSetInstanceTransform(this._dataSet,"addVChartProperty",addVChartProperty);const e=new DataView(this._dataSet,{name:`${this.type}_outlier_${this.id}_data`});e.parse([this.getViewData()],{type:"dataview"}),e.name=`${PREFIX}_series_${this.id}_outlierData`,e.transform({type:"foldOutlierData",options:{dimensionField:this._direction==="horizontal"?this._fieldY:this._fieldX,outliersField:this._outliersField}}),e.transform({type:"addVChartProperty",options:{beforeCall:initKeyMap.bind(this),call:addDataKey}},!1),this._outlierDataView=new SeriesData(this._option,e)}compileData(){var e;super.compileData(),(e=this._outlierDataView)===null||e===void 0||e.compile()}init(e){super.init(e),this.initBoxPlotMarkStyle()}_getMarkWidth(){if(this._autoBoxWidth)return this._autoBoxWidth;const e=this._direction==="horizontal"?this._yAxisHelper:this._xAxisHelper,i=this._direction==="horizontal"?this._fieldY:this._fieldX,n=e.getBandwidth(i.length-1)/i.length;return this._autoBoxWidth=n,this._autoBoxWidth}onLayoutEnd(e){super.onLayoutEnd(e),this._autoBoxWidth=null}_initAnimationSpec(e={}){const i=merge$1({},e);return["appear","enter","update","exit","disappear"].forEach(n=>{i[n]&&i[n].type==="scaleIn"?i[n].type=this._shaftShape==="line"?"boxplotScaleIn":"barBoxplotScaleIn":i[n]&&i[n].type==="scaleOut"&&(i[n].type=this._shaftShape==="line"?"boxplotScaleOut":"barBoxplotScaleOut")}),i}initAnimation(){var e,i,n,o,l,d,u;const f=getGroupAnimationParams(this);if(this._boxPlotMark){const g=this._initAnimationSpec((e=Factory$1.getAnimationInKey("scaleInOut"))===null||e===void 0?void 0:e()),_=this._initAnimationSpec(userAnimationConfig("boxPlot",this._spec,this._markAttributeContext));this._boxPlotMark.setAnimationConfig(animationConfig(g,_,f))}if(this._outlierMark){const g={appear:(i=this._spec.animationAppear)===null||i===void 0?void 0:i.symbol,disappear:(n=this._spec.animationDisappear)===null||n===void 0?void 0:n.symbol,enter:(o=this._spec.animationEnter)===null||o===void 0?void 0:o.symbol,exit:(l=this._spec.animationExit)===null||l===void 0?void 0:l.symbol,update:(d=this._spec.animationUpdate)===null||d===void 0?void 0:d.symbol};this._outlierMark.setAnimationConfig(animationConfig((u=Factory$1.getAnimationInKey("scaleInOut"))===null||u===void 0?void 0:u(),g,f))}}initTooltip(){this._tooltipHelper=new BoxPlotSeriesTooltipHelper(this),this._boxPlotMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._boxPlotMark),this._outlierMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._outlierMark)}getStatisticFields(){const e=super.getStatisticFields(),i=e.find(n=>n.key===this._outliersField);return i&&(i.operations=["array-min","array-max"]),e}onEvaluateEnd(e){super.onEvaluateEnd(e),this._outlierDataView.updateData()}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._boxPlotMark]}}BoxPlotSeries.type=SeriesTypeEnum.boxPlot,BoxPlotSeries.mark=boxPlotSeriesMark;const registerBoxplotSeries=()=>{registerBoxPlotMark(),registerSymbolMark(),registerScaleInOutAnimation(),registerCartesianBandAxis(),registerCartesianLinearAxis(),Factory$1.registerSeries(BoxPlotSeries.type,BoxPlotSeries)};class TextMark extends BaseMark{getTextType(){return this._textType}constructor(e,i){super(e,i),this.type=TextMark.type,this._textType="text"}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{angle:0,textAlign:"center",lineWidth:0,textConfig:[]})}initStyleWithSpec(e,i){super.initStyleWithSpec(e,i),e.textType&&(this._textType=e.textType)}compileEncode(){super.compileEncode(),this._textType==="rich"&&this._product.encodeState("group",{textType:this._textType})}}TextMark.type="text";const registerTextMark=()=>{Factory$1.registerMark(TextMark.type,TextMark),registerTextGraphic(),registerRichTextGraphic()};function setRectLabelPos(r,e,i,n,o,l,d,u,f){r.setMarkStyle(e,{textAlign:g=>{if(f()==="vertical")return"center";const _=o(g),y=l(g);if(i==="middle")return"center";if(_>=y){if(i==="start")return"left";if(i==="end")return"right";if(i==="outside")return"left"}else{if(i==="start")return"right";if(i==="end")return"left";if(i==="outside")return"right"}return"center"},textBaseline:g=>{if(f()==="horizontal")return"middle";const _=d(g),y=u(g);if(i==="middle")return"middle";if(y>=_){if(i==="start")return"bottom";if(i==="end")return"top";if(i==="outside")return"bottom"}else{if(i==="start")return"top";if(i==="end")return"bottom";if(i==="outside")return"top"}return"middle"}}),r.setMarkStyle(e,{x:g=>{const _=f(),y=o(g),b=l(g);if(_==="vertical"||i==="middle")return(y+b)/2;if(y>=b){if(i==="start")return b+n;if(i==="end")return y-n;if(i==="outside")return y+n}else{if(i==="start")return b-n;if(i==="end")return y+n;if(i==="outside")return y-n}return(y+b)/2},y:g=>{const _=f(),y=d(g),b=u(g);if(_==="horizontal"||i==="middle")return(y+b)/2;if(y>=b){if(i==="start")return b+n;if(i==="end")return y-n;if(i==="outside")return y+n}else{if(i==="start")return b-n;if(i==="end")return y+n;if(i==="outside")return y-n}return(y+b)/2}},"normal",AttributeLevel.Series)}class RangeColumnSeriesTooltipHelper extends BaseSeriesTooltipHelper{constructor(){super(...arguments),this._getMeasureData=e=>this.series.getSpec().direction==="horizontal"?e[this.series.getSpec().xField[0]]+"-"+e[this.series.getSpec().xField[1]]:e[this.series.getSpec().yField[0]]+"-"+e[this.series.getSpec().yField[1]]}}const rangeColumnGrowIn=r=>({type:"growCenterIn",options:{direction:r.direction==="horizontal"?"x":"y"}}),Appear_FadeIn$5={type:"fadeIn"},rangeColumnGrowOut=r=>({type:"growCenterOut",options:{direction:r.direction==="horizontal"?"x":"y"}});function rangeColumnPresetAnimation(r,e){return e==="fadeIn"?Appear_FadeIn$5:rangeColumnGrowIn(r)}const registerRangeColumnAnimation=()=>{Factory$1.registerAnimation("rangeColumn",(r,e)=>({appear:rangeColumnPresetAnimation(r,e),enter:rangeColumnGrowIn(r),exit:rangeColumnGrowOut(r),disappear:rangeColumnGrowOut(r)}))},rangeColumnSeriesMark=Object.assign(Object.assign({},barSeriesMark),{minLabel:{name:"minLabel",type:"text"},maxLabel:{name:"maxLabel",type:"text"}}),rangeColumn3dSeriesMark=Object.assign(Object.assign({},bar3dSeriesMark),{minLabel:{name:"minLabel",type:"text"},maxLabel:{name:"maxLabel",type:"text"}});class RangeColumnSeriesSpecTransformer extends BarSeriesSpecTransformer{constructor(){super(...arguments),this._supportStack=!1}_transformLabelSpec(e){var i;((i=e.label)===null||i===void 0?void 0:i.position)!=="bothEnd"&&this._addMarkLabelSpec(e,"bar")}}class RangeColumnSeries extends BarSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.rangeColumn,this._barMarkType="rect",this._barName=SeriesTypeEnum.bar,this.transformerConstructor=RangeColumnSeriesSpecTransformer}initMark(){var e,i,n,o,l,d,u,f,g,_;this._initBarBackgroundMark();const y=(e=this._spec.label)===null||e===void 0?void 0:e.position;this._barMark=this._createMark(RangeColumnSeries.mark.bar,{groupKey:this._seriesField,isSeriesMark:!0,stateSort:(i=this._spec.bar)===null||i===void 0?void 0:i.stateSort},{setCustomizedShape:(n=this._spec.bar)===null||n===void 0?void 0:n.customShape,morph:shouldMarkDoMorph(this._spec,RangeColumnSeries.mark.bar.name),morphElementKey:this.getDimensionField()[0]}),((o=this._spec.label)===null||o===void 0?void 0:o.visible)!==!1&&y==="bothEnd"&&(((d=(l=this._spec.label)===null||l===void 0?void 0:l.minLabel)===null||d===void 0?void 0:d.visible)!==!1&&(this._minLabelMark=this._createMark(RangeColumnSeries.mark.minLabel,{markSpec:(u=this._spec.label)===null||u===void 0?void 0:u.minLabel})),((g=(f=this._spec.label)===null||f===void 0?void 0:f.maxLabel)===null||g===void 0?void 0:g.visible)!==!1&&(this._maxLabelMark=this._createMark(RangeColumnSeries.mark.maxLabel,{markSpec:(_=this._spec.label)===null||_===void 0?void 0:_.maxLabel})))}initMarkStyle(){var e,i;super.initMarkStyle(),this._initLabelMarkPos(this._minLabelMark,(e=this._spec.label)===null||e===void 0?void 0:e.minLabel,0,"end"),this._initLabelMarkPos(this._maxLabelMark,(i=this._spec.label)===null||i===void 0?void 0:i.maxLabel,1,"start")}_initLabelMarkPos(e,i,n,o){var l,d,u,f;if(e){this.setMarkStyle(e,{fill:(d=(l=i==null?void 0:i.style)===null||l===void 0?void 0:l.fill)!==null&&d!==void 0?d:this.getColorAttribute(),text:y=>{const b=this._spec.direction==="horizontal"?y[this._spec.xField[n]]:y[this._spec.yField[n]];return i!=null&&i.formatMethod?i.formatMethod(b,y):b}});const g=(u=i==null?void 0:i.position)!==null&&u!==void 0?u:o,_=(f=i==null?void 0:i.offset)!==null&&f!==void 0?f:this._direction==="vertical"?-20:-25;setRectLabelPos(this,e,g,_,y=>this._barMark.getAttribute("x",y),y=>this._direction==="vertical"?this._barMark.getAttribute("x",y)+this._barMark.getAttribute("width",y):this._barMark.getAttribute("x1",y),y=>this._barMark.getAttribute("y",y),y=>this._direction==="vertical"?this._barMark.getAttribute("y1",y):this._barMark.getAttribute("y",y)+this._barMark.getAttribute("height",y),()=>this._direction)}}initLabelMarkStyle(e){e&&(this.setMarkStyle(e,{text:i=>{let n,o;return this._spec.direction==="horizontal"?(n=i[this._spec.xField[0]],o=i[this._spec.xField[1]]):(n=i[this._spec.yField[0]],o=i[this._spec.yField[1]]),n+"-"+o},z:this._fieldZ?this.dataToPositionZ.bind(this):null}),this._labelMark=e)}_dataToPosX(e){return this._xAxisHelper.dataToPosition(this.getDatumPositionValues(e,this._spec.xField[0]),{bandPosition:this._bandPosition})}_dataToPosX1(e){return this._xAxisHelper.dataToPosition(this.getDatumPositionValues(e,this._spec.xField[1]),{bandPosition:this._bandPosition})}_dataToPosY(e){return this._yAxisHelper.dataToPosition(this.getDatumPositionValues(e,this._spec.yField[0]),{bandPosition:this._bandPosition})}_dataToPosY1(e){return this._yAxisHelper.dataToPosition(this.getDatumPositionValues(e,this._spec.yField[1]),{bandPosition:this._bandPosition})}initAnimation(){var e,i,n,o,l;const d=getGroupAnimationParams(this),u=(i=(e=this._spec)===null||e===void 0?void 0:e.animationAppear)===null||i===void 0?void 0:i.preset;this._barMark.setAnimationConfig(animationConfig((n=Factory$1.getAnimationInKey("rangeColumn"))===null||n===void 0?void 0:n({direction:this.direction},u),userAnimationConfig("bar",this._spec,this._markAttributeContext),d)),this._minLabelMark&&this._minLabelMark.setAnimationConfig(animationConfig((o=Factory$1.getAnimationInKey("fadeInOut"))===null||o===void 0?void 0:o(),userAnimationConfig("label",this._spec,this._markAttributeContext),d)),this._maxLabelMark&&this._maxLabelMark.setAnimationConfig(animationConfig((l=Factory$1.getAnimationInKey("fadeInOut"))===null||l===void 0?void 0:l(),userAnimationConfig("label",this._spec,this._markAttributeContext),d))}initTooltip(){this._tooltipHelper=new RangeColumnSeriesTooltipHelper(this),this._barMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._barMark),this._minLabelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._minLabelMark),this._maxLabelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._maxLabelMark),this._labelMark&&this._tooltipHelper.ignoreTriggerSet.mark.add(this._labelMark)}}RangeColumnSeries.type=SeriesTypeEnum.rangeColumn,RangeColumnSeries.mark=rangeColumnSeriesMark,RangeColumnSeries.transformerConstructor=RangeColumnSeriesSpecTransformer;const registerRangeColumnSeries=()=>{registerRectMark(),registerTextMark(),registerRangeColumnAnimation(),registerFadeInOutAnimation(),registerCartesianBandAxis(),registerCartesianLinearAxis(),Factory$1.registerSeries(RangeColumnSeries.type,RangeColumnSeries)};class RangeColumn3dSeries extends RangeColumnSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.rangeColumn3d,this._barMarkType="rect3d",this._barName=SeriesTypeEnum.bar3d}}RangeColumn3dSeries.type=SeriesTypeEnum.rangeColumn3d,RangeColumn3dSeries.mark=rangeColumn3dSeriesMark;const registerRangeColumn3dSeries=()=>{registerRect3dMark(),registerCartesianBandAxis(),registerCartesianLinearAxis(),Factory$1.registerSeries(RangeColumn3dSeries.type,RangeColumn3dSeries)};class RangeAreaSeriesTooltipHelper extends BaseSeriesTooltipHelper{constructor(){super(...arguments),this._getMeasureData=e=>this.series.getSpec().direction==="horizontal"?e[this.series.getSpec().xField[0]]+"-"+e[this.series.getSpec().xField[1]]:e[this.series.getSpec().yField[0]]+"-"+e[this.series.getSpec().yField[1]]}}const rangeAreaSeriesMark=Object.assign({},areaSeriesMark);class RangeAreaSeries extends AreaSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.rangeArea}initMark(){var e;const{customShape:i,stateSort:n}=(e=this._spec.area)!==null&&e!==void 0?e:{};this._areaMark=this._createMark(RangeAreaSeries.mark.area,{groupKey:this._seriesField,isSeriesMark:!0,stateSort:n},{setCustomizedShape:i,morphElementKey:this.getDimensionField()[0]})}initMarkStyle(){this.initAreaMarkStyle()}initAreaMarkStyle(){const e=this._areaMark;e&&(super.initAreaMarkStyle(),this._direction==="horizontal"?this.setMarkStyle(this._areaMark,{x1:i=>{if(!this._xAxisHelper)return Number.NaN;const{dataToPosition:n}=this._xAxisHelper;return n(this.getDatumPositionValues(i,this._spec.xField[1]),{bandPosition:this._bandPosition})}},"normal",AttributeLevel.Series):this.setMarkStyle(this._areaMark,{y1:i=>{if(!this._yAxisHelper)return Number.NaN;const{dataToPosition:n}=this._yAxisHelper;return n(this.getDatumPositionValues(i,this._spec.yField[1]),{bandPosition:this._bandPosition})}},"normal",AttributeLevel.Series),this.setMarkStyle(e,{stroke:!1},"normal",AttributeLevel.Series))}initTooltip(){this._tooltipHelper=new RangeAreaSeriesTooltipHelper(this)}_isFieldAllValid(){const e=this.getViewDataStatistics(),i=this.fieldY;return!!(e&&e.latestData&&i.length)&&i.every(n=>e.latestData[n]&&e.latestData[n].allValid)}}RangeAreaSeries.type=SeriesTypeEnum.rangeArea,RangeAreaSeries.mark=rangeAreaSeriesMark;const registerRangeAreaSeries=()=>{registerAreaMark(),registerCartesianBandAxis(),registerCartesianLinearAxis(),Factory$1.registerSeries(RangeAreaSeries.type,RangeAreaSeries)};class PolarSeries extends BaseSeries{constructor(){super(...arguments),this.coordinate="polar",this._outerRadius=POLAR_DEFAULT_RADIUS,this._innerRadius=0,this._angleField=[],this._radiusField=[],this._sortDataByAxis=!1}get outerRadius(){return this._outerRadius}get innerRadius(){return this._innerRadius}getAngleField(){return this._angleField}setAngleField(e){return this._angleField=isValid(e)?array(e):[],this._angleField}getRadiusField(){return this._radiusField}setRadiusField(e){return this._radiusField=isValid(e)?array(e):[],this._radiusField}get innerRadiusField(){return this._innerRadiusField}setInnerRadiusField(e){return this._innerRadiusField=array(e),this._innerRadiusField}get radiusScale(){return this._radiusScale}setRadiusScale(e){return this._radiusScale=e,e}get angleScale(){return this._angleScale}setAngleScale(e){return this._angleScale=e,e}get angleAxisHelper(){return this._angleAxisHelper}set angleAxisHelper(e){this._angleAxisHelper=e,this.onAngleAxisHelperUpdate()}get radiusAxisHelper(){return this._radiusAxisHelper}set radiusAxisHelper(e){this._radiusAxisHelper=e,this.onRadiusAxisHelperUpdate()}get sortDataByAxis(){return this._sortDataByAxis}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this),this._markAttributeContext.getCenter=()=>this.angleAxisHelper.center(),this._markAttributeContext.getLayoutRadius=()=>this._computeLayoutRadius()}valueToPosition(e,i){if(isNil(e)||isNil(i)||!this.angleAxisHelper||!this.radiusAxisHelper)return{x:Number.NaN,y:Number.NaN};const n=this.radiusAxisHelper.dataToPosition(array(i));if(n<0){if(this._invalidType==="break"||this._invalidType==="link")return{x:Number.NaN,y:Number.NaN};if(this._invalidType==="zero")return this.angleAxisHelper.center()}const o=this.angleAxisHelper.dataToPosition(array(e));return this.angleAxisHelper.coordToPoint({angle:o,radius:n})}dataToPosition(e,i){return e&&this.angleAxisHelper&&this.radiusAxisHelper?i&&!this.isDatumInViewData(e)?null:this.valueToPosition(this.getDatumPositionValues(e,this._angleField),this.getDatumPositionValues(e,this._radiusField)):null}dataToPositionX(e){var i;return(i=this.dataToPosition(e))===null||i===void 0?void 0:i.x}dataToPositionY(e){var i;return(i=this.dataToPosition(e))===null||i===void 0?void 0:i.y}dataToPositionZ(e){return 0}positionToData(e){}radiusToData(e){}angleToData(e){}getStatisticFields(){var e,i;const n=[];return!((e=this.radiusAxisHelper)===null||e===void 0)&&e.getScale&&this._radiusField.forEach(o=>{const l={key:o,operations:[]};isContinuous(this.radiusAxisHelper.getScale(0).type)?l.operations=["max","min"]:l.operations=["values"],n.push(l)}),!((i=this.angleAxisHelper)===null||i===void 0)&&i.getScale&&this._angleField.forEach(o=>{const l={key:o,operations:[]};isContinuous(this.angleAxisHelper.getScale(0).type)?l.operations=["max","min"]:l.operations=["values"],n.push(l)}),n}setAttrFromSpec(){super.setAttrFromSpec(),isValid(this._spec.outerRadius)&&(this._outerRadius=this._spec.outerRadius),isValid(this._spec.radius)&&(this._outerRadius=this._spec.radius),isValid(this._spec.innerRadius)&&(this._innerRadius=this._spec.innerRadius),isValid(this._spec.sortDataByAxis)&&(this._sortDataByAxis=this._spec.sortDataByAxis===!0)}onRadiusAxisHelperUpdate(){this.onMarkPositionUpdate()}onAngleAxisHelperUpdate(){this.onMarkPositionUpdate()}afterInitMark(){super.afterInitMark()}_computeLayoutRadius(){const e=this._angleAxisHelper||this._radiusAxisHelper;if(e)return e.layoutRadius();const{width:i,height:n}=this._region.getLayoutRect();return Math.min(i/2,n/2)}initEvent(){super.initEvent(),this.sortDataByAxis&&this.event.on(ChartEvent.scaleDomainUpdate,{filter:e=>{var i;return e.model.id===((i=this._angleAxisHelper)===null||i===void 0?void 0:i.getAxisId())}},()=>{this._sortDataInAxisDomain()})}_sortDataInAxisDomain(){var e,i;!((i=(e=this.getViewData())===null||e===void 0?void 0:e.latestData)===null||i===void 0)&&i.length&&sortDataInAxisHelper(this.angleAxisHelper,this._angleField[0],this.getViewData().latestData)}getInvalidCheckFields(){const e=[];return this.angleAxisHelper.isContinuous&&this._angleField.forEach(i=>{e.push(i)}),this.radiusAxisHelper.isContinuous&&this._radiusField.forEach(i=>{e.push(i)}),e}}function transformInvalidValue(r){return couldBeValidNumber(r)?Number.parseFloat(r):0}const pie=(r,e)=>{const{asStartAngle:i,asEndAngle:n,asMiddleAngle:o,asRadian:l,asRatio:d,asQuadrant:u,asK:f,showAllZero:g,supportNegative:_,showEmptyCircle:y}=e,b=e.angleField(),S=e.startAngle(),v=e.endAngle(),A=e.minAngle(),x=r.map(O=>Object.assign({},O));if(!x||x.length===0||!g&&y&&isDataEmpty(x,b,_))return x;const T=(O,N,V)=>{O[i]=N,O[n]=N+V,O[o]=N+V/2,O[l]=V,O[u]=computeQuadrant(N+V/2)};let C=0,E=-1/0,P=!0;for(let O=0;O<x.length;O++){const N=_?Math.abs(transformInvalidValue(x[O][b])):transformInvalidValue(x[O][b]);C+=N,E=Math.max(N,E),P&&N!==0&&(P=!1),x[O][ARC_TRANSFORM_VALUE]=N}const R=x.map(O=>Number(O[b])),L=v-S;let w=S,B=L,I=0;const D=getPercentValue(R);if(x.forEach((O,N)=>{const V=O[ARC_TRANSFORM_VALUE],H=C?V/C:0;let F=H*L;F<A?(F=A,B-=A):I+=V;const $=w,G=w+F;O[d]=H,O[f]=E?V/E:0,O._percent_=D[N],T(O,$,F),w=G}),B<L)if(B<=.001){const O=L/x.length;x.forEach((N,V)=>{T(N,S+V*O,O)})}else{const O=B/I;w=S,x.forEach(N=>{const V=N[l]===A?A:N[ARC_TRANSFORM_VALUE]*O;T(N,w,V),w+=V})}if(C!==0&&(x[x.length-1][n]=v),P&&g){const O=L/x.length;x.forEach((N,V)=>{T(N,S+V*O,O)})}return x},isDataEmpty=(r,e,i)=>!!isNil(r)||r.length===0||!!r.every(n=>transformInvalidValue(n[e])===0)||!i&&r.reduce((n,o)=>n+transformInvalidValue(o[e]),0)===0;function pieGrowOption(r,e,i){return(n,o,l)=>e?r.growField==="radius"?{overall:0}:{overall:r.growFrom(n,o,i)}:{overall:!1}}const Appear_Grow$4=r=>({type:r.growField==="radius"?"growRadiusIn":"growAngleIn",options:pieGrowOption(r,!0,AnimationStateEnum.appear)}),Appear_FadeIn$4={type:"fadeIn"},pieEnter=r=>({type:r.growField==="radius"?"growRadiusIn":"growAngleIn",easing:"linear",options:pieGrowOption(r,!0,AnimationStateEnum.enter)}),pieExit=r=>({type:r.growField==="radius"?"growRadiusOut":"growAngleOut",easing:"linear",options:pieGrowOption(r,!0,AnimationStateEnum.exit)}),pieDisappear=r=>({type:r.growField==="radius"?"growRadiusOut":"growAngleOut",options:pieGrowOption(r,!0,AnimationStateEnum.exit)});function piePresetAnimation(r,e){if(e===!1)return{};switch(e){case"fadeIn":return Appear_FadeIn$4;case"growRadius":return Appear_Grow$4(Object.assign(Object.assign({},r),{growField:"radius"}));default:return Appear_Grow$4(Object.assign(Object.assign({},r),{growField:"angle"}))}}const registerPieAnimation=()=>{Factory$1.registerAnimation("pie",(r,e)=>({appear:piePresetAnimation(r,e),enter:pieEnter(r),exit:pieExit(r),disappear:pieDisappear(r)}))},registerEmptyCircleAnimation=()=>{Factory$1.registerAnimation("emptyCircle",(r,e)=>({appear:piePresetAnimation(r,e)}))},registerPie3dAnimation=()=>{Factory$1.registerAnimation("pie3d",(r,e)=>({appear:piePresetAnimation(r,e),enter:pieEnter(r),exit:pieExit(r),disappear:pieDisappear(r)}))};function centerOffsetConfig(r,e){var i,n,o,l;const d=(n=(i=e.options)===null||i===void 0?void 0:i.distance)!==null&&n!==void 0?n:10,u=isValidNumber(e.duration)?e.duration/2:1e3,f=(o=e.options.easing)!==null&&o!==void 0?o:"cubicOut";return{oneByOne:e.oneByOne,loop:(l=e.loop)!==null&&l!==void 0&&l,timeSlices:[{duration:u,effects:{easing:f,channel:{x:{from:g=>r.getAttribute("x",g),to:g=>r.getAttribute("x",g)+polarToCartesian({x:0,y:0},d,g[ARC_MIDDLE_ANGLE]).x},y:{from:g=>r.getAttribute("y",g),to:g=>r.getAttribute("y",g)+polarToCartesian({x:0,y:0},d,g[ARC_MIDDLE_ANGLE]).y}}}},{duration:u,effects:{easing:f,channel:{x:{to:g=>r.getAttribute("x",g),from:g=>r.getAttribute("x",g)+polarToCartesian({x:0,y:0},d,g[ARC_MIDDLE_ANGLE]).x},y:{to:g=>r.getAttribute("y",g),from:g=>r.getAttribute("y",g)+polarToCartesian({x:0,y:0},d,g[ARC_MIDDLE_ANGLE]).y}}}}]}}class BaseArcMark extends BaseMark{constructor(e,i){super(e,i),this.type=ArcMark.type,this._unCompileChannel={centerOffset:!0,radiusOffset:!0},this.computeOuterRadius=(n,o,l="normal",d,u)=>{var f;return u+((f=this.getAttribute("radiusOffset",o,l,d))!==null&&f!==void 0?f:0)},this.computeCenter=(n,o,l="normal",d,u)=>polarToCartesian({x:0,y:0},this.getAttribute("centerOffset",o,l,d),o[ARC_MIDDLE_ANGLE])[n]+u,this._computeExChannel.x=this.computeCenter,this._computeExChannel.y=this.computeCenter,this._computeExChannel.outerRadius=this.computeOuterRadius,this._extensionChannel.centerOffset=["x","y"],this._extensionChannel.radiusOffset=["outerRadius"]}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{startAngle:0,endAngle:0,outerRadius:0,innerRadius:0,cornerRadius:0,lineWidth:0,innerPadding:0,outerPadding:0})}}class ArcMark extends BaseArcMark{constructor(){super(...arguments),this.type=ArcMark.type}}ArcMark.type="arc";const registerArcMark=()=>{registerArcGraphic(),registerVGrammarArcAnimation(),Factory$1.registerMark(ArcMark.type,ArcMark)},pieSeriesMark=Object.assign(Object.assign({},baseSeriesMark),{pie:{name:"pie",type:"arc"},labelLine:{name:"labelLine",type:"path"}}),pie3dSeriesMark=Object.assign(Object.assign({},baseSeriesMark),{pie3d:{name:"pie3d",type:"arc3d"},labelLine:{name:"labelLine",type:"path"}});class PieSeriesSpecTransformer extends BaseSeriesSpecTransformer{_transformLabelSpec(e){this._addMarkLabelSpec(e,"pie")}_mergeThemeToSpec(e,i){const n=this._theme;let o=e;if(this._shouldMergeThemeToSpec()){const l=this._getDefaultSpecFromChart(i);o=mergeSpec({},this._theme,l,e);const d=(u,f)=>mergeSpec({},u==="inside"||u==="inside-center"?this._theme.innerLabel:this._theme.outerLabel,f);isArray(o.label)?o.label=o.label.map(u=>d(u.position,u)):o.label=d(o.label.position,o.label)}return{spec:o,theme:n}}_getDefaultSpecFromChart(e){var i;const n=(i=super._getDefaultSpecFromChart(e))!==null&&i!==void 0?i:{},{centerX:o,centerY:l}=e;return isValid(o)&&(n.centerX=o),isValid(l)&&(n.centerY=l),Object.keys(n).length>0?n:void 0}}const DEFAULT_LABEL_VISIBLE=`${PREFIX}_LABEL_VISIBLE`,getPolarAxisInfo=(r,e)=>{var i,n,o,l,d,u;const f=(i=r.type)!==null&&i!==void 0?i:r.orient==="angle"?"band":"linear",g=`${ComponentTypeEnum.polarAxis}-${f}`,_=(n=r.startAngle)!==null&&n!==void 0?n:e.startAngle,y=(o=r.endAngle)!==null&&o!==void 0?o:e.endAngle;return{axisType:f,componentName:g,startAngle:_??POLAR_START_ANGLE,endAngle:y??(isValid(_)?_+360:POLAR_END_ANGLE),center:isValid(e.center)?e.center:isValid(e==null?void 0:e.centerX)||isValid(e==null?void 0:e.centerY)?{x:e==null?void 0:e.centerX,y:e==null?void 0:e.centerY}:void 0,outerRadius:(u=(d=(l=r.outerRadius)!==null&&l!==void 0?l:r.radius)!==null&&d!==void 0?d:e.outerRadius)!==null&&u!==void 0?u:e.radius,layoutRadius:e.layoutRadius}},computeLayoutRadius=(r,e,i,n)=>{const o=r();if(isNumber(o))return o;if(isFunction(o))return o(e(),i());const l=e();if(o==="auto"&&l.width>0&&l.height>0){const{startAngle:d=0,endAngle:u=2*Math.PI}=n();return calculateMaxRadius(l,i(),d,u)}return Math.min(l.width/2,l.height/2)};class BasePieSeries extends PolarSeries{constructor(){super(...arguments),this.transformerConstructor=PieSeriesSpecTransformer,this._pieMarkName="pie",this._pieMarkType="arc",this.getCenter=()=>{var e,i;const n=this._region.getLayoutRect();return{x:calcLayoutNumber((e=this._spec)===null||e===void 0?void 0:e.centerX,n.width,n,n.width/2),y:calcLayoutNumber((i=this._spec)===null||i===void 0?void 0:i.centerY,n.height,n,n.height/2)}},this._startAngle=POLAR_START_RADIAN,this._endAngle=POLAR_END_RADIAN,this._pieMark=null,this._labelMark=null,this._labelLineMark=null,this._emptyArcMark=null,this.dataToCentralPosition=e=>{const i=e[ARC_MIDDLE_ANGLE];if(isNil(i))return null;const n=this.computeDatumRadius(e),o=this.computeDatumInnerRadius(e),l=this.computeCenter(e);return polarToCartesian(l,(n+o)/2,i)}}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.getCenter=()=>({x:()=>this.getCenter().x,y:()=>this.getCenter().y}),this._markAttributeContext.startAngleScale=e=>this.startAngleScale(e),this._markAttributeContext.endAngleScale=e=>this.endAngleScale(e)}setAttrFromSpec(){var e,i,n,o,l,d;super.setAttrFromSpec(),this._centerOffset=(e=this._spec.centerOffset)!==null&&e!==void 0?e:0,this._cornerRadius=(i=this._spec.cornerRadius)!==null&&i!==void 0?i:0;const u=normalizeStartEndAngle(isValid(this._spec.startAngle)?degreeToRadian(this._spec.startAngle):this._startAngle,isValid(this._spec.endAngle)?degreeToRadian(this._spec.endAngle):this._endAngle);this._startAngle=u.startAngle,this._endAngle=u.endAngle,this._padAngle=isValid(this._spec.padAngle)?degreeToRadian(this._spec.padAngle):0,this.setAngleField(this._spec.valueField||this._spec.angleField),this._spec.categoryField&&this.setSeriesField(this._spec.categoryField),this._radiusField=[],this._specAngleField=this._angleField.slice(),this._specRadiusField=[],this._showEmptyCircle=(o=(n=this._spec.emptyPlaceholder)===null||n===void 0?void 0:n.showEmptyCircle)!==null&&o!==void 0&&o,this._showAllZero=(l=this._spec.showAllZero)!==null&&l!==void 0&&l,this._supportNegative=(d=this._spec.supportNegative)!==null&&d!==void 0&&d}initData(){super.initData();const e=this.getViewData();if(!e)return;registerDataSetInstanceTransform(this._dataSet,"pie",pie),e.transform({type:"pie",options:{angleField:()=>this._angleField[0],startAngle:()=>this._startAngle,endAngle:()=>this._endAngle,minAngle:()=>isValid(this._spec.minAngle)?degreeToRadian(this._spec.minAngle):0,asStartAngle:ARC_START_ANGLE,asEndAngle:ARC_END_ANGLE,asRatio:ARC_RATIO,asMiddleAngle:ARC_MIDDLE_ANGLE,asRadian:ARC_RADIAN,asQuadrant:ARC_QUADRANT,asK:ARC_K,showAllZero:this._showAllZero,supportNegative:this._supportNegative,showEmptyCircle:this._showEmptyCircle}},!1);const i=new DataView(this._dataSet,{name:`${PREFIX}_series_${this.id}_viewDataLabel`});i.parse([this.getViewData()],{type:"dataview"}),this._viewDataLabel=new SeriesData(this._option,i)}compileData(){var e;super.compileData(),(e=this._viewDataLabel)===null||e===void 0||e.compile()}initMark(){var e,i;this._pieMark=this._createMark(Object.assign(Object.assign({},BasePieSeries.mark.pie),{name:this._pieMarkName,type:this._pieMarkType}),{key:DEFAULT_DATA_KEY,groupKey:this._seriesField,skipBeforeLayouted:!0,isSeriesMark:!0,stateSort:(e=this._spec.pie)===null||e===void 0?void 0:e.stateSort},{setCustomizedShape:(i=this._spec.pie)===null||i===void 0?void 0:i.customShape,morph:shouldMarkDoMorph(this._spec,this._pieMarkName),morphElementKey:this._seriesField}),this._showEmptyCircle&&(this._emptyArcMark=this._createMark({name:"emptyCircle",type:"arc"},{dataView:!1}))}startAngleScale(e){return field$2(ARC_START_ANGLE)(e)}endAngleScale(e){return field$2(ARC_END_ANGLE)(e)}_computeLayoutRadius(){return computeLayoutRadius(()=>this._spec.layoutRadius,this.getLayoutRect,this.getCenter,()=>({startAngle:this._startAngle,endAngle:this._endAngle}))}initMarkStyle(){const e={x:()=>this.getCenter().x,y:()=>this.getCenter().y,fill:this.getColorAttribute(),outerRadius:isSpecValueWithScale(this._outerRadius)?this._outerRadius:()=>this._computeLayoutRadius()*this._outerRadius,innerRadius:isSpecValueWithScale(this._innerRadius)?this._innerRadius:()=>this._computeLayoutRadius()*this._innerRadius,cornerRadius:()=>this._computeLayoutRadius()*this._cornerRadius,startAngle:o=>this.startAngleScale(o),endAngle:o=>this.endAngleScale(o),padAngle:this._padAngle,centerOffset:this._centerOffset},i=this._pieMark;i&&this.setMarkStyle(i,e,"normal",AttributeLevel.Series);const n=this._emptyArcMark;n&&this.setMarkStyle(n,Object.assign(Object.assign({},e),{visible:()=>{const o=this.getAngleField()[0];return isDataEmpty(this.getViewData().latestData,o,this._supportNegative)}}),"normal",AttributeLevel.Series)}initInteraction(){this._parseInteractionConfig(this._pieMark?[this._pieMark]:[])}initTooltip(){super.initTooltip(),this._pieMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pieMark)}initMarkStyleWithSpec(e,i,n){if(super.initMarkStyleWithSpec(e,i,n),e.name===this._pieMarkName){const o=this.getSpec()[e.name];if(o)for(const l in o.state||{})this.setMarkStyle(e,this.generateRadiusStyle(o.state[l]),l,AttributeLevel.User_Mark)}e.name==="emptyCircle"&&this.setMarkStyle(e,this.generateRadiusStyle(i.style),"normal",AttributeLevel.User_Mark)}initLabelMarkStyle(e){e&&this.setMarkStyle(e,{visible:field$2(DEFAULT_LABEL_VISIBLE).bind(this),text:i=>i[this.getDimensionField()[0]],fill:this.getColorAttribute(),z:this.dataToPositionZ.bind(this)})}afterInitMark(){super.afterInitMark()}initEvent(){var e;super.initEvent(),(e=this._viewDataLabel.getDataView())===null||e===void 0||e.target.addListener("change",this.viewDataLabelUpdate.bind(this))}initGroups(){}onLayoutEnd(e){this._viewDataLabel.getDataView().reRunAllTransform(),this.onMarkPositionUpdate(),super.onLayoutEnd(e)}getDimensionField(){return this._seriesField?[this._seriesField]:[]}getMeasureField(){return this._specAngleField}viewDataLabelUpdate(){this.event.emit(ChartEvent.viewDataLabelUpdate,{model:this}),this._viewDataLabel.updateData()}generateRadiusStyle(e){if(!e)return;const i={};return e.outerRadius&&(i.outerRadius=()=>this._computeLayoutRadius()*e.outerRadius),e.innerRadius&&(i.innerRadius=()=>this._computeLayoutRadius()*e.innerRadius),e.cornerRadius&&(i.cornerRadius=()=>this._computeLayoutRadius()*e.cornerRadius),i}computeCenter(e){return{x:this._pieMark.getAttribute("x",e,"normal"),y:this._pieMark.getAttribute("y",e,"normal")}}getRadius(e="normal"){var i,n,o,l,d,u,f;const g=e==="normal"?(o=(n=this.getSpec()[((i=this._pieMark)===null||i===void 0?void 0:i.name)||"pie"])===null||n===void 0?void 0:n.style)===null||o===void 0?void 0:o.outerRadius:(f=(u=(d=this.getSpec()[((l=this._pieMark)===null||l===void 0?void 0:l.name)||"pie"])===null||d===void 0?void 0:d.state)===null||u===void 0?void 0:u[e])===null||f===void 0?void 0:f.outerRadius;return g??this._outerRadius}getInnerRadius(e="normal"){var i,n,o,l,d,u,f;const g=e==="normal"?(o=(n=this.getSpec()[((i=this._pieMark)===null||i===void 0?void 0:i.name)||"pie"])===null||n===void 0?void 0:n.style)===null||o===void 0?void 0:o.innerRadius:(f=(u=(d=this.getSpec()[((l=this._pieMark)===null||l===void 0?void 0:l.name)||"pie"])===null||d===void 0?void 0:d.state)===null||u===void 0?void 0:u[e])===null||f===void 0?void 0:f.innerRadius;return g??this._innerRadius}computeRadius(e,i){return this._computeLayoutRadius()*e*(isNil(i)?1:i)+this._centerOffset}computeDatumRadius(e,i){return this._computeLayoutRadius()*this.getRadius(i)+this._centerOffset}_compareSpec(e,i,n){n=n??{data:!0};const o=["centerX","centerY","centerOffset","radius","innerRadius","cornerRadius","startAngle","endAngle","padAngle"];o.forEach(d=>{n[d]=!0});const l=super._compareSpec(e,i,n);return e=e??{},o.some(d=>e[d]!==i[d])&&(l.reRender=!0,l.change=!0),l}computeDatumInnerRadius(e,i){return this._computeLayoutRadius()*this.getInnerRadius(i)+this._centerOffset}dataToPosition(e,i){const n=e[ARC_MIDDLE_ANGLE];if(isNil(n)||i&&!this.isDatumInViewData(e))return null;const o=this.computeDatumRadius(e),l=this.computeCenter(e);return polarToCartesian(l,o,n)}initAnimation(){var e,i,n;const o={growFrom:(d,u,f)=>{var g;if(f===AnimationStateEnum.appear)return this._startAngle;if(f===AnimationStateEnum.disappear)return this._endAngle;const _=[AnimationStateEnum.disappear,AnimationStateEnum.exit],y=u.mark.elements,b=d,S=b==null?void 0:b[DEFAULT_DATA_INDEX];if(y.find(A=>{var x;return((x=A.data[0])===null||x===void 0?void 0:x[DEFAULT_DATA_INDEX])<S})===void 0)return this._startAngle;if(y.find(A=>{var x;return((x=A.data[0])===null||x===void 0?void 0:x[DEFAULT_DATA_INDEX])>S})===void 0)return this._endAngle;const v=[...y].reverse().find(A=>{var x;return((x=A.data[0])===null||x===void 0?void 0:x[DEFAULT_DATA_INDEX])<S});return _.includes(f)?(g=v==null?void 0:v.getNextGraphicAttributes())===null||g===void 0?void 0:g.endAngle:v==null?void 0:v.getGraphicAttribute("endAngle",!0)}},l=(e=this._spec.animationAppear)===null||e===void 0?void 0:e.preset;if(this._pieMark){const d=animationConfig((i=Factory$1.getAnimationInKey("pie"))===null||i===void 0?void 0:i(o,l),userAnimationConfig("pie",this._spec,this._markAttributeContext));d.normal&&d.normal.type&&(d.normal=centerOffsetConfig(this._pieMark,d.normal)),this._pieMark.setAnimationConfig(d)}if(this._emptyArcMark){const d=animationConfig((n=Factory$1.getAnimationInKey("emptyCircle"))===null||n===void 0?void 0:n(o,l??"fadeIn"));this._emptyArcMark.setAnimationConfig(d)}}getDefaultShapeType(){return"circle"}getGroupFields(){return[]}getStackGroupFields(){return[]}getStackValueField(){return""}_noAnimationDataKey(e,i){return i}getActiveMarks(){return[this._pieMark]}}BasePieSeries.transformerConstructor=PieSeriesSpecTransformer,BasePieSeries.mark=pieSeriesMark;class PieSeries extends BasePieSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.pie}}PieSeries.type=SeriesTypeEnum.pie;const registerPieSeries=()=>{registerArcMark(),registerPieAnimation(),registerEmptyCircleAnimation(),Factory$1.registerSeries(PieSeries.type,PieSeries)};class Arc3dMark extends BaseArcMark{constructor(){super(...arguments),this.type=Arc3dMark.type,this._support3d=!0}}Arc3dMark.type="arc3d";const registerArc3dMark=()=>{registerVGrammarArcAnimation(),registerArc3dGraphic(),Factory$1.registerMark(Arc3dMark.type,Arc3dMark)};class Pie3dSeriesSpecTransformer extends PieSeriesSpecTransformer{_transformLabelSpec(e){this._addMarkLabelSpec(e,"pie3d")}}class Pie3dSeries extends BasePieSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.pie3d,this._pieMarkName="pie3d",this._pieMarkType="arc3d",this.transformerConstructor=Pie3dSeriesSpecTransformer}setAttrFromSpec(){var e,i;super.setAttrFromSpec(),this._angle3d=(i=(e=this._spec)===null||e===void 0?void 0:e.angle3d)!==null&&i!==void 0?i:-Math.PI/3}initMarkStyle(){super.initMarkStyle();const e=this._pieMark;e&&this.setMarkStyle(e,{beta:()=>this._angle3d},"normal",AttributeLevel.Series)}initLabelMarkStyle(e,i={}){e&&(super.initLabelMarkStyle(e),this.setMarkStyle(e,{support3d:!0},void 0,AttributeLevel.Mark))}}Pie3dSeries.type=SeriesTypeEnum.pie3d,Pie3dSeries.mark=pie3dSeriesMark,Pie3dSeries.transformerConstructor=Pie3dSeriesSpecTransformer;const registerPie3dSeries=()=>{registerPie3dAnimation(),registerArc3dMark(),Factory$1.registerSeries(Pie3dSeries.type,Pie3dSeries)},Appear_Grow$3=r=>{const e=r.growField==="angle"?0:r.innerRadius;return r.growField==="angle"?{type:r.growField==="angle"?"growAngleIn":"growRadiusIn"}:{channel:{innerRadius:{from:e,to:(i,n)=>{var o;return(o=n.getFinalGraphicAttributes())===null||o===void 0?void 0:o.innerRadius}},outerRadius:{from:e,to:(i,n)=>{var o;return(o=n.getFinalGraphicAttributes())===null||o===void 0?void 0:o.outerRadius}}}}},Appear_FadeIn$3={type:"fadeIn"},roseEnter=r=>({type:r.growField==="angle"?"growAngleIn":"growRadiusIn"}),roseExit=r=>({type:r.growField==="angle"?"growAngleOut":"growRadiusOut"}),roseDisappear=r=>({type:r.growField==="angle"?"growAngleOut":"growRadiusOut"});function rosePresetAnimation(r,e){if(e===!1)return{};switch(e){case"fadeIn":return Appear_FadeIn$3;case"growAngle":return Appear_Grow$3(Object.assign(Object.assign({},r),{growField:"angle"}));default:return Appear_Grow$3(Object.assign(Object.assign({},r),{growField:"radius"}))}}const registerRoseAnimation=()=>{Factory$1.registerAnimation("rose",(r,e)=>({appear:rosePresetAnimation(r,e),enter:roseEnter(r),exit:roseExit(r),disappear:roseDisappear(r)}))};class RoseLikeSeries extends PolarSeries{getStackGroupFields(){return this._angleField}getStackValueField(){return array(this._spec.valueField)[0]||array(this._spec.radiusField)[0]}getGroupFields(){return this._angleField}setAttrFromSpec(){super.setAttrFromSpec(),this.setAngleField(this._spec.categoryField||this._spec.angleField),this.setRadiusField(this._spec.valueField||this._spec.radiusField),this._specAngleField=this._angleField.slice(),this._specRadiusField=this._radiusField.slice(),this.setInnerRadiusField(this._spec.valueField||this._spec.radiusField),this.getStack()&&this.setValueFieldToStack(),this.getPercent()&&this.setValueFieldToPercent()}setValueFieldToStack(){this.setRadiusField(STACK_FIELD_END),this.setInnerRadiusField(STACK_FIELD_START)}setValueFieldToPercent(){this.setRadiusField(STACK_FIELD_END_PERCENT),this.setInnerRadiusField(STACK_FIELD_START_PERCENT)}getDimensionField(){return this._specAngleField}getMeasureField(){return this._specRadiusField}getDefaultShapeType(){return"square"}}const roseSeriesMark=Object.assign(Object.assign({},baseSeriesMark),{rose:{name:"rose",type:"arc"}});class RoseSeriesSpecTransformer extends BaseSeriesSpecTransformer{constructor(){super(...arguments),this._supportStack=!0}_transformLabelSpec(e){this._addMarkLabelSpec(e,"rose")}}var __rest$9=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};class PolarAxis extends AxisComponent{get center(){return this._center}get startAngle(){return this._startAngle}get endAngle(){return this._endAngle}getOrient(){return this._orient}getDefaultInteractive(){return this._orient!=="angle"}getGroupScales(){return this._groupScales}static getSpecInfo(e){if(!e[this.specKey])return null;const i=isArray(e[this.specKey]),n=i?e[this.specKey]:[e[this.specKey]],o=[];let l,d;const u=[],f=[];return n.forEach((g,_)=>{if(!isValidPolarAxis(g))return;const{axisType:y,componentName:b,startAngle:S,endAngle:v,center:A,outerRadius:x,layoutRadius:T}=getPolarAxisInfo(g,e);g.center=A,g.startAngle=S,g.endAngle=v,g.outerRadius=x,g.type=y,g.layoutRadius=T;const C={spec:g,specPath:i?[this.specKey,_]:[this.specKey],specInfoPath:["component",this.specKey,_],type:b};o.push(C),g.orient==="radius"?(u.push(C),d=_):(f.push(C),l=_)}),u.forEach(g=>{g.angleAxisIndex=l}),f.forEach(g=>{g.radiusAxisIndex=d}),o}static createComponent(e,i){const{spec:n}=e,o=__rest$9(e,["spec"]),l=Factory$1.getComponentInKey(o.type);return l?new l(n,Object.assign(Object.assign({},i),o)):(i.onError(`Component ${o.type} not found`),null)}constructor(e,i){super(e,i),this.type=ComponentTypeEnum.polarAxis,this.name=ComponentTypeEnum.polarAxis,this._defaultBandPosition=0,this._defaultBandInnerPadding=0,this._defaultBandOuterPadding=0,this.layoutType="absolute",this.layoutZIndex=LayoutZIndex.Axis,this._tick=void 0,this._center=null,this._startAngle=POLAR_START_RADIAN,this._endAngle=POLAR_END_RADIAN,this._orient="radius",this._groupScales=[],this.effect={scaleUpdate:n=>{this.computeData(n==null?void 0:n.value),eachSeries(this._regions,o=>{this.getOrient()==="radius"?shouldUpdateAxis(o.radiusAxisHelper,this.axisHelper(),isValid(this._seriesUserId)||isValid(this._seriesIndex))&&(o.radiusAxisHelper=this.axisHelper()):shouldUpdateAxis(o.angleAxisHelper,this.axisHelper(),isValid(this._seriesUserId)||isValid(this._seriesIndex))&&(o.angleAxisHelper=this.axisHelper())},{userId:this._seriesUserId,specIndex:this._seriesIndex})}},this._transformLayoutPosition=n=>{var o;const l=(o=this.getRegions())===null||o===void 0?void 0:o[0];return l?l.getLayoutStartPoint():n},this.getCenter=()=>{var n,o;const l=this.getRefLayoutRect(),{width:d,height:u}=l;return{x:calcLayoutNumber((n=this._center)===null||n===void 0?void 0:n.x,d,l,d/2),y:calcLayoutNumber((o=this._center)===null||o===void 0?void 0:o.y,u,l,u/2)}},this.getRefLayoutRect=()=>this.getRegions()[0].getLayoutRect(),this._coordinateType="polar"}setAttrFromSpec(){super.setAttrFromSpec(),this.visible&&(this._axisStyle=this._getAxisAttributes(),this._gridStyle=this._getGridAttributes()),this._tick=this._spec.tick,this._orient=this._spec.orient==="angle"?"angle":"radius",this._center=this._spec.center,this._startAngle=degreeToRadian(this._spec.startAngle),this._endAngle=degreeToRadian(this._spec.endAngle),this._inverse=this._spec.inverse}onRender(e){}changeRegions(){}_tickTransformOption(){var e;return Object.assign(Object.assign({},super._tickTransformOption()),{noDecimal:(e=this._tick)===null||e===void 0?void 0:e.noDecimals,startAngle:this.startAngle,labelOffset:getAxisLabelOffset(this._spec),getRadius:()=>this.getOuterRadius(),inside:this._spec.inside})}updateScaleRange(){const e=this._scale.range();let i;return i=this.getOrient()==="radius"?this._inverse?[this.computeLayoutOuterRadius(),this.computeLayoutInnerRadius()]:[this.computeLayoutInnerRadius(),this.computeLayoutOuterRadius()]:this._inverse?[this._endAngle,this._startAngle]:[this._startAngle,this._endAngle],(!e||!i||e[0]!==i[0]||e[1]!==i[1])&&(this._scale.range(i),!0)}collectSeriesField(e,i){var n,o;let l;return l=e>0?(o=(n=i.getGroups())===null||n===void 0?void 0:n.fields)===null||o===void 0?void 0:o[e]:this.getOrient()==="radius"?i.getRadiusField():i.getAngleField(),l}updateSeriesScale(){eachSeries(this._regions,e=>{this.getOrient()==="radius"?shouldUpdateAxis(e.radiusAxisHelper,this.axisHelper(),isValid(this._seriesUserId)||isValid(this._seriesIndex))&&(e.setRadiusScale(this._scale),e.radiusAxisHelper=this.axisHelper()):shouldUpdateAxis(e.angleAxisHelper,this.axisHelper(),isValid(this._seriesUserId)||isValid(this._seriesIndex))&&(e.setAngleScale(this._scale),e.angleAxisHelper=this.axisHelper())},{userId:this._seriesUserId,specIndex:this._seriesIndex})}getSeriesStatisticsField(e){const i=this.getOrient()==="radius"?e.getRadiusField():e.getAngleField();return isContinuous(this._scale.type)?i:[i[0]]}initGroupScales(){}axisHelper(){return{isContinuous:isContinuous(this._scale.type),dataToPosition:this.dataToPosition.bind(this),coordToPoint:this.coordToPoint.bind(this),pointToCoord:this.pointToCoord.bind(this),center:this.getCenter.bind(this),layoutRadius:this._computeLayoutRadius.bind(this),getScale:(e=0)=>this._scales[e],getAxisId:()=>this.id,getSpec:()=>this._spec}}positionToData(e){const i=this.pointToCoord(e);return this.getOrient()==="radius"?this.invert(i.radius):this.invert(i.angle)}coordToPoint(e){const i=this.getCenter();return polarToCartesian(i,e.radius,e.angle)}pointToCoord(e){const i=this.getCenter(),n=this._startAngle,o=this._endAngle;return cartesianToPolar(e,i,n,o)}getOuterRadius(){return this.computeLayoutOuterRadius()}getInnerRadius(){return this.computeLayoutInnerRadius()}updateLayoutAttribute(){this._visible&&(this.getOrient()==="radius"?this._layoutRadiusAxis():this._layoutAngleAxis()),super.updateLayoutAttribute()}_getNormalizedValue(e,i){return i===0?0:(this.dataToPosition(e)-this._getStartValue())/i}getLabelItems(e){var i;const n=(i=this.getTickData())===null||i===void 0?void 0:i.getLatestData();return n&&n.length?[n.map(o=>getAxisItem(o.value,this._getNormalizedValue([o.value],e)))]:[]}_getStartValue(){return this.getOrient()==="radius"?this.computeLayoutInnerRadius():this._startAngle}_layoutAngleAxis(){var e,i,n;const o=this.getCenter(),l=this.computeLayoutOuterRadius(),d=this.computeLayoutInnerRadius(),u=this._endAngle-this._startAngle,f=this.getLabelItems(u),g=Object.assign(Object.assign({},this.getLayoutStartPoint()),{inside:this._spec.inside,center:o,radius:l,innerRadius:d,startAngle:this._startAngle,endAngle:this._endAngle,sides:!((n=(i=(e=this._getRelatedAxis(this._option.radiusAxisIndex))===null||e===void 0?void 0:e.getSpec())===null||i===void 0?void 0:i.grid)===null||n===void 0)&&n.smooth?void 0:this.getScale().domain().length}),_=Object.assign(Object.assign({},g),{size:this.getRefLayoutRect(),title:{text:this._spec.title.text||this._dataFieldText},items:f,orient:"angle"});this._spec.grid.visible&&(_.grid=Object.assign({type:"line",smoothLink:!0,items:f[0]},g)),this._update(_)}_layoutRadiusAxis(){var e,i,n;const o=this.getCenter(),l=this.computeLayoutOuterRadius(),d=this.computeLayoutInnerRadius(),u=this.coordToPoint({angle:this._startAngle,radius:l}),f=this.coordToPoint({angle:this._startAngle,radius:d}),g=PointService.distancePP(f,u),_=this.getLabelItems(g),y=Object.assign(Object.assign({},this.getLayoutStartPoint()),{start:f,end:u,verticalFactor:-1}),b=Object.assign(Object.assign({},y),{title:{text:this._spec.title.text||this._dataFieldText},items:_,orient:"radius"});!((e=this._spec.grid)===null||e===void 0)&&e.visible&&(b.grid=Object.assign({items:_[0],type:!((i=this._spec.grid)===null||i===void 0)&&i.smooth?"circle":"polygon",center:o,closed:!0,sides:(n=this._getRelatedAxis(this._option.angleAxisIndex))===null||n===void 0?void 0:n.getScale().domain().length,startAngle:this._startAngle,endAngle:this._endAngle},y)),this._update(b)}_getRelatedAxis(e){if(isValid(e))return this._option.getComponentByIndex(this.specKey,e)}_computeLayoutRadius(){return computeLayoutRadius(()=>this._spec.layoutRadius,this.getRefLayoutRect,this.getCenter,()=>({startAngle:this._startAngle,endAngle:this._endAngle}))}computeLayoutOuterRadius(){var e;const i=(e=this._spec.outerRadius)!==null&&e!==void 0?e:this._spec.radius,n=i??this.getRefSeriesRadius().outerRadius;return this._computeLayoutRadius()*n}computeLayoutInnerRadius(){var e;const i=(e=this._spec.innerRadius)!==null&&e!==void 0?e:this.getRefSeriesRadius().innerRadius;return this._computeLayoutRadius()*i}getRefSeriesRadius(){let e=POLAR_DEFAULT_RADIUS,i=0;const n=this.getChart().getSpec();return eachSeries(this.getRegions(),o=>{const l=o;if(isPolarAxisSeries(l.type)){const{outerRadius:d=n.outerRadius,innerRadius:u=n.innerRadius}=l;isValidNumber(d)&&(e=d),isValidNumber(u)&&(i=u)}},{userId:this._seriesUserId,specIndex:this._seriesIndex}),{outerRadius:e,innerRadius:i}}_update(e){const{grid:i}=e,n=__rest$9(e,["grid"]);this._axisMark.getProduct().encode(mergeSpec({},this._axisStyle,n)),this._gridMark&&this._gridMark.getProduct().encode(mergeSpec({},this._gridStyle,i))}invert(e){var i;if(this.getOrient()==="angle"&&this._scale.type==="band"){const n=this._scale.range(),o=n[n.length-1]-n[0],l=((i=this.getSpec().bandPosition)!==null&&i!==void 0?i:this._defaultBandPosition)===.5?0:this._scale.bandwidth()/2;if(n[0]<0){const d=(e+l+Math.abs(n[0]))%o-Math.abs(n[0]);return this._scale.invert(d)}return this._scale.invert((e+l)%o)}return this._scale.invert(e)}}PolarAxis.type=ComponentTypeEnum.polarAxis,PolarAxis.specKey="axes";class PolarLinearAxis extends PolarAxis{constructor(){super(...arguments),this.type=ComponentTypeEnum.polarLinearAxis,this._zero=!0,this._nice=!0,this._extend={},this._scale=new LinearScale}setAttrFromSpec(){super.setAttrFromSpec(),this.setExtraAttrFromSpec()}initScales(){super.initScales(),this.setScaleNice()}computeDomain(e){return this.computeLinearDomain(e)}axisHelper(){const e=super.axisHelper();return e.setExtendDomain=this.setExtendDomain.bind(this),e}registerTicksTransform(){const e=`${this.type}-ticks`;return registerDataSetInstanceTransform(this._option.dataSet,e,continuousTicks),e}}PolarLinearAxis.type=ComponentTypeEnum.polarLinearAxis,PolarLinearAxis.specKey="axes",mixin(PolarLinearAxis,LinearAxisMixin);const registerPolarLinearAxis=()=>{registerLineAxis(),registerLineGrid(),registerCircleAxis(),registerCircleGrid(),registerAxis(),Factory$1.registerComponent(PolarLinearAxis.type,PolarLinearAxis)};class PolarBandAxis extends PolarAxis{constructor(){super(...arguments),this.type=ComponentTypeEnum.polarBandAxis,this._scale=new BandScale}computeDomain(e){return this.computeBandDomain(e)}updateScaleRange(){const e=super.updateScaleRange();return this.updateGroupScaleRange(),e}axisHelper(){const e=super.axisHelper();return Object.assign(Object.assign({},e),{getBandwidth:i=>e.getScale(i).bandwidth()})}initScales(){super.initScales(),this.calcScales(this._defaultBandInnerPadding,this._defaultBandOuterPadding)}registerTicksTransform(){const e=`${this.type}-ticks`;return registerDataSetInstanceTransform(this._option.dataSet,e,polarAngleAxisDiscreteTicks),e}transformScaleDomain(){}}PolarBandAxis.type=ComponentTypeEnum.polarBandAxis,PolarBandAxis.specKey="axes",mixin(PolarBandAxis,BandAxisMixin);const registerPolarBandAxis=()=>{registerLineAxis(),registerLineGrid(),registerCircleAxis(),registerCircleGrid(),registerAxis(),Factory$1.registerComponent(PolarBandAxis.type,PolarBandAxis)};class RoseSeries extends RoseLikeSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.rose,this.transformerConstructor=RoseSeriesSpecTransformer,this._roseMark=null,this._labelMark=null}initMark(){this.initRoseMark()}initMarkStyle(){this.initRoseMarkStyle()}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.getCenter=()=>({x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y}),this._markAttributeContext.startAngleScale=e=>this.startAngleScale(e),this._markAttributeContext.endAngleScale=e=>this.endAngleScale(e)}initRoseMark(){var e,i;this._roseMark=this._createMark(RoseSeries.mark.rose,{groupKey:this._seriesField,isSeriesMark:!0,stateSort:(e=this._spec.rose)===null||e===void 0?void 0:e.stateSort},{setCustomizedShape:(i=this._spec.rose)===null||i===void 0?void 0:i.customShape,morph:shouldMarkDoMorph(this._spec,RoseSeries.mark.rose.name),morphElementKey:this.getDimensionField()[0]})}getRoseAngle(){var e,i,n;return(n=(i=(e=this.angleAxisHelper).getBandwidth)===null||i===void 0?void 0:i.call(e,this._groups?this._groups.fields.length-1:0))!==null&&n!==void 0?n:.5}startAngleScale(e){return this.angleAxisHelper.dataToPosition(this.getDatumPositionValues(e,this.getGroupFields()))-.5*this.angleAxisHelper.getBandwidth(this.getGroupFields().length-1)}endAngleScale(e){return this.angleAxisHelper.dataToPosition(this.getDatumPositionValues(e,this.getGroupFields()))+this.getRoseAngle()-.5*this.angleAxisHelper.getBandwidth(this.getGroupFields().length-1)}initRoseMarkStyle(){const e=this._roseMark;e&&this.setMarkStyle(e,{x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y,startAngle:i=>this.startAngleScale(i),endAngle:i=>this.endAngleScale(i),fill:this.getColorAttribute(),outerRadius:i=>valueInScaleRange(this.radiusAxisHelper.dataToPosition([i[this._radiusField[0]]]),this.radiusAxisHelper.getScale(0)),innerRadius:i=>{var n;if(!this.getStack())return 0;const o=valueInScaleRange(this.radiusAxisHelper.dataToPosition([i[this._innerRadiusField[0]]]),this.radiusAxisHelper.getScale(0));return o<=Number.MIN_VALUE?this._computeLayoutRadius()*((n=this._spec.innerRadius)!==null&&n!==void 0?n:0):o}})}initTooltip(){super.initTooltip(),this._roseMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._roseMark)}initLabelMarkStyle(e){e&&this.setMarkStyle(e,{text:i=>i[this.getDimensionField()[0]],fill:this.getColorAttribute(),z:0})}initAnimation(){var e,i,n;const o=(i=(e=this._spec)===null||e===void 0?void 0:e.animationAppear)===null||i===void 0?void 0:i.preset;if(this._roseMark){const l={innerRadius:()=>{var d;return this._computeLayoutRadius()*((d=this._spec.innerRadius)!==null&&d!==void 0?d:0)}};this._roseMark.setAnimationConfig(animationConfig((n=Factory$1.getAnimationInKey("rose"))===null||n===void 0?void 0:n(l,o),userAnimationConfig("rose",this._spec,this._markAttributeContext)))}}getDefaultShapeType(){return"circle"}getActiveMarks(){return[this._roseMark]}}RoseSeries.type=SeriesTypeEnum.rose,RoseSeries.mark=roseSeriesMark,RoseSeries.transformerConstructor=RoseSeriesSpecTransformer;const registerRoseSeries=()=>{Factory$1.registerSeries(RoseSeries.type,RoseSeries),registerArcMark(),registerRoseAnimation(),registerPolarBandAxis(),registerPolarLinearAxis()};class PolarPointUpdate extends ACustomAnimate{constructor(e,i,n,o,l){super(e,i,n,o,l),this._center=i.center,this._prevCenter=e.center,this._center&&this._prevCenter||(this.valid=!1)}getEndProps(){return this.valid===!1?{}:polarToCartesian(this._center,this._toRadius,this._toAngle)}onBind(){const{angle:e,radius:i}=cartesianToPolar(this.from,this._prevCenter),{angle:n,radius:o}=cartesianToPolar(this.to,this._center);isValidNumber(n*o)||(this.valid=!1),this._fromAngle=isValidNumber(e)?e:n,this._fromRadius=isValidNumber(i)?i:o,this._toAngle=n,this._toRadius=o,isClose(this._fromAngle,this._toAngle)&&isClose(this._fromRadius,this._toRadius)&&(this.valid=!1)}onUpdate(e,i,n){if(this.valid===!1)return n.x=this.to.x,void(n.y=this.to.y);if(e){const{x:o,y:l}=this.getEndProps();n.x=o,n.y=l,n.center=this._center}else{const{x:o,y:l}=polarToCartesian({x:this._prevCenter.x+(this._center.x-this._prevCenter.x)*i,y:this._prevCenter.y+(this._center.y-this._prevCenter.y)*i},this._fromRadius+(this._toRadius-this._fromRadius)*i,this._fromAngle+(this._toAngle-this._fromAngle)*i);n.x=o,n.y=l}}}class PolarTagPointsUpdate extends TagPointsUpdate{constructor(e,i,n,o,l){super(e,i,n,o,l),this._center=i.center,this._prevCenter=e.center}onUpdate(e,i,n){this.points=this.points.map((o,l)=>{const d=this.polarPointInterpolation(this.interpolatePoints[l][0],this.interpolatePoints[l][1],i);return e&&(n.center=this._center),d.context=o.context,d}),n.points=this.points}_interpolationSinglePoint(e,i,n){if(!isValidPoint(e)&&!isValidPoint(i))return i;const o=cartesianToPolar(e,this._prevCenter),l=cartesianToPolar(i,this._center);let d=normalizeAngle(o.angle),u=normalizeAngle(l.angle);!isValidNumber(d)&&isValidNumber(u)&&(d=u),isValidNumber(d)&&!isValidNumber(u)&&(u=d);const f=d+(u-d)*n,g=o.radius+(l.radius-o.radius)*n;return polarToCartesian({x:this._prevCenter.x+(this._center.x-this._prevCenter.x)*n,y:this._prevCenter.y+(this._center.y-this._prevCenter.y)*n},g,f)}polarPointInterpolation(e,i,n){const{x:o,y:l}=this._interpolationSinglePoint(e,i,n),{x:d,y:u}=this._interpolationSinglePoint({x:e.x1,y:e.y1},{x:i.x1,y:i.y1},n),f=new Point(o,l,d,u);return f.defined=i.defined,f}}const radarFadeAnimation=r=>({type:r==="in"?"fadeIn":"fadeOut"}),radarGrowAnimation=(r,e)=>({type:e==="in"?"growPointsIn":"growPointsOut",options:()=>({center:r.center()})});function radarPresetAnimation(r,e,i){return e==="fadeIn"?radarFadeAnimation(i):radarGrowAnimation(r,i)}const radarSymbolMoveAnimation=(r,e)=>{const i=()=>{var d;return(d=r.center())===null||d===void 0?void 0:d.x},n=(d,u)=>u.getGraphicAttribute("x"),o=()=>{var d;return(d=r.center())===null||d===void 0?void 0:d.y},l=(d,u)=>u.getGraphicAttribute("y");return e==="in"?{channel:{x:{from:i,to:n},y:{from:o,to:l}}}:{channel:{x:{from:n,to:i},y:{from:l,to:o}}}};function radarSymbolPresetAnimation(r,e,i){return e==="fadeIn"?radarFadeAnimation(i):radarSymbolMoveAnimation(r,i)}const radarGroupClipAnimation=(r,e)=>({custom:ClipAngleAnimate,customParameters:(i,n)=>{var o;return{group:n.getGraphicItem(),startAngle:(o=r.startAngle)!==null&&o!==void 0?o:Math.PI/2,orient:"clockwise",center:r.center(),radius:r.radius(),animationType:e}}}),registerRadarAnimation=()=>{Factory$1.registerAnimation("radar",(r,e)=>({appear:e==="clipIn"?void 0:radarPresetAnimation(r,e,"in"),enter:radarPresetAnimation(r,e,"in"),exit:radarPresetAnimation(r,e,"out"),disappear:e==="clipIn"?void 0:radarPresetAnimation(r,e,"out"),update:[{options:{excludeChannels:["points","defined","center"]}},{channel:["points","center"],custom:PolarTagPointsUpdate,customParameters:r,duration:DEFAULT_ANIMATION_CONFIG.update.duration,easing:DEFAULT_ANIMATION_CONFIG.update.easing}]})),Factory$1.registerAnimation("radarSymbol",(r,e)=>({appear:e==="clipIn"?void 0:radarSymbolPresetAnimation(r,e,"in"),enter:{type:"scaleIn"},exit:{type:"scaleOut"},disappear:e==="clipIn"?void 0:radarSymbolPresetAnimation(r,e,"out"),update:[{options:{excludeChannels:["x","y","center"]}},{channel:["x","y","center"],custom:PolarPointUpdate,customParameters:r,duration:DEFAULT_ANIMATION_CONFIG.update.duration,easing:DEFAULT_ANIMATION_CONFIG.update.easing}]})),Factory$1.registerAnimation("radarGroup",(r,e)=>({appear:radarGroupClipAnimation(r,"in"),disappear:radarGroupClipAnimation(r,"out")})),registerArc()},radarSeriesMark=Object.assign(Object.assign(Object.assign({},baseSeriesMark),lineLikeSeriesMark),{area:{name:"area",type:"area"}});class RadarSeries extends RoseLikeSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.radar,this.transformerConstructor=LineLikeSeriesSpecTransformer,this._sortDataByAxis=!1}initGroups(){}compile(){super.compile(),this.addOverlapCompile()}initMark(){var e,i,n,o;const l={progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold},d=((e=this._spec.area)===null||e===void 0?void 0:e.visible)!==!1&&((n=(i=this._spec.area)===null||i===void 0?void 0:i.style)===null||n===void 0?void 0:n.visible)!==!1,u=(o=this._spec.seriesMark)!==null&&o!==void 0?o:"area";this.initAreaMark(l,d&&u==="area"),this.initLineMark(l,u==="line"||u==="area"&&!d),this.initSymbolMark(l,u==="point")}initMarkStyle(){this.initAreaMarkStyle(),this.initLineMarkStyle(),this.initSymbolMarkStyle(),[this._lineMark,this._symbolMark,this._areaMark].forEach(e=>{e&&this.setMarkStyle(e,{center:()=>{var i;return(i=this.angleAxisHelper)===null||i===void 0?void 0:i.center()}})})}initAreaMark(e,i){var n,o;this._areaMark=this._createMark(RadarSeries.mark.area,{groupKey:this._seriesField,isSeriesMark:i,stateSort:(n=this._spec.area)===null||n===void 0?void 0:n.stateSort},Object.assign(Object.assign({},e),{setCustomizedShape:(o=this._spec.area)===null||o===void 0?void 0:o.customShape}))}initAreaMarkStyle(){const e=this._areaMark;e&&(this.setMarkStyle(e,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),x1:i=>i&&this.angleAxisHelper&&this.radiusAxisHelper?this.valueToPosition(this.getDatumPositionValues(i,this._angleField),this.getStack()?this.getDatumPositionValues(i,this._innerRadiusField):this.radiusScale.domain()[0]).x:Number.NaN,y1:i=>!i||!this.angleAxisHelper||!this.radiusAxisHelper?Number.NaN:this.valueToPosition(this.getDatumPositionValues(i,this._angleField),this.getStack()?this.getDatumPositionValues(i,this._innerRadiusField):this.radiusScale.domain()[0]).y,fill:this.getColorAttribute(),curveType:DEFAULT_LINEAR_INTERPOLATE,closePath:!0},"normal",AttributeLevel.Series),this._invalidType!=="zero"&&this.setMarkStyle(e,{defined:this._getInvalidDefined.bind(this),connectedType:this._getInvalidConnectType()},"normal",AttributeLevel.Series),this.event.on(ChartEvent.viewDataStatisticsUpdate,{filter:i=>i.model===this},()=>{this.encodeDefined(e,"defined")}))}initTooltip(){super.initTooltip();const{group:e,mark:i}=this._tooltipHelper.activeTriggerSet;this._lineMark&&e.add(this._lineMark),this._areaMark&&e.add(this._areaMark),this._symbolMark&&(i.add(this._symbolMark),e.add(this._symbolMark))}initAnimation(){var e,i,n,o;const l={center:()=>{var u;return(u=this.angleAxisHelper)===null||u===void 0?void 0:u.center()},radius:()=>{const u=this.getLayoutRect();return Math.min(u.width,u.height)},startAngle:isValid(this._spec.startAngle)?degreeToRadian(this._spec.startAngle):POLAR_START_RADIAN},d=(n=(i=(e=this._spec)===null||e===void 0?void 0:e.animationAppear)===null||i===void 0?void 0:i.preset)!==null&&n!==void 0?n:"clipIn";d==="clipIn"&&this._rootMark&&this._rootMark.setAnimationConfig(animationConfig((o=Factory$1.getAnimationInKey("radarGroup"))===null||o===void 0?void 0:o(l,d),userAnimationConfig("group",this._spec,this._markAttributeContext))),[[this._areaMark,"radar"],[this._lineMark,"radar"],[this._symbolMark,"radarSymbol"]].forEach(([u,f])=>{if(isValid(u)){const g=Factory$1.getAnimationInKey(f);u.setAnimationConfig(animationConfig(g==null?void 0:g(l,d),userAnimationConfig(u.name,this._spec,this._markAttributeContext)))}})}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._areaMark,this._symbolMark,this._lineMark]}getSeriesStyle(e){return i=>{var n,o,l,d;let u=(o=(n=this._seriesMark)===null||n===void 0?void 0:n.getAttribute(i,e))!==null&&o!==void 0?o:void 0;return i!=="fill"||u||(i="stroke",u=(d=(l=this._seriesMark)===null||l===void 0?void 0:l.getAttribute(i,e))!==null&&d!==void 0?d:void 0),i==="stroke"&&isArray(u)?u[0]:u}}}RadarSeries.type=SeriesTypeEnum.radar,RadarSeries.mark=radarSeriesMark,RadarSeries.transformerConstructor=LineLikeSeriesSpecTransformer,mixin(RadarSeries,LineLikeSeriesMixin);const registerRadarSeries=()=>{Factory$1.registerSeries(RadarSeries.type,RadarSeries),registerAreaMark(),registerLineMark(),registerSymbolMark(),registerRadarAnimation(),registerPolarBandAxis(),registerPolarLinearAxis()};class DotSeriesTooltipHelper extends BaseSeriesTooltipHelper{constructor(){super(...arguments),this.shapeTypeCallback=()=>"square"}enableByType(e){return e==="mark"}getDefaultTitlePattern(e){return{key:"event info",value:"event info"}}getDefaultContentList(){return[{key:e=>e.type,value:e=>e.id},{key:"event_time",value:e=>TimeUtil.getInstance().timeFormat("%Y%m%d",e.event_time)},{key:"action_type",value:e=>e.action_type},{key:"children",value:e=>e.children}]}getTooltipData(e,i,n,o,l){var d,u,f,g;const _=super.getTooltipData(e,i,n,o,l),y=(f=(u=(d=this.spec)===null||d===void 0?void 0:d[e])===null||u===void 0?void 0:u.updateContent)!==null&&f!==void 0?f:(g=i==null?void 0:i[e])===null||g===void 0?void 0:g.updateContent;return _&&!y&&(_.updateContent=(b,S,v)=>{const A=[],x=b.filter(T=>T.key==="children");return x.length>0&&x[0].value.forEach(T=>{let C=!0;for(const E in T)A.push(Object.assign(Object.assign({},x[0]),{shapeType:"circle",hasShape:C,key:E,value:T[E]+""})),C=!1}),b.concat(A)}),_}}const objFlat=(r,e)=>{var i;const n=!((i=r[0])===null||i===void 0)&&i.latestData?r[0].latestData:r||[],o=[];return n.forEach(l=>{const d={};for(const f in l)f!==e&&(d[f]=l[f]);const u=l[e];u==null||u.forEach(f=>{o.push(Object.assign({},d,f))})}),o},DEFAULT_GRID_BACKGROUND={fill:"#bbb",fillOpacity:.2},dotSeriesMark=Object.assign(Object.assign({},baseSeriesMark),{group:{name:"group",type:"group"},grid:{name:"grid",type:"rule"},gridBackground:{name:"gridBackground",type:"rect"},dot:{name:"dot",type:"symbol"},title:{name:"title",type:"text"},subTitle:{name:"subTitle",type:"text"},symbol:{name:"symbol",type:"symbol"}});class DotSeries extends CartesianSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.dot}getSeriesGroupField(){return this._seriesField}setSeriesGroupField(e){isValid(e)&&(this._seriesGroupField=e)}getTitleField(){return this._titleField}setTitleField(e){isValid(e)&&(this._titleField=e)}getSubTitleField(){return this._subTitleField}setSubTitleField(e){isValid(e)&&(this._subTitleField=e)}getDotTypeField(){return this._dotTypeField}setDotTypeField(e){isValid(e)&&(this._dotTypeField=e)}getHighLightSeriesGroup(){return this._highLightSeriesGroup}setHighLightSeriesGroup(e){isValid(e)&&(this._highLightSeriesGroup=e)}setGridBackground(e){isValid(e)&&(this._gridBackground=e)}initData(){var e;super.initData(),this._xDimensionStatisticsDomain=this.getRawData().latestData.map(i=>i[this._fieldY[0]]),registerDataSetInstanceTransform(this._option.dataSet,"objFlat",objFlat),registerDataSetInstanceTransform(this._option.dataSet,"copyDataView",copyDataView),registerDataSetInstanceParser(this._option.dataSet,"dataview",dataViewParser),(e=this.getViewData())===null||e===void 0||e.transform({type:"objFlat",options:"dots",level:TransformLevel.dotObjFlat},!1)}getStatisticFields(){return[{key:this._fieldY[0],operations:["values"],customize:this._xDimensionStatisticsDomain}]}setAttrFromSpec(){var e;super.setAttrFromSpec(),this.setSeriesGroupField(this._spec.seriesGroupField),this.setTitleField(this._spec.titleField),this.setSubTitleField(this._spec.subTitleField),this.setDotTypeField(this._spec.dotTypeField),this.setHighLightSeriesGroup(this._spec.highLightSeriesGroup),this.setGridBackground(mergeSpec(DEFAULT_GRID_BACKGROUND,((e=this._spec.grid)===null||e===void 0?void 0:e.background)||{}))}initMark(){this._clipMark=this._createMark(DotSeries.mark.group),this._containerMark=this._createMark(DotSeries.mark.group,{parent:this._clipMark,dataView:this.getRawData()}),this._gridBackgroundMark=this._createMark(DotSeries.mark.gridBackground,{parent:this._containerMark,dataView:this.getRawData()}),this._gridMark=this._createMark(DotSeries.mark.grid,{parent:this._containerMark,dataView:this.getRawData()}),this._dotMark=this._createMark(DotSeries.mark.dot,{skipBeforeLayouted:!1,isSeriesMark:!0,parent:this._containerMark}),this._titleMark=this._createMark(DotSeries.mark.title,{parent:this._containerMark,dataView:this.getRawData()}),this._subTitleMark=this._createMark(DotSeries.mark.subTitle,{parent:this._containerMark,dataView:this.getRawData()}),this._symbolMark=this._createMark(DotSeries.mark.symbol,{parent:this._containerMark,dataView:this.getRawData()})}initMarkStyle(){const e=this._clipMark;e&&(this.setMarkStyle(e,{x:-this._spec.leftAppendPadding,y:0,width:1e4,height:this._spec.clipHeight},"normal",AttributeLevel.Series),e.setMarkConfig({interactive:!1,clip:!0}));const i=this._containerMark;i&&(this.setMarkStyle(i,{x:this._spec.leftAppendPadding},"normal",AttributeLevel.Series),i.setMarkConfig({interactive:!1}));const n=this._gridBackgroundMark;n&&this.setMarkStyle(n,{x:this.getRegionRectLeft.bind(this),x1:this.getRegionRectRight.bind(this),y:this.dataToGridBackgroundPositionY.bind(this),y1:this.dataToGridBackgroundPositionY1.bind(this),fill:this._gridBackground.fill,fillOpacity:this.dataToGridBackgroundOpacity.bind(this)},"normal",AttributeLevel.Series);const o=this._gridMark;o&&this.setMarkStyle(o,{stroke:this.getColorAttribute(),x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this),x1:this.getRegionRectRight.bind(this),y1:this.dataToPositionY.bind(this)},"normal",AttributeLevel.Series);const l=this._dotMark;l&&this.setMarkStyle(l,{x:this.dataToPositionX.bind(this),y:this.dataToPositionY.bind(this),fill:this.getDotColorAttribute(),fillOpacity:this.dataToOpacity.bind(this)},"normal",AttributeLevel.Series);const d=this._titleMark;d&&this.setMarkStyle(d,{fill:this.getColorAttribute(),text:g=>g[this.getTitleField()],x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this)},"normal",AttributeLevel.Series);const u=this._subTitleMark;u&&this.setMarkStyle(u,{fill:this.getColorAttribute(),text:g=>g[this.getSubTitleField()],x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this)},"normal",AttributeLevel.Series);const f=this._symbolMark;f&&this.setMarkStyle(f,{x:this.getRegionRectLeft.bind(this),y:this.dataToPositionY.bind(this),fill:this.getColorAttribute()},"normal",AttributeLevel.Series)}dataToGridBackgroundPositionY(e){if(!this._yAxisHelper)return Number.NaN;const{dataToPosition:i,getBandwidth:n}=this._yAxisHelper;return i(this.getDatumPositionValues(e,this._fieldY),{bandPosition:this._bandPosition})-n(0)/2}dataToGridBackgroundPositionY1(e){if(!this._yAxisHelper)return Number.NaN;const{dataToPosition:i,getBandwidth:n}=this._yAxisHelper;return i(this.getDatumPositionValues(e,this._fieldY),{bandPosition:this._bandPosition})+n(0)/2}dataToOpacity(e){var i,n,o,l;if(!this._xAxisHelper)return Number.NaN;const{dataToPosition:d,getScale:u}=this._xAxisHelper;return d(this.getDatumPositionValues(e,this._fieldX),{bandPosition:this._bandPosition})<u(0).range()[0]||d(this.getDatumPositionValues(e,this._fieldX),{bandPosition:this._bandPosition})>u(0).range()[1]?0:(l=(o=(n=(i=this._theme)===null||i===void 0?void 0:i.dot)===null||n===void 0?void 0:n.style)===null||o===void 0?void 0:o.fillOpacity)!==null&&l!==void 0?l:1}dataToGridBackgroundOpacity(e){return e[this._seriesGroupField]===this._highLightSeriesGroup?this._gridBackground.fillOpacity:0}onLayoutEnd(e){var i,n;super.onLayoutEnd(e);const o=(n=(i=this._spec)===null||i===void 0?void 0:i.leftAppendPadding)!==null&&n!==void 0?n:0;this.setMarkStyle(this._clipMark,{width:this.getLayoutRect().width+o},"normal",AttributeLevel.Series)}getDefaultColorDomain(){var e,i;return this._seriesGroupField?(e=this.getViewDataStatistics())===null||e===void 0?void 0:e.latestData[this._seriesGroupField].values:this._seriesField?(i=this.getViewDataStatistics())===null||i===void 0?void 0:i.latestData[this._seriesField].values:[]}getColorAttribute(){var e,i,n;return{scale:(e=this._option.globalScale.getScale("color"))!==null&&e!==void 0?e:this._getDefaultColorScale(),field:(n=(i=this._seriesGroupField)!==null&&i!==void 0?i:this._seriesField)!==null&&n!==void 0?n:DEFAULT_DATA_SERIES_FIELD}}getDotColorScale(){var e,i,n;const o=this._dotTypeField?(e=this.getViewDataStatistics())===null||e===void 0?void 0:e.latestData[this._dotTypeField].values:this._seriesGroupField?(i=this.getViewDataStatistics())===null||i===void 0?void 0:i.latestData[this._seriesGroupField].values:this._seriesField?(n=this.getViewDataStatistics())===null||n===void 0?void 0:n.latestData[this._seriesField].values:[],l=this._getDataScheme();return new ColorOrdinalScale().domain(o).range(l)}getDotColorAttribute(){var e,i,n,o;return{scale:(e=this._option.globalScale.getScale("color"))!==null&&e!==void 0?e:this.getDotColorScale(),field:(o=(n=(i=this._dotTypeField)!==null&&i!==void 0?i:this._seriesGroupField)!==null&&n!==void 0?n:this._seriesField)!==null&&o!==void 0?o:DEFAULT_DATA_SERIES_FIELD}}initTooltip(){this._tooltipHelper=new DotSeriesTooltipHelper(this),this._dotMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._dotMark)}onEvaluateEnd(e){super.onEvaluateEnd(e)}onMarkTreePositionUpdate(e){e.forEach(i=>{i.type==="group"?this.onMarkTreePositionUpdate(i.getMarks()):i.updateLayoutState()})}getDotData(){var e;return(e=this._dotMark)===null||e===void 0?void 0:e.getData()}_getDataIdKey(){}getStackValueField(){return null}getActiveMarks(){return[this._dotMark]}}DotSeries.type=SeriesTypeEnum.dot,DotSeries.mark=dotSeriesMark;const registerDotSeries=()=>{registerSymbolMark(),registerRuleMark(),registerRectMark(),registerTextMark(),Factory$1.registerSeries(DotSeries.type,DotSeries)};class LinkSeriesTooltipHelper extends BaseSeriesTooltipHelper{constructor(){super(...arguments),this.shapeTypeCallback=()=>"square"}enableByType(e){return e==="mark"}getDefaultTitlePattern(e){return{key:"link info",value:"link info"}}getDefaultContentList(){return[{key:"time",value:e=>TimeUtil.getInstance().timeFormat("%Y%m%d %H:%M",e.from.split("_")[1])},{key:"type",value:e=>e.action_type},{key:"from",value:e=>e.from},{key:"to",value:e=>e.to}]}}const linkSeriesMark=Object.assign(Object.assign({},baseSeriesMark),{group:{name:"group",type:"group"},link:{name:"link",type:"rule"},arrow:{name:"arrow",type:"symbol"}}),linkDotInfo=(r,e)=>{const{infoKey:i,fields:n,linkData:o,dotData:l}=e,{fromField:d,toField:u,xField:f,yField:g}=n(),_=o(),y=l(),b={};return y.forEach(S=>{const v={};for(const x in S)x!==i&&(v[x]=S[x]);const A=S[i];A==null||A.forEach(x=>{b[x.node_name]=Object.assign({},v,x)})}),_.forEach(S=>{var v,A,x,T;S[d+"_xField"]=(v=b==null?void 0:b[S[d]])===null||v===void 0?void 0:v[f],S[d+"_yField"]=(A=b==null?void 0:b[S[d]])===null||A===void 0?void 0:A[g],S[u+"_xField"]=(x=b==null?void 0:b[S[u]])===null||x===void 0?void 0:x[f],S[u+"_yField"]=(T=b==null?void 0:b[S[u]])===null||T===void 0?void 0:T[g]}),_};class LinkSeries extends CartesianSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.link}getFromField(){return this._fromField}setFromField(e){isValid(e)&&(this._fromField=e)}getToField(){return this._toField}setToField(e){isValid(e)&&(this._toField=e)}getDotTypeField(){return this._dotTypeField}setDotTypeField(e){isValid(e)&&(this._dotTypeField=e)}getDotSeriesSpec(){return this._dotSeriesSpec}setDotSeriesSpec(e){isValid(e)&&(this._dotSeriesSpec=e)}_getDotData(){const e=this._option.getChart().getSeriesInIndex([this._spec.dotSeriesIndex])[0];return e?e.getRawData().latestData:[]}initData(){var e;super.initData(),registerDataSetInstanceTransform(this._option.dataSet,"linkDotInfo",linkDotInfo),(e=this.getViewData())===null||e===void 0||e.transform({type:"linkDotInfo",options:{infoKey:"dots",fields:()=>({fromField:this._fromField,toField:this._toField,xField:this._dotSeriesSpec.xField,yField:this._dotSeriesSpec.yField}),linkData:()=>this._rawData.latestData,dotData:()=>this._getDotData()},level:TransformLevel.linkDotInfo},!1)}setAttrFromSpec(){super.setAttrFromSpec(),this.setFromField(this._spec.fromField),this.setToField(this._spec.toField),this.setDotTypeField(this._spec.dotTypeField),this.setDotSeriesSpec(this._spec.dotSeriesSpec)}initMark(){this._clipMark=this._createMark(LinkSeries.mark.group),this._containerMark=this._createMark(LinkSeries.mark.group,{parent:this._clipMark}),this._linkMark=this._createMark(LinkSeries.mark.link,{skipBeforeLayouted:!1,parent:this._containerMark}),this._arrowMark=this._createMark(LinkSeries.mark.arrow,{skipBeforeLayouted:!1,isSeriesMark:!0,parent:this._containerMark})}initMarkStyle(){var e,i,n,o;const l=this._clipMark;l&&(this.setMarkStyle(l,{x:-this._spec.leftAppendPadding,y:0,width:1e4,height:this._spec.clipHeight},"normal",AttributeLevel.Series),l.setMarkConfig({interactive:!1,clip:!0}));const d=this._containerMark;d&&(this.setMarkStyle(d,{x:this._spec.leftAppendPadding,width:this.getLayoutRect().width},"normal",AttributeLevel.Series),d.setMarkConfig({interactive:!1}));const u=this._linkMark;u&&this.setMarkStyle(u,{stroke:this.getColorAttribute(),strokeOpacity:this.dataToOpacity.bind(this),x:this.dataToPositionXFrom.bind(this),y:this.dataToPositionYFrom.bind(this),x1:this.dataToPositionXTo.bind(this),y1:this.dataToPositionYTo.bind(this)},"normal",AttributeLevel.Series);const f=this._arrowMark;if(f){const g=(o=(n=(i=(e=this._theme)===null||e===void 0?void 0:e.arrow)===null||i===void 0?void 0:i.style)===null||n===void 0?void 0:n.size)!==null&&o!==void 0?o:10;this.setMarkStyle(f,{x:this.dataToPositionXTo.bind(this),y:_=>this.dataToPositionArrowYTo(_,g),fill:this.getColorAttribute(),fillOpacity:this.dataToOpacity.bind(this),size:g,symbolType:_=>this.isPositionYFromHigher(_)?"triangleDown":"triangleUp"},"normal",AttributeLevel.Series)}}afterInitMark(){super.afterInitMark()}dataToPositionXFrom(e){if(!this._xAxisHelper)return Number.NaN;const{dataToPosition:i}=this._xAxisHelper;return i(this.getDatumPositionValues(e,this._fromField+"_xField"),{bandPosition:this._bandPosition})}dataToPositionYFrom(e){if(!this._yAxisHelper)return Number.NaN;const{dataToPosition:i}=this._yAxisHelper;return i(this.getDatumPositionValues(e,this._fromField+"_yField"))}dataToPositionXTo(e){if(!this._xAxisHelper)return Number.NaN;const{dataToPosition:i}=this._xAxisHelper;return i(this.getDatumPositionValues(e,this._toField+"_xField"),{bandPosition:this._bandPosition})}dataToPositionYTo(e){if(!this._yAxisHelper)return Number.NaN;const{dataToPosition:i}=this._yAxisHelper;return i(this.getDatumPositionValues(e,this._toField+"_yField"),{bandPosition:this._bandPosition})}dataToPositionArrowYTo(e,i){if(!this._yAxisHelper)return Number.NaN;const{dataToPosition:n}=this._yAxisHelper,o=this.isPositionYFromHigher(e)?-i/2:i/2;return n(this.getDatumPositionValues(e,this._toField+"_yField"),{bandPosition:this._bandPosition})+o}dataToOpacity(e){return this.isPositionXOuterRange(e,this._fromField+"_xField")||this.isPositionXOuterRange(e,this._toField+"_xField")||e[this._fromField]===e[this._toField]?0:1}isPositionYFromHigher(e){return this.dataToPositionYFrom(e)<this.dataToPositionYTo(e)}isPositionXOuterRange(e,i){if(!this._xAxisHelper)return!1;const{dataToPosition:n,getScale:o}=this._xAxisHelper;return n(this.getDatumPositionValues(e,i),{bandPosition:this._bandPosition})<o(0).range()[0]||n(this.getDatumPositionValues(e,i),{bandPosition:this._bandPosition})>o(0).range()[1]}getDefaultColorDomain(){var e,i;return this._dotTypeField?(e=this.getViewDataStatistics())===null||e===void 0?void 0:e.latestData[this._dotTypeField].values:this._seriesField?(i=this.getViewDataStatistics())===null||i===void 0?void 0:i.latestData[this._seriesField].values:[]}getColorAttribute(){var e,i,n;return{scale:(e=this._option.globalScale.getScale("color"))!==null&&e!==void 0?e:this._getDefaultColorScale(),field:(n=(i=this._dotTypeField)!==null&&i!==void 0?i:this._seriesField)!==null&&n!==void 0?n:DEFAULT_DATA_SERIES_FIELD}}initInteraction(){const e=[];this._linkMark&&e.push(this._linkMark),this._arrowMark&&e.push(this._arrowMark),this._parseInteractionConfig(e)}initTooltip(){this._tooltipHelper=new LinkSeriesTooltipHelper(this),this._linkMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._linkMark),this._arrowMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._arrowMark)}onMarkTreePositionUpdate(e){e.forEach(i=>{i.type==="group"?this.onMarkTreePositionUpdate(i.getMarks()):i.updateLayoutState()})}getDotInfoData(){var e,i;return(i=(e=this._linkMark)!==null&&e!==void 0?e:this._arrowMark)===null||i===void 0?void 0:i.getData()}getActiveMarks(){return[this._linkMark,this._arrowMark]}}LinkSeries.type=SeriesTypeEnum.link,LinkSeries.mark=linkSeriesMark;const registerLinkSeries=()=>{registerRuleMark(),registerSymbolMark(),registerCartesianBandAxis(),registerCartesianLinearAxis(),Factory$1.registerSeries(LinkSeries.type,LinkSeries)},progressLikeSeriesMark=Object.assign(Object.assign({},baseSeriesMark),{group:{name:"group",type:"group"}});class ProgressLikeSeries extends PolarSeries{constructor(){super(...arguments),this._arcGroupMark=null,this._getAngleValueStart=e=>{const i=this._getAngleAxis(),{tickMask:n}=this._spec;if(n!=null&&n.forceAlign&&this._isTickMaskVisible(i)){const o=e[this.getStack()?STACK_FIELD_START:SEGMENT_FIELD_START],l=this._getAngleAxisSubTickData(i),d=l[1].value-l[0].value,u=degreeToRadian(n.offsetAngle);let f;if(isValid(o)){const g=binaryFuzzySearch(l,y=>y.value-o),_=g>=l.length||o>l[g].value-d/2?Math.min(g,l.length-1):g>0?g-1:void 0;_!==void 0&&(f=this.angleAxisHelper.dataToPosition([l[_].value-d/2]))}return isNil(f)&&(f=this.angleAxisHelper.dataToPosition([l[0].value-d/2])),f+u}return this._getAngleValueStartWithoutMask(e)},this._getAngleValueEnd=e=>{const i=this._getAngleAxis(),{tickMask:n}=this._spec;if(n!=null&&n.forceAlign&&this._isTickMaskVisible(i)){const o=e[this.getStack()?STACK_FIELD_END:this._angleField[0]],l=this._getAngleAxisSubTickData(i),d=l[1].value-l[0].value,u=degreeToRadian(n.offsetAngle),f=binaryFuzzySearch(l,y=>y.value-o),g=f>=l.length||o>l[f].value-d/2?Math.min(f,l.length-1):f>0?f-1:void 0;let _;return _=g!==void 0?this.angleAxisHelper.dataToPosition([l[g].value+d/2]):this.angleAxisHelper.dataToPosition([l[0].value-d/2]),_+u}return this._getAngleValueEndWithoutMask(e)}}setAttrFromSpec(){var e,i,n;super.setAttrFromSpec();const o=(e=this._option.globalInstance.getChart())===null||e===void 0?void 0:e.getSpec(),l=(i=this._spec.startAngle)!==null&&i!==void 0?i:o==null?void 0:o.startAngle;this._startAngle=isValid(l)?degreeToRadian(l):POLAR_START_RADIAN;const d=(n=this._spec.endAngle)!==null&&n!==void 0?n:o==null?void 0:o.endAngle;this._endAngle=isValid(d)?degreeToRadian(d):POLAR_END_RADIAN,this.setAngleField(this._spec.valueField||this._spec.angleField),this.setRadiusField(this._spec.categoryField||this._spec.radiusField),this._specAngleField=this._angleField.slice(),this._specRadiusField=this._radiusField.slice()}getStackGroupFields(){return this._radiusField}getStackValueField(){var e;return(e=this._angleField)===null||e===void 0?void 0:e[0]}getGroupFields(){return this._angleField}_convertMarkStyle(e){const i=super._convertMarkStyle(e);if(i.fill){const n=e.fill;(n==null?void 0:n.gradient)!=="conical"||isValid(n==null?void 0:n.startAngle)||isValid(n==null?void 0:n.endAngle)||(i.fill=Object.assign(Object.assign({},n),{startAngle:this._startAngle,endAngle:this._endAngle}))}return i}_getAngleValueStartWithoutMask(e){if(this.getStack()){const i=valueInScaleRange(this.angleAxisHelper.dataToPosition([e[STACK_FIELD_START]]),this.angleAxisHelper.getScale(0));if(isValidNumber(i))return i}return this._startAngle}_getAngleValueEndWithoutMask(e){if(this.getStack()){const i=valueInScaleRange(this.angleAxisHelper.dataToPosition([e[STACK_FIELD_END]]),this.angleAxisHelper.getScale(0));if(isValidNumber(i))return i}return this.angleAxisHelper.dataToPosition([e[this._angleField[0]]])}getDimensionField(){return this._specRadiusField}getMeasureField(){return this._specAngleField}initMark(){this._initArcGroupMark()}initMarkStyle(){this._initArcGroupMarkStyle()}_initArcGroupMark(){return this._arcGroupMark=this._createMark(ProgressLikeSeries.mark.group,{skipBeforeLayouted:!1}),this._arcGroupMark}_initArcGroupMarkStyle(){const e=this._arcGroupMark;e.created(),this.setMarkStyle(e,{x:0,y:0},"normal",AttributeLevel.Series),this._arcGroupMark.setMarkConfig({interactive:!1,zIndex:this.layoutZIndex,clip:!0,clipPath:()=>{const i=this._getAngleAxis();if(this._isTickMaskVisible(i)){const{tickMask:l}=this._spec,{angle:d,offsetAngle:u,style:f={}}=l,g=this._getAngleAxisSubTickData(i),{x:_,y}=this.angleAxisHelper.center(),b=this._computeLayoutRadius(),S=f;return g.map(({value:v})=>{const A=this.angleAxisHelper.dataToPosition([v])+degreeToRadian(u),x=degreeToRadian(d)/2;return createArc(Object.assign(Object.assign({},S),{x:_,y,startAngle:A-x,endAngle:A+x,innerRadius:b*this._innerRadius,outerRadius:b*this._outerRadius,fill:!0}))})}const{width:n,height:o}=this.getLayoutRect();return[createRect({width:n,height:o,fill:!0})]}})}_getAngleAxis(){if(!this.angleAxisHelper)return;const e=this.angleAxisHelper.getAxisId();return this._option.getChart().getAllComponents().find(i=>i.id===e)}_getAngleAxisTickData(e){var i;return(i=e==null?void 0:e.getTickData())===null||i===void 0?void 0:i.getLatestData()}_isTickMaskVisible(e){const i=this._getAngleAxisTickData(e),{tickMask:n}=this._spec;return n&&n.visible!==!1&&(i==null?void 0:i.length)>1}_getAngleAxisSubTickData(e){var i;const n=this._getAngleAxisTickData(e),o=[],{subTick:l={},tick:d={}}=(i=e==null?void 0:e.getSpec())!==null&&i!==void 0?i:{},{tickCount:u=4}=l,{alignWithLabel:f}=d;if((n==null?void 0:n.length)>=2){const g=n[1].value-n[0].value;for(let _=0;_<n.length-1;_++){const y=n[_],b=n[_+1];o.push(y);for(let S=0;S<u;S++){const v=(S+1)/(u+1),A=(1-v)*y.value+v*(b?b.value:f?1:y.value+g);o.push({value:A})}}return o.push(n[n.length-1]),o}return n}}ProgressLikeSeries.mark=progressLikeSeriesMark;const circularProgressSeriesMark=Object.assign(Object.assign({},progressLikeSeriesMark),{track:{name:"track",type:"arc"},progress:{name:"progress",type:"arc"}}),Appear_Grow$2=r=>({type:"growAngleIn",options:{overall:r.startAngle}}),Appear_FadeIn$2={type:"fadeIn"};function progressLikePresetAnimation(r,e){return e==="fadeIn"?Appear_FadeIn$2:Appear_Grow$2(r)}const registerProgressLikeAnimation=()=>{Factory$1.registerAnimation("circularProgress",(r,e)=>({appear:progressLikePresetAnimation(r,e),enter:{type:"growAngleIn"},disappear:{type:"growAngleOut"}}))};class CircularProgressSeriesSpecTransformer extends BaseSeriesSpecTransformer{constructor(){super(...arguments),this._supportStack=!0}}class CircularProgressSeries extends ProgressLikeSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.circularProgress,this.transformerConstructor=CircularProgressSeriesSpecTransformer,this._progressMark=null,this._trackMark=null,this._getRadiusValueStart=e=>{if(this.getGroupFields().length>1){const i=this.radiusAxisHelper.dataToPosition(this.getDatumPositionValues(e,this.getGroupFields()));if(isValidNumber(i))return i}return this.radiusAxisHelper.dataToPosition([e[this._radiusField[0]]])},this._getRadiusValueEnd=e=>{var i,n;if(this.getGroupFields().length>1){const o=this.radiusAxisHelper.dataToPosition(this.getDatumPositionValues(e,this.getGroupFields()))+((n=(i=this.radiusAxisHelper).getBandwidth)===null||n===void 0?void 0:n.call(i,this._groups?this._groups.fields.length-1:0));if(isValidNumber(o))return o}return this.radiusAxisHelper.dataToPosition([e[this._radiusField[0]]])+this.radiusAxisHelper.getScale(0).step()}}getStackGroupFields(){return this.getGroupFields()}getGroupFields(){return this._radiusField}initMark(){super.initMark(),this._initTrackMark(),this._initProgressMark()}initMarkStyle(){super.initMarkStyle(),this._initTrackMarkStyle(),this._initProgressMarkStyle()}_initProgressMark(){var e,i;return this._progressMark=this._createMark(CircularProgressSeries.mark.progress,{parent:this._arcGroupMark,isSeriesMark:!0,stateSort:(e=this._spec.progress)===null||e===void 0?void 0:e.stateSort},{setCustomizedShape:(i=this._spec.progress)===null||i===void 0?void 0:i.customShape}),this._progressMark}_initProgressMarkStyle(){var e;const i=this._progressMark;i&&this.setMarkStyle(i,{x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y,startAngle:this._getAngleValueStart,endAngle:this._getAngleValueEnd,innerRadius:this._getRadiusValueStart,outerRadius:this._getRadiusValueEnd,cap:(e=this._spec.roundCap)!==null&&e!==void 0&&e,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:200,forceShowCap:!0},"normal",AttributeLevel.Series)}initInteraction(){const e=[];this._trackMark&&e.push(this._trackMark),this._progressMark&&e.push(this._progressMark),this._parseInteractionConfig(e)}initTooltip(){super.initTooltip(),this._progressMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._progressMark)}_initTrackMark(){var e,i;return this._trackMark=this._createMark(CircularProgressSeries.mark.track,{parent:this._arcGroupMark,stateSort:(e=this._spec.track)===null||e===void 0?void 0:e.stateSort},{setCustomizedShape:(i=this._spec.track)===null||i===void 0?void 0:i.customShape}),this._trackMark}_initTrackMarkStyle(){const e=this._trackMark;e&&this.setMarkStyle(e,{visible:i=>{const n=this.angleAxisHelper.getScale(0).range(),o=Math.min(n[0],n[n.length-1]),l=this._getAngleValueStartWithoutMask(i);return Math.abs(l-o)<=1e-14},x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y,startAngle:()=>{const i=this.getStack()?STACK_FIELD_START:this._angleField[0],n=this.angleAxisHelper.getScale(0).domain();return this._getAngleValueStart({[i]:n[0]})},endAngle:()=>{const i=this.getStack()?STACK_FIELD_END:this._angleField[0],n=this.angleAxisHelper.getScale(0).domain();return this._getAngleValueEnd({[i]:n[n.length-1]})},innerRadius:this._getRadiusValueStart,outerRadius:this._getRadiusValueEnd,cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:100},"normal",AttributeLevel.Series)}initAnimation(){var e,i,n,o;const l=(i=(e=this._spec)===null||e===void 0?void 0:e.animationAppear)===null||i===void 0?void 0:i.preset;this._progressMark.setAnimationConfig(animationConfig((n=Factory$1.getAnimationInKey("circularProgress"))===null||n===void 0?void 0:n({startAngle:this._startAngle},l),userAnimationConfig("progress",this._spec,this._markAttributeContext))),this._trackMark.setAnimationConfig(animationConfig((o=Factory$1.getAnimationInKey("fadeInOut"))===null||o===void 0?void 0:o(),userAnimationConfig("track",this._spec,this._markAttributeContext)))}getActiveMarks(){return[this._progressMark]}}CircularProgressSeries.type=SeriesTypeEnum.circularProgress,CircularProgressSeries.mark=circularProgressSeriesMark,CircularProgressSeries.transformerConstructor=CircularProgressSeriesSpecTransformer;const registerCircularProgressSeries=()=>{Factory$1.registerSeries(CircularProgressSeries.type,CircularProgressSeries),registerArcMark(),registerProgressLikeAnimation(),registerFadeInOutAnimation(),registerPolarBandAxis(),registerPolarLinearAxis()};function LinearProgressGrowOption(r){return()=>r.direction==="vertical"?{orient:"negative"}:{orient:"positive"}}const Appear_Grow$1=r=>({type:r.direction==="horizontal"?"growWidthIn":"growHeightIn",options:LinearProgressGrowOption(r)}),linearProgressDisappear=r=>({type:r.direction==="horizontal"?"growWidthOut":"growHeightOut",options:LinearProgressGrowOption(r)}),Appear_FadeIn$1={type:"fadeIn"};function linearProgressPresetAnimation(r,e){return e===!1?{}:e==="fadeIn"?Appear_FadeIn$1:Appear_Grow$1(r)}const registerLinearProgressAnimation=()=>{Factory$1.registerAnimation("linearProgress",(r,e)=>({appear:linearProgressPresetAnimation(r,e),enter:{type:"grow"},disappear:linearProgressDisappear(r)}))};class LinearProgressSeriesTooltipHelper extends BaseSeriesTooltipHelper{enableByType(e){return e!=="dimension"}}const linearProgressSeriesMark=Object.assign(Object.assign({},baseSeriesMark),{track:{name:"track",type:"rect"},progress:{name:"progress",type:"rect"},group:{name:"group",type:"group"}});class LinearProgressSeries extends CartesianSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.linearProgress,this._progressMark=null,this._trackMark=null,this._defaultProgressCustomShape=(e,i,n)=>{var o,l;const d=(o=this._spec)===null||o===void 0?void 0:o.cornerRadius,u=isValid(i.width)?i.width:i.x1-i.x,f=isValid(i.height)?i.height:i.y1-i.y,g=Math.min(0,u),_=Math.max(0,u),y=Math.min(0,f),b=Math.max(0,f);if(d>0){let S=d;if(((l=this._spec)===null||l===void 0?void 0:l.direction)==="vertical"){if(S=Math.min(Math.abs(u/2),d),2*S>Math.abs(f)){const v=Math.acos((S-Math.abs(f)/2)/S);return n.moveTo(g+S,y),n.arc(g+S,y+S,S,1.5*Math.PI,1.5*Math.PI-v,!0),n.arc(g+S,b-S,S,v+Math.PI/2,Math.PI/2,!0),n.lineTo(_-d,b),n.arc(_-S,b-S,S,Math.PI/2,Math.PI/2-v,!0),n.arc(_-S,y+S,S,-Math.PI/2+v,-Math.PI/2,!0),n.lineTo(g+S,y),n.closePath(),n}}else if(S=Math.min(Math.abs(f/2),d),2*S>Math.abs(u)){const v=Math.acos((S-Math.abs(u)/2)/S);return n.moveTo(g,y+S),n.arc(g+S,y+S,S,Math.PI,Math.PI+v),n.arc(_-S,y+S,S,-v,0),n.lineTo(_,b-S),n.arc(_-S,b-S,S,0,v),n.arc(g+S,b-S,S,Math.PI-v,Math.PI),n.closePath(),n}n.moveTo(g,y+S),n.arc(g+S,y+S,S,Math.PI,1.5*Math.PI),n.lineTo(_-S,y),n.arc(_-S,y+S,S,-Math.PI/2,0),n.lineTo(_,b-S),n.arc(_-S,b-S,S,0,Math.PI/2),n.lineTo(g+S,b),n.arc(g+S,b-S,S,Math.PI/2,Math.PI),n.closePath()}else n.moveTo(g,y),n.lineTo(_,y),n.lineTo(_,b),n.lineTo(g,b),n.closePath();return n}}initMark(){this._initTrackMark(),this._initProgressMark()}initMarkStyle(){this._initTrackMarkStyle(),this._initProgressMarkStyle()}_initProgressMark(){var e,i,n;return this._progressMark=this._createMark(LinearProgressSeries.mark.progress,{isSeriesMark:!0,stateSort:(e=this._spec.progress)===null||e===void 0?void 0:e.stateSort},{setCustomizedShape:(n=(i=this._spec.progress)===null||i===void 0?void 0:i.customShape)!==null&&n!==void 0?n:this._defaultProgressCustomShape}),this._progressMark}_initProgressMarkStyle(){var e,i,n,o;const l=this._progressMark;if(l)if(this._spec.direction==="vertical"){const d=this._spec.progress||{},u=(e=d.leftPadding)!==null&&e!==void 0?e:0,f=(i=d.rightPadding)!==null&&i!==void 0?i:0;this.setMarkStyle(l,{x:g=>{var _,y;return valueInScaleRange(this.dataToPositionX(g),(y=(_=this._xAxisHelper)===null||_===void 0?void 0:_.getScale)===null||y===void 0?void 0:y.call(_,0),!0)-this._spec.bandWidth/2+u},y1:g=>{var _,y;return valueInScaleRange(this.dataToPositionY(g),(y=(_=this._yAxisHelper)===null||_===void 0?void 0:_.getScale)===null||y===void 0?void 0:y.call(_,0))},y:()=>{var g;return(g=this._yAxisHelper)===null||g===void 0?void 0:g.dataToPosition([0],{bandPosition:this._bandPosition})},width:this._spec.bandWidth-u-f,cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute()},"normal",AttributeLevel.Series)}else{const d=this._spec.progress||{},u=(n=d.topPadding)!==null&&n!==void 0?n:0,f=(o=d.bottomPadding)!==null&&o!==void 0?o:0;this.setMarkStyle(l,{x1:g=>{var _,y;return valueInScaleRange(this.dataToPositionX(g),(y=(_=this._xAxisHelper)===null||_===void 0?void 0:_.getScale)===null||y===void 0?void 0:y.call(_,0))},y:g=>{var _,y;return valueInScaleRange(this.dataToPositionY(g),(y=(_=this._yAxisHelper)===null||_===void 0?void 0:_.getScale)===null||y===void 0?void 0:y.call(_,0),!0)-this._spec.bandWidth/2+u},height:this._spec.bandWidth-u-f,x:()=>{var g;return(g=this._xAxisHelper)===null||g===void 0?void 0:g.dataToPosition([0],{bandPosition:this._bandPosition})},cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute()},"normal",AttributeLevel.Series)}}_initTrackMark(){var e,i;return this._trackMark=this._createMark(LinearProgressSeries.mark.track,{stateSort:(e=this._spec.track)===null||e===void 0?void 0:e.stateSort},{setCustomizedShape:(i=this._spec.track)===null||i===void 0?void 0:i.customShape}),this._trackMark}_initTrackMarkStyle(){const e=this._trackMark;e&&(this._spec.direction==="vertical"?this.setMarkStyle(e,{x:i=>{var n,o;return valueInScaleRange(this.dataToPositionX(i),(o=(n=this._xAxisHelper)===null||n===void 0?void 0:n.getScale)===null||o===void 0?void 0:o.call(n,0),!0)-this._spec.bandWidth/2},y:0,width:this._spec.bandWidth,height:()=>this._scaleY.range()[0],cornerRadius:this._spec.cornerRadius},"normal",AttributeLevel.Series):this.setMarkStyle(e,{x:0,y:i=>{var n,o;return valueInScaleRange(this.dataToPositionY(i),(o=(n=this._yAxisHelper)===null||n===void 0?void 0:n.getScale)===null||o===void 0?void 0:o.call(n,0),!0)-this._spec.bandWidth/2},height:this._spec.bandWidth,width:()=>this._scaleX.range()[1],cornerRadius:this._spec.cornerRadius},"normal",AttributeLevel.Series))}initInteraction(){const e=[];this._trackMark&&e.push(this._trackMark),this._progressMark&&e.push(this._progressMark),this._parseInteractionConfig(e)}initAnimation(){var e,i,n,o;const l={direction:this.direction},d=(i=(e=this._spec)===null||e===void 0?void 0:e.animationAppear)===null||i===void 0?void 0:i.preset;this._progressMark.setAnimationConfig(animationConfig((n=Factory$1.getAnimationInKey("linearProgress"))===null||n===void 0?void 0:n(l,d),userAnimationConfig("progress",this._spec,this._markAttributeContext))),this._trackMark.setAnimationConfig(animationConfig((o=Factory$1.getAnimationInKey("fadeInOut"))===null||o===void 0?void 0:o(),userAnimationConfig("track",this._spec,this._markAttributeContext)))}initTooltip(){this._tooltipHelper=new LinearProgressSeriesTooltipHelper(this),this._progressMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._progressMark),this._trackMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._trackMark)}getActiveMarks(){return[this._progressMark]}}LinearProgressSeries.type=SeriesTypeEnum.linearProgress,LinearProgressSeries.mark=linearProgressSeriesMark;const registerLinearProgressSeries=()=>{registerRectMark(),registerLinearProgressAnimation(),registerFadeInOutAnimation(),Factory$1.registerSeries(LinearProgressSeries.type,LinearProgressSeries)},DEFAULT_ROTATE_ANGLES=[0],DEFAULT_DRAW_OUT_OF_BOUND="hidden",DEFAULT_MIN_FONT_SIZE=20,DEFAULT_FONTSIZE_RANGE=[20,40],DEFAULT_FONT_WEIGHT_RANGE=[200,500],DEFAULT_MASK_SHAPE="circle",DEFAULT_ZOOM_TO_FIT={shrink:!1,enlarge:!1,fontSizeLimitMin:0},DEFAULT_RANDOM=!0,DEFAULT_FONT_PADDING=1,SHAPE_TYPE=["triangleForward","triangle","diamond","square","star","cardioid","circle","pentagon","rect"],WORD_CLOUD_TEXT=`${PREFIX}_WORD_CLOUD_TEXT`,wordCloudSeriesMark=Object.assign(Object.assign({},baseSeriesMark),{word:{name:"word",type:"text"},fillingWord:{name:"fillingWord",type:"text"},wordMask:{name:"wordMask",type:"rect"}});class BaseWordCloudSeries extends BaseSeries{constructor(){super(...arguments),this._fontSizeRange=[DEFAULT_MIN_FONT_SIZE,DEFAULT_MIN_FONT_SIZE],this._isWordCloudShape=!1,this._dataChange=!0,this.handleMaskCanvasUpdate=(e,i)=>{this._maskCanvas=e},this.getWordColor=e=>e.isFillingWord?(this._fillingColorCallback&&!this._dataChange||(this._fillingColorCallback=this._wordCloudShapeConfig.fillingColorHexField?i=>i[this._wordCloudShapeConfig.fillingColorHexField]:this.initColorCallback(this._wordCloudShapeConfig.fillingSeriesField,!0)),this._fillingColorCallback(e)):(this._keyWordColorCallback&&!this._dataChange||(this._keyWordColorCallback=this._spec.colorHexField?i=>i[this._spec.colorHexField]:this.initColorCallback(this._seriesField,!1)),this._keyWordColorCallback(e)),this._calculateFontWeight=e=>{const i=this.getRawDataStatisticsByField(this._valueField,!0);return i.min===i.max?this._fontWeightRange[0]:this._fontWeightRange[0]+(this._fontWeightRange[this._fontWeightRange.length-1]-this._fontWeightRange[0])*(e[this._valueField]-i.min)/(i.max-i.min)}}setValueField(e){isValid(e)&&(this._valueField=e)}setFontSizeRange(e){isValid(e)?this._fontSizeRange=e:this._fontSizeRange=DEFAULT_FONTSIZE_RANGE}setAttrFromSpec(){var e,i,n,o,l;super.setAttrFromSpec(),this._padding=this._option.getChart().padding,this._nameField=this._spec.nameField,this._colorMode=(e=this._spec.colorMode)!==null&&e!==void 0?e:"ordinal",this._colorList=this._spec.colorList,this.setValueField(this._spec.valueField),this._fontWeightRange=(i=this._spec.fontWeightRange)!==null&&i!==void 0?i:DEFAULT_FONT_WEIGHT_RANGE,this._rotateAngles=(n=this._spec.rotateAngles)!==null&&n!==void 0?n:DEFAULT_ROTATE_ANGLES,this.setFontSizeRange(this._spec.fontSizeRange),this._maskShape=(o=this._spec.maskShape)!==null&&o!==void 0?o:DEFAULT_MASK_SHAPE,this._textField=!((l=this._spec.word)===null||l===void 0)&&l.formatMethod?WORD_CLOUD_TEXT:this._nameField;const d=this._spec.wordCloudConfig;this._wordCloudConfig=Object.assign({drawOutOfBound:DEFAULT_DRAW_OUT_OF_BOUND,layoutMode:"default",zoomToFit:DEFAULT_ZOOM_TO_FIT},this._spec.wordCloudConfig),d&&!isNil(d.layoutMode)||isTrueBrowser(this._option.mode)||(this._wordCloudConfig.layoutMode="fast"),this._wordCloudShapeConfig=Object.assign({fillingSeriesField:this.getSeriesField(),fillingRotateAngles:DEFAULT_ROTATE_ANGLES,layoutMode:"default"},this._spec.wordCloudShapeConfig),this._isWordCloudShape=!SHAPE_TYPE.includes(this._maskShape)&&!["fast","grid","cloud"].includes(this._wordCloudConfig.layoutMode),this._defaultFontFamily=this._option.getTheme().fontFamily}initData(){var e,i;super.initData(),(i=(e=this.getViewData())===null||e===void 0?void 0:e.target)===null||i===void 0||i.addListener("change",()=>{this._dataChange=!0,this.compile()})}initMark(){var e;!((e=this._spec.wordMask)===null||e===void 0)&&e.visible&&(this._maskMark=this._createMark(BaseWordCloudSeries.mark.wordMask,{dataView:!1})),this._wordMark=this._createMark(BaseWordCloudSeries.mark.word,{key:DEFAULT_DATA_KEY,groupKey:this._seriesField,isSeriesMark:!0},{morphElementKey:this._seriesField})}initMarkStyle(){this.initMarkStyleOfWord(this._wordMark,this._spec.word,this._spec.colorHexField,this._seriesField),this._maskMark&&this.setMarkStyle(this._maskMark,{width:()=>this._region.getLayoutRect().width,height:()=>this._region.getLayoutRect().height,background:()=>this._maskCanvas},"normal",AttributeLevel.Series)}initMarkStyleOfWord(e,i,n,o,l){var d,u;e&&(this.setMarkStyle(e,{text:i!=null&&i.formatMethod?f=>i.formatMethod(f):f=>f[this._textField],x:f=>f.x,y:f=>f.y,fontSize:f=>f.fontSize,fontStyle:f=>f.fontStyle,angle:f=>f.angle,visible:f=>f.visible},"normal",AttributeLevel.Series),this.setMarkStyle(e,{fill:(u=(d=i==null?void 0:i.style)===null||d===void 0?void 0:d.fill)!==null&&u!==void 0?u:this.getWordColor,fontWeight:f=>f.fontWeight,fontFamily:f=>f.fontFamily},"normal",AttributeLevel.User_Mark))}initTooltip(){super.initTooltip(),this._wordMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._wordMark)}initAnimation(){[this._wordMark].forEach(e=>{var i,n;if(e){const o=(n=(i=this._spec)===null||i===void 0?void 0:i.animationAppear)===null||n===void 0?void 0:n.preset,l={animationConfig:()=>{var d,u;return(u=(d=e.getAnimationConfig())===null||d===void 0?void 0:d.appear)===null||u===void 0?void 0:u[0]}};e.setAnimationConfig(animationConfig(Factory$1.getAnimationInKey("wordCloud")(l,o),userAnimationConfig("word",this._spec,this._markAttributeContext)))}})}getWordOrdinalColorScale(e,i){var n,o,l,d,u;const f=i?this._wordCloudShapeConfig.fillingColorList:this._colorList,g=e?(n=this.getViewData())===null||n===void 0?void 0:n.latestData.map(y=>y[e]):[],_=(l=f??((o=this._option.globalScale.getScale("color"))===null||o===void 0?void 0:o.range()))!==null&&l!==void 0?l:this._getDataScheme();return(u=(d=new ColorOrdinalScale().domain(g)).range)===null||u===void 0?void 0:u.call(d,_)}initColorCallback(e,i){var n,o,l,d;if(this._colorMode==="ordinal"){const g=this.getWordOrdinalColorScale(e,i);return _=>g.scale(_[e??DEFAULT_DATA_SERIES_FIELD])}const u=(n=i?this._colorList:this._wordCloudShapeConfig.fillingColorList)!==null&&n!==void 0?n:this._option.globalScale.getScale("color").range();if(u.length===1)return g=>u[0];if(this._valueField){const g=this.getRawDataStatisticsByField(this._valueField,!0);if(g.min===g.max)return u[0];const _=new LinearScale().domain([g.min,g.max]).range(u);return y=>_.scale(y[this._valueField])}const f=new LinearScale().domain([0,(d=(l=(o=this.getViewData())===null||o===void 0?void 0:o.latestData)===null||l===void 0?void 0:l.length)!==null&&d!==void 0?d:1]).range(u);return g=>f.scale(g[DEFAULT_DATA_INDEX])}compile(){super.compile();const{width:e,height:i}=this._region.getLayoutRect();if(!isValidNumber(e)||!isValidNumber(i)||!(i>0&&e>0))return;const n=this._wordMark.getProduct();if(n){const o=[];this._isWordCloudShape?o.push(Object.assign({type:"wordcloudShape"},this._wordCloudShapeTransformOption())):o.push(Object.assign({type:"wordcloud"},this._wordCloudTransformOption())),n.transform(o)}}_getCommonTransformOptions(){var e,i,n,o,l,d;const{width:u,height:f}=this._region.getLayoutRect(),g=(e=this._spec.word)!==null&&e!==void 0?e:{},_=(i=g.style)!==null&&i!==void 0?i:{};return{size:[u,f],shape:isObject$1(this._maskShape)&&this._maskShape.type==="text"&&isNil(this._maskShape.fontFamily)?Object.assign({fontFamily:(n=this._option.getTheme())===null||n===void 0?void 0:n.fontFamily},this._maskShape):this._maskShape,onUpdateMaskCanvas:this.handleMaskCanvasUpdate,dataIndexKey:DEFAULT_DATA_KEY,text:g.formatMethod?y=>g.formatMethod(y):{field:this._textField},fontSize:this._valueField?{field:this._valueField}:this._fontSizeRange[0],fontSizeRange:this._fontSizeRange==="auto"?null:this._fontSizeRange,padding:(l=(o=this._spec.word)===null||o===void 0?void 0:o.padding)!==null&&l!==void 0?l:DEFAULT_FONT_PADDING,fontFamily:isValid(this._spec.fontFamilyField)?{field:this._spec.fontFamilyField}:(d=_.fontFamily)!==null&&d!==void 0?d:this._defaultFontFamily,fontWeight:isValid(this._spec.fontWeightField)?{field:this._spec.fontWeightField}:isValid(_.fontWeight)?_.fontWeight:isValid(this._valueField)?this._calculateFontWeight:"normal",fontStyle:isValid(this._spec.fontStyleField)?{field:this._spec.fontStyleField}:_.fontStyle}}_wordCloudTransformOption(){var e,i;const n=(e=this._wordCloudConfig)!==null&&e!==void 0?e:{};return Object.assign(Object.assign(Object.assign({},n),this._getCommonTransformOptions()),{layoutType:this._wordCloudConfig.layoutMode,rotate:this._rotateAngles,randomVisible:(i=this._spec.random)!==null&&i!==void 0?i:DEFAULT_RANDOM,clip:this._wordCloudConfig.drawOutOfBound==="clip",shrink:this._wordCloudConfig.zoomToFit.shrink,enlarge:this._wordCloudConfig.zoomToFit.enlarge,minFontSize:this._wordCloudConfig.zoomToFit.fontSizeLimitMin,progressiveTime:this._wordCloudConfig.progressiveTime,progressiveStep:this._wordCloudConfig.progressiveStep,repeatFill:this._wordCloudConfig.zoomToFit.repeat})}_wordCloudShapeTransformOption(){var e,i,n,o,l,d;const u=(i=(e=this._spec.fillingWord)===null||e===void 0?void 0:e.style)!==null&&i!==void 0?i:{},f=(n=this._wordCloudShapeConfig)!==null&&n!==void 0?n:{};return Object.assign(Object.assign(Object.assign({},f),this._getCommonTransformOptions()),{rotateList:this._rotateAngles,fillingRotateList:f.fillingRotateAngles,fillingFontFamily:isValid(f.fillingFontFamilyField)?{field:f.fillingFontFamilyField}:(o=u.fontFamily)!==null&&o!==void 0?o:this._defaultFontFamily,fillingPadding:(d=(l=this._spec.fillingWord)===null||l===void 0?void 0:l.padding)!==null&&d!==void 0?d:DEFAULT_FONT_PADDING,fillingFontStyle:isValid(f.fillingFontStyleField)?{field:f.fillingFontStyleField}:u.fontStyle,fillingFontWeight:isValid(f.fillingFontWeightField)?{field:f.fillingFontWeightField}:u.fontWeight})}getStatisticFields(){const e=[];return e.push({key:this._nameField,operations:["values"]}),e.push({key:this._valueField,operations:["max","min"]}),e}dataToPosition(e){return null}dataToPositionX(e){return null}dataToPositionY(e){return null}dataToPositionZ(e){return null}valueToPosition(e,i){return null}getGroupFields(){return[]}getStackGroupFields(){return[]}getStackValueField(){return""}onLayoutEnd(e){super.onLayoutEnd(e),this.compile(),this._dataChange=!1}getActiveMarks(){return[this._wordMark]}reInit(){super.reInit(),this._keyWordColorCallback&&(this._keyWordColorCallback=null),this._fillingColorCallback&&(this._fillingColorCallback=null)}}BaseWordCloudSeries.mark=wordCloudSeriesMark;const WordCloud3dAnimation=r=>({custom:RotateBySphereAnimate,customParameters:(e,i)=>r,easing:"linear",loop:1/0,duration:6e3});function computeWordDelay(r,e,i){return r*i<e?r+(e-i*r)/(i-1):(e-r)/(i-1)}const WordCloudScaleInAnimation=r=>({channel:{fontSize:{from:0}},duration:200,delay:(e,i,n)=>{const o=r.animationConfig(),l=(o==null?void 0:o.duration)||200,d=(o==null?void 0:o.totalTime)||DEFAULT_ANIMATION_CONFIG.appear.duration,u=n.VGRAMMAR_ANIMATION_PARAMETERS.elementCount;return n.VGRAMMAR_ANIMATION_PARAMETERS.elementIndex*computeWordDelay(l,d,u)}});function wordcloudPresetAnimation(r,e){return e===!1?{}:e==="fadeIn"?{type:"fadeIn"}:WordCloudScaleInAnimation(r)}const registerWordCloudAnimation=()=>{Factory$1.registerAnimation("wordCloud",(r,e)=>({appear:wordcloudPresetAnimation(r,e),enter:{type:"fadeIn"},exit:{type:"fadeOut"},disappear:{type:"fadeOut"}}))},registerWordCloud3dAnimation=()=>{Factory$1.registerAnimation("wordCloud3d",r=>({enter:WordCloud3dAnimation(r)}))},randomHslColor=(r,e)=>"hsl("+(360*Math.random()).toFixed()+","+(30*Math.random()+70).toFixed()+"%,"+(Math.random()*(e-r)+r).toFixed()+"%)";function functor$1(r){return isFunction(r)?r:function(){return r}}class BaseLayout{constructor(e){var i,n;switch(this.options=merge$1({},BaseLayout.defaultOptions,e),isFunction(this.options.shape)?this.shape=this.options.shape:this.shape=getShapeFunction(this.options.shape),this.getText=(i=functor$1(this.options.text))!==null&&i!==void 0?i:o=>o,this.getTextFontWeight=functor$1(this.options.fontWeight),this.getTextFontSize=functor$1(this.options.fontSize),this.getTextFontStyle=functor$1(this.options.fontStyle),this.getTextFontFamily=functor$1(this.options.fontFamily),this.outputCallback=(n=this.options.outputCallback)!==null&&n!==void 0?n:o=>o,this.options.color){case"random-dark":this.getTextColor=()=>randomHslColor(10,50);break;case"random-light":this.getTextColor=()=>randomHslColor(50,90);break;default:this.getTextColor=functor$1(this.options.color)}if(isNil(this.options.rotate))if(this.options.useRandomRotate){const o=Math.abs(this.options.maxRotation-this.options.minRotation),l=Math.abs(Math.floor(this.options.rotationSteps)),d=Math.min(this.options.maxRotation,this.options.minRotation);this.getTextRotate=()=>this.options.rotateRatio===0||Math.random()>this.options.rotateRatio?0:o===0?d:l>0?d+Math.floor(Math.random()*l)*o/(l-1):d+Math.random()*o}else this.getTextRotate=()=>0;else this.getTextRotate=isFunction(this.options.rotate)?o=>{var l;return degreeToRadian((l=this.options.rotate(o))!==null&&l!==void 0?l:0)}:(o,l)=>{const d=array(this.options.rotate),u=this.options.random?Math.random():seedRandom(l);return degreeToRadian(d[Math.floor(u*d.length)])}}canRepeat(){return!1}exceedTime(){var e;return this.options.progressiveStep>0?this.progressiveIndex>=(((e=this.currentStepIndex)!==null&&e!==void 0?e:-1)+1)*this.options.progressiveStep:this.options.progressiveTime>0&&new Date().getTime()-this.escapeTime>this.options.progressiveTime}progressiveRun(){var e;if(this.options.progressiveStep>0?this.currentStepIndex=((e=this.currentStepIndex)!==null&&e!==void 0?e:-1)+1:this.options.progressiveTime>0&&(this.escapeTime=Date.now()),this.data&&this.progressiveIndex<this.data.length){this.progressiveResult=[];let i=this.progressiveIndex,n=0;const o=this.options.maxSingleWordTryCount,l=Math.min(this.options.maxFailCount,this.originalData.length);for(;i<this.data.length&&this.failCount<l;){const d=this.layoutWord(i);if(n++,(d||n>o)&&(i++,n=0,this.failCount=d?0:this.failCount+1),this.progressiveIndex=i,this.exceedTime())break;i===this.data.length&&this.failCount<l&&this.options.repeatFill&&this.canRepeat()&&(this.data=[...this.data,...this.originalData.map(u=>Object.assign(Object.assign({},u),{isFill:!0}))],this.isTryRepeatFill=!0)}return this.progressiveResult}return this.result}initProgressive(){this.failCount=0,this.progressiveIndex=0,this.options.progressiveStep>0?this.currentStepIndex=-1:this.options.progressiveTime>0&&(this.escapeTime=Date.now()),this.progressiveResult=[]}output(){return this.result?this.outputCallback(this.result):null}progressiveOutput(){return this.progressiveResult?this.outputCallback(this.progressiveResult):null}unfinished(){return this.data&&this.data.length&&!isNil(this.progressiveIndex)&&this.progressiveIndex<this.data.length}release(){this.data=null,this.result=null,this.progressiveIndex=null,this.progressiveResult=null}}BaseLayout.defaultOptions={fontFamily:'"Trebuchet MS", "Heiti TC", "", "Arial Unicode MS", "Droid Fallback Sans", sans-serif',fontWeight:"normal",color:"random-dark",fontStyle:"normal",minFontSize:12,drawOutOfBound:!1,shrink:!1,minRotation:-Math.PI/2,maxRotation:Math.PI/2,rotationSteps:0,rotateRatio:.1,random:!1,shape:"circle",progressiveTime:0,progressiveStep:0,repeatFill:!1,fillTextFontSize:12,maxFailCount:20};const spirals={archimedean:archimedeanSpiral$1,rectangular:rectangularSpiral};function archimedeanSpiral$1(r){const e=r[0]/r[1];return i=>[e*(i*=.1)*Math.cos(i),i*Math.sin(i)]}function rectangularSpiral(r){const e=4*r[0]/r[1];let i=0,n=0;return o=>{const l=o<0?-1:1;switch(Math.sqrt(1+4*l*o)-l&3){case 0:i+=e;break;case 1:n+=4;break;case 2:i-=e;break;default:n-=4}return[i,n]}}class CloudLayout extends BaseLayout{constructor(e){var i;super(merge$1({},CloudLayout.defaultOptions,e)),this.cw=64,this.ch=2048,this._size=[256,256],this._isBoardExpandCompleted=!1,this._placeStatus=0,this._tTemp=null,this._dtTemp=null,this._dy=0,this.cacheMap=new Map,this.options.minFontSize<=CloudLayout.defaultOptions.minFontSize&&(this.options.minFontSize=CloudLayout.defaultOptions.minFontSize),this.spiral=isString(this.options.spiral)?(i=spirals[this.options.spiral])!==null&&i!==void 0?i:spirals.archimedean:this.options.spiral,this.random=this.options.random?Math.random:()=>1,this.getTextPadding=functor$1(this.options.padding)}zoomRatio(){return this._originSize[0]/this._size[0]}dy(){return this._dy}layoutWord(e){const i=this.data[e];if((""+i.text).trim()==="")return!0;const{maxRadius:n,center:o}=getMaxRadiusAndCenter(this.options.shape,this._size);if(i.x=o[0],i.y=o[1],cloudSprite(this.contextAndRatio,i,this.data,e,this.cw,this.ch),this._placeStatus=0,i.hasText&&this.place(this._board,i,this._bounds,n))return this.result.push(i),this._bounds?cloudBounds(this._bounds,i):this._bounds=[{x:i.x+i.x0,y:i.y+i.y0},{x:i.x+i.x1,y:i.y+i.y1}],i.x-=this._size[0]>>1,i.y-=this._size[1]>>1,this._tTemp=null,this._dtTemp=null,!0;if(this.updateBoardExpandStatus(i.fontSize),i.hasText&&this.shouldShrinkContinue()){if(this._placeStatus===1){const l=i.fontSize*this._originSize[0]/this.options.minFontSize,d=Math.max(i.width,i.height);if(d<=l)this.expandBoard(this._board,this._bounds,d/this._size[0]);else{if(!this.options.clip)return!0;this.expandBoard(this._board,this._bounds,l/this._size[0])}}else this._placeStatus,this.expandBoard(this._board,this._bounds);return this.updateBoardExpandStatus(i.fontSize),!1}return this._tTemp=null,this._dtTemp=null,!0}layout(e,i){this.initProgressive(),this.result=[],this._size=[i.width,i.height],this.clearCache(),this._originSize=[...this._size];const n=this.getContext(vglobal.createCanvas({width:1,height:1}));this.contextAndRatio=n,this._board=new Array((this._size[0]>>5)*this._size[1]).fill(0),this._bounds=null,e.length,this.result=[];const o=e.map((l,d)=>({text:this.getText(l),fontFamily:this.getTextFontFamily(l),fontStyle:this.getTextFontStyle(l),fontWeight:this.getTextFontWeight(l),angle:this.getTextRotate(l,d),fontSize:~~this.getTextFontSize(l),padding:this.getTextPadding(l),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:l,x:0,y:0,width:0,height:0})).sort(function(l,d){return d.fontSize-l.fontSize});if(this.originalData=o,this.data=o,this.progressiveRun(),!this.options.clip&&this.options.enlarge&&this._bounds&&this.shrinkBoard(this._bounds),this._bounds&&["cardioid","triangle","triangle-upright"].includes(this.options.shape)){const l=(this._bounds[0].y+this._bounds[1].y)/2;this._dy=-(l-this._originSize[1]/2)}return this.result}formatTagItem(e){const i=this._size,n=this.zoomRatio(),o=this.dy(),l=i[0]>>1,d=i[1]>>1,u=e.length,f=[];let g,_;for(let y=0;y<u;++y)g=e[y],_={},_.datum=g.datum,_.x=(g.x+l)*n,_.y=(g.y+d+o)*n,_.fontFamily=g.fontFamily,_.fontSize=g.fontSize*n,_.fontStyle=g.fontStyle,_.fontWeight=g.fontWeight,_.angle=g.angle,f.push(_);return f}output(){return this.outputCallback?this.outputCallback(this.formatTagItem(this.result)):this.formatTagItem(this.result)}progressiveOutput(){return this.outputCallback?this.outputCallback(this.formatTagItem(this.progressiveResult)):this.formatTagItem(this.progressiveResult)}updateBoardExpandStatus(e){this._isBoardExpandCompleted=e*(this._originSize[0]/this._size[0])<this.options.minFontSize}shouldShrinkContinue(){return!this.options.clip&&this.options.shrink&&!this._isBoardExpandCompleted}shrinkBoard(e){const i=e[0],n=e[1];if(n.x>=this._size[0]||n.y>=this._size[1])return;const o=Math.min(i.x,this._size[0]-n.x),l=Math.min(i.y,this._size[1]-n.y),d=2*Math.min(o/this._size[0],l/this._size[1]);this._size=this._size.map(u=>u*(1-d))}expandBoard(e,i,n){const o=this._size[0]*(n||1.1)-this._size[0]>>5;let l=2*o>2?o:2;l%2!=0&&l++;let d=Math.ceil(this._size[1]*(l<<5)/this._size[0]);d%2!=0&&d++;const u=this._size[0],f=this._size[1],g=new Array(l).fill(0),_=new Array(d/2*(l+(u>>5))).fill(0);this.insertZerosToArray(e,f*(u>>5),_.length+l/2);for(let y=f-1;y>0;y--)this.insertZerosToArray(e,y*(u>>5),g.length);this.insertZerosToArray(e,0,_.length+l/2),this._size=[u+(l<<5),f+d],i&&(i[0].x+=(l<<5)/2,i[0].y+=d/2,i[1].x+=(l<<5)/2,i[1].y+=d/2)}insertZerosToArray(e,i,n){if(this.options.customInsertZerosToArray)return this.options.customInsertZerosToArray(e,i,n);const o=Math.floor(n/6e4),l=n%6e4;for(let d=0;d<o;d++)e.splice(i+6e4*d,0,...new Array(6e4).fill(0));e.splice(i+6e4*o,0,...new Array(l).fill(0))}getContext(e){e.width=1,e.height=1;const i=e.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,1,1),n=Math.sqrt(i.data.length>>2);e.width=(this.cw<<5)/n,e.height=this.ch/n;const o=e.getContext("2d",{willReadFrequently:!0});return o.fillStyle=o.strokeStyle="red",o.textAlign="center",{context:o,ratio:n,canvas:e}}place(e,i,n,o){let l=!1;if(this.shouldShrinkContinue()&&(i.width>this._size[0]||i.height>this._size[1]))return this._placeStatus=1,!1;const d=this.random()<.5?1:-1;if(!this.shouldShrinkContinue()&&this.isSizeLargerThanMax(i,d))return null;const u=i.x,f=i.y,g=Math.sqrt(this._size[0]*this._size[0]+this._size[1]*this._size[1]),_=this.spiral(this._size);let y,b,S,v,A=-d;for(this._tTemp=null,this._dtTemp=null;y=_(A+=d);){b=y[0],S=y[1];const x=Math.sqrt(b**2+S**2);let T=Math.atan(S/b);b<0?T+=Math.PI:S<0&&(T=2*Math.PI+T);const C=this.shape(T);if(Math.min(Math.abs(b),Math.abs(S))>=g)break;if(x>=o)l&&this._tTemp===null&&(this._tTemp=A,this._dtTemp=d);else{if(i.x=u+~~(x*C*Math.cos(-T)),i.y=f+~~(x*C*Math.sin(-T)),v=i,this.options.clip)if(this.shouldShrinkContinue()){if(isPartOutside(v,this._size)){l&&this._tTemp===null&&(this._tTemp=A,this._dtTemp=d);continue}}else{if(isFullOutside(v,this._size)){l&&this._tTemp===null&&(this._tTemp=A,this._dtTemp=d);continue}isPartOutside(v,this._size)&&(v=clipInnerTag(v,this._size))}else if(isPartOutside(v,this._size)){l&&this._tTemp===null&&(this._tTemp=A,this._dtTemp=d);continue}if(l=!0,(!n||collideRects(v,n))&&(!n||!cloudCollide(v,e,this._size))){const E=v.sprite,P=v.width>>5,R=this._size[0]>>5,L=v.x-(P<<4),w=127&L,B=32-w,I=v.y1-v.y0;let D,O=(v.y+v.y0)*R+(L>>5);for(let N=0;N<I;N++){D=0;for(let V=0;V<=P;V++)e[O+V]|=D<<B|(V<P?(D=E[N*P+V])>>>w:0);O+=R}return i.sprite=null,v.sprite=null,!0}}}return this._tTemp!==null&&(this._placeStatus=3),!this.shouldShrinkContinue()&&this.setCache(v,d),!1}clearCache(){this.cacheMap.clear()}setCache(e,i){const n=`${e.angle}-${i}`,o=e.x1-e.x0,l=e.y1-e.y0;if(!this.cacheMap.has(n))return void this.cacheMap.set(n,{width:o,height:l});const{width:d,height:u}=this.cacheMap.get(n);(o<d&&l<u||o<=d&&l<u)&&this.cacheMap.set(n,{width:o,height:l})}isSizeLargerThanMax(e,i){const n=`${e.angle}-${i}`;if(!this.cacheMap.has(n))return!1;const{width:o,height:l}=this.cacheMap.get(n),d=e.x1-e.x0,u=e.y1-e.y0;return d>=o&&u>=l}}function cloudSprite(r,e,i,n,o,l){if(e.sprite)return;const d=r.context,u=r.ratio;d.setTransform(u,0,0,u,0,0),d.clearRect(0,0,(o<<5)/u,l/u);let f=0,g=0,_=0;const y=i.length;let b,S,v,A,x;for(--n;++n<y;){if(e=i[n],d.save(),d.font=e.fontStyle+" "+e.fontWeight+" "+~~((e.fontSize+1)/u)+"px "+e.fontFamily,b=d.measureText(e.text+"m").width*u,v=e.fontSize<<1,e.angle){const E=Math.sin(e.angle),P=Math.cos(e.angle),R=b*P,L=b*E,w=v*P,B=v*E;b=Math.max(Math.abs(R+B),Math.abs(R-B))+31>>5<<5,v=~~Math.max(Math.abs(L+w),Math.abs(L-w))}else b=b+31>>5<<5;if(v>_&&(_=v),f+b>=o<<5&&(f=0,g+=_,_=0),g+v>=l)break;d.translate((f+(b>>1))/u,(g+(v>>1))/u),e.angle&&d.rotate(e.angle),d.fillText(e.text,0,0),e.padding&&(d.lineWidth=2*e.padding,d.strokeText(e.text,0,0)),d.restore(),e.width=b,e.height=v,e.xoff=f,e.yoff=g,e.x1=b>>1,e.y1=v>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,f+=b}const T=d.getImageData(0,0,(o<<5)/u,l/u).data,C=[];for(;--n>=0;){if(!(e=i[n]).hasText)continue;for(b=e.width,S=b>>5,v=e.y1-e.y0,A=0;A<v*S;A++)C[A]=0;if(f=e.xoff,f==null)return;g=e.yoff;let E=0,P=-1;for(x=0;x<v;x++){for(A=0;A<b;A++){const R=S*x+(A>>5),L=T[(g+x)*(o<<5)+(f+A)<<2]?1<<31-A%32:0;C[R]|=L,E|=L}E?P=x:(e.y0++,v--,x--,g++)}e.y1=e.y0+P,e.sprite=C.slice(0,(e.y1-e.y0)*S)}}function cloudCollide(r,e,i){const n=i[0]>>5,o=r.sprite,l=r.width>>5,d=r.x-(l<<4),u=127&d,f=32-u,g=r.y1-r.y0;let _,y=(r.y+r.y0)*n+(d>>5);for(let b=0;b<g;b++){_=0;for(let S=0;S<=l;S++)if((_<<f|(S<l?(_=o[b*l+S])>>>u:0))&e[y+S])return!0;y+=n}return!1}function cloudBounds(r,e){const i=r[0],n=r[1];e.x+e.x0<i.x&&(i.x=e.x+e.x0),e.y+e.y0<i.y&&(i.y=e.y+e.y0),e.x+e.x1>n.x&&(n.x=e.x+e.x1),e.y+e.y1>n.y&&(n.y=e.y+e.y1)}function collideRects(r,e){return r.x+r.x1>e[0].x&&r.x+r.x0<e[1].x&&r.y+r.y1>e[0].y&&r.y+r.y0<e[1].y}CloudLayout.defaultOptions={enlarge:!1,minFontSize:2,maxSingleWordTryCount:2};const isFullOutside=(r,e)=>r.x+r.x0>e[0]||r.y+r.y0>e[0]||r.x+r.x1<0||r.y+r.y1<0,isPartOutside=(r,e)=>r.x+r.x0<0||r.y+r.y0<0||r.x+r.x1>e[0]||r.y+r.y1>e[1];function clipInnerTag(r,e){const i=r.sprite,n=r.y1-r.y0,o=r.width>>5;let l=0;const d=[],u=Math.max(-(r.y0+r.y),0),f=Math.min(n+(e[1]-(r.y1+r.y)),n),g=Math.max(-(r.x0+r.x),0)>>5,_=Math.min(o+(e[0]-(r.x1+r.x)>>5)+1,o);for(let A=0;A<n;A++){for(let x=0;x<o;x++)A<u||f<=A||x<g||_<=x||d.push(i[l+x]);l+=o}const y=g<<5,b=o-_<<5,S=u,v=n-f;return Object.assign(Object.assign({},r),{width:r.width-y-b,height:r.height-S-v,x0:r.x0+y,x1:r.x1-b,y0:r.y0+S,y1:r.y1-v,x:r.x+y/2-b/2,sprite:d})}let GridLayout$1=class je extends BaseLayout{constructor(e){super(merge$1({},je.defaultOptions,e)),this.fillGridAt=(i,n)=>{i>=this.ngx||n>=this.ngy||i<0||n<0||(this.grid[i][n]=!1)},this.updateGrid=(i,n,o,l,d)=>{const u=d.occupied;let f=u.length;for(;f--;){const g=i+u[f][0],_=n+u[f][1];g>=this.ngx||_>=this.ngy||g<0||_<0||this.fillGridAt(g,_)}},this.gridSize=Math.max(Math.floor(this.options.gridSize),4)}getPointsAtRadius(e){if(this.pointsAtRadius[e])return this.pointsAtRadius[e];const i=8*e;let n=i;const o=[];for(e===0&&o.push([this.center[0],this.center[1],0]);n--;){const l=this.shape(n/i*2*Math.PI);o.push([this.center[0]+e*l*Math.cos(-n/i*2*Math.PI),this.center[1]+e*l*Math.sin(-n/i*2*Math.PI)*this.options.ellipticity,n/i*2*Math.PI])}return this.pointsAtRadius[e]=o,o}getTextInfo(e,i=1,n){var o;const l=this.options.clip?1:i,d=Math.max(Math.floor((this.isTryRepeatFill?this.options.fillTextFontSize:this.getTextFontSize(e))*l),this.options.minFontSize);let u=this.getText(e)+"";if(this.options.clip&&(u=u.slice(0,Math.ceil(u.length*i))),!u)return null;const f=this.getTextFontWeight(e),g=this.getTextFontStyle(e),_=this.getTextRotate&&(o=this.getTextRotate(e,n))!==null&&o!==void 0?o:0,y=this.getTextFontFamily(e),b=document.createElement("canvas"),S=b.getContext("2d",{willReadFrequently:!0});S.font=g+" "+f+" "+d.toString(10)+"px "+y;const v=S.measureText(u).width,A=Math.max(d,S.measureText("m").width,S.measureText("").width);let x=v+2*A,T=3*A;const C=Math.ceil(x/this.gridSize),E=Math.ceil(T/this.gridSize);x=C*this.gridSize,T=E*this.gridSize;const P=-v/2,R=.4*-A,L=Math.ceil((x*Math.abs(Math.sin(_))+T*Math.abs(Math.cos(_)))/this.gridSize),w=Math.ceil((x*Math.abs(Math.cos(_))+T*Math.abs(Math.sin(_)))/this.gridSize),B=w*this.gridSize,I=L*this.gridSize;b.setAttribute("width",""+B),b.setAttribute("height",""+I),S.scale(1,1),S.translate(B/2,I/2),S.rotate(-_),S.font=g+" "+f+" "+d.toString(10)+"px "+y,S.fillStyle="#000",S.textBaseline="middle",S.fillText(u,P,R);const D=S.getImageData(0,0,B,I).data;if(this.exceedTime())return null;const O=[];let N,V=w;const H=[L/2,w/2,L/2,w/2],F=($,G,Y)=>{let Q=this.gridSize;for(;Q--;){let q=this.gridSize;for(;q--;)if(D[4*((G*this.gridSize+Q)*B+($*this.gridSize+q))+3])return Y.push([$,G]),$<H[3]&&(H[3]=$),$>H[1]&&(H[1]=$),G<H[0]&&(H[0]=G),void(G>H[2]&&(H[2]=G))}};for(;V--;)for(N=L;N--;)F(V,N,O);return{datum:e,occupied:O,bounds:H,gw:w,gh:L,fillTextOffsetX:P,fillTextOffsetY:R,fillTextWidth:v,fillTextHeight:A,fontSize:d,fontStyle:g,fontWeight:f,fontFamily:y,angle:_,text:u}}calculateEmptyRate(){const e=this.ngx*this.ngy;let i=0;for(let n=0;n<this.ngx;n++)for(let o=0;o<this.ngy;o++)this.grid[n][o]&&i++;return i/e}canFitText(e,i,n,o,l){let d=l.length;for(;d--;){const u=e+l[d][0],f=i+l[d][1];if(u>=this.ngx||f>=this.ngy||u<0||f<0){if(!this.options.drawOutOfBound)return!1}else if(!this.grid[u][f])return!1}return!0}layoutWord(e,i=1){const n=this.data[e],o=this.getTextInfo(n,i,e);if(!o||this.exceedTime())return!1;if(!this.options.drawOutOfBound&&(!this.options.shrink||o.fontSize<=this.options.minFontSize)&&!this.options.clip){const u=o.bounds;if(u[1]-u[3]+1>this.ngx||u[2]-u[0]+1>this.ngy)return!1}let l=this.maxRadius+1;const d=u=>{const f=Math.floor(u[0]-o.gw/2),g=Math.floor(u[1]-o.gh/2),_=o.gw,y=o.gh;return!!this.canFitText(f,g,_,y,o.occupied)&&(o.distance=this.maxRadius-l,o.theta=u[2],this.outputText(f,g,o),this.updateGrid(f,g,_,y,o),!0)};for(;l--;){let u=this.getPointsAtRadius(this.maxRadius-l);if(this.options.random&&(u=[].concat(u),shuffleArray(u)),u.some(d))return!0}return(this.options.clip||!!(this.options.shrink&&o.fontSize>this.options.minFontSize))&&this.layoutWord(e,.75*i)}outputText(e,i,n){const o=this.getTextColor(n),l={text:n.text,datum:n.datum,color:o,fontStyle:n.fontStyle,fontWeight:n.fontWeight,fontFamily:n.fontFamily,angle:n.angle,width:n.fillTextWidth,height:n.fillTextHeight,x:(e+n.gw/2)*this.gridSize,y:(i+n.gh/2)*this.gridSize+n.fillTextOffsetY+.5*n.fontSize,fontSize:n.fontSize};this.result.push(l),this.progressiveResult&&this.progressiveResult.push(l)}initGrid(e){this.grid=[];const i=this.options.shape;if(isObject$1(i)){const n=generateMaskCanvas(i,e.width,e.height);let o=n.getContext("2d").getImageData(0,0,this.ngx*this.gridSize,this.ngy*this.gridSize);this.options.onUpdateMaskCanvas&&this.options.onUpdateMaskCanvas(n);let l=generateIsEmptyPixel(i.backgroundColor);const d=(f,g)=>{let _=this.gridSize;for(;_--;){let y=this.gridSize;for(;y--;)if(!l(o,g*this.gridSize+_,f*this.gridSize+y))return void(this.grid[f][g]=!0)}this.grid[f][g]=!1};let u=this.ngx;for(;u--;){this.grid[u]=[];let f=this.ngy;for(;f--;)d(u,f),this.grid[u][f]!==!1&&(this.grid[u][f]=!0)}o=l=void 0}else{let n=this.ngx;for(;n--;){this.grid[n]=[];let o=this.ngy;for(;o--;)this.grid[n][o]=!0}}}canRepeat(){return this.calculateEmptyRate()>.001}layout(e,i){this.initProgressive(),this.drawnCount=0,this.isTryRepeatFill=!1,this.originalData=e,this.data=e,this.pointsAtRadius=[],this.ngx=Math.floor(i.width/this.gridSize),this.ngy=Math.floor(i.height/this.gridSize);const{center:n,maxRadius:o}=getMaxRadiusAndCenter(this.options.shape,[i.width,i.height]);return this.center=i.origin?[i.origin[0]/this.gridSize,i.origin[1]/this.gridSize]:[n[0]/this.gridSize,n[1]/this.gridSize],this.maxRadius=Math.floor(o/this.gridSize),this.initGrid(i),this.result=[],this.progressiveRun()}};GridLayout$1.defaultOptions={gridSize:8,ellipticity:1,maxSingleWordTryCount:1};class FastLayout extends BaseLayout{constructor(e){super(merge$1({},FastLayout.defaultOptions,e)),this.random=this.options.random?Math.random:()=>0,this.aspectRatio=1}fit(e){for(let i=0,n=this.result.length;i<n;i++)if(isOverlap(e,this.result[i]))return!1;return!0}getTextInfo(e,i){const n={datum:e,fontSize:this.getTextFontSize(e),fontWeight:this.getTextFontWeight(e),fontStyle:this.getTextFontStyle(e),fontFamily:this.getTextFontFamily(e),angle:this.getTextRotate(e,i),text:this.getText(e)+"",x:this.center[0],y:this.center[1]},o=getTextBounds(n);return n.width=o.width(),n.height=o.height(),n.top=this.center[1]-n.height+.21*n.height,n.left=this.center[0]-n.width/2,n}layoutWord(e){const i=this.getTextInfo(this.data[e],e);let n=2*Math.PI,o=0,l=i.left,d=i.top;const u=i.width,f=i.height;let g=1,_=this.fit(i);for(;!_&&o<this.maxRadius;)o+=.5,g=this.shape(o/this.maxRadius*2*Math.PI),n+=.5*(this.options.random?this.random()>.5?1:-1:e%2==0?1:-1),l=this.center[0]-u/2+o*g*Math.cos(n)*this.aspectRatio,d=this.center[1]-f/2+o*g*Math.sin(n),i.left=l,i.top=d,i.x=l+u/2,i.y=d+f/2,_=this.fit(i);return!!_&&!!(this.options.clip||i.left>=0&&i.left+i.width<=this.width&&i.top>=0&&i.top+i.height<=this.height)&&(this.result.push(i),!0)}layout(e,i){if(!(e!=null&&e.length))return[];this.initProgressive(),this.result=[],this.maxRadius=Math.sqrt(i.width*i.width+i.height*i.height)/2,this.center=[i.width/2,i.height/2],this.width=i.width,this.height=i.height,this.data=e.sort((o,l)=>this.getTextFontSize(l)-this.getTextFontSize(o));let n=0;for(;n<e.length&&(this.layoutWord(n),n++,this.progressiveIndex=n,!this.exceedTime()););return this.result}}function isOverlap(r,e){return!(r.left+r.width<e.left||r.top+r.height<e.top||r.left>e.left+e.width||r.top>e.top+e.height)}FastLayout.defaultOptions={enlarge:!1};const OUTPUT$1={x:"x",y:"y",z:"z",fontFamily:"fontFamily",fontSize:"fontSize",fontStyle:"fontStyle",fontWeight:"fontWeight",angle:"angle"},transform$3=(r,e)=>{var i,n,o,l,d,u;if(r.size&&(r.size[0]<=0||r.size[1]<=0))return Logger.getInstance().info("Wordcloud size dimensions must be greater than 0"),[];const f=e,g=((i=r.size)!==null&&i!==void 0?i:[500,500]).slice();g[0]=Math.floor(g[0]),g[1]=Math.floor(g[1]);const _=r.fontFamily?field$1(r.fontFamily):"sans-serif",y=r.fontStyle?field$1(r.fontStyle):"normal",b=r.fontWeight?field$1(r.fontWeight):"normal",S=r.rotate?field$1(r.rotate):0,v=field$1(r.text),A=(n=r.spiral)!==null&&n!==void 0?n:"archimedean",x=r.padding?field$1(r.padding):1,T=(o=r.shape)!==null&&o!==void 0?o:"square",C=(l=r.shrink)!==null&&l!==void 0&&l,E=(d=r.enlarge)!==null&&d!==void 0&&d,P=(u=r.clip)!==null&&u!==void 0&&u,R=r.minFontSize,L=r.randomVisible,w=r.as?Object.assign(Object.assign({},OUTPUT$1),r.as):OUTPUT$1,B=r.depth_3d,I=r.postProjection;let D=r.fontSize?field$1(r.fontSize):14;const O=r.fontSizeRange;if(O&&!isNumber(D)){const H=D,F=generateScale(extent$1(H,f),O);D=$=>F(H($))}let N=CloudLayout;r.layoutType==="fast"?N=FastLayout:r.layoutType==="grid"&&(N=GridLayout$1);const V=new N(Object.assign(Object.assign({},r),{text:v,padding:x,spiral:A,shape:T,rotate:S,fontFamily:_,fontStyle:y,fontWeight:b,fontSize:D,shrink:C,clip:P,enlarge:E,minFontSize:R,random:L,outputCallback:H=>{const F=[];let $,G;for(let Y=0,Q=H.length;Y<Q;Y++)G=H[Y],$=G.datum,$[w.x]=G.x,$[w.y]=G.y,$[w.fontFamily]=G.fontFamily,$[w.fontSize]=G.fontSize,$[w.fontStyle]=G.fontStyle,$[w.fontWeight]=G.fontWeight,$[w.angle]=G.angle,I==="StereographicProjection"&&stereographicProjection(g,G,$,w,B),r.dataIndexKey&&($[r.dataIndexKey]=`${Y}`),F.push($);return F}}));return V.layout(f,{width:g[0],height:g[1]}),r.progressiveStep>0||r.progressiveTime>0?{progressive:V}:V.output()},field$1=r=>isString(r)||isNumber(r)||isFunction(r)||isArray(r)?r:e=>e[r.field],sqrt=r=>r<0?-Math.sqrt(-r):Math.sqrt(r),generateScale=(r,e,i)=>{if(r[0]===r[1])return u=>e[0];const n=sqrt(r[0]),o=sqrt(r[1]),l=Math.min(n,o),d=Math.max(n,o);return u=>(sqrt(u)-l)/(d-l)*(e[1]-e[0])+e[0]},extent$1=(r,e)=>{let i=1/0,n=-1/0;const o=e.length;let l;for(let d=0;d<o;++d)l=toNumber(r(e[d])),l<i&&(i=l),l>n&&(n=l);return e.length===1&&i===n&&(i-=1e4),[i,n]};function stereographicProjection(r,e,i,n,o){const l=Math.max(r[0],r[1])/2,d=_StereographicProjection(r[0],r[1],l,{x:l,y:l,z:o??l},e);i[n.x]=d.x,i[n.y]=d.y,i[n.z]=d.z}function _StereographicProjection(r,e,i,n,o){const{x:l,y:d}=o,u=l/r*Math.PI*2;let f=Math.PI-d/e*Math.PI;return f+=(f<Math.PI/2?1:-1)*Math.pow(Math.min(f-Math.PI/2,1),2)/5,{x:i*Math.sin(f)*Math.cos(u)+n.x,y:i*Math.cos(f)+n.y,z:i*Math.sin(f)*Math.sin(u)+n.z}}const registerWordCloudTransforms=()=>{Factory.registerTransform("wordcloud",{transform:transform$3,markPhase:"beforeJoin"},!0)};var WORDCLOUD_SHAPE_HOOK_EVENT;(function(r){r.BEFORE_WORDCLOUD_SHAPE_LAYOUT="beforeWordcloudShapeLayout",r.AFTER_WORDCLOUD_SHAPE_LAYOUT="afterWordcloudShapeLayout",r.AFTER_WORDCLOUD_SHAPE_DRAW="afterWordcloudShapeDraw"})(WORDCLOUD_SHAPE_HOOK_EVENT||(WORDCLOUD_SHAPE_HOOK_EVENT={}));const colorListEqual=(r,e)=>{if(e.length===1&&e[0]==="#537EF5")return!0;if(!Array.isArray(r)||!Array.isArray(e)||r.length!==e.length)return!1;for(let i=0;i<r.length;i++)if(r[i]!==e[i])return!1;return!0},fakeRandom=()=>{let r=-1;const e=[0,.1,.2,.3,.4,.5,.6,.7,.8,.9];return()=>(r=(r+1)%e.length,e[r])},isChinese=r=>/^[\u4e00-\u9fa5]+$/.test(r),calTextLength=(r,e)=>{if(isNil(r))return 0;let i=0;for(const n of r)isChinese(n)?i+=1:i+=.53;return i};function loadImage(r){return r&&(isValidUrl(r)||isBase64(r)||r.startsWith("<svg"))?new Promise((e,i)=>{var n;const o=createImage({image:r}),l=(n=o.resources)===null||n===void 0?void 0:n.get(r);l&&l.state==="success"&&l.data?e(l.data):(o.successCallback=()=>{var d;if(o){const u=(d=o.resources)===null||d===void 0?void 0:d.get(r);u&&u.state==="success"&&u.data?e(u.data):i(new Error("image load failed"+r))}else i(new Error("image load failed"+r))},o.failCallback=()=>{Logger.getInstance().error("image ",r)})}):null}function functor(r){return typeof r=="function"?r:function(){return r}}function segmentation(r){const{size:e,maskCanvas:i}=r,n=i.getContext("2d",{willReadFrequently:!0}).getImageData(0,0,i.width,i.height),o=new Array(e[0]*e[1]).fill(0);let l=1;const d=[[0,1],[1,0],[-1,0],[0,-1]];let u=[];for(let B=0;B<e[1];B++)for(let I=0;I<e[0];I++)if(o[B*e[0]+I]===0&&!r.isEmptyPixel(n,B,I)){o[B*e[0]+I]=l,u.push([B,I]);for(let D=0;D<u.length;D++)for(let O=0;O<4;O++){let N=u[D][0]+d[O][0],V=u[D][1]+d[O][1];N=N<0?0:N>=e[1]?e[1]-1:N,V=V<0?0:V>=e[0]?e[0]-1:V,o[N*e[0]+V]!==0||r.isEmptyPixel(n,N,V)||(o[N*e[0]+V]=l,u.push([N,V]))}l++,u=[]}const f={},g={},_={},y={},b={},S={},v={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0,width:0,height:0};for(let B=0;B<e[1];B++)for(let I=0;I<e[0];I++){const D=o[B*e[0]+I];D!==0&&(w(B,I)&&(f[D]=f[D]||[],f[D].push([I,B]),y[D]||(y[D]=[1/0,-1/0,1/0,-1/0]),B<y[D][0]&&(y[D][0]=B),B>y[D][1]&&(y[D][1]=B),I<y[D][2]&&(y[D][2]=I),I>y[D][3]&&(y[D][3]=I),I<v.x1&&(v.x1=I),I>v.x2&&(v.x2=I),B<v.y1&&(v.y1=B),B>v.y2&&(v.y2=B)),g[D]=g[D]||0,g[D]++)}const A=[];for(const B in f){const I=f[B],D=~~(I.reduce(($,G)=>$+G[0],0)/I.length),O=~~(I.reduce(($,G)=>$+G[1],0)/I.length);_[B]=[D,O],A.push(...I);const[N,V,H,F]=y[B];b[B]=~~Math.max(Math.sqrt((D-H)**2+(O-N)**2),Math.sqrt((D-F)**2+(O-V)**2),Math.sqrt((D-H)**2+(O-V)**2),Math.sqrt((D-F)**2+(O-N)**2)),S[B]=(F-H)/(V-N)}const x=Object.keys(_).map(B=>({label:B-1,boundary:f[B],area:g[B],center:_[B],maxPoint:y[B],maxR:b[B],ratio:S[B]}));v.width=v.x2-v.x1+1,v.height=v.y2-v.y1+1;const T=~~(A.reduce((B,I)=>B+I[0],0)/A.length),C=~~(A.reduce((B,I)=>B+I[1],0)/A.length),E=~~Math.max(Math.sqrt((T-v.x1)**2+(C-v.y1)**2),Math.sqrt((T-v.x2)**2+(C-v.y2)**2),Math.sqrt((T-v.x1)**2+(C-v.y2)**2),Math.sqrt((T-v.x2)**2+(C-v.y1)**2)),P=v.width/v.height,R=Object.keys(g).reduce((B,I)=>B+g[I],0),L={regions:x,labels:o,labelNumber:l-1};return Object.assign(r,{segmentation:L,shapeBounds:v,shapeMaxR:E,shapeRatio:P,shapeCenter:[T,C],shapeArea:R});function w(B,I){const D=[[0,1],[1,0],[-1,0],[0,-1]];if(B===0||I===0||B===e[1]-1||I===e[0]-1)return!0;for(let O=0;O<4;O++){let N=B+D[O][0],V=I+D[O][1];if(N=N<0?0:N>=e[1]?e[1]-1:N,V=V<0?0:V>=e[0]?e[0]-1:V,o[N*e[0]+V]===0)return!0}return!1}}function removeBorder(r,e,i){e.width=r.width,e.height=r.height;const n=e.getContext("2d",{willReadFrequently:!0});n.clearRect(0,0,e.width,e.height),n.drawImage(r,0,0);const o=e.width,l=n.getImageData(0,0,e.width,e.height);let d=0,u=l.height,f=0,g=l.width;const _=(S,v)=>{for(let A=0;A<S;++A)if(!i(l,v,A))return!1;return!0},y=(S,v,A)=>{for(let x=v;x<A;++x)if(!i(l,x,S))return!1;return!0};for(;d<u&&_(o,d);)++d;for(;u-1>d&&_(o,u-1);)--u;for(;f<g&&y(f,d,u);)++f;for(;g-1>f&&y(g-1,d,u);)--g;const b=n.getImageData(f,d,g-f,u-d);return e.width=b.width,e.height=b.height,n.clearRect(0,0,e.width,e.height),n.putImageData(b,0,0),e}function scaleAndMiddleShape(r,e){const i=r.width,n=r.height;let o=e[0]/i;n*o>e[1]&&(o=e[1]/n);const l=Math.floor(o*i),d=Math.floor(o*n);return{x:(e[0]-l)/2,y:(e[1]-d)/2,width:l,height:d,scale:o}}function allocateWords(r,e){const{segmentation:{regions:i}}=e;let n=-1/0,o=0,l=0;i.forEach((g,_)=>{const y=g.area;y>n&&(n=y,l=_),o+=y});let d=0;i.forEach(g=>{const _=g.area,y=Math.ceil(_/o*r.length),b=_/n;g.words=[],g.regionNum=y,g.regionWeight=b,d+=y}),d<r.length&&(i[l].wordsNum+=r.length-d);let u=l;const f=i.map(g=>g.regionNum);r.forEach(g=>{let _=0,y=0;g.regionIndex=-1;do{if(f[u]>0&&g.weight<=i[u].regionWeight){g.regionIndex=u,i[u].words.push(g),f[u]--,u=(u+1)%i.length;break}u=(u+1)%i.length,_++,y++,y>i.length+1&&(i.forEach(b=>{b.regionWeight+=.15}),y=0)}while(g.regionIndex===-1&&_<3*i.length);g.regionIndex===-1&&(g.regionIndex=l,i[l].words.push(g),f[l]--)}),i.forEach(g=>{g.words.sort((_,y)=>y.weight-_.weight)})}function layout(r,e,i){const{size:n,stepFactor:o}=e,{segmentation:{regions:l},tempCanvas:d,boardSize:u,shapeCenter:f,shapeMaxR:g,shapeRatio:_}=i,y=initBoardWithShape(i),b=d.getContext("2d",{willReadFrequently:!0});for(const S of l){const{words:v,center:A,maxR:x,ratio:T}=S;for(let C=0;C<v.length;C++){measureSprite(d,b,r,C);const E=v[C];E.x=A[0],E.y=A[1],E.hasText&&E.sprite&&place$1(y,E,x,T,n,u,o)&&(E.hasPlaced=!0)}}for(let S=0;S<e.textLayoutTimes;S++){const v=r.filter(A=>(A.hasPlaced||(A.hasText=!1,A.sprite=null,A.fontSize=Math.max(~~(A.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!A.hasPlaced));if(v.length===0)break;for(let A=0;A<v.length;A++){const x=v[A];measureSprite(d,b,v,A),x.x=f[0],x.y=f[1],x.hasText&&place$1(y,x,g,_,n,u,o)&&(x.hasPlaced=!0)}}e.board=y}function layoutGlobalShrink(r,e,i){const{stepFactor:n,importantWordCount:o,globalShinkLimit:l}=e,{size:d,segmentation:{regions:u},tempCanvas:f,boardSize:g,shapeCenter:_,shapeMaxR:y,shapeRatio:b}=i,S=f.getContext("2d",{willReadFrequently:!0}),v=initBoardWithShape(i);let A=v.slice(0);const x=e.fontSizeShrinkFactor;let T=null,C=1,E=1;const P=o;let R=0;r.length>P&&(R=r.sort((L,w)=>w.weight-L.weight)[P].weight);for(let L=0;L<u.length;L++){const w=u[L],{words:B,center:I,maxR:D,ratio:O}=w;let N=!1;for(let V=0;V<B.length;V++){measureSprite(f,S,r,V);const H=B[V];if(H.x=I[0],H.y=I[1],!H.skip&&H.hasText&&H.sprite&&place$1(A,H,D,O,d,g,n))H.hasPlaced=!0;else{if(!H.skip&&H.weight>R&&E>l){const F=H.datum[Symbol.for("vGrammar_id")];F!==T&&(T=F,C=E),E*=x,r.forEach($=>{$.hasText=!1,$.sprite=null,$.fontSize=$.fontSize*x}),A=v.slice(0),N=!0;break}if(!H.skip&&H.datum[Symbol.for("vGrammar_id")]===T){r.forEach(F=>{F.hasText=!1,F.sprite=null,F.fontSize=F.fontSize/E}),H.skip=!0,E=C,T=null,A=v.slice(0),N=!0;break}}}N&&(L=-1)}for(let L=0;L<e.textLayoutTimes;L++){const w=r.filter(B=>(B.hasPlaced||(B.hasText=!1,B.sprite=null,B.fontSize=Math.max(~~(B.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!B.hasPlaced));if(w.length===0)break;for(let B=0;B<w.length;B++){const I=w[B];measureSprite(f,S,w,B),I.x=_[0],I.y=_[1],I.hasText&&place$1(A,I,y,b,d,g,n)&&(I.hasPlaced=!0)}}e.board=A}function layoutSelfEnlarge(r,e,i){const{size:n,stepFactor:o,importantWordCount:l}=e,{segmentation:{regions:d},tempCanvas:u,boardSize:f,shapeCenter:g,shapeMaxR:_,shapeRatio:y}=i,b=u.getContext("2d",{willReadFrequently:!0}),S=initBoardWithShape(i);let v=S.slice(0);const A=e.fontSizeEnlargeFactor,x=Math.min(l,r.length);let T=0;r.length>x&&(T=r.sort((R,L)=>L.weight-R.weight)[x-1].weight);let C=0,E=1,P=!1;for(let R=0;R<d.length;R++){const L=d[R],{words:w,center:B,maxR:I,ratio:D}=L;let O=!1;for(let N=0;N<w.length;N++){measureSprite(u,b,r,N);const V=w[N];if(V.x=B[0],V.y=B[1],V.hasText&&V.sprite&&place$1(v,V,I,D,n,f,o)){if(V.hasPlaced=!0,V.weight>=T&&C++,C>=x&&!P){E*=A,r.forEach(H=>{H.hasText=!1,H.sprite=null,H.fontSize=H.fontSize*A}),v=S.slice(0),O=!0,C=0;break}}else{if(V.weight>=T&&E>1){r.forEach(H=>{H.hasText=!1,H.sprite=null,H.fontSize=H.fontSize/A}),E/=A,P=!0,v=S.slice(0),O=!0;break}if(V.weight>=T)return layoutGlobalShrink(r,e,i)}}O&&(R=-1)}for(let R=0;R<e.textLayoutTimes;R++){const L=r.filter(w=>(w.hasPlaced||(w.hasText=!1,w.sprite=null,w.fontSize=Math.max(~~(w.fontSize*e.fontSizeShrinkFactor),e.minFontSize)),!w.hasPlaced));if(L.length===0)break;for(let w=0;w<L.length;w++){const B=L[w];measureSprite(u,b,L,w),B.x=g[0],B.y=g[1],B.hasText&&place$1(v,B,_,y,n,f,o)&&(B.hasPlaced=!0)}}e.board=v}function place$1(r,e,i,n,o,l,d){const u=e.x,f=e.y,g=archimedeanSpiral(n),_=1*d;let y,b,S,v=-_;for(;y=g(v+=_);){const{wordSize:A,bounds:{dTop:x,dBottom:T,dLeft:C,dRight:E}}=e;if(b=y[0],S=y[1],Math.min(Math.abs(b),Math.abs(S))>=i)break;if(e.x=~~(u+b),e.y=~~(f+S),!(e.x-C<0||e.x+E>o[0]||e.y-x<0||e.y+T>o[1]||isCollideWithBoard(e,r,l)))return placeWordOnBoard(e,r,l),!0}return!1}function placeWordOnBoard(r,e,i){const{wordSize:n}=r,o=r.sprite,l=n[0]>>5,d=i[0]>>5,u=r.x-(l<<4),f=u%32,g=32-f,_=n[1];let y,b=(r.y-(n[1]>>1))*d+(u>>5);if(f===0)for(let S=0;S<_;S++){for(let v=0;v<l;v++)e[b+v]|=o[S*l+v];b+=d}else for(let S=0;S<_;S++){y=0;for(let v=0;v<=l;v++)e[b+v]|=y<<g|(v<l?(y=o[S*l+v])>>>f:0);b+=d}}function isCollideWithBoard(r,e,i){const{sprite:n,wordSize:o}=r,l=i[0]>>5,d=o[0]>>5,u=r.x-(d<<4),f=u%32,g=32-f,_=o[1];let y,b=(r.y-(o[1]>>1))*l+(u>>5);if(f===0)for(let S=0;S<_;S++){for(let v=0;v<d;v++)if(e[b+v]&n[S*d+v])return!0;b+=l}else for(let S=0;S<_;S++){y=0;for(let v=0;v<=d;v++)if((y<<g|(v<d?(y=n[S*d+v])>>>f:0))&e[b+v])return!0;b+=l}return!1}function archimedeanSpiral(r){return function(e){return[r*(e*=.1)*Math.cos(e),e*Math.sin(e)]}}function measureSprite(r,e,i,n){if(i[n].sprite||i[n].fontSize===0)return;const o=2048,l=Math.PI/180,d=i.length;r.width=o,r.height=2048,e.clearRect(0,0,o,2048),e.textAlign="center";let u,f,g=0,_=0,y=0,b=0;const S=n;for(--n;++n<d;){const T=i[n],C=Math.max(T.fontSize,2);if(e.save(),e.font=T.fontStyle+" "+T.fontWeight+" "+C+"px "+T.fontFamily,u=e.measureText(T.text+"m").width+2*T.padding,f=2*C+2*T.padding,T.rotate!==0){const E=Math.sin(T.rotate*l),P=Math.cos(T.rotate*l),R=u*P,L=u*E,w=f*P,B=f*E;u=Math.max(Math.abs(R+B),Math.abs(R-B)),f=~~Math.max(Math.abs(L+w),Math.abs(L-w))}if(u=u+31>>5<<5,f=Math.ceil(f),f>y&&(y=f),g+u>=o&&(g=0,_+=y,y=f),_+f>=2048){if(_===0){T.hasText=!1;continue}break}_+f>=b&&(b=_+f),e.translate(g+(u>>1),_+(f>>1)),T.rotate!==0&&e.rotate(T.rotate*l),e.fillText(T.text,0,0),T.padding&&(e.lineWidth=2*T.padding,e.strokeText(T.text,0,0)),e.restore(),T.LT=[g,_],T.wordSize=[u,f],T.hasText=!0,g+=u}if(b===0)return;const v=e.getImageData(0,0,o,b).data;let A,x;for(;--n>=S;){const T=i[n];if(!T.hasText){T.bounds={dTop:1/0,dBottom:-1/0,dLeft:1/0,dRight:-1/0};break}const{LT:C=[0,0],wordSize:E}=T;[g,_]=C;const P=E[0]>>5,R=new Array(P*E[1]).fill(0);let[L,w,B,I]=[1/0,-1/0,1/0,-1/0];for(x=0;x<E[1];x++){let D;for(A=0;A<E[0];A++)if(v[4*((_+x)*o+(g+A))+3]>0){const O=1<<31-A%32;R[P*x+(A>>5)]|=O,A<B&&(B=A),A>I&&(I=A),D|=O}D&&(x<L&&(L=x),x>w&&(w=x))}T.bounds={dTop:(E[1]>>1)-L,dBottom:w-(E[1]>>1),dLeft:(E[0]>>1)-B,dRight:I-(E[0]>>1)},T.sprite=R,delete T.LT}}function initBoardWithShape(r){const{segmentation:{labels:e},boardSize:i,size:n}=r,o=i[0]>>5,l=new Array(o*n[1]).fill(0);for(let d=0;d<n[1];d++)for(let u=0;u<n[0];u++)if(e[d*n[0]+u]===0){const f=1<<31-u%32;l[o*d+(u>>5)]|=f}if(i[0]>n[0]){const d=(1<<i[0]-n[0])-1;for(let u=0;u<n[1];u++)l[o*u+o-1]|=d}return l}function filling(r,e,i){const{size:n,fillingTimes:o,fillingXStep:l,fillingYStep:d,getFillingFontStyle:u,getFillingFontWeight:f,getFillingFontFamily:g,fillingInitialFontSize:_,fillingDeltaFontSize:y,fillingInitialOpacity:b,fillingDeltaOpacity:S,fillingRotateList:v,getFillingPadding:A,random:x,board:T,minFillFontSize:C}=e,{boardSize:E,shapeBounds:P,tempCanvas:R,randomGenerator:L}=i,w=R.getContext("2d",{willReadFrequently:!0});let B=_,I=b;const D=[];for(let V=0;V<o;V++)O(B,I),B=Math.max(B>y?B-y:y,C),I=I>S?I-S:S;return D;function O(V,H){const F=r.map(he=>{const{text:fe,color:pe,fillingColor:me,hasPlaced:ee,datum:J}=he;return{x:0,y:0,weight:0,text:fe,fontFamily:g(J),fontStyle:u(J),fontWeight:f(J),fontSize:V,rotate:v[~~(L()*v.length)],padding:A(J),opacity:H,visible:!0,color:pe,fillingColor:me,hasPlaced:ee,datum:J}});N(F);let $=0;const{x1:G,y1:Y,x2:Q,y2:q}=P,[te,ue]=[G+~~(L()*l*2),Y+~~(L()*d*2)];for(let he=ue;he<=q;he+=d)for(let fe=te;fe<=Q;fe+=l){measureSprite(R,w,F,$);const pe=F[$];pe.x=fe,pe.y=he;const{wordSize:me,bounds:ee,hasPlaced:J}=pe;if(!J||!ee){++$===F.length&&($=0,x&&N(F));continue}const{dTop:ie,dBottom:le,dLeft:ce,dRight:j}=ee;pe.x-ce<0||pe.x+j>n[0]||pe.y-ie<0||pe.y+le>n[1]||pe.hasText&&pe.sprite&&!isCollideWithBoard(pe,T,E)&&(placeWordOnBoard(pe,T,E),D.push(Object.assign({},pe)),++$===F.length&&($=0,x&&N(F)))}}function N(V){return V.sort(()=>L()-.5)}}function cloud(r,e,i){allocateWords(r,i),e.layoutMode==="ensureMapping"?layoutGlobalShrink(r,e,i):e.layoutMode==="ensureMappingEnlarge"?layoutSelfEnlarge(r,e,i):layout(r,e,i);const n=filling(r,e,i),o=[],l=[];for(let d=0;d<r.length;d++)r[d].hasPlaced?l.push(r[d]):o.push(r[d]);return o.forEach(d=>d.visible=!1),{fillingWords:n,successedWords:l,failedWords:o}}const OUTPUT={x:"x",y:"y",fontFamily:"fontFamily",fontSize:"fontSize",fontStyle:"fontStyle",fontWeight:"fontWeight",angle:"angle",opacity:"opacity",visible:"visible",isFillingWord:"isFillingWord",color:"color"};class Layout{constructor(e,i){this.progressiveResult=[],this.options=e,this.view=i}layout(e){this.data=e;const i=this.options,n={shapeUrl:i.shape,size:i.size,ratio:i.ratio||.8,tempCanvas:void 0,boardSize:[0,0],random:!1,randomGenerator:void 0},o=vglobal.createCanvas({width:i.size[0],height:i.size[1]}),l=o.getContext("2d",{willReadFrequently:!0});l.textAlign="center",l.textBaseline="middle",n.tempCanvas=o;const d=i.size[0]+31>>5<<5;if(n.boardSize=[d,i.size[1]],n.random?n.randomGenerator=Math.random:n.randomGenerator=fakeRandom(),this.segmentationInput=n,isString(n.shapeUrl)){n.isEmptyPixel=generateIsEmptyPixel();const u=loadImage(n.shapeUrl);u?(this.isImageFinished=!1,this.isLayoutFinished=!1,u.then(f=>{this.isImageFinished=!0;const g=vglobal.createCanvas({width:i.size[0],height:i.size[1],dpr:1});n.maskCanvas=g;const _=g.getContext("2d");i.removeWhiteBorder&&removeBorder(f,g,n.isEmptyPixel);const y=scaleAndMiddleShape(f,i.size);_.clearRect(0,0,i.size[0],i.size[1]),_.drawImage(f,y.x,y.y,y.width,y.height),this.options.onUpdateMaskCanvas&&this.options.onUpdateMaskCanvas(n.maskCanvas)}).catch(f=>{this.isImageFinished=!0})):(this.isImageFinished=!0,this.isLayoutFinished=!0)}else if(n.shapeUrl&&(n.shapeUrl.type==="text"||n.shapeUrl.type==="geometric")){n.isEmptyPixel=generateIsEmptyPixel(n.shapeUrl.backgroundColor);const u=generateMaskCanvas(n.shapeUrl,i.size[0],i.size[1]);n.maskCanvas=u,this.options.onUpdateMaskCanvas&&this.options.onUpdateMaskCanvas(u),this.doLayout(),this.isImageFinished=!0,this.isLayoutFinished=!0}}canAnimate(){return!0}unfinished(){return!this.isLayoutFinished}output(){return this.progressiveResult}progressiveRun(){this.isImageFinished&&!this.isLayoutFinished&&(this.segmentationInput.maskCanvas&&this.doLayout(),this.isLayoutFinished=!0)}progressiveOutput(){return this.progressiveResult}doLayout(){var e,i,n,o,l,d,u,f,g,_,y,b,S,v,A,x,T,C,E,P,R,L;const w=this.segmentationInput,B=segmentation(w);if(!B.segmentation.regions.length)return;const I=this.options,D=this.data,O=I.colorMode||"ordinal",N={getText:field(I.text),getFontSize:field(I.fontSize),fontSizeRange:I.fontSizeRange,colorMode:O,getColor:I.colorField?field(I.colorField):field(I.text),getFillingColor:field(I.fillingColorField),colorList:I.colorList||(O==="ordinal"?["#2E62F1"]:["#537EF5","#2E62F1","#2358D8","#184FBF","#0C45A6","#013B8E"]),getColorHex:field(I.colorHexField),getFontFamily:field(I.fontFamily||"sans-serif"),rotateList:I.rotateList||[0],getPadding:field(I.padding||1),getFontStyle:field(I.fontStyle||"normal"),getFontWeight:field(I.fontWeight||"normal"),getFontOpacity:I.fontOpacity?field(I.fontOpacity):()=>1};initFontSizeScale(D,N,B);const V={size:I.size,ratio:I.ratio||.8,shapeUrl:I.shape,random:I.random===void 0||I.random,textLayoutTimes:(e=I.textLayoutTimes)!==null&&e!==void 0?e:3,removeWhiteBorder:I.removeWhiteBorder,layoutMode:(i=I.layoutMode)!==null&&i!==void 0?i:"default",fontSizeShrinkFactor:(n=I.fontSizeShrinkFactor)!==null&&n!==void 0?n:.8,stepFactor:(o=I.stepFactor)!==null&&o!==void 0?o:1,importantWordCount:(l=I.importantWordCount)!==null&&l!==void 0?l:10,globalShinkLimit:I.globalShinkLimit||.2,fontSizeEnlargeFactor:(d=I.fontSizeEnlargeFactor)!==null&&d!==void 0?d:1.5,fillingRatio:(u=I.fillingRatio)!==null&&u!==void 0?u:.7,fillingTimes:(f=I.fillingTimes)!==null&&f!==void 0?f:4,fillingXStep:I.fillingXRatioStep?Math.max(Math.floor(I.size[0]*I.fillingXRatioStep),1):(g=I.fillingXStep)!==null&&g!==void 0?g:4,fillingYStep:I.fillingYRatioStep?Math.max(Math.floor(I.size[1]*I.fillingYRatioStep),1):(_=I.fillingYStep)!==null&&_!==void 0?_:4,fillingInitialFontSize:I.fillingInitialFontSize,fillingDeltaFontSize:I.fillingDeltaFontSize,fillingInitialOpacity:(y=I.fillingInitialOpacity)!==null&&y!==void 0?y:.8,fillingDeltaOpacity:(b=I.fillingDeltaOpacity)!==null&&b!==void 0?b:.05,getFillingFontFamily:field(I.fillingFontFamily||"sans-serif"),getFillingFontStyle:field(I.fillingFontStyle||"normal"),getFillingFontWeight:field(I.fillingFontWeight||"normal"),getFillingPadding:field((S=I.fillingPadding)!==null&&S!==void 0?S:.4),fillingRotateList:(v=I.fillingRotateList)!==null&&v!==void 0?v:[0,90],fillingDeltaFontSizeFactor:(A=I.fillingDeltaFontSizeFactor)!==null&&A!==void 0?A:.2,fillingColorList:I.fillingColorList||["#537EF5"],sameColorList:!1,minInitFontSize:(x=I.minInitFontSize)!==null&&x!==void 0?x:10,minFontSize:(T=I.minFontSize)!==null&&T!==void 0?T:4,minFillFontSize:(C=I.minFillFontSize)!==null&&C!==void 0?C:2},H=colorListEqual(N.colorList,V.fillingColorList);V.sameColorList=H,initColorScale(D,N,V,I),initFillingWordsFontSize(D,N,V,B);const{getText:F,getFontFamily:$,getFontStyle:G,getFontWeight:Y,getPadding:Q,getColor:q,getFillingColor:te,getColorHex:ue,fontSizeScale:he,colorScale:fe,fillingColorScale:pe,getFontOpacity:me,rotateList:ee}=N,J=D.map(X=>{var se,ge;return{x:0,y:0,weight:0,text:F(X),fontFamily:$(X),fontWeight:Y(X),fontStyle:G(X),rotate:ee[~~(w.randomGenerator()*ee.length)],fontSize:Math.max(V.minInitFontSize,~~he(X)),opacity:me(X),padding:Q(X),color:ue&&ue(X)||fe&&fe(q(X))||"black",fillingColor:!te||((se=I.colorField)===null||se===void 0?void 0:se.field)===((ge=I.fillingColorField)===null||ge===void 0?void 0:ge.field)&&H?void 0:ue&&ue(X)||pe&&pe(te(X))||"black",datum:X,visible:!0,hasPlaced:!1}}),ie=maxInArray(J.map(X=>X.fontSize));J.forEach(X=>X.weight=X.fontSize/ie),J.sort((X,se)=>se.weight-X.weight);const{fillingWords:le,successedWords:ce,failedWords:j}=cloud(J,V,B),W=(P=(E=I.text)===null||E===void 0?void 0:E.field)!==null&&P!==void 0?P:"textKey",K=(R=I.dataIndexKey)!==null&&R!==void 0?R:"defaultDataIndexKey",ne=I.as?Object.assign(Object.assign({},OUTPUT),I.as):OUTPUT;let re,ae;const z=[];for(let X=0;X<J.length;++X)re=J[X],ae=re.datum,ae[ne.x]=re.x,ae[ne.y]=re.y,ae[ne.fontFamily]=re.fontFamily,ae[ne.fontSize]=re.fontSize,ae[ne.fontStyle]=re.fontStyle,ae[ne.fontWeight]=re.fontWeight,ae[ne.angle]=degreeToRadian(re.rotate),ae[ne.opacity]=re.opacity,ae[ne.visible]=re.visible,ae[ne.isFillingWord]=!1,ae[ne.color]=re.color,ae[K]=`${re.text}_${X}_keyword`,z.push(ae);const U=[];if(le.forEach((X,se)=>{var ge,de;const Z=Object.assign({},X.datum);Z[ne.x]=X.x,Z[ne.y]=X.y,Z[ne.fontFamily]=X.fontFamily,Z[ne.fontSize]=X.fontSize,Z[ne.fontStyle]=X.fontStyle,Z[ne.fontWeight]=X.fontWeight,Z[ne.angle]=degreeToRadian(X.rotate),Z[ne.opacity]=X.opacity,Z[ne.visible]=X.visible,Z[ne.isFillingWord]=!0,Z[ne.color]=te?((ge=I.colorField)===null||ge===void 0?void 0:ge.field)===((de=I.fillingColorField)===null||de===void 0?void 0:de.field)&&H?X.color:X.fillingColor:V.fillingColorList[~~(w.randomGenerator()*V.fillingColorList.length)],Z[W]=X.text,Z[K]=`${X.text}_${se}_fillingWords`,U.push(Z)}),this.view&&this.view.emit){this.view.emit(WORDCLOUD_SHAPE_HOOK_EVENT.AFTER_WORDCLOUD_SHAPE_LAYOUT,{successedWords:ce,failedWords:j});const X=(L=this.view.renderer)===null||L===void 0?void 0:L.stage();X&&X.hooks.afterRender.tap(WORDCLOUD_SHAPE_HOOK_EVENT.AFTER_WORDCLOUD_SHAPE_DRAW,()=>{this.view.emit(WORDCLOUD_SHAPE_HOOK_EVENT.AFTER_WORDCLOUD_SHAPE_DRAW,{successedWords:ce,failedWords:j}),X.hooks.afterRender.unTap(WORDCLOUD_SHAPE_HOOK_EVENT.AFTER_WORDCLOUD_SHAPE_DRAW)})}this.progressiveResult=z.concat(U)}release(){this.segmentationInput=null,this.data=null,this.progressiveResult=null,this.options=null}}const initColorScale=(r,e,i,n)=>{var o,l,d,u;const{colorMode:f,getColor:g,getFillingColor:_}=e,{sameColorList:y}=i;let b,S,v=e.colorList,A=i.fillingColorList;if(f==="ordinal"){const x=r.map(T=>g(T));if(b=T=>new OrdinalScale().domain(x).range(v).scale(T),_&&(((o=n.colorField)===null||o===void 0?void 0:o.field)!==((l=n.fillingColorField)===null||l===void 0?void 0:l.field)||!y)){const T=r.map(C=>_(C));S=C=>new OrdinalScale().domain(T).range(A).scale(C)}}else{v.length===1&&(v=[v[0],v[0]]);const x=new LinearScale().domain(extent(g,r)).range(v);if(b=T=>x.scale(T),_&&(((d=n.colorField)===null||d===void 0?void 0:d.field)!==((u=n.fillingColorField)===null||u===void 0?void 0:u.field)||!y)){A.length===1&&(A=[A[0],A[0]]);const T=new LinearScale().domain(extent(_,r)).range(A);S=C=>T.scale(C)}}Object.assign(e,{colorScale:b,fillingColorScale:S})},initFontSizeScale=(r,e,i)=>{let{fontSizeRange:n}=e;const{getFontSize:o,getText:l}=e;let d;if(o){if(o&&n){const u=new SqrtScale().domain(extent(o,r)).range(n);d=f=>u.scale(o(f))}else if(o&&isFunction(o)&&!n){const[f,g]=extent(o,r),_=r.map(S=>({text:l(S),value:o(S),weight:g===f?1:(o(S)-f)/(g-f)})),y=getInitialFontSize(_,i,!0);n=[~~(.5*y),~~y];const b=new SqrtScale().domain(extent(o,r)).range(n);d=S=>b.scale(o(S))}}else{const u=r.map(g=>({text:l(g)})),f=getInitialFontSize(u,i,!1);d=functor(f)}Object.assign(e,{getFontSize:o,fontSizeRange:n,fontSizeScale:d})},getInitialFontSize=(r,e,i)=>{const n=e.shapeArea,o=e.ratio,l=e.segmentation.regions,d=Math.ceil(Math.sqrt(n)/12),u=r.reduce((g,_)=>{const y=calTextLength(_.text);return y<d?g+y*(i?(.5+.5*_.weight)**2:1):g},0);if(u===0)return 12;let f=20;if(l.length===1)f=Math.sqrt(o*(n/(1.7*u)));else{const g=[];for(let _=0;_<l.length;_++){const y=l[_].area,b=l[_].ratio,S=y/n;if(S<.1)continue;const v=S*(u*(b<1?2.7-b:1.7)),A=Math.sqrt(o*(y/v));g.push(A)}f=g.length?Math.min(...g):Math.sqrt(o*(n/(1.7*u)))}return f};function initFillingWordsFontSize(r,e,i,n){const{getText:o}=e;let{fillingInitialFontSize:l,fillingDeltaFontSize:d}=i;const{fillingRatio:u}=i,f=Math.ceil(Math.sqrt(n.shapeArea)/4);if(!l||!d){const g=u/100,_=r.reduce((b,S)=>{const v=calTextLength(o(S));return v>f?b:b+v},0)/r.length;let y;if(_===0)y=8;else{const b=.2*n.shapeArea;y=Math.sqrt(g*(b/_))}l=~~y,d=y*i.fillingDeltaFontSizeFactor,Object.assign(i,{fillingInitialFontSize:l,fillingDeltaFontSize:d})}}const extent=(r,e)=>{let i=1/0,n=-1/0;const o=e.length;let l;for(let d=0;d<o;++d)l=toNumber(r(e[d])),l<i&&(i=l),l>n&&(n=l);return e.length===1&&i===n&&(i-=1e4),[i,n]},field=r=>r?typeof r=="string"||typeof r=="number"?()=>r:isFunction(r)?r:e=>e[r.field]:null,transform$2=(r,e,i,n)=>{if(!r.size||isNil(r.size[0])||isNil(r.size[1])||r.size[0]<=0||r.size[1]<=0)return Logger.getInstance().info("Wordcloud size dimensions must be greater than 0"),[];if(r.size=[Math.ceil(r.size[0]),Math.ceil(r.size[1])],r.shape||error("WordcloudShape shape must be specified."),r.text||error("WordcloudShape text must be specified."),n!=null&&n.emit&&n.emit(WORDCLOUD_SHAPE_HOOK_EVENT.BEFORE_WORDCLOUD_SHAPE_LAYOUT),!e||e.length===0)return[];const o=new Layout(r,n);return o.layout(e),o.unfinished()?{progressive:o}:o.output()},registerWordCloudShapeTransforms=()=>{Factory.registerTransform("wordcloudShape",{transform:transform$2,markPhase:"beforeJoin"},!0)};class WordCloudSeries extends BaseWordCloudSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.wordCloud}}WordCloudSeries.type=SeriesTypeEnum.wordCloud;const registerWordCloudSeries=()=>{registerWordCloudTransforms(),registerTextMark(),registerWordCloudAnimation(),Factory$1.registerSeries(WordCloudSeries.type,WordCloudSeries)},registerWordCloudShapeSeries=()=>{registerWordCloudShapeTransforms(),registerWordCloudTransforms(),registerTextMark(),registerWordCloudAnimation(),Factory$1.registerSeries(WordCloudSeries.type,WordCloudSeries)};class WordCloud3dSeries extends BaseWordCloudSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.wordCloud3d}_wordCloudTransformOption(){var e;return Object.assign(Object.assign({},super._wordCloudTransformOption()),{postProjection:(e=this._spec.postProjection)!==null&&e!==void 0?e:"StereographicProjection",depth_3d:this._spec.depth_3d})}_wordCloudShapeTransformOption(){var e;return Object.assign(Object.assign({},super._wordCloudShapeTransformOption()),{postProjection:(e=this._spec.postProjection)!==null&&e!==void 0?e:"StereographicProjection",depth_3d:this._spec.depth_3d})}initMark(){this._wordMark=this._createMark(BaseWordCloudSeries.mark.word,{groupKey:this._seriesField,isSeriesMark:!0},{support3d:!0})}initMarkStyle(){super.initMarkStyle();const e=this._wordMark;e&&this.setMarkStyle(e,{z:i=>{var n;return(n=i.z)!==null&&n!==void 0?n:0}},"normal",AttributeLevel.Series)}initAnimation(){var e,i;const n=(e=this._padding)!==null&&e!==void 0?e:{};this._wordMark&&this._wordMark.setAnimationConfig(animationConfig((i=Factory$1.getAnimationInKey("wordCloud3d"))===null||i===void 0?void 0:i(()=>{var o;const l=this.getCompiler().getVGrammarView(),d=l.width()-n.left||0-n.right||0,u=l.height()-n.top||0-n.bottom||0,f=Math.max(d,u)/2;return{center:{x:f,y:f,z:(o=this._spec.depth_3d)!==null&&o!==void 0?o:f},r:f}}),userAnimationConfig("word",this._spec,this._markAttributeContext)))}}WordCloud3dSeries.type=SeriesTypeEnum.wordCloud3d;const registerWordCloud3dSeries=()=>{registerWordCloudTransforms(),registerTextMark(),registerWordCloud3dAnimation(),Factory$1.registerSeries(WordCloud3dSeries.type,WordCloud3dSeries)},registerWordCloudShape3dSeries=()=>{registerWordCloudShapeTransforms(),registerWordCloudTransforms(),registerTextMark(),registerWordCloud3dAnimation(),Factory$1.registerSeries(WordCloud3dSeries.type,WordCloud3dSeries)},funnel=(r,e)=>{var i,n;const o=r.map(R=>Object.assign({},R));if(!o||o.length===0)return o;const{valueField:l,asTransformRatio:d,asReachRatio:u,asHeightRatio:f,asValueRatio:g,asNextValueRatio:_,asLastValueRatio:y,asLastValue:b,asCurrentValue:S,asNextValue:v,heightVisual:A=!1,isCone:x=!0,range:T}=e,C=o.reduce((R,L)=>Math.max(R,Number.parseFloat(L[l])||-1/0),-1/0),E=o.reduce((R,L)=>Math.min(R,Number.parseFloat(L[l])||1/0),1/0),P=[(i=T==null?void 0:T.min)!==null&&i!==void 0?i:E,(n=T==null?void 0:T.max)!==null&&n!==void 0?n:C];return o.forEach((R,L)=>{var w,B;const I=Number.parseFloat(R[l]),D=Number.parseFloat((w=o[L-1])===null||w===void 0?void 0:w[l]),O=Number.parseFloat((B=o[L+1])===null||B===void 0?void 0:B[l]),N=isValidNumber(O*I)&&I!==0?O/I:0,V=isValidNumber(I*D)&&D!==0?I/D:0;b&&(R[b]=D),v&&(R[v]=O),d&&(R[d]=N),u&&(R[u]=L===0?1:V),f&&(R[f]=A===!0?N:1/o.length),g&&(R[g]=I/P[1]),_&&(R[_]=L===o.length-1?x?0:R[g]:O/P[1]),y&&(R[y]=L===0?1:D/P[1]),S&&(R[S]=I)}),o},funnelTransform=(r,e)=>{var i,n;const o=(n=(i=r[0])===null||i===void 0?void 0:i.latestData)===null||n===void 0?void 0:n.map(l=>Object.assign({},l));return o&&o.length!==0&&(o.shift(),o.forEach(l=>{l[e.asIsTransformLevel]=!0})),o},FUNNEL_TRANSFORM_RATIO=`${PREFIX}_FUNNEL_TRANSFORM_RATIO`,FUNNEL_REACH_RATIO=`${PREFIX}_FUNNEL_REACH_RATIO`,FUNNEL_HEIGHT_RATIO=`${PREFIX}_FUNNEL_HEIGHT_RATIO`,FUNNEL_VALUE_RATIO=`${PREFIX}_FUNNEL_VALUE_RATIO`,FUNNEL_LAST_VALUE_RATIO=`${PREFIX}_FUNNEL_LAST_VALUE_RATIO`,FUNNEL_NEXT_VALUE_RATIO=`${PREFIX}_FUNNEL_NEXT_VALUE_RATIO`,FUNNEL_LAST_VALUE=`${PREFIX}_FUNNEL_LAST_VALUE`,FUNNEL_CURRENT_VALUE=`${PREFIX}_FUNNEL_CURRENT_VALUE`,FUNNEL_NEXT_VALUE=`${PREFIX}_FUNNEL_NEXT_VALUE`,FUNNEL_TRANSFORM_LEVEL=`${PREFIX}_FUNNEL_TRANSFORM_LEVEL`,FUNNEL_LABEL_LINE_LENGTH=20,FUNNEL_LABEL_SPACE_WIDTH=5,FUNNEL_MAX_SIZE="80%",FUNNEL_MIN_SIZE=0;class FunnelSeriesTooltipHelper extends BaseSeriesTooltipHelper{constructor(){super(...arguments),this.dimensionTooltipTitleCallback=(e,i)=>{var n,o,l;const d=this.series;return((n=i==null?void 0:i.mark)===null||n===void 0?void 0:n.name)==="transform"?"":(o=this._getDimensionData(e))!==null&&o!==void 0?o:(l=e.properties)===null||l===void 0?void 0:l[`${d.getCategoryField()}`]},this.markTooltipValueCallback=(e,i)=>{var n;return((n=i==null?void 0:i.mark)===null||n===void 0?void 0:n.name)==="transform"?`${(100*(e==null?void 0:e[FUNNEL_REACH_RATIO])).toFixed(1)}%`:this._getMeasureData(e)},this.markTooltipKeyCallback=(e,i)=>{var n;if(((n=i==null?void 0:i.mark)===null||n===void 0?void 0:n.name)==="transform")return"";const{dimensionFields:o,seriesFields:l}=this._seriesCacheInfo,d=o[o.length-1];return isValid(l[0])?e==null?void 0:e[l[0]]:e==null?void 0:e[d]}}}class BasePolygonMark extends BaseMark{_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{points:[]})}}class PolygonMark extends BasePolygonMark{constructor(){super(...arguments),this.type=PolygonMark.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{lineWidth:0})}}PolygonMark.type="polygon";const registerPolygonMark=()=>{Factory$1.registerMark(PolygonMark.type,PolygonMark),registerPolygonGraphic(),registerVGrammarPolygonAnimation()},funnelSeriesMark=Object.assign(Object.assign({},baseSeriesMark),{funnel:{name:"funnel",type:"polygon"},transform:{name:"transform",type:"polygon"},transformLabel:{name:"transformLabel",type:"text"},outerLabel:{name:"outerLabel",type:"text"},outerLabelLine:{name:"outerLabelLine",type:"rule"}}),funnel3dSeriesMark=Object.assign(Object.assign({},baseSeriesMark),{funnel3d:{name:"funnel3d",type:"pyramid3d"},transform3d:{name:"transform3d",type:"pyramid3d"},transformLabel:{name:"transformLabel",type:"text"},outerLabel:{name:"outerLabel",type:"text"},outerLabelLine:{name:"outerLabelLine",type:"rule"}});class FunnelSeriesSpecTransformer extends BaseSeriesSpecTransformer{_transformLabelSpec(e){this._addMarkLabelSpec(e,"funnel"),e.isTransform&&this._addMarkLabelSpec(e,"transform","transformLabel")}}class FunnelSeries extends BaseSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.funnel,this._funnelMarkName="funnel",this._funnelMarkType="polygon",this._transformMarkName="transform",this._transformMarkType="polygon",this.transformerConstructor=FunnelSeriesSpecTransformer,this._funnelMark=null,this._funnelTransformMark=null,this._labelMark=null,this._transformLabelMark=null,this._funnelOuterLabelMark={}}getCategoryField(){return this._categoryField}setCategoryField(e){return this._categoryField=e,this._categoryField}getValueField(){return this._valueField}setValueField(e){return this._valueField=e,this._valueField}setAttrFromSpec(){var e,i,n,o,l;super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this._funnelOrient=(e=this._spec.funnelOrient)!==null&&e!==void 0?e:"top",this._shape=(i=this._spec.shape)!==null&&i!==void 0?i:"trapezoid",this._minLabelLineWidth=(l=(o=(n=this._spec.outerLabel)===null||n===void 0?void 0:n.line)===null||o===void 0?void 0:o.minLength)!==null&&l!==void 0?l:FUNNEL_LABEL_LINE_LENGTH,this._isHorizontal()?this._funnelAlign=["top","bottom"].includes(this._spec.funnelAlign)?this._spec.funnelAlign:"center":this._funnelAlign=["left","right"].includes(this._spec.funnelAlign)?this._spec.funnelAlign:"center",!this._seriesField&&this._spec.categoryField&&this.setSeriesField(this._spec.categoryField)}initData(){if(super.initData(),!this._data)return;registerDataSetInstanceTransform(this._dataSet,"funnel",funnel),registerDataSetInstanceTransform(this._dataSet,"funnelTransform",funnelTransform);const e=new DataView(this._dataSet,{name:`${PREFIX}_series_${this.id}_viewDataTransform`});e.parse([this.getViewData()],{type:"dataview"}),this._viewDataTransform=new SeriesData(this._option,e)}compileData(){var e;super.compileData(),(e=this._viewDataTransform)===null||e===void 0||e.compile()}getStatisticFields(){const e=[];return e.push({key:this._categoryField,operations:["values"]}),e.push({key:this._valueField,operations:["max","min"]}),e}_statisticViewData(){var e,i,n,o,l,d,u,f,g;super._statisticViewData(),this._data.getDataView().transform({type:"funnel",options:{valueField:this.getValueField(),isCone:this._spec.isCone,asCurrentValue:FUNNEL_CURRENT_VALUE,asTransformRatio:FUNNEL_TRANSFORM_RATIO,asReachRatio:FUNNEL_REACH_RATIO,asHeightRatio:FUNNEL_HEIGHT_RATIO,asValueRatio:FUNNEL_VALUE_RATIO,asNextValueRatio:FUNNEL_NEXT_VALUE_RATIO,asLastValueRatio:FUNNEL_LAST_VALUE_RATIO,asLastValue:FUNNEL_LAST_VALUE,asNextValue:FUNNEL_NEXT_VALUE,range:{min:(i=(e=this._spec.range)===null||e===void 0?void 0:e.min)!==null&&i!==void 0?i:(o=(n=this.getViewDataStatistics().latestData)===null||n===void 0?void 0:n[this.getValueField()])===null||o===void 0?void 0:o.min,max:(d=(l=this._spec.range)===null||l===void 0?void 0:l.max)!==null&&d!==void 0?d:(f=(u=this.getViewDataStatistics().latestData)===null||u===void 0?void 0:u[this.getValueField()])===null||f===void 0?void 0:f.max}}}),(g=this._viewDataTransform.getDataView())===null||g===void 0||g.transform({type:"funnelTransform",options:{asIsTransformLevel:FUNNEL_TRANSFORM_LEVEL}})}initMark(){var e,i,n,o,l,d,u,f,g,_,y,b;if(this._funnelMark=this._createMark(Object.assign(Object.assign({},FunnelSeries.mark.funnel),{name:this._funnelMarkName,type:this._funnelMarkType}),{themeSpec:(e=this._theme)===null||e===void 0?void 0:e.funnel,groupKey:this._seriesField,isSeriesMark:!0,stateSort:(i=this._spec.funnel)===null||i===void 0?void 0:i.stateSort,noSeparateStyle:!0},{setCustomizedShape:(n=this._spec.funnel)===null||n===void 0?void 0:n.customShape,morph:shouldMarkDoMorph(this._spec,this._funnelMarkName),morphElementKey:this._seriesField}),this._spec.isTransform&&(this._funnelTransformMark=this._createMark(Object.assign(Object.assign({},FunnelSeries.mark.transform),{name:this._transformMarkName,type:this._transformMarkType}),{themeSpec:(o=this._theme)===null||o===void 0?void 0:o.transform,skipBeforeLayouted:!1,dataView:this._viewDataTransform.getDataView(),dataProductId:this._viewDataTransform.getProductId(),stateSort:(l=this._spec.transform)===null||l===void 0?void 0:l.stateSort,noSeparateStyle:!0},{setCustomizedShape:(d=this._spec.transform)===null||d===void 0?void 0:d.customShape})),(f=(u=this._spec)===null||u===void 0?void 0:u.outerLabel)===null||f===void 0?void 0:f.visible){const{line:S}=(g=this._spec.outerLabel)!==null&&g!==void 0?g:{},{line:v}=(y=(_=this._theme)===null||_===void 0?void 0:_.outerLabel)!==null&&y!==void 0?y:{};this._funnelOuterLabelMark.label=this._createMark(FunnelSeries.mark.outerLabel,{themeSpec:(b=this._theme)===null||b===void 0?void 0:b.outerLabel,markSpec:this._spec.outerLabel,skipBeforeLayouted:!0,noSeparateStyle:!0}),this._funnelOuterLabelMark.line=this._createMark(FunnelSeries.mark.outerLabelLine,{themeSpec:v,markSpec:S,depend:[this._funnelOuterLabelMark.label],noSeparateStyle:!0})}}initTooltip(){this._tooltipHelper=new FunnelSeriesTooltipHelper(this),this._funnelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._funnelMark),this._funnelTransformMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._funnelTransformMark)}getDimensionField(){return this._seriesField?[this._seriesField]:[]}getMeasureField(){return[this._valueField]}getGroupFields(){return null}initMarkStyle(){const e=this._funnelMark;e&&this.setMarkStyle(e,{points:l=>this.getPoints(l),visible:l=>isValid(l[this._valueField]),fill:this.getColorAttribute()},"normal",AttributeLevel.Series);const i=this._funnelTransformMark;i&&this.setMarkStyle(i,{points:l=>this.getPoints(l)},"normal",AttributeLevel.Series);const n=this._funnelOuterLabelMark.label;n&&(this.setMarkStyle(n,{text:l=>`${l[this.getCategoryField()]}`,x:l=>this._computeOuterLabelPosition(l).x,y:l=>this._computeOuterLabelPosition(l).y,textAlign:l=>this._computeOuterLabelPosition(l).align,textBaseline:l=>this._computeOuterLabelPosition(l).textBaseline,maxLineWidth:l=>this._computeOuterLabelLimit(l),width:0,height:0},"normal",AttributeLevel.Series),isFunction(this._spec.outerLabel.formatMethod)&&this.setMarkStyle(n,{text:l=>this._spec.outerLabel.formatMethod(`${l[this.getCategoryField()]}`,l)},"normal",AttributeLevel.User_Mark));const o=this._funnelOuterLabelMark.line;o&&n&&this.setMarkStyle(o,{x:l=>this._computeOuterLabelLinePosition(l).x1,y:l=>this._computeOuterLabelLinePosition(l).y1,x1:l=>this._computeOuterLabelLinePosition(l).x2,y1:l=>this._computeOuterLabelLinePosition(l).y2},"normal",AttributeLevel.Series)}initLabelMarkStyle(e){var i,n;if(!e)return;const o=e.getTarget(),l=e.getComponent();o===this._funnelMark?(this._labelMark=e,this.setMarkStyle(e,{text:d=>`${d[this.getCategoryField()]} ${d[this.getValueField()]}`,x:d=>this._computeLabelPosition(d).x,y:d=>this._computeLabelPosition(d).y,maxLineWidth:d=>this._computeLabelLimit(d,this._spec.label),stroke:this.getColorAttribute()},"normal",AttributeLevel.Series),!((i=this._funnelOuterLabelMark)===null||i===void 0)&&i.label&&this._funnelOuterLabelMark.label.setDepend(l),!((n=this._funnelOuterLabelMark)===null||n===void 0)&&n.line&&this._funnelOuterLabelMark.line.setDepend(...this._funnelOuterLabelMark.line.getDepend())):this._funnelTransformMark&&o===this._funnelTransformMark&&(this._transformLabelMark=e,this.setMarkStyle(e,{text:d=>`${(100*field$2(FUNNEL_REACH_RATIO).bind(this)(d)).toFixed(1)}%`,x:d=>this._computeLabelPosition(d).x,y:d=>this._computeLabelPosition(d).y,maxLineWidth:d=>this._computeLabelLimit(d,this._spec.transformLabel)},"normal",AttributeLevel.Series))}initAnimation(){var e,i,n,o,l,d,u;const f=(n=(i=(e=this._spec)===null||e===void 0?void 0:e.animationAppear)===null||i===void 0?void 0:i.preset)!==null&&n!==void 0?n:"clipIn";f==="clipIn"&&this._rootMark&&this._rootMark.setAnimationConfig(animationConfig((o=Factory$1.getAnimationInKey("cartesianGroupClip"))===null||o===void 0?void 0:o({direction:()=>this._isHorizontal()?"x":"y",width:()=>{const g=this.getRootMark().getProduct();if(g){const{x1:_,x2:y}=g.getBounds();return Math.max(_,y)}return this.getLayoutRect().width},height:()=>{const g=this.getRootMark().getProduct();if(g){const{y1:_,y2:y}=g.getBounds();return Math.max(_,y)}return this.getLayoutRect().height},orient:()=>this._isReverse()?"negative":"positive"},f),userAnimationConfig("group",this._spec,this._markAttributeContext))),[(l=this._funnelOuterLabelMark)===null||l===void 0?void 0:l.label].forEach(g=>{g&&g.setAnimationConfig(animationConfig(Factory$1.getAnimationInKey("fadeInOut")(),userAnimationConfig(g.name,this._spec,this._markAttributeContext)))}),[this._funnelMark,this._funnelTransformMark].forEach(g=>{g&&g.setAnimationConfig(animationConfig(Factory$1.getAnimationInKey("funnel")({},f),userAnimationConfig(g.name,this._spec,this._markAttributeContext)))}),!((d=this._funnelOuterLabelMark)===null||d===void 0)&&d.line&&this._funnelOuterLabelMark.line.setAnimationConfig(animationConfig((u=Factory$1.getAnimationInKey("fadeInOut"))===null||u===void 0?void 0:u(),userAnimationConfig("outerLabelLine",this._spec,this._markAttributeContext)))}initGroups(){}getStackGroupFields(){return[]}getStackValueField(){return null}initEvent(){var e;super.initEvent(),(e=this._viewDataTransform.getDataView())===null||e===void 0||e.target.addListener("change",i=>{this._viewDataTransform.updateData()})}getPoints(e){const i=this.isTransformLevel(e),n=this._getMainAxisLength(i)/2;let o,l;i?(o=this._shape==="rect"?this._getSecondaryAxisLength(e[FUNNEL_LAST_VALUE_RATIO])/2:this._getSecondaryAxisLength(e[FUNNEL_VALUE_RATIO])/2,l=this._getSecondaryAxisLength(e[FUNNEL_VALUE_RATIO])/2):(o=this._getSecondaryAxisLength(e[FUNNEL_VALUE_RATIO])/2,l=this._shape==="rect"?o:this._getSecondaryAxisLength(e[FUNNEL_NEXT_VALUE_RATIO])/2);const{x:d,y:u}=this._getPositionByData(e),f=this._getPolygonPoints([d,u],o,l,o,l,n);return this._funnelAlign!=="center"&&this._adjustPoints(f),f}isTransformLevel(e){return!!(e!=null&&e[FUNNEL_TRANSFORM_LEVEL])}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.valueToPosition=this.valueToPosition.bind(this),this._markAttributeContext.getPoints=this.getPoints.bind(this),this._markAttributeContext.isTransformLevel=this.isTransformLevel.bind(this)}valueToPosition(e){var i,n,o;const l=(o=(n=(i=this.getViewData())===null||i===void 0?void 0:i.latestData)===null||n===void 0?void 0:n.find)===null||o===void 0?void 0:o.call(n,d=>d[this._categoryField]===e);return isValid(l)?this._getPolygonCenter(this.getPoints(l)):null}dataToPosition(e,i){return i&&!this.isDatumInViewData(e)?null:this.valueToPosition(e[this._categoryField])}dataToPositionX(e){var i;return(i=this.dataToPosition(e))===null||i===void 0?void 0:i.x}dataToPositionY(e){var i;return(i=this.dataToPosition(e))===null||i===void 0?void 0:i.y}dataToPositionZ(e){return 0}_getMainAxisLength(e=!1){var i;const n=this.getViewData().latestData.length,o=this._isHorizontal()?this.getLayoutRect().width:this.getLayoutRect().height,l=!!this._spec.isTransform,d=l?0:(i=this._spec.gap)!==null&&i!==void 0?i:0,u=l?Math.max(0,n-1):0,f=this._spec.heightRatio||.5,g=(o-d*Math.max(0,n-1))/(n+f*u);return e?l?g*f:0:g}_getSecondaryAxisLength(e){const i=Number.isNaN(e)||!Number.isFinite(e)?0:e,n=this._computeMaxSize(),o=this._computeMinSize();return o+(n-o)*i}_getPositionByData(e){var i;const n=(i=this.getViewData().latestData)===null||i===void 0?void 0:i.findIndex(b=>b[this._categoryField]===e[this._categoryField]&&b[DEFAULT_DATA_KEY]===e[DEFAULT_DATA_KEY]);if(!isValid(n)||n<0)return{};const o=this.isTransformLevel(e),l=this._isHorizontal(),d=l?this.getLayoutRect().height:this.getLayoutRect().width,u=l?this.getLayoutRect().width:this.getLayoutRect().height,f=d/2;let g=0;const _=this._getMainAxisLength(),y=this._getMainAxisLength(!0);return g+=n*(_+y),g+=o?-y/2:_/2,!this._spec.isTransform&&this._spec.gap&&(g+=this._spec.gap*n),this._isReverse()&&(g=u-g),this._isHorizontal()?{x:g,y:f}:{x:f,y:g}}_getPolygonPoints(e,i,n,o,l,d){const u=e[0],f=e[1];switch(this._funnelOrient){case"left":return[{x:u-d,y:f+i},{x:u-d,y:f-o},{x:u+d,y:f-l},{x:u+d,y:f+n}];case"right":return[{x:u+d,y:f-o},{x:u+d,y:f+o},{x:u-d,y:f+n},{x:u-d,y:f-n}];case"bottom":return[{x:u+i,y:f+d},{x:u-o,y:f+d},{x:u-l,y:f-d},{x:u+n,y:f-d}];default:return[{x:u-i,y:f-d},{x:u+o,y:f-d},{x:u+l,y:f+d},{x:u-n,y:f+d}]}}_getPolygonCenter(e){if(this._isHorizontal()){const o=(e[0].x+e[3].x)/2,l=(e[0].y+e[3].y)/2;return{x:(o+(e[1].x+e[2].x)/2)/2,y:(l+(e[1].y+e[2].y)/2)/2}}const i=(e[0].x+e[3].x)/2,n=(e[0].y+e[3].y)/2;return{x:(i+(e[1].x+e[2].x)/2)/2,y:(n+(e[1].y+e[2].y)/2)/2}}_adjustPoints(e){let i,n,o;return this._isHorizontal()?(o="y",this._funnelOrient==="left"?(i=this._funnelAlign==="bottom"?-e[1].y:e[1].y,n=this._funnelAlign==="bottom"?-e[2].y:e[2].y):(i=this._funnelAlign==="bottom"?-e[0].y:e[0].y,n=this._funnelAlign==="bottom"?-e[3].y:e[3].y)):(o="x",this._funnelOrient==="top"?(i=this._funnelAlign==="left"?e[0].x:-e[0].x,n=this._funnelAlign==="left"?e[3].x:-e[3].x):(i=this._funnelAlign==="left"?e[1].x:-e[1].x,n=this._funnelAlign==="left"?e[2].x:-e[2].x)),e[0][o]-=i,e[1][o]-=i,e[2][o]-=n,e[3][o]-=n,e}_computeLabelPosition(e){const i=this.getPoints(e);return this._getPolygonCenter(i)}_computeLabelLimit(e,i){const n=i==null?void 0:i.limit;if(isNumber(n))return n;const o=this.getPoints(e);return n==="shapeSize"?this._isHorizontal()?Math.abs(o[3].x-o[0].x):(Math.abs(o[0].x-o[1].x)+Math.abs(o[2].x-o[3].x))/2:this._isHorizontal()?Math.abs(o[3].x-o[0].x):void 0}_computeOuterLabelPosition(e){var i,n;let o,l,d=(i=this._spec.outerLabel)===null||i===void 0?void 0:i.position,u="center",f="middle";if(d=this._isHorizontal()?["top","bottom"].includes(d)?d:this._funnelAlign==="bottom"?"top":"bottom":["left","right"].includes(d)?d:this._funnelAlign==="left"?"right":"left",((n=this._spec.outerLabel)===null||n===void 0?void 0:n.alignLabel)!==!1)({x:o,y:l}=this._getPositionByData(e)),d==="left"?(o=0,u="left"):d==="right"?(o=this.getLayoutRect().width,u="right"):d==="top"?(l=0,f="top"):d==="bottom"&&(l=this.getLayoutRect().height,f="bottom");else{const{x2:g,y2:_}=this._computeOuterLabelLinePosition(e);o=g,l=_,d==="left"?(o-=FUNNEL_LABEL_SPACE_WIDTH,u="right"):d==="right"?(o+=FUNNEL_LABEL_SPACE_WIDTH,u="left"):d==="top"?(l-=FUNNEL_LABEL_SPACE_WIDTH,f="bottom"):d==="bottom"&&(l+=FUNNEL_LABEL_SPACE_WIDTH,f="top")}return{x:o,y:l,align:u,textBaseline:f}}_computeOuterLabelLimit(e){var i,n,o,l,d,u,f;if(this._isHorizontal())return this._getMainAxisLength(this.isTransformLevel(e));const g=this.getPoints(e),_=(Math.abs(g[0].x-g[1].x)+Math.abs(g[2].x-g[3].x))/2,y=this.getCategoryField(),b=(d=(l=(o=(n=(i=this._labelMark)===null||i===void 0?void 0:i.getComponent())===null||n===void 0?void 0:n.getProduct())===null||o===void 0?void 0:o.getGroupGraphicItem())===null||l===void 0?void 0:l.find(({attribute:x,type:T})=>{var C;return T==="text"&&((C=x.data)===null||C===void 0?void 0:C[y])===e[y]},!0))===null||d===void 0?void 0:d.AABBBounds,S=b?b.x2-b.x1:0,v=this._funnelOuterLabelMark.line?this._minLabelLineWidth:0;let A=this.getLayoutRect().width-Math.max(_,S);return this._funnelAlign==="center"&&(A/=2),A-v-((f=(u=this._spec.outerLabel)===null||u===void 0?void 0:u.spaceWidth)!==null&&f!==void 0?f:FUNNEL_LABEL_SPACE_WIDTH)}_computeOuterLabelLinePosition(e){var i,n,o,l,d,u,f,g,_,y,b,S,v;const A=this.getCategoryField(),x=(d=(l=(o=(n=(i=this._funnelOuterLabelMark)===null||i===void 0?void 0:i.label)===null||n===void 0?void 0:n.getProduct())===null||o===void 0?void 0:o.elements)===null||l===void 0?void 0:l.find(O=>{var N;return((N=O.data[0])===null||N===void 0?void 0:N[A])===e[A]}))===null||d===void 0?void 0:d.getBounds(),T=(y=(_=(g=(f=(u=this._labelMark)===null||u===void 0?void 0:u.getComponent())===null||f===void 0?void 0:f.getProduct())===null||g===void 0?void 0:g.getGroupGraphicItem())===null||_===void 0?void 0:_.find(({attribute:O,type:N})=>{var V;return N==="text"&&((V=O.data)===null||V===void 0?void 0:V[A])===e[A]},!0))===null||y===void 0?void 0:y.AABBBounds,C=(b=this._spec.outerLabel)!==null&&b!==void 0?b:{};let E,P,R,L;if(this._isHorizontal()){const O=(S=C.spaceWidth)!==null&&S!==void 0?S:FUNNEL_LABEL_SPACE_WIDTH,N=this.getPoints(e),V=(Math.abs(N[0].y-N[1].y)+Math.abs(N[2].y-N[3].y))/2;return this._spec.outerLabel.position==="top"||this._funnelAlign==="bottom"?(R=this._getPolygonCenter(N).y-V/2-O,L=C.alignLabel!==!1?(x==null?void 0:x.y2)+O:R-O,E=this._getPolygonCenter(N).x,R-L<this._minLabelLineWidth&&(L=R-this._minLabelLineWidth),P=E):(R=this._getPolygonCenter(N).y+V/2+O,L=C.alignLabel!==!1?(x==null?void 0:x.y1)-O:R+O,E=this._getPolygonCenter(N).x,L-R<this._minLabelLineWidth&&(L=R+this._minLabelLineWidth),P=E),{x1:E,x2:P,y1:R,y2:L}}const w=this.getPoints(e),B=(Math.abs(w[0].x-w[1].x)+Math.abs(w[2].x-w[3].x))/2,I=(T==null?void 0:T.x2)-(T==null?void 0:T.x1)||0,D=(v=C.spaceWidth)!==null&&v!==void 0?v:FUNNEL_LABEL_SPACE_WIDTH;return this._spec.outerLabel.position==="right"||this._funnelAlign==="left"?(E=this._getPolygonCenter(w).x+Math.max(I/2,B/2)+D,P=C.alignLabel!==!1?(x==null?void 0:x.x1)-D:E+D,R=this._getPolygonCenter(w).y,P-E<this._minLabelLineWidth&&(P=E+this._minLabelLineWidth),L=R):(E=this._getPolygonCenter(w).x-Math.max(I/2,B/2)-D,P=C.alignLabel!==!1?(x==null?void 0:x.x2)+D:E-D,R=this._getPolygonCenter(w).y,E-P<this._minLabelLineWidth&&(P=E-this._minLabelLineWidth),L=R),{x1:E,x2:P,y1:R,y2:L}}_computeMaxSize(){var e;const i=this._isHorizontal()?this.getLayoutRect().height:this.getLayoutRect().width,n=(e=this._spec.maxSize)!==null&&e!==void 0?e:FUNNEL_MAX_SIZE;return calcLayoutNumber(n,i)}_computeMinSize(){var e;const i=this._isHorizontal()?this.getLayoutRect().height:this.getLayoutRect().width,n=(e=this._spec.minSize)!==null&&e!==void 0?e:FUNNEL_MIN_SIZE;return calcLayoutNumber(n,i)}_isHorizontal(){return this._funnelOrient==="left"||this._funnelOrient==="right"}_isReverse(){return this._funnelOrient==="bottom"||this._funnelOrient==="right"}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._funnelMark]}}FunnelSeries.type=SeriesTypeEnum.funnel,FunnelSeries.mark=funnelSeriesMark,FunnelSeries.transformerConstructor=FunnelSeriesSpecTransformer;const registerFunnelSeries=()=>{registerPolygonMark(),registerTextMark(),registerRuleMark(),Factory$1.registerSeries(FunnelSeries.type,FunnelSeries),Factory$1.registerAnimation("funnel",(r,e)=>Object.assign({appear:e==="clipIn"?void 0:{type:"fadeIn"}},FadeInOutAnimation)),registerCartesianGroupClipAnimation(),registerFadeInOutAnimation()};class Pyramid3dMark extends BasePolygonMark{constructor(){super(...arguments),this.type=Pyramid3dMark.type}}Pyramid3dMark.type="pyramid3d";const registerPyramid3dMark=()=>{Factory$1.registerMark(Pyramid3dMark.type,Pyramid3dMark),registerPyramid3dGraphic(),registerVGrammarPolygonAnimation()};class Funnel3dSeriesSpecTransformer extends FunnelSeriesSpecTransformer{_transformLabelSpec(e){this._addMarkLabelSpec(e,"funnel3d"),e.isTransform&&this._addMarkLabelSpec(e,"transform3d","transformLabel")}}class Funnel3dSeries extends FunnelSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.funnel3d,this._funnelMarkName="funnel3d",this._funnelMarkType="pyramid3d",this._transformMarkName="transform3d",this._transformMarkType="pyramid3d",this.transformerConstructor=Funnel3dSeriesSpecTransformer}initMark(){var e,i,n,o,l,d,u,f;if(this._funnelMark=this._createMark(Object.assign(Object.assign({},Funnel3dSeries.mark.funnel3d),{name:this._funnelMarkName,type:this._funnelMarkType}),{themeSpec:(e=this._theme)===null||e===void 0?void 0:e.funnel3d,key:this._seriesField,isSeriesMark:!0},{support3d:!0}),this._spec.isTransform&&(this._funnelTransformMark=this._createMark(Object.assign(Object.assign({},Funnel3dSeries.mark.transform3d),{name:this._transformMarkName,type:this._transformMarkType}),{themeSpec:(i=this._theme)===null||i===void 0?void 0:i.transform3d,key:this._seriesField,skipBeforeLayouted:!1,dataView:this._viewDataTransform.getDataView(),dataProductId:this._viewDataTransform.getProductId()})),(o=(n=this._spec)===null||n===void 0?void 0:n.outerLabel)===null||o===void 0?void 0:o.visible){const{line:g}=(l=this._spec.outerLabel)!==null&&l!==void 0?l:{},{line:_}=(u=(d=this._theme)===null||d===void 0?void 0:d.outerLabel)!==null&&u!==void 0?u:{};this._funnelOuterLabelMark.label=this._createMark(Funnel3dSeries.mark.outerLabel,{themeSpec:(f=this._theme)===null||f===void 0?void 0:f.outerLabel,key:this._seriesField,markSpec:this._spec.outerLabel}),this._funnelOuterLabelMark.line=this._createMark(Funnel3dSeries.mark.outerLabelLine,{themeSpec:_,key:this._seriesField,markSpec:g,depend:[this._funnelOuterLabelMark.label]})}}initMarkStyle(){super.initMarkStyle();const e=this._funnelMark;e&&this.setMarkStyle(e,{z:i=>{if(this._isHorizontal())return 0;const n=this.getPoints(i),o=Math.max(Math.abs(n[0].x-n[1].x),Math.abs(n[2].x-n[3].x));return(this._computeMaxSize()-o)/2}},"normal",AttributeLevel.Series)}initLabelMarkStyle(e){var i,n;super.initLabelMarkStyle(e),this.setMarkStyle(e,{z:o=>{if(this._isHorizontal())return 0;const l=this.getPoints(o),d=Math.max(Math.abs(l[0].x-l[1].x),Math.abs(l[2].x-l[3].x));return(this._computeMaxSize()-d)/2}},"normal",AttributeLevel.Series),this._labelMark=e,!((i=this._funnelOuterLabelMark)===null||i===void 0)&&i.label&&this._funnelOuterLabelMark.label.setDepend(e.getComponent()),!((n=this._funnelOuterLabelMark)===null||n===void 0)&&n.line&&this._funnelOuterLabelMark.line.setDepend(...this._funnelOuterLabelMark.line.getDepend())}}Funnel3dSeries.type=SeriesTypeEnum.funnel3d,Funnel3dSeries.mark=funnel3dSeriesMark,Funnel3dSeries.transformerConstructor=Funnel3dSeriesSpecTransformer;const registerFunnel3dSeries=()=>{registerPyramid3dMark(),registerTextMark(),registerRuleMark(),Factory$1.registerSeries(Funnel3dSeries.type,Funnel3dSeries)},computeRatio=(r,e)=>{const i=(r-e[0])/(e[1]-e[0]||1);return Math.max(0,Math.min(1,i))},getInnerMostElements=r=>{const e=r.mark.elements.filter(n=>n.diffState===DiffState.update),i=minInArray(e.map(n=>{var o;return(o=n==null?void 0:n.data)===null||o===void 0?void 0:o[0].depth}));return e.filter(n=>{var o;return((o=n==null?void 0:n.data)===null||o===void 0?void 0:o[0].depth)===i})},computeInnerAngleRange$1=(r,e,i)=>isEmpty(r)?[e,i]:[minInArray(r.map(n=>1*n.getGraphicAttribute("startAngle",!1))),maxInArray(r.map(n=>1*n.getGraphicAttribute("endAngle",!1)))],sunburstEnter=r=>({channel:{startAngle:{from:(e,i)=>{const{startAngle:n,endAngle:o}=r.animationInfo(),l=getInnerMostElements(i),d=computeInnerAngleRange$1(l,n,o);return computeRatio(e.startAngle,d)*(o-n)+n},to:e=>e.startAngle},endAngle:{from:(e,i)=>{const{startAngle:n,endAngle:o}=r.animationInfo(),l=getInnerMostElements(i),d=computeInnerAngleRange$1(l,n,o);return computeRatio(e.endAngle,d)*(o-n)+n},to:e=>e.endAngle},outerRadius:{from:e=>e.innerRadius,to:e=>e.outerRadius},innerRadius:{from:e=>e.innerRadius,to:e=>e.innerRadius}}}),computeInnerAngleRange=r=>[minInArray(r.map(e=>1*e.getGraphicAttribute("startAngle",!1))),maxInArray(r.map(e=>1*e.getGraphicAttribute("endAngle",!1)))],sunburstExit=r=>({channel:{startAngle:{from:(e,i)=>i.getGraphicAttribute("startAngle",!1),to:(e,i)=>{const{startAngle:n,endAngle:o}=r.animationInfo(),l=getInnerMostElements(i),d=computeInnerAngleRange(l);return computeRatio(i.getGraphicAttribute("startAngle",!1),d)*(o-n)+n}},endAngle:{from:(e,i)=>i.getGraphicAttribute("endAngle",!1),to:(e,i)=>{const{startAngle:n,endAngle:o}=r.animationInfo(),l=getInnerMostElements(i),d=computeInnerAngleRange(l);return computeRatio(i.getGraphicAttribute("endAngle",!1),d)*(o-n)+n}},outerRadius:{from:(e,i)=>i.getGraphicAttribute("outerRadius",!1),to:()=>r.animationInfo().innerRadius},innerRadius:{from:(e,i)=>i.getGraphicAttribute("innerRadius",!1),to:()=>r.animationInfo().innerRadius}}}),sunburstPresetAnimation=(r,e)=>{switch(e){case"fadeIn":return{type:"fadeIn"};case"growAngle":return{type:"growAngleIn"};default:return{type:"growRadiusIn"}}},registerSunburstAnimation=()=>{Factory$1.registerAnimation("sunburst",(r,e)=>({appear:sunburstPresetAnimation(r,e),enter:sunburstEnter(r),exit:sunburstExit(r),disappear:sunburstExit(r)}))},flattenNodes=(r,e=[],i)=>{const n=(i==null?void 0:i.maxDepth)>=0;return r.forEach(o=>{(!n||o.depth<=i.maxDepth)&&(e.push(i!=null&&i.callback?i.callback(o):o),o.children&&(n&&o.depth===i.maxDepth?(o.children=null,o.isLeaf=!0):flattenNodes(o.children,e,i)))}),e};function binary(r,e,i,n,o){const l=r.children,d=l.length;let u=0;const f=new Array(d+1);f[0]=0;for(let _=0;_<d;++_)u+=l[_].value,f[_+1]=u;const g=(_,y,b,S,v,A,x)=>{if(_>=y-1){const w=l[_];return w.x0=S,w.y0=v,w.x1=A,void(w.y1=x)}const T=f[_],C=b/2+T;let E=_+1,P=y-1;for(;E<P;){const w=E+P>>>1;f[w]<C?E=w+1:P=w}C-f[E-1]<f[E]-C&&_+1<E&&--E;const R=f[E]-T,L=b-R;if(A-S>x-v){const w=b?(S*L+A*R)/b:A;g(_,E,R,S,v,w,x),g(E,y,L,w,v,A,x)}else{const w=b?(v*L+x*R)/b:x;g(_,E,R,S,v,A,w),g(E,y,L,S,w,A,x)}};g(0,d,r.value,e,i,n,o)}function dice(r,e,i,n,o,l={x0:"x0",x1:"x1",y0:"y0",y1:"y1"}){const d=r.children;let u,f=-1;const g=d.length,_=r.value&&(n-e)/r.value;for(;++f<g;)u=d[f],u[l.y0]=i,u[l.y1]=o,u[l.x0]=e,u[l.x1]=e+=u.value*_}function slice(r,e,i,n,o){const l=r.children;let d,u=-1;const f=l.length,g=r.value&&(o-i)/r.value;for(;++u<f;)d=l[u],d.x0=e,d.x1=n,d.y0=i,i+=d.value*g,d.y1=i}function sliceDice(r,e,i,n,o){(r.depth%2==1?slice:dice)(r,e,i,n,o)}function squarifyRatio(r,e,i,n,o,l){const d=[],u=e.children;let f,g,_=0,y=0;const b=u.length;let S,v,A,x,T,C,E,P,R,L=e.value;for(;_<b;){S=o-i,v=l-n;do A=u[y++].value;while(!A&&y<b);for(x=A,T=A,P=Math.max(v/S,S/v)/(L*r),R=A*A*P,E=Math.max(T/R,R/x);y<b;++y){if(g=u[y].value,A+=g,g<x&&(x=g),g>T&&(T=g),R=A*A*P,C=Math.max(T/R,R/x),C>E){A-=g;break}E=C}f=Object.assign({},e,{value:A,children:u.slice(_,y)}),d.push(f),S<v?dice(f,i,n,o,L?n+=v*A/L:l):slice(f,i,n,L?i+=S*A/L:o,l),L-=A,_=y}return d}const generateSquarify=r=>(e,i,n,o,l)=>{squarifyRatio(r,e,i,n,o,l)},calculateNodeValue$1=(r,e,i=0,n=-1,o,l,d="value")=>{let u=0,f=n??-1,g=i;return r.forEach((_,y)=>{var b,S;const v={flattenIndex:++f,key:l?l(_):`${(b=o==null?void 0:o.key)!==null&&b!==void 0?b:""}-${y}`,maxDepth:-1,depth:i,index:y,value:_[d],isLeaf:!0,datum:o?o.datum.concat(_):[_],parentKey:o==null?void 0:o.key};if(!((S=_.children)===null||S===void 0)&&S.length){v.children=[],v.isLeaf=!1;const A=calculateNodeValue$1(_.children,v.children,i+1,f,v,l,d);v.value=isNil(_[d])?A.sum:Math.max(A.sum,toValidNumber$1(_[d])),f=A.flattenIndex,g=Math.max(A.maxDepth,g)}else v.isLeaf=!0,v.value=toValidNumber$1(_[d]);u+=Math.abs(v.value),e.push(v)}),{sum:u,maxDepth:g,flattenIndex:f}},eachBefore=(r,e,i,n)=>{let o=n;return r.forEach((l,d)=>{var u;o=e(l,d,i,o),!((u=l.children)===null||u===void 0)&&u.length&&(o=eachBefore(l.children,e,l,o))}),n},eachAfter=(r,e,i,n)=>{let o=n;return r.forEach((l,d)=>{var u;!((u=l.children)===null||u===void 0)&&u.length&&(o=eachAfter(l.children,e,l,o)),o=e(l,d,i,o)}),o},algorithms={binary,dice,slice,sliceDice};class TreemapLayout{constructor(e){var i;this._filterByArea=(l,d)=>{var u;const f=this._getMinAreaByDepth(l.depth);if(f>0&&l.value*d<f)return!1;if(!((u=l.children)===null||u===void 0)&&u.length){const g=l.children.filter(_=>this._filterByArea(_,d));g.length?g.length!==l.children.length&&(l.children=g):(l.isLeaf=!0,l.children=null)}return!0},this._getMinAreaByDepth=l=>{var d;return l<0?0:(d=isArray(this.options.minVisibleArea)?this.options.minVisibleArea[l]:this.options.minVisibleArea)!==null&&d!==void 0?d:0},this._getGapWidthByDepth=l=>{var d;return l<0?0:(d=isArray(this.options.gapWidth)?this.options.gapWidth[l]:this.options.gapWidth)!==null&&d!==void 0?d:0},this._getPaddingByDepth=l=>{var d;return l<0?0:(d=isArray(this.options.padding)?this.options.padding[l]:this.options.padding)!==null&&d!==void 0?d:0},this._getLabelPaddingByDepth=l=>{var d;return l<0?0:(d=isArray(this.options.labelPadding)?this.options.labelPadding[l]:this.options.labelPadding)!==null&&d!==void 0?d:0},this._layoutNode=l=>{const d=this._getGapWidthByDepth(l.depth);let u=l.x0,f=l.y0,g=l.x1,_=l.y1;if(l.maxDepth=this._maxDepth,d>0&&(u+=d/2,g-=d/2,f+=d/2,_-=d/2,u>g&&(u=(u+g)/2,g=u),f>_&&(f=(f+_)/2,_=f),l.x0=u,l.x1=g,l.y0=f,l.y1=_),l.children){const y=this._getLabelPaddingByDepth(l.depth),b=this._getPaddingByDepth(l.depth);b>0&&b<Math.min(g-u,_-f)/2&&(f+=b,_-=b,u+=b,g-=b),y>0&&(this.options.labelPosition==="top"&&f+y<_?(l.labelRect={x0:u,y0:f,x1:g,y1:f+y},f+=y):this.options.labelPosition==="bottom"&&_-y>f?(l.labelRect={x0:u,y0:_-y,x1:g,y1:_},_-=y):this.options.labelPosition==="left"&&u+y<g?(l.labelRect={x0:u,y0:f,x1:u+y,y1:_},u+=y):this.options.labelPosition==="right"&&g-y>u&&(l.labelRect={x0:g-y,y0:f,x1:g,y1:_},g-=y));const S=this._getGapWidthByDepth(l.depth+1);S>0&&(u-=S/2,g+=S/2,f-=S/2,_+=S/2),this._splitNode(l,u,f,g,_)}},this.options=Object.assign({},TreemapLayout.defaultOpionts,e);const n=this.options.nodeKey,o=isFunction(n)?n:n?field$3(n):null;this._getNodeKey=o,this._splitNode=this.options.splitType==="squarify"?generateSquarify(this.options.aspectRatio):(i=algorithms[this.options.splitType])!==null&&i!==void 0?i:algorithms.binary,this._maxDepth=-1}layout(e,i){var n;if(!e||!e.length)return[];const o="width"in i?{x0:0,x1:i.width,y0:0,y1:i.height,width:i.width,height:i.height}:{x0:Math.min(i.x0,i.x1),x1:Math.max(i.x0,i.x1),y0:Math.min(i.y0,i.y1),y1:Math.max(i.y0,i.y1),width:Math.abs(i.x1-i.x0),height:Math.abs(i.y1-i.y0)},l=[],d=calculateNodeValue$1(e,l,0,-1,null,this._getNodeKey,this.options.valueField);if(this._maxDepth=d.maxDepth,d.sum<=0)return[];const u={flattenIndex:-1,maxDepth:-1,key:"-1",depth:-1,index:-1,value:d.sum,datum:null,x0:o.x0,x1:o.x1,y0:o.y0,y1:o.y1,children:l},f=o.width*o.height/d.sum;return this._filterByArea(u,f),this._layout(u),(n=u.children)!==null&&n!==void 0?n:[]}_filterChildren(e){const i=this.options.maxDepth;if(isNumber(i)&&i>=0&&e.depth>=i)return!1;const n=this.options.minChildrenVisibleArea;if(isNumber(n)&&Math.abs((e.x1-e.x0)*(e.y1-e.y0))<n)return!1;const o=this.options.minChildrenVisibleSize;return!isNumber(o)||!(Math.abs(e.x1-e.x0)<o||Math.abs(e.y1-e.y0)<o)}_layout(e){var i;this._filterChildren(e)||(e.children=null,e.isLeaf=!0),this._layoutNode(e),!((i=e.children)===null||i===void 0)&&i.length&&e.children.forEach(n=>{var o;!((o=n==null?void 0:n.children)===null||o===void 0)&&o.length?this._layout(n):this._layoutNode(n)})}}TreemapLayout.defaultOpionts={aspectRatio:(1+Math.sqrt(5))/2,gapWidth:0,labelPadding:0,labelPosition:"top",splitType:"binary",minVisibleArea:10};const transform$1=(r,e)=>{const i=new TreemapLayout(r).layout(e,"width"in r?{width:r.width,height:r.height}:{x0:r.x0,x1:r.x1,y0:r.y0,y1:r.y1});if(r.flatten){const n=[];return flattenNodes(i,n,{maxDepth:r==null?void 0:r.maxDepth}),n}return i},keyMap={x0:"startAngle",x1:"endAngle",y0:"innerRadius",y1:"outerRadius"};class SunburstLayout{constructor(e){this._layoutNode=o=>{if(o.maxDepth=this._maxDepth,o.children){const l=this._parsedInnerRadius[o.depth+1],d=this._parsedOutterRadius[o.depth+1];dice(o,o.startAngle,Math.min(l,d),o.endAngle,Math.max(l,d),keyMap);const u=isArray(this.options.label)?this.options.label[o.depth+1]:this.options.label;o.children.forEach(f=>{if(f.x=this._parsedCenter[0],f.y=this._parsedCenter[1],u)return this._layoutLabel(f,isBoolean(u)?{align:"center",rotate:"radial"}:u)})}},this.options=e?Object.assign({},SunburstLayout.defaultOpionts,e):Object.assign({},SunburstLayout.defaultOpionts);const i=this.options.nodeKey,n=isFunction(i)?i:i?field$3(i):null;this._getNodeKey=n,this._maxDepth=-1}_parseRadius(e,i){const n=e.x0+toPercent(this.options.center[0],e.width),o=e.y0+toPercent(this.options.center[1],e.height),l=Math.min(e.width/2,e.height/2),d=this.options.innerRadius,u=this.options.outerRadius,f=isArray(d),g=f?d.map(v=>toPercent(v,l)):toPercent(d,l),_=isArray(u),y=this.options.gapRadius,b=_?u.map(v=>toPercent(v,l)):toPercent(u,l),S=range(0,i+1);if(f)this._parsedInnerRadius=S.map((v,A)=>{const x=g[A];return isNil(x)?l:x}),this._parsedOutterRadius=S.map((v,A)=>{var x,T;return _?(x=b[A])!==null&&x!==void 0?x:l:A<i?this._parsedInnerRadius[A+1]-(isArray(y)?(T=y[A])!==null&&T!==void 0?T:0:y):b});else if(_)this._parsedOutterRadius=S.map((v,A)=>isNil(b[A])?l:b[A]),this._parsedInnerRadius=S.map((v,A)=>{var x;return A===0?g:this._parsedOutterRadius[A-1]-(isArray(y)?(x=y[A])!==null&&x!==void 0?x:0:y)});else{const v=toPercent(d,l),A=(b-v)/(i+1);this._parsedInnerRadius=S.map((x,T)=>v+T*A),this._parsedOutterRadius=S.map((x,T)=>{var C;return this._parsedInnerRadius[T]+A-(isArray(y)?(C=y[T])!==null&&C!==void 0?C:0:y)})}this._parsedCenter=[n,o],this._maxRadius=l}layout(e,i){const n="width"in i?{x0:0,x1:i.width,y0:0,y1:i.height,width:i.width,height:i.height}:{x0:Math.min(i.x0,i.x1),x1:Math.max(i.x0,i.x1),y0:Math.min(i.y0,i.y1),y1:Math.max(i.y0,i.y1),width:Math.abs(i.x1-i.x0),height:Math.abs(i.y1-i.y0)};if(!e||!e.length)return[];const o=[],l=calculateNodeValue$1(e,o,0,-1,null,this._getNodeKey);return this._parseRadius(n,l.maxDepth),this._maxDepth=l.maxDepth,this._layout(o,{flattenIndex:-1,maxDepth:-1,key:"-1",depth:-1,index:-1,value:l.sum,datum:null,children:o,startAngle:this.options.startAngle,endAngle:this.options.endAngle}),o}_layout(e,i){this._layoutNode(i),e.forEach(n=>{var o;!((o=n==null?void 0:n.children)===null||o===void 0)&&o.length?this._layout(n.children,n):this._layoutNode(n)})}_layoutLabel(e,i){var n;const o=(e.startAngle+e.endAngle)/2,l=(i.align==="start"?e.innerRadius:i.align==="end"?e.outerRadius:(e.innerRadius+e.outerRadius)/2)+((n=i.offset)!==null&&n!==void 0?n:0),d=polarToCartesian({x:this._parsedCenter[0],y:this._parsedCenter[1]},l,o);if(e.label={x:d.x,y:d.y,textBaseline:"middle"},i.rotate==="tangential")e.label.angle=o-Math.PI/2,e.label.textAlign="center",e.label.maxLineWidth=Math.abs(e.endAngle-e.startAngle)*l;else{const u=o%(2*Math.PI),f=u<0?u+2*Math.PI:u;f>Math.PI/2&&f<1.5*Math.PI?(e.label.angle=f+Math.PI,e.label.textAlign=i.align==="start"?"end":i.align==="end"?"start":"center"):(e.label.angle=f,e.label.textAlign=i.align),e.label.maxLineWidth=e.isLeaf?void 0:Math.abs(e.outerRadius-e.innerRadius)}}}SunburstLayout.defaultOpionts={startAngle:Math.PI/2,endAngle:-3*Math.PI/2,center:["50%","50%"],gapRadius:0,innerRadius:0,outerRadius:"70%"};const a=1664525,c=1013904223,m=4294967296;function randomLCG(r=1){let e=r;return()=>(e=(a*e+c)%m)/m}function packEncloseRandom(r,e){let i=0;const n=shuffleArray(Array.from(r),e),o=n.length;let l,d,u=[];for(;i<o;)l=n[i],d&&enclosesWeak(d,l)?++i:(u=extendBasis(u,l),d=encloseBasis(u),i=0);return d}function extendBasis(r,e){let i,n;if(enclosesWeakAll(e,r))return[e];for(i=0;i<r.length;++i)if(enclosesNot(e,r[i])&&enclosesWeakAll(encloseBasis2(r[i],e),r))return[r[i],e];for(i=0;i<r.length-1;++i)for(n=i+1;n<r.length;++n)if(enclosesNot(encloseBasis2(r[i],r[n]),e)&&enclosesNot(encloseBasis2(r[i],e),r[n])&&enclosesNot(encloseBasis2(r[n],e),r[i])&&enclosesWeakAll(encloseBasis3(r[i],r[n],e),r))return[r[i],r[n],e];Logger.getInstance().error("error when packEncloseRandom")}function enclosesNot(r,e){const i=r.radius-e.radius,n=e.x-r.x,o=e.y-r.y;return i<0||i*i<n*n+o*o}function enclosesWeak(r,e){const i=r.radius-e.radius+1e-9*Math.max(r.radius,e.radius,1),n=e.x-r.x,o=e.y-r.y;return i>0&&i*i>n*n+o*o}function enclosesWeakAll(r,e){for(let i=0;i<e.length;++i)if(!enclosesWeak(r,e[i]))return!1;return!0}function encloseBasis(r){switch(r.length){case 1:return encloseBasis1(r[0]);case 2:return encloseBasis2(r[0],r[1]);case 3:return encloseBasis3(r[0],r[1],r[2])}}function encloseBasis1(r){return{x:r.x,y:r.y,radius:r.radius}}function encloseBasis2(r,e){const i=r.x,n=r.y,o=r.radius,l=e.x,d=e.y,u=e.radius,f=l-i,g=d-n,_=u-o,y=Math.sqrt(f*f+g*g);return{x:(i+l+f/y*_)/2,y:(n+d+g/y*_)/2,radius:(y+o+u)/2}}function encloseBasis3(r,e,i){const n=r.x,o=r.y,l=r.radius,d=e.x,u=e.y,f=e.radius,g=i.x,_=i.y,y=i.radius,b=n-d,S=n-g,v=o-u,A=o-_,x=f-l,T=y-l,C=n*n+o*o-l*l,E=C-d*d-u*u+f*f,P=C-g*g-_*_+y*y,R=S*v-b*A,L=(v*P-A*E)/(2*R)-n,w=(A*x-v*T)/R,B=(S*E-b*P)/(2*R)-o,I=(b*T-S*x)/R,D=w*w+I*I-1,O=2*(l+L*w+B*I),N=L*L+B*B-l*l,V=-(Math.abs(D)>1e-6?(O+Math.sqrt(O*O-4*D*N))/(2*D):N/O);return{x:n+L+w*V,y:o+B+I*V,radius:V}}function place(r,e,i){const n=r.x-e.x;let o,l;const d=r.y-e.y;let u,f;const g=n*n+d*d;g?(l=e.radius+i.radius,l*=l,f=r.radius+i.radius,f*=f,l>f?(o=(g+f-l)/(2*g),u=Math.sqrt(Math.max(0,f/g-o*o)),i.x=r.x-o*n-u*d,i.y=r.y-o*d+u*n):(o=(g+l-f)/(2*g),u=Math.sqrt(Math.max(0,l/g-o*o)),i.x=e.x+o*n-u*d,i.y=e.y+o*d+u*n)):(i.x=e.x+i.radius,i.y=e.y)}function intersects(r,e){const i=r.radius+e.radius-1e-6,n=e.x-r.x,o=e.y-r.y;return i>0&&i*i>n*n+o*o}function score(r){const e=r._,i=r.next._,n=e.radius+i.radius,o=(e.x*i.radius+i.x*e.radius)/n,l=(e.y*i.radius+i.y*e.radius)/n;return o*o+l*l}function getCicleNode(r){return{_:r,next:null,prev:null}}function packSiblingsRandom(r,e){const i=(r=array(r)).length;if(!i)return 0;let n=r[0];if(n.x=0,n.y=0,i===1)return n.radius;const o=r[1];if(n.x=-o.radius,o.x=n.radius,o.y=0,i===2)return n.radius+o.radius;let l=r[2];place(o,n,l);let d,u,f,g,_,y,b,S=getCicleNode(n),v=getCicleNode(o),A=getCicleNode(l);S.next=v,A.prev=v,v.next=A,S.prev=A,A.next=S,v.prev=S;for(let T=3;T<i;++T){b=!1,l=r[T],place(S._,v._,l),A=getCicleNode(l),d=v.next,u=S.prev,f=v._.radius,g=S._.radius;do if(f<=g){if(intersects(d._,A._)){v=d,S.next=v,v.prev=S,--T,b=!0;break}f+=d._.radius,d=d.next}else{if(intersects(u._,A._)){S=u,S.next=v,v.prev=S,--T,b=!0;break}g+=u._.radius,u=u.prev}while(d!==u.next);if(!b){for(A.prev=S,A.next=v,S.next=v.prev=v=A,_=score(S),A=A.next;A!==v;)y=score(A),y<_&&(S=A,_=y),A=A.next;v=S.next}}const x=[v._];for(A=v.next;A!==v;)x.push(A._),A=A.next;l=packEncloseRandom(x,e);for(let T=0;T<i;++T)n=r[T],n.x-=l.x,n.y-=l.y;return l.radius}function radiusLeaf(r){return function(e){e.children||(e.radius=Math.max(0,+r(e)||0))}}function packChildrenRandom(r,e,i){return function(n){const o=n==null?void 0:n.children;if(o){let l;const d=o.length,u=r(n)*e||0;if(u)for(l=0;l<d;++l)o[l].radius+=u;const f=packSiblingsRandom(o,i);if(u)for(l=0;l<d;++l)o[l].radius-=u;n.radius=f+u}}}function translateChild(r,e){return function(i,n,o){i.radius*=r,i.maxDepth=e,o&&(i.x=o.x+r*i.x,i.y=o.y+r*i.y)}}class CirclePackingLayout{constructor(e){this.options=e;const i=e==null?void 0:e.nodeKey,n=isFunction(i)?i:i?field$3(i):null;this._getNodeKey=n,this._getPadding=isNumber(e==null?void 0:e.padding)?o=>e.padding:isArray(e==null?void 0:e.padding)?o=>{var l;return(l=e.padding[o.depth+1])!==null&&l!==void 0?l:0}:()=>0,this._maxDepth=-1}layout(e,i){var n;const o="width"in i?{x0:0,x1:i.width,y0:0,y1:i.height,width:i.width,height:i.height}:{x0:Math.min(i.x0,i.x1),x1:Math.max(i.x0,i.x1),y0:Math.min(i.y0,i.y1),y1:Math.max(i.y0,i.y1),width:Math.abs(i.x1-i.x0),height:Math.abs(i.y1-i.y0)};if(!e||!e.length)return[];const l=[],d=calculateNodeValue$1(e,l,0,-1,null,this._getNodeKey);this._maxDepth=d.maxDepth;const u=randomLCG(),f={flattenIndex:-1,maxDepth:-1,key:"root",depth:-1,index:-1,value:d.sum,datum:null,children:l,x:o.x0+o.width/2,y:o.y0+o.height/2},{nodeSort:g,setRadius:_,padding:y,includeRoot:b}=(n=this.options)!==null&&n!==void 0?n:{};if(g!==!1){const S=isFunction(g)?this.options.nodeKey:CirclePackingLayout.defaultOpionts.nodeSort;eachBefore([f],v=>{v.children&&v.children.length&&v.children.sort(S)})}if(_)eachBefore([f],radiusLeaf(_)),eachAfter([f],packChildrenRandom(this._getPadding,.5,u)),eachBefore([f],translateChild(1,this._maxDepth));else{const S=Math.min(o.width,o.height);eachBefore([f],radiusLeaf(CirclePackingLayout.defaultOpionts.setRadius)),eachAfter([f],packChildrenRandom(zero,1,u)),y&&eachAfter([f],packChildrenRandom(this._getPadding,f.radius/S,u)),eachBefore([f],translateChild(S/(2*f.radius),this._maxDepth))}return b?[f]:l}}CirclePackingLayout.defaultOpionts={setRadius:r=>Math.sqrt(r.value),padding:0,nodeSort:(r,e)=>e.value-r.value};const registerTreemapTransforms=()=>{Factory.registerTransform("treemap",{transform:transform$1,markPhase:"beforeJoin"},!0)},flatten=(r,e={})=>{if(!r)return[];const i=[];return flattenNodes(r,i,e),i},sunburstLayout=(r,e)=>{if(!r)return r;const i=e(),{width:n,height:o}=i;return new SunburstLayout(i).layout(r,{width:n,height:o})},SUNBURST_AUTO_VISIBLE_DEFAULT_THRESHOLD=10;class SunburstTooltipHelper extends BaseSeriesTooltipHelper{constructor(){super(...arguments),this.markTooltipKeyCallback=e=>e==null?void 0:e[this.series.getDimensionField()[0]]}}var DrillEnum;(function(r){r.DrillDown="drillDown",r.DrillUp="drillUp"})(DrillEnum||(DrillEnum={}));const drillFilter=(r,e)=>{const i=e.info(),n=e.keyField(),o=i==null?void 0:i.key;if(isNil(o))return r;if(i.type===DrillEnum.DrillDown){const l=findHierarchyNode(r,o,n,"children");return array(l)}if(i.type===DrillEnum.DrillUp){const l=findHierarchyNodeParent(r,o,n,"children");if(l)return array(l)}return r};class Drillable{_getDrillTriggerEvent(e){var i;const{mode:n}=this._drillParams;return(i=getDefaultTriggerEventByMode(n))===null||i===void 0?void 0:i[e]}_hideTooltip(){const e=this.getChart().getComponentsByType(ComponentTypeEnum.tooltip)[0];e&&e.hideTooltip()}initDrillable(e){this._drillParams=e}initDrillableData(e){const{getRawData:i}=this._drillParams;registerDataSetInstanceTransform(e,"drillFilter",drillFilter),i().transform({type:"drillFilter",options:{info:()=>this._drillInfo,keyField:()=>this._drillParams.drillField()}})}bindDrillEvent(){const{event:e,getRawData:i,drillField:n}=this._drillParams,o=n();this._getDrillTriggerEvent("start")&&e.on(this._getDrillTriggerEvent("start"),l=>{var d,u,f;if(isNil(l.datum)||isNil((d=l.datum)===null||d===void 0?void 0:d[o]))return void this.drillUp();this._hideTooltip();const g=l.datum[o],_=(f=(u=this._drillInfo)===null||u===void 0?void 0:u.path)!==null&&f!==void 0?f:[],y=findHierarchyPath(i().rawData,g,o,"children");_[_.length-1]===y[y.length-1]?this.drillUp():this.drillDown(y)})}drillDown(e=[]){const{getRawData:i,event:n}=this._drillParams;if(!isArray(e)||isEmpty(e))return e;const o=e[e.length-1];return this._drillInfo={key:o,path:e,type:DrillEnum.DrillDown},i().reRunAllTransform(),n.emit(ChartEvent.drill,{value:{path:e,type:DrillEnum.DrillDown},model:this}),e}drillUp(){var e,i;const{getRawData:n,event:o}=this._drillParams,l=(i=(e=this._drillInfo)===null||e===void 0?void 0:e.path)!==null&&i!==void 0?i:[];if(!isArray(l)||isEmpty(l))return l;const d=l.pop();return this._drillInfo={key:d,path:l,type:DrillEnum.DrillUp},n().reRunAllTransform(),o.emit(ChartEvent.drill,{value:{path:l,type:DrillEnum.DrillUp},model:this}),l}}const sunburstSeriesMark=Object.assign(Object.assign({},baseSeriesMark),{sunburst:{name:"sunburst",type:"arc"}}),appendHierarchyFields=(r,e,i)=>(r.push({key:e,operations:["values"]}),r.push({key:i,operations:["max","min"]}),r.push({key:DEFAULT_HIERARCHY_DEPTH,operations:["max","min","values"]}),r.push({key:DEFAULT_HIERARCHY_ROOT,operations:["values"]}),r);class SunburstSeries extends PolarSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.sunburst}setCategoryField(e){return this._categoryField=e,this._categoryField}getCategoryField(){return this._categoryField}setValueField(e){return this._valueField=e,this._valueField}getValueField(){return this._valueField}getDimensionField(){return[this._categoryField]}getMeasureField(){return[this._valueField]}setAttrFromSpec(){var e;super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField((e=this._spec.seriesField)!==null&&e!==void 0?e:DEFAULT_HIERARCHY_ROOT),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:()=>{var i;return(i=this._spec.drillField)!==null&&i!==void 0?i:DEFAULT_DATA_KEY},getRawData:()=>this.getRawData()}),this._startAngle=degreeToRadian(this._spec.startAngle),this._endAngle=degreeToRadian(this._spec.endAngle),this._centerX=this._spec.centerX,this._centerY=this._spec.centerY,this._offsetX=this._spec.offsetX,this._offsetY=this._spec.offsetY,this.__innerRadius=this._spec.innerRadius,this.__outerRadius=this._spec.outerRadius,this._gap=this._spec.gap,this._labelLayout=this._spec.labelLayout,this._sunburst=this._spec.sunburst,this._label=this._spec.label,this._labelAutoVisible=this._spec.labelAutoVisible}initData(){super.initData();const e=this.getRawData();e&&(this._spec.drill&&this.initDrillableData(this._dataSet),registerDataSetInstanceTransform(this._dataSet,"sunburstLayout",sunburstLayout),registerDataSetInstanceTransform(this._dataSet,"flatten",flatten),e.transform({type:"sunburstLayout",options:()=>{const{innerRadius:i,outerRadius:n,gap:o,label:l}=this._computeLevel();return{nodeKey:this._categoryField,width:this.getLayoutRect().width,height:this.getLayoutRect().height,center:[isValid(this._centerX)?this._centerX:this.getLayoutRect().width/2,isValid(this._centerY)?this._centerY:this.getLayoutRect().height/2],startAngle:this._startAngle,endAngle:this._endAngle,innerRadius:i,outerRadius:n,gapRadius:o,label:l}}}),e.transform({type:"flatten",options:{callback:i=>{if(i.datum){const n=i.datum[i.depth];return Object.assign(Object.assign({},i),n)}return i}}}))}getStatisticFields(){return appendHierarchyFields(super.getStatisticFields(),this._categoryField,this._valueField)}_addDataIndexAndKey(){const e=this.getRawData();isNil(e==null?void 0:e.dataSet)||(registerDataSetInstanceTransform(e.dataSet,"addVChartProperty",addVChartProperty),e.transform({type:"addVChartProperty",options:{beforeCall:initHierarchyKeyMap.bind(this),call:addHierarchyDataKey}}))}initMark(){this._initArcMark(),this._initLabelMark()}initMarkStyle(){this._initArcMarkStyle(),this._initLabelMarkStyle()}_initArcMark(){var e,i;if(this._sunburst.visible===!1)return;const n=this._createMark(SunburstSeries.mark.sunburst,{isSeriesMark:!0,stateSort:(e=this._spec.sunburst)===null||e===void 0?void 0:e.stateSort},{setCustomizedShape:(i=this._spec.sunburst)===null||i===void 0?void 0:i.customShape});this._sunburstMark=n}_initArcMarkStyle(){isNil(this._sunburstMark)||this.setMarkStyle(this._sunburstMark,{x:e=>e.x+(isValid(this._offsetX)?this._offsetX:0),y:e=>e.y+(isValid(this._offsetY)?this._offsetY:0),outerRadius:e=>e.outerRadius,innerRadius:e=>e.innerRadius,startAngle:e=>e.startAngle,endAngle:e=>e.endAngle,fill:this.getColorAttribute()},STATE_VALUE_ENUM.STATE_NORMAL,AttributeLevel.Series)}_initLabelMark(){if(this._label.visible!==!0)return;const e=this._createMark(SunburstSeries.mark.label,{isSeriesMark:!1});this._labelMark=e}_initLabelMarkStyle(){isNil(this._labelMark)||this.setMarkStyle(this._labelMark,{visible:e=>{var i;const n=this._labelAutoVisible;return isObject$1(n)&&n.enable===!0?(e.endAngle-e.startAngle)*(e.outerRadius-e.innerRadius)>((i=n==null?void 0:n.circumference)!==null&&i!==void 0?i:SUNBURST_AUTO_VISIBLE_DEFAULT_THRESHOLD):this._spec.label.visible},x:e=>{var i;return((i=e.label)===null||i===void 0?void 0:i.x)+(isValid(this._offsetX)?this._offsetX:0)},y:e=>{var i;return((i=e.label)===null||i===void 0?void 0:i.y)+(isValid(this._offsetY)?this._offsetY:0)},textBaseline:e=>{var i;return(i=e.label)===null||i===void 0?void 0:i.textBaseline},textAlign:e=>{var i;return(i=e.label)===null||i===void 0?void 0:i.textAlign},angle:e=>{var i,n;return(n=(i=e.label)===null||i===void 0?void 0:i.angle)!==null&&n!==void 0?n:0},fontSize:10,text:e=>e.name},STATE_VALUE_ENUM.STATE_NORMAL,AttributeLevel.Series)}initTooltip(){this._tooltipHelper=new SunburstTooltipHelper(this),this._sunburstMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._sunburstMark),this._labelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._labelMark)}initAnimation(){var e,i;const n={animationInfo:()=>({innerRadius:this._computeRadius(array(this.__innerRadius))[0],outerRadius:this._computeRadius(array(this.__outerRadius))[0],startAngle:array(this._startAngle)[0],endAngle:array(this._endAngle)[0]})},o=(i=(e=this._spec)===null||e===void 0?void 0:e.animationAppear)===null||i===void 0?void 0:i.preset;this.getMarksInType("arc").forEach(l=>{var d;l.setAnimationConfig(animationConfig((d=Factory$1.getAnimationInKey("sunburst"))===null||d===void 0?void 0:d(n,o),userAnimationConfig(l.name,this._spec,this._markAttributeContext)))}),this.getMarksInType("text").forEach(l=>{var d;l.setAnimationConfig(animationConfig((d=Factory$1.getAnimationInKey("fadeInOut"))===null||d===void 0?void 0:d(),userAnimationConfig(l.name,this._spec,this._markAttributeContext)))})}initEvent(){super.initEvent(),this._spec.drill&&this.bindDrillEvent()}onLayoutEnd(e){super.onLayoutEnd(e),this._rawData.reRunAllTransform()}_computeRadius(e){return isArray(e)?e.map(i=>this._computeLayoutRadius()*i):this._computeLayoutRadius()*e}_computeLevel(){return{innerRadius:this._computeRadius(this.__innerRadius),outerRadius:this._computeRadius(this.__outerRadius),gap:this._gap,label:this._labelLayout}}getGroupFields(){return[]}getStackGroupFields(){return[]}getStackValueField(){return""}_noAnimationDataKey(e,i){}getActiveMarks(){return[this._sunburstMark]}getMarkData(e){return e!=null&&e.datum?e.datum[e.datum.length-1]:e}}SunburstSeries.type=SeriesTypeEnum.sunburst,SunburstSeries.mark=sunburstSeriesMark,mixin(SunburstSeries,Drillable);const registerSunBurstSeries=()=>{Factory$1.registerSeries(SunburstSeries.type,SunburstSeries),registerArcMark(),registerTextMark(),registerFadeInOutAnimation(),registerSunburstAnimation()},circlePackingLayout=(r,e)=>{if(!r)return r;const i=e(),{width:n,height:o}=i;return n===0||o===0?r:new CirclePackingLayout(i).layout(r,{width:n,height:o})};class CirclePackingTooltipHelper extends BaseSeriesTooltipHelper{constructor(){super(...arguments),this.markTooltipKeyCallback=e=>e==null?void 0:e[this.series.getDimensionField()[0]]}}const circlePackingPresetAnimation=r=>r==="fadeIn"?{type:"fadeIn"}:{type:"growRadiusIn"},registerCirclePackingAnimation=()=>{Factory$1.registerAnimation("circlePacking",(r,e)=>({appear:circlePackingPresetAnimation(e),enter:{type:"growRadiusIn"},exit:{type:"growRadiusOut"},disappear:{type:"growRadiusOut"}}))},circlePackingSeriesMark=Object.assign(Object.assign({},baseSeriesMark),{circlePacking:{name:"circlePacking",type:"arc"}});class CirclePackingSeries extends CartesianSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.circlePacking}setCategoryField(e){return this._categoryField=e,this._categoryField}getCategoryField(){return this._categoryField}setValueField(e){return this._valueField=e,this._valueField}getValueField(){return this._valueField}getDimensionField(){return[this._categoryField]}getMeasureField(){return[this._valueField]}setAttrFromSpec(){var e;super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField((e=this._spec.seriesField)!==null&&e!==void 0?e:DEFAULT_HIERARCHY_ROOT),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:()=>{var i;return(i=this._spec.drillField)!==null&&i!==void 0?i:DEFAULT_DATA_KEY},getRawData:()=>this.getRawData()}),this._circlePacking=this._spec.circlePacking,this._label=this._spec.label,this._layoutPadding=this._spec.layoutPadding}initData(){super.initData();const e=this.getRawData();isNil(e)||(this._spec.drill&&this.initDrillableData(this._dataSet),registerDataSetInstanceTransform(this._dataSet,"circlePackingLayout",circlePackingLayout),registerDataSetInstanceTransform(this._dataSet,"flatten",flatten),e.transform({type:"circlePackingLayout",options:()=>({nodeKey:this._categoryField,padding:this._layoutPadding,includeRoot:!1,width:this.getLayoutRect().width||1,height:this.getLayoutRect().height||1})}),e.transform({type:"flatten",options:{callback:i=>{if(i.datum){const n=i.datum[i.depth];return Object.assign(Object.assign({},i),n)}return i}}}))}_addDataIndexAndKey(){const e=this.getRawData();isNil(e==null?void 0:e.dataSet)||(registerDataSetInstanceTransform(e.dataSet,"addVChartProperty",addVChartProperty),e.transform({type:"addVChartProperty",options:{beforeCall:initHierarchyKeyMap.bind(this),call:addHierarchyDataKey}}))}initMark(){this._initCirclePackingMark(),this._initLabelMark()}initMarkStyle(){this._initCirclePackingMarkStyle(),this._initLabelMarkStyle()}_initCirclePackingMark(){var e,i;if(((e=this._circlePacking)===null||e===void 0?void 0:e.visible)===!1)return;const n=this._createMark(CirclePackingSeries.mark.circlePacking,{isSeriesMark:!0},{setCustomizedShape:(i=this._spec.circlePacking)===null||i===void 0?void 0:i.customShape});this._circlePackingMark=n}_initCirclePackingMarkStyle(){isNil(this._circlePackingMark)||this.setMarkStyle(this._circlePackingMark,{x:e=>e.x,y:e=>e.y,outerRadius:e=>e.radius,innerRadius:0,startAngle:0,endAngle:2*Math.PI,fill:this.getColorAttribute(),zIndex:e=>e.depth},STATE_VALUE_ENUM.STATE_NORMAL,AttributeLevel.Series)}_initLabelMark(){var e;if(((e=this._label)===null||e===void 0?void 0:e.visible)===!1)return;const i=this._createMark(CirclePackingSeries.mark.label,{isSeriesMark:!1});this._labelMark=i}_initLabelMarkStyle(){isNil(this._labelMark)||this.setMarkStyle(this._labelMark,{x:e=>e.x,y:e=>e.y,text:e=>e.key,cursor:"pointer"},STATE_VALUE_ENUM.STATE_NORMAL,AttributeLevel.Series)}getStatisticFields(){return appendHierarchyFields(super.getStatisticFields(),this._categoryField,this._valueField)}initTooltip(){this._tooltipHelper=new CirclePackingTooltipHelper(this),this._circlePackingMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._circlePackingMark),this._labelMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._labelMark)}initAnimation(){var e;const i=(e=this._spec.animationAppear)===null||e===void 0?void 0:e.preset;this.getMarksInType("arc").forEach(n=>{var o;n.setAnimationConfig(animationConfig((o=Factory$1.getAnimationInKey("circlePacking"))===null||o===void 0?void 0:o(void 0,i),userAnimationConfig(n.name,this._spec,this._markAttributeContext)))}),this.getMarksInType("text").forEach(n=>{var o;n.setAnimationConfig(animationConfig((o=Factory$1.getAnimationInKey("scaleInOut"))===null||o===void 0?void 0:o(),userAnimationConfig(n.name,this._spec,this._markAttributeContext)))})}initEvent(){super.initEvent(),this._spec.drill&&this.bindDrillEvent()}onLayoutEnd(e){super.onLayoutEnd(e),this._rawData.reRunAllTransform()}_noAnimationDataKey(e,i){}getActiveMarks(){return[this._circlePackingMark]}getMarkData(e){return e!=null&&e.datum?e.datum[e.datum.length-1]:e}}CirclePackingSeries.type=SeriesTypeEnum.circlePacking,CirclePackingSeries.mark=circlePackingSeriesMark,mixin(CirclePackingSeries,Drillable);const registerCirclePackingSeries=()=>{Factory$1.registerSeries(CirclePackingSeries.type,CirclePackingSeries),registerArcMark(),registerTextMark(),registerScaleInOutAnimation(),registerCirclePackingAnimation()},calculateNodeValue=r=>{let e=0;return r.forEach((i,n)=>{var o;isNil(i.value)&&(!((o=i.children)===null||o===void 0)&&o.length?i.value=calculateNodeValue(i.children):i.value=0),e+=Math.abs(i.value)}),e};function left(r){return r.depth}function right(r,e){return e-1-r.endDepth}function justify(r,e){return r.sourceLinks.length?r.depth:e-1}function center(r,e,i){return r.targetLinks.length?r.depth:r.sourceLinks.length?minInArray(r.sourceLinks.map(n=>i[n.target].depth))-1:0}const ascendingNodeBreadth=(r,e)=>(r==null?void 0:r.y0)-(e==null?void 0:e.y0),calcDivideValue=(r,e)=>{if(isNil(r.value))return null;const i=(e?r.targetLinks:r.sourceLinks).reduce((n,o)=>(isNil(o.value)?n.count+=1:n.sum+=o.value,n),{sum:0,count:0});return i.count>0?(r.value-i.sum)/i.count:null},alignFunctions={left,right,justify,center,start:left,end:right},linkClampe=clamper(0,1);class SankeyLayout{constructor(e){this._ascendingSourceBreadth=(o,l)=>ascendingNodeBreadth(this._nodeMap[o.source],this._nodeMap[l.source])||o.index-l.index,this._ascendingTargetBreadth=(o,l)=>ascendingNodeBreadth(this._nodeMap[o.target],this._nodeMap[l.target])||o.index-l.index,this.options=Object.assign({},SankeyLayout.defaultOptions,e);const i=this.options.nodeKey,n=isFunction(i)?i:i?field$3(i):null;this._getNodeKey=n,this._logger=Logger.getInstance(),this._alignFunc=isFunction(this.options.setNodeLayer)?o=>this.options.setNodeLayer(o.datum):alignFunctions[this.options.nodeAlign]}layout(e,i){if(!e)return null;const n="width"in i?{x0:0,x1:i.width,y0:0,y1:i.height,width:i.width,height:i.height}:{x0:Math.min(i.x0,i.x1),x1:Math.max(i.x0,i.x1),y0:Math.min(i.y0,i.y1),y1:Math.max(i.y0,i.y1),width:Math.abs(i.x1-i.x0),height:Math.abs(i.y1-i.y0)};isVertical$1(this.options.direction)?this._viewBox={x0:n.y0,x1:n.y1,y0:n.x0,y1:n.x1,width:n.height,height:n.width}:this._viewBox=n;const o=this.computeNodeLinks(e),l=o.nodes;let d=o.links;if(this._nodeMap=o.nodeMap,this.computeNodeValues(l),this.computeNodeDepths(l),["right","end","justify"].includes(this.options.nodeAlign)&&this.computeNodeEndDepths(l),this._maxDepth<=1)return null;const u=this.computeNodeBreadths(l);if(this.computeLinkBreadths(l),l.forEach(f=>{f.sourceLinks=f.sourceLinks.filter(g=>!isNil(g.source)&&!isNil(g.target)),f.targetLinks=f.targetLinks.filter(g=>!isNil(g.source)&&!isNil(g.target))}),d=d.filter(f=>!isNil(f.source)&&!isNil(f.target)),isVertical$1(this.options.direction))if(this.options.inverse){const f=this._viewBox.x1;l.forEach(g=>{const{y0:_,y1:y,x0:b,x1:S}=g;g.y0=f-S,g.y1=f-b,g.x0=_,g.x1=y}),d.forEach(g=>{g.vertical=!0;const{x0:_,x1:y,y0:b,y1:S}=g;g.x0=b,g.x1=S,g.y0=f-_,g.y1=f-y})}else l.forEach(f=>{const{y0:g,y1:_}=f;f.y0=f.x0,f.y1=f.x1,f.x0=g,f.x1=_}),d.forEach(f=>{f.vertical=!0;const g=f.x0,_=f.x1;f.x0=f.y0,f.x1=f.y1,f.y0=g,f.y1=_});else this.options.inverse&&(l.forEach(f=>{const{x0:g,x1:_}=f;f.x0=n.x1-_,f.x1=n.x1-g}),d.forEach(f=>{f.x0=n.x1-f.x0,f.x1=n.x1-f.x1}));return d.forEach(f=>{const g=this._nodeMap[f.source],_=this._nodeMap[f.target];f.sourceRect={x0:g.x0,x1:g.x1,y0:g.y0,y1:g.y1},f.targetRect={x0:_.x0,x1:_.x1,y1:_.y1,y0:_.y0}}),{nodes:l,links:d,columns:u}}computeHierarchicNodeLinks(e){const i=[],n=[],o={},l={},d=[];calculateNodeValue(e);const u=(f,g,_)=>{f.forEach((y,b)=>{const S=this._getNodeKey?this._getNodeKey(y):_?`${_[_.length-1].key}-${b}`:`${g}-${b}`,v=isNil(y.value)?0:toValidNumber$1(y.value);if(o[S])o[S].value=void 0;else{const A={depth:g,datum:y,index:b,key:S,value:v,sourceLinks:[],targetLinks:[]};o[S]=A,i.push(A)}_&&d.push({source:_[_.length-1].key,target:S,value:v,parents:_}),y.children&&y.children.length&&u(y.children,g+1,_?_.concat([o[S]]):[o[S]])})};return u(e,0,null),d.forEach((f,g)=>{const _=`${f.source}-${f.target}`,y=pickWithout(f,["parents"]);if(y.parents=f.parents.map(S=>pickWithout(S,["sourceLinks","targetLinks"])),l[_])return l[_].value+=toValidNumber$1(f.value),void l[_].datum.push(y);const b={index:g,key:`${f.source}-${f.target}`,source:f.source,target:f.target,datum:[y],value:f.value,parents:f.parents.map(S=>S.key)};n.push(b),o[f.source].sourceLinks.push(b),o[f.target].targetLinks.push(b),l[_]=b}),{nodes:i,links:n,nodeMap:o}}computeSourceTargetNodeLinks(e){const i=[],n=[],o={};e.nodes&&e.nodes.forEach((d,u)=>{const f={depth:-1,datum:d,index:u,key:this._getNodeKey?this._getNodeKey(d):u,value:d.value,sourceLinks:[],targetLinks:[]};o[f.key]=f,i.push(f)});const l=[];return e.links.forEach((d,u)=>{const f=!isNil(d.source),g=!isNil(d.target);if(e.nodes&&(!o[d.source]||!o[d.target]))return;e.nodes||!f||o[d.source]||(o[d.source]={value:void 0,depth:-1,index:i.length,key:d.source,datum:null,sourceLinks:[],targetLinks:[]},i.push(o[d.source])),e.nodes||!g||o[d.target]||(o[d.target]={value:void 0,depth:-1,index:i.length,key:d.target,datum:null,sourceLinks:[],targetLinks:[]},i.push(o[d.target]));const _={index:u,source:d.source,target:d.target,datum:d,value:d.value};this.options.divideNodeValueToLink&&isNil(d.value)&&l.push(_),n.push(_),f&&o[d.source].sourceLinks.push(_),g&&o[d.target].targetLinks.push(_)}),this.options.divideNodeValueToLink&&l.length&&l.forEach(d=>{const u=[calcDivideValue(o[d.source]),calcDivideValue(o[d.target],!0)].filter(f=>!isNil(f));u.length&&(d.value=minInArray(u))}),{nodeMap:o,nodes:i,links:n}}computeNodeLinks(e){let i;"links"in e?i=this.computeSourceTargetNodeLinks(e):(this._isHierarchic=!0,i=this.computeHierarchicNodeLinks(e.nodes));let n=i.nodes;const o=i.links;if(this.options.linkSortBy)for(let l=0,d=n.length;l<d;l++)n[l].sourceLinks.sort(this.options.linkSortBy),n[l].targetLinks.sort(this.options.linkSortBy);return this.options.dropIsolatedNode&&(n=n.filter(l=>l.targetLinks.length||l.sourceLinks.length)),{nodes:n,links:o,nodeMap:i.nodeMap}}computeNodeValues(e){for(let i=0,n=e.length;i<n;i++){const o=e[i];o.value=Math.max(isNil(o.value)?0:toValidNumber$1(o.value),o.sourceLinks.reduce((l,d)=>{var u;return l+((u=toValidNumber$1(d.value))!==null&&u!==void 0?u:0)},0),o.targetLinks.reduce((l,d)=>{var u;return l+((u=toValidNumber$1(d.value))!==null&&u!==void 0?u:0)},0))}}computeNodeDepths(e){const i=e.length;let n,o,l=e,d=0;for(;l.length&&d<i;){n=[],o={};for(let u=0,f=l.length;u<f;u++){const g=l[u];if(g&&(g.depth=d,g.sourceLinks&&g.sourceLinks.length))for(let _=0,y=g.sourceLinks.length;_<y;_++){const b=g.sourceLinks[_];o[b.target]||(n.push(this._nodeMap[b.target]),o[b.target]=!0)}}l=n,d+=1}d>i&&this._logger.warn("Error: there is a circular link"),this._maxDepth=d}computeNodeEndDepths(e){const i=e.length;let n,o,l=e,d=0;for(;l.length&&d<i;){n=[],o={};for(let u=0,f=l.length;u<f;u++){const g=l[u];if(g){g.endDepth=d;for(let _=0,y=g.targetLinks.length;_<y;_++){const b=g.targetLinks[_];o[b.source]||(n.push(this._nodeMap[b.source]),o[b.source]=!0)}}}l=n,d+=1}d>i&&this._logger.warn("Error: there is a circular link")}computeNodeLayers(e){const i=this.options.nodeWidth,n=this.options.linkWidth,o=this.options.minStepWidth,l=this._viewBox.width;let d=null,u=null,f=!1;if(isString(i)){const _=clamp(parseFloat(i.replace("%",""))/100,0,1);let y=l/(this._maxDepth-1+_);o>0&&(y=Math.max(o,y)),d=y*_,u=y*(1-_),f=!0}else if(isNumber(i)){if(d=i,isNumber(n))u=n;else if(isNil(n)){let _=(l-i)/(this._maxDepth-1);o>0&&(_=Math.max(o,_)),u=_-i}f=!0}else isFunction(i)&&isNumber(n)&&(u=n);const g=[];for(let _=0,y=e.length;_<y;_++){const b=e[_];b.layer=this._isHierarchic?b.depth:clamp(Math.floor(this._alignFunc(b,this._maxDepth,this._nodeMap)),0,this._maxDepth-1);const S=b.layer;S===this._maxDepth-1&&(b.isLastLayer=!0),f&&(b.x0=this._viewBox.x0+S*(d+u),b.x1=b.x0+d),g[S]?g[S].push(b):g[S]=[b]}if(this.options.nodeSortBy)for(let _=0,y=g.length;_<y;_++)g[_].sort(this.options.nodeSortBy);if(!f&&isFunction(i)){let _=this._viewBox.x0;for(let y=0;y<this._maxDepth;y++){const b=g[y];let S=0,v=0;for(let A=0,x=b&&b.length;A<x;A++){const T=b[A],C=i(T);T.x0=_,T.x1=_+C,S=Math.max(d,C);const E=T.sourceLinks;for(let P=0,R=E.length;P<R;P++){const L=E[P],w=isFunction(n)?n(L,this._viewBox):u;v=Math.max(v,w)}}_+=S+v}}return g}initializeNodeBreadths(e){var i,n,o;const l=(i=this.options.minLinkHeight)!==null&&i!==void 0?i:0;let d=(n=this.options.minNodeHeight)!==null&&n!==void 0?n:0;const u=(o=this.options.maxNodeHeight)!==null&&o!==void 0?o:1/0;let f=this.options.maxLinkHeight;(isNil(d)||d<l)&&(d=l),(isNil(f)||f>u)&&(f=u);let g=0,_=null,y=null;if(isFunction(this.options.nodeGap))_=this.options.nodeGap,g=e.reduce((x,T)=>{const C=T.reduce((P,R)=>P+R.value,0),E=T.reduce((P,R)=>P+this.options.nodeGap(R),0);return Math.min(x,(this._viewBox.height-E)/C)},1/0);else{const x=e.reduce((E,P)=>Math.max(E,P.length),0),T=this._viewBox.height/x;let C=Math.min(this.options.nodeGap,T);if(d+C>T&&(C=d>=T?T/2:(T-d)/2,d=Math.min(T-C,d)),_=()=>C,this._gapY=C,this.options.equalNodeHeight)y=this._viewBox.height/x-C;else{const E=d>0?Math.max(C,d):C;g=e.reduce((P,R)=>{const L=R.reduce((w,B)=>w+B.value,0);return Math.min(P,(this._viewBox.height-((R.length-1)*E+d))/L)},1/0)}}const b=this.options.gapPosition==="start",S=!b&&this.options.gapPosition!=="end",v=isNumber(this.options.nodeHeight)?x=>this.options.nodeHeight:isFunction(this.options.nodeHeight)?this.options.nodeHeight:y>0?x=>y:x=>Math.max(x.value*g,0),A=isNumber(this.options.linkHeight)?()=>this.options.linkHeight:isFunction(this.options.linkHeight)?this.options.linkHeight:(x,T,C)=>Math.min(Math.max(T.value?C*linkClampe(x.value/T.value):0,l,0),f);for(let x=0,T=e.length;x<T;x++){const C=e[x];if(!C||!C.length)continue;let E=this._viewBox.y0,P=0,R=0,L=0;for(let B=0,I=C.length;B<I;B++){const D=C[B];P=_(D),b&&(E+=P),L=v(D),R=Math.min(Math.max(L,d),u),D.y0=E,D.y1=E+R,E=b?D.y1:D.y1+P;for(let O=0,N=D.sourceLinks.length;O<N;O++){const V=D.sourceLinks[O];V.thickness=A(V,D,L)}}let w=this._viewBox.y1-E+(S?P:0);if(w>0){if(this.options.crossNodeAlign!=="start")if(this.options.crossNodeAlign==="end")for(let B=0,I=C.length;B<I;++B){const D=C[B];D.y0+=w,D.y1+=w}else if(this.options.crossNodeAlign==="parent"){const B=C.reduce((I,D)=>(D.targetLinks&&D.targetLinks.length&&D.targetLinks.forEach(O=>{I[O.source]=!0}),I),{});if(Object.keys(B).length&&e[x-1]&&e[x-1].length){const I=e[x-1].filter(D=>B[D.key]);if(I&&I.length&&I[0].y0!==C[0].y0){const D=I[0].y0-C[0].y0;for(let O=0,N=C.length;O<N;++O){const V=C[O];V.y0+=D,V.y1+=D}}}}else{w/=C.length+1;for(let B=0,I=C.length;B<I;++B){const D=C[B];D.y0+=w*(B+1),D.y1+=w*(B+1)}}}else if(w<0&&C.length>1&&(w/=C.length-1,P+w>=0)){P+=w,this._gapY=Math.min(P);for(let B=1,I=C.length;B<I;++B){const D=C[B];D.y0+=w*B,D.y1+=w*B}}this.reorderLinks(C)}}computeNodeBreadths(e){const i=this.computeNodeLayers(e);this.initializeNodeBreadths(i);const n=this.options.iterations;if(!this._isHierarchic&&!isFunction(this.options.setNodeLayer)&&!isFunction(this.options.nodeGap))for(let o=0;o<n;++o){const l=Math.pow(.99,o),d=Math.max(1-l,(o+1)/n);this.relaxRightToLeft(i,l,d),this.relaxLeftToRight(i,l,d)}return i}relaxLeftToRight(e,i,n){for(let o=1,l=e.length;o<l;++o){const d=e[o];for(let u=0,f=d.length;u<f;u++){const g=d[u];let _=0,y=0;for(let S=0,v=g.targetLinks.length;S<v;S++){const A=g.targetLinks[S],x=A.value*(g.layer-this._nodeMap[A.source].layer);_+=this.targetTop(this._nodeMap[A.source],g)*x,y+=x}if(!(y>0))continue;const b=(_/y-g.y0)*i;g.y0+=b,g.y1+=b,this.reorderNodeLinks(g)}isNil(this.options.nodeSortBy)&&d.sort(ascendingNodeBreadth),this.resolveCollisions(d,n)}}relaxRightToLeft(e,i,n){for(let o=e.length-2;o>=0;--o){const l=e[o];for(let d=0,u=l.length;d<u;d++){const f=l[d];let g=0,_=0;for(let b=0,S=f.sourceLinks.length;b<S;b++){const v=f.sourceLinks[b],A=v.value*(this._nodeMap[v.target].layer-f.layer);g+=this.sourceTop(f,this._nodeMap[v.target])*A,_+=A}if(!(_>0))continue;const y=(g/_-f.y0)*i;f.y0+=y,f.y1+=y,this.reorderNodeLinks(f)}this.options.nodeSortBy===void 0&&l.sort(ascendingNodeBreadth),this.resolveCollisions(l,n)}}resolveCollisions(e,i){const n=e.length>>1,o=e[n];this.resolveCollisionsBottomToTop(e,o.y0-this._gapY,n-1,i),this.resolveCollisionsTopToBottom(e,o.y1+this._gapY,n+1,i),this.resolveCollisionsBottomToTop(e,this._viewBox.y1,e.length-1,i),this.resolveCollisionsTopToBottom(e,this._viewBox.y0,0,i)}resolveCollisionsTopToBottom(e,i,n,o){for(;n<e.length;++n){const l=e[n],d=(i-l.y0)*o;d>1e-6&&(l.y0+=d,l.y1+=d),i=l.y1+this._gapY}}resolveCollisionsBottomToTop(e,i,n,o){for(;n>=0;--n){const l=e[n],d=(l.y1-i)*o;d>1e-6&&(l.y0-=d,l.y1-=d),i=l.y0-this._gapY}}targetTop(e,i){let n,o,l,d=e.y0-(e.sourceLinks.length-1)*this._gapY/2;for(n=0,o=e.sourceLinks.length;n<o&&(l=e.sourceLinks[n],l.target!==i.key);n++)d+=l.thickness+this._gapY;for(n=0,o=i.targetLinks.length;n<o&&(l=i.targetLinks[n],l.source!==e.key);n++)d-=l.thickness;return d}sourceTop(e,i){let n,o,l,d=i.y0-(i.targetLinks.length-1)*this._gapY/2;for(n=0,o=i.targetLinks.length;n<o&&(l=i.targetLinks[n],l.source!==e.key);n++)d+=l.thickness+this._gapY;for(n=0,o=e.sourceLinks.length;n<o&&(l=e.sourceLinks[n],l.target!==i.key);n++)d-=l.thickness;return d}computeLinkBreadthsNoOverlap(e){for(let i=0,n=e.length;i<n;i++){const o=e[i];let l=o.y0,d=!1;for(let f=0,g=o.sourceLinks.length;f<g;f++){const _=o.sourceLinks[f];d||(_.y0=l+_.thickness/2),_.x0=o.x1,l+_.thickness>o.y1||d?(_.y0=o.y1-_.thickness/2,d=!0):l+=_.thickness}let u=o.y0;d=!1;for(let f=0,g=o.targetLinks.length;f<g;f++){const _=o.targetLinks[f];d||(_.y1=u+_.thickness/2),_.x1=o.x0,u+_.thickness>o.y1||d?(_.y1=o.y1-_.thickness/2,d=!0):u+=_.thickness}}}computeLinkBreadthsOverlap(e){const i=this.options.linkOverlap;for(let n=0,o=e.length;n<o;n++){const l=e[n],d=i==="start"?l.y0:i==="end"?l.y1:(l.y0+l.y1)/2,u=i==="start"?.5:i==="end"?-.5:0;for(let f=0,g=l.sourceLinks.length;f<g;f++){const _=l.sourceLinks[f];_.y0=d+u*_.thickness,_.x0=l.x1}for(let f=0,g=l.targetLinks.length;f<g;f++){const _=l.targetLinks[f];_.y1=d+u*_.thickness,_.x1=l.x0}}}computeLinkBreadths(e){this.options.linkOverlap?this.computeLinkBreadthsOverlap(e):this.computeLinkBreadthsNoOverlap(e)}reorderNodeLinks(e){if(isNil(this.options.linkSortBy)){const i=e.targetLinks,n=e.sourceLinks;for(let o=0,l=i.length;o<l;o++){const d=i[o];this._nodeMap[d.source].sourceLinks.sort(this._ascendingTargetBreadth)}for(let o=0,l=n.length;o<l;o++){const d=n[o];this._nodeMap[d.target].targetLinks.sort(this._ascendingSourceBreadth)}}}reorderLinks(e){if(isNil(this.options.linkSortBy))for(let i=0,n=e.length;i<n;i++){const o=e[i];o.sourceLinks.sort(this._ascendingTargetBreadth),o.targetLinks.sort(this._ascendingSourceBreadth)}}}SankeyLayout.defaultOptions={iterations:6,nodeAlign:"justify",direction:"horizontal",nodeWidth:24,nodeGap:8,crossNodeAlign:"middle",dropIsolatedNode:!0};const transform=(r,e)=>{const i=new SankeyLayout(r).layout(Array.isArray(e)?e[0]:e,"width"in r?{width:r.width,height:r.height}:{x0:r.x0,x1:r.x1,y0:r.y0,y1:r.y1});return i?[i]:[]},registerSankeyTransforms=()=>{Factory.registerTransform("sankey",{transform,markPhase:"beforeJoin"},!0)},collectHierarchyField=(r,e,i)=>{e.forEach(n=>{isNil(n[i])||r.add(n[i]),n.children&&n.children.length>0&&collectHierarchyField(r,n.children,i)})},sankeyFormat=r=>{var e;if(!r||!isArray(r))return[];if(r.length>1){const i={links:[],nodes:[]};return r.forEach(n=>{n.id!=="links"&&n.id!=="nodes"||(i[n.id]=n.values)}),[i]}return!((e=r[0])===null||e===void 0)&&e.latestData?r[0].latestData:r},sankeyLayout=(r,e)=>{if(!r||!(e!=null&&e.view)||!r.length)return[];const i=e.view();if(i.x1-i.x0==0||i.y1-i.y0==0||i.x1-i.x0==-1/0||i.x1-i.x0==1/0||i.y1-i.y0==-1/0||i.y1-i.y0==1/0)return[];const n=r[0];if((e.sourceField!=="source"||e.targetField!=="target"||e.valueField!=="value")&&n.links){const d=[];n.links.forEach(u=>{const f={};for(const g in u)g===e.sourceField?f.source=u[e.sourceField]:g===e.targetField?f.target=u[e.targetField]:g===e.valueField?f.value=u[e.valueField]:f[g]=u[g];d.push(f)}),n.links=d}const o=new SankeyLayout(e),l=[];return l.push(o.layout(n,i)),l},sankeyNodes=r=>{var e,i;return r&&isArray(r)&&(!((e=r[0])===null||e===void 0)&&e.latestData)&&r[0].latestData.length&&r[0].latestData[0]&&(i=r[0].latestData[0].nodes)!==null&&i!==void 0?i:[]},sankeyLinks=r=>{var e,i;return r&&isArray(r)&&(!((e=r[0])===null||e===void 0)&&e.latestData)&&r[0].latestData.length&&r[0].latestData[0]&&(i=r[0].latestData[0].links)!==null&&i!==void 0?i:[]};class SankeySeriesTooltipHelper extends BaseSeriesTooltipHelper{constructor(){super(...arguments),this._getDimensionData=e=>{if(e.source){if(isNumber(e.source)){const i=this.series.getSeriesKeys();return i[e.source]+" => "+i[e.target]}return e.source+" => "+e.target}return e.datum?e.datum[this.series.getSpec().categoryField]:e.key},this.markTooltipValueCallback=e=>e.value}}const sankeyGrowIn=(r,e=!0)=>({type:r.direction==="horizontal"?"growWidthIn":"growHeightIn",options:{overall:e&&r.growFrom(),orient:"positive"}}),sankeyNodePresetAnimation=(r,e)=>e==="fadeIn"?{type:"fadeIn"}:sankeyGrowIn(r),sankeyLinkPresetAnimation=r=>r==="fadeIn"?{type:"fadeIn"}:{type:"linkPathGrowIn"},registerSankeyAnimation=()=>{Factory$1.registerAnimation("sankeyNode",(r,e)=>Object.assign({appear:sankeyNodePresetAnimation(r,e)},FadeInOutAnimation)),Factory$1.registerAnimation("sankeyLinkPath",(r,e)=>({appear:sankeyLinkPresetAnimation(e),enter:{type:"linkPathGrowIn"},exit:{type:"linkPathGrowOut"},disappear:{type:"linkPathGrowOut"}}))};class LinkPathMark extends BaseMark{constructor(){super(...arguments),this.type=LinkPathMark.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{x:0,y:0,x0:0,y0:0,x1:100,y1:100,thickness:1,round:!0})}_initProduct(e){const i=this.getVGrammarView(),n=this.getProductId(),o=this.getStyle("direction");this._product=i.glyph("linkPath",e??i.rootMark).id(n).configureGlyph({direction:o}),this._compiledProductId=n}}LinkPathMark.type="linkPath";const registerLinkPathMark=()=>{registerLinkPathGlyph(),Factory$1.registerMark(LinkPathMark.type,LinkPathMark)},sankeySeriesMark=Object.assign(Object.assign({},baseSeriesMark),{node:{name:"node",type:"rect"},link:{name:"link",type:"linkPath"}});class SankeySeriesSpecTransformer extends BaseSeriesSpecTransformer{_transformLabelSpec(e){this._addMarkLabelSpec(e,"node")}}class SankeySeries extends CartesianSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.sankey,this.transformerConstructor=SankeySeriesSpecTransformer,this._nodeLayoutZIndex=LayoutZIndex.Node,this._labelLayoutZIndex=LayoutZIndex.Label,this._viewBox=new Bounds,this._fillByNode=e=>{var i,n,o,l,d;if(e&&e.sourceRect&&e.targetRect)return this._fillByLink(e);const u=(n=(i=this._spec.node)===null||i===void 0?void 0:i.style)===null||n===void 0?void 0:n.fill;if(isValid(u))return u;if(isValid(this._spec.seriesField)){const f=(l=(o=this._option)===null||o===void 0?void 0:o.globalScale)===null||l===void 0?void 0:l.getScale("color"),g=e!=null&&e.datum?e.datum:e;return f==null?void 0:f.scale(g==null?void 0:g[this._spec.seriesField])}return(d=this._colorScale)===null||d===void 0?void 0:d.scale(this._getNodeNameFromData(e))},this._fillByLink=e=>{var i,n,o,l,d,u,f;const g=(n=(i=this._spec.link)===null||i===void 0?void 0:i.style)===null||n===void 0?void 0:n.fill;if(g)return g;if(isValid(this._spec.seriesField)){const y=(l=(o=this._nodesSeriesData)===null||o===void 0?void 0:o.getLatestData())===null||l===void 0?void 0:l.find(v=>e.source===v.key),b=y==null?void 0:y.datum,S=(u=(d=this._option)===null||d===void 0?void 0:d.globalScale)===null||u===void 0?void 0:u.getScale("color");return S==null?void 0:S.scale(b==null?void 0:b[this._spec.seriesField])}const _=isNumber(e.source)?this.getNodeList()[e.source]:e.source;return(f=this._colorScale)===null||f===void 0?void 0:f.scale(_)},this._handleEmphasisElement=e=>{var i,n,o,l,d;const u=(i=this._spec.emphasis)!==null&&i!==void 0?i:{},f=e.item;u.effect==="adjacency"?f&&f.mark===((n=this._nodeMark)===null||n===void 0?void 0:n.getProduct())?this._handleNodeAdjacencyClick(f):f&&f.mark===((o=this._linkMark)===null||o===void 0?void 0:o.getProduct())?this._handleLinkAdjacencyClick(f):this._handleClearEmpty():u.effect==="related"&&(f&&f.mark===((l=this._nodeMark)===null||l===void 0?void 0:l.getProduct())?this._handleNodeRelatedClick(f):f&&f.mark===((d=this._linkMark)===null||d===void 0?void 0:d.getProduct())?this._handleLinkRelatedClick(f):this._handleClearEmpty())},this._handleClearEmpty=()=>{var e,i;if(!this._needClear)return;const n=(e=this._nodeMark)===null||e===void 0?void 0:e.getProductElements();if(!n||!n.length)return;const o=(i=this._linkMark)===null||i===void 0?void 0:i.getProductElements();if(!o||!o.length)return;const l=[STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE];n.forEach(d=>{d.removeState(l)}),o.forEach(d=>{d.removeState(l)}),this._needClear=!1},this._handleNodeAdjacencyClick=e=>{const i=e.getDatum(),n=[i.key];if(this._linkMark){const o=this._linkMark.getProductElements();if(!o||!o.length)return;o.forEach((l,d)=>{const u=l.getDatum();u.source===i.key?(n.includes(u.target)||n.push(u.target),l.removeState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),l.addState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS)):u.target===i.key?(n.includes(u.source)||n.push(u.source),l.removeState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),l.addState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS)):(l.removeState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS),l.addState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE))})}this._nodeMark&&this._highLightElements(this._nodeMark.getProductElements(),n),this._needClear=!0},this._handleLinkAdjacencyClick=e=>{const i=e.getDatum(),n=[i.source,i.target];if(this._linkMark){const o=this._linkMark.getProductElements();if(!o||!o.length)return;o.forEach(l=>{l===e?(l.removeState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),l.addState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,{ratio:1})):(l.removeState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS),l.addState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE))})}this._nodeMark&&this._highLightElements(this._nodeMark.getProductElements(),n),this._needClear=!0},this._handleNodeRelatedClick=e=>{var i;const n=e.getDatum(),o=this._nodeMark.getProductElements();if(!o||!o.length)return;const l=this._linkMark.getProductElements();if(!l||!l.length)return;const d=!((i=l[0].getDatum())===null||i===void 0)&&i.parents?"parents":"source";if(d==="source"){const u=[n.key],f=[];if(l.forEach((g,_)=>{var y,b,S,v;const A=g.getDatum(),x=A!=null&&A.parents?"parents":"source";if(array(A[x]).includes(n.key)){if(f.includes((y=A.key)!==null&&y!==void 0?y:A.index)||f.push((b=A.key)!==null&&b!==void 0?b:A.index),u.includes(A.source)||u.push(A.source),!u.includes(A.target)){u.push(A.target);let T=o.find(C=>C.data[0].key===A.target).data[0].sourceLinks;for(;(T==null?void 0:T.length)>0;){const C=[];return T.forEach(E=>{var P,R;if(!f.includes((P=E.key)!==null&&P!==void 0?P:E.index)&&(f.push((R=E.key)!==null&&R!==void 0?R:E.index),!u.includes(E.target))){u.push(E.target);const L=o.find(w=>w.data[0].key===E.target);C.push(L.data[0].targetLinks)}}),void(T=C)}}}else if(A.target===n.key&&(f.includes((S=A.key)!==null&&S!==void 0?S:A.index)||f.push((v=A.key)!==null&&v!==void 0?v:A.index),!u.includes(A.source))){u.push(A.source);let T=o.find(C=>C.data[0].key===A.source).data[0].targetLinks;for(;(T==null?void 0:T.length)>0;){const C=[];return T.forEach(E=>{var P,R;if(!f.includes((P=E.key)!==null&&P!==void 0?P:E.index)&&(f.push((R=E.key)!==null&&R!==void 0?R:E.index),!u.includes(E.source))){u.push(E.source);const L=o.find(w=>w.data[0].key===E.source);C.push(L.data[0].targetLinks)}}),void(T=C)}}}),this._linkMark){const g=this._linkMark.getProductElements();if(!g||!g.length)return;g.forEach((_,y)=>{var b;f.includes((b=_.getDatum().key)!==null&&b!==void 0?b:_.getDatum().index)?(_.removeState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),_.addState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS)):(_.removeState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS),_.addState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE))})}this._nodeMark&&this._highLightElements(this._nodeMark.getProductElements(),u)}else{const u=[n.key],f=n.targetLinks.reduce((g,_)=>(array(_.datum).forEach(y=>{const b=y.parents,S=b.length;for(let v=0;v<S;v++){const A=b[v].key,x=b[v+1]?b[v+1].key:n.key,T=y.value,C=g.find(E=>E.source===A&&E.target===x);C?C.value+=T:g.push({source:A,target:x,value:T})}}),g),[]);l.forEach((g,_)=>{const y=g.getDatum(),b=y.datum,S=b?b.filter(A=>A[d].some(x=>x.key===n.key)):null,v=f.find(A=>A.source===y.source&&A.target===y.target);if(S&&S.length){u.includes(y.source)||u.push(y.source),u.includes(y.target)||u.push(y.target);const A=S.reduce((x,T)=>x+T.value,0)/y.value;return g.removeState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),void g.addState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,{ratio:A})}if(v)return u.includes(y.source)||u.push(y.source),u.includes(y.target)||u.push(y.target),g.removeState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),void g.addState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,{ratio:v.value/y.value});g.removeState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS),g.addState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE)}),this._nodeMark&&this._highLightElements(this._nodeMark.getProductElements(),u)}this._needClear=!0},this._handleLinkRelatedClick=e=>{var i;const n=this._nodeMark.getProductElements();if(!n||!n.length)return;const o=this._linkMark.getProductElements();if(!(!o||!o.length)){if((!((i=e.getDatum())===null||i===void 0)&&i.parents?"parents":"source")=="source"){const l=[STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE];this._linkMark&&o.forEach(d=>{d.removeState(l)}),this._nodeMark&&n.forEach(d=>{d.removeState(l)})}else{const l=e.getDatum(),d=[l.source,l.target],u=[];array(l.datum).forEach(f=>{const g=f.parents,_=g.length;for(let y=0;y<_-1;y++){const b=g[y].key,S=g[y+1].key,v=f.value,A=u.find(x=>x.source===b&&x.target===S);u.push({source:g[y].key,target:g[y+1].key,value:f.value}),A?A.value+=v:u.push({source:b,target:S,value:v})}}),o.forEach(f=>{const g=f.getDatum(),_=g.datum;if(g.source===l.source&&g.target===l.target)return f.removeState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),void f.addState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,{ratio:1});const y=_?_.filter(S=>{const v=S.parents.map(A=>A.key);return v.includes(l.source)&&v.includes(l.target)}):null;if(y&&y.length){d.includes(g.source)||d.push(g.source),d.includes(g.target)||d.push(g.target);const S=y.filter(A=>A.parents.some((x,T)=>{var C;return x.key===l.source&&((C=A.parents[T+1])===null||C===void 0?void 0:C.key)===l.target})).reduce((A,x)=>A+x.value,0),v=S/g.value;return f.removeState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),void f.addState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,{ratio:v})}const b=u.find(S=>S.source===g.source&&S.target===g.target);if(b)return d.includes(g.source)||d.push(g.source),d.includes(g.target)||d.push(g.target),f.removeState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE),void f.addState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS,{ratio:b.value/g.value});f.removeState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS),f.addState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE)}),this._highLightElements(n,d)}this._needClear=!0}}}get direction(){var e;return(e=this._spec.direction)!==null&&e!==void 0?e:"horizontal"}getCategoryField(){return this._categoryField}setCategoryField(e){return this._categoryField=e,this._categoryField}getValueField(){return this._valueField}setValueField(e){return this._valueField=e,this._valueField}setAttrFromSpec(){var e;super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField((e=this._spec.seriesField)!==null&&e!==void 0?e:this._spec.categoryField)}initData(){var e,i,n,o;super.initData();const l=this.getViewData(),d=this.getRawData();if(d&&l){registerDataSetInstanceTransform(this._dataSet,"sankeyLayout",sankeyLayout),registerDataSetInstanceTransform(this._dataSet,"sankeyFormat",sankeyFormat),d.transform({type:"sankeyFormat"},!1),l.transform({type:"sankeyLayout",options:{view:()=>({x0:this._viewBox.x1,x1:this._viewBox.x2,y0:this._viewBox.y1,y1:this._viewBox.y2}),sourceField:this._spec.sourceField,targetField:this._spec.targetField,valueField:this._spec.valueField,direction:this.direction,crossNodeAlign:this._spec.crossNodeAlign,nodeAlign:(e=this._spec.nodeAlign)!==null&&e!==void 0?e:"justify",nodeGap:(i=this._spec.nodeGap)!==null&&i!==void 0?i:8,nodeWidth:(n=this._spec.nodeWidth)!==null&&n!==void 0?n:10,linkWidth:this._spec.linkWidth,minStepWidth:this._spec.minStepWidth,minNodeHeight:(o=this._spec.minNodeHeight)!==null&&o!==void 0?o:4,maxNodeHeight:this._spec.maxNodeHeight,minLinkHeight:this._spec.minLinkHeight,maxLinkHeight:this._spec.maxLinkHeight,iterations:this._spec.iterations,nodeKey:this._spec.nodeKey,linkSortBy:this._spec.linkSortBy,nodeSortBy:this._spec.nodeSortBy,setNodeLayer:this._spec.setNodeLayer,dropIsolatedNode:this._spec.dropIsolatedNode,nodeHeight:this._spec.nodeHeight,linkHeight:this._spec.linkHeight,equalNodeHeight:this._spec.equalNodeHeight,linkOverlap:this._spec.linkOverlap,inverse:this._spec.inverse},level:TransformLevel.sankeyLayout});const{dataSet:u}=this._option;registerDataSetInstanceTransform(u,"sankeyNodes",sankeyNodes),registerDataSetInstanceTransform(u,"flatten",flatten);const f=new DataView(u,{name:`sankey-node-${this.id}-data`});f.parse([this.getViewData()],{type:"dataview"}),f.transform({type:"sankeyNodes"}),f.transform({type:"flatten",options:{callback:_=>{if(_.datum){const y=_.datum[_.depth];return Object.assign(Object.assign({},_),y)}return _}}},!1),f.transform({type:"addVChartProperty",options:{beforeCall:initKeyMap.bind(this),call:addDataKey}},!1),this._nodesSeriesData=new SeriesData(this._option,f),registerDataSetInstanceTransform(u,"sankeyLinks",sankeyLinks);const g=new DataView(u,{name:`sankey-link-${this.id}-data`});g.parse([this.getViewData()],{type:"dataview"}),g.transform({type:"sankeyLinks"}),g.transform({type:"addVChartProperty",options:{beforeCall:initKeyMap.bind(this),call:addDataKey}},!1),this._linksSeriesData=new SeriesData(this._option,g)}}compileData(){var e,i;super.compileData(),(e=this._linksSeriesData)===null||e===void 0||e.compile(),(i=this._nodesSeriesData)===null||i===void 0||i.compile()}initMark(){var e,i,n,o;this._rootMark.setMarkConfig({overflow:this._spec.overflow,interactive:!!this._spec.overflow});const l=this._createMark(SankeySeries.mark.node,{isSeriesMark:!0,dataView:this._nodesSeriesData.getDataView(),dataProductId:this._nodesSeriesData.getProductId(),stateSort:(e=this._spec.node)===null||e===void 0?void 0:e.stateSort},{setCustomizedShape:(i=this._spec.node)===null||i===void 0?void 0:i.customShape});l&&(l.setMarkConfig({zIndex:this._nodeLayoutZIndex}),this._nodeMark=l);const d=this._createMark(SankeySeries.mark.link,{dataView:this._linksSeriesData.getDataView(),dataProductId:this._linksSeriesData.getProductId(),stateSort:(n=this._spec.link)===null||n===void 0?void 0:n.stateSort},{setCustomizedShape:(o=this._spec.link)===null||o===void 0?void 0:o.customShape});d&&(this._linkMark=d)}_buildMarkAttributeContext(){super._buildMarkAttributeContext(),this._markAttributeContext.valueToNode=this.valueToNode.bind(this),this._markAttributeContext.valueToLink=this.valueToLink.bind(this)}valueToNode(e){const i=this._nodesSeriesData.getLatestData(),n=array(e)[0];return i&&i.find(o=>o.key===n)}valueToLink(e){const i=this._linksSeriesData.getLatestData(),n=array(e);return i&&i.find(o=>o&&o.source===n[0]&&o.target===n[1])}valueToPositionX(e){const i=this.valueToNode(e);return i==null?void 0:i.x0}valueToPositionY(e){const i=this.valueToNode(e);return i==null?void 0:i.y0}initMarkStyle(){this._initNodeMarkStyle(),this._initLinkMarkStyle()}_initNodeMarkStyle(){var e,i;const n=this._nodeMark;n&&(this.setMarkStyle(n,{x:o=>o.x0,x1:o=>o.x1,y:o=>o.y0,y1:o=>o.y1},STATE_VALUE_ENUM.STATE_NORMAL,AttributeLevel.Mark),this.setMarkStyle(n,{fill:(i=(e=this._spec.node.style)===null||e===void 0?void 0:e.fill)!==null&&i!==void 0?i:this._fillByNode},"normal",AttributeLevel.User_Mark))}_initLinkMarkStyle(){var e,i;const n=this._linkMark;n&&(this.setMarkStyle(n,{x0:o=>o.x0,x1:o=>o.x1,y0:o=>o.y0,y1:o=>o.y1,thickness:o=>o.thickness,direction:this.direction},STATE_VALUE_ENUM.STATE_NORMAL,AttributeLevel.Series),this.setMarkStyle(n,{fill:(i=(e=this._spec.link.style)===null||e===void 0?void 0:e.fill)!==null&&i!==void 0?i:this._fillByLink},"normal",AttributeLevel.User_Mark))}initLabelMarkStyle(e,i){if(!e)return;const n=i.position;n&&n.includes("inside")?this.setMarkStyle(e,{fill:"#ffffff",text:o=>this._createText(o,i),maxLineWidth:o=>{var l;return(l=i.limit)!==null&&l!==void 0?l:o.x1-o.x0}}):this.setMarkStyle(e,{fill:this._fillByNode,text:o=>this._createText(o,i),maxLineWidth:i.limit}),e.setMarkConfig({zIndex:this._labelLayoutZIndex})}_createText(e,i){if(isNil(e)||isNil(e.datum))return"";let n=e.datum[this._spec.categoryField]||"";const{formatMethod:o,formatter:l}=i||{},{formatFunc:d,args:u}=getFormatFunction(o,l,n,e.datum);return d&&(n=d(...u,{series:this})),n}initAnimation(){var e,i,n,o;const l={direction:this.direction,growFrom:()=>{var u,f;return this.direction==="horizontal"?(u=this._xAxisHelper)===null||u===void 0?void 0:u.getScale(0).scale(0):(f=this._yAxisHelper)===null||f===void 0?void 0:f.getScale(0).scale(0)}},d=(i=(e=this._spec)===null||e===void 0?void 0:e.animationAppear)===null||i===void 0?void 0:i.preset;this._nodeMark&&this._nodeMark.setAnimationConfig(animationConfig((n=Factory$1.getAnimationInKey("sankeyNode"))===null||n===void 0?void 0:n(l,d),userAnimationConfig("node",this._spec,this._markAttributeContext))),this._linkMark&&this._linkMark.setAnimationConfig(animationConfig((o=Factory$1.getAnimationInKey("sankeyLinkPath"))===null||o===void 0?void 0:o(l,d),userAnimationConfig("link",this._spec,this._markAttributeContext)))}initEvent(){var e,i,n;super.initEvent(),(e=this._nodesSeriesData.getDataView())===null||e===void 0||e.target.addListener("change",this.nodesSeriesDataUpdate.bind(this)),(i=this._linksSeriesData.getDataView())===null||i===void 0||i.target.addListener("change",this.linksSeriesDataUpdate.bind(this));const o=(n=this._spec.emphasis)!==null&&n!==void 0?n:{};if(this._option.disableTriggerEvent!==!0&&o.enable&&(o.effect==="adjacency"||o.effect==="related")){const l=o.trigger==="hover"?"pointerover":"pointerdown";this.event.on(l,{level:Event_Bubble_Level.chart},this._handleEmphasisElement)}}nodesSeriesDataUpdate(){this._nodesSeriesData.updateData(),this._nodeList=null,this._setNodeOrdinalColorScale()}linksSeriesDataUpdate(){this._linksSeriesData.updateData()}_highLightElements(e,i){e&&e.length&&e.forEach(n=>{n.removeState([STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE,STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS]),i.includes(n.getDatum().key)?n.addState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS):n.addState(STATE_VALUE_ENUM.STATE_SANKEY_EMPHASIS_REVERSE)})}initTooltip(){this._tooltipHelper=new SankeySeriesTooltipHelper(this),this._nodeMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nodeMark),this._linkMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._linkMark)}_setNodeOrdinalColorScale(){var e,i,n,o,l;const d=(i=(e=this._option)===null||e===void 0?void 0:e.globalScale)===null||i===void 0?void 0:i.getScale("color");if(d!=null&&d._specified)return void(this._colorScale=d);let u,f;d&&(u=d.domain(),f=d.range()),f||(f=this._getDataScheme()),u&&!isNil(u[0])||(u=this.getNodeList(),u.length>10&&(f=(n=this._getDataScheme()[1])===null||n===void 0?void 0:n.scheme));const g=new ColorOrdinalScale;(l=(o=g.domain(u)).range)===null||l===void 0||l.call(o,f),this._colorScale=g}getNodeList(){var e,i;if(this._nodeList)return this._nodeList;const n=this._rawData.latestData[0],o=n!=null&&n.nodes?!((e=n.nodes[0])===null||e===void 0)&&e.children?Array.from(this.extractNamesFromTree(n.nodes,this._spec.categoryField)):n.nodes.map((l,d)=>l[this._spec.categoryField]):n!=null&&n.links?Array.from(this.extractNamesFromLink(n.links)):(i=n==null?void 0:n.values)===null||i===void 0?void 0:i.map((l,d)=>l[this._spec.categoryField]);return this._nodeList=o,o}_getNodeNameFromData(e){var i;return e!=null&&e.datum?e.datum[this._spec.categoryField]:(i=e.key)!==null&&i!==void 0?i:e[this._spec.categoryField]}extractNamesFromTree(e,i){const n=new Set;return e.forEach(o=>{n.add(o[i]),o.children&&this.extractNamesFromTree(o.children,i).forEach(l=>n.add(l))}),n}extractNamesFromLink(e){const i=new Set,{sourceField:n,targetField:o}=this._spec;return e.forEach(l=>{isValid(l[n])&&i.add(l[n]),isValid(l[o])&&i.add(l[o])}),i}getDimensionField(){return[this._spec.categoryField]}getMeasureField(){return[this._valueField]}getRawDataStatisticsByField(e,i){var n;return this._rawStatisticsCache||(this._rawStatisticsCache={}),!this._rawStatisticsCache[e]&&(this._viewDataStatistics&&this.getViewData().transformsArr.length<=1&&(!((n=this._viewDataStatistics.latestData)===null||n===void 0)&&n[e])?this._rawStatisticsCache[e]=this._viewDataStatistics.latestData[e]:this._rawData&&(this._rawStatisticsCache[e]={values:this._collectByField(e)})),this._rawStatisticsCache[e]}_collectByField(e){var i,n,o;const l=[],d=(n=(i=this.getRawData())===null||i===void 0?void 0:i.latestData)===null||n===void 0?void 0:n[0];if(!d)return[];if(d.links)!((o=d.nodes)===null||o===void 0)&&o.length&&d.nodes.forEach(u=>{u[this._seriesField]&&l.push(u[this._seriesField])});else if(d.nodes){const u=new Set;return collectHierarchyField(u,d.nodes,this._seriesField),Array.from(u)}return l}onLayoutEnd(e){super.onLayoutEnd(e),this._viewBox.set(0,0,this._region.getLayoutRect().width,this._region.getLayoutRect().height),this.getViewData().reRunAllTransform()}getDefaultShapeType(){return"square"}_noAnimationDataKey(e,i){}getActiveMarks(){return[this._nodeMark,this._linkMark]}getMarkData(e){return e.datum?isArray(e.datum)?e.datum[e.datum.length-1]:e.datum:e}}SankeySeries.type=SeriesTypeEnum.sankey,SankeySeries.transformerConstructor=SankeySeriesSpecTransformer,SankeySeries.mark=sankeySeriesMark;const registerSankeySeries=()=>{registerSankeyTransforms(),registerRectMark(),registerLinkPathMark(),registerTextMark(),registerSankeyAnimation(),registerFadeInOutAnimation(),Factory$1.registerSeries(SankeySeries.type,SankeySeries)},hierarchyDimensionStatistics=(r,e)=>{let i={},n=e.fields;if(isFunction(n)&&(n=n()),!(n!=null&&n.length)||!(r!=null&&r.length)||!r[0].latestData)return i;const o=r[0].latestData,l=flatten(o);return i=dimensionStatistics([{latestData:l}],e),i};class TreemapTooltipHelper extends BaseSeriesTooltipHelper{constructor(){super(...arguments),this.markTooltipKeyCallback=e=>{var i,n;return(n=(i=this.series)===null||i===void 0?void 0:i.getMarkData(e))===null||n===void 0?void 0:n[this.series.getDimensionField()[0]]},this.markTooltipValueCallback=e=>{var i,n;const{measureFields:o}=this._seriesCacheInfo,l=(i=this.series)===null||i===void 0?void 0:i.getMarkData(e);if(o[0]&&l)return(n=l[o[0]])!==null&&n!==void 0?n:e.value},this.dimensionTooltipTitleCallback=e=>{var i;const{dimensionFields:n}=this._seriesCacheInfo,o=(i=this.series)===null||i===void 0?void 0:i.getMarkData(e);if(n[0]&&o)return o[n[0]]}}get defaultShapeType(){return"square"}}const treemapSeriesMark=Object.assign(Object.assign({},baseSeriesMark),{nonLeaf:{name:"nonLeaf",type:"rect"},leaf:{name:"leaf",type:"rect"},nonLeafLabel:{name:"nonLeafLabel",type:"text"}}),treemapPresetAnimation=r=>r==="fadeIn"?{type:"fadeIn"}:{type:"growCenterIn"},registerTreemapAnimation=()=>{Factory$1.registerAnimation("treemap",(r,e)=>({appear:treemapPresetAnimation(e),enter:{type:"growCenterIn"},exit:{type:"growCenterOut"},disappear:{type:"growCenterOut"}}))};class TreemapSeriesSpecTransformer extends BaseSeriesSpecTransformer{_transformLabelSpec(e){this._addMarkLabelSpec(e,"nonLeaf","nonLeafLabel","initNonLeafLabelMarkStyle"),this._addMarkLabelSpec(e,"leaf")}}class TreemapSeries extends CartesianSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.treemap,this.transformerConstructor=TreemapSeriesSpecTransformer,this._categoryField="name",this._valueField="value",this._viewBox=new Bounds,this._enableAnimationHook=this.enableMarkAnimation.bind(this),this.isHierarchyData=()=>!0}getCategoryField(){return this._categoryField}setCategoryField(e){return this._categoryField=e,this._categoryField}getValueField(){return this._valueField}setValueField(e){return this._valueField=e,this._valueField}setAttrFromSpec(){var e;super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField((e=this._spec.seriesField)!==null&&e!==void 0?e:DEFAULT_HIERARCHY_ROOT),this._spec.roam&&(this.initZoomable(this.event,this._option.mode),this._matrix=new Matrix),this._spec.drill&&this.initDrillable({event:this.event,mode:this._option.mode,drillField:()=>{var i,n;return(n=(i=this._spec.drillField)!==null&&i!==void 0?i:this._categoryField)!==null&&n!==void 0?n:DEFAULT_DATA_KEY},getRawData:()=>this.getRawData()}),isValidNumber(this._spec.maxDepth)&&(this._maxDepth=this._spec.maxDepth-1)}initData(){super.initData(),this.getViewData()&&this._spec.drill&&this.initDrillableData(this._dataSet)}compile(){super.compile(),this._runTreemapTransform()}_runTreemapTransform(e=!1){var i,n,o,l;const d=this._data.getProduct();d&&d.transform([{type:"treemap",nameField:this._categoryField,valueField:this._valueField,x0:this._viewBox.x1,x1:this._viewBox.x2,y0:this._viewBox.y1,y1:this._viewBox.y2,maxDepth:this._maxDepth,gapWidth:this._spec.gapWidth,padding:this._spec.nodePadding,splitType:this._spec.splitType,aspectRatio:this._spec.aspectRatio,labelPadding:!((i=this._spec.nonLeafLabel)===null||i===void 0)&&i.visible?(n=this._spec.nonLeafLabel)===null||n===void 0?void 0:n.padding:0,labelPosition:(o=this._spec.nonLeafLabel)===null||o===void 0?void 0:o.position,minVisibleArea:(l=this._spec.minVisibleArea)!==null&&l!==void 0?l:10,minChildrenVisibleArea:this._spec.minChildrenVisibleArea,minChildrenVisibleSize:this._spec.minChildrenVisibleSize,flatten:!0},{type:"map",callback:u=>(u&&[DEFAULT_HIERARCHY_ROOT,"name"].forEach(f=>{u[f]=u.datum[u.depth][this._categoryField]}),u)}]),e&&this.getCompiler().renderNextTick()}_addDataIndexAndKey(){var e;!((e=this._rawData)===null||e===void 0)&&e.dataSet&&(registerDataSetInstanceTransform(this._rawData.dataSet,"addVChartProperty",addVChartProperty),this._rawData.transform({type:"addVChartProperty",options:{beforeCall:initHierarchyKeyMap.bind(this),call:addHierarchyDataKey}}))}getRawDataStatisticsByField(e,i){var n;if(this._rawStatisticsCache||(this._rawStatisticsCache={}),!this._rawStatisticsCache[e]&&this._rawData){const o=hierarchyDimensionStatistics([this._rawData],{fields:[{key:e,operations:i?["min","max"]:["values"]}]})[e];this._rawStatisticsCache[e]=merge$1((n=this._rawStatisticsCache[e])!==null&&n!==void 0?n:{},o)}return this._rawStatisticsCache[e]}_createHierarchyDataStatistics(e,i){registerDataSetInstanceTransform(this._dataSet,"hierarchyDimensionStatistics",hierarchyDimensionStatistics),registerDataSetInstanceTransform(this._dataSet,"flatten",flatten);const n=new DataView(this._dataSet,{name:e});return n.parse(i,{type:"dataview"}),n.transform({type:"hierarchyDimensionStatistics",options:{fields:()=>{const o=this.getStatisticFields();return this._seriesField&&this._seriesField!==this._categoryField&&o.push({key:this._seriesField,operations:["values"]}),o}}},!1),n}getStatisticFields(){return appendHierarchyFields(super.getStatisticFields(),this._categoryField,this._valueField)}initMark(){var e,i,n,o;const l=this._createMark(TreemapSeries.mark.nonLeaf,{isSeriesMark:!0,stateSort:(e=this._spec.nonLeaf)===null||e===void 0?void 0:e.stateSort},{setCustomizedShape:(i=this._spec.nonLeaf)===null||i===void 0?void 0:i.customShape});l&&(l.setTransform([{type:"filter",callback:u=>!this._shouldFilterElement(u,"nonLeaf")}]),this._nonLeafMark=l);const d=this._createMark(TreemapSeries.mark.leaf,{isSeriesMark:!0,stateSort:(n=this._spec.leaf)===null||n===void 0?void 0:n.stateSort},{setCustomizedShape:(o=this._spec.leaf)===null||o===void 0?void 0:o.customShape});d&&(d.setTransform([{type:"filter",callback:u=>!this._shouldFilterElement(u,"leaf")}]),this._leafMark=d)}initMarkStyle(){this._initLeafMarkStyle(),this._initNonLeafMarkStyle()}_initLeafMarkStyle(){this._leafMark&&this.setMarkStyle(this._leafMark,{x:e=>e.x0,y:e=>e.y0,x1:e=>e.x1,y1:e=>e.y1,fill:this.getColorAttribute()},STATE_VALUE_ENUM.STATE_NORMAL,AttributeLevel.Series)}_initNonLeafMarkStyle(){this._nonLeafMark&&this.setMarkStyle(this._nonLeafMark,{x:e=>e.x0,y:e=>e.y0,x1:e=>e.x1,y1:e=>e.y1,fill:this.getColorAttribute()},STATE_VALUE_ENUM.STATE_NORMAL,AttributeLevel.Series)}_initRichStyleOfLabelMark(e){e.getTextType()==="rich"&&this.setMarkStyle(e,{maxWidth:i=>Math.abs(i.x0-i.x1),maxHeight:i=>Math.abs(i.y0-i.y1),ellipsis:!0},STATE_VALUE_ENUM.STATE_NORMAL,AttributeLevel.Series)}initLabelMarkStyle(e){e&&(this._labelMark=e,e.setRule("treemap"),this.setMarkStyle(e,{x:i=>(i.x0+i.x1)/2,y:i=>(i.y0+i.y1)/2,text:i=>{var n;return(n=i.datum[i.depth])===null||n===void 0?void 0:n[this.getDimensionField()[0]]},maxLineWidth:i=>i.x1===i.x0?Number.MIN_VALUE:i.x1-i.x0},STATE_VALUE_ENUM.STATE_NORMAL,AttributeLevel.Series),this._initRichStyleOfLabelMark(e))}initNonLeafLabelMarkStyle(e){e&&(this._nonLeafLabelMark=e,e.setRule("treemap"),this.setMarkStyle(e,{x:i=>i.labelRect?(i.labelRect.x0+i.labelRect.x1)/2:(i.x0+i.x1)/2,y:i=>i.labelRect?(i.labelRect.y0+i.labelRect.y1)/2:(i.y0+i.y1)/2,text:i=>{var n;return(n=i.datum[i.depth])===null||n===void 0?void 0:n[this.getDimensionField()[0]]},maxLineWidth:i=>i.x1===i.x0?Number.MIN_VALUE:i.x1-i.x0},STATE_VALUE_ENUM.STATE_NORMAL,AttributeLevel.Series),this._initRichStyleOfLabelMark(e))}initAnimation(){this.getMarksInType("rect").forEach(e=>{var i;e.setAnimationConfig(animationConfig((i=Factory$1.getAnimationInKey("treemap"))===null||i===void 0?void 0:i(),userAnimationConfig(e.name,this._spec,this._markAttributeContext)))})}initEvent(){super.initEvent(),this._spec.roam&&(this.initDragEventOfSeries(this),this.event.on("panmove",e=>{this.handlePan(e)}),this.initZoomEventOfSeries(this),this.event.on("zoom",e=>{this.handleZoom(e)})),this._spec.drill&&this.bindDrillEvent()}_getDataIdKey(){return"key"}initTooltip(){this._tooltipHelper=new TreemapTooltipHelper(this),this._leafMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._leafMark),this._nonLeafMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nonLeafMark)}_shouldFilterElement(e,i){const n=e.isLeaf;return i==="leaf"?!n:n}handlePan(e){const{delta:i}=e;if(i[0]===0&&i[1]===0)return;this._matrix.reset(),this._matrix.translate(i[0],i[1]);const{a:n,b:o,c:l,d,e:u,f}=this._matrix;this._matrix.multiply(n,o,l,d,u,f),this._viewBox.transformWithMatrix(this._matrix),this._runTreemapTransform(!0)}handleZoom(e){const{scale:i,scaleCenter:n}=e;if(i===1)return;this._matrix.reset();const{x:o,y:l}=n;this._matrix.translate(o,l),this._matrix.scale(i,i),this._matrix.translate(-o,-l);const{a:d,b:u,c:f,d:g,e:_,f:y}=this._matrix;this._matrix.multiply(d,u,f,g,_,y),this.disableMarkAnimation(),this.event.on(HOOK_EVENT.AFTER_DO_RENDER,this._enableAnimationHook),this._viewBox.transformWithMatrix(this._matrix),this._runTreemapTransform(!0)}getDimensionField(){return[this._categoryField]}getMeasureField(){return[this._valueField]}onLayoutEnd(e){super.onLayoutEnd(e),this._viewBox.set(0,0,this.getLayoutRect().width,this.getLayoutRect().height),this._runTreemapTransform()}enableMarkAnimation(){this.getMarks().forEach(e=>{var i;(i=e.getProduct().animate)===null||i===void 0||i.enable()}),[this._labelMark,this._nonLeafLabelMark].forEach(e=>{e&&e.getComponent()&&e.getComponent().getProduct().getGroupGraphicItem().enableAnimation()}),this.event.off(HOOK_EVENT.AFTER_DO_RENDER,this._enableAnimationHook)}disableMarkAnimation(){this.getMarks().forEach(e=>{var i;(i=e.getProduct().animate)===null||i===void 0||i.disable()}),[this._labelMark,this._nonLeafLabelMark].forEach(e=>{e&&e.getComponent()&&e.getComponent().getProduct().getGroupGraphicItem().disableAnimation()})}getDefaultShapeType(){return"square"}getActiveMarks(){return[this._nonLeafMark,this._leafMark]}getMarkData(e){return e!=null&&e.datum?e.datum[e.datum.length-1]:e}}TreemapSeries.type=SeriesTypeEnum.treemap,TreemapSeries.mark=treemapSeriesMark,TreemapSeries.transformerConstructor=TreemapSeriesSpecTransformer,mixin(TreemapSeries,Drillable),mixin(TreemapSeries,Zoomable);const registerTreemapSeries=()=>{registerFilterTransform(),registerMapTransform(),registerRectMark(),registerTextMark(),registerTreemapAnimation(),registerFadeInOutAnimation(),registerTreemapTransforms(),Factory$1.registerSeries(TreemapSeries.type,TreemapSeries)},gaugeSeriesMark=Object.assign(Object.assign({},progressLikeSeriesMark),{segment:{name:"segment",type:"arc"},track:{name:"track",type:"arc"}}),gaugePointerSeriesMark=Object.assign(Object.assign({},baseSeriesMark),{pin:{name:"pin",type:"path"},pinBackground:{name:"pinBackground",type:"path"},pointer:{name:"pointer",type:["path","rect"]}}),Appear_Grow=r=>({channel:{angle:{from:r.startAngle+Math.PI/2}}}),Appear_FadeIn={type:"fadeIn"};function gaugePointerPresetAnimation(r,e){return e==="fadeIn"?Appear_FadeIn:Appear_Grow(r)}const registerGaugePointerAnimation=()=>{Factory$1.registerAnimation("gaugePointer",(r,e)=>{const i=gaugePointerPresetAnimation(r,e);return{appear:i,enter:i,disappear:{type:"fadeOut"}}})};class GaugePointerSeriesSpecTransformer extends BaseSeriesSpecTransformer{constructor(){super(...arguments),this._supportStack=!1}}class GaugePointerTooltipHelper extends BaseSeriesTooltipHelper{enableByType(e){return e!=="dimension"}}class GaugePointerSeries extends ProgressLikeSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.gaugePointer,this.transformerConstructor=GaugePointerSeriesSpecTransformer,this._pinMark=null,this._pointerMark=null,this._pinBackgroundMark=null}setAttrFromSpec(){var e;super.setAttrFromSpec(),this.setRadiusField(this._spec.radiusField),this._pointerType=((e=this._spec.pointer)===null||e===void 0?void 0:e.type)==="rect"?"rect":"path"}initMark(){this._pinBackgroundMark=this._createMark(GaugePointerSeries.mark.pinBackground),this._pointerMark=this._createMark(Object.assign(Object.assign({},GaugePointerSeries.mark.pointer),{type:this._pointerType}),{isSeriesMark:!0}),this._pinMark=this._createMark(GaugePointerSeries.mark.pin)}initMarkStyle(){this.initPinBackgroundMarkStyle(),this.initPointerMarkStyle(),this.initPinMarkStyle()}initGroups(){}initPointerMarkStyle(){const e=this._pointerMark,i=this._spec.pointer;e&&(this.setMarkStyle(e,{x:n=>{var o,l;const{x:d}=this._getPointerAnchor(n,i);return d-this._getPointerWidth()*((l=(o=i==null?void 0:i.center)===null||o===void 0?void 0:o[0])!==null&&l!==void 0?l:0)},y:n=>{var o,l;const{y:d}=this._getPointerAnchor(n,i);return d-this._getPointerHeight(n)*((l=(o=i==null?void 0:i.center)===null||o===void 0?void 0:o[1])!==null&&l!==void 0?l:0)},anchor:n=>{const{x:o,y:l}=this._getPointerAnchor(n,i);return[o,l]},fill:this.getColorAttribute(),zIndex:200}),this._pointerType==="path"?this.setMarkStyle(e,{scaleX:this._getPointerWidth.bind(this),scaleY:this._getPointerHeight.bind(this),angle:n=>this._getPointerAngle(n)+Math.PI/2}):this.setMarkStyle(e,{width:this._getPointerWidth.bind(this),height:this._getPointerHeight.bind(this),angle:n=>this._getPointerAngle(n)-Math.PI/2}))}initTooltip(){this._tooltipHelper=new GaugePointerTooltipHelper(this),this._pointerMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._pointerMark)}_getPointerAnchor(e,i){var n;return(n=i.isOnCenter)===null||n===void 0||n?this.angleAxisHelper.center():this.radiusAxisHelper.coordToPoint({radius:this._innerRadius*this._computeLayoutRadius(),angle:this.angleAxisHelper.dataToPosition([e[this._angleField[0]]])})}_getPointerWidth(){return this._spec.pointer.width*this._computeLayoutRadius()}_getPointerHeight(e){var i,n;const o=this._spec.pointer,l=this._radiusField[0];return isValid(this.radiusAxisHelper)&&isValid(l)?this.radiusAxisHelper.dataToPosition([e[l]])-((i=o==null?void 0:o.innerPadding)!==null&&i!==void 0?i:0)-((n=o==null?void 0:o.outerPadding)!==null&&n!==void 0?n:10):o.height*this._computeLayoutRadius()}_getPointerAngle(e){const i=this.angleAxisHelper.getScale().domain(),n=maxInArray(i),o=minInArray(i),l=clamp(e[this._angleField[0]],o,n);return this.angleAxisHelper.dataToPosition([l])}_getRotatedPointerCenterOffset(e){var i,n,o,l;const d=this._spec.pointer,u=this._getPointerWidth()*((n=(i=d==null?void 0:d.center)===null||i===void 0?void 0:i[0])!==null&&n!==void 0?n:0),f=-this._getPointerHeight(e)*((l=(o=d==null?void 0:d.center)===null||o===void 0?void 0:o[1])!==null&&l!==void 0?l:0),g=this._getPointerAngle(e)-Math.PI/2,_=Math.cos(g),y=Math.sin(g);return{x:u*_+f*y,y:-(f*_-u*y)}}initPinBackgroundMarkStyle(){const e=this._pinBackgroundMark,i=this._spec.pinBackground;e&&this.setMarkStyle(e,{x:n=>this._getPointerAnchor(n,i).x,y:n=>this._getPointerAnchor(n,i).y,scaleX:()=>i.width*this._computeLayoutRadius(),scaleY:()=>i.height*this._computeLayoutRadius(),fill:this.getColorAttribute(),zIndex:100})}initPinMarkStyle(){const e=this._pinMark,i=this._spec.pin;e&&this.setMarkStyle(e,{x:n=>this._getPointerAnchor(n,i).x,y:n=>this._getPointerAnchor(n,i).y,scaleX:()=>i.width*this._computeLayoutRadius(),scaleY:()=>i.height*this._computeLayoutRadius(),fill:this.getColorAttribute(),zIndex:300})}initInteraction(){this._parseInteractionConfig(this._pointerMark?[this._pointerMark]:[])}initAnimation(){var e,i,n;const o=(i=(e=this._spec)===null||e===void 0?void 0:e.animationAppear)===null||i===void 0?void 0:i.preset;this._pointerMark.setAnimationConfig(animationConfig((n=Factory$1.getAnimationInKey("gaugePointer"))===null||n===void 0?void 0:n({startAngle:this._startAngle},o),userAnimationConfig("pointer",this._spec,this._markAttributeContext)))}getDefaultShapeType(){return"circle"}getActiveMarks(){return[]}}GaugePointerSeries.type=SeriesTypeEnum.gaugePointer,GaugePointerSeries.mark=gaugePointerSeriesMark,GaugePointerSeries.transformerConstructor=GaugePointerSeriesSpecTransformer;const registerGaugePointerSeries=()=>{Factory$1.registerSeries(GaugePointerSeries.type,GaugePointerSeries),registerPathMark(),registerRectMark(),registerGaugePointerAnimation(),registerPolarBandAxis(),registerPolarLinearAxis()};class GaugeSeriesSpecTransformer extends BaseSeriesSpecTransformer{constructor(){super(...arguments),this._supportStack=!1}_transformLabelSpec(e){this._addMarkLabelSpec(e,"segment")}}class GaugeSeries extends ProgressLikeSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.gauge,this.transformerConstructor=GaugeSeriesSpecTransformer,this._segmentMark=null,this._trackMark=null,this._padAngle=0}setAttrFromSpec(){var e;super.setAttrFromSpec(),this._padAngle=degreeToRadian((e=this._spec.padAngle)!==null&&e!==void 0?e:0)}initData(){var e;super.initData(),registerDataSetInstanceTransform(this._option.dataSet,"spiltSegment",(i,n)=>{const o=i.slice();return o.sort((l,d)=>l[this._angleField[0]]-d[this._angleField[0]]),o.forEach((l,d)=>{l[SEGMENT_FIELD_END]=l[this._angleField[0]],l[SEGMENT_FIELD_START]=d>0?o[d-1][SEGMENT_FIELD_END]:void 0}),o}),(e=this.getViewData())===null||e===void 0||e.transform({type:"spiltSegment"},!1)}initMark(){super.initMark(),this._trackMark=this._createMark(GaugeSeries.mark.track,{parent:this._arcGroupMark,dataView:!1}),this._segmentMark=this._createMark(GaugeSeries.mark.segment,{parent:this._arcGroupMark,isSeriesMark:!0})}initMarkStyle(){super.initMarkStyle(),this.initTrackMarkStyle(),this.initSegmentMarkStyle()}initSegmentMarkStyle(){var e;const i=this._segmentMark;i&&this.setMarkStyle(i,{x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y,startAngle:this._getAngleValueStart.bind(this),endAngle:this._getAngleValueEnd.bind(this),innerRadius:()=>{var n;return this._computeLayoutRadius()*((n=this._spec.innerRadius)!==null&&n!==void 0?n:0)},outerRadius:()=>{var n,o;return this._computeLayoutRadius()*((o=(n=this._spec.radius)!==null&&n!==void 0?n:this._spec.outerRadius)!==null&&o!==void 0?o:1)},cap:(e=this._spec.roundCap)!==null&&e!==void 0&&e,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,fill:this.getColorAttribute(),zIndex:200,forceShowCap:!0})}generateRadiusStyle(e){if(!e)return;const i={};return e.outerRadius&&(i.outerRadius=()=>this._computeLayoutRadius()*e.outerRadius),e.innerRadius&&(i.innerRadius=()=>this._computeLayoutRadius()*e.innerRadius),i}initMarkStyleWithSpec(e,i,n){if(super.initMarkStyleWithSpec(e,i,n),e&&e.name==="segment"){const o=this.getSpec().segment;if(o)for(const l in o.state||{})this.setMarkStyle(e,this.generateRadiusStyle(o.state[l]),l,AttributeLevel.User_Mark)}}initTooltip(){super.initTooltip(),this._segmentMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._segmentMark)}initTrackMarkStyle(){var e;const i=this._trackMark;i&&this.setMarkStyle(i,{x:()=>this.angleAxisHelper.center().x,y:()=>this.angleAxisHelper.center().y,startAngle:this._startAngle,endAngle:this._endAngle,innerRadius:()=>{var n;return this._computeLayoutRadius()*((n=this._spec.innerRadius)!==null&&n!==void 0?n:0)},outerRadius:()=>{var n,o;return this._computeLayoutRadius()*((o=(n=this._spec.radius)!==null&&n!==void 0?n:this._spec.outerRadius)!==null&&o!==void 0?o:1)},cap:(e=this._spec.roundCap)!==null&&e!==void 0&&e,boundsMode:"imprecise",cornerRadius:this._spec.cornerRadius,zIndex:100})}_getAngleValueStartWithoutMask(e){const i=this._getAngleValueStartWithoutPadAngle(e),n=this._getAngleValueEndWithoutPadAngle(e);return clamper(i,(i+n)/2)(i+(n>i?1:-1)*Math.abs(this._padAngle/2))}_getAngleValueEndWithoutMask(e){const i=this._getAngleValueStartWithoutPadAngle(e),n=this._getAngleValueEndWithoutPadAngle(e);return clamper(n,(i+n)/2)(n-(n>i?1:-1)*Math.abs(this._padAngle/2))}_getAngleValueStartWithoutPadAngle(e){return isValid(e[SEGMENT_FIELD_START])?this.angleAxisHelper.dataToPosition([e[SEGMENT_FIELD_START]]):this._startAngle}_getAngleValueEndWithoutPadAngle(e){return this.angleAxisHelper.dataToPosition([e[SEGMENT_FIELD_END]])}initAnimation(){var e,i,n;const o=(i=(e=this._spec)===null||e===void 0?void 0:e.animationAppear)===null||i===void 0?void 0:i.preset;this._segmentMark.setAnimationConfig(animationConfig((n=Factory$1.getAnimationInKey("circularProgress"))===null||n===void 0?void 0:n({startAngle:this._startAngle},o),userAnimationConfig("segment",this._spec,this._markAttributeContext)))}getDefaultShapeType(){return"circle"}getActiveMarks(){return[]}}GaugeSeries.type=SeriesTypeEnum.gauge,GaugeSeries.mark=gaugeSeriesMark,GaugeSeries.transformerConstructor=GaugeSeriesSpecTransformer;const registerGaugeSeries=()=>{Factory$1.registerSeries(GaugeSeries.type,GaugeSeries),registerArcMark(),registerProgressLikeAnimation(),registerPolarLinearAxis()};class CellMark extends BaseSymbolMark{constructor(){super(...arguments),this.type=CellMark.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{padding:0})}}CellMark.type="cell";const registerCellMark=()=>{Factory$1.registerMark(CellMark.type,CellMark),registerCellGraphic(),registerCellMark$1()};function heatmapPresetAnimation(r){return r===!1?{}:{type:"fadeIn"}}const registerHeatmapAnimation=()=>{Factory$1.registerAnimation("heatmap",(r,e)=>Object.assign(Object.assign({},FadeInOutAnimation),{appear:heatmapPresetAnimation(e)}))};class HeatmapSeriesTooltipHelper extends BaseSeriesTooltipHelper{enableByType(e){return e!=="dimension"}}const heatmapSeriesMark=Object.assign(Object.assign({},baseSeriesMark),{cell:{name:"cell",type:"cell"},cellBackground:{name:"cellBackground",type:"cell"}});class HeatmapSeriesSpecTransformer extends BaseSeriesSpecTransformer{_transformLabelSpec(e){this._addMarkLabelSpec(e,"cell")}}class HeatmapSeries extends CartesianSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.heatmap,this.transformerConstructor=HeatmapSeriesSpecTransformer}getFieldValue(){return this._fieldValue}setFieldValue(e){this._fieldValue=array(e)}setAttrFromSpec(){super.setAttrFromSpec(),this.setFieldValue(this._spec.valueField)}initMark(){var e,i,n,o;const l={progressiveStep:this._spec.progressiveStep,progressiveThreshold:this._spec.progressiveThreshold,large:this._spec.large,largeThreshold:this._spec.largeThreshold};this._cellMark=this._createMark(HeatmapSeries.mark.cell,{isSeriesMark:!0,stateSort:(e=this._spec.cell)===null||e===void 0?void 0:e.stateSort},Object.assign(Object.assign({},l),{setCustomizedShape:(i=this._spec.cell)===null||i===void 0?void 0:i.customShape,morph:shouldMarkDoMorph(this._spec,HeatmapSeries.mark.cell.name),morphElementKey:this.getDimensionField()[0]})),this._backgroundMark=this._createMark(HeatmapSeries.mark.cellBackground,{stateSort:(n=this._spec.cellBackground)===null||n===void 0?void 0:n.stateSort},Object.assign(Object.assign({},l),{setCustomizedShape:(o=this._spec.cellBackground)===null||o===void 0?void 0:o.customShape}))}initMarkStyle(){this.initCellMarkStyle(),this.initCellBackgroundMarkStyle()}initLabelMarkStyle(e){e&&this.setMarkStyle(e,{fill:this.getColorAttribute(),text:i=>i[this.getMeasureField()[0]]})}initCellMarkStyle(){this.setMarkStyle(this._cellMark,{x:e=>this.dataToPositionX(e),y:e=>this.dataToPositionY(e),size:()=>[this.getCellSize(this._xAxisHelper),this.getCellSize(this._yAxisHelper)],fill:this.getColorAttribute()},"normal",AttributeLevel.Series)}initCellBackgroundMarkStyle(){var e,i,n;const o=normalizePadding$1((n=(i=(e=this._spec.cellBackground)===null||e===void 0?void 0:e.style)===null||i===void 0?void 0:i.padding)!==null&&n!==void 0?n:0);this.setMarkStyle(this._backgroundMark,{x:l=>{const d=this.getCellSize(this._xAxisHelper);return this.dataToPositionX(l)-d/2+o[3]},y:l=>{const d=this.getCellSize(this._yAxisHelper);return this.dataToPositionY(l)-d/2+o[0]},width:()=>this.getCellSize(this._xAxisHelper)-o[1]-o[3],height:()=>this.getCellSize(this._yAxisHelper)-o[0]-o[2]},"normal",AttributeLevel.Series)}getColorAttribute(){var e;return{scale:(e=this._option.globalScale.getScale("color"))!==null&&e!==void 0?e:this._getDefaultColorScale(),field:this.getFieldValue[0]}}initInteraction(){this._parseInteractionConfig(this._cellMark?[this._cellMark]:[])}initAnimation(){var e,i,n;const o=(i=(e=this._spec)===null||e===void 0?void 0:e.animationAppear)===null||i===void 0?void 0:i.preset,l=getGroupAnimationParams(this);this._cellMark.setAnimationConfig(animationConfig((n=Factory$1.getAnimationInKey("heatmap"))===null||n===void 0?void 0:n(o),userAnimationConfig("cell",this._spec,this._markAttributeContext),l))}getCellSize(e){var i,n;return(n=(i=e.getBandwidth)===null||i===void 0?void 0:i.call(e,0))!==null&&n!==void 0?n:6}initTooltip(){this._tooltipHelper=new HeatmapSeriesTooltipHelper(this),this._cellMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._cellMark)}getDefaultShapeType(){return"square"}getDimensionField(){return[].concat(this.fieldX,this.fieldY)}getMeasureField(){return this.getFieldValue()}getActiveMarks(){return[this._cellMark]}}HeatmapSeries.type=SeriesTypeEnum.heatmap,HeatmapSeries.mark=heatmapSeriesMark,HeatmapSeries.transformerConstructor=HeatmapSeriesSpecTransformer;const registerHeatmapSeries=()=>{registerTextMark(),registerCellMark(),registerHeatmapAnimation(),registerCartesianBandAxis(),registerCartesianLinearAxis(),Factory$1.registerSeries(HeatmapSeries.type,HeatmapSeries)},correlationSeriesMark=Object.assign(Object.assign({},baseSeriesMark),{nodePoint:{name:"nodePoint",type:"symbol"},ripplePoint:{name:"ripplePoint",type:"ripple"},centerPoint:{name:"centerPoint",type:"symbol"},centerLabel:{name:"centerLabel",type:"text"}}),CORRELATION_X=`${PREFIX}_CORRELATION_X`,CORRELATION_Y=`${PREFIX}_CORRELATION_Y`,CORRELATION_SIZE=`${PREFIX}_CORRELATION_SIZE`,correlation=(r,e)=>{var i,n,o,l,d,u,f,g,_,y,b,S,v,A,x;if(!r||!(e!=null&&e.view)||!isArray(r))return r;const T=e.view();if(T.x1-T.x0==0||T.y1-T.y0==0||T.x1-T.x0==-1/0||T.x1-T.x0==1/0||T.y1-T.y0==-1/0||T.y1-T.y0==1/0)return r;const C=degreeToRadian((i=e.startAngle)!==null&&i!==void 0?i:-90),E=degreeToRadian((n=e.endAngle)!==null&&n!==void 0?n:270),P=Math.max((T.x1-T.x0)/2,(T.y1-T.y0)/2),R=toPercent((o=e.innerRadius)!==null&&o!==void 0?o:0,P),L=toPercent(e.outerRadius,P),w=[isNumber((l=e.center)===null||l===void 0?void 0:l[0])?e.center[0]:T.x0+toPercent((u=(d=e.center)===null||d===void 0?void 0:d[0])!==null&&u!==void 0?u:"50%",T.x1-T.x0),isNumber((f=e.center)===null||f===void 0?void 0:f[1])?e.center[1]:T.y0+toPercent((_=(g=e.center)===null||g===void 0?void 0:g[1])!==null&&_!==void 0?_:"50%",T.y1-T.y0)],B=field$3(e.field),I=r.map(B),[D,O]=extent$2(I),N=D===O?te=>(R+L)/2:te=>R+(L-R)*(te-D)/(O-D),V=isNil(e.radiusField)?B:field$3(e.radiusField),H=(b=(y=e==null?void 0:e.radiusRange)===null||y===void 0?void 0:y[1])!==null&&b!==void 0?b:5;let F=te=>H;if(V){const[te,ue]=V!==B?extent$2(r.map(V)):[D,O],he=(v=(S=e.radiusRange)===null||S===void 0?void 0:S[0])!==null&&v!==void 0?v:5,fe=(x=(A=e.radiusRange)===null||A===void 0?void 0:A[1])!==null&&x!==void 0?x:5;te!==ue&&(F=pe=>he+(fe-he)*(V(pe)-te)/(ue-te))}const $=Math.min(C,E),G=Math.max(C,E),Y=getPartialAngles($,G,r.length),Q=[],q=(G-$)/60;return r.forEach((te,ue)=>{const he=N(I[ue]),fe=F(te);let pe,me,ee=Y[ue];for(let J=0;J<60&&(pe=w[0]+he*Math.cos(ee),me=w[1]+he*Math.sin(ee),hasOverlap({x:pe,y:me,size:fe},Q)||pe-fe<T.x0||pe+fe>T.x1||me-fe<T.y0||me+fe>T.y1);J++)J<59&&(ee+=q,ee>G?ee=$:ee<$&&(ee=G));Q.push(Object.assign({[CORRELATION_X]:pe,[CORRELATION_Y]:me,[CORRELATION_SIZE]:fe},te))}),Q},getPartialAngles=(r,e,i)=>{let n=0,o=Math.max(Math.ceil(2*(e-r)/Math.PI),2),l=(e-r)/o,d=0,u=1,f=0,g=0;const _=[];let y=r;for(;f<i;)g<o&&(_.push(y+(g%2?Math.floor(g/2)+Math.floor(o/2):g/2)*l*u),g++),f++,g===o&&(g=0,d+=1,u*=-1,n===0?n=l/2:n/=2,y=u===-1?e-n:r+n,d>=2&&(l/=2,o*=2));return _},hasOverlap=(r,e)=>!(!e||!e.length)&&e.some(i=>Math.pow(r.x-i.x,2)+Math.pow(r.y-i.y,2)<Math.pow(r.size+i.size,2)),correlationCenter=(r,e)=>{if(!r||!isArray(r))return[];const{keyword:i,categoryField:n}=e,o=r[0].latestData[0];return{[n]:i,[DEFAULT_DATA_INDEX]:o==null?void 0:o[DEFAULT_DATA_INDEX],[DEFAULT_DATA_SERIES_FIELD]:o==null?void 0:o[DEFAULT_DATA_SERIES_FIELD]}};class RippleMark extends BaseMark{constructor(){super(...arguments),this.type=RippleMark.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{x:0,y:0,ripple:0})}_initProduct(e){const i=this.getVGrammarView(),n=this.getProductId();this._product=i.glyph("ripplePoint",e??i.rootMark).id(n),this._compiledProductId=n}}RippleMark.type="ripple";const registerRippleMark=()=>{Factory$1.registerMark(RippleMark.type,RippleMark),registerRippleGlyph()},correlationPresetAnimation=(r,e)=>e==="fadeIn"?{type:"fadeIn"}:{type:"scaleIn"},registerCorrelationAnimation=()=>{Factory$1.registerAnimation("correlation",(r,e)=>Object.assign({appear:correlationPresetAnimation(0,e)},ScaleInOutAnimation))};class CorrelationSeriesSpecTransformer extends BaseSeriesSpecTransformer{_transformLabelSpec(e){this._addMarkLabelSpec(e,"nodePoint"),this._addMarkLabelSpec(e,"centerPoint","centerLabel")}}class CorrelationSeries extends PolarSeries{constructor(){super(...arguments),this.type=SeriesTypeEnum.correlation,this.transformerConstructor=CorrelationSeriesSpecTransformer,this._viewBox=new Bounds}getCategoryField(){return this._categoryField}setCategoryField(e){return this._categoryField=e,this._categoryField}getValueField(){return this._valueField}setValueField(e){return this._valueField=e,this._valueField}getSeriesField(){return this._seriesField}setSeriesField(e){isValid(e)&&(this._seriesField=e)}getSizeField(){return this._sizeField}setSizeField(e){isValid(e)&&(this._sizeField=e)}getSizeRange(){return this._sizeRange}setSizeRange(e){isValid(e)&&(this._sizeRange=e)}setAttrFromSpec(){super.setAttrFromSpec(),this.setCategoryField(this._spec.categoryField),this.setValueField(this._spec.valueField),this.setSeriesField(this._spec.seriesField),this.setSizeField(this._spec.sizeField),this.setSizeRange(this._spec.sizeRange)}initData(){var e,i,n;if(super.initData(),!this._data)return;registerDataSetInstanceTransform(this._dataSet,"correlation",correlation);const o=new DataSet;registerDataSetInstanceParser(o,"dataview",dataViewParser),registerDataSetInstanceTransform(o,"correlationCenter",correlationCenter);const l=new DataView(o,{name:`${this.type}_${this.id}_center`});l.parse([this.getViewData()],{type:"dataview"}),l.transform({type:"correlationCenter",options:{keyword:(n=(i=(e=this._spec.centerLabel)===null||e===void 0?void 0:e.style)===null||i===void 0?void 0:i.text)!==null&&n!==void 0?n:"",categoryField:this._spec.categoryField}}),this._centerSeriesData=new SeriesData(this._option,l)}compileData(){var e;super.compileData(),(e=this._centerSeriesData)===null||e===void 0||e.compile()}_statisticViewData(){super._statisticViewData(),this._data.getDataView().transform({type:"correlation",options:{view:()=>({x0:this._viewBox.x1,x1:this._viewBox.x2,y0:this._viewBox.y1,y1:this._viewBox.y2}),field:this._spec.valueField,radiusRange:this._spec.sizeRange,radiusField:this._spec.sizeField,center:[this._spec.centerX,this._spec.centerY],innerRadius:this._spec.innerRadius,outerRadius:this._spec.outerRadius,startAngle:this._spec.startAngle,endAngle:this._spec.endAngle}})}initMark(){var e,i,n,o;const l=this._createMark(CorrelationSeries.mark.nodePoint,{groupKey:this._seriesField,isSeriesMark:!0,key:DEFAULT_DATA_INDEX,stateSort:(e=this._spec.nodePoint)===null||e===void 0?void 0:e.stateSort},{setCustomizedShape:(i=this._spec.nodePoint)===null||i===void 0?void 0:i.customShape});l&&(l.setMarkConfig({zIndex:LayoutZIndex.Node}),this._nodePointMark=l);const d=this._createMark(CorrelationSeries.mark.ripplePoint,{key:DEFAULT_DATA_INDEX,dataView:this._centerSeriesData.getDataView(),dataProductId:this._centerSeriesData.getProductId()});d&&(this._ripplePointMark=d);const u=this._createMark(CorrelationSeries.mark.centerPoint,{key:DEFAULT_DATA_INDEX,dataView:this._centerSeriesData.getDataView(),dataProductId:this._centerSeriesData.getProductId(),stateSort:(n=this._spec.centerPoint)===null||n===void 0?void 0:n.stateSort},{setCustomizedShape:(o=this._spec.centerPoint)===null||o===void 0?void 0:o.customShape});u&&(u.setMarkConfig({zIndex:LayoutZIndex.Node}),this._centerPointMark=u)}initMarkStyle(){this._initNodePointMarkStyle(),this._initRipplePointMarkStyle(),this._initCenterPointMarkStyle()}_initNodePointMarkStyle(){var e,i,n,o;const l=this._nodePointMark;if(!l)return;const d=(i=(e=this._spec.nodePoint)===null||e===void 0?void 0:e.style)!==null&&i!==void 0?i:{};this.setMarkStyle(l,{x:u=>u[CORRELATION_X],y:u=>u[CORRELATION_Y],size:u=>u[CORRELATION_SIZE],fill:(n=d.fill)!==null&&n!==void 0?n:this.getColorAttribute(),fillOpacity:(o=d.fillOpacity)!==null&&o!==void 0?o:1,lineWidth:0},STATE_VALUE_ENUM.STATE_NORMAL,AttributeLevel.Series)}_initRipplePointMarkStyle(){var e,i,n,o,l;const d=this._ripplePointMark;if(!d)return;const u=(i=(e=this._spec.ripplePoint)===null||e===void 0?void 0:e.style)!==null&&i!==void 0?i:{};this.setMarkStyle(d,{x:()=>{var f;return(f=this._spec.centerX)!==null&&f!==void 0?f:(this._viewBox.x1+this._viewBox.x2)/2},y:()=>{var f;return(f=this._spec.centerY)!==null&&f!==void 0?f:(this._viewBox.y1+this._viewBox.y2)/2},size:()=>Math.max(this._viewBox.x2-this._viewBox.x1,this._viewBox.y2-this._viewBox.y1)/2,fill:(n=u.fill)!==null&&n!==void 0?n:this.getColorAttribute(),opacity:(o=u.fillOpacity)!==null&&o!==void 0?o:.2,ripple:(l=u.ripple)!==null&&l!==void 0?l:0},STATE_VALUE_ENUM.STATE_NORMAL,AttributeLevel.Series)}_initCenterPointMarkStyle(){var e,i,n,o,l,d;const u=this._centerPointMark;u&&this.setMarkStyle(u,{x:()=>{var f;return(f=this._spec.centerX)!==null&&f!==void 0?f:(this._viewBox.x1+this._viewBox.x2)/2},y:()=>{var f;return(f=this._spec.centerY)!==null&&f!==void 0?f:(this._viewBox.y1+this._viewBox.y2)/2},size:()=>.2*Math.max(this._viewBox.x2-this._viewBox.x1,this._viewBox.y2-this._viewBox.y1)/2,fill:(n=(i=(e=this._spec.centerPoint)===null||e===void 0?void 0:e.style)===null||i===void 0?void 0:i.fill)!==null&&n!==void 0?n:this.getColorAttribute(),fillOpacity:(d=(l=(o=this._spec.centerPoint)===null||o===void 0?void 0:o.style)===null||l===void 0?void 0:l.fillOpacity)!==null&&d!==void 0?d:1},STATE_VALUE_ENUM.STATE_NORMAL,AttributeLevel.Series)}initTooltip(){super.initTooltip(),this._nodePointMark&&this._tooltipHelper.activeTriggerSet.mark.add(this._nodePointMark)}initLabelMarkStyle(e){e&&this.setMarkStyle(e,{fill:this.getColorAttribute(),text:i=>i[this._categoryField],z:this.dataToPositionZ.bind(this)},STATE_VALUE_ENUM.STATE_NORMAL,AttributeLevel.Series)}initAnimation(){var e,i;const n=(e=this._spec.animationAppear)===null||e===void 0?void 0:e.preset;this._nodePointMark.setAnimationConfig(animationConfig((i=Factory$1.getAnimationInKey("correlation"))===null||i===void 0?void 0:i({},n),userAnimationConfig("nodePoint",this._spec,this._markAttributeContext)))}getGroupFields(){return[]}getStackGroupFields(){return[]}getStackValueField(){return""}getActiveMarks(){return[this._nodePointMark,this._centerPointMark]}getDimensionField(){return[this._categoryField]}getMeasureField(){return[this._valueField]}onLayoutEnd(e){super.onLayoutEnd(e),this._viewBox.set(0,0,this._region.getLayoutRect().width,this._region.getLayoutRect().height),this._rawData.reRunAllTransform(),this.getViewData().reRunAllTransform()}}CorrelationSeries.type=SeriesTypeEnum.correlation,CorrelationSeries.mark=correlationSeriesMark,CorrelationSeries.transformerConstructor=CorrelationSeriesSpecTransformer;const registerCorrelationSeries=()=>{registerSymbolMark(),registerRippleMark(),Factory$1.registerSeries(CorrelationSeries.type,CorrelationSeries),registerCorrelationAnimation()};class MapChartSpecTransformer extends BaseChartSpecTransformer{_isValidSeries(e){return e===SeriesTypeEnum.map}_getDefaultSeriesSpec(e){return super._getDefaultSeriesSpec(e,["type","nameField","valueField","map","nameProperty","centroidProperty","nameMap","area","defaultFillColor","showDefaultName"])}transformSpec(e){super.transformSpec(e),e.region.forEach(i=>{i.coordinate="geo"}),super.transformSeriesSpec(e)}}class MapChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=MapChartSpecTransformer,this.type="map",this.seriesType=SeriesTypeEnum.map}}MapChart.type="map",MapChart.seriesType=SeriesTypeEnum.map,MapChart.transformerConstructor=MapChartSpecTransformer;const registerMapChart=()=>{registerMapSeries(),Factory$1.registerChart(MapChart.type,MapChart)};class PolarChartSpecTransformer extends BaseChartSpecTransformer{_isValidSeries(e){return!this.seriesType||e===this.seriesType}getIndicatorSpec(e){var i,n,o;const l=array(e.indicator),d=(i=e.innerRadius)!==null&&i!==void 0?i:(o=(n=e.series)===null||n===void 0?void 0:n[0])===null||o===void 0?void 0:o.innerRadius;return isValid(d)&&l.forEach(u=>{isNil(u.limitRatio)&&(u.limitRatio=d)}),l}_getDefaultSeriesSpec(e,i){return super._getDefaultSeriesSpec(e,["radius","outerRadius","innerRadius","startAngle","endAngle","sortDataByAxis"],i)}transformSpec(e){super.transformSpec(e),isArray(e.dataZoom)&&e.dataZoom.length>0&&e.dataZoom.forEach(i=>{i.filterMode==="axis"&&(i.filterMode="filter")}),this.transformSeriesSpec(e),isValid(e.indicator)&&(e.indicator=this.getIndicatorSpec(e))}}class ProgressLikeChartSpecTransformer extends PolarChartSpecTransformer{needAxes(){return!1}_getDefaultSeriesSpec(e){const i=super._getDefaultSeriesSpec(e,["startAngle","endAngle","centerX","centerY"]);return i.categoryField=e.categoryField||e.radiusField,i.valueField=e.valueField||e.angleField,i}_transformProgressAxisSpec(e,i,n,o,l){var d,u;e.axes||(e.axes=[]);let f=((d=e.axes)!==null&&d!==void 0?d:[]).find(y=>y.orient==="radius"),g=((u=e.axes)!==null&&u!==void 0?u:[]).find(y=>y.orient==="angle");g||(g=i,e.axes.push(g)),f||(f=n,e.axes.push(f)),isNil(g.type)&&(g.type="linear"),isNil(f.type)&&(f.type="band");const _=getLinearAxisSpecDomain(g,{min:0,max:1});isNil(g.min)&&(g.min=_.min),isNil(g.max)&&(g.max=_.max),o&&Object.assign(g,mergeSpec({},o,g)),l&&Object.assign(f,mergeSpec({},l,f))}}class RoseLikeChartSpecTransformer extends PolarChartSpecTransformer{needAxes(){return!0}_getDefaultSeriesSpec(e){const i=super._getDefaultSeriesSpec(e);return i.categoryField=e.categoryField||e.angleField,i.valueField=e.valueField||e.radiusField,i}transformSpec(e){var i;if(super.transformSpec(e),this.needAxes()){e.axes||(e.axes=[]);const n={radius:!1,angle:!1};((i=e.axes)!==null&&i!==void 0?i:[]).forEach(o=>{const{orient:l}=o;l==="radius"&&(n.radius=!0),l==="angle"&&(n.angle=!0)}),n.angle||e.axes.push({orient:"angle"}),n.radius||e.axes.push({orient:"radius"})}}}class BasePieChartSpecTransformer extends PolarChartSpecTransformer{needAxes(){return!1}_getDefaultSeriesSpec(e){var i;const n=super._getDefaultSeriesSpec(e,["center","centerOffset","cornerRadius","padAngle","minAngle","emptyPlaceholder","showAllZero","supportNegative","layoutRadius"]);return n.categoryField=e.categoryField||e.seriesField,n.valueField=e.valueField||e.angleField,n.emptyCircle=(i=e.emptyPlaceholder)===null||i===void 0?void 0:i.emptyCircle,n}}class BasePieChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=BasePieChartSpecTransformer}}BasePieChart.transformerConstructor=BasePieChartSpecTransformer;class PieChart extends BasePieChart{constructor(){super(...arguments),this.transformerConstructor=BasePieChartSpecTransformer,this.type="pie",this.seriesType=SeriesTypeEnum.pie}}PieChart.type="pie",PieChart.seriesType=SeriesTypeEnum.pie,PieChart.transformerConstructor=BasePieChartSpecTransformer;const registerPieChart=()=>{registerPieSeries(),Factory$1.registerChart(PieChart.type,PieChart)};class Pie3dChartSpecTransformer extends BasePieChartSpecTransformer{transformSpec(e){super.transformSpec(e),e.series.forEach(i=>{i.type==="pie3d"&&(i.angle3d=e.angle3d)})}}class Pie3dChart extends BasePieChart{constructor(){super(...arguments),this.transformerConstructor=Pie3dChartSpecTransformer,this.type="pie3d",this.seriesType=SeriesTypeEnum.pie3d}}Pie3dChart.type="pie3d",Pie3dChart.seriesType=SeriesTypeEnum.pie3d,Pie3dChart.transformerConstructor=Pie3dChartSpecTransformer;const registerPie3dChart=()=>{register3DPlugin(),registerPie3dSeries(),Factory$1.registerChart(Pie3dChart.type,Pie3dChart)};class RoseChartSpecTransformer extends RoseLikeChartSpecTransformer{_getDefaultSeriesSpec(e){var i,n,o;const l=super._getDefaultSeriesSpec(e);return l.radius=(i=e.radius)!==null&&i!==void 0?i:POLAR_DEFAULT_RADIUS,l.outerRadius=(n=e.outerRadius)!==null&&n!==void 0?n:POLAR_DEFAULT_RADIUS,l.innerRadius=(o=e.innerRadius)!==null&&o!==void 0?o:0,l.stack=e.stack,l.percent=e.percent,l}transformSpec(e){var i;super.transformSpec(e),((i=e.axes)!==null&&i!==void 0?i:[]).forEach(n=>{["domainLine","grid","label","tick"].forEach(o=>{n[o]||(n[o]={visible:!1})}),n.orient==="angle"&&isNil(n.bandPosition)&&(n.bandPosition=.5)}),e.crosshair=array(e.crosshair||{}).map(n=>mergeSpec({categoryField:{visible:!0,line:{visible:!0,type:"rect"}}},n))}}class RoseChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=RoseChartSpecTransformer,this.type="rose",this.seriesType=SeriesTypeEnum.rose}}RoseChart.type="rose",RoseChart.seriesType=SeriesTypeEnum.rose,RoseChart.transformerConstructor=RoseChartSpecTransformer,mixin(RoseChart,StackChartMixin);const registerRoseChart=()=>{registerRoseSeries(),Factory$1.registerChart(RoseChart.type,RoseChart)};class RadarChartSpecTransformer extends RoseLikeChartSpecTransformer{_getDefaultSeriesSpec(e){var i;const n=super._getDefaultSeriesSpec(e);return n.line=e.line,n.point=e.point,n.stack=e.stack,n.percent=e.percent,n.area=mergeSpec({visible:!1},e.area),n.seriesMark=(i=e.seriesMark)!==null&&i!==void 0?i:"area",n.activePoint=e.activePoint,n.pointDis=e.pointDis,n.pointDisMul=e.pointDisMul,n.markOverlap=e.markOverlap,n}transformSpec(e){var i;super.transformSpec(e),((i=e.axes)!==null&&i!==void 0?i:[]).forEach(n=>{n.orient==="radius"&&(["domainLine","label","tick"].forEach(o=>{n[o]||(n[o]={visible:!1})}),n.grid||(n.grid={visible:!0}))}),e.crosshair=array(e.crosshair||{}).map(n=>mergeSpec({categoryField:{visible:!0,line:{visible:!0,type:"line"}}},n))}}class RadarChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=RadarChartSpecTransformer,this.type="radar",this.seriesType=SeriesTypeEnum.radar}}RadarChart.type="radar",RadarChart.seriesType=SeriesTypeEnum.radar,RadarChart.transformerConstructor=RadarChartSpecTransformer,mixin(RadarChart,StackChartMixin);const registerRadarChart=()=>{registerRadarSeries(),Factory$1.registerChart(RadarChart.type,RadarChart)};class CommonChartSpecTransformer extends BaseChartSpecTransformer{_getDefaultSeriesSpec(e){const i=super._getDefaultSeriesSpec(e);return delete i.data,i}_transformAxisSpec(e){e.axes&&e.autoBandSize&&e.series.forEach((i,n)=>{var o;if(i.type==="bar"){const l=this._findBandAxisBySeries(i,n,e.axes);if(l&&!l.bandSize&&!l.maxBandSize&&!l.minBandSize){const d=isObject$1(i.autoBandSize)&&(o=i.autoBandSize.extend)!==null&&o!==void 0?o:0,{barMaxWidth:u,barMinWidth:f,barWidth:g,barGapInGroup:_}=i;this._applyAxisBandSize(l,d,{barMaxWidth:u,barMinWidth:f,barWidth:g,barGapInGroup:_})}}})}transformSpec(e){if(super.transformSpec(e),e.series&&e.series.length){const i=this._getDefaultSeriesSpec(e);e.series.forEach(n=>{this._isValidSeries(n.type)&&Object.keys(i).forEach(o=>{o in n||(n[o]=i[o])})})}e.axes&&e.axes.length&&e.axes.forEach(i=>{get(i,"trimPadding")&&mergeSpec(i,getTrimPaddingConfig(this.type,e))}),this._transformAxisSpec(e)}}class CommonChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=CommonChartSpecTransformer,this.type="common"}}CommonChart.type="common",CommonChart.transformerConstructor=CommonChartSpecTransformer,mixin(CommonChart,StackChartMixin);const registerCommonChart=()=>{Factory$1.registerChart(CommonChart.type,CommonChart)},SCROLL_BAR_DEFAULT_SIZE=12;class SequenceChartSpecTransformer extends BaseChartSpecTransformer{_getSeriesDataLength(e,i){var n,o;if(i.data){const d=array(i.data)[0];return d instanceof DataView?(n=d.latestData)===null||n===void 0?void 0:n.length:(o=d.values)===null||o===void 0?void 0:o.length}const l=array(e.data).find((d,u)=>i.dataId?d instanceof DataView?d.name===i.dataId:d.id===i.dataId:i.dataIndex===u);return l?l instanceof DataView?l.latestData.length:l.values.length:0}addAttrToComponentSpec(e,i,n){return Array.isArray(e)?e[0][i]=n:e[i]=n,e}addPaddingRow(e,i,n){e.push({index:i,size:n})}addOrientAxes(e,i,n,o){e.push({id:`regionAxesRow${n}`}),i.push({modelId:`axesRow${n}`,col:1,row:n}),o.axes[0].id=`axesRow${n}`,o.axes[0].regionIndex=Array.from(Array(o.series.length),(l,d)=>o.axes[0].orient==="top"?d+1:d)}transformSpec(e){var i,n,o,l,d,u,f,g,_,y,b,S,v,A,x;super.transformSpec(e);let T=0;const C=[],E=[],P=[],R=[],L=[],w=(this._option.getCompiler().getVGrammarView().width(),this._option.getCompiler().getVGrammarView().height());let B=0;if(e!=null&&e.legends){C.push({modelId:`legendRow${T}`,col:1,row:T}),this.addAttrToComponentSpec(e.legends,"id",`legendRow${T}`);const H=array(e.legends);let F=(i=H[0].height)!==null&&i!==void 0?i:40;if(H[0].padding){const $=normalizeLayoutPaddingSpec(H[0].padding);F+=Number((n=$==null?void 0:$.bottom)!==null&&n!==void 0?n:0),F+=Number((o=$==null?void 0:$.top)!==null&&o!==void 0?o:0),H[0].offsetY=Number((d=(l=H[0])===null||l===void 0?void 0:l.offsetY)!==null&&d!==void 0?d:0)+Number((u=$==null?void 0:$.top)!==null&&u!==void 0?u:0)}L.push({index:T,size:F}),B+=F,T++}e!=null&&e.dataZoom&&(C.push({modelId:`dataZoomRow${T}`,col:1,row:T}),this.addAttrToComponentSpec(e.dataZoom,"id",`dataZoomRow${T}`),B+=60,T++,this.addPaddingRow(L,T,10),B+=10,T++),B+=60,e.axes!==null&&((g=(f=e==null?void 0:e.axes)===null||f===void 0?void 0:f[0])===null||g===void 0?void 0:g.orient)!=="top"||(this.addOrientAxes(E,C,T,e),T++);const I=e.series.filter(H=>H.type!==SeriesTypeEnum.link).length,D=(w-B-20*I)/I,O=((_=e==null?void 0:e.appendPadding)===null||_===void 0?void 0:_.left)||0,N=((y=e==null?void 0:e.appendPadding)===null||y===void 0?void 0:y.right)||0;(b=e==null?void 0:e.series)===null||b===void 0||b.forEach(H=>{var F,$;if([SeriesTypeEnum.bar,SeriesTypeEnum.line,SeriesTypeEnum.area,SeriesTypeEnum.dot].includes(H.type)){if(C.push({modelId:`${H.type}Row${T}`,col:1,row:T}),C.push({modelId:`axesLeftRow${T}`,col:0,row:T}),E.push({id:`${H.type}Row${T}`,clip:!1}),L.push({index:T,size:(H==null?void 0:H.height)||D}),P.push({orient:"left",id:`axesLeftRow${T}`,type:H.type===SeriesTypeEnum.dot?"band":"linear",visible:H.type!==SeriesTypeEnum.dot,title:{visible:!0,autoRotate:!1,style:{text:H==null?void 0:H.barTitle,dx:-20,textBaseline:"middle",textAlign:"end"}},grid:{visible:typeof((F=H==null?void 0:H.grid)===null||F===void 0?void 0:F.visible)!="boolean"||(($=H==null?void 0:H.grid)===null||$===void 0?void 0:$.visible),style:(G,Y)=>{var Q,q,te,ue,he;let fe=0;if(Y===0){const pe=(Q=H==null?void 0:H.grid)===null||Q===void 0?void 0:Q.style;fe=(te=(q=pe==null?void 0:pe.lineWidth)!==null&&q!==void 0?q:pe==null?void 0:pe.strokeWidth)!==null&&te!==void 0?te:1}return{lineWidth:fe,stroke:((he=(ue=H==null?void 0:H.grid)===null||ue===void 0?void 0:ue.style)===null||he===void 0?void 0:he.stroke)||"#dfdfdf",lineDash:[0,0]}}},domainLine:{visible:!1},tick:{visible:!1},label:{visible:!1},regionIndex:E.length-1}),H.type===SeriesTypeEnum.dot){C.push({modelId:`scrollBarRightRow${T}`,col:2,row:T});const G=this._getSeriesDataLength(e,H);let Y=0;G&&(Y=((H==null?void 0:H.height)||D)/(30*G)),R.push(Object.assign({orient:"right",visible:H.type===SeriesTypeEnum.dot&&Y<1,id:`scrollBarRightRow${T}`,start:0,end:Math.min(Y,1),filterMode:"axis",regionIndex:E.length-1,axisId:`axesLeftRow${T}`},array(e==null?void 0:e.scrollBar)[0]))}H.regionIndex=E.length-1,T++,this.addPaddingRow(L,T,(H==null?void 0:H.padding)||20),T++,H.leftAppendPadding=O,H.type===SeriesTypeEnum.dot&&(H.title.style.dx=-O,H.subTitle.style.dx=-O)}}),this.addPaddingRow(L,T,20),T++,(S=e==null?void 0:e.series)===null||S===void 0||S.forEach(H=>{if(H.type===SeriesTypeEnum.link){const F=H.dotSeriesIndex+1;C.push({modelId:`${H.type}Row${F}`,col:1,row:F-1}),H.regionIndex=e.series[H.dotSeriesIndex].regionIndex,H.leftAppendPadding=O,H.height=e.series[H.dotSeriesIndex].height,H.clipHeight=e.series[H.dotSeriesIndex].clipHeight}}),e!=null&&e.legends&&this.addAttrToComponentSpec(e.legends,"regionIndex",[E.length-1]),((A=(v=e==null?void 0:e.axes)===null||v===void 0?void 0:v[0])===null||A===void 0?void 0:A.orient)==="bottom"&&(this.addOrientAxes(E,C,T,e),T++);const V={type:"grid",col:4,row:T,colWidth:[{index:0,size:O},{index:2,size:SCROLL_BAR_DEFAULT_SIZE},{index:3,size:N}],rowHeight:L,elements:C};e.layout=V,e.region=E,(x=e.axes)===null||x===void 0||x.push(...P),e.scrollBar=R}}var __rest$8=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};class SequenceChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=SequenceChartSpecTransformer,this.type="sequence"}_createSeries(e,i){if(!e)return;const{spec:n}=i,o=__rest$8(i,["spec"]);let l;if(n.type===SeriesTypeEnum.link&&(n.dotSeriesSpec=this._spec.series[n.dotSeriesIndex]),n.regionId&&(l=this.getRegionsInUserId(n.regionId)),l||(l=this.getRegionsInIndex(n.regionIndex?[n.regionIndex]:void 0)[0]),!l)return;const d=new e(n,Object.assign(Object.assign(Object.assign({},this._modelOption),o),{region:l,specKey:"series",globalScale:this._globalScale}));d&&(d.created(),this._series.push(d),l.addSeries(d))}}SequenceChart.type="sequence",SequenceChart.transformerConstructor=SequenceChartSpecTransformer;const registerSequenceChart=()=>{registerDotSeries(),registerLinkSeries(),registerCartesianBandAxis(),registerCartesianLinearAxis(),Factory$1.registerChart(SequenceChart.type,SequenceChart)};class BaseHistogramChartSpecTransformer extends CartesianChartSpecTransformer{transformSpec(e){super.transformSpec(e),e.axes.forEach(i=>i.type="linear")}_getDefaultSeriesSpec(e){return super._getDefaultSeriesSpec(e,["x2Field","y2Field","barMinHeight","barBackground"])}}class BaseHistogramChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=BaseHistogramChartSpecTransformer}}BaseHistogramChart.transformerConstructor=BaseHistogramChartSpecTransformer,mixin(BaseHistogramChart,StackChartMixin);class HistogramChartSpecTransformer extends BaseHistogramChartSpecTransformer{transformSpec(e){super.transformSpec(e),setDefaultCrosshairForCartesianChart(e)}}class HistogramChart extends BaseHistogramChart{constructor(){super(...arguments),this.transformerConstructor=HistogramChartSpecTransformer,this.type="histogram",this.seriesType=SeriesTypeEnum.bar}}HistogramChart.type="histogram",HistogramChart.seriesType=SeriesTypeEnum.bar,HistogramChart.transformerConstructor=HistogramChartSpecTransformer;const registerHistogramChart=()=>{registerBarSeries(),Factory$1.registerChart(HistogramChart.type,HistogramChart)};class Histogram3dChart extends BaseHistogramChart{constructor(){super(...arguments),this.transformerConstructor=HistogramChartSpecTransformer,this.type="histogram3d",this.seriesType=SeriesTypeEnum.bar3d}}Histogram3dChart.type="histogram3d",Histogram3dChart.seriesType=SeriesTypeEnum.bar3d,Histogram3dChart.transformerConstructor=HistogramChartSpecTransformer;const registerHistogram3dChart=()=>{register3DPlugin(),registerBar3dSeries(),Factory$1.registerChart(Histogram3dChart.type,Histogram3dChart)};class CircularProgressChartSpecTransformer extends ProgressLikeChartSpecTransformer{_getDefaultSeriesSpec(e){var i,n;const o=super._getDefaultSeriesSpec(e);return o.progress=e.progress,o.track=e.track,o.tickMask=e.tickMask,o.cornerRadius=(i=e.cornerRadius)!==null&&i!==void 0?i:0,o.roundCap=(n=e.roundCap)!==null&&n!==void 0&&n,o}transformSpec(e){super.transformSpec(e),this._transformProgressAxisSpec(e,{orient:"angle",visible:!1},{orient:"radius",visible:!1},{forceInitTick:e.tickMask&&e.tickMask.visible!==!1})}}class CircularProgressChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=CircularProgressChartSpecTransformer,this.type="circularProgress",this.seriesType=SeriesTypeEnum.circularProgress}}CircularProgressChart.type="circularProgress",CircularProgressChart.seriesType=SeriesTypeEnum.circularProgress,CircularProgressChart.transformerConstructor=CircularProgressChartSpecTransformer,mixin(CircularProgressChart,StackChartMixin);const registerCircularProgressChart=()=>{registerCircularProgressSeries(),Factory$1.registerChart(CircularProgressChart.type,CircularProgressChart)};class GaugeChartSpecTransformer extends ProgressLikeChartSpecTransformer{_getDefaultSeriesSpec(e){const i=super._getDefaultSeriesSpec(e);return i.radiusField=e.radiusField,i.pin=e.pin,i.pinBackground=e.pinBackground,i.pointer=e.pointer,i}_getDefaultCircularProgressSeriesSpec(e){const i=super._getDefaultSeriesSpec(e);return i.type=SeriesTypeEnum.circularProgress,i}transformSpec(e){var i,n,o,l,d;super.transformSpec(e);let u=(i=e.series)===null||i===void 0?void 0:i.find(f=>f.type===SeriesTypeEnum.gauge||f.type===SeriesTypeEnum.circularProgress);isNil(u)&&(u=(n=e.gauge)!==null&&n!==void 0?n:this._getDefaultCircularProgressSeriesSpec(e),u.type==="circularProgress"&&(isNil(u.radiusField)&&isNil(u.categoryField)&&(u.radiusField=(l=(o=e.radiusField)!==null&&o!==void 0?o:e.categoryField)!==null&&l!==void 0?l:e.seriesField),isNil(u.valueField)&&isNil(u.angleField)&&(u.valueField=(d=e.valueField)!==null&&d!==void 0?d:e.angleField)),e.series.length===1?e.series.push(u):e.series.forEach(f=>{f.type===u.type&&Object.keys(u).forEach(g=>{g in f||(f[g]=u[g])})})),u.type===SeriesTypeEnum.circularProgress?this._transformProgressAxisSpec(e,{orient:"angle",visible:!0,domainLine:{visible:!1},grid:{visible:!1}},{orient:"radius",visible:!1},{zIndex:LayoutZIndex.Region+50}):this._transformGaugeAxisSpec(e)}_transformGaugeAxisSpec(e){var i;e.axes||(e.axes=[]);const n={radius:null,angle:null};((i=e.axes)!==null&&i!==void 0?i:[]).forEach(o=>{const{orient:l}=o;l==="radius"&&(n.radius=o),l==="angle"&&(n.angle=o)}),n.angle||(n.angle={orient:"angle",visible:!0},e.axes.push(n.angle)),n.radius||(n.radius={orient:"radius",visible:!1},e.axes.push(n.radius)),isNil(n.angle.type)&&(n.angle.type="linear"),isNil(n.radius.type)&&(n.radius.type="linear"),isNil(n.angle.zIndex)&&(n.angle.zIndex=LayoutZIndex.Region+50)}}class GaugeChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=GaugeChartSpecTransformer,this.type="gauge",this.seriesType=SeriesTypeEnum.gaugePointer}}GaugeChart.type="gauge",GaugeChart.seriesType=SeriesTypeEnum.gaugePointer,GaugeChart.transformerConstructor=GaugeChartSpecTransformer;const registerGaugeChart=()=>{registerGaugePointerSeries(),registerGaugeSeries(),Factory$1.registerChart(GaugeChart.type,GaugeChart)};class BaseWordCloudChartSpecTransformer extends BaseChartSpecTransformer{transformSpec(e){super.transformSpec(e),this.transformSeriesSpec(e)}_getDefaultSeriesSpec(e){return super._getDefaultSeriesSpec(e,["nameField","valueField","fontFamilyField","fontWeightField","fontStyleField","colorHexField","colorMode","colorList","rotateAngles","fontWeightRange","fontSizeRange","maskShape","keepAspect","random","wordCloudConfig","wordCloudShapeConfig","word","fillingWord","wordMask"])}}class BaseWordCloudChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=BaseWordCloudChartSpecTransformer,this.type="wordCloud",this.seriesType=SeriesTypeEnum.wordCloud}}BaseWordCloudChart.transformerConstructor=BaseWordCloudChartSpecTransformer;class WordCloudChart extends BaseWordCloudChart{constructor(){super(...arguments),this.transformerConstructor=BaseWordCloudChartSpecTransformer,this.type="wordCloud",this.seriesType=SeriesTypeEnum.wordCloud}}WordCloudChart.type="wordCloud",WordCloudChart.seriesType=SeriesTypeEnum.wordCloud,WordCloudChart.transformerConstructor=BaseWordCloudChartSpecTransformer;const registerWordCloudChart=()=>{registerWordCloudSeries(),Factory$1.registerChart(WordCloudChart.type,WordCloudChart)},registerWordCloudShapeChart=()=>{registerWordCloudShapeSeries(),registerWordCloudSeries(),Factory$1.registerChart(WordCloudChart.type,WordCloudChart)};class WordCloud3dChartSpecTransformer extends BaseWordCloudChartSpecTransformer{_getDefaultSeriesSpec(e){const i=super._getDefaultSeriesSpec(e);return i.depth_3d=e.depth_3d,i}}class WordCloud3dChart extends BaseWordCloudChart{constructor(){super(...arguments),this.transformerConstructor=WordCloud3dChartSpecTransformer,this.type="wordCloud3d",this.seriesType=SeriesTypeEnum.wordCloud3d}}WordCloud3dChart.type="wordCloud3d",WordCloud3dChart.seriesType=SeriesTypeEnum.wordCloud3d,WordCloud3dChart.transformerConstructor=WordCloud3dChartSpecTransformer;const registerWordCloud3dChart=()=>{register3DPlugin(),registerWordCloud3dSeries(),Factory$1.registerChart(WordCloud3dChart.type,WordCloud3dChart)},registerWordCloudShape3dChart=()=>{register3DPlugin(),registerWordCloudShape3dSeries(),register3DPlugin(),registerWordCloud3dSeries(),Factory$1.registerChart(WordCloud3dChart.type,WordCloud3dChart)};class FunnelChartSpecTransformer extends BaseChartSpecTransformer{needAxes(){return!1}_getDefaultSeriesSpec(e){return super._getDefaultSeriesSpec(e,["categoryField","valueField","funnelAlign","funnelOrient","heightRatio","shape","funnel","transform","outerLabel","transformLabel","isTransform","maxSize","minSize","gap","isCone","range"])}transformSpec(e){super.transformSpec(e),super.transformSeriesSpec(e)}}class FunnelChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=FunnelChartSpecTransformer,this.type="funnel",this.seriesType=SeriesTypeEnum.funnel}}FunnelChart.type="funnel",FunnelChart.seriesType=SeriesTypeEnum.funnel,FunnelChart.transformerConstructor=FunnelChartSpecTransformer;const registerFunnelChart=()=>{registerFunnelSeries(),Factory$1.registerChart(FunnelChart.type,FunnelChart)};class Funnel3dChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=FunnelChartSpecTransformer,this.type="funnel3d",this.seriesType=SeriesTypeEnum.funnel3d}}Funnel3dChart.type="funnel3d",Funnel3dChart.seriesType=SeriesTypeEnum.funnel3d,Funnel3dChart.transformerConstructor=FunnelChartSpecTransformer;const registerFunnel3dChart=()=>{register3DPlugin(),registerFunnel3dSeries(),Factory$1.registerChart(Funnel3dChart.type,Funnel3dChart)};class LinearProgressChartSpecTransformer extends CartesianChartSpecTransformer{needAxes(){return!1}_getDefaultSeriesSpec(e){var i,n;const o=super._getDefaultSeriesSpec(e,["bandWidth","progress","track"]);return o.direction=(i=e.direction)!==null&&i!==void 0?i:"horizontal",o.cornerRadius=(n=e.cornerRadius)!==null&&n!==void 0?n:0,o}transformSpec(e){var i,n;if(super.transformSpec(e),e.axes||(e.axes=[]),e.direction==="vertical"){let o=null,l=null;((i=e.axes)!==null&&i!==void 0?i:[]).forEach(u=>{const{orient:f}=u;f==="left"&&(o=u),f==="bottom"&&(l=u)}),o||(o={orient:"left",visible:!1},e.axes.push(o)),l||(l={orient:"bottom",visible:!1},e.axes.push(l)),isNil(l.type)&&(l.type="band"),isNil(o.type)&&(o.type="linear");const d=getLinearAxisSpecDomain(o,{min:0,max:1});isNil(o.min)&&(o.min=d.min),isNil(o.max)&&(o.max=d.max)}else{let o=null,l=null;((n=e.axes)!==null&&n!==void 0?n:[]).forEach(u=>{const{orient:f}=u;f==="left"&&(o=u),f==="bottom"&&(l=u)}),o||(o={type:"band",orient:"left",visible:!1},e.axes.push(o)),l||(l={orient:"bottom",visible:!1},e.axes.push(l)),isNil(l.type)&&(l.type="linear"),isNil(o.type)&&(o.type="band");const d=getLinearAxisSpecDomain(l,{min:0,max:1});isNil(l.min)&&(l.min=d.min),isNil(l.max)&&(l.max=d.max)}}}class LinearProgressChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=LinearProgressChartSpecTransformer,this.type="linearProgress",this.seriesType=SeriesTypeEnum.linearProgress}}LinearProgressChart.type="linearProgress",LinearProgressChart.seriesType=SeriesTypeEnum.linearProgress,LinearProgressChart.transformerConstructor=LinearProgressChartSpecTransformer,mixin(LinearProgressChart,StackChartMixin);const registerLinearProgressChart=()=>{registerLinearProgressSeries(),Factory$1.registerChart(LinearProgressChart.type,LinearProgressChart)};class RangeColumnChartSpecTransformer extends CartesianChartSpecTransformer{_getDefaultSeriesSpec(e){var i,n;const o=super._getDefaultSeriesSpec(e,["barWidth","barMaxWidth","barMinWidth","barGapInGroup","barBackground","barMinHeight","stackCornerRadius","bar"]);return e.direction==="horizontal"?o.xField=(i=e.xField)!==null&&i!==void 0?i:[e.minField,e.maxField]:o.yField=(n=e.yField)!==null&&n!==void 0?n:[e.minField,e.maxField],o}transformSpec(e){super.transformSpec(e),setDefaultCrosshairForCartesianChart(e)}}class RangeColumnChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=RangeColumnChartSpecTransformer,this.type="rangeColumn",this.seriesType=SeriesTypeEnum.rangeColumn}}RangeColumnChart.type="rangeColumn",RangeColumnChart.seriesType=SeriesTypeEnum.rangeColumn,RangeColumnChart.transformerConstructor=RangeColumnChartSpecTransformer;const registerRangeColumnChart=()=>{registerRangeColumnSeries(),Factory$1.registerChart(RangeColumnChart.type,RangeColumnChart)};class RangeColumn3dChartSpecTransformer extends CartesianChartSpecTransformer{_getDefaultSeriesSpec(e){var i,n;const o=super._getDefaultSeriesSpec(e,["bar3d","barGapInGroup"]);return e.direction==="horizontal"?o.xField=(i=e.xField)!==null&&i!==void 0?i:[e.minField,e.maxField]:o.yField=(n=e.yField)!==null&&n!==void 0?n:[e.minField,e.maxField],o}}class RangeColumn3dChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=RangeColumn3dChartSpecTransformer,this.type="rangeColumn3d",this.seriesType=SeriesTypeEnum.rangeColumn3d}}RangeColumn3dChart.type="rangeColumn3d",RangeColumn3dChart.seriesType=SeriesTypeEnum.rangeColumn3d,RangeColumn3dChart.transformerConstructor=RangeColumn3dChartSpecTransformer;const registerRangeColumn3dChart=()=>{register3DPlugin(),registerRangeColumn3dSeries(),Factory$1.registerChart(RangeColumn3dChart.type,RangeColumn3dChart)};class SunburstChartSpecTransformer extends BaseChartSpecTransformer{_getDefaultSeriesSpec(e){const i=isValid(e.startAngle)?e.startAngle:POLAR_START_ANGLE,n=isValid(e.endAngle)?e.endAngle:i+radianToDegree(2*Math.PI),o=super._getDefaultSeriesSpec(e,["categoryField","valueField","centerX","centerY","offsetX","offsetY","innerRadius","outerRadius","gap","labelLayout","label","labelAutoVisible","drill","drillField"]);return o.startAngle=i,o.endAngle=n,o}transformSpec(e){super.transformSpec(e),this.transformSeriesSpec(e)}}class SunburstChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=SunburstChartSpecTransformer,this.type="sunburst",this.seriesType=SeriesTypeEnum.sunburst}}SunburstChart.type="sunburst",SunburstChart.seriesType=SeriesTypeEnum.sunburst,SunburstChart.transformerConstructor=SunburstChartSpecTransformer;const registerSunburstChart=()=>{registerSunBurstSeries(),Factory$1.registerChart(SunburstChart.type,SunburstChart)};class CirclePackingChartSpecTransformer extends BaseChartSpecTransformer{_getDefaultSeriesSpec(e){return super._getDefaultSeriesSpec(e,["categoryField","valueField","layoutPadding","circlePacking","drill","drillField"])}transformSpec(e){super.transformSpec(e),this.transformSeriesSpec(e)}}class CirclePackingChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=CirclePackingChartSpecTransformer,this.type="circlePacking",this.seriesType=SeriesTypeEnum.circlePacking}}CirclePackingChart.type="circlePacking",CirclePackingChart.seriesType=SeriesTypeEnum.circlePacking,CirclePackingChart.transformerConstructor=CirclePackingChartSpecTransformer;const registerCirclePackingChart=()=>{registerCirclePackingSeries(),Factory$1.registerChart(CirclePackingChart.type,CirclePackingChart)};class TreemapChartSpecTransformer extends BaseChartSpecTransformer{_getDefaultSeriesSpec(e){return super._getDefaultSeriesSpec(e,["categoryField","valueField","aspectRatio","splitType","maxDepth","gapWidth","nodePadding","minVisibleArea","minChildrenVisibleArea","minChildrenVisibleSize","roam","drill","drillField","leaf","nonLeaf","nonLeafLabel"])}transformSpec(e){super.transformSpec(e),this.transformSeriesSpec(e)}}class TreemapChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=TreemapChartSpecTransformer,this.type="treemap",this.seriesType=SeriesTypeEnum.treemap}}TreemapChart.type="treemap",TreemapChart.seriesType=SeriesTypeEnum.treemap,TreemapChart.transformerConstructor=TreemapChartSpecTransformer;const registerTreemapChart=()=>{registerTreemapSeries(),Factory$1.registerChart(TreemapChart.type,TreemapChart)};class WaterfallChartSpecTransformer extends BarChartSpecTransformer{transformSpec(e){super.transformSpec(e),e.legends&&array(e.legends).forEach(i=>{i.select=!1,i.hover=!1,i.filter=!1}),setDefaultCrosshairForCartesianChart(e)}_getDefaultSeriesSpec(e){const i=super._getDefaultSeriesSpec(e);return i.bar=e.bar,i.stackLabel=e.stackLabel,i.leaderLine=e.leaderLine,i.total=e.total,i}}class WaterfallChart extends BarChart{constructor(){super(...arguments),this.transformerConstructor=WaterfallChartSpecTransformer,this.type="waterfall",this.seriesType=SeriesTypeEnum.waterfall}}WaterfallChart.type="waterfall",WaterfallChart.seriesType=SeriesTypeEnum.waterfall,WaterfallChart.transformerConstructor=WaterfallChartSpecTransformer;const registerWaterfallChart=()=>{registerWaterfallSeries(),Factory$1.registerChart(WaterfallChart.type,WaterfallChart)};class BoxPlotChartSpecTransformer extends CartesianChartSpecTransformer{_getDefaultSeriesSpec(e){var i;const n=[e.maxField,e.medianField,e.q1Field,e.q3Field,e.minField,e.outliersField],o=super._getDefaultSeriesSpec(e,["boxPlot","minField","maxField","q1Field","medianField","q3Field","outliersField","outliersStyle"]);return o.direction=(i=e.direction)!==null&&i!==void 0?i:"vertical",o[o.direction==="horizontal"?"xField":"yField"]=n,o}transformSpec(e){super.transformSpec(e),e.axes||(e.axes=[{orient:"bottom"},{orient:"left"}]),setDefaultCrosshairForCartesianChart(e)}}class BoxPlotChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=BoxPlotChartSpecTransformer,this.type="boxPlot",this.seriesType=SeriesTypeEnum.boxPlot}}BoxPlotChart.type="boxPlot",BoxPlotChart.seriesType=SeriesTypeEnum.boxPlot,BoxPlotChart.transformerConstructor=BoxPlotChartSpecTransformer;const registerBoxplotChart=()=>{registerBoxplotSeries(),Factory$1.registerChart(BoxPlotChart.type,BoxPlotChart)};class SankeyChartSpecTransformer extends BaseChartSpecTransformer{_getDefaultSeriesSpec(e){return super._getDefaultSeriesSpec(e,["categoryField","valueField","sourceField","targetField","direction","nodeAlign","crossNodeAlign","nodeGap","nodeWidth","linkWidth","minStepWidth","minNodeHeight","maxNodeHeight","minLinkHeight","maxLinkHeight","dropIsolatedNode","nodeHeight","linkHeight","equalNodeHeight","linkOverlap","iterations","nodeKey","linkSortBy","nodeSortBy","setNodeLayer","node","link","emphasis","inverse","overflow"])}transformSpec(e){super.transformSpec(e),this.transformSeriesSpec(e)}}class SankeyChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=SankeyChartSpecTransformer,this.type="sankey",this.seriesType=SeriesTypeEnum.sankey}_setStateInDatum(e,i,n,o,l){const d=isArray(n)?n[0]:n,u=d?Object.keys(d):null;this.getRegionsInQuerier(l).forEach(f=>{if(!d)return void f.interaction.clearEventElement(e,!0);let g=!1;f.getSeries().forEach(_=>{var y,b;let S=null;_.getMarksWithoutRoot().forEach(v=>{if(v.type==="text")return;let A=null;const x=v.getProduct();x&&((!o||isFunction(o)&&o(_,v))&&(A=x.elements.find(T=>u.every(C=>{var E;let P=(E=T.getDatum())===null||E===void 0?void 0:E.datum;return isArray(P)&&(P=P[0]),d[C]==(P==null?void 0:P[C])}))),A&&(g=!0,f.interaction.startInteraction(e,A),(x.id().includes("node")||x.id().includes("link"))&&(S=A)))}),S&&((b=(y=_)._handleEmphasisElement)===null||b===void 0||b.call(y,{item:S}))}),i&&g&&f.interaction.reverseEventElement(e)})}}SankeyChart.type="sankey",SankeyChart.seriesType=SeriesTypeEnum.sankey,SankeyChart.transformerConstructor=SankeyChartSpecTransformer;const registerSankeyChart=()=>{loadScrollbar(),registerSankeySeries(),Factory$1.registerChart(SankeyChart.type,SankeyChart)};class RangeAreaChartSpecTransformer extends CartesianChartSpecTransformer{_getDefaultSeriesSpec(e){var i,n;const o=super._getDefaultSeriesSpec(e);return o.area=e.area,e.direction==="horizontal"?o.xField=(i=e.xField)!==null&&i!==void 0?i:[e.minField,e.maxField]:o.yField=(n=e.yField)!==null&&n!==void 0?n:[e.minField,e.maxField],o.stack=!1,o}transformSpec(e){super.transformSpec(e),setDefaultCrosshairForCartesianChart(e)}}class RangeAreaChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=RangeAreaChartSpecTransformer,this.type="rangeArea",this.seriesType=SeriesTypeEnum.rangeArea}}RangeAreaChart.type="rangeArea",RangeAreaChart.seriesType=SeriesTypeEnum.rangeArea,RangeAreaChart.transformerConstructor=RangeAreaChartSpecTransformer;const registerRangeAreaChart=()=>{registerRangeAreaSeries(),Factory$1.registerChart(RangeAreaChart.type,RangeAreaChart)};class HeatmapChartSpecTransformer extends CartesianChartSpecTransformer{_getDefaultSeriesSpec(e){return super._getDefaultSeriesSpec(e,["valueField","cell"])}}class HeatmapChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=HeatmapChartSpecTransformer,this.type="heatmap",this.seriesType=SeriesTypeEnum.heatmap}}HeatmapChart.type="heatmap",HeatmapChart.seriesType=SeriesTypeEnum.heatmap,HeatmapChart.transformerConstructor=HeatmapChartSpecTransformer;const registerHeatmapChart=()=>{registerHeatmapSeries(),Factory$1.registerChart(HeatmapChart.type,HeatmapChart)};class CorrelationChartSpecTransformer extends BaseChartSpecTransformer{_getDefaultSeriesSpec(e){return super._getDefaultSeriesSpec(e,["categoryField","valueField","sizeField","sizeRange","centerX","centerY","innerRadius","outerRadius","startAngle","endAngle","ripplePoint","centerPoint","centerLabel","nodePoint"])}transformSpec(e){super.transformSpec(e),this.transformSeriesSpec(e)}}class CorrelationChart extends BaseChart{constructor(){super(...arguments),this.transformerConstructor=CorrelationChartSpecTransformer,this.type="correlation",this.seriesType=SeriesTypeEnum.correlation}}CorrelationChart.type="correlation",CorrelationChart.seriesType=SeriesTypeEnum.correlation,CorrelationChart.transformerConstructor=CorrelationChartSpecTransformer;const registerCorrelationChart=()=>{registerCorrelationSeries(),Factory$1.registerChart(CorrelationChart.type,CorrelationChart)};function transformLegendTitleAttributes(r){var e,i;const n=Object.assign({},r);return isEmpty(r.style)||(n.textStyle=transformToGraphic(r.style)),isEmpty(r.textStyle)||mergeSpec(n.textStyle,transformToGraphic(r.textStyle)),!((e=r.shape)===null||e===void 0)&&e.style&&transformToGraphic(n.shape.style),!((i=r.background)===null||i===void 0)&&i.style&&transformToGraphic(n.background.style),n}var __rest$7=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};function getLegendAttributes(r,e){const{title:i={},item:n={},pager:o={},background:l={},type:d,id:u,visible:f,orient:g,position:_,data:y,filter:b,regionId:S,regionIndex:v,seriesIndex:A,seriesId:x,padding:T}=r,C=__rest$7(r,["title","item","pager","background","type","id","visible","orient","position","data","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return i.visible&&(C.title=transformLegendTitleAttributes(i)),isEmpty(n.focusIconStyle)||transformToGraphic(n.focusIconStyle),n.shape&&(n.shape=transformComponentStyle(n.shape)),n.label&&(n.label=transformComponentStyle(n.label)),n.value&&(n.value=transformComponentStyle(n.value)),n.background&&(n.background=transformComponentStyle(n.background)),isPercent(n.maxWidth)&&(n.maxWidth=Number(n.maxWidth.substring(0,n.maxWidth.length-1))*e.width/100),isPercent(n.width)&&(n.width=Number(n.width.substring(0,n.width.length-1))*e.width/100),isPercent(n.height)&&(n.height=Number(n.height.substring(0,n.height.length-1))*e.width/100),C.item=n,o.type==="scrollbar"?(isEmpty(o.railStyle)||transformToGraphic(o.railStyle),isEmpty(o.sliderStyle)||transformToGraphic(o.sliderStyle)):(isEmpty(o.textStyle)||transformToGraphic(o.textStyle),o.handler&&transformComponentStyle(o.handler)),C.pager=o,l.visible&&!isEmpty(l.style)&&(mergeSpec(C,l.style),isValid(l.padding)&&(C.padding=l.padding)),C}const discreteLegendDataMake=(r,e)=>{const i=[],n={},{series:o,seriesField:l}=e;return o().forEach(d=>{const u=l(d);let f;f=u===d.getSeriesField()?d.getSeriesInfoList():d.getSeriesInfoInField(u),f.forEach(g=>{n[g.key]||(n[g.key]=!0,i.push(g))})}),i},discreteLegendFilter=(r,e)=>{var i,n,o;const{series:l,selected:d,field:u,data:f,customFilter:g}=e,_=d(),y=f();if(_.length===0&&y.length)return[];if(_.length===y.length)return r;const b={};_.forEach(v=>{b[v]=!0});const S=(i=u())!==null&&i!==void 0?i:DEFAULT_DATA_SERIES_FIELD;return g?g(r,_,S):(isArray(r)&&(!((n=r[0])===null||n===void 0)&&n.nodes)?(r[0].nodes=r[0].nodes.filter(v=>b[v.key]===!0),!((o=r[0])===null||o===void 0)&&o.links&&(r[0].links=r[0].links.filter(v=>b[v.source]===!0&&b[v.target]===!0))):isValid(S)&&(r=r.filter(v=>b[l.getSeriesFieldValue(v,S)]===!0)),r)};class BaseLegend extends BaseComponent{constructor(){super(...arguments),this.layoutType="normal",this.layoutZIndex=LayoutZIndex.Legend,this.layoutLevel=LayoutLevel.Legend,this.specKey="legends",this._orient="left",this._visible=!0,this._position="middle",this._preSelectedData=[],this._selectedData=[],this.effect={onSelectedDataChange:()=>{eachSeries(this._regions,e=>{var i;(i=e.getViewData())===null||i===void 0||i.markRunning()},{userId:this._seriesUserId,specIndex:this._seriesIndex}),eachSeries(this._regions,e=>{e.reFilterViewData()},{userId:this._seriesUserId,specIndex:this._seriesIndex})}}}get orient(){return this._orient}get visible(){return this._visible}get position(){return this._position}getLegendData(){return this._legendData.getLatestData()}getSelectedData(){return this._selectedData}setAttrFromSpec(){var e;super.setAttrFromSpec(),this._orient=isValidOrient(this._spec.orient)?this._spec.orient:"left",this._position=(e=this._spec.position)!==null&&e!==void 0?e:"middle",this._visible=this._spec.visible!==!1;const{regionId:i,regionIndex:n,seriesId:o,seriesIndex:l}=this._spec;isValid(o)&&(this._seriesUserId=array(o)),isValid(i)&&(this._regionUserId=array(i)),isValid(l)&&(this._seriesIndex=array(l)),isValid(n)&&(this._regionUserIndex=array(n)),this._regions=this._option.getRegionsInUserIdOrIndex(this._regionUserId,this._regionUserIndex)}created(){super.created(),this.initData()}onRender(e){}_compareSpec(e,i){const n=super._compareSpec(e,i);return n.reRender=!0,(e==null?void 0:e.orient)!==(i==null?void 0:i.orient)?(n.reMake=!0,n):(isEqual(i,e)||(n.reCompile=!0),n)}changeRegions(e){}_bindLegendDataChange(){this._preSelectedData=this._selectedData.slice(),this._initSelectedData()}initData(){const e=this._initLegendData();e.target.addListener("change",this._bindLegendDataChange.bind(this)),this._legendData=new CompilableData(this._option,e),this._initSelectedData(),eachSeries(this._regions,i=>{i.event.on(ChartEvent.rawDataUpdate,{filter:({model:n})=>(n==null?void 0:n.id)===i.id},()=>{this._legendData.getDataView().reRunAllTransform()})},{userId:this._seriesUserId,specIndex:this._seriesIndex})}setSelectedData(e){var i,n,o;const l=this._selectedData;isNil(e)||JSON.stringify(l)===JSON.stringify(e)||(eachSeries(this._regions,d=>{d.legendSelectedFilter&&(e=d.legendSelectedFilter(this,e))},{userId:this._seriesUserId,specIndex:this._seriesIndex}),this._selectedData=[...e],(n=(i=this.effect).onSelectedDataChange)===null||n===void 0||n.call(i),this.event.emit(ChartEvent.legendSelectedDataChange,{model:this}),(o=this._legendComponent)===null||o===void 0||o.setSelected(this._selectedData))}afterSetLayoutStartPoint(e){if(super.afterSetLayoutStartPoint(e),this._legendComponent){const{x:i,y:n}=e;isValidNumber(i*n)&&this._legendComponent.setAttributes({x:i,y:n})}}getBoundsInRect(e,i){if(!this._visible)return this._legendComponent&&this._legendComponent.parent&&(this._legendComponent.parent.removeChild(this._legendComponent),this._legendComponent=null),{x1:0,y1:0,x2:0,y2:0};const n={x1:this.getLayoutStartPoint().x,y1:this.getLayoutStartPoint().y,x2:0,y2:0},o=this._getLegendAttributes(e);if(o.disableTriggerEvent=this._option.disableTriggerEvent,this._legendComponent)isEqual(o,this._cacheAttrs)||this._legendComponent.setAttributes(mergeSpec({},o,{defaultSelected:this._selectedData}));else{const u=new(this._getLegendConstructor())(mergeSpec({},o,{defaultSelected:this._selectedData}));u.name="legend",this._legendComponent=u,this.getContainer().add(u),this._option.disableTriggerEvent||this._initEvent(),u.on("*",(f,g)=>this._delegateEvent(this._legendComponent,f,g))}this._cacheAttrs=o;const l=isFinite(this._legendComponent.AABBBounds.width())?this._legendComponent.AABBBounds.width():0,d=isFinite(this._legendComponent.AABBBounds.height())?this._legendComponent.AABBBounds.height():0;if(this.layoutType!=="normal-inline"){const u=this.layoutOrient==="bottom"||this.layoutOrient==="top"?"horizontal":"vertical",f=this._position,{width:g,height:_}=i;let y=0,b=0;u==="horizontal"?f==="middle"?y=(g-l)/2:f==="end"&&(y=g-l):f==="middle"?b=(_-d)/2:f==="end"&&(b=_-d),this._legendComponent.setAttributes({dx:y,dy:b})}return n.x2=n.x1+l,n.y2=n.y1+d,n}onDataUpdate(){var e,i,n;if(JSON.stringify(this._preSelectedData)!==JSON.stringify(this._selectedData)){if(this._legendComponent){const o=this._getLegendAttributes(this.getLayoutRect());isEqual(o,this._cacheAttrs)||this._legendComponent.setAttributes(mergeSpec({},o,{defaultSelected:this._selectedData}))}(i=(e=this.effect).onSelectedDataChange)===null||i===void 0||i.call(e),(n=this.getChart())===null||n===void 0||n.setLayoutTag(!0,null,!1),this.event.emit(ChartEvent.legendSelectedDataChange,{model:this})}}_getNeedClearVRenderComponents(){return[this._legendComponent]}clear(){super.clear(),this._cacheAttrs=null,this._preSelectedData=null}}BaseLegend.specKey="legends";class DiscreteLegend extends BaseLegend{constructor(){super(...arguments),this.type=ComponentTypeEnum.discreteLegend,this.name=ComponentTypeEnum.discreteLegend}static getSpecInfo(e){return getSpecInfo(e,this.specKey,this.type,i=>!i.type||i.type==="discrete")}init(e){super.init(e),eachSeries(this._regions,i=>{i.addViewDataFilter({type:"discreteLegendFilter",options:{series:i,selected:()=>this._selectedData,field:()=>this._getSeriesLegendField(i),data:()=>this.getLegendDefaultData(),customFilter:this._spec.customFilter},level:TransformLevel.legendFilter})},{userId:this._seriesUserId,specIndex:this._seriesIndex})}_initLegendData(){registerDataSetInstanceTransform(this._option.dataSet,"discreteLegendFilter",discreteLegendFilter),registerDataSetInstanceTransform(this._option.dataSet,"discreteLegendDataMake",discreteLegendDataMake);const e=new DataView(this._option.dataSet,{name:`${this.type}_${this.id}_data`});return e.transform({type:"discreteLegendDataMake",options:{series:()=>{const i=[];return eachSeries(this._regions,n=>{i.push(n)},{specIndex:this._spec.seriesIndex,userId:this._spec.seriesId}),i},seriesField:i=>this._getSeriesLegendField(i)}}),e}_getSeriesLegendField(e){var i,n,o;const l=e.getSeriesField(),d=(i=this._spec.scaleName)!==null&&i!==void 0?i:this._spec.scale;if(isNil(d)||!e.getRawData())return l;const u=this._option.globalScale.getScaleSpec(d);if(!u)return l;if(this._spec.field)return this._spec.field;if(!isDataDomainSpec(u.domain))return l;const f=u.domain.find(g=>g.dataId===e.getRawData().name);return f&&(o=(n=f.fields)===null||n===void 0?void 0:n[0])!==null&&o!==void 0?o:l}_initSelectedData(){const e=this.getLegendDefaultData();if(this._unselectedData){const i=[],n=[];e.forEach(o=>{this._unselectedData.includes(o)?n.push(o):i.push(o)}),this._selectedData=i,this._unselectedData=n}else this._spec.defaultSelected?this._selectedData=[...this._spec.defaultSelected]:this._selectedData=e}getLegendDefaultData(e){return isFunction(this._spec.data)?this._getLegendItems().map(i=>i.label):this._legendData.getLatestData().map(e?i=>i.originalKey:i=>i.key)}_addDefaultTitleText(e){var i,n,o,l;if(!((i=e.title)===null||i===void 0)&&i.visible&&isNil(e.title.text)&&isNil((n=e.title.style)===null||n===void 0?void 0:n.text)){const d=(l=(o=this._regions)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.getSeries()[0];if(!d)return;e.title.text=getFieldAlias(d.getRawData(),d.getSeriesField())}}_getLegendAttributes(e){const i=this.layoutOrient==="bottom"||this.layoutOrient==="top"?"horizontal":"vertical",n=Object.assign(Object.assign({layout:i,items:this._getLegendItems(),zIndex:this.layoutZIndex},getLegendAttributes(this._spec,e)),{maxWidth:e.width,maxHeight:e.height});return this._addDefaultTitleText(n),this._addLegendItemFormatMethods(n),n}_getLegendConstructor(){return DiscreteLegend$1}setSelectedData(e){e&&(this._unselectedData=this.getLegendDefaultData().filter(i=>!e.includes(i))),super.setSelectedData(e)}_initEvent(){if(this._legendComponent){const e=this._spec.filter!==!1;this._legendComponent.addEventListener(LegendEvent.legendItemClick,i=>{const n=get(i,"detail.currentSelected");e&&this.setSelectedData(n),this.event.emit(ChartEvent.legendItemClick,{model:this,value:n,event:i})}),this._legendComponent.addEventListener(LegendEvent.legendItemHover,i=>{const n=get(i,"detail");this.event.emit(ChartEvent.legendItemHover,{model:this,value:n,event:i})}),this._legendComponent.addEventListener(LegendEvent.legendItemUnHover,i=>{const n=get(i,"detail");this.event.emit(ChartEvent.legendItemUnHover,{model:this,value:n,event:i})})}}_getLegendItems(){const e=(this._legendData.getLatestData()||[]).map(i=>{var n,o;const l=i.style("fillOpacity"),d=i.style("strokeOpacity"),u=i.style("opacity"),f=i.style("texture");return{label:i.key,shape:{symbolType:(o=(n=i.style("symbolType"))!==null&&n!==void 0?n:i.shapeType)!==null&&o!==void 0?o:"circle",fillOpacity:isValidNumber(l)?l:1,strokeOpacity:isValidNumber(d)?d:1,opacity:isValidNumber(u)?u:1,texturePadding:f?1:null,textureSize:f?4:null,texture:f,fill:i.style("fill"),stroke:i.style("stroke"),textureColor:i.style("textureColor"),innerBorder:i.style("innerBorder"),outerBorder:i.style("outerBorder"),lineDash:i.style("lineDash"),lineDashOffset:i.style("lineDashOffset"),lineWidth:i.style("lineWidth")}}});return isFunction(this._spec.data)?this._spec.data(e,this._option.globalScale.getScale("color"),this._option.globalScale):e}_addLegendItemFormatMethods(e){var i,n,o,l;const{formatMethod:d,formatter:u}=(n=(i=this._spec.item)===null||i===void 0?void 0:i.label)!==null&&n!==void 0?n:{},{formatMethod:f,formatter:g}=(l=(o=this._spec.item)===null||o===void 0?void 0:o.value)!==null&&l!==void 0?l:{},{formatFunc:_}=getFormatFunction(d,u);u&&!d&&_&&(e.item.label.formatMethod=(b,S)=>_(b,S,u));const{formatFunc:y}=getFormatFunction(f,g);g&&!f&&y&&(e.item.value.formatMethod=(b,S)=>y(g,b,S,u))}}DiscreteLegend.specKey="legends",DiscreteLegend.type=ComponentTypeEnum.discreteLegend;const registerDiscreteLegend=()=>{Factory$1.registerComponent(DiscreteLegend.type,DiscreteLegend)},continuousLegendDataMake=(r,e)=>{const{series:i,field:n,scale:o}=e,l=n();if(n&&l){let d=1/0,u=-1/0;return i().forEach(f=>{const g=f.getRawDataStatisticsByField(l,!0),_=g==null?void 0:g.min,y=g==null?void 0:g.max;isValidNumber(_)&&(d=Math.min(_,d)),isValidNumber(y)&&(u=Math.max(y,u))}),[d,u]}if(o){const d=o();return d?d.domain():[]}return[]},continuousLegendFilter=(r,e)=>{const{selected:i,field:n,data:o,isHierarchyData:l,customFilter:d}=e,u=i(),f=n(),g=l||(_=>_&&_.some(y=>y&&isHierarchyItem(y)));if(u===o())return r;if(f&&!isEmpty(u)){const[_,y]=u;return d?d(r,u,f):g(r)?filterHierarchyDataByRange(r,+_,+y,f):r.filter(b=>b[f]>=_&&b[f]<=y)}return r};var __rest$6=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};function getContinuousLegendAttributes(r){const e=mergeSpec({},r),{title:i={},handler:n={},rail:o={},track:l={},startText:d,endText:u,handlerText:f,sizeBackground:g,background:_={},type:y,id:b,visible:S,orient:v,position:A,data:x,defaultSelected:T,field:C,filter:E,regionId:P,regionIndex:R,seriesIndex:L,seriesId:w,padding:B}=e,I=__rest$6(e,["title","handler","rail","track","startText","endText","handlerText","sizeBackground","background","type","id","visible","orient","position","data","defaultSelected","field","filter","regionId","regionIndex","seriesIndex","seriesId","padding"]);return i.visible&&(I.title=transformLegendTitleAttributes(i)),I.showHandler=n.visible!==!1,isEmpty(n.style)||(I.handlerStyle=transformToGraphic(n.style)),isValid(o.width)&&(I.railWidth=o.width),isValid(o.height)&&(I.railHeight=o.height),isEmpty(o.style)||(I.railStyle=transformToGraphic(o.style)),isEmpty(l.style)||(I.trackStyle=transformToGraphic(l.style)),I.startText=transformComponentStyle(d),I.endText=transformComponentStyle(u),I.handlerText=transformComponentStyle(f),isEmpty(g)||(I.sizeBackground=transformToGraphic(g)),_.visible&&!isEmpty(_.style)&&(mergeSpec(I,_.style),isValid(_.padding)&&(I.padding=_.padding)),I}function isContinuousLegend(r){return r==="color"||r==="size"}const ContinuousLegendMap={color:ColorContinuousLegend,size:SizeContinuousLegend},SINGLE_SEQUENCE=["#C4E7FF","#98CAFF","#75ACFF","#518FF9","#2775DC","#005CBE","#00429F","#00287E"],SIZE=[2,10];class ContinuousLegend extends BaseLegend{static getSpecInfo(e){const i=getSpecInfo(e,this.specKey,this.type,n=>isContinuousLegend(n.type));return i&&i.forEach(n=>{n.type=n.spec.type==="color"?ComponentTypeEnum.colorLegend:ComponentTypeEnum.sizeLegend}),i}constructor(e,i){super(e,i),this.type=ComponentTypeEnum.colorLegend,this.name=ComponentTypeEnum.colorLegend;const n=this._spec.type==="color"?ComponentTypeEnum.colorLegend:ComponentTypeEnum.sizeLegend;this.type=n,this.name=n}setAttrFromSpec(){super.setAttrFromSpec(),this._field=this._spec.field,this._legendType=this._spec.type}init(e){super.init(e),eachSeries(this._regions,i=>{i.addViewDataFilter({type:"continuousLegendFilter",options:{selected:()=>this._selectedData,field:()=>this._field,data:()=>this._legendData.getLatestData(),isHierarchyData:i.isHierarchyData,customFilter:this._spec.customFilter},level:TransformLevel.legendFilter})},{userId:this._seriesUserId,specIndex:this._seriesIndex})}_getScaleInGlobal(){const e=this._option.globalScale;let i=this._spec.scale;return i||(i=this._legendType),e.getScale(i)}_initLegendData(){registerDataSetInstanceTransform(this._option.dataSet,"continuousLegendFilter",continuousLegendFilter),registerDataSetInstanceTransform(this._option.dataSet,"continuousLegendDataMake",continuousLegendDataMake);const e=new DataView(this._option.dataSet,{name:`${this.type}_${this.id}_data`});return e.transform({type:"continuousLegendDataMake",options:{series:()=>getSeries(this._regions,{userId:this._seriesUserId,specIndex:this._seriesIndex}),field:()=>this._field,scale:this._getScaleInGlobal.bind(this)}}),e}_initSelectedData(){this._spec.defaultSelected?this._selectedData=this._spec.defaultSelected.slice():this._selectedData=this._legendData.getLatestData()}_addDefaultTitleText(e){var i,n,o,l;if(!((i=e.title)===null||i===void 0)&&i.visible&&isNil(e.title.text)&&isNil((n=e.title.style)===null||n===void 0?void 0:n.text)){const d=this._field;if(d){const _=(l=(o=this._regions)===null||o===void 0?void 0:o[0])===null||l===void 0?void 0:l.getSeries()[0];return _?void(e.title.text=getFieldAlias(_.getRawData(),d)):void 0}let u=this._spec.scale;u||(u=this._legendType);const f=this._option.globalScale.getScaleSpec(u);if(!isDataDomainSpec(f==null?void 0:f.domain))return;const g=f.domain[0];if(g.fields.length===0)return;e.title.text=getFieldAlias(this._option.dataSet.getDataView(g.dataId),g.fields[0])}}_getLegendAttributes(e){var i,n;const o=this.layoutOrient==="bottom"||this.layoutOrient==="top"?"horizontal":"vertical",l=o==="horizontal"?"bottom":this.layoutOrient;let d=[];const u=this._getScaleInGlobal();u&&u.type==="linear"&&(d=u.range()),isEmpty(d)&&(d=this._legendType==="color"?SINGLE_SEQUENCE:SIZE);let f=(i=this._legendData.getLatestData()[0])!==null&&i!==void 0?i:0,g=(n=this._legendData.getLatestData()[1])!==null&&n!==void 0?n:1;this._legendData.getLatestData()[0]===this._legendData.getLatestData()[1]&&(f=Math.min(0,this._legendData.getLatestData()[0]),g=this._legendData.getLatestData()[0]===0?1:Math.max(0,this._legendData.getLatestData()[0]));const _=Object.assign({layout:o,align:l,zIndex:this.layoutZIndex,min:f,max:g,value:this._spec.defaultSelected,[this._legendType==="color"?"colors":"sizeRange"]:d},getContinuousLegendAttributes(this._spec));return this._addDefaultTitleText(_),_}_getLegendConstructor(){return ContinuousLegendMap[this._legendType]}_initEvent(){if(this._legendComponent){const e=this._spec.filter!==!1;this._legendComponent.addEventListener("change",debounce(i=>{const n=get(i,"detail.value");e&&this.setSelectedData(n),this.event.emit(ChartEvent.legendFilter,{model:this,value:n,event:i})},30))}}}ContinuousLegend.specKey="legends",ContinuousLegend.type=ComponentTypeEnum.continuousLegend;const registerContinuousLegend=()=>{Factory$1.registerComponent(ContinuousLegend.type,ContinuousLegend)},getDataArrayFromFieldArray=(r,e)=>isValid(e)?r.map(i=>e[i]):void 0,datumContainsArray=(r,e)=>i=>r.every((n,o)=>i[n]===(e==null?void 0:e[o])),hasData=r=>!isNil(r)&&(isArray(r)?r.length>0&&r.every(isValid):Object.keys(r).length>0);function showTooltip(r,e,i){var n,o,l;const d=Object.assign({regionIndex:0},e),u=i.getOption(),f=u.getRegionsInUserIdOrIndex(isValid(d.regionId)?[d.regionId]:void 0,isValid(d.regionIndex)?[d.regionIndex]:void 0)[0];if(!f)return"none";const g=getMarkInfoList(r,f),_=(n=d.activeType)!==null&&n!==void 0?n:g.length>1?"dimension":"mark",y=f.getLayoutStartPoint(),b=f.getLayoutRect(),S=u.globalInstance.getContainer(),v=Object.assign({x:0,y:0},S?getElementAbsolutePosition(S):{}),A=T=>{var C;const{dimensionFields:E,dimensionData:P,measureFields:R,measureData:L,groupField:w,groupData:B}=T.data;return(C=T.series.getViewData())===null||C===void 0?void 0:C.latestData.find(D=>datumContainsArray(E,P)(D)&&datumContainsArray(R,L)(D)&&(isNil(w)||datumContainsArray([w],[B])(D)))},x=T=>{var C,E;const P=(w=>({x:Math.min(Math.max(w.x,0),b.width),y:Math.min(Math.max(w.y,0),b.height)}))(T),R=(C=d.x)!==null&&C!==void 0?C:y.x+P.x,L=(E=d.y)!==null&&E!==void 0?E:y.y+P.y;return{canvasX:R,canvasY:L,clientX:v.x+R,clientY:v.y+L}};if(_==="dimension"){const T=g[0];if(!T)return"none";const C=new Map;g.forEach(L=>{var w;C.has(L.series)||C.set(L.series,[]),(w=C.get(L.series))===null||w===void 0||w.push(L)});const E=[{value:r[T.data.dimensionFields[0]],data:[...C.keys()].map(L=>{var w,B;return{series:L,datum:(B=(w=C.get(L))===null||w===void 0?void 0:w.map(I=>A(I)))!==null&&B!==void 0?B:[]}})}];isValid(T.dimType)&&(E[0].position=T.pos[T.dimType],E[0].dimType=T.dimType);const P={changePositionOnly:!1,action:"enter",tooltip:null,dimensionInfo:E,chart:(o=u.globalInstance.getChart())!==null&&o!==void 0?o:void 0,datum:void 0,model:void 0,source:Event_Source_Type.chart,event:x({x:g.reduce((L,w)=>L+w.pos.x,0)/g.length,y:g.reduce((L,w)=>L+w.pos.y,0)/g.length}),item:void 0,itemMap:new Map};i.processor.dimension.showTooltip(E,P,!1);const R=u.globalInstance;return VChart.globalConfig.uniqueTooltip&&VChart.hideTooltip(R.id),_}if(_==="mark"){const T=g[0];if(!T)return"none";const C=Object.assign(Object.assign({},A(T)),r),E=[{datum:[C],series:T.series}],P={changePositionOnly:!1,tooltip:null,dimensionInfo:[{value:C[T.data.dimensionFields[0]],data:E}],chart:(l=u.globalInstance.getChart())!==null&&l!==void 0?l:void 0,datum:C,model:T.series,source:Event_Source_Type.chart,event:x(T.pos),item:void 0,itemMap:new Map};i.processor.mark.showTooltip({datum:C,mark:null,series:T.series},P,!1);const R=u.globalInstance;return VChart.globalConfig.uniqueTooltip&&VChart.hideTooltip(R.id),_}return"none"}const getMarkInfoList=(r,e)=>{const i=e.getSeries(),n=[];return i.forEach(o=>{var l,d,u,f,g,_,y;const b=o.getDimensionField(),S=o.getMeasureField(),v=o.getSeriesField(),A=isValid(v)?r[v]:void 0,x=isValid(v)&&(f=(u=(d=(l=o.getViewDataStatistics)===null||l===void 0?void 0:l.call(o))===null||d===void 0?void 0:d.latestData[v])===null||u===void 0?void 0:u.values)!==null&&f!==void 0?f:[],T=getDataArrayFromFieldArray(b,r);let C=getDataArrayFromFieldArray(S,r);const E=hasData(C),P=!E&&isValid(v)&&isNil(A)&&x.length>0,R=()=>{var L;const w=(L=o.getViewData())===null||L===void 0?void 0:L.latestData.find(datumContainsArray(b,T));if(!E&&(C=getDataArrayFromFieldArray(S,w),!hasData(C)))return;const B=o.type===SeriesTypeEnum.pie?o.dataToCentralPosition(w):o.dataToPosition(w);isNil(B)||isNaN(B.x)||isNaN(B.y)||n.push({pos:B,data:{dimensionFields:b,dimensionData:T,measureFields:S,measureData:C,hasMeasureData:E,groupField:v,groupData:A},series:o})};if(o.coordinate==="cartesian"){const L=o,w=isDiscrete((_=(g=o.getYAxisHelper())===null||g===void 0?void 0:g.getScale(0))===null||_===void 0?void 0:_.type)?"y":"x",B=b.map((D,O)=>[D,O]).filter(([,D])=>isNil(T==null?void 0:T[D]));let I=[T??[]];B.length>0&&B.forEach(([D,O])=>{var N,V,H,F;const $=(F=(H=(V=(N=o.getViewDataStatistics)===null||N===void 0?void 0:N.call(o))===null||V===void 0?void 0:V.latestData[D])===null||H===void 0?void 0:H.values)!==null&&F!==void 0?F:[],G=[];I.forEach(Y=>{$.forEach(Q=>{var q;const te=(q=Y==null?void 0:Y.slice())!==null&&q!==void 0?q:[];te[O]=Q,G.push(te)})}),I=G}),I.forEach(D=>{var O,N;if(P){const V=(O=L.getViewData())===null||O===void 0?void 0:O.latestData.filter(datumContainsArray(b,D));x.forEach(H=>{const F=V.find(G=>G[v]===H);if(C=getDataArrayFromFieldArray(S,F),!hasData(C))return;const $=L.dataToPosition(F);isNil($)||isNaN($.x)||isNaN($.y)||n.push({pos:$,data:{dimensionFields:b,dimensionData:D,measureFields:S,measureData:C,hasMeasureData:E,groupField:v,groupData:H},series:o,dimType:w})})}else{const V=(N=L.getViewData())===null||N===void 0?void 0:N.latestData.find(datumContainsArray(b,D));if(!E&&(C=getDataArrayFromFieldArray(S,V),!hasData(C)))return;const H=L.dataToPosition(V);if(isNil(H)||isNaN(H.x)||isNaN(H.y))return;n.push({pos:H,data:{dimensionFields:b,dimensionData:D,measureFields:S,measureData:C,hasMeasureData:E,groupField:v,groupData:A},dimType:w,series:o})}})}else if(o.coordinate==="polar")if(o.type===SeriesTypeEnum.pie)R();else{const L=o;if(P){const w=((y=L.getViewData())===null||y===void 0?void 0:y.latestData.filter(datumContainsArray(b,T))).find(B=>B[v]===A);x.forEach(B=>{if(C=getDataArrayFromFieldArray(S,w),!hasData(C))return;const I=L.dataToPosition(w);isNil(I)||isNaN(I.x)||isNaN(I.y)||n.push({pos:I,data:{dimensionFields:b,dimensionData:T,measureFields:S,measureData:C,hasMeasureData:E,groupField:v,groupData:B},series:o})})}else R()}else o.coordinate==="geo"&&R()}),n},pick_keys=["updateTitle","updateContent","updatePosition","maxLineCount","othersLine"],getTooltipSpecForShow=(r,e,i,n,o)=>{var l,d,u;const f={activeType:r};switch(r){case"mark":case"group":if(i){const g=(l=i.getSpec())===null||l===void 0?void 0:l.tooltip;return f.visible=!0,g!=null&&g.handler&&(f.handler=g.handler),!((d=f.handler)===null||d===void 0)&&d.showTooltip?f:(g!=null&&g[r]&&pick_keys.forEach(_=>{isValid(g[r][_])&&(f[_]=g[r][_])}),Object.assign(Object.assign({},f),i.tooltipHelper.getTooltipData(r,e,n,n[0].datum,o)))}break;case"dimension":if(n!=null&&n.length){if(getSeriesListFromDimensionInfo(n).every(_=>{var y;return!isActiveTypeVisible("dimension",(y=_.tooltipHelper)===null||y===void 0?void 0:y.spec)})?f.visible=!1:f.visible=!0,f.handler=e.handler,(u=f.handler)===null||u===void 0?void 0:u.showTooltip)return f;const g=[];return n.forEach(_=>_.data.forEach(y=>{const{series:b}=y,S=b.tooltipHelper.getTooltipData(r,e,n,y.datum,o);S&&g.push(S)})),combineContents(g)}}return null},getSeriesListFromDimensionInfo=r=>{const e=[];return r.forEach(i=>{i.data.forEach(n=>{isValid(n.series)&&e.push(n.series)})}),e},TooltipHandlerType={dom:`${PREFIX}_TOOLTIP_HANDLER_DOM`,canvas:`${PREFIX}_TOOLTIP_HANDLER_CANVAS`},TOOLTIP_EL_CLASS_NAME="vchart-tooltip-element",TOOLTIP_MAX_LINE_COUNT=20,TOOLTIP_OTHERS_LINE={key:"",value:"..."},TOOLTIP_TYPES=["group","mark","dimension"],DEFAULT_SHOW_DELAY=50;class BaseTooltipProcessor{constructor(e){this._showTooltipByHandler=(i,n)=>{var o,l,d;if(isNil(i))return 1;n.changePositionOnly||this.clearCache(),this._updateViewSpec(i,n);const u=this._cacheActiveSpec;if(isNil(u)||u.visible===!1)return 1;n.tooltipSpec=this.component.getSpec(),n.activeTooltipSpec=u;const{title:f,content:g}=u,_=isNil(f==null?void 0:f.key)&&isNil(f==null?void 0:f.value)&&!(g!=null&&g.length);if(this.component.event.emit(ChartEvent.tooltipShow,Object.assign(Object.assign({},n),{isEmptyTooltip:_,tooltipData:i,activeType:this.activeType,tooltip:this.component})),_)return 1;let y;return!((o=u.handler)===null||o===void 0)&&o.showTooltip?y=u.handler.showTooltip.bind(u.handler):!((l=this.component.tooltipHandler)===null||l===void 0)&&l.showTooltip&&(y=this.component.tooltipHandler.showTooltip.bind(this.component.tooltipHandler)),y?(d=y(this.activeType,i,n))!==null&&d!==void 0?d:0:1},this.component=e}_preprocessDimensionInfo(e){const i=[];if(e==null||e.forEach(n=>{const o=Object.assign(Object.assign({},n),{data:n.data.filter(({series:l})=>{var d,u;return((u=(d=l.getSpec())===null||d===void 0?void 0:d.tooltip)===null||u===void 0?void 0:u.visible)!==!1})});o.data.length>0&&i.push(o)}),i.length>0)return i}_updateViewSpec(e,i){var n,o,l,d,u,f,g,_,y;const{changePositionOnly:b,model:S}=i;if(!b||!this._cacheActiveSpec){const v=this.component.getSpec();if(this._cacheActiveSpec=getTooltipSpecForShow(this.activeType,this.component.getSpec(),S,e,i),this._cacheActiveSpec){isNil(this._cacheActiveSpec.handler)&&isValid(v.handler)&&(this._cacheActiveSpec.handler=v.handler);const A=(n=v[this.activeType])!==null&&n!==void 0?n:{},x=(o=this._cacheActiveSpec.updateTitle)!==null&&o!==void 0?o:A.updateTitle,T=(l=this._cacheActiveSpec.updateContent)!==null&&l!==void 0?l:A.updateContent,C=(u=(d=this._cacheActiveSpec.maxLineCount)!==null&&d!==void 0?d:A.maxLineCount)!==null&&u!==void 0?u:TOOLTIP_MAX_LINE_COUNT;if(x&&(this._cacheActiveSpec.title=(f=x(this._cacheActiveSpec.title,e,i))!==null&&f!==void 0?f:this._cacheActiveSpec.title),T)this._cacheActiveSpec.content=(g=T(this._cacheActiveSpec.content,e,i))!==null&&g!==void 0?g:this._cacheActiveSpec.content;else if(C>=1&&((_=this._cacheActiveSpec.content)===null||_===void 0?void 0:_.length)>C){const E=(y=this._cacheActiveSpec.othersLine)!==null&&y!==void 0?y:A.othersLine,P=E?Object.assign(Object.assign({},TOOLTIP_OTHERS_LINE),E):TOOLTIP_OTHERS_LINE;this._cacheActiveSpec.content=[...this._cacheActiveSpec.content.slice(0,C-1),Object.assign(Object.assign({},this._cacheActiveSpec.content[C-1]),P)]}}}}shouldHandleTooltip(e,i){var n,o;return!isNil(i)&&isActiveTypeVisible(this.activeType,(o=(n=e.model)===null||n===void 0?void 0:n.tooltipHelper)===null||o===void 0?void 0:o.spec)}clearCache(){this._cacheActiveSpec=void 0}}class DimensionTooltipProcessor extends BaseTooltipProcessor{constructor(){super(...arguments),this.activeType="dimension"}showTooltip(e,i,n){const o=Object.assign(Object.assign({},i),{dimensionInfo:this._preprocessDimensionInfo(e),changePositionOnly:n,tooltip:this.component});return this._showTooltipByHandler(e,o)}_getDimensionInfo(e){var i,n;let o;const l=this.component.getChart(),d=l.getCompiler().getStage().getLayer(void 0),u={x:e.event.viewX,y:e.event.viewY};if(d.globalTransMatrix.transformPoint({x:e.event.viewX,y:e.event.viewY},u),o=[...(i=getCartesianDimensionInfo(l,u,!0))!==null&&i!==void 0?i:[],...(n=getPolarDimensionInfo(l,u))!==null&&n!==void 0?n:[]],o.length===0)o=void 0;else if(o.length>1){const f=o.filter(g=>{var _;const y=g.axis;if(y.getSpec().hasDimensionTooltip)return!0;if(!isDiscrete(y.getScale().type))return!1;let b;for(const S of(_=y==null?void 0:y.getRegions())!==null&&_!==void 0?_:[]){for(const v of S.getSeries())if(v.coordinate==="cartesian"){b=v;break}if(isValid(b))break}return isValid(b)&&b.getDimensionField()[0]===b.fieldY[0]?y.getOrient()==="left"||y.getOrient()==="right":y.getOrient()==="bottom"||y.getOrient()==="top"});if(o=f.length?f:o.slice(0,1),o.length>1){const g=new Set;o.forEach(_=>{_.data=_.data.filter(({key:y})=>!g.has(y)&&(g.add(y),!0))})}}return o}getMouseEventData(e){return{tooltipInfo:this._getDimensionInfo(e),ignore:!1}}}class MarkTooltipProcessor extends BaseTooltipProcessor{constructor(){super(...arguments),this.activeType="mark"}showTooltip(e,i,n){var o,l,d;const{datum:u,series:f}=e,g=this.component.getSpec(),_=[{datum:[u],series:f}],y=f.tooltipHelper,b=(o=f.getSpec())===null||o===void 0?void 0:o.tooltip,S=(l=b==null?void 0:b.mark)===null||l===void 0?void 0:l.checkOverlap;let v=!1;if(S===!0||((d=g.mark)===null||d===void 0?void 0:d.checkOverlap)===!0&&S!==!1){const x=y==null?void 0:y.activeTriggerSet.mark;if(x){v=!0;const T=this.component.getChart().getCompiler().getStage().getLayer(void 0),C={x:i.event.viewX,y:i.event.viewY};T.globalTransMatrix.transformPoint({x:i.event.viewX,y:i.event.viewY},C),x.forEach(E=>{E.getProductElements().forEach(P=>{const R=P.getGraphicItem();P!==i.item&&R&&R.containsPoint(C.x,C.y,IContainPointMode.GLOBAL,R.stage.getPickerService())&&_[0].datum.push(P.getDatum())})})}}const A=Object.assign(Object.assign({},i),{changePositionOnly:n,tooltip:this.component});if(n&&v){const x=this._cacheActiveSpec&&this._cacheActiveSpec.data;x&&x[0].series===_[0].series&&x[0].datum.length===_[0].datum.length&&!x[0].datum.some((T,C)=>T!==_[0].datum[C])||(A.changePositionOnly=!1)}return this._showTooltipByHandler(_,A)}getMouseEventData(e){var i;let n,o;if(((i=e.model)===null||i===void 0?void 0:i.modelType)==="series"){const l=e.model,d=l.tooltipHelper,u=d==null?void 0:d.activeTriggerSet.mark,f=d==null?void 0:d.ignoreTriggerSet.mark;u!=null&&u.has(e.mark)?n={mark:e.mark,datum:e.datum,series:l}:f!=null&&f.has(e.mark)&&(o=!0)}return{tooltipInfo:n,ignore:o}}}class GroupTooltipProcessor extends BaseTooltipProcessor{constructor(){super(...arguments),this.activeType="group"}showTooltip(e,i,n){const{datum:o,series:l}=e,d=[{datum:array(o),series:l}],u=Object.assign(Object.assign({},i),{groupDatum:this._getGroupDatum(i),changePositionOnly:n,tooltip:this.component});return this._showTooltipByHandler(d,u)}getMouseEventData(e){var i,n;let o;if(((i=e.model)===null||i===void 0?void 0:i.modelType)==="series"){const l=e.model,d=l.tooltipHelper,u=d==null?void 0:d.activeTriggerSet.group;if(u!=null&&u.has(e.mark)){const f=this.component.getSpec()[this.activeType];(f!=null&&f.triggerMark?array(f.triggerMark):[]).includes((n=e.mark)===null||n===void 0?void 0:n.name)&&(o={mark:e.mark,datum:e.datum,series:l})}}return{tooltipInfo:o,ignore:!1}}_getGroupDatum(e){const{model:i,mark:n,datum:o}=e,l=i;if(["line","area"].includes(n.type))return array(o);const d=l.getViewData().latestData,u=l.getSeriesField();if(!u)return d;const f=array(o)[0][u];return d.filter(g=>g[u]===f)}}const isMarkInfo=r=>isValid(r)&&!isArray(r),isDimensionInfo=r=>isValid(r)&&isArray(r);class TooltipSpecTransformer extends BaseComponentSpecTransformer{_shouldMergeThemeToSpec(){return!1}_initTheme(e,i){var n;const{spec:o,theme:l}=super._initTheme(e,i);return o.style=mergeSpec({},this._theme,o.style),o.offset=mergeSpec({},l.offset,e.offset),o.transitionDuration=(n=e.transitionDuration)!==null&&n!==void 0?n:l.transitionDuration,{spec:o,theme:l}}_transformSpecAfterMergingTheme(e,i,n){var o,l,d,u,f,g,_;super._transformSpecAfterMergingTheme(e,i,n),e.visible=(o=e.visible)===null||o===void 0||o,e.activeType=getTooltipActualActiveType(e),e.renderMode=(l=e.renderMode)!==null&&l!==void 0?l:isMiniAppLikeMode(this._option.mode)||!isTrueBrowser(this._option.mode)?"canvas":"html",e.trigger=(d=e.trigger)!==null&&d!==void 0?d:"hover",e.className=(u=e.className)!==null&&u!==void 0?u:TOOLTIP_EL_CLASS_NAME,e.enterable=(f=e.enterable)!==null&&f!==void 0&&f,e.transitionDuration=(g=e.transitionDuration)!==null&&g!==void 0?g:150,e.confine=(_=e.confine)!==null&&_!==void 0?_:e.renderMode==="canvas",isValid(e.parentElement)?isString(e.parentElement)&&(e.parentElement=vglobal.getElementById(e.parentElement)):isTrueBrowser(this._option.mode)&&(e.parentElement=domDocument==null?void 0:domDocument.body)}}class Tooltip extends BaseComponent{constructor(){super(...arguments),this.layoutZIndex=1,this.type=ComponentTypeEnum.tooltip,this.name=ComponentTypeEnum.tooltip,this.transformerConstructor=TooltipSpecTransformer,this.specKey="tooltip",this.layoutType="none",this._isReleased=!1,this._alwaysShow=!1,this._eventList=[],this._isTooltipShown=!1,this._clickLock=!1,this._mountEvent=(e,i,n)=>{this.event.on(e,i,n),this._eventList.push({eventType:e,handler:n})},this._handleClickToLock=e=>{this._clickLock?(this._handleChartMouseOut(e),this._clickLock=!1):this._clickLock=!0},this._getMouseOutHandler=e=>i=>{var n,o,l,d,u;if(this._isReleased||this._alwaysShow||this._clickLock||!this._isTooltipShown&&!(!((o=(n=this.tooltipHandler)===null||n===void 0?void 0:n.isTooltipShown)===null||o===void 0)&&o.call(n)))return;const f=isTrueBrowser((l=this._option)===null||l===void 0?void 0:l.mode),{clientX:g,clientY:_}=i.event;f&&e&&this._isPointerInChart({x:g,y:_})||(this._enterable?this._outTimer=setTimeout(()=>{this._handleChartMouseOut(i)},(u=(d=this._spec)===null||d===void 0?void 0:d.showDelay)!==null&&u!==void 0?u:DEFAULT_SHOW_DELAY):this._handleChartMouseOut(i))},this._handleChartMouseOut=e=>{this._alwaysShow||this._isReleased||this._spec.triggerOff!=="none"&&(this._hideTooltipByHandler(Object.assign(Object.assign({},e),{tooltip:this})),this._handleMouseMove&&this._handleMouseMove.cancel&&this._handleMouseMove.cancel(),this._cacheEnterableRect=null,this._cacheInfo=void 0,this._cacheParams=void 0,this._cacheActiveType=void 0)},this._getMouseMoveHandler=e=>i=>{var n,o,l,d;this._isReleased||(this._outTimer&&(clearTimeout(this._outTimer),this._outTimer=null),this.tooltipHandler||this._initHandler(),this.processor||this._initProcessor(),this._alwaysShow||(this._clickLock?e&&(this._handleChartMouseOut(i),this._clickLock=!1):!e&&this._enterable&&(!((o=(n=this.tooltipHandler)===null||n===void 0?void 0:n.isTooltipShown)===null||o===void 0)&&o.call(n))?(this._showTimer&&clearTimeout(this._showTimer),this._showTimer=setTimeout(()=>{this._handleChartMouseMove(i,e)},(d=(l=this._spec)===null||l===void 0?void 0:l.showDelay)!==null&&d!==void 0?d:DEFAULT_SHOW_DELAY)):this._handleChartMouseMove(i,e)))},this._handleChartMouseMove=(e,i)=>{if(this._isReleased)return;const n=this._getMouseEventData(e),{tooltipInfo:{dimension:o},ignore:{mark:l}}=n,d={mark:!1,dimension:!1,group:!1};for(let u=0,f=TOOLTIP_TYPES.length;u<f;u++){const g=TOOLTIP_TYPES[u];if(this.processor[g]&&this._showTooltipByMouseEvent(g,n,e,i)){d[g]=!0;break}}Object.values(d).every(u=>!u)&&!isEmptyPos(e)&&(l&&isMarkInfo(this._cacheInfo)?d.mark=this._showTooltipByMouseEvent("mark",n,e,i,!0):isValid(o)&&(d.dimension=this._showTooltipByMouseEvent("dimension",n,e,i))),d.mark||d.group||d.dimension&&!isNil(o)?this._initEventOfTooltipContent():this._handleChartMouseOut(e)},this._showTooltipByMouseEvent=(e,i,n,o,l)=>{var d;const u=this.processor[e];if(!u.shouldHandleTooltip(n,i.tooltipInfo[e]))return!1;let f;if(this._hideTimer&&clearTimeout(this._hideTimer),l)f=!u.showTooltip(this._cacheInfo,n,!0);else{const _=i.tooltipInfo[e],y=this._isSameAsCache(_,n,e);f=!u.showTooltip(_,n,y),f&&(this._cacheInfo=_,this._cacheParams=n,this._cacheActiveType=e)}f&&(this._isTooltipShown=!0,o&&this._spec.lockAfterClick&&!this._clickLock?this._clickLock=!0:Number.isFinite(this._spec.hideTimer)&&(this._hideTimer=setTimeout(()=>{this._handleChartMouseOut()},this._spec.hideTimer)));const g=(d=this._option)===null||d===void 0?void 0:d.globalInstance;return f&&VChart.globalConfig.uniqueTooltip&&g&&VChart.hideTooltip(g.id),f},this._getMouseEventData=e=>{const i={tooltipInfo:{},ignore:{}};return Object.keys(this.processor).forEach(n=>{const{tooltipInfo:o,ignore:l}=this.processor[n].getMouseEventData(e);i.tooltipInfo[n]=o,i.ignore[n]=l}),i},this._hideTooltipByHandler=e=>{var i,n,o;if(!this._isTooltipShown&&!(!((n=(i=this.tooltipHandler)===null||i===void 0?void 0:i.isTooltipShown)===null||n===void 0)&&n.call(i)))return 0;this.event.emit(ChartEvent.tooltipHide,Object.assign(Object.assign({},e),{source:Event_Source_Type.chart,tooltip:this})),Object.values(this.processor).forEach(d=>{d.clearCache()});const l=(o=this._spec.handler)!==null&&o!==void 0?o:this.tooltipHandler;if(l.hideTooltip){const d=l.hideTooltip.call(l,e);return d||(this._isTooltipShown=!1),d}return 1},this.hideTooltip=()=>{if(this._isReleased)return!1;const e={changePositionOnly:!1,tooltip:this,item:void 0,datum:void 0,source:Event_Source_Type.chart};return this._alwaysShow=!1,!this._hideTooltipByHandler(e)}}isTooltipShown(){return this._isTooltipShown}changeRegions(e){}_getNeedClearVRenderComponents(){return[]}_registerEvent(){}_releaseEvent(){}onLayout(e){}onLayoutEnd(e){}onRender(e){}created(){super.created(),this._regions=this._option.getAllRegions(),this._initEvent()}release(){var e,i;super.release(),this._isReleased=!0,this._hideTimer&&clearTimeout(this._hideTimer),this._eventList.forEach(({eventType:n,handler:o})=>{this.event.off(n,o)}),this._eventList=[],(i=(e=this.tooltipHandler)===null||e===void 0?void 0:e.release)===null||i===void 0||i.call(e),this._isTooltipShown=!1}beforeRelease(){this.event.emit(ChartEvent.tooltipHide,{tooltip:this,chart:this.getChart()}),this.event.emit(ChartEvent.tooltipRelease,{tooltip:this,chart:this.getChart()})}_initHandler(){var e,i,n;const o=(e=this._spec.renderMode)!==null&&e!==void 0?e:"html",l=this._option.globalInstance.getTooltipHandlerByUser();if(l)this.tooltipHandler=l,this._enterable=!1;else{const d=o==="canvas"?TooltipHandlerType.canvas:TooltipHandlerType.dom,u=Factory$1.getComponentPluginInType(d);u||error$1("Can not find tooltip handler: "+d);const f=new u;f.name=`${this._spec.className}-${(i=this._option.globalInstance.id)!==null&&i!==void 0?i:0}-${this.getSpecIndex()}`,(n=this.pluginService)===null||n===void 0||n.load([f]),this.tooltipHandler=f,this._spec.enterable&&o==="html"&&this.tooltipHandler?(this._enterable=!0,this._needInitEventOfTooltip=!0):this._enterable=!1}}_initEventOfTooltipContent(){var e,i;if(!this._needInitEventOfTooltip)return;const n=(i=(e=this.tooltipHandler).getTooltipContainer)===null||i===void 0?void 0:i.call(e),o=n==null?void 0:n.firstChild;o&&(o.addEventListener("pointerenter",()=>{var l;if(!this._enterable)return;const d=(l=o.getBoundingClientRect)===null||l===void 0?void 0:l.call(o);d&&(this._cacheEnterableRect={x:d.x,y:d.y,width:d.width,height:d.height}),this._outTimer&&(clearTimeout(this._outTimer),this._outTimer=null),this._showTimer&&(clearTimeout(this._showTimer),this._showTimer=null)}),o.addEventListener("pointerleave",()=>{var l,d,u;if(this._enterable&&this._cacheEnterableRect){const f=(l=o.getBoundingClientRect)===null||l===void 0?void 0:l.call(o);f&&Object.keys(this._cacheEnterableRect).every(g=>this._cacheEnterableRect[g]===f[g])&&(this._cacheEnterableRect=null,this._outTimer=setTimeout(this.hideTooltip,(u=(d=this._spec)===null||d===void 0?void 0:d.showDelay)!==null&&u!==void 0?u:DEFAULT_SHOW_DELAY))}}),this._needInitEventOfTooltip=!1)}_initProcessor(){const e=this._spec.activeType;this.processor={},e.includes("dimension")&&(this.processor.dimension=new DimensionTooltipProcessor(this)),e.includes("group")&&(this.processor.group=new GroupTooltipProcessor(this)),e.includes("mark")&&(this.processor.mark=new MarkTooltipProcessor(this))}_initEvent(){var e;if(this._option.disableTriggerEvent)return;const i=array((e=this._spec.trigger)!==null&&e!==void 0?e:"hover"),n=array(this._spec.triggerOff),o=this._option.mode;i.forEach(l=>{var d;l==="hover"?(this._handleMouseMove=this._throttle(this._getMouseMoveHandler(!1)),this._mountEvent("pointermove",{source:"chart"},this._handleMouseMove),(isMobileLikeMode(o)||isMiniAppLikeMode(o))&&(this._mountEvent("pointerdown",{source:"chart"},this._getMouseMoveHandler(!1)),this._mountEvent("pointerup",{source:"window"},this._getMouseOutHandler(!0))),this._mountEvent("pointerleave",{source:"chart"},this._getMouseOutHandler(!1))):l==="click"?(this._mountEvent("pointertap",{source:"chart"},this._getMouseMoveHandler(!0)),this._mountEvent("pointerup",{source:"window"},this._getMouseOutHandler(!0))):isObject$1(l)&&this._mountEvent(l.eventType,{source:(d=l.source)!==null&&d!==void 0?d:"chart",consume:l.consume},this._getMouseMoveHandler(!0))}),n.filter(l=>isObject$1(l)).forEach(l=>{var d,u;this._mountEvent(l.eventType,{source:(d=l.source)!==null&&d!==void 0?d:"chart",consume:l.consume},this._getMouseOutHandler((u=l.checkOutside)!==null&&u!==void 0&&u))}),!i.includes("click")&&this._spec.lockAfterClick&&this._mountEvent("pointertap",{source:"chart"},this._handleClickToLock)}_throttle(e){let i;return i=isNumber(this._spec.throttleInterval)?this._spec.throttleInterval:this._spec.renderMode==="html"&&this._spec.transitionDuration?50:10,throttle(e,i)}reInit(e){var i,n,o;if(super.reInit(e),this.tooltipHandler){const l=(i=this._spec.renderMode)!==null&&i!==void 0?i:"html",d=this._spec.enterable&&l==="html";d&&!this._enterable&&(this._needInitEventOfTooltip=!0),this._enterable=d,(o=(n=this.tooltipHandler).reInit)===null||o===void 0||o.call(n)}else this._initHandler()}showTooltip(e,i){var n;if(this.tooltipHandler||this._initHandler(),this.processor||this._initProcessor(),!(!((n=this.tooltipHandler)===null||n===void 0)&&n.showTooltip))return!1;const o=showTooltip(e,i,this);return o!=="none"&&(this._alwaysShow=!!(i!=null&&i.alwaysShow)),o}_isSameAsCache(e,i,n){if(n!==this._cacheActiveType)return!1;if(e===this._cacheInfo)return!0;if(isNil(this._cacheInfo)||isNil(e))return!1;if(isDimensionInfo(e)){if(isMarkInfo(this._cacheInfo))return!1;const d=this._cacheInfo;return d.length===e.length&&e.every((u,f)=>isSameDimensionInfo(u,d[f]))}if(isDimensionInfo(this._cacheInfo))return!1;const o=this._cacheInfo;if(!((e==null?void 0:e.datum)===o.datum&&(e==null?void 0:e.mark)===o.mark&&(e==null?void 0:e.series)===o.series))return!1;const l=this._cacheParams;return!isNil(l)&&!isNil(i)&&l.mark===i.mark&&l.model===i.model&&l.datum===i.datum}_isPointerInChart(e){var i;const n=(i=this._option)===null||i===void 0?void 0:i.globalInstance;if(!n||!n.getChart())return!1;const{x:o,y:l}=e,d=n.getCanvas(),{x:u,y:f,width:g,height:_}=d.getBoundingClientRect();return o>=u&&o<=u+g&&l>=f&&l<=f+_}getVisible(){return this._spec.visible!==!1}}Tooltip.type=ComponentTypeEnum.tooltip,Tooltip.transformerConstructor=TooltipSpecTransformer,Tooltip.specKey="tooltip";const registerTooltip=()=>{Factory$1.registerComponent(Tooltip.type,Tooltip)};function getDefaultCrosshairTriggerEventByMode(r){return r===RenderModeEnum["desktop-browser"]||r===RenderModeEnum["desktop-miniApp"]?{click:"pointertap",hover:"pointermove",hoverOut:"pointerleave",clickOut:"pointerleave"}:isMobileLikeMode(r)||isMiniAppLikeMode(r)?{click:"tap",hover:["pointerdown","pointermove"],hoverOut:"pointerleave",clickOut:"pointerleave"}:null}var LayoutType;(function(r){r[r.ALL=3]="ALL",r[r.HORIZONTAL=2]="HORIZONTAL",r[r.VERTICAL=1]="VERTICAL"})(LayoutType||(LayoutType={}));var __rest$5=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};const ORIENT_MAP={x:["top","bottom"],y:["left","right"],category:["angle"],value:["radius"]};class BaseCrossHair extends BaseComponent{get enableRemain(){return this.triggerOff==="none"}constructor(e,i){super(e,i),this.specKey="crosshair",this.layoutType="none",this.gridZIndex=LayoutZIndex.CrossHair_Grid,this.labelZIndex=LayoutZIndex.CrossHair,this.trigger="hover",this._handleIn=n=>{if(!this._option)return;const{x:o,y:l}=this.calculateTriggerPoint(n);this.showDefault=!1,this._layoutCrosshair(o,l);const d=this._getNeedClearVRenderComponents();this._hasActive=d.some(u=>u&&u.attribute.visible!==!1)},this._handleClickInEvent=n=>{if(!this._hasActive||!this._spec.lockAfterClick||this._clickLock)return this._clickLock?(this._clickLock=!1,void this._handleOutEvent()):void(this._onlyLockClick||(this._handleIn(n),isNumber(this.triggerOff)&&(this._timer&&clearTimeout(this._timer),this._timer=setTimeout(()=>{this._handleOutEvent()},this.triggerOff))));this._clickLock=!0},this._handleHoverInEvent=throttle(n=>{this._clickLock||this._handleIn(n)},10),this._handleOutEvent=()=>{this.enableRemain||this._clickLock||!this._hasActive||(this.clearOutEvent(),this.hide())},this._handleTooltipShow=n=>{const o=n.tooltipData;if(n.isEmptyTooltip||!o||!o.length)return void this._handleTooltipHideOrRelease();if(isObject$1(this._spec.followTooltip)&&this._spec.followTooltip[n.activeType]===!1)return void this._handleTooltipHideOrRelease();const{x:l,y:d}=this.calculateTriggerPoint(n);this.showDefault=!1,this._layoutCrosshair(l,d,o,n.activeType);const u=this._getNeedClearVRenderComponents();this._hasActive=u.some(f=>f&&f.attribute.visible!==!1)},this._handleTooltipHideOrRelease=()=>{this.clearOutEvent(),this.hide()},this.enable=!0,this.showDefault=!0}_getLimitBounds(){var e,i;if(!this._limitBounds){const{width:n,height:o}=(i=(e=this._option.globalInstance.getChart())===null||e===void 0?void 0:e.getViewRect())!==null&&i!==void 0?i:{width:0,height:0};this._limitBounds={x1:0,y1:0,x2:n,y2:o}}return this._limitBounds}_showDefaultCrosshair(){this.showDefault&&this._showDefaultCrosshairBySpec()}setAttrFromSpec(){super.setAttrFromSpec(),this._parseCrosshairSpec()}created(){super.created(),this._initEvent()}_compareSpec(e,i){const n=super._compareSpec(e,i);return n.reMake||isEqual(i,e)||(n.reRender=!0,n.reMake=!0),n}_initEvent(){if(!this._option.disableTriggerEvent)if(this._spec.followTooltip)this._registerTooltipEvent();else{const e=this._getTriggerEvent();e&&e.forEach(i=>{this._registerEvent(i.in,!1,i.click),i.out&&this._registerEvent(i.out,!0)})}}_registerEvent(e,i,n){const o=i?this._handleOutEvent:n?this._handleClickInEvent:this._handleHoverInEvent,l=i?{level:Event_Bubble_Level.chart}:{source:Event_Source_Type.chart};isArray(e)?e.forEach(d=>{this.event.on(d,l,o)}):this.event.on(e,l,o)}_eventOff(e,i,n){const o=i?this._handleOutEvent:n?this._handleClickInEvent:this._handleHoverInEvent;isArray(e)?e.forEach(l=>{this.event.off(l,o)}):this.event.off(e,o)}updateLayoutAttribute(){this._limitBounds=null,this._showDefaultCrosshair()}calculateTriggerPoint(e){const{event:i}=e,n=this._option.getCompiler().getStage().getLayer(void 0),o={x:i.viewX,y:i.viewY};return n.globalTransMatrix.transformPoint({x:i.viewX,y:i.viewY},o),{x:o.x-this.getLayoutStartPoint().x,y:o.y-this.getLayoutStartPoint().y}}_getTriggerEvent(){const{mode:e=RenderModeEnum["desktop-browser"]}=this._option,i=getDefaultCrosshairTriggerEventByMode(e);if(i){const n=array(this.trigger||"hover"),o=d=>d==="click"?this.triggerOff==="none"?null:i.clickOut:i.hoverOut;this._spec.lockAfterClick&&!n.includes("click")?(n.push("click"),this._onlyLockClick=!0):this._onlyLockClick=!1;const l=[];return n.forEach(d=>{l.push({click:d==="click",in:i[d],out:o(d)})}),l}return null}_registerTooltipEvent(){this.event.on(ChartEvent.tooltipHide,{source:Event_Source_Type.chart},this._handleTooltipHideOrRelease),this.event.on(ChartEvent.tooltipShow,{source:Event_Source_Type.chart},this._handleTooltipShow),this.event.on(ChartEvent.tooltipRelease,{source:Event_Source_Type.chart},this._handleTooltipHideOrRelease)}_getAxisInfoByField(e){var i,n;const o=(n=(i=this._option).getComponentsByKey)===null||n===void 0?void 0:n.call(i,"axes");if(!(o!=null&&o.length))return null;let l=get(this._spec,`${e}Field.bindingAxesIndex`);if(l||(l=[],o.forEach((S,v)=>{ORIENT_MAP[e].includes(S.getOrient())&&l.push(v)})),!l.length)return null;const d=new Map;let u=1/0,f=1/0,g=-1/0,_=-1/0;const{x:y,y:b}=this.getLayoutStartPoint();return l.forEach(S=>{u=1/0,f=1/0,g=-1/0,_=-1/0;const v=o.find(A=>A.getSpecIndex()===S);v&&(v.getRegions().forEach(A=>{const{x,y:T}=A.getLayoutStartPoint();u=Math.min(u,x-y),f=Math.min(f,T-b),g=Math.max(g,x+A.getLayoutRect().width-y),_=Math.max(_,T+A.getLayoutRect().height-b)}),d.set(S,{x1:u,y1:f,x2:g,y2:_,axis:v}))}),d}changeRegions(e){}onLayoutEnd(e){const i=this._regions[0];this.setLayoutRect(i.getLayoutRect()),this.setLayoutStartPosition(i.getLayoutStartPoint()),super.onLayoutEnd(e)}onRender(e){}_releaseEvent(){this.clearOutEvent();const e=this._getTriggerEvent();e&&e.forEach(i=>{this._eventOff(i.in,!1,i.click),i.out&&this._eventOff(i.out,!0)})}_parseCrosshairSpec(){this._parseFieldInfo();const{trigger:e,triggerOff:i,labelZIndex:n,gridZIndex:o}=this._spec;e&&(this.trigger=e),(i==="none"||isNumber(i)&&i>0)&&(this.triggerOff=i),n!==void 0&&(this.labelZIndex=n),o!==void 0&&(this.gridZIndex=o)}_parseField(e,i){var n,o,l;const d={},{line:u={},label:f={},visible:g}=e;if(d.visible=g,d.type=u.type||"line",u.visible===!1)d.style={visible:!1};else{const _=u.style||{},{stroke:y,fill:b,lineWidth:S}=_,v=_,{strokeOpacity:A,fillOpacity:x,opacity:T}=v,C=__rest$5(v,["strokeOpacity","fillOpacity","opacity"]),E=d.type==="line";let P=E?A:x;if(isNumber(T)&&(P=(P??1)*T),d.style=Object.assign({opacity:P,pickable:!1,visible:!0},C),E)d.style.stroke=y||b,d.style.lineWidth=get(u,"width",S||2);else{d.style.fill=b||y,!((l=(o=(n=this._spec[i])===null||n===void 0?void 0:n.line)===null||o===void 0?void 0:o.style)===null||l===void 0)&&l.stroke&&(d.style.stroke=this._spec[i].line.style.stroke);const R=get(u,"width");if(typeof R=="string"){const L=parseInt(R.substring(0,R.length-1),10)/100;d.style.sizePercent=L}else typeof R!="number"&&typeof R!="function"||(d.style.size=R)}}if(f.visible){const _=f.labelBackground||{},y=f.style||{},b=_.style||{},{fill:S="rgba(47, 59, 82, 0.9)",stroke:v,outerBorder:A}=b,x=__rest$5(b,["fill","stroke","outerBorder"]);d.label={visible:!0,formatMethod:f.formatMethod,formatter:f.formatter,minWidth:_.minWidth,maxWidth:_.maxWidth,padding:_.padding,textStyle:Object.assign(Object.assign({fontSize:14,pickable:!1},y),{fill:y.fill||"#fff",stroke:get(y,"stroke")}),panel:(isBoolean(_.visible)?_.visible:_)?Object.assign({visible:!0,pickable:!1,fill:S,stroke:v,outerBorder:Object.assign({stroke:S,distance:0,lineWidth:3},A)},x):{visible:!1},zIndex:this.labelZIndex,childrenPickable:!1,pickable:!1}}else d.label={visible:!1};return d}_filterAxisByPoint(e,i,n){return e&&e.forEach(o=>{const l=o.axis;if(outOfBounds(o,i,n)&&e.delete(l.getSpecIndex()),l.type.startsWith("polarAxis")){const d=l.getCenter(),u=l.getInnerRadius(),f=l.getOuterRadius(),g=PointService.distancePP({x:i,y:n},d);(g>f||g<u)&&e.delete(l.getSpecIndex())}}),e}clearOutEvent(){this._timer&&(clearTimeout(this._timer),this._timer=null),this._clickLock&&(this._clickLock=null),this._hasActive&&(this._hasActive=null)}}BaseCrossHair.specKey="crosshair";const layoutByValue$1=(r=3,e,i,n,o,l,d,u=!1,f,g)=>{const _=1&r,y=2&r;i||(i={x:0,y:0});let b=null,S=null,v=0,A=0;if(n.size){const D=Array.from(n.values())[0];v=D.axis.getScale().scale(D.value)+D.axis.getLayoutStartPoint().x-i.x,b=D.axis}if(o.size){const D=Array.from(o.values())[0];A=D.axis.getScale().scale(D.value)+D.axis.getLayoutStartPoint().y-i.y,S=D.axis}const x=!!n.size&&Number.isFinite(v),T=!!o.size&&Number.isFinite(A),C=u&&!x&&isValid(f),E=u&&!T&&isValid(g);let P,R,L;_&&(P=C?f:{height:0,leftPos:0,rightPos:0,topPos:0,x:0,bottom:{visible:!1,text:"",dx:0,dy:0},top:{visible:!1,text:"",dx:0,dy:0},visible:x,axis:b}),y&&(R=E?g:{width:0,leftPos:0,topPos:0,bottomPos:0,y:0,left:{visible:!1,text:"",dx:0,dy:0},right:{visible:!1,text:"",dx:0,dy:0},visible:T,axis:S});let w,B=0,I=0;if(l&&n.forEach(({axis:D,value:O})=>{var N;O=O??"";let V=null;const H=D.getScale();if(isDiscrete(H.type))L=H.bandwidth(),L===0&&H.step&&(B=H.step());else if(isContinuous(H.type)){const F=e.fieldX[0],$=e.fieldX2,G=getDatumByValue(e.getViewData().latestData,+O,F,$);if(G){const Y=e.dataToPositionX(G);$?(L=Math.abs(Y-e.dataToPositionX1(G)),O=`${G[F]} ~ ${G[$]}`):L=1,v=Y}V=D.niceLabelFormatter}if(P&&(!((N=l.label)===null||N===void 0)&&N.visible)&&!C){const F=getAxisLabelOffset(D.getSpec());D.getOrient()==="bottom"?(P.bottom.visible=!0,P.bottom.defaultFormatter=V,P.bottom.text=O,P.bottom.dx=0,P.bottom.dy=F):D.getOrient()==="top"&&(P.top.visible=!0,P.top.defaultFormatter=V,P.top.text=O,P.top.dx=0,P.top.dy=-F)}}),d&&o.forEach(({axis:D,value:O})=>{var N;O=O??"";let V=null;const H=D.getScale();if(isDiscrete(H.type))w=H.bandwidth(),w===0&&H.step&&(I=H.step());else if(isContinuous(H.type)){const F=e.fieldY[0],$=e.fieldY2,G=getDatumByValue(e.getViewData().latestData,+O,F,$);if(G){const Y=e.dataToPositionY(G);$?(w=Math.abs(Y-e.dataToPositionY1(G)),O=`${G[F]} ~ ${G[$]}`):w=1,A=Y}V=D.niceLabelFormatter}if(R&&(!((N=d.label)===null||N===void 0)&&N.visible)&&!E){const F=getAxisLabelOffset(D.getSpec());D.getOrient()==="left"?(R.left.visible=!0,R.left.defaultFormatter=V,R.left.text=O,R.left.dx=-F,R.left.dy=0):D.getOrient()==="right"&&(R.right.visible=!0,R.right.defaultFormatter=V,R.right.text=O,R.right.dx=F,R.right.dy=0)}}),P&&!C){const D={x1:1/0,y1:1/0,x2:-1/0,y2:-1/0};if(setRegionArea(D,n),P.leftPos=D.x1,P.rightPos=D.x2,P.topPos=D.y1,P.height=D.y2-D.y1,P.x=v+i.x,l&&l.label){const{top:O,bottom:N}=P;O.visible&&setFormattedCrosshairLabel(O,"top",l.label),N.visible&&setFormattedCrosshairLabel(N,"bottom",l.label)}}if(R&&!E){const D={x1:1/0,y1:1/0,x2:-1/0,y2:-1/0};if(setRegionArea(D,o),R.leftPos=D.x1,R.topPos=D.y1,R.bottomPos=D.y2,R.width=D.x2-D.x1,R.y=A+i.y,d&&d.label){const{left:O,right:N}=R;O.visible&&setFormattedCrosshairLabel(O,"left",d.label),N.visible&&setFormattedCrosshairLabel(N,"right",d.label)}}return{x:_&&P?P:void 0,y:y&&R?R:void 0,offsetWidth:B,offsetHeight:I,bandWidth:L??0,bandHeight:w??0}},setFormattedCrosshairLabel=(r,e,i)=>{const{formatMethod:n,formatter:o}=i,{formatFunc:l,args:d}=getFormatFunction(n,o,r.text,{label:r.text,position:e});l?r.text=l(...d):r.defaultFormatter&&(r.text=r.defaultFormatter(r.text))},setRegionArea=(r,e)=>{e.forEach(({axis:i})=>{i.getRegions().forEach(n=>{r.x1=Math.min(r.x1,n.getLayoutStartPoint().x),r.y1=Math.min(r.y1,n.getLayoutStartPoint().y),r.x2=Math.max(r.x2,n.getLayoutStartPoint().x+n.getLayoutRect().width),r.y2=Math.max(r.y2,n.getLayoutStartPoint().y+n.getLayoutRect().height)})})},layoutVerticalCrosshair=(r,e,i,n)=>{const{x:o,topPos:l,height:d}=e,u=r.type;let f;if(u==="line")f={visible:!0,start:{x:o+i/2,y:l},end:{x:o+i/2,y:l+d}};else if(u==="rect"){const g=getRectSize(r,i,e.axis),{leftPos:_,rightPos:y}=e;f={visible:!0,start:{x:Math.max(o-g/2-n/2,_),y:l},end:{x:Math.min(o+i+g/2+n/2,y),y:l+d}}}return f},layoutHorizontalCrosshair=(r,e,i,n)=>{const{leftPos:o,width:l,y:d}=e,u=r.type;let f;if(u==="line")f={visible:!0,start:{x:o,y:d+i/2},end:{x:o+l,y:d+i/2}};else if(u==="rect"){const g=getRectSize(r,i,e.axis),{topPos:_,bottomPos:y}=e;f={visible:!0,start:{x:o,y:Math.max(d-g/2-n/2,_)},end:{x:o+l,y:Math.min(d+i+g/2+n/2,y)}}}return f},getRectSize=(r,e,i)=>{var n,o,l;let d=0;if(!((n=r.style)===null||n===void 0)&&n.sizePercent)d=(r.style.sizePercent-1)*e;else if(typeof((o=r.style)===null||o===void 0?void 0:o.size)=="number")d=r.style.size-e;else if(typeof((l=r.style)===null||l===void 0?void 0:l.size)=="function"){const u=i.getLayoutRect();d=r.style.size(u,i)-e}return d};class CartesianCrossHair extends BaseCrossHair{static getSpecInfo(e){return getSpecInfo(e,this.specKey,this.type,i=>i.xField&&i.xField.visible!==!1||i.yField&&i.yField.visible!==!1)}constructor(e,i){super(e,i),this.type=ComponentTypeEnum.cartesianCrosshair,this.name=ComponentTypeEnum.cartesianCrosshair,this._currValueX=new Map,this._currValueY=new Map}_showDefaultCrosshairBySpec(){const{xField:e,yField:i}=this._spec;if(e!=null&&e.visible&&e.defaultSelect){const{axisIndex:n,datum:o}=e.defaultSelect;this._defaultCrosshair(n,o,1)}if(i!=null&&i.visible&&i.defaultSelect){const{axisIndex:n,datum:o}=i.defaultSelect;this._defaultCrosshair(n,o,2)}}_defaultCrosshair(e,i,n){const o=this._option.getComponentsByKey("axes").find(l=>l.getSpecIndex()===e);o&&(n===1?(this._currValueX.clear(),this._currValueX.set(e,{axis:o,value:i})):(this._currValueY.clear(),this._currValueY.set(e,{axis:o,value:i})),this.layoutByValue(n))}_findAllAxisContains(e,i){const n=this._getAxisInfoByField("x"),o=this._getAxisInfoByField("y");return{xAxisMap:this._filterAxisByPoint(n,e,i),yAxisMap:this._filterAxisByPoint(o,e,i)}}_getValueAt(e,i){return e.getScale().invert(i)}clearAxisValue(){this._currValueX.clear(),this._currValueY.clear()}setAxisValue(e,i){isXAxis(i.getOrient())?this._currValueX.set(i.getSpecIndex(),{value:e,axis:i}):this._currValueY.set(i.getSpecIndex(),{value:e,axis:i})}_getAllAxisValues(e,i,n,o){let l=!1;return e.forEach(d=>{isDiscrete(d.axis.getScale().type)&&(l?this.enable=!1:l=!0)}),!!this.enable&&(e.forEach((d,u)=>{const f=d.axis;n.set(u,{value:this._getValueAt(f,i-(o?f.getLayoutStartPoint().x-this.getLayoutStartPoint().x:f.getLayoutStartPoint().y-this.getLayoutStartPoint().y)),axis:f})}),!0)}_layoutCrosshair(e,i,n,o){var l;let d=e,u=i;if(n&&n.length){if(o==="dimension"){const _=n[0],y=_.data.findIndex(S=>S.datum.length>0);let b;if(y>-1){const S=_.data[y];b=S.series.dataToPosition(S.datum[0])}(isValid(_.dimType)?_.dimType==="y":isYAxis((l=_==null?void 0:_.axis)===null||l===void 0?void 0:l.getOrient()))?u=b==null?void 0:b.y:d=b==null?void 0:b.x}else if(o==="mark"){const _=n[0],y=_.series.dataToPosition(_.datum[0]);d=y==null?void 0:y.x,u=y==null?void 0:y.y}}const{xAxisMap:f,yAxisMap:g}=this._findAllAxisContains(d,u);if(f&&f.size===0||g&&g.size===0){if(this.enableRemain)return;this.hide()}else this._currValueX.clear(),this._currValueY.clear(),f&&f.size&&this._getAllAxisValues(f,d,this._currValueX,!0),g&&g.size&&this._getAllAxisValues(g,u,this._currValueY,!1),this.layoutByValue(3)}hide(){this._xCrosshair&&this._xCrosshair.hideAll(),this._xTopLabel&&this._xTopLabel.hideAll(),this._xBottomLabel&&this._xBottomLabel.hideAll(),this._yCrosshair&&this._yCrosshair.hideAll(),this._yLeftLabel&&this._yLeftLabel.hideAll(),this._yRightLabel&&this._yRightLabel.hideAll()}layoutByValue(e=3){if(!this.enable)return;const i=getFirstSeries(this._regions,"cartesian");if(!i)return;const{x:n,y:o,offsetWidth:l,offsetHeight:d,bandWidth:u,bandHeight:f}=layoutByValue$1(e,i,this.getLayoutStartPoint(),this._currValueX,this._currValueY,this._xHair,this._yHair,this.enableRemain,this._cacheXCrossHairInfo,this._cacheYCrossHairInfo);this.enableRemain&&(n&&(this._cacheXCrossHairInfo=Object.assign(Object.assign({},n),{_isCache:!0})),o&&(this._cacheYCrossHairInfo=Object.assign(Object.assign({},o),{_isCache:!0}))),n&&this._layoutVertical(n,u,l),o&&this._layoutHorizontal(o,f,d)}_layoutVertical(e,i,n){var o,l;if(e._isCache&&this.enableRemain||!this._xHair)return;const{x:d,topPos:u,height:f,top:g,bottom:_,visible:y}=e;if(y){const b=this._xHair.type,S=layoutVerticalCrosshair(this._xHair,e,i,n);if(this._updateCrosshair("x",b,S),g.visible){const v=Object.assign(Object.assign(Object.assign({x:d+i/2,y:u},g),this._xHair.label),{textStyle:Object.assign(Object.assign({},(o=this._xHair.label)===null||o===void 0?void 0:o.textStyle),{textAlign:"center",textBaseline:"bottom"}),zIndex:this.labelZIndex,visible:!0});this._updateCrosshairLabel(this._xTopLabel,v,A=>{A.name="crosshair-x-top-label",this._xTopLabel=A})}else this._xTopLabel&&this._xTopLabel.hideAll();if(_.visible){const v=Object.assign(Object.assign(Object.assign({x:d+i/2,y:u+f},_),this._xHair.label),{textStyle:Object.assign(Object.assign({},(l=this._xHair.label)===null||l===void 0?void 0:l.textStyle),{textAlign:"center",textBaseline:"top"}),zIndex:this.labelZIndex,visible:!0});this._updateCrosshairLabel(this._xBottomLabel,v,A=>{A.name="crosshair-x-bottom-label",this._xBottomLabel=A})}else this._xBottomLabel&&this._xBottomLabel.hideAll()}}_layoutHorizontal(e,i,n){var o,l;if(e._isCache&&this.enableRemain||!this._yHair)return;const{leftPos:d,width:u,y:f,left:g,right:_,visible:y}=e;if(y){const b=this._yHair.type,S=layoutHorizontalCrosshair(this._yHair,e,i,n);if(this._updateCrosshair("y",b,S),g.visible){const v=Object.assign(Object.assign(Object.assign({x:d,y:f+i/2},g),this._yHair.label),{textStyle:Object.assign(Object.assign({},(o=this._yHair.label)===null||o===void 0?void 0:o.textStyle),{textAlign:"right",textBaseline:"middle"}),zIndex:this.labelZIndex});this._updateCrosshairLabel(this._yLeftLabel,v,A=>{A.name="crosshair-y-left-label",this._yLeftLabel=A})}else this._yLeftLabel&&this._yLeftLabel.hideAll();if(_.visible){const v=Object.assign(Object.assign(Object.assign({x:d+u,y:f+i},_),this._yHair.label),{textStyle:Object.assign(Object.assign({},(l=this._yHair.label)===null||l===void 0?void 0:l.textStyle),{textAlign:"left",textBaseline:"middle"}),zIndex:this.labelZIndex});this._updateCrosshairLabel(this._yRightLabel,v,A=>{A.name="crosshair-y-right-label",this._yRightLabel=A})}else this._yRightLabel&&this._yRightLabel.hideAll()}}_parseFieldInfo(){const{xField:e,yField:i}=this._spec;this._parseAndSetCrosshair(e,"x"),this._parseAndSetCrosshair(i,"y")}_parseAndSetCrosshair(e,i){const n=`_${i}Hair`,o=`_${i}Crosshair`;if(e&&e.visible){if(this[n]=this._parseField(e,`${i}Field`),this[o]){const{style:l,type:d}=this[n],u=d==="rect"?"rectStyle":"lineStyle";this[o].setAttributes({[u]:l})}}else this[o]&&this[o].parent&&this[o].parent.removeChild(this[o])}_updateCrosshair(e,i,n){const o=this.getContainer();let l;if(l=e==="x"?this._xCrosshair:this._yCrosshair,l)l.setAttributes(n);else{const d=e==="x"?this._xHair.style:this._yHair.style;i==="line"?l=new LineCrosshair(Object.assign(Object.assign({},n),{lineStyle:d,zIndex:this.gridZIndex+1,disableTriggerEvent:this._option.disableTriggerEvent,pickable:!1})):i==="rect"&&(l=new RectCrosshair(Object.assign(Object.assign({},n),{rectStyle:d,zIndex:this.gridZIndex,disableTriggerEvent:this._option.disableTriggerEvent,pickable:!1}))),o==null||o.add(l),e==="x"?this._xCrosshair=l:this._yCrosshair=l}}_updateCrosshairLabel(e,i,n){const o=this.getContainer();e?e.setAttributes(i):(n(e=new Tag(i)),o==null||o.add(e)),limitTagInBounds(e,this._getLimitBounds())}_getNeedClearVRenderComponents(){return[this._xCrosshair,this._xTopLabel,this._xBottomLabel,this._yCrosshair,this._yLeftLabel,this._yRightLabel]}}CartesianCrossHair.specKey="crosshair",CartesianCrossHair.type=ComponentTypeEnum.cartesianCrosshair;const registerCartesianCrossHair=()=>{Factory$1.registerComponent(CartesianCrossHair.type,CartesianCrossHair)};var __rest$4=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};const layoutByValue=(r,e,i,n,o,l=!1,d,u)=>{let f={x:0,y:0,center:{x:0,y:0},radius:0,distance:0,startAngle:0,endAngle:0,innerRadius:0,visible:!1,label:{visible:!1,text:"",offset:0}},g={x:0,y:0,center:{x:0,y:0},radius:0,distance:0,startAngle:0,endAngle:0,innerRadius:0,visible:!1,sides:r.angleAxisHelper.getScale(0).domain().length,label:{visible:!1,text:"",offset:0}};if(n){f.visible=!!e.size;const _=r.angleAxisHelper.getBandwidth(0);e.forEach(y=>{var b,{axis:S,value:v,coord:A}=y,x=__rest$4(y,["axis","value","coord"]);v=v??"",mergeSpec(f,x);const T=r.angleAxisHelper.dataToPosition([v]);f.angle=T;const C=S.niceLabelFormatter;!((b=n.label)===null||b===void 0)&&b.visible&&(f.label.visible=!0,f.label.defaultFormatter=C,f.label.text=v,f.label.offset=getAxisLabelOffset(S.getSpec())),f.startAngle=T-_/2,f.endAngle=T+_/2})}if(o&&(g.visible=!!i.size,i.forEach(_=>{var y,{axis:b,value:S,coord:v}=_,A=__rest$4(_,["axis","value","coord"]);S=S??"";const x=b.niceLabelFormatter;!((y=o.label)===null||y===void 0)&&y.visible&&(g.label.visible=!0,g.label.defaultFormatter=x,g.label.text=S,g.label.offset=getAxisLabelOffset(b.getSpec())),g.angle=v.angle,g.axis=b,mergeSpec(g,A)})),l&&!f.visible&&isValid(d))f=d;else if(f.label.visible&&n&&n.label){const{label:_}=f,{formatMethod:y,formatter:b}=n.label,{formatFunc:S,args:v}=getFormatFunction(y,b,_.text,{label:_.text,orient:"angle"});S?_.text=S(...v):_.defaultFormatter&&(_.text=_.defaultFormatter(_.text))}if(l&&!g.visible&&isValid(u))g=u;else if(g.label.visible&&o&&o.label){const{label:_}=g,{formatMethod:y,formatter:b}=o.label,{formatFunc:S,args:v}=getFormatFunction(y,b,_.text,{label:_.text,orient:"radius"});S?_.text=S(...v):_.defaultFormatter&&(_.text=_.defaultFormatter(_.text))}return{angle:f,radius:g}},layoutAngleCrosshair=(r,e)=>{const{angle:i,innerRadius:n,radius:o,startAngle:l,endAngle:d,center:u}=e;let f;return f=(r.type==="rect"?"sector":"line")=="sector"?{center:u,innerRadius:n,radius:o,startAngle:l,endAngle:d}:{start:polarToCartesian(u,n,i),end:polarToCartesian(u,o,i)},f},layoutRadiusCrosshair=(r,e)=>{const{center:i,startAngle:n,endAngle:o,distance:l,sides:d,axis:u,point:f,radius:g,innerRadius:_}=e;let y=l;if((r.smooth?"circle":"polygon")=="polygon"){const b=u.getCenter(),S=getAngleByPoint(b,f),v=(o-n)/d,A=Math.floor((S-n)/v),x=A*v+n,T=Math.min((A+1)*v+n,o),C=polarToCartesian(b,l,x),E=polarToCartesian(b,l,T),P=getIntersectPoint([E.x,E.y],[C.x,C.y],[b.x,b.y],[f.x,f.y]);P&&(y=clamp(PointService.distancePN(f,P[0],P[1])+l,_,g))}return{center:i,startAngle:n,endAngle:o,radius:y,sides:d}};class PolarCrossHair extends BaseCrossHair{static getSpecInfo(e){return getSpecInfo(e,this.specKey,this.type,i=>i.categoryField&&i.categoryField.visible!==!1||i.valueField&&i.valueField.visible!==!1)}constructor(e,i){super(e,i),this.type=ComponentTypeEnum.polarCrosshair,this.name=ComponentTypeEnum.polarCrosshair,this._currValueAngle=new Map,this._currValueRadius=new Map}_showDefaultCrosshairBySpec(){const{categoryField:e,valueField:i}=this._spec;if(e!=null&&e.visible&&e.defaultSelect){const{axisIndex:n,datum:o}=e.defaultSelect;this._defaultCrosshair(n,o,1)}if(i!=null&&i.visible&&i.defaultSelect){const{axisIndex:n,datum:o}=i.defaultSelect;this._defaultCrosshair(n,o,2)}}_defaultCrosshair(e,i,n){const o=this._option.getComponentsByKey("axes").find(l=>l.getSpecIndex()===e);if(o){if(n===1){this._currValueAngle.clear();const l={angle:o.valueToPosition(i),radius:o.getOuterRadius()},d=o.coordToPoint(l);this._currValueAngle.set(e,this._getValueByAxis(o,d))}else{this._currValueRadius.clear();const l={angle:o.startAngle,radius:o.valueToPosition(i)},d=o.coordToPoint(l);this._currValueRadius.set(e,this._getValueByAxis(o,d))}this.layoutByValue(3)}}hide(){this._radiusCrosshair&&this._radiusCrosshair.hideAll(),this._radiusLabelCrosshair&&this._radiusLabelCrosshair.hideAll(),this._angleCrosshair&&this._angleCrosshair.hideAll(),this._angleLabelCrosshair&&this._angleLabelCrosshair.hideAll()}_findAllAxisContains(e,i){const n=this._getAxisInfoByField("category"),o=this._getAxisInfoByField("value");return{angleAxisMap:this._filterAxisByPoint(n,e,i),radiusAxisMap:this._filterAxisByPoint(o,e,i)}}_getAllAxisValues(e,i,n){let o=!1;return e.forEach(l=>{isDiscrete(l.axis.getScale().type)&&(o?this.enable=!1:o=!0)}),!!this.enable&&(e.forEach((l,d)=>{const u=l.axis;n.set(d,this._getValueByAxis(u,i))}),!0)}_getValueByAxis(e,i){const{x:n,y:o}=e.getLayoutStartPoint(),{x:l,y:d}=this.getLayoutStartPoint(),u=e.positionToData({x:i.x-(n-l),y:i.y-(o-d)}),f={x:e.getCenter().x+this.getLayoutStartPoint().x,y:e.getCenter().y+this.getLayoutStartPoint().y};return{value:u,axis:e,center:f,innerRadius:e.getInnerRadius(),radius:e.getOuterRadius(),startAngle:e.startAngle,endAngle:e.endAngle,distance:PointService.distancePP(i,e.getCenter()),coord:e.pointToCoord(i),point:i}}_layoutCrosshair(e,i,n,o){let l=e,d=i;if(n&&n.length){if(o==="dimension"){const g=n[0];if(g.axis){const _=g.axis.pointToCoord({x:l,y:d}),y=g.axis.getOrient()==="radius"?{radius:g.position,angle:_.angle}:{radius:_.radius,angle:g.position},b=g.axis.coordToPoint(y);l=b.x,d=b.y}}else if(o==="mark"){const g=n[0],_=g.series.dataToPosition(g.datum[0]);l=_.x,d=_.y}}const{angleAxisMap:u,radiusAxisMap:f}=this._findAllAxisContains(l,d);if(u.size!==0||f.size!==0)this._currValueAngle.clear(),this._currValueRadius.clear(),u&&this._getAllAxisValues(u,{x:l,y:d},this._currValueAngle),f&&this._getAllAxisValues(f,{x:l,y:d},this._currValueRadius),this.layoutByValue(3);else{if(this.enableRemain)return;this.hide()}}layoutByValue(e=3){if(!this.enable)return;const i=getFirstSeries(this._regions,"polar");if(!i)return;const{angle:n,radius:o}=layoutByValue(i,this._currValueAngle,this._currValueRadius,this._angleHair,this._radiusHair,this.enableRemain,this._cacheAngleCrossHairInfo,this._cacheRadiusCrossHairInfo);this.enableRemain&&(this._cacheAngleCrossHairInfo=Object.assign(Object.assign({},n),{_isCache:!0}),this._cacheRadiusCrossHairInfo=Object.assign(Object.assign({},o),{_isCache:!0})),e&&(this._layoutRadius(o),this._layoutAngle(n))}_layoutAngle(e){var i;if(e._isCache&&this.enableRemain)return;const n=this.getContainer(),{angle:o,radius:l,label:d,center:u,visible:f}=e;if(f){const g=this._angleHair.type==="rect"?"sector":"line",_=layoutAngleCrosshair(this._angleHair,e);if(this._angleCrosshair)this._angleCrosshair.setAttributes(_);else{let y;g==="line"?y=new LineCrosshair(Object.assign(Object.assign({},_),{lineStyle:this._angleHair.style,zIndex:this.gridZIndex,pickable:!1})):g==="sector"&&(y=new SectorCrosshair(Object.assign(Object.assign({},_),{sectorStyle:this._angleHair.style,zIndex:this.gridZIndex,pickable:!1}))),this._angleCrosshair=y,n.add(y)}if(d.visible){const y=angleLabelOrientAttribute(o),b=Object.assign(Object.assign(Object.assign(Object.assign({},polarToCartesian(u,l+d.offset,o)),this._angleHair.label),d),{textStyle:Object.assign(Object.assign({},(i=this._angleHair.label)===null||i===void 0?void 0:i.textStyle),{textAlign:y.align,textBaseline:y.baseline}),zIndex:this.labelZIndex});this._updateCrosshairLabel(this._angleLabelCrosshair,b,S=>{S.name="crosshair-angle-label",this._angleLabelCrosshair=S})}else this._angleLabelCrosshair&&this._angleLabelCrosshair.hideAll()}}_layoutRadius(e){var i;if(e._isCache&&this.enableRemain)return;const{center:n,startAngle:o,label:l,visible:d}=e,u=this.getContainer();if(d){const f=this._radiusHair.smooth?"circle":"polygon",g=layoutRadiusCrosshair(this._radiusHair,e),_=g.radius;if(this._radiusCrosshair)this._radiusCrosshair.setAttributes(g);else{let y;y=f==="polygon"?new PolygonCrosshair(Object.assign(Object.assign({},g),{lineStyle:this._radiusHair.style,zIndex:this.gridZIndex+1})):new CircleCrosshair(Object.assign(Object.assign({},g),{lineStyle:this._radiusHair.style,zIndex:this.gridZIndex})),this._radiusCrosshair=y,u.add(y)}if(l.visible){const y=radiusLabelOrientAttribute(o),b=Object.assign(Object.assign(Object.assign(Object.assign({},polarToCartesian(n,_,o)),this._radiusHair.label),l),{textStyle:Object.assign(Object.assign({},(i=this._radiusHair.label)===null||i===void 0?void 0:i.textStyle),{textAlign:y.align,textBaseline:y.baseline}),zIndex:this.labelZIndex});this._updateCrosshairLabel(this._radiusLabelCrosshair,b,S=>{S.name="crosshair-radius-label",this._radiusLabelCrosshair=S})}else this._radiusLabelCrosshair&&this._radiusLabelCrosshair.hideAll()}}_parseFieldInfo(){var e;const{categoryField:i,valueField:n}=this._spec;i&&i.visible&&(this._angleHair=this._parseField(i,"categoryField")),n&&n.visible&&(this._radiusHair=this._parseField(n,"valueField"),this._radiusHair.smooth=(e=n==null?void 0:n.line)===null||e===void 0?void 0:e.smooth)}_updateCrosshairLabel(e,i,n){const o=this.getContainer();e?e.setAttributes(i):(e=new Tag(i),o==null||o.add(e),n(e)),limitTagInBounds(e,this._getLimitBounds())}_getNeedClearVRenderComponents(){return[this._radiusCrosshair,this._radiusLabelCrosshair,this._angleCrosshair,this._angleLabelCrosshair]}}PolarCrossHair.specKey="crosshair",PolarCrossHair.type=ComponentTypeEnum.polarCrosshair;const registerPolarCrossHair=()=>{Factory$1.registerComponent(PolarCrossHair.type,PolarCrossHair)},lockStatisticsFilter=(r,e)=>{const{getNewDomain:i,isContinuous:n,field:o,originalFields:l}=e,d=o(),u=i();if(isNil(u)||isNil(d))return r;const f=l(),g=isArray(d)?d[0]:d;return r[g]&&f&&f[g]&&f[g].lockStatisticsByDomain&&!n()&&(r[g].values=u),r},dataFilterWithNewDomain=(r,e)=>{const{getNewDomain:i,isContinuous:n,field:o}=e,l=o(),d=i();if(isNil(d)||isNil(l))return r;if(d.length===0)return[];const u={};d.forEach(g=>{u[g]||(u[g]=1)});let f=null;return f=n()?g=>{let _=!1;return array(l).every(y=>{g[y]>=d[0]&&g[y]<=last(d)&&(_=!0)}),_}:g=>{let _=!1;return array(l).every(y=>{(u[g[y]+""]||u[g[y]])&&(_=!0)}),_},r.filter(f)},dataFilterComputeDomain=(r,e)=>{const{stateFields:i,valueFields:n,dataCollection:o}=e.input,{stateField:l,valueField:d}=e.output,u={},f=[];return o.forEach((g,_)=>{var y;if(isNil(i[_]))return;const b=(y=g.getFields())===null||y===void 0?void 0:y[i[_]];b&&b.lockStatisticsByDomain&&b.domain.forEach(S=>{u[S]=0}),g.latestData.forEach(S=>{array(i[_]).forEach(v=>{isNil(S[v])||(isNil(u[S[v]])&&(u[S[v]]=0),isNil(n[_])||(u[S[v]]+=isNaN(parseFloat(S[n[_]]))?1:parseFloat(S[n[_]])))})})}),Object.keys(u).forEach((g,_)=>{const y={[l]:g};d&&(y[d]=u[g]),f.push(y)}),f};class DataFilterBaseComponent extends BaseComponent{get relatedAxisComponent(){return this._relatedAxisComponent}setStartAndEnd(e,i,n=["percent","percent"]){const[o="percent",l="percent"]=n,d=o==="percent"?e:this.dataToStatePoint(e),u=l==="percent"?i:this.dataToStatePoint(i);this._handleChange(d,u,!0)}enableInteraction(){this._activeRoam=!0}disableInteraction(){this._activeRoam=!1}zoomIn(e){this._handleChartZoom({zoomDelta:1.2,zoomX:e==null?void 0:e.x,zoomY:e==null?void 0:e.y})}zoomOut(e){this._handleChartZoom({zoomDelta:.8,zoomX:e==null?void 0:e.x,zoomY:e==null?void 0:e.y})}_handleChange(e,i,n){var o,l;(l=(o=this._spec)===null||o===void 0?void 0:o.zoomLock)!==null&&l!==void 0&&l||i-e!==this._spanCache&&(i-e<this._minSpan||i-e>this._maxSpan)?this._shouldChange=!1:(this._shouldChange=!0,this._spanCache=i-e)}_isReverse(){const e=this._relatedAxisComponent;if(!e)return!1;const i=e.getScale();return i.range()[0]>i.range()[1]&&(!e.getInverse()||this._isHorizontal)}_updateRangeFactor(e){const i=this._relatedAxisComponent.getScale(),n=this._isReverse(),o=n?[1-this._end,1-this._start]:[this._start,this._end];if(n)switch(e){case"startHandler":i.rangeFactorEnd(o[1]);break;case"endHandler":i.rangeFactorStart(o[0]);break;default:i.rangeFactorStart(o[0],!0),i.rangeFactorEnd(o[1])}else switch(e){case"startHandler":i.rangeFactorStart(o[0]);break;case"endHandler":i.rangeFactorEnd(o[1]);break;default:i.rangeFactorEnd(o[1],!0),i.rangeFactorStart(o[0])}const l=i.rangeFactor();l?(this._start=n?1-l[1]:l[0],this._end=n?1-l[0]:l[1]):(this._start=0,this._end=1)}get visible(){return this._visible}constructor(e,i){super(e,i),this.layoutType="none",this._orient="left",this._cacheVisibility=void 0,this._dataUpdating=!1,this._shouldChange=!0,this._stateField="x",this._activeRoam=!0,this._zoomAttr={enable:!0,rate:1,focus:!0},this._dragAttr={enable:!0,rate:1,reverse:!0},this._scrollAttr={enable:!0,rate:1,reverse:!0},this.effect={onZoomChange:n=>{var o,l;const d=this._relatedAxisComponent;if(d&&this._filterMode==="axis"){const u=d.getScale(),f=d.getSpec();this._auto&&this._getAxisBandSize(f)&&this._spec.ignoreBandSize&&(u.bandwidth("auto"),u.maxBandwidth("auto"),u.minBandwidth("auto")),this._updateRangeFactor(n),this._auto&&((l=(o=this._component)===null||o===void 0?void 0:o.setStartAndEnd)===null||l===void 0||l.call(o,this._start,this._end)),d.effect.scaleUpdate({value:"force"})}else eachSeries(this._regions,u=>{var f;(f=u.getViewData())===null||f===void 0||f.markRunning()},{userId:this._seriesUserId,specIndex:this._seriesIndex}),eachSeries(this._regions,u=>{u.reFilterViewData()},{userId:this._seriesUserId,specIndex:this._seriesIndex})}},this._visible=!0,this._handleStateChange=(n,o,l)=>{var d,u;return this._startValue=n,this._endValue=o,this._newDomain=this._parseDomainFromState(this._startValue,this._endValue),(u=(d=this.effect).onZoomChange)===null||u===void 0||u.call(d,l),!0},this._handleChartZoom=n=>{var o,l;if(!this._activeRoam)return;const{zoomDelta:d,zoomX:u,zoomY:f}=n,{x:g,y:_}=this._regions[0].getLayoutStartPoint(),{width:y,height:b}=this._regions[0].getLayoutRect(),S=Math.abs(this._start-this._end),v=(l=(o=this._spec.roamZoom)===null||o===void 0?void 0:o.rate)!==null&&l!==void 0?l:1;if(S>=1&&d<1||S<=.01&&d>1)return;const A=this._isHorizontal?u:f,x=S*(d-1)*v;let T=x/2,C=x/2;if(A){const R=this._isHorizontal?g:_,L=this._isHorizontal?y:b;T=Math.abs(R-A)/Math.abs(L-R)*x,C=Math.abs(L-A)/Math.abs(L-R)*x}const E=clamp(this._start+T,0,1),P=clamp(this._end-C,0,1);this._handleChange(Math.min(E,P),Math.max(E,P),!0)},this._handleChartScroll=(n,o)=>{var l;if(!this._activeRoam)return!1;const{scrollX:d,scrollY:u}=n;let f=this._isHorizontal?d:u;const g=this._isHorizontal?abs$1(d/u)>=.5:abs$1(u/d)>=.5;this._scrollAttr.reverse||(f=-f),g&&this._handleChartMove(f,(l=this._scrollAttr.rate)!==null&&l!==void 0?l:1);const _=this._start!==0&&this._end!==1;return g&&_},this._handleChartDrag=(n,o)=>{var l;if(!this._activeRoam)return;const[d,u]=n;let f=this._isHorizontal?d:u;this._dragAttr.reverse&&(f=-f),this._handleChartMove(f,(l=this._dragAttr.rate)!==null&&l!==void 0?l:1)},this._handleChartMove=(n,o)=>{const l=this._isHorizontal?this.getLayoutRect().width:this.getLayoutRect().height;if(Math.abs(n)>=1e-6){if(n>0&&this._end<1){const d=Math.min(1-this._end,n/l)*o;this._handleChange(this._start+d,this._end+d,!0)}else if(n<0&&this._start>0){const d=Math.max(-this._start,n/l)*o;this._handleChange(this._start+d,this._end+d,!0)}}return!1},this._orient=getOrient(e),this._isHorizontal=getDirectionByOrient(this._orient)==="horizontal"}created(){super.created(),this._setAxisFromSpec(),this._setRegionsFromSpec(),this._initEvent(),this._initData(),this._initStateScale(),this._setStateFromSpec()}initLayout(){super.initLayout(),this._layout&&(this._layout.layoutOrient=this._orient)}_setAxisFromSpec(){if(isValid(this._spec.axisId)?this._relatedAxisComponent=this._option.getComponentByUserId(this._spec.axisId):isValid(this._spec.axisIndex)&&(this._relatedAxisComponent=this._option.getComponentByIndex("axes",this._spec.axisIndex)),isNil(this._spec.field)&&!this._relatedAxisComponent){const e=this._option.getComponentsByKey("axes"),i=e.find(n=>n._orient===this._orient);if(i)this._relatedAxisComponent=i;else{const n=e.find(o=>!isContinuous(o.getScale().type));this._relatedAxisComponent=n}}this._relatedAxisComponent&&this._filterMode==="axis"&&(this._relatedAxisComponent.autoIndentOnce=!0)}_setRegionsFromSpec(){var e,i;this._regions=this._relatedAxisComponent?this._relatedAxisComponent.getRegions():this._option.getAllRegions();const n=this._relatedAxisComponent?(i=(e=this._relatedAxisComponent).getBindSeriesFilter)===null||i===void 0?void 0:i.call(e):null;if(isValid(n)&&(isValid(n.userId)&&(this._seriesUserId=array(n.userId)),isValid(n.specIndex)&&(this._seriesIndex=array(n.specIndex))),isValid(this._spec.seriesId)){const o=array(this._spec.seriesId);this._seriesUserId?this._seriesUserId=this._seriesUserId.filter(l=>o.includes(l)):this._seriesUserId=o}if(isValid(this._spec.seriesIndex)){const o=array(this._spec.seriesIndex);this._seriesIndex?this._seriesIndex=this._seriesIndex.filter(l=>o.includes(l)):this._seriesIndex=o}if(isValid(this._spec.regionIndex)){const o=this._option.getRegionsInIndex(array(this._spec.regionIndex));this._regions=this._regions.filter(l=>o.includes(l))}else if(isValid(this._spec.regionId)){const o=array(this._spec.regionId);this._regions=o.length?this._regions.filter(l=>o.includes(l.id)):[]}}onDataUpdate(){var e;const i=this._computeDomainOfStateScale(isContinuous(this._stateScale.type));this._stateScale.domain(i,!1),this._handleChange(this._start,this._end,!0),this._spec.auto&&!isEqual(this._domainCache,i)&&(this._domainCache=i,this._dataUpdating=!0,(e=this.getChart())===null||e===void 0||e.setLayoutTag(!0,null,!1))}_computeDomainOfStateScale(e){if(this._spec.customDomain)return this._spec.customDomain;const i=this._data.getLatestData().map(n=>n[this._stateField]);if(e){const n=i.map(o=>1*o);return i.length?[minInArray(n),maxInArray(n)]:[-1/0,1/0]}return i}_initEvent(){this._initCommonEvent()}_initData(){const e=[],i=[],n=[];if(this._relatedAxisComponent){const d={};eachSeries(this._regions,u=>{var f,g;const _=u.coordinate==="cartesian"?u.getXAxisHelper():u.coordinate==="polar"?u.angleAxisHelper:null,y=u.coordinate==="cartesian"?u.getYAxisHelper():u.coordinate==="polar"?u.radiusAxisHelper:null;if(!_||!y)return;const b=_.getAxisId()===this._relatedAxisComponent.id?_:y.getAxisId()===this._relatedAxisComponent.id?y:this._isHorizontal?_:y,S=b===_?y:_,v=isContinuous(S.getScale(0).type),A=isContinuous(b.getScale(0).type);e.push(u.getRawData());const x=u.getSpec(),T=u.coordinate==="cartesian"?array(x.xField):array((f=x.angleField)!==null&&f!==void 0?f:x.categoryField),C=u.coordinate==="cartesian"?array(x.yField):array((g=x.radiusField)!==null&&g!==void 0?g:x.valueField);if(d[u.id]=u.type==="link"?["from_xField"]:b===_?T:C,A?i.push(d[u.id]):i.push(d[u.id][0]),this._valueField){const E=u.type==="link"?["from_yField"]:S===_?T:C;v&&n.push(...E)}},{userId:this._seriesUserId,specIndex:this._seriesIndex}),this._originalStateFields=d}else eachSeries(this._regions,d=>{e.push(d.getRawData()),i.push(this._field),this._valueField&&n.push(this._spec.valueField)},{userId:this._seriesUserId,specIndex:this._seriesIndex});const{dataSet:o}=this._option;registerDataSetInstanceParser(o,"dataview",dataViewParser),registerDataSetInstanceTransform(o,"dataFilterComputeDomain",dataFilterComputeDomain);const l=new DataView(o,{name:`${this.type}_${this.id}_data`});l.transform({type:"dataFilterComputeDomain",options:{input:{dataCollection:e,stateFields:i,valueFields:n},output:{stateField:this._stateField,valueField:this._valueField}}},!1),this._data=new CompilableData(this._option,l),l.reRunAllTransform(),o.multipleDataViewAddListener(e,"change",this._handleDataCollectionChange.bind(this))}setAttrFromSpec(){var e;super.setAttrFromSpec(),this._spec.roamZoom===!0||this._spec.roamZoom?this._zoomAttr=merge$1({},this._zoomAttr,this._spec.roamZoom):this._zoomAttr.enable=!1,this._spec.roamDrag===!0||this._spec.roamDrag?this._dragAttr=merge$1({},this._dragAttr,this._spec.roamDrag):this._dragAttr.enable=!1,this._spec.roamScroll===!0||this._spec.roamScroll?this._scrollAttr=merge$1({},this._scrollAttr,this._spec.roamScroll):this._scrollAttr.enable=!1,this._field=this._spec.field,this._width=this._computeWidth(),this._height=this._computeHeight(),this._visible=(e=this._spec.visible)===null||e===void 0||e}_statePointToData(e){const i=this._stateScale,n=i.domain();if(isContinuous(i.type))return this._isReverse()?n[0]+(last(n)-n[0])*(1-e):n[0]+(last(n)-n[0])*e;let o=i.range();this._isReverse()&&(o=o.slice().reverse());const l=o[0]+(last(o)-o[0])*e;return i.invert(l)}dataToStatePoint(e){const i=this._stateScale,n=i.scale(e);let o=i.range();return!this._isHorizontal&&isContinuous(i.type)&&(o=o.slice().reverse()),(n-o[0])/(last(o)-o[0])}_modeCheck(e,i){return e==="start"?i==="percent"&&isValid(this._spec.start)||i==="value"&&isValid(this._spec.startValue):i==="percent"&&isValid(this._spec.end)||i==="value"&&isValid(this._spec.endValue)}_setStateFromSpec(){var e,i;let n,o;if(this._auto=!!this._spec.auto,this._spec.rangeMode){const[l,d]=this._spec.rangeMode;this._modeCheck("start",l)&&this._modeCheck("end",d)&&(n=l==="percent"?this._spec.start:this.dataToStatePoint(this._spec.startValue),o=d==="percent"?this._spec.end:this.dataToStatePoint(this._spec.endValue))}else n=this._spec.start?this._spec.start:this._spec.startValue?this.dataToStatePoint(this._spec.startValue):0,o=this._spec.end?this._spec.end:this._spec.endValue?this.dataToStatePoint(this._spec.endValue):1;this._startValue=this._statePointToData(n),this._endValue=this._statePointToData(o),this._start=n,this._end=o,this._minSpan=(e=this._spec.minSpan)!==null&&e!==void 0?e:0,this._maxSpan=(i=this._spec.maxSpan)!==null&&i!==void 0?i:1,isContinuous(this._stateScale.type)&&this._stateScale.domain()[0]!==last(this._stateScale.domain())&&(this._spec.minValueSpan&&(this._minSpan=this._spec.minValueSpan/(last(this._stateScale.domain())-this._stateScale.domain()[0])),this._spec.maxValueSpan&&(this._maxSpan=this._spec.maxValueSpan/(last(this._stateScale.domain())-this._stateScale.domain()[0]))),this._minSpan=Math.max(0,this._minSpan),this._maxSpan=Math.min(this._maxSpan,1),this._relatedAxisComponent&&this._filterMode==="axis"||this._start===0&&this._end===1||(this._newDomain=this._parseDomainFromState(this._startValue,this._endValue))}_parseFieldOfSeries(e){var i;return(i=this._originalStateFields)===null||i===void 0?void 0:i[e.id]}_initStateScale(){const e=[0,1];if(this._relatedAxisComponent){const i=this._relatedAxisComponent.getScale(),n=isContinuous(i.type),o=this._computeDomainOfStateScale(n);if(this._stateScale=i.clone(),n){const l=o.map(d=>1*d);this._stateScale.domain(o.length?[minInArray(l),maxInArray(l)]:[0,1],!0).range(e)}else this._stateScale.domain(o,!0).range(e)}else this._stateScale=new BandScale,this._stateScale.domain(this._computeDomainOfStateScale(),!0).range(e)}init(e){super.init(e),this._addTransformToSeries(),this._start===0&&this._end===1||this.effect.onZoomChange()}_addTransformToSeries(){this._relatedAxisComponent&&this._filterMode==="axis"||(registerDataSetInstanceTransform(this._option.dataSet,"dataFilterWithNewDomain",dataFilterWithNewDomain),registerDataSetInstanceTransform(this._option.dataSet,"lockStatisticsFilter",lockStatisticsFilter),eachSeries(this._regions,e=>{e.getViewDataStatistics().transform({type:"lockStatisticsFilter",options:{originalFields:()=>e.getViewDataStatistics().getFields(),getNewDomain:()=>this._newDomain,field:()=>{var i;return(i=this._field)!==null&&i!==void 0?i:this._parseFieldOfSeries(e)},isContinuous:()=>isContinuous(this._stateScale.type)},level:1},!1),e.addViewDataFilter({type:"dataFilterWithNewDomain",options:{getNewDomain:()=>this._newDomain,field:()=>{var i;return(i=this._field)!==null&&i!==void 0?i:this._parseFieldOfSeries(e)},isContinuous:()=>isContinuous(this._stateScale.type)},level:TransformLevel.dataZoomFilter})},{userId:this._seriesUserId,specIndex:this._seriesIndex}))}onRender(e){}_compareSpec(e,i){const n=super._compareSpec(e,i);return n.reMake||isEqual(i,e)||(n.reRender=!0,n.reMake=!0),n}reInit(e){super.reInit(e),this._marks.forEach(i=>{i.getMarks().forEach(n=>{this.initMarkStyleWithSpec(n,this._spec[n.name])})})}changeRegions(){}update(e){}resize(e){}_parseDomainFromState(e,i){if(isContinuous(this._stateScale.type))return[Math.min(i,e),Math.max(i,e)];const n=this._stateScale.domain(),o=n.indexOf(e),l=n.indexOf(i);return n.slice(Math.min(o,l),Math.max(o,l)+1)}_initCommonEvent(){var e,i,n,o,l,d,u;const f={delayType:(i=(e=this._spec)===null||e===void 0?void 0:e.delayType)!==null&&i!==void 0?i:"throttle",delayTime:isValid((n=this._spec)===null||n===void 0?void 0:n.delayType)?(l=(o=this._spec)===null||o===void 0?void 0:o.delayTime)!==null&&l!==void 0?l:30:0,realTime:(u=(d=this._spec)===null||d===void 0?void 0:d.realTime)===null||u===void 0||u};this._zoomAttr.enable&&this.initZoomEventOfRegions(this._regions,null,this._handleChartZoom,f),this._scrollAttr.enable&&this.initScrollEventOfRegions(this._regions,null,this._handleChartScroll,f),this._dragAttr.enable&&this.initDragEventOfRegions(this._regions,null,this._handleChartDrag,f)}updateLayoutAttribute(){this._visible&&this._createOrUpdateComponent(),super.updateLayoutAttribute()}_autoVisible(e){if(!this._auto)return;e?this.show():this.hide();const i=this._isHorizontal?"height":"width";this.layout.setLayoutRect({[i]:e?this[`_${i}`]:0},{[i]:AttributeLevel.Built_In})}onLayoutStart(e,i,n){super.onLayoutStart(e,i,n);const o=this._autoUpdate(e);this._autoVisible(o),this._dataUpdating=!1}onLayoutEnd(e){const i=!(this._start===0&&this._end===1);this._autoVisible(i),super.onLayoutEnd(e)}getBoundsInRect(e){const i={x1:this.getLayoutStartPoint().x,y1:this.getLayoutStartPoint().y,x2:0,y2:0};return this._isHorizontal?(i.y2=i.y1+this._height,i.x2=i.x1+e.width):(i.x2=i.x1+this._width,i.y2=i.y1+e.height),i}hide(){var e;(e=this._component)===null||e===void 0||e.hideAll()}show(){var e;(e=this._component)===null||e===void 0||e.showAll()}_getAxisBandSize(e){const i=e==null?void 0:e.bandSize,n=e==null?void 0:e.maxBandSize,o=e==null?void 0:e.minBandSize;if(i||o||n)return{bandSize:i,maxBandSize:n,minBandSize:o}}_autoUpdate(e){var i,n,o,l,d,u;if(!this._auto)return this._cacheVisibility=void 0,!0;const f=this._relatedAxisComponent,g=f==null?void 0:f.getSpec(),_=f==null?void 0:f.getScale(),y=this._getAxisBandSize(g);if(!this._dataUpdating&&isDiscrete(_.type)&&(e==null?void 0:e.height)===((i=this._cacheRect)===null||i===void 0?void 0:i.height)&&(e==null?void 0:e.width)===((n=this._cacheRect)===null||n===void 0?void 0:n.width)&&this._fixedBandSize===(y==null?void 0:y.bandSize))return this._cacheVisibility;let b=!0;if(this._isHorizontal&&(e==null?void 0:e.width)!==((o=this._cacheRect)===null||o===void 0?void 0:o.width)?_.range(f.getInverse()?[e.width,0]:[0,e.width]):(e==null?void 0:e.height)!==((l=this._cacheRect)===null||l===void 0?void 0:l.height)&&_.range(f.getInverse()?[0,e.height]:[e.height,0]),this._cacheRect={width:e==null?void 0:e.width,height:e==null?void 0:e.height},this._fixedBandSize=y==null?void 0:y.bandSize,isDiscrete(_.type)){y&&(this._start||this._end)&&(this.type===ComponentTypeEnum.scrollBar&&(this._start=0,this._end=1),this._updateRangeFactor());const[S,v]=(d=_.rangeFactor())!==null&&d!==void 0?d:[];b=(!isNil(S)||!isNil(v))&&!(S===0&&v===1)}else{const[S,v]=(u=_.rangeFactor())!==null&&u!==void 0?u:[this._start,this._end];b=!(S===0&&v===1)}return this.setStartAndEnd(this._start,this._end),this._cacheVisibility=b,b}_getNeedClearVRenderComponents(){return[this._component]}}mixin(DataFilterBaseComponent,Zoomable);class DataZoomSpecTransformer extends BaseComponentSpecTransformer{_mergeThemeToSpec(e,i){const n=this._theme;let o=e;if(this._shouldMergeThemeToSpec()){const l=u=>{const f=mergeSpec({selectedBackgroundChart:{line:{},area:{}}},this._theme,u),{selectedBackgroundChart:g={}}=u,{line:_,area:y}=g;return _&&_.visible!==!1&&(f.selectedBackgroundChart.line.style=Object.assign(Object.assign({},f.selectedBackgroundChart.line.style),{visible:!0})),y&&y.visible!==!1&&(f.selectedBackgroundChart.area.style=Object.assign(Object.assign({},f.selectedBackgroundChart.area.style),{visible:!0})),f},d=e;o=isArray(d)?d.map(u=>l(u)):l(d)}return this._adjustPadding(o),{spec:o,theme:n}}}class DataZoom extends DataFilterBaseComponent{constructor(e,i){var n;super(e,i),this.type=ComponentTypeEnum.dataZoom,this.name=ComponentTypeEnum.dataZoom,this.transformerConstructor=DataZoomSpecTransformer,this.specKey="dataZoom",this.layoutZIndex=LayoutZIndex.DataZoom,this.layoutLevel=LayoutLevel.DataZoom,this.layoutType="region-relative",this._isReverseCache=!1,this._dataToPositionX=o=>{const l=this._orient==="left"?this._middleHandlerSize:0,d=this._isHorizontal?this._startHandlerSize/2:0,u=this._isHorizontal?this._stateScale:this._valueScale,f=this._isHorizontal?this._stateField:this._valueField;return u.scale(o[f])+this.getLayoutStartPoint().x+l+d},this._dataToPositionX2=o=>{const l=this._orient==="left"?this._middleHandlerSize:0,d=this._isHorizontal?this._startHandlerSize/2:0,u=this._isHorizontal?this._stateScale:this._valueScale,f=u.domain()[0];return u.scale(f)+this.getLayoutStartPoint().x+l+d},this._dataToPositionY=o=>{const l=this._isHorizontal?this._middleHandlerSize:0,d=this._isHorizontal?0:this._startHandlerSize/2,u=this._isHorizontal?this._valueScale:this._stateScale,f=this._isHorizontal?this._valueField:this._stateField;return u.scale(o[f])+this.getLayoutStartPoint().y+l+d},this._dataToPositionY2=o=>{const l=this._isHorizontal?this._middleHandlerSize:0,d=this._isHorizontal?0:this._startHandlerSize/2,u=this._isHorizontal?this._valueScale:this._stateScale,f=u.domain()[0];return u.scale(f)+this.getLayoutStartPoint().y+l+d},this._valueField="y",this._filterMode=(n=e.filterMode)!==null&&n!==void 0?n:"filter"}created(){super.created(),this._initValueScale()}setAttrFromSpec(){var e,i,n,o,l,d,u,f,g,_;super.setAttrFromSpec(),isBoolean(this._spec.roam)&&(this._zoomAttr.enable=this._spec.roam,this._dragAttr.enable=this._spec.roam,this._scrollAttr.enable=this._spec.roam),(this._zoomAttr.enable||this._dragAttr.enable||this._scrollAttr.enable)&&this.initZoomable(this.event,this._option.mode),this._backgroundSize=(i=(e=this._spec.background)===null||e===void 0?void 0:e.size)!==null&&i!==void 0?i:30,this._middleHandlerSize=this._computeMiddleHandlerSize(),this._width=this._computeWidth(),this._height=this._computeHeight(),isNil((l=(o=(n=this._spec)===null||n===void 0?void 0:n.startHandler)===null||o===void 0?void 0:o.style)===null||l===void 0?void 0:l.size)&&(this._spec.startHandler.style.size=this._isHorizontal?this._height-this._middleHandlerSize:this._width-this._middleHandlerSize),isNil((f=(u=(d=this._spec)===null||d===void 0?void 0:d.endHandler)===null||u===void 0?void 0:u.style)===null||f===void 0?void 0:f.size)&&(this._spec.endHandler.style.size=this._isHorizontal?this._height-this._middleHandlerSize:this._width-this._middleHandlerSize);const y=(g=this._spec.startHandler.style.visible)===null||g===void 0||g,b=(_=this._spec.endHandler.style.visible)===null||_===void 0||_;this._startHandlerSize=y?this._spec.startHandler.style.size:0,this._endHandlerSize=b?this._spec.endHandler.style.size:0}onLayoutEnd(e){this._updateScaleRange(),this._isReverse()&&!this._isReverseCache&&(this._isReverseCache=this._isReverse(),this.effect.onZoomChange()),this._cacheVisibility!==!1&&super.onLayoutEnd(e)}_initValueScale(){const e=this._computeDomainOfValueScale();if(e){const i=new LinearScale;i.domain(e),this._valueScale=i}}_updateScaleRange(){var e,i;const n=this._startHandlerSize+this._endHandlerSize;if(!this._stateScale||!this._valueScale)return;let o;const l=this._isHorizontal?this.getLayoutRect().width-n:this.getLayoutRect().height-n,d=(i=(e=this._relatedAxisComponent)===null||e===void 0?void 0:e.getScale().range())!==null&&i!==void 0?i:[this._startHandlerSize/2,l+this._startHandlerSize/2],u=this._computeWidth(),f=this._computeHeight();this._isHorizontal?(o=this._visible?[this._startHandlerSize/2,u-n+this._startHandlerSize/2]:d,this._stateScale.range(o),this._valueScale.range([f-this._middleHandlerSize,0])):(o=this._visible?[this._startHandlerSize/2,f-n+this._startHandlerSize/2]:d,this._stateScale.range(o),this.layoutOrient==="left"?this._valueScale.range([u-this._middleHandlerSize,0]):this._valueScale.range([0,u-this._middleHandlerSize])),this._component&&this._cacheVisibility!==!1&&this._component.setAttributes({size:{width:u,height:f},position:{x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y}})}_computeDomainOfValueScale(){const e=this._data.getLatestData().map(n=>n[this._valueField]),i=e.map(n=>1*n);return e.length?[minInArray(i),maxInArray(i)]:null}_computeMiddleHandlerSize(){var e,i,n,o;let l=0;if(!((i=(e=this._spec)===null||e===void 0?void 0:e.middleHandler)===null||i===void 0)&&i.visible){const d=(n=this._spec.middleHandler.icon.style.size)!==null&&n!==void 0?n:8,u=(o=this._spec.middleHandler.background.size)!==null&&o!==void 0?o:40;l+=Math.max(d,u)}return l}_computeWidth(){return this._visible===!1?0:isNumber(this._spec.width)?this._spec.width:this._isHorizontal?this.getLayoutRect().width:this._backgroundSize+this._middleHandlerSize}_computeHeight(){return this._visible===!1?0:isNumber(this._spec.height)?this._spec.height:this._isHorizontal?this._backgroundSize+this._middleHandlerSize:this.getLayoutRect().height}_isScaleValid(e){if(!e||!e.domain())return!1;const i=e.domain();return(!isContinuous(e.type)||i[0]!==last(i))&&(!isDiscrete(e.type)||uniqArray(i).length!==1)}_getAttrs(e){var i,n,o,l,d;const u=(i=this._spec)!==null&&i!==void 0?i:{};return Object.assign({zIndex:this.layoutZIndex,start:this._start,end:this._end,position:{x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y},orient:this._orient,size:{width:this._computeWidth(),height:this._computeHeight()},showDetail:u.showDetail,brushSelect:(n=u.brushSelect)!==null&&n!==void 0&&n,zoomLock:(o=u.zoomLock)!==null&&o!==void 0&&o,minSpan:this._minSpan,maxSpan:this._maxSpan,delayType:u.delayType,delayTime:isValid(u.delayType)?(l=u.delayTime)!==null&&l!==void 0?l:30:0,realTime:(d=u.realTime)===null||d===void 0||d,previewData:e&&this._data.getLatestData(),previewPointsX:e&&this._dataToPositionX,previewPointsY:e&&this._dataToPositionY,tolerance:this._spec.tolerance},this._getComponentAttrs(e))}_createOrUpdateComponent(){if(this._visible){const e=this._isHorizontal?this._stateScale:this._valueScale,i=this._isHorizontal?this._valueScale:this._stateScale,n=this._isScaleValid(e)&&this._isScaleValid(i)&&this._spec.showBackgroundChart!==!1,o=this._getAttrs(n);if(this._component)this._component.setAttributes(o);else{const l=this.getContainer();this._component=new DataZoom$1(o),this._isHorizontal?n&&this._component.setPreviewPointsY1(this._dataToPositionY2):n&&this._component.setPreviewPointsX1(this._dataToPositionX2),this._component.setStatePointToData(d=>this._statePointToData(d)),this._component.addEventListener("change",d=>{const{start:u,end:f,tag:g}=d.detail;this._handleChange(u,f,void 0,g)}),l.add(this._component),this._updateScaleRange()}}}_handleChange(e,i,n,o){if(super._handleChange(e,i,n),this._shouldChange){n&&this._component&&this._component.setStartAndEnd(e,i),this._start=e,this._end=i;const l=this._statePointToData(e),d=this._statePointToData(i);(isFunction(this._spec.updateDataAfterChange)?this._spec.updateDataAfterChange(e,i,l,d):this._handleStateChange(l,d,o))&&this.event.emit(ChartEvent.dataZoomChange,{model:this,value:{filterData:this._filterMode!=="axis",start:e,end:i,startValue:this._startValue,endValue:this._endValue,newDomain:this._newDomain}})}}_handleDataCollectionChange(){var e;const i=this._data.getDataView();if(i.reRunAllTransform(),(e=this._component)===null||e===void 0||e.setPreviewData(i.latestData),this._valueScale){const n=this._computeDomainOfValueScale();n&&this._valueScale.domain(n)}}_getComponentAttrs(e){var i,n,o,l,d,u,f,g,_,y,b;const{middleHandler:S={},startText:v={},endText:A={},backgroundChart:x={},selectedBackgroundChart:T={}}=this._spec;return{backgroundStyle:transformToGraphic((i=this._spec.background)===null||i===void 0?void 0:i.style),startHandlerStyle:transformToGraphic((n=this._spec.startHandler)===null||n===void 0?void 0:n.style),middleHandlerStyle:S.visible?{visible:!0,icon:transformToGraphic((o=S.icon)===null||o===void 0?void 0:o.style),background:{size:(l=S.background)===null||l===void 0?void 0:l.size,style:transformToGraphic((d=S.background)===null||d===void 0?void 0:d.style)}}:{visible:!1},endHandlerStyle:transformToGraphic((u=this._spec.endHandler)===null||u===void 0?void 0:u.style),startTextStyle:{padding:v.padding,formatMethod:this._getHandlerTextFormatMethod(v),textStyle:transformToGraphic(v.style)},endTextStyle:{padding:A.padding,formatMethod:this._getHandlerTextFormatMethod(A),textStyle:transformToGraphic(A.style)},selectedBackgroundStyle:transformToGraphic(this._spec.selectedBackground.style),dragMaskStyle:transformToGraphic((f=this._spec.dragMask)===null||f===void 0?void 0:f.style),backgroundChartStyle:e?{line:mergeSpec(transformToGraphic((g=x.line)===null||g===void 0?void 0:g.style),{fill:!1}),area:Object.assign({curveType:"basis",visible:!0},transformToGraphic((_=x.area)===null||_===void 0?void 0:_.style))}:{line:{visible:!1},area:{visible:!1}},selectedBackgroundChartStyle:e?{line:mergeSpec(transformToGraphic((y=T.line)===null||y===void 0?void 0:y.style),{fill:!1}),area:Object.assign({curveType:"basis",visible:!0},transformToGraphic((b=T.area)===null||b===void 0?void 0:b.style))}:{line:{visible:!1},area:{visible:!1}},disableTriggerEvent:this._option.disableTriggerEvent}}_getHandlerTextFormatMethod(e){const{formatMethod:i,formatter:n}=e,{formatFunc:o}=getFormatFunction(i,n);return o?l=>o(l,{label:l},n):void 0}_getNeedClearVRenderComponents(){return[this._component]}clear(){if(this._component){const e=this.getContainer();this._component.removeAllChild(),e&&e.removeChild(this._component),this._component=null}super.clear()}}DataZoom.type=ComponentTypeEnum.dataZoom,DataZoom.transformerConstructor=DataZoomSpecTransformer,DataZoom.specKey="dataZoom";const registerDataZoom=()=>{Factory$1.registerComponent(DataZoom.type,DataZoom)};class ScrollBar extends DataFilterBaseComponent{constructor(e,i){var n;super(e,i),this.type=ComponentTypeEnum.scrollBar,this.name=ComponentTypeEnum.scrollBar,this.specKey="scrollBar",this.layoutZIndex=LayoutZIndex.DataZoom,this.layoutLevel=LayoutLevel.DataZoom,this.layoutType="region-relative",this._filterMode=(n=e.filterMode)!==null&&n!==void 0?n:"axis"}setAttrFromSpec(){super.setAttrFromSpec(),isBoolean(this._spec.roam)&&(this._zoomAttr.enable=!1,this._dragAttr.enable=this._spec.roam,this._scrollAttr.enable=this._spec.roam),(this._zoomAttr.enable||this._dragAttr.enable||this._scrollAttr.enable)&&this.initZoomable(this.event,this._option.mode)}onLayoutEnd(e){var i,n;this._updateScaleRange(),(n=(i=this.effect).onZoomChange)===null||n===void 0||n.call(i),super.onLayoutEnd(e)}_updateScaleRange(){this._component&&this._component.setAttributes({x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y,width:this.getLayoutRect().width,height:this.getLayoutRect().height})}_computeWidth(){return isNumber(this._spec.width)?this._spec.width:this._isHorizontal?this.getLayoutRect().width:SCROLL_BAR_DEFAULT_SIZE}_computeHeight(){return isNumber(this._spec.height)?this._spec.height:this._isHorizontal?SCROLL_BAR_DEFAULT_SIZE:this.getLayoutRect().height}_getAttrs(){var e,i,n,o,l,d;return Object.assign({zIndex:this.layoutZIndex,x:this.getLayoutStartPoint().x,y:this.getLayoutStartPoint().y,width:this.getLayoutRect().width,height:this.getLayoutRect().height,range:[this._start,this._end],direction:this._isHorizontal?"horizontal":"vertical",delayType:(e=this._spec)===null||e===void 0?void 0:e.delayType,delayTime:isValid((i=this._spec)===null||i===void 0?void 0:i.delayType)?(o=(n=this._spec)===null||n===void 0?void 0:n.delayTime)!==null&&o!==void 0?o:30:0,realTime:(d=(l=this._spec)===null||l===void 0?void 0:l.realTime)===null||d===void 0||d},this._getComponentAttrs())}_createOrUpdateComponent(){const e=this._getAttrs();if(this._component)this._component.setAttributes(e);else{const i=this.getContainer();this._component=new ScrollBar$1(e),this._component.addEventListener("scrollDrag",n=>{const o=n.detail.value;this._handleChange(o[0],o[1])}),i.add(this._component)}}_handleChange(e,i,n){super._handleChange(e,i,n);const o=isClose(this._start,e)&&isClose(this._end,i);if(this._shouldChange&&!o){n&&this._component&&this._component.setAttribute("range",[e,i]),this._start=e,this._end=i;const l=this._statePointToData(e),d=this._statePointToData(i);(isFunction(this._spec.updateDataAfterChange)?this._spec.updateDataAfterChange(e,i,l,d):this._handleStateChange(this._statePointToData(e),this._statePointToData(i)))&&this.event.emit(ChartEvent.scrollBarChange,{model:this,value:{filterData:this._filterMode!=="axis",start:this._start,end:this._end,startValue:this._startValue,endValue:this._endValue,newDomain:this._newDomain}})}}_handleDataCollectionChange(){this._spec.auto&&this._data.getDataView().reRunAllTransform()}_initCommonEvent(){super._initCommonEvent(),this._component&&this._component.on("scrollDrag",e=>{const i=e.detail.value;this._handleChange(i[0],i[1])})}_getComponentAttrs(){const{rail:e,slider:i,innerPadding:n}=this._spec,o={};return isNil(n)||(o.padding=n),isEmpty(e==null?void 0:e.style)||(o.railStyle=transformToGraphic(e.style)),isEmpty(i==null?void 0:i.style)||(o.sliderStyle=transformToGraphic(i.style)),o.disableTriggerEvent=this._option.disableTriggerEvent,o}_getNeedClearVRenderComponents(){return[this._component]}}ScrollBar.type=ComponentTypeEnum.scrollBar,ScrollBar.specKey="scrollBar";const registerScrollBar=()=>{Factory$1.registerComponent(ScrollBar.type,ScrollBar)},indicatorMapper=(r,e)=>{const{datum:i,title:n,content:o}=e,l=[],d=i.call(null);return n.visible&&l.push({type:"title",index:0,datum:d,spec:n}),array(o).forEach((u,f)=>{u.visible&&l.push({type:"content",index:f,datum:d,spec:u})}),l};var __rest$3=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};class Indicator extends BaseComponent{constructor(){super(...arguments),this.type=ComponentTypeEnum.indicator,this.name=ComponentTypeEnum.indicator,this.specKey="indicator",this.layoutType="none",this.layoutZIndex=LayoutZIndex.Indicator,this.layoutLevel=LayoutLevel.Indicator,this._gap=0,this._activeDatum=null}static getSpecInfo(e){return getSpecInfo(e,this.specKey,this.type,i=>i&&i.visible!==!1)}created(){super.created(),this.initData(),this.initEvent()}setAttrFromSpec(){super.setAttrFromSpec(),this._gap=this._spec.gap||0,this._title=this._spec.title,this._content=array(this._spec.content),this._regions=this._option.getRegionsInUserIdOrIndex(array(this._spec.regionId),array(this._spec.regionIndex))}onRender(e){}changeRegions(e){}initEvent(){var e;if(this._option.disableTriggerEvent||this._spec.trigger==="none")return;const i=(e=this.getCompiler())===null||e===void 0?void 0:e.getVGrammarView();i&&(this._spec.trigger==="hover"?(i.addEventListener("element-highlight:start",n=>{this.isRelativeModel(n.options.regionId)&&this.updateDatum(n.elements[0].getDatum())}),i.addEventListener("element-highlight:reset",n=>{this.isRelativeModel(n.options.regionId)&&this.updateDatum(null)})):(i.addEventListener("element-select:start",n=>{this.isRelativeModel(n.options.regionId)&&this.updateDatum(n.elements[0].getDatum())}),i.addEventListener("element-select:reset",n=>{this.isRelativeModel(n.options.regionId)&&this.updateDatum(null)})))}updateDatum(e){this._activeDatum=e,this._displayData.updateData();const i=this._getIndicatorAttrs();this._createOrUpdateIndicatorComponent(i)}initData(){registerDataSetInstanceTransform(this._option.dataSet,"indicatorFilter",indicatorMapper);const e=new DataView(this._option.dataSet,{name:`${this.type}_${this.id}_data`});e.transform({type:"indicatorFilter",options:{title:this._title,content:this._content,datum:()=>this._activeDatum}}),e.target.addListener("change",this.updateDatum.bind(this)),this._displayData=new CompilableData(this._option,e)}updateLayoutAttribute(){const e=this._getIndicatorAttrs();this._createOrUpdateIndicatorComponent(e),super.updateLayoutAttribute()}_getIndicatorAttrs(){if(this._spec.visible===!1||this._spec.fixed===!1&&this._activeDatum===null)return{visible:!1};const e=this._regions[0],{width:i,height:n}=e.getLayoutRect(),{x:o,y:l}=e.getLayoutStartPoint(),d=this._spec,{content:u,offsetX:f,offsetY:g,limitRatio:_,title:y}=d,b=__rest$3(d,["content","offsetX","offsetY","limitRatio","title"]),S=[];return array(u).forEach(v=>{const A=mergeSpec({},this._theme.content,v);S.push({visible:A.visible!==!1&&(!A.field||this._activeDatum!==null),space:A.space||this._gap,autoLimit:A.autoLimit,autoFit:A.autoFit,fitPercent:A.fitPercent,fitStrategy:A.fitStrategy,style:Object.assign(Object.assign({},transformIndicatorStyle(pickWithout(A.style,["text"]),this._activeDatum)),{text:this._createText(A.field,A.style.text)})})}),Object.assign({visible:!0,size:{width:i,height:n},zIndex:this.layoutZIndex,x:o,y:l,dx:f?getActualNumValue(f,this._computeLayoutRadius()):0,dy:g?getActualNumValue(g,this._computeLayoutRadius()):0,limitRatio:_||1/0,title:{visible:y.visible!==!1&&(!isValid(y.field)||this._activeDatum!==null),space:y.space||this._gap,autoLimit:y.autoLimit,autoFit:y.autoFit,fitPercent:y.fitPercent,fitStrategy:y.fitStrategy,style:Object.assign(Object.assign({},transformIndicatorStyle(pickWithout(y.style,["text"]),this._activeDatum)),{text:this._createText(y.field,y.style.text)})},content:S},b)}_createOrUpdateIndicatorComponent(e){if(e.visible===!1)return this._indicatorComponent&&this._indicatorComponent.parent&&this._indicatorComponent.parent.removeChild(this._indicatorComponent),void(this._indicatorComponent=null);if(this._indicatorComponent)isEqual(e,this._cacheAttrs)||this._indicatorComponent.setAttributes(e);else{const i=this.getContainer(),n=new Indicator$1(e);n.name="indicator",i.add(n),this._indicatorComponent=n,this._indicatorComponent.on("*",(o,l)=>this._delegateEvent(this._indicatorComponent,o,l))}this._cacheAttrs=e}_createText(e,i){var n;return e?this._activeDatum?this._activeDatum[e]:"":isFunction(i)?(n=i(this._activeDatum,void 0))!==null&&n!==void 0?n:"":i??""}_computeLayoutRadius(){const e=this._regions[0],{width:i,height:n}=e.getLayoutRect();return Math.min(i/2,n/2)}isRelativeModel(e){return this._regions.some(i=>i.id===e)}_getNeedClearVRenderComponents(){return[this._indicatorComponent]}clear(){this._cacheAttrs=null,super.clear()}getIndicatorComponent(){return this._indicatorComponent}}Indicator.type=ComponentTypeEnum.indicator,Indicator.specKey="indicator";const registerIndicator=()=>{Factory$1.registerComponent(Indicator.type,Indicator)},AGGR_TYPE=["sum","average","min","max","variance","standardDeviation","median"];var __rest$2=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};function isNeedExtendDomain(r,e,i){if(!i)return!1;const n=r.map(d=>1*d),o=minInArray(n),l=maxInArray(n);return e<o||e>l}function getXValue(r,e,i,n,o,l){var d,u;const{relativeSeries:f}=n;let g;return isNumber(r.x)&&isNeedExtendDomain(e,r.x,i)&&((u=f==null?void 0:(d=f.getXAxisHelper()).setExtendDomain)===null||u===void 0||u.call(d,"marker_xAxis_extend",r.x)),g=isPercent(r.x)?convertPercentToValue(r.x,o)+l.x:f.getXAxisHelper().dataToPosition([r.x])+l.x,g}function getYValue(r,e,i,n,o,l){var d,u;const{relativeSeries:f}=n;let g;return isNumber(r.y)&&isNeedExtendDomain(e,r.y,i)&&((u=(d=f.getYAxisHelper())===null||d===void 0?void 0:d.setExtendDomain)===null||u===void 0||u.call(d,"marker_yAxis_extend",r.y)),g=isPercent(r.y)?convertPercentToValue(r.y,o)+l.y:f.getYAxisHelper().dataToPosition([r.y])+l.y,g}function getAngleValue(r,e,i,n){var o,l;const{relativeSeries:d}=n;return isNumber(r.angle)&&isNeedExtendDomain(e,r.angle,i)&&((l=(o=d.angleAxisHelper)===null||o===void 0?void 0:o.setExtendDomain)===null||l===void 0||l.call(o,"marker_angleAxis_extend",r.angle)),d.angleAxisHelper.dataToPosition([r.angle])}function getRadiusValue(r,e,i,n){var o,l;const{relativeSeries:d}=n;return isNumber(r.radius)&&isNeedExtendDomain(e,r.radius,i)&&((l=(o=d.radiusAxisHelper)===null||o===void 0?void 0:o.setExtendDomain)===null||l===void 0||l.call(o,"marker_radiusAxis_extend",r.radius)),d.radiusAxisHelper.dataToPosition([r.radius])}function convertPercentToValue(r,e){return Number(r.substring(0,r.length-1))*e/100}function isAggrSpec(r){return AGGR_TYPE.includes(r)}function xyLayout(r,e,i,n,o){const l=e.getRegion(),d=l.getLayoutStartPoint(),u=i.getRegion(),f=u.getLayoutStartPoint(),g=Math.abs(Math.min(d.x,f.x)-Math.max(d.x+l.getLayoutRect().width,f.x+u.getLayoutRect().width)),_=Math.abs(Math.min(d.y,f.y)-Math.max(d.y+l.getLayoutRect().height,f.y+u.getLayoutRect().height)),y={relativeSeries:n},b=[],S=r.latestData[0]&&r.latestData[0].latestData?r.latestData[0].latestData:r.latestData,v=n.getXAxisHelper().getScale(0).domain(),A=n.getYAxisHelper().getScale(0).domain();return S.forEach(x=>{const T=isValid(x.x),C=isValid(x.y);if(T&&C){const E=getXValue(x,v,o,y,g,d),P=getYValue(x,A,o,y,_,d);b.push([{x:E,y:P}])}else if(T){const E=getXValue(x,v,o,y,g,d),P=Math.max(d.y+l.getLayoutRect().height,f.y+u.getLayoutRect().height),R=Math.min(d.y,f.y);b.push([{x:E,y:P},{x:E,y:R}])}else if(C){const E=Math.min(d.x,f.x),P=getYValue(x,A,o,y,_,d),R=Math.max(d.x+l.getLayoutRect().width,f.x+u.getLayoutRect().width);b.push([{x:E,y:P},{x:R,y:P}])}}),b}function polarLayout(r,e,i,n,o){const l={relativeSeries:n},d=[],u=r.latestData[0]&&r.latestData[0].latestData?r.latestData[0].latestData:r.latestData,f=n.angleAxisHelper.getScale(0).domain(),g=n.radiusAxisHelper.getScale(0).domain(),_=Math.min(n.getRegion().getLayoutRect().width/2,n.getRegion().getLayoutRect().height/2);return u.forEach(y=>{const b=isValid(y.angle),S=isValid(y.radius);if(b&&S){const v=getAngleValue(y,f,o,l),A=getRadiusValue(y,g,o,l);d.push([{angle:v,radius:A}])}else if(b){const v=getAngleValue(y,f,o,l);d.push([{angle:v,radius:-_},{angle:v,radius:_}])}else if(S){const v=getRadiusValue(y,g,o,l);d.push([{radius:v,angle:0},{radius:v,angle:2*Math.PI}])}}),d}function geoLayout(r,e){const i=[];return(r.latestData[0]&&r.latestData[0].latestData?r.latestData[0].latestData:r.latestData).forEach(n=>{isValid(n.areaName)&&i.push([{x:e.nameValueToPosition(n.areaName).x+e.getRegion().getLayoutStartPoint().x,y:e.nameValueToPosition(n.areaName).y+e.getRegion().getLayoutStartPoint().y}])}),i}function cartesianCoordinateLayout(r,e,i,n){const o=[],l=r.latestData[0]&&r.latestData[0].latestData?r.latestData[0].latestData:r.latestData,d=isArray(n);return l.forEach((u,f)=>{var g,_,y,b;const S=u!=null&&u.getRefRelativeSeries?u.getRefRelativeSeries():e,v=S.getRegion(),A=v.getLayoutStartPoint(),{width:x,height:T}=v.getLayoutRect();let C=0,E=0;if(n){const B=d?n[f]:n,I=B.x,D=B.y;I&&(C=isPercent(I)?Number(I.substring(0,I.length-1))*x/100:I),D&&(E=isPercent(D)?Number(D.substring(0,D.length-1))*T/100:D)}const P=S.getXAxisHelper().getScale(0).domain(),R=S.getYAxisHelper().getScale(0).domain(),L=array(u.x),w=array(u.y);L.length===1&&isNumber(L[0])&&isNeedExtendDomain(P,L[0],i)&&((_=(g=S.getXAxisHelper())===null||g===void 0?void 0:g.setExtendDomain)===null||_===void 0||_.call(g,"marker_xAxis_extend",L[0])),w.length===1&&isNumber(w[0])&&isNeedExtendDomain(R,w[0],i)&&((b=(y=S.getYAxisHelper())===null||y===void 0?void 0:y.setExtendDomain)===null||b===void 0||b.call(y,"marker_yAxis_extend",w[0])),o.push({x:S.getXAxisHelper().dataToPosition(L)+A.x+C,y:S.getYAxisHelper().dataToPosition(w)+A.y+E})}),o}function polarCoordinateLayout(r,e,i){const n=[];return(r.latestData[0]&&r.latestData[0].latestData?r.latestData[0].latestData:r.latestData).forEach(o=>{var l,d,u,f;const g=o!=null&&o.getRefRelativeSeries?o.getRefRelativeSeries():e,_=g.angleAxisHelper.getScale(0).domain(),y=g.radiusAxisHelper.getScale(0).domain(),b=array(o.angle),S=array(o.radius);b.length===1&&isNumber(b[0])&&isNeedExtendDomain(_,b[0],i)&&((d=(l=g.angleAxisHelper)===null||l===void 0?void 0:l.setExtendDomain)===null||d===void 0||d.call(l,"marker_xAxis_extend",b[0])),S.length===1&&isNumber(S[0])&&isNeedExtendDomain(y,S[0],i)&&((f=(u=g.radiusAxisHelper)===null||u===void 0?void 0:u.setExtendDomain)===null||f===void 0||f.call(u,"marker_yAxis_extend",S[0])),n.push({angle:g.angleAxisHelper.dataToPosition(b),radius:g.radiusAxisHelper.dataToPosition(S)})}),n}function convertPosition(r,e,i){let{x:n,y:o}=r;return isPercent(n)&&(n=convertPercentToValue(n,e)),isPercent(o)&&(o=convertPercentToValue(o,i)),{x:n,y:o}}function positionLayout(r,e,i){let n;if(n=isFunction(r)?array(r(e.getData().getLatestData(),e)):array(r),i){const d=e.getRegion(),{x:u,y:f}=d.getLayoutStartPoint(),{width:g,height:_}=d.getLayoutRect();return n.map(y=>{let{x:b,y:S}=convertPosition(y,g,_);return b+=u,S+=f,{x:b,y:S}})}const{width:o,height:l}=e.getOption().getChart().getViewRect();return n.map(d=>convertPosition(d,o,l))}function computeClipRange(r){let e=1/0,i=-1/0,n=1/0,o=-1/0;return r.forEach(l=>{const d=l.getLayoutStartPoint(),u=l.getLayoutRect();d.x<e&&(e=d.x),d.x+u.width>i&&(i=d.x+u.width),d.y<n&&(n=d.y),d.y+u.height>o&&(o=d.y+u.height)}),{minX:e,maxX:i,minY:n,maxY:o}}function transformLabelAttributes(r,e,i){const{labelBackground:n={},style:o,shape:l}=r,d=__rest$2(r,["labelBackground","style","shape"]);if(r.visible!==!1){const u=d;return l!=null&&l.visible?u.shape=Object.assign({visible:!0},transformToGraphic(l.style)):u.shape={visible:!1},n.visible!==!1?(u.panel=Object.assign({visible:!0,customShape:n.customShape},transformStyle(transformToGraphic(n.style),e,i)),isValid(n.padding)&&(u.padding=normalizePadding$1(n.padding))):(u.panel={visible:!1},u.padding=0),o&&(u.textStyle=transformStyle(transformToGraphic(o),e,i)),u}return{visible:!1}}function transformState(r,e,i){for(const n in r)isFunction(r[n])&&(r[n]=r[n](e,i));return r}function transformStyle(r,e,i){return isFunction(r)?r(e,i):r}function transformOffset(r,e){return isFunction(r)?r(e):r}function computeOffsetFromRegion(r,e,i){return isValid(r)?e==="regionLeft"?i.getLayoutStartPoint().x-r.x:e==="regionRight"?i.getLayoutStartPoint().x+i.getLayoutRect().width-r.x:e==="regionTop"?i.getLayoutStartPoint().y-r.y:e==="regionBottom"?i.getLayoutStartPoint().y+i.getLayoutRect().height-r.y:e:e}function getMarkLineProcessInfo(r){const e="x"in r,i="y"in r,n="x1"in r,o="y1"in r,l="angle"in r,d="radius"in r,u="angle1"in r,f="radius1"in r;return{doXProcess:e&&!i&&!o,doXYY1Process:e&&i&&o,doYProcess:i&&!e&&!n,doYXX1Process:i&&e&&n,doXYProcess:e&&i&&n&&o,doAngleProcess:l&&!u&&!d&&!f,doRadiusProcess:d&&!f&&!l&&!u,doAngRadRad1Process:l&&!u&&d&&f,doRadAngAng1Process:d&&l&&u&&!f,doRadAngProcess:l&&d&&u&&f,doCoordinatesProcess:"coordinates"in r&&(!("process"in r)||"process"in r&&"xy"in r.process)}}function getMarkAreaProcessInfo(r){const e="x"in r,i="x1"in r,n="y"in r,o="y1"in r,l="angle"in r,d="radius"in r,u="angle1"in r,f="radius1"in r;return{doXProcess:e&&i&&!n&&!o,doYProcess:n&&o&&!e&&!i,doXYProcess:e&&i&&n&&o,doAngleProcess:l&&u&&!d&&!f,doRadiusProcess:d&&f&&!l&&!u,doRadAngProcess:l&&d&&u&&f,doCoordinatesProcess:"coordinates"in r}}function getMarkPointProcessInfo(r){return{doXYProcess:isValid(r.x)&&isValid(r.y),doPolarProcess:isValid(r.angle)&&isValid(r.radius),doGeoProcess:isValid(r.areaName)}}function getInsertPoints(r,e,i,n=0){const o=[],l=r.y-e.y,d=r.x-e.x;switch(i){case"top":o.push(r),o.push({x:r.x,y:l>0?r.y-n-Math.abs(l):r.y-n}),o.push({x:e.x,y:l>0?e.y-n:e.y-n-Math.abs(l)}),o.push(e);break;case"bottom":o.push(r),o.push({x:r.x,y:l<0?r.y+n+Math.abs(l):r.y+n}),o.push({x:e.x,y:l<0?e.y+n:e.y+n+Math.abs(l)}),o.push(e);break;case"left":o.push(r),o.push({x:d>0?r.x-n-Math.abs(d):r.x-n,y:r.y}),o.push({x:d>0?e.x-n:e.x-n-Math.abs(d),y:e.y}),o.push(e);break;case"right":o.push(r),o.push({x:d>0?r.x+n:r.x+n+Math.abs(d),y:r.y}),o.push({x:d>0?e.x+n+Math.abs(d):e.x+n,y:e.y}),o.push(e)}return o}function getTextOffset(r,e,i,n=0){const o=r.y-e.y,l=r.x-e.x;return i==="bottom"?{dx:l>0?-l/2:Math.abs(l/2),dy:o>0?n:Math.abs(o)+n}:i==="top"?{dx:l>0?-Math.abs(l/2):+Math.abs(l/2),dy:o>0?-(Math.abs(o)+n):-n}:i==="left"?{dx:l>0?-l-n:-n,dy:o>0?-o/2:Math.abs(o/2)}:i==="right"?{dx:l>0?n:Math.abs(l)+n,dy:o>0?-o/2:Math.abs(o/2)}:{}}var __rest$1=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};const markerMin=(r,e)=>{const i=r[0].latestData;return min(i,e.field)},markerMax=(r,e)=>{const i=r[0].latestData;return max(i,e.field)};function markerSum(r,e){const i=r[0].latestData;return sum$1(i,e.field)}function markerAverage(r,e){const i=r[0].latestData;return average$1(i,e.field)}function markerVariance(r,e){const i=r[0].latestData;return variance(i,e.field)}function markerStandardDeviation(r,e){const i=r[0].latestData;return standardDeviation(i,e.field)}function markerMedian(r,e){const i=r[0].latestData;return median(i,e.field)}function markerAggregation(r,e){let i;if(e.coordinates){const o=e,{coordinates:l,coordinateType:d,getSeriesByIdOrIndex:u}=o,f=__rest$1(o,["coordinates","coordinateType","getSeriesByIdOrIndex"]);let g,_;if(isFunction(l)){const y=e.getRelativeSeries();g=l(y.getData().getLatestData(),y)}else g=l;g=array(g),i=g.map(y=>{const b=u(y.refRelativeSeriesId,y.refRelativeSeriesIndex);if(d==="cartesian"){const{xField:S,yField:v}=b.getSpec(),{xFieldDim:A,xFieldIndex:x,yFieldDim:T,yFieldIndex:C}=y;let E=S;isValid(x)&&(E=array(S)[x]),A&&array(S).includes(A)&&(E=A);let P=v;isValid(C)&&(P=array(v)[C]),T&&array(v).includes(T)&&(P=T),_=Object.assign({x:void 0,y:void 0},f),isString(y[E])&&isAggrSpec(y[E])?_.x={field:E,aggrType:y[E]}:_.x=array(E).map(R=>y[R]),isString(y[P])&&isAggrSpec(y[P])?_.y={field:P,aggrType:y[P]}:_.y=array(P).map(R=>y[R])}else if(d==="polar"){const{valueField:S,categoryField:v}=b.getSpec(),{angleFieldDim:A,angleFieldIndex:x}=y;let T=v;isValid(x)&&(T=array(v)[x]),A&&array(v).includes(A)&&(T=A);const C=S;_=Object.assign({angle:void 0,radius:void 0},f),isString(y[T])&&isAggrSpec(y[T])?_.angle={field:T,aggrType:y[T]}:_.angle=array(T).map(E=>y[E]),isString(y[C])&&isAggrSpec(y[C])?_.radius={field:C,aggrType:y[C]}:_.radius=array(C).map(E=>y[E])}return _.getRefRelativeSeries=()=>b,_})}else i=e;const n=[];return i.forEach(o=>{const l={x:null,y:null,angle:null,radius:null,areaName:null};if(isValid(o.x)){const d=o.x;isArray(d)?l.x=d.map(u=>getFinalValue(u,r,o)):l.x=getFinalValue(d,r,o)}if(isValid(o.y)){const d=o.y;isArray(d)?l.y=d.map(u=>getFinalValue(u,r,o)):l.y=getFinalValue(d,r,o)}if(isValid(o.angle)){const d=o.angle;isArray(d)?l.angle=d.map(u=>getFinalValue(u,r,o)):l.angle=getFinalValue(d,r,o)}if(isValid(o.radius)){const d=o.radius;isArray(d)?l.radius=d.map(u=>getFinalValue(u,r,o)):l.radius=getFinalValue(d,r,o)}if(isValid(o.areaName)){const d=o.areaName;l.areaName=getFinalValue(d,r,o)}o.getRefRelativeSeries&&(l.getRefRelativeSeries=o.getRefRelativeSeries),n.push(l)}),n}const aggrMap={min:markerMin,max:markerMax,sum:markerSum,average:markerAverage,variance:markerVariance,standardDeviation:markerStandardDeviation,median:markerMedian};function getFinalValue(r,e,i){const n=i.getRelativeSeries(),o=i.getStartRelativeSeries(),l=i.getEndRelativeSeries(),d=n.getData().getLatestData(),u=o.getData().getLatestData(),f=l.getData().getLatestData();if(isFunction(r))return r(d,u,f,n,o,l);if(isPlainObject(r)){const{aggrType:g,field:_}=r;return aggrMap[g](e,{field:_})}return r}function markerFilter(r,e){if(e&&e.getRelativeSeries){const i=e.getRelativeSeries();if(i){const n=i.getViewData();return n&&n.latestData&&n.latestData.length?r:[]}}return r}class BaseMarker extends BaseComponent{constructor(){super(...arguments),this.layoutType="none",this._layoutOffsetX=0,this._layoutOffsetY=0}getRelativeSeries(){return this._relativeSeries}getMarkerData(){return this._markerData}static _getMarkerCoordinateType(e){return"cartesian"}static getSpecInfo(e){return getSpecInfo(e,this.specKey,this.type,i=>i.visible!==!1&&this._getMarkerCoordinateType(i)===this.coordinateType)}getMarkAttributeContext(){return this._markAttributeContext}_buildMarkerAttributeContext(){this._markAttributeContext={relativeSeries:this._relativeSeries,startRelativeSeries:this._startRelativeSeries,endRelativeSeries:this._endRelativeSeries,vchart:this._option.globalInstance}}created(){super.created(),this._bindSeries(),this._initDataView(),this.initEvent(),this._buildMarkerAttributeContext()}_getAllRelativeSeries(){return{getRelativeSeries:()=>this._relativeSeries,getStartRelativeSeries:()=>this._startRelativeSeries,getEndRelativeSeries:()=>this._endRelativeSeries}}_getFieldInfoFromSpec(e,i,n){const o={x:"xField",y:"yField",radius:"valueField",angle:"categoryField",areaName:"nameField"};return isString(i)&&isAggrSpec(i)?{field:n.getSpec()[o[e]],aggrType:i}:i}_processSpecByDims(e){const i=this._relativeSeries,n={};return e.forEach(o=>n[o.dim]=this._getFieldInfoFromSpec(o.dim,o.specValue,i)),Object.assign(Object.assign({},n),this._getAllRelativeSeries())}_processSpecCoo(e){return Object.assign(Object.assign({coordinates:e.coordinates||e.coordinate},this._getAllRelativeSeries()),{getSeriesByIdOrIndex:(i,n)=>this._getSeriesByIdOrIndex(i,n),coordinateType:this.coordinateType})}_getRelativeDataView(){if(this._specifiedDataSeries){let e=[];array(this._specifiedDataSeries).forEach(n=>{e=e.concat(n.getViewData().latestData)});const i=new DataSet;return i.registerParser("array",arrayParser),new DataView(i).parse(e,{type:"array"})}return this._relativeSeries.getViewData()}updateLayoutAttribute(){var e,i,n;if((e=this._spec.visible)===null||e===void 0||e){if(!this._markerComponent){const o=this._createMarkerComponent();o.name=(i=this._spec.name)!==null&&i!==void 0?i:this.type,o.id=(n=this._spec.id)!==null&&n!==void 0?n:`${this.type}-${this.id}`,this._markerComponent=o,this.getContainer().add(this._markerComponent),this._markerComponent.on("*",(l,d)=>{this._delegateEvent(this._markerComponent,l,d,null,this.getMarkerData.bind(this))})}this._markerLayout()}super.updateLayoutAttribute()}_getSeriesByIdOrIndex(e,i){var n,o;let l;return l=(n=this._option.getSeriesInUserIdOrIndex(isValid(e)?[e]:[],[i]))===null||n===void 0?void 0:n[0],l||(l=(o=this._relativeSeries)!==null&&o!==void 0?o:this._getFirstSeries()),l}_bindSeries(){const e=this._spec;this._relativeSeries=this._getSeriesByIdOrIndex(e.relativeSeriesId,e.relativeSeriesIndex),this._startRelativeSeries=this._getSeriesByIdOrIndex(e.startRelativeSeriesId,e.startRelativeSeriesIndex),this._endRelativeSeries=this._getSeriesByIdOrIndex(e.endRelativeSeriesId,e.endRelativeSeriesIndex),e.specifiedDataSeriesIndex&&e.specifiedDataSeriesIndex==="all"||e.specifiedDataSeriesId&&e.specifiedDataSeriesId==="all"?this._specifiedDataSeries=this._option.getAllSeries():(e.specifiedDataSeriesIndex||e.specifiedDataSeriesId)&&(this._specifiedDataSeries=this._getSeriesByIdOrIndex(e.specifiedDataSeriesId,e.specifiedDataSeriesIndex))}initEvent(){this._relativeSeries.coordinate!=="cartesian"&&(this._relativeSeries.event.on("zoom",this._markerLayout.bind(this)),this._relativeSeries.event.on("panmove",this._markerLayout.bind(this)),this._relativeSeries.event.on("scroll",this._markerLayout.bind(this)))}onRender(e){}changeRegions(e){}clear(){super.clear(),this._firstSeries=null}_getFirstSeries(){var e;if(this._firstSeries)return this._firstSeries;const i=getFirstSeries(this._regions);return i?(this._firstSeries=i,i):((e=this._option)===null||e===void 0||e.onError("need at least one series"),null)}_getNeedClearVRenderComponents(){return[this._markerComponent]}onLayoutStart(e,i,n){isNil(this._spec.offsetX)||(this._layoutOffsetX=calcLayoutNumber(this._spec.offsetX,i.width,i)),isNil(this._spec.offsetY)||(this._layoutOffsetY=calcLayoutNumber(this._spec.offsetY,i.height,i)),super.onLayoutStart(e,i,n)}_compareSpec(e,i){const n=super._compareSpec(e,i);return isEqual(i,e)||(n.reRender=!0,n.reMake=!0,n.change=!0),n}_initCommonDataView(){const{options:e}=this._computeOptions(),i=this._getRelativeDataView();registerDataSetInstanceTransform(this._option.dataSet,"markerAggregation",markerAggregation),registerDataSetInstanceTransform(this._option.dataSet,"markerFilter",markerFilter);const n=new DataView(this._option.dataSet,{name:`${this.type}_${this.id}_data`});n.parse([i],{type:"dataview"}),n.transform({type:"markerAggregation",options:e}),n.transform({type:"markerFilter",options:this._getAllRelativeSeries()}),n.target.on("change",()=>{this._markerLayout()}),this._markerData=n}}function markerRegression(r,e){const i=r[0].latestData;return regression(i,e.fieldX,e.fieldY)}class BaseMarkLine extends BaseMarker{constructor(){super(...arguments),this.specKey="markLine",this.layoutZIndex=LayoutZIndex.MarkLine}static _getMarkerCoordinateType(e){const{doAngleProcess:i,doRadiusProcess:n,doAngRadRad1Process:o,doRadAngAng1Process:l,doRadAngProcess:d}=getMarkLineProcessInfo(e);return e.coordinateType==="polar"||i||n||o||l||d?"polar":"cartesian"}_createMarkerComponent(){var e,i,n,o,l,d,u,f,g,_,y,b,S,v,A,x,T,C,E;const{label:P={},startSymbol:R={},endSymbol:L={}}=this._spec,w={zIndex:this.layoutZIndex,interactive:(e=this._spec.interactive)===null||e===void 0||e,hover:(i=this._spec.interactive)===null||i===void 0||i,select:(n=this._spec.interactive)===null||n===void 0||n,points:[{x:0,y:0},{x:0,y:0}],center:{x:0,y:0},radius:0,startAngle:0,endAngle:0,lineStyle:transformStyle(transformToGraphic((o=this._spec.line)===null||o===void 0?void 0:o.style),this._markerData,this._markAttributeContext),clipInRange:(l=this._spec.clip)!==null&&l!==void 0&&l,label:transformLabelAttributes(P,this._markerData,this._markAttributeContext),state:{line:transformState((u=(d=this._spec.line)===null||d===void 0?void 0:d.state)!==null&&u!==void 0?u:{},this._markerData,this._markAttributeContext),lineStartSymbol:transformState((g=(f=this._spec.startSymbol)===null||f===void 0?void 0:f.state)!==null&&g!==void 0?g:{},this._markerData,this._markAttributeContext),lineEndSymbol:transformState((y=(_=this._spec.endSymbol)===null||_===void 0?void 0:_.state)!==null&&y!==void 0?y:{},this._markerData,this._markAttributeContext),label:transformState((v=(S=(b=this._spec)===null||b===void 0?void 0:b.label)===null||S===void 0?void 0:S.state)!==null&&v!==void 0?v:{},this._markerData,this._markAttributeContext),labelBackground:transformState((C=(T=(x=(A=this._spec)===null||A===void 0?void 0:A.label)===null||x===void 0?void 0:x.labelBackground)===null||T===void 0?void 0:T.state)!==null&&C!==void 0?C:{},this._markerData,this._markAttributeContext)},animation:(E=this._spec.animation)!==null&&E!==void 0&&E,animationEnter:this._spec.animationEnter,animationExit:this._spec.animationExit,animationUpdate:this._spec.animationUpdate};return R.visible?w.startSymbol=Object.assign(Object.assign({},R),{visible:!0,style:transformStyle(transformToGraphic(R.style),this._markerData,this._markAttributeContext)}):w.startSymbol={visible:!1},L.visible?w.endSymbol=Object.assign(Object.assign({},L),{visible:!0,style:transformStyle(transformToGraphic(L.style),this._markerData,this._markAttributeContext)}):w.endSymbol={visible:!1},this._newMarkLineComponent(w)}_getUpdateMarkerAttrs(){var e,i,n,o;const l=this._spec,d=this._markerData,u=this._startRelativeSeries,f=this._endRelativeSeries,g=this._relativeSeries,_=this._computePointsAttr(),y=g.getViewData().latestData,b=d.latestData[0]&&d.latestData[0].latestData?d.latestData[0].latestData:d.latestData;let S;if(l.clip||!((e=l.label)===null||e===void 0)&&e.confine){const{minX:x,maxX:T,minY:C,maxY:E}=computeClipRange([u.getRegion(),f.getRegion(),g.getRegion()]);S={x,y:C,width:T-x,height:E-C}}const v=(n=(i=this._markerComponent)===null||i===void 0?void 0:i.attribute)!==null&&n!==void 0?n:{},A=Object.assign(Object.assign({},v.label),{text:this._spec.label.formatMethod?this._spec.label.formatMethod(b,y):(o=v.label)===null||o===void 0?void 0:o.text});return Object.assign(Object.assign({},_),{label:A,limitRect:S,dx:this._layoutOffsetX,dy:this._layoutOffsetY})}_markerLayout(){var e;const i=this._getUpdateMarkerAttrs();(e=this._markerComponent)===null||e===void 0||e.setAttributes(i)}_initDataView(){const e=this._spec,i="coordinates"in e,{doXProcess:n,doYProcess:o,doXYY1Process:l,doYXX1Process:d,doXYProcess:u,doAngleProcess:f,doRadiusProcess:g,doAngRadRad1Process:_,doRadAngAng1Process:y,doRadAngProcess:b}=getMarkLineProcessInfo(e);if(this._markerData=this._getRelativeDataView(),!(n||o||l||d||u||f||g||_||y||b||i))return;registerDataSetInstanceTransform(this._option.dataSet,"markerAggregation",markerAggregation),registerDataSetInstanceTransform(this._option.dataSet,"markerRegression",markerRegression),registerDataSetInstanceTransform(this._option.dataSet,"markerFilter",markerFilter);const{options:S,needAggr:v,needRegr:A,processData:x}=this._computeOptions(),T=new DataView(this._option.dataSet);T.parse([x],{type:"dataview"}),v&&T.transform({type:"markerAggregation",options:S}),A&&T.transform({type:"markerRegression",options:S}),T.transform({type:"markerFilter",options:this._getAllRelativeSeries()}),T.target.on("change",()=>{this._markerLayout()}),this._markerData=T}}BaseMarkLine.specKey="markLine";class CartesianMarkLine extends BaseMarkLine{constructor(){super(...arguments),this.type=ComponentTypeEnum.markLine,this.name=ComponentTypeEnum.markLine,this.coordinateType="cartesian"}_newMarkLineComponent(e){return new MarkLine(e)}_computePointsAttr(){var e;const i=this._spec,n=this._markerData,o=this._startRelativeSeries,l=this._endRelativeSeries,d=this._relativeSeries,u=isValid(i.coordinates),f=isValid(i.process),g=f&&isValid(i.process.x),_=f&&isValid(i.process.y),y=isValid(i.positions),b=(e=i.autoRange)!==null&&e!==void 0&&e,{doXProcess:S,doYProcess:v,doXYY1Process:A,doYXX1Process:x,doXYProcess:T,doCoordinatesProcess:C}=getMarkLineProcessInfo(i);let E=[];if(S||A||v||x||T||u&&g||u&&_){const P=xyLayout(n,o,l,d,b);E=P.length===1?P[0]:P.map(R=>R[0])}else C?E=cartesianCoordinateLayout(n,d,b,i.coordinatesOffset):y&&(E=positionLayout(i.positions,d,i.regionRelative));return{points:E}}_markerLayout(){var e,i,n,o,l,d,u,f;const g=this._getUpdateMarkerAttrs();if(this._spec.type==="type-step"){const _=this._startRelativeSeries,y=this._endRelativeSeries,{multiSegment:b,mainSegmentIndex:S}=this._spec.line||{},{connectDirection:v,expandDistance:A=0}=this._spec;let x;if(isPercent(A)){const w=_.getRegion(),B=w.getLayoutStartPoint(),I=y.getRegion(),D=I.getLayoutStartPoint();if(v==="bottom"||v==="top"){const O=Math.abs(Math.min(B.y,D.y)-Math.max(B.y+w.getLayoutRect().height,D.y+I.getLayoutRect().height));x=Number(A.substring(0,A.length-1))*O/100}else{const O=Math.abs(Math.min(B.x,D.x)-Math.max(B.x+w.getLayoutRect().width,D.x+I.getLayoutRect().width));x=Number(A.substring(0,A.length-1))*O/100}}else x=A;const{points:T,label:C,limitRect:E}=g,P=getInsertPoints(T[0],T[1],v,x);let R;R=b&&isValid(S)?{position:"middle",autoRotate:!1,refX:0,refY:0}:Object.assign(Object.assign({position:"start",autoRotate:!1},getTextOffset(T[0],T[1],v,x)),{refX:0,refY:0}),isValidNumber((e=this._spec.label)===null||e===void 0?void 0:e.refX)&&(R.refX+=this._spec.label.refX),isValidNumber((i=this._spec.label)===null||i===void 0?void 0:i.refY)&&(R.refY+=this._spec.label.refY),isValidNumber((n=this._spec.label)===null||n===void 0?void 0:n.dx)&&(R.dx=(R.dx||0)+this._spec.label.dx),isValidNumber((o=this._spec.label)===null||o===void 0?void 0:o.dy)&&(R.dy=(R.dy||0)+this._spec.label.dy);const L=(d=(l=this._markerComponent)===null||l===void 0?void 0:l.attribute)!==null&&d!==void 0?d:{};(u=this._markerComponent)===null||u===void 0||u.setAttributes({points:b?[[P[0],P[1]],[P[1],P[2]],[P[2],P[3]]]:P,label:Object.assign(Object.assign(Object.assign({},C),R),{textStyle:Object.assign(Object.assign({},L.label.textStyle),{textAlign:"center",textBaseline:"middle"})}),limitRect:E,multiSegment:b,mainSegmentIndex:S,dx:this._layoutOffsetX,dy:this._layoutOffsetY})}else(f=this._markerComponent)===null||f===void 0||f.setAttributes(g)}_computeOptions(){let e,i=this._getRelativeDataView(),n=!0,o=!1;const l=this._spec,d=this._relativeSeries,{doXProcess:u,doYProcess:f,doXYY1Process:g,doYXX1Process:_,doXYProcess:y,doCoordinatesProcess:b}=getMarkLineProcessInfo(l);if(y)e=[this._processSpecByDims([{dim:"x",specValue:l.x},{dim:"y",specValue:l.y}]),this._processSpecByDims([{dim:"x",specValue:l.x1},{dim:"y",specValue:l.y1}])];else if(u)e=[this._processSpecByDims([{dim:"x",specValue:l.x}])];else if(f)e=[this._processSpecByDims([{dim:"y",specValue:l.y}])];else if(g)e=[this._processSpecByDims([{dim:"x",specValue:l.x},{dim:"y",specValue:l.y}]),this._processSpecByDims([{dim:"x",specValue:l.x},{dim:"y",specValue:l.y1}])];else if(_)e=[this._processSpecByDims([{dim:"x",specValue:l.x},{dim:"y",specValue:l.y}]),this._processSpecByDims([{dim:"x",specValue:l.x1},{dim:"y",specValue:l.y}])];else if(b){if(e=this._processSpecCoo(l),n=!1,i=new DataView(this._option.dataSet,{name:`${this.type}_${this.id}_data`}).parse([d.getViewData()],{type:"dataview"}).transform({type:"markerAggregation",options:e}),l.process&&"x"in l.process&&(e=[this._processSpecByDims([{dim:"x",specValue:l.process.x}])],n=!0),l.process&&"y"in l.process&&(e=e=[this._processSpecByDims([{dim:"y",specValue:l.process.y}])],n=!0),l.process&&"xy"in l.process){const{xField:S,yField:v}=d.getSpec();e={fieldX:S,fieldY:v},o=!0}}else n=!1;return{options:e,needAggr:n,needRegr:o,processData:i}}}CartesianMarkLine.type=ComponentTypeEnum.markLine,CartesianMarkLine.coordinateType="cartesian";const registerMarkLine=()=>{Factory$1.registerComponent(CartesianMarkLine.type,CartesianMarkLine),registerMarkLineAnimate()};class PolarMarkLine extends BaseMarkLine{constructor(){super(...arguments),this.type=ComponentTypeEnum.polarMarkLine,this.name=ComponentTypeEnum.polarMarkLine,this.coordinateType="polar"}_newMarkLineComponent(e){const{doRadiusProcess:i,doRadAngAng1Process:n}=getMarkLineProcessInfo(this._spec);return i||n?new MarkArcLine(e):new MarkLine(e)}_computePointsAttr(){var e;const i=this._spec,n=this._markerData,o=this._startRelativeSeries,l=this._endRelativeSeries,d=this._relativeSeries,u=(e=i.autoRange)!==null&&e!==void 0&&e,{doAngleProcess:f,doRadiusProcess:g,doAngRadRad1Process:_,doRadAngAng1Process:y,doRadAngProcess:b,doCoordinatesProcess:S}=getMarkLineProcessInfo(i);let v=[],A={};const x={x:this._relativeSeries.getRegion().getLayoutStartPoint().x+this._relativeSeries.angleAxisHelper.center().x,y:this._relativeSeries.getRegion().getLayoutStartPoint().y+this._relativeSeries.angleAxisHelper.center().y};if(f||g||_||y||b){const T=polarLayout(n,o,l,d,u);v=T.length===1?T[0]:T.map(C=>C[0]),A=v[0].radius===v[1].radius?{radius:v[0].radius,startAngle:v[0].angle,endAngle:v[1].angle,center:x}:{points:v.map(C=>polarToCartesian(x,C.radius,C.angle))}}else S&&(v=polarCoordinateLayout(n,d,u),A={points:v.map(T=>polarToCartesian(x,T.radius,T.angle))});return A}_computeOptions(){const e=this._spec,{doAngleProcess:i,doRadiusProcess:n,doAngRadRad1Process:o,doRadAngAng1Process:l,doRadAngProcess:d,doCoordinatesProcess:u}=getMarkLineProcessInfo(e);let f;const g=this._getRelativeDataView();return d?f=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius1}])]:i?f=[this._processSpecByDims([{dim:"angle",specValue:e.angle}])]:n?f=[this._processSpecByDims([{dim:"radius",specValue:e.radius}])]:o?f=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius1}])]:l?f=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius}])]:u&&(f=this._processSpecCoo(e)),{options:f,needAggr:!0,needRegr:!1,processData:g}}}PolarMarkLine.type=ComponentTypeEnum.polarMarkLine,PolarMarkLine.coordinateType="polar";const registerPolarMarkLine=()=>{Factory$1.registerComponent(PolarMarkLine.type,PolarMarkLine),registerMarkArcLineAnimate(),registerMarkLineAnimate()};class Title extends BaseComponent{get orient(){return this._orient}constructor(e,i){super(e,i),this.type=ComponentTypeEnum.title,this.specKey=ComponentTypeEnum.title,this.layoutType="normal",this.layoutZIndex=LayoutZIndex.Title,this.layoutLevel=LayoutLevel.Title,this._orient="top",this._orient=isValidOrient(e.orient)?e.orient:"top"}initLayout(){super.initLayout(),this._layout&&(this._layout.layoutOrient=this._orient)}static getSpecInfo(e){return getSpecInfo(e,this.specKey,ComponentTypeEnum.title,i=>i.visible!==!1)}onRender(e){}_compareSpec(e,i){const n=super._compareSpec(e,i);return(i==null?void 0:i.orient)===(e==null?void 0:e.orient)&&(i==null?void 0:i.visible)===e.visible||(n.reMake=!0),n.change=!0,n.reRender=!0,n}changeRegions(e){}update(e){}resize(e){}afterSetLayoutStartPoint(e){isValidNumber(e.x)&&this._titleComponent&&this._titleComponent.setAttribute("x",e.x),isValidNumber(e.y)&&this._titleComponent&&this._titleComponent.setAttribute("y",e.y),super.afterSetLayoutStartPoint(e)}getBoundsInRect(e){let i={};this.setLayoutRect(e);const n=this._getTitleAttrs();this._createOrUpdateTitleComponent(n),i=this._getTitleLayoutRect();const{x:o,y:l}=this.getLayoutStartPoint();return{x1:o,y1:l,x2:o+i.width,y2:l+i.height}}_getTitleLayoutRect(){const e=this._titleComponent.AABBBounds;return{width:this._spec.width?this._spec.width:isValidNumber(e.width())?e.width():0,height:this._spec.height?this._spec.height:isValidNumber(e.height())?e.height():0}}_getTitleAttrs(){var e,i,n,o,l,d,u,f;if(this._spec.visible===!1)return{visible:!1};const g=this.getLayoutRect(),_=calcLayoutNumber(this._spec.width,g.width,null,g.width),y=calcLayoutNumber(this._spec.maxWidth,g.width,null,g.width),b=Math.max(Math.min(_,y,g.width),0),S=Object.assign(Object.assign({},pickWithout(this._spec,["padding"])),{textType:(e=this._spec.textType)!==null&&e!==void 0?e:"text",text:(i=this._spec.text)!==null&&i!==void 0?i:"",subtextType:(n=this._spec.subtextType)!==null&&n!==void 0?n:"text",subtext:(o=this._spec.subtext)!==null&&o!==void 0?o:"",x:(l=this._spec.x)!==null&&l!==void 0?l:0,y:(d=this._spec.y)!==null&&d!==void 0?d:0,height:this._spec.height,minWidth:this._spec.minWidth,maxWidth:b,minHeight:this._spec.minHeight,maxHeight:this._spec.maxHeight,padding:this._spec.innerPadding,align:(u=this._spec.align)!==null&&u!==void 0?u:"left",verticalAlign:(f=this._spec.verticalAlign)!==null&&f!==void 0?f:"top",textStyle:Object.assign({width:b,maxLineWidth:b},this._spec.textStyle),subtextStyle:Object.assign({maxLineWidth:b},this._spec.subtextStyle)});return isValid(this._spec.width)&&(S.textStyle.width=Math.max(_,g.width),S.subtextStyle.width=S.textStyle.width),S}_createOrUpdateTitleComponent(e){if(this._titleComponent)isEqual(e,this._cacheAttrs)||this._titleComponent.setAttributes(e);else{const i=this.getContainer(),n=new Title$1(e);n.name="title",i.add(n),this._titleComponent=n,n.on("*",(o,l)=>this._delegateEvent(n,o,l))}return this._cacheAttrs=e,this._titleComponent}_getNeedClearVRenderComponents(){return[this._titleComponent]}clear(){super.clear(),this._cacheAttrs=null}}Title.type=ComponentTypeEnum.title,Title.specKey=ComponentTypeEnum.title;const registerTitle=()=>{Factory$1.registerComponent(Title.type,Title)};class BaseMarkArea extends BaseMarker{constructor(){super(...arguments),this.specKey="markArea",this.layoutZIndex=LayoutZIndex.MarkArea}static _getMarkerCoordinateType(e){const{doAngleProcess:i,doRadiusProcess:n,doRadAngProcess:o}=getMarkAreaProcessInfo(e);return e.coordinateType==="polar"||i||n||o?"polar":"cartesian"}_createMarkerComponent(){var e,i,n,o,l,d,u,f,g,_,y,b;const S=(e=this._spec.label)!==null&&e!==void 0?e:{},v={zIndex:this.layoutZIndex,interactive:(i=this._spec.interactive)===null||i===void 0||i,hover:(n=this._spec.interactive)===null||n===void 0||n,select:(o=this._spec.interactive)===null||o===void 0||o,points:[{x:0,y:0}],center:{x:0,y:0},innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,areaStyle:transformStyle(transformToGraphic((l=this._spec.area)===null||l===void 0?void 0:l.style),this._markerData,this._markAttributeContext),clipInRange:(d=this._spec.clip)!==null&&d!==void 0&&d,label:transformLabelAttributes(S,this._markerData,this._markAttributeContext),state:{area:transformState((u=this._spec.area)===null||u===void 0?void 0:u.state,this._markerData,this._markAttributeContext),label:transformState((f=this._spec.label)===null||f===void 0?void 0:f.state,this._markerData,this._markAttributeContext),labelBackground:transformState((y=(_=(g=this._spec)===null||g===void 0?void 0:g.label)===null||_===void 0?void 0:_.labelBackground)===null||y===void 0?void 0:y.state,this._markerData,this._markAttributeContext)},animation:(b=this._spec.animation)!==null&&b!==void 0&&b,animationEnter:this._spec.animationEnter,animationExit:this._spec.animationExit,animationUpdate:this._spec.animationUpdate};return this._newMarkAreaComponent(v)}_markerLayout(){var e,i,n,o;const l=this._spec,d=this._markerData,u=this._startRelativeSeries,f=this._endRelativeSeries,g=this._relativeSeries,_=this._computePointsAttr(),y=this._getRelativeDataView().latestData,b=d?d.latestData[0]&&d.latestData[0].latestData?d.latestData[0].latestData:d.latestData:y;let S;if(l.clip||!((e=l.label)===null||e===void 0)&&e.confine){const{minX:v,maxX:A,minY:x,maxY:T}=computeClipRange([u.getRegion(),f.getRegion(),g.getRegion()]);S={x:v,y:x,width:A-v,height:T-x}}this._markerComponent&&this._markerComponent.setAttributes(Object.assign(Object.assign({},_),{label:Object.assign(Object.assign({},(i=this._markerComponent.attribute)===null||i===void 0?void 0:i.label),{text:this._spec.label.formatMethod?this._spec.label.formatMethod(b,y):(o=(n=this._markerComponent.attribute)===null||n===void 0?void 0:n.label)===null||o===void 0?void 0:o.text}),limitRect:S,dx:this._layoutOffsetX,dy:this._layoutOffsetY}))}_initDataView(){const e=this._spec,{doXProcess:i,doYProcess:n,doXYProcess:o,doAngleProcess:l,doRadiusProcess:d,doRadAngProcess:u,doCoordinatesProcess:f}=getMarkAreaProcessInfo(e);if(!(i||n||o||l||d||u||f))return null;this._initCommonDataView()}}BaseMarkArea.specKey="markArea";class CartesianMarkArea extends BaseMarkArea{constructor(){super(...arguments),this.type=ComponentTypeEnum.markArea,this.name=ComponentTypeEnum.markArea,this.coordinateType="cartesian"}_newMarkAreaComponent(e){return new MarkArea(e)}_computePointsAttr(){var e;const i=this._spec,n=this._markerData,o=this._startRelativeSeries,l=this._endRelativeSeries,d=this._relativeSeries,{doXProcess:u,doYProcess:f,doXYProcess:g,doCoordinatesProcess:_}=getMarkAreaProcessInfo(i),y=isValid(i.positions),b=(e=i.autoRange)!==null&&e!==void 0&&e;let S=[],v=[];if(g){v=xyLayout(n,o,l,d,b);const[A,x]=v;A&&A.length&&x&&x.length&&(S=[{x:A[0].x,y:x[0].y},A[0],{x:x[0].x,y:A[0].y},x[0]])}else if(u||f){v=xyLayout(n,o,l,d,b);const[A,x]=v;A&&A.length&&x&&x.length&&(S=[...A,x[1],x[0]])}else _?S=cartesianCoordinateLayout(n,d,b,i.coordinatesOffset):y&&(S=positionLayout(i.positions,d,i.regionRelative));return{points:S}}_computeOptions(){const e=this._spec,{doXProcess:i,doYProcess:n,doXYProcess:o,doCoordinatesProcess:l}=getMarkAreaProcessInfo(e);let d;return o?d=[this._processSpecByDims([{dim:"x",specValue:e.x},{dim:"y",specValue:e.y}]),this._processSpecByDims([{dim:"x",specValue:e.x1},{dim:"y",specValue:e.y1}])]:i?d=[this._processSpecByDims([{dim:"x",specValue:e.x}]),this._processSpecByDims([{dim:"x",specValue:e.x1}])]:n?d=[this._processSpecByDims([{dim:"y",specValue:e.y}]),this._processSpecByDims([{dim:"y",specValue:e.y1}])]:l&&(d=this._processSpecCoo(e)),{options:d}}}CartesianMarkArea.type=ComponentTypeEnum.markArea,CartesianMarkArea.coordinateType="cartesian";const registerMarkArea=()=>{Factory$1.registerComponent(CartesianMarkArea.type,CartesianMarkArea),registerMarkAreaAnimate()};class PolarMarkArea extends BaseMarkArea{constructor(){super(...arguments),this.type=ComponentTypeEnum.polarMarkArea,this.name=ComponentTypeEnum.polarMarkArea,this.coordinateType="polar"}_newMarkAreaComponent(e){const{doRadiusProcess:i,doAngleProcess:n,doRadAngProcess:o}=getMarkAreaProcessInfo(this._spec);return n||i||o?new MarkArcArea(e):new MarkArea(e)}_computePointsAttr(){var e;const i=this._spec,n=this._markerData,o=this._startRelativeSeries,l=this._endRelativeSeries,d=this._relativeSeries,{doAngleProcess:u,doRadiusProcess:f,doRadAngProcess:g,doCoordinatesProcess:_}=getMarkAreaProcessInfo(i),y=(e=i.autoRange)!==null&&e!==void 0&&e;let b,S={};const v={x:this._relativeSeries.getRegion().getLayoutStartPoint().x+this._relativeSeries.angleAxisHelper.center().x,y:this._relativeSeries.getRegion().getLayoutStartPoint().y+this._relativeSeries.angleAxisHelper.center().y};if(u||f||g){const A=polarLayout(n,o,l,d,y);g?S={innerRadius:A[0][0].radius,outerRadius:A[1][0].radius,startAngle:A[0][0].angle,endAngle:A[1][0].angle,center:v}:u?S={innerRadius:0,outerRadius:Math.abs(A[0][0].radius),startAngle:A[0][1].angle,endAngle:A[1][1].angle,center:v}:f&&(S={innerRadius:A[0][0].radius,outerRadius:A[1][0].radius,startAngle:A[0][0].angle,endAngle:A[1][1].angle,center:v})}else _&&(b=polarCoordinateLayout(n,d,y),S={points:b.map(A=>polarToCartesian(v,A.radius,A.angle))});return S}_computeOptions(){const e=this._spec,{doAngleProcess:i,doRadiusProcess:n,doRadAngProcess:o,doCoordinatesProcess:l}=getMarkAreaProcessInfo(e);let d;return o?d=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius1}])]:i?d=[this._processSpecByDims([{dim:"angle",specValue:e.angle},{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"angle",specValue:e.angle1},{dim:"radius",specValue:e.radius}])]:n?d=[this._processSpecByDims([{dim:"radius",specValue:e.radius}]),this._processSpecByDims([{dim:"radius",specValue:e.radius1}])]:l&&(d=this._processSpecCoo(e)),{options:d}}}PolarMarkArea.type=ComponentTypeEnum.polarMarkArea,PolarMarkArea.coordinateType="polar";const registerPolarMarkArea=()=>{Factory$1.registerComponent(PolarMarkArea.type,PolarMarkArea),registerMarkArcAreaAnimate(),registerMarkAreaAnimate()},rectToAttribute=r=>{const e=Object.assign({},r);return transformToGraphic(e)},symbolToAttribute=r=>{const e=Object.assign({},r);return transformToGraphic(e)},baseToAttribute=r=>Object.assign(Object.assign({},r),{style:Object.assign({},transformToGraphic(r.style))}),transformToAttrs=r=>{var e,i,n,o,l,d,u,f,g,_,y,b,S,v,A;const x=rectToAttribute((i=(e=r==null?void 0:r.slider)===null||e===void 0?void 0:e.trackStyle)!==null&&i!==void 0?i:{}),T=rectToAttribute((o=(n=r==null?void 0:r.slider)===null||n===void 0?void 0:n.railStyle)!==null&&o!==void 0?o:{}),C=symbolToAttribute((d=(l=r==null?void 0:r.slider)===null||l===void 0?void 0:l.handlerStyle)!==null&&d!==void 0?d:{}),E=baseToAttribute((f=(u=r==null?void 0:r.controller)===null||u===void 0?void 0:u.start)!==null&&f!==void 0?f:{}),P=baseToAttribute((_=(g=r==null?void 0:r.controller)===null||g===void 0?void 0:g.pause)!==null&&_!==void 0?_:{}),R=baseToAttribute((b=(y=r==null?void 0:r.controller)===null||y===void 0?void 0:y.backward)!==null&&b!==void 0?b:{}),L=baseToAttribute((v=(S=r==null?void 0:r.controller)===null||S===void 0?void 0:S.forward)!==null&&v!==void 0?v:{}),w=Object.assign(Object.assign({},r),{direction:r.direction,interval:r.interval,visible:r.visible,orient:(A=r.orient)!==null&&A!==void 0?A:"bottom",slider:Object.assign(Object.assign({},r.slider),{trackStyle:x,railStyle:T,handlerStyle:C}),controller:Object.assign(Object.assign({},r.controller),{start:E,pause:P,backward:R,forward:L})});return r.visible||(w.controller.visible=!1,w.slider.visible=!1),w},transformContinuousSpecToAttrs=(r,e)=>Object.assign(Object.assign({},transformToAttrs(r)),{data:e,type:"continuous"}),transformDiscreteSpecToAttrs=(r,e)=>Object.assign(Object.assign({},transformToAttrs(r)),{data:e,type:"discrete"}),isVertical=r=>r==="left"||r==="right",isHorizontal=r=>r==="top"||r==="bottom";class Player extends BaseComponent{constructor(){super(...arguments),this.layoutZIndex=LayoutZIndex.Player,this.layoutLevel=LayoutLevel.Player,this.specKey="player",this.type=ComponentTypeEnum.player,this._orient="bottom",this._getPlayerAttrs=()=>{var e,i,n,o,l,d;const u=this._spec.type,f={size:{width:this._width,height:this._height},dx:(e=this._spec.dx)!==null&&e!==void 0?e:0+this._dx,dy:(i=this._spec.dy)!==null&&i!==void 0?i:0+this._dy};return u==="discrete"?Object.assign(Object.assign(Object.assign({},transformDiscreteSpecToAttrs(this._spec,this._specs)),f),{disableTriggerEvent:this._option.disableTriggerEvent,loop:(o=(n=this._spec)===null||n===void 0?void 0:n.loop)===null||o===void 0||o}):Object.assign(Object.assign(Object.assign({},transformContinuousSpecToAttrs(this._spec,this._specs)),f),{disableTriggerEvent:this._option.disableTriggerEvent,loop:(d=(l=this._spec)===null||l===void 0?void 0:l.loop)===null||d===void 0||d})},this._createOrUpdatePlayerComponent=()=>{const e=Object.assign({},this._getPlayerAttrs()),i=this.getContainer();this._playerComponent?isEqual(e,this._cacheAttrs)||(this._cacheAttrs=e,this._playerComponent.setAttributes(e),this._playerComponent._initAttributes(),this._playerComponent.render()):(e.type==="discrete"?this._playerComponent=new DiscretePlayer(e):this._playerComponent=new ContinuousPlayer(e),this._cacheAttrs=e,this._playerComponent.name="player",i.add(this._playerComponent),this._initEvent())},this._maxSize=()=>{var e,i,n,o,l,d,u,f,g;return Math.max(...array((i=(e=this._spec.controller.start)===null||e===void 0?void 0:e.style)===null||i===void 0?void 0:i.size),...array((o=(n=this._spec.controller.pause)===null||n===void 0?void 0:n.style)===null||o===void 0?void 0:o.size),...array((d=(l=this._spec.controller.backward)===null||l===void 0?void 0:l.style)===null||d===void 0?void 0:d.size),...array((f=(u=this._spec.controller.forward)===null||u===void 0?void 0:u.style)===null||f===void 0?void 0:f.size),(g=isVertical(this._orient)?this._spec.slider.railStyle.width:this._spec.slider.railStyle.height)!==null&&g!==void 0?g:10)},this._sliderExceededSize=()=>{var e,i,n,o,l,d,u,f,g;const _=(e=isVertical(this._orient)?this._spec.slider.railStyle.width:this._spec.slider.railStyle.height)!==null&&e!==void 0?e:10,y=Math.max(...array((n=(i=this._spec.controller.start)===null||i===void 0?void 0:i.style)===null||n===void 0?void 0:n.size),...array((l=(o=this._spec.controller.pause)===null||o===void 0?void 0:o.style)===null||l===void 0?void 0:l.size),...array((u=(d=this._spec.controller.backward)===null||d===void 0?void 0:d.style)===null||u===void 0?void 0:u.size),...array((g=(f=this._spec.controller.forward)===null||f===void 0?void 0:f.style)===null||g===void 0?void 0:g.size));return _>=y?_-y:0},this._initEvent=()=>{this._option.disableTriggerEvent||(this._option.globalInstance.on(ChartEvent.rendered,()=>{var e;!((e=this._spec)===null||e===void 0)&&e.auto&&this._playerComponent.play()}),this._playerComponent.addEventListener(PlayerEventEnum.end,()=>{var e;this.event.emit(ChartEvent.playerEnd,{model:this}),this._alternate&&this._spec.type==="discrete"&&(this._direction=this._direction==="default"?"reverse":"default",this._playerComponent.setAttributes({direction:this._direction,dataIndex:this._direction==="reverse"?this._specs.length-2:1})),!((e=this._spec)===null||e===void 0)&&e.loop&&this._playerComponent.play()}),this._playerComponent.addEventListener(PlayerEventEnum.change,e=>{const{index:i}=e.detail;this.changePlayerIndex(i)}),this._playerComponent.addEventListener(PlayerEventEnum.backward,e=>{const{index:i}=e.detail,n=this._specs[i];this.event.emit(ChartEvent.playerBackward,{model:this,value:{spec:n,index:i,specs:this._specs}})}),this._playerComponent.addEventListener(PlayerEventEnum.forward,e=>{const{index:i}=e.detail,n=this._specs[i];this.event.emit(ChartEvent.playerForward,{model:this,value:{spec:n,index:i,specs:this._specs}})}),this._playerComponent.addEventListener(PlayerEventEnum.play,e=>{const{index:i}=e.detail,n=this._specs[i];this.event.emit(ChartEvent.playerPlay,{model:this,value:{spec:n,index:i,specs:this._specs}})}),this._playerComponent.addEventListener(PlayerEventEnum.pause,e=>{const{index:i}=e.detail,n=this._specs[i];this.event.emit(ChartEvent.playerPause,{model:this,value:{spec:n,index:i,specs:this._specs}})}))}}get orient(){return this._orient}set layoutOrient(e){this._orient=e}setAttrFromSpec(){var e,i,n,o,l,d,u,f;super.setAttrFromSpec(),this._orient=(e=this._spec.orient)!==null&&e!==void 0?e:"bottom",this._specs=(i=this._spec.specs)!==null&&i!==void 0?i:[],this._direction=(n=this._spec.direction)!==null&&n!==void 0?n:"default",this._alternate=(o=this._spec.alternate)!==null&&o!==void 0&&o,this._dx=(l=this._spec.dx)!==null&&l!==void 0?l:0,this._dy=(d=this._spec.dy)!==null&&d!==void 0?d:0,this._position=(u=this._spec.position)!==null&&u!==void 0?u:"middle",this._visible=(f=this._spec.visible)===null||f===void 0||f}afterSetLayoutStartPoint(e){if(super.afterSetLayoutStartPoint(e),isValidNumber(e.x)){const i=isVertical(this._orient)?e.x+this._sliderExceededSize()/2:e.x;this._playerComponent&&this._playerComponent.setAttribute("x",i)}if(isValidNumber(e.y)){const i=isHorizontal(this._orient)?e.y+this._sliderExceededSize()/2:e.y;this._playerComponent&&this._playerComponent.setAttribute("y",i)}}getBoundsInRect(e,i){this._width=this._computeWidth(e),this._height=this._computeHeight(e),this._dx=this._computeDx(i),this._dy=this._computeDy(i);const n=this._computeLayoutRect(e,this._width,this._height);return this._createOrUpdatePlayerComponent(),n}changeRegions(e){}onRender(e){}_getNeedClearVRenderComponents(){return[this._playerComponent]}_computeLayoutRect(e,i,n){if(this._visible===!1)return{x1:0,x2:0,y1:0,y2:0};switch(this._orient){case"top":case"left":return{x1:0,y1:0,x2:i,y2:n};case"right":return{x1:e.width-i,y1:0,x2:e.width,y2:e.height};default:return{x1:0,y1:e.height-n,x2:e.width,y2:e.height}}}_computeWidth(e){return isNumber(this._spec.width)?Math.min(e.width,Number(this._spec.width)):isVertical(this._orient)?this._maxSize():e.width}_computeHeight(e){return isNumber(this._spec.height)?(this._height=this._spec.height,Math.min(e.height,Number(this._spec.height))):isHorizontal(this._orient)?this._maxSize():e.height}_computeDx(e){return isVertical(this._orient)||this._position==="start"?0:this._position==="middle"?(e.width-this._width)/2:e.width-this._width}_computeDy(e){return isHorizontal(this._orient)||this._position==="start"?0:this._position==="middle"?(e.height-this._height)/2:e.height-this._height}changePlayerIndex(e){const i=this._specs[e];array(i.data).forEach(n=>{var o,l;(l=(o=this._option)===null||o===void 0?void 0:o.globalInstance)===null||l===void 0||l.updateData(n.id,n.values)}),this.event.emit(ChartEvent.playerChange,{model:this,value:{spec:i,index:e,specs:this._specs}})}}Player.specKey="player",Player.type=ComponentTypeEnum.player;const registerPlayer=()=>{Factory$1.registerComponent(Player.type,Player)};class BaseLabelComponent extends BaseComponent{constructor(e,i){super(e,i),this.type=ComponentTypeEnum.label,this.name=ComponentTypeEnum.label,this.layoutType="none",this.layoutZIndex=LayoutZIndex.Label,this._regions=i.getRegionsInIndex(i.regionIndexes)}_interactiveConfig(e){const{interactive:i}=e,n={hover:!1,select:!1,state:e.state};if(i!==!0)return n;const{hover:o,select:l}=this._option.getChart().getSpec();return o===!1&&o.enable===!1||(n.hover=!0),l===!1&&l.enable===!1||(n.select=!0),n}_compareSpec(e,i){const n=super._compareSpec(e,i);return n.reRender=!0,isEqual(i,e)||(n.reMake=!0),n}onRender(e){}changeRegions(e){}_getNeedClearVRenderComponents(){return[]}}BaseLabelComponent.type=ComponentTypeEnum.label;class LabelMark extends TextMark{constructor(){super(...arguments),this.skipEncode=!1}getRule(){return this._rule}setRule(e){this._rule=e}getTarget(){return this._target}setTarget(e){this._target=e,this._rule||this.setRule(e.type)}getComponent(){return this._component}setComponent(e){this._component=e}}LabelMark.type="text",LabelMark.constructorType="label";const registerLabelMark=()=>{Factory$1.registerMark(LabelMark.constructorType,LabelMark),registerTextGraphic()};class LabelSpecTransformer extends BaseComponentSpecTransformer{_initTheme(e,i){return{spec:e,theme:this._theme}}}class Label extends BaseLabelComponent{constructor(e,i){super(e,i),this.type=ComponentTypeEnum.label,this.name=ComponentTypeEnum.label,this.specKey="label",this.transformerConstructor=LabelSpecTransformer,this.layoutZIndex=LayoutZIndex.Label,this._layoutRule=e.labelLayout||"series"}static getSpecInfo(e,i){const n=[];return((i==null?void 0:i.region)||[]).forEach((l,d)=>{(l.seriesIndexes||[]).some(u=>{const f=i.series[u],{markLabelSpec:g={}}=f;return Object.values(g).some(_=>Array.isArray(_)&&(y=>y.some(b=>b.visible))(_))})&&n.push({spec:e,type:ComponentTypeEnum.label,specInfoPath:["component",this.specKey,d],regionIndexes:[d]})}),n}init(e){super.init(e),this.initEvent(),this._initTextMark(),this._initLabelComponent(),this._initTextMarkStyle()}reInit(e){super.reInit(e),this._labelInfoMap&&this._labelInfoMap.clear(),this._initTextMark(),this._initTextMarkStyle()}initEvent(){this.event.on(ChartEvent.dataZoomChange,()=>{this._labelComponentMap.forEach((i,n)=>{const o=n.getProduct().getGroupGraphicItem();o&&o.disableAnimation()}),this.event.on(HOOK_EVENT.AFTER_MARK_RENDER_END,e)});const e=()=>{this._labelComponentMap.forEach((i,n)=>{const o=n.getProduct().getGroupGraphicItem();o&&o.enableAnimation()}),this.event.off(HOOK_EVENT.AFTER_MARK_RENDER_END,e)}}_initTextMark(){this._labelInfoMap||(this._labelInfoMap=new Map),this._labelComponentMap||(this._labelComponentMap=new Map),eachSeries(this._regions,e=>{const{markLabelSpec:i={}}=e.getSpecInfo(),n=Object.keys(i),o=e.getRegion();this._labelInfoMap.get(o)||this._labelInfoMap.set(o,[]);for(let l=0;l<n.length;l++){const d=n[l],u=e.getMarkInName(d);u&&i[d].forEach((f,g)=>{if(f.visible){const _=this._labelInfoMap.get(o),y=this._createMark({type:"label",name:`${d}-label-${g}`},{noSeparateStyle:!0,attributeContext:e.getMarkAttributeContext()});y.setTarget(u),_.push({labelMark:y,baseMark:u,series:e,labelSpec:f})}})}})}_initLabelComponent(){this._labelInfoMap.forEach((e,i)=>{if(this._layoutRule==="region"){const n=this._createMark({type:"component",name:`${i.getGroupMark().name}-label-component`},{componentType:"label",noSeparateStyle:!0},{support3d:this._spec.support3d});n&&(n.setSkipBeforeLayouted(!0),e[0]&&isValid(e[0].labelSpec.zIndex)&&n.setMarkConfig({zIndex:e[0].labelSpec.zIndex}),this._marks.addMark(n),this._labelComponentMap.set(n,()=>this._labelInfoMap.get(i)))}else e.forEach((n,o)=>{const l=this._createMark({type:"component",name:`${n.labelMark.name}-component`},{componentType:"label",noSeparateStyle:!0},{support3d:n.baseMark.getMarkConfig().support3d});l&&(isValid(n.labelSpec.zIndex)&&l.setMarkConfig({zIndex:n.labelSpec.zIndex}),l.setSkipBeforeLayouted(!0),this._marks.addMark(l),this._labelComponentMap.set(l,()=>this._labelInfoMap.get(i)[o]))})})}_initTextMarkStyle(){this._labelComponentMap.forEach((e,i)=>{array(e()).forEach(({labelMark:n})=>{n.setComponent(i)})}),this._labelInfoMap.forEach(e=>{e.forEach(i=>{var n,o;const{labelMark:l,labelSpec:d,series:u}=i;if(this.initMarkStyleWithSpec(l,d,void 0),isFunction(d==null?void 0:d.getStyleHandler)){const f=d.getStyleHandler(u);f==null||f.call(u,l,d)}!((o=(n=l.stateStyle)===null||n===void 0?void 0:n.normal)===null||o===void 0)&&o.lineWidth&&l.setAttribute("stroke",u.getColorAttribute(),"normal",AttributeLevel.Base_Series)})})}updateLayoutAttribute(){super.updateLayoutAttribute(),this._labelComponentMap.forEach((e,i)=>{const n=e();isArray(n)?this._updateMultiLabelAttribute(n,i):this._updateSingleLabelAttribute(n,i)})}_updateMultiLabelAttribute(e,i){this._updateLabelComponentAttribute(i.getProduct(),e.map(({baseMark:n})=>n.getProduct()),e)}_updateSingleLabelAttribute(e,i){const{baseMark:n}=e;this._updateLabelComponentAttribute(i.getProduct(),n.getProduct(),[e])}_updateLabelComponentAttribute(e,i,n){const o=this._option.getComponentsByType("totalLabel");e.target(i).configure({interactive:!1}).depend(o.map(l=>l.getMarks()[0].getProduct())).labelStyle((l,d)=>{var u,f;const g=n[d.labelIndex];if(g){const{labelSpec:_,labelMark:y,series:b}=g,S=y.getRule(),v=this._interactiveConfig(_),A=(f=(u=this._spec)===null||u===void 0?void 0:u.centerOffset)!==null&&f!==void 0?f:0;let x=mergeSpec({textStyle:Object.assign({pickable:_.interactive===!0},_.style),overlap:{avoidMarks:o.map(T=>T.getMarks()[0].getProductId())}},defaultLabelConfig(S,g),Object.assign(Object.assign(Object.assign({},pickWithout(_,["position","style","state","type","stackDataFilterType","getStyleHandler"])),v),{centerOffset:A}),_.stackDataFilterType?{dataFilter:_.stackDataFilterType==="min"?T=>T.filter(C=>C.data[STACK_FIELD_TOTAL_BOTTOM]):T=>T.filter(C=>C.data[STACK_FIELD_TOTAL_TOP])}:{});return b&&b.parseLabelStyle&&(x=b.parseLabelStyle(x,_,y)),S!=="line"&&S!=="area"||(x.type=S),x}}).encode((l,d,u)=>{if(n[u.labelIndex]){const{labelSpec:f,labelMark:g}=n[u.labelIndex];return g.skipEncode?{data:l}:textAttribute(n[u.labelIndex],l,f.formatMethod,f.formatter)}}).size(()=>n[0].series.getRegion().getLayoutRect())}compileMarks(){this.getMarks().forEach(e=>{const i=this._labelComponentMap.get(e)();let n;n=isArray(i)?i[0].series.getRegion().getGroupMark().getProduct():i.series.getRegion().getGroupMark().getProduct(),e.compile({group:n,context:{model:this,labelInfo:i}})})}getVRenderComponents(){const e=[];return this._labelComponentMap.forEach((i,n)=>{const o=n.getProduct().getGroupGraphicItem();o&&e.push(o)}),e}}Label.type=ComponentTypeEnum.label,Label.specKey="label",Label.transformerConstructor=LabelSpecTransformer;const registerLabel=()=>{registerLabel$1(),registerLabelMark(),registerComponentMark(),Factory$1.registerComponent(Label.type,Label,!0)};class TotalLabel extends BaseLabelComponent{constructor(){super(...arguments),this.type=ComponentTypeEnum.totalLabel,this.name=ComponentTypeEnum.totalLabel,this.specKey="totalLabel",this.layoutZIndex=LayoutZIndex.Label}static getSpecInfo(e,i){var n;const o=[];return(n=i==null?void 0:i.region)===null||n===void 0||n.forEach((l,d)=>{var u;(u=l.seriesIndexes)===null||u===void 0||u.forEach(f=>{const{spec:g}=i.series[f],_=g[this.specKey];_!=null&&_.visible&&o.push({spec:_,type:ComponentTypeEnum.totalLabel,specPath:["series",f,this.specKey],specInfoPath:["component",this.specKey,f],regionIndexes:[d],seriesIndexes:[f]})})}),o}init(e){super.init(e),this._initTextMark(),this._initLabelComponent()}reInit(e){super.reInit(e),this._initTextMark()}_initTextMark(){var e;const i=this._getSeries();if(!((e=i.getSpec().totalLabel)===null||e===void 0)&&e.visible){const n=i.getSeriesMark();if(n){const o=this._createMark({type:"label",name:`${n.name}-total-label`});this._baseMark=n,this._textMark=o,this._initTextMarkStyle()}}}_initTextMarkStyle(){var e;super.initMarkStyleWithSpec(this._textMark,this._spec),this.setMarkStyle(this._textMark,{text:n=>n[STACK_FIELD_TOTAL]},"normal",AttributeLevel.Default);const i=this._getSeries();(e=i.initTotalLabelMarkStyle)===null||e===void 0||e.call(i,this._textMark)}_initLabelComponent(){const e=this._getSeries(),i=this._createMark({type:"component",name:`${e.name}-total-label-component`},{componentType:"label",noSeparateStyle:!0},{support3d:this._spec.support3d});i&&this._marks.addMark(i)}updateLayoutAttribute(){super.updateLayoutAttribute();const e=this._getSeries();this._marks.forEach((i,n)=>{i.getProduct().target(this._baseMark.getProduct()).configure({interactive:!1}).labelStyle(()=>{var o,l;if(this._baseMark){const{offset:d,animation:u,overlap:f}=this._spec,g=this._interactiveConfig(this._spec);return mergeSpec({textStyle:{pickable:this._spec.interactive===!0},position:totalLabelPosition(e,this._baseMark.type),x:0,y:0},(l=(o=e.getTotalLabelComponentStyle)===null||o===void 0?void 0:o.call(e,{baseMark:this._baseMark,labelMark:this._textMark}))!==null&&l!==void 0?l:{},Object.assign({offset:d,animation:u,overlap:f,dataFilter:_=>_.filter(y=>y.data[STACK_FIELD_TOTAL_TOP])},g))}}).encode(o=>textAttribute({baseMark:this._baseMark,labelMark:this._textMark,series:e,labelSpec:e.getSpec().totalLabel},o,this._spec.formatMethod)).size(()=>this._regions[0].getLayoutRect())})}compileMarks(){this.getMarks().forEach(e=>{const i=this._regions[0].getGroupMark().getProduct();e.compile({group:i,context:{model:this}})})}getVRenderComponents(){const e=[];return this.getMarks().forEach(i=>{const n=i.getProduct().getGroupGraphicItem();n&&e.push(n)}),e}_getSeries(){return this._option.getSeriesInIndex([this.getSpecPath()[1]])[0]}}TotalLabel.type=ComponentTypeEnum.totalLabel,TotalLabel.specKey="totalLabel";function totalLabelPosition(r,e){var i,n;let o;const{direction:l}=r,d={vertical:["top","bottom"],horizontal:["right","left"]},u=(l==="horizontal"?!((i=r.getXAxisHelper())===null||i===void 0)&&i.isInverse():!((n=r.getYAxisHelper())===null||n===void 0)&&n.isInverse())?1:0;switch(e){case"rect":case"symbol":o=d[l][u];break;default:o="top"}return o}const registerTotalLabel=()=>{registerLabel$1(),registerLabelMark(),registerComponentMark(),Factory$1.registerComponent(TotalLabel.type,TotalLabel,!0)};var __rest=function(r,e){var i={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(i[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function"){var o=0;for(n=Object.getOwnPropertySymbols(r);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(r,n[o])&&(i[n[o]]=r[n[o]])}return i};class BaseMarkPoint extends BaseMarker{constructor(){super(...arguments),this.specKey="markPoint",this.layoutZIndex=LayoutZIndex.MarkPoint}static _getMarkerCoordinateType(e){const{doPolarProcess:i,doGeoProcess:n}=getMarkPointProcessInfo(e);return e.coordinateType==="polar"||i?"polar":e.coordinateType==="geo"||n?"geo":"cartesian"}_createMarkerComponent(){var e,i,n,o,l,d,u,f,g,_,y,b,S,v,A,x,T,C,E,P,R,L,w,B,I,D,O,N;const{itemContent:V={},itemLine:H={},targetSymbol:F={}}=this._spec,{text:$={},symbol:G,image:Y,richText:Q}=V,q=__rest(V,["text","symbol","image","richText"]),te={zIndex:this.layoutZIndex,interactive:(e=this._spec.interactive)===null||e===void 0||e,hover:(i=this._spec.interactive)===null||i===void 0||i,select:(n=this._spec.interactive)===null||n===void 0||n,position:{x:0,y:0},clipInRange:(o=this._spec.clip)!==null&&o!==void 0&&o,itemContent:Object.assign({offsetX:transformOffset(V.offsetX,this._relativeSeries.getRegion()),offsetY:transformOffset(V.offsetX,this._relativeSeries.getRegion())},q),targetSymbol:{offset:(l=F.offset)!==null&&l!==void 0?l:0,visible:(d=F.visible)!==null&&d!==void 0&&d,size:(u=F.size)!==null&&u!==void 0?u:20,style:transformStyle(F.style,this._markerData,this._markAttributeContext)},state:{line:transformState((g=(f=this._spec.itemLine.line)===null||f===void 0?void 0:f.state)!==null&&g!==void 0?g:{},this._markerData,this._markAttributeContext),lineStartSymbol:transformState((y=(_=this._spec.itemLine.startSymbol)===null||_===void 0?void 0:_.state)!==null&&y!==void 0?y:{},this._markerData,this._markAttributeContext),lineEndSymbol:transformState((S=(b=this._spec.itemLine.endSymbol)===null||b===void 0?void 0:b.state)!==null&&S!==void 0?S:{},this._markerData,this._markAttributeContext),symbol:transformState((A=(v=this._spec.itemContent.symbol)===null||v===void 0?void 0:v.state)!==null&&A!==void 0?A:{},this._markerData,this._markAttributeContext),image:transformState((T=(x=this._spec.itemContent.image)===null||x===void 0?void 0:x.state)!==null&&T!==void 0?T:{},this._markerData,this._markAttributeContext),text:transformState((E=(C=this._spec.itemContent.text)===null||C===void 0?void 0:C.state)!==null&&E!==void 0?E:{},this._markerData,this._markAttributeContext),textBackground:transformState((R=(P=this._spec.itemContent.text)===null||P===void 0?void 0:P.labelBackground)===null||R===void 0?void 0:R.state,this._markerData,this._markAttributeContext),richText:transformState((w=(L=this._spec.itemContent.richText)===null||L===void 0?void 0:L.state)!==null&&w!==void 0?w:{},this._markerData,this._markAttributeContext),customMark:transformState((I=(B=this._spec.itemContent.customMark)===null||B===void 0?void 0:B.state)!==null&&I!==void 0?I:{},this._markerData,this._markAttributeContext),targetItem:transformState((O=(D=this._spec.targetSymbol)===null||D===void 0?void 0:D.state)!==null&&O!==void 0?O:{},this._markerData,this._markAttributeContext)},animation:(N=this._spec.animation)!==null&&N!==void 0&&N,animationEnter:this._spec.animationEnter,animationExit:this._spec.animationExit,animationUpdate:this._spec.animationUpdate};G!=null&&G.style&&(te.itemContent.symbolStyle=transformToGraphic(transformStyle(G.style,this._markerData,this._markAttributeContext))),Y!=null&&Y.style&&(te.itemContent.imageStyle=transformStyle(Y.style,this._markerData,this._markAttributeContext)),$&&(te.itemContent.textStyle=transformLabelAttributes($,this._markerData,this._markAttributeContext)),Q!=null&&Q.style&&(te.itemContent.richTextStyle=transformStyle(Q.style,this._markerData,this._markAttributeContext));const{visible:ue,line:he={}}=H,fe=__rest(H,["visible","line"]);return te.itemLine=ue!==!1?Object.assign(Object.assign({},fe),{visible:!0,lineStyle:transformToGraphic(he.style)}):{visible:!1},new MarkPoint(te)}_markerLayout(){var e,i,n,o,l;const d=this._spec,u=this._markerData,f=this._relativeSeries,{point:g}=this._computePointsAttr(),_=this._getRelativeDataView().latestData,y=u?u.latestData[0]&&u.latestData[0].latestData?u.latestData[0].latestData:u.latestData:_;let b;if(d.clip||!((e=d.itemContent)===null||e===void 0)&&e.confine){const{minX:S,maxX:v,minY:A,maxY:x}=computeClipRange([f.getRegion()]);b={x:S,y:A,width:v-S,height:x-A}}if(this._markerComponent){const S=(i=this._markerComponent.attribute)!==null&&i!==void 0?i:{},v=(o=(n=S.itemContent)===null||n===void 0?void 0:n.textStyle)!==null&&o!==void 0?o:{};this._markerComponent.setAttributes({position:g===void 0?{x:null,y:null}:g,itemContent:Object.assign(Object.assign({},S.itemContent),{textStyle:Object.assign(Object.assign({},v),{text:!((l=this._spec.itemContent.text)===null||l===void 0)&&l.formatMethod?this._spec.itemContent.text.formatMethod(y,_):v.text}),offsetX:computeOffsetFromRegion(g,S.itemContent.offsetX,this._relativeSeries.getRegion()),offsetY:computeOffsetFromRegion(g,S.itemContent.offsetY,this._relativeSeries.getRegion())}),limitRect:b,dx:this._layoutOffsetX,dy:this._layoutOffsetY})}}_initDataView(){const e=this._spec,{doXYProcess:i,doPolarProcess:n,doGeoProcess:o}=getMarkPointProcessInfo(e);(isValid(e.coordinate)||i||n||o)&&this._initCommonDataView()}}BaseMarkPoint.specKey="markPoint";class CartesianMarkPoint extends BaseMarkPoint{constructor(){super(...arguments),this.type=ComponentTypeEnum.markPoint,this.name=ComponentTypeEnum.markPoint,this.coordinateType="cartesian"}_computePointsAttr(){var e;const i=this._spec,n=this._markerData,o=this._relativeSeries,l="x"in i&&"y"in i,d="coordinate"in i,u="position"in i,f=(e=i==null?void 0:i.autoRange)!==null&&e!==void 0&&e;let g;return l?g=xyLayout(n,o,o,o,f)[0][0]:d?g=cartesianCoordinateLayout(n,o,f,i.coordinatesOffset)[0]:u&&(g=positionLayout(i.position,o,i.regionRelative)[0]),{point:g}}_computeOptions(){const e=this._spec,{doXYProcess:i}=getMarkPointProcessInfo(e),n=isValid(e.coordinate);let o;return i?o=[this._processSpecByDims([{dim:"x",specValue:e.x},{dim:"y",specValue:e.y}])]:n&&(o=this._processSpecCoo(e)),{options:o}}}CartesianMarkPoint.type=ComponentTypeEnum.markPoint,CartesianMarkPoint.coordinateType="cartesian";const registerMarkPoint=()=>{Factory$1.registerComponent(CartesianMarkPoint.type,CartesianMarkPoint),registerMarkPointAnimate()};class PolarMarkPoint extends BaseMarkPoint{constructor(){super(...arguments),this.type=ComponentTypeEnum.polarMarkPoint,this.name=ComponentTypeEnum.polarMarkPoint,this.coordinateType="polar"}_computePointsAttr(){var e,i;const n=this._markerData,o=this._relativeSeries,l=(i=(e=this._spec)===null||e===void 0?void 0:e.autoRange)!==null&&i!==void 0&&i,d=polarLayout(n,o,o,o,l)[0][0],u={x:this._relativeSeries.getRegion().getLayoutStartPoint().x+this._relativeSeries.angleAxisHelper.center().x,y:this._relativeSeries.getRegion().getLayoutStartPoint().y+this._relativeSeries.angleAxisHelper.center().y};return{point:polarToCartesian(u,d.radius,d.angle)}}_computeOptions(){const e=this._spec;return{options:[this._processSpecByDims([{dim:"radius",specValue:e.radius},{dim:"angle",specValue:e.angle}])]}}}PolarMarkPoint.type=ComponentTypeEnum.polarMarkPoint,PolarMarkPoint.coordinateType="polar";const registerPolarMarkPoint=()=>{Factory$1.registerComponent(PolarMarkPoint.type,PolarMarkPoint),registerMarkPointAnimate()};class GeoMarkPoint extends BaseMarkPoint{constructor(){super(...arguments),this.type=ComponentTypeEnum.geoMarkPoint,this.name=ComponentTypeEnum.geoMarkPoint,this.coordinateType="geo"}_computePointsAttr(){const e=this._markerData,i=this._relativeSeries;return{point:geoLayout(e,i)[0][0]}}_computeOptions(){const e=this._spec;return{options:[this._processSpecByDims([{dim:"areaName",specValue:e.areaName}])]}}}GeoMarkPoint.type=ComponentTypeEnum.geoMarkPoint,GeoMarkPoint.coordinateType="geo";const registerGeoMarkPoint=()=>{Factory$1.registerComponent(GeoMarkPoint.type,GeoMarkPoint),registerMarkPointAnimate()};class Brush extends BaseComponent{constructor(){super(...arguments),this.layoutType="none",this.type=ComponentTypeEnum.brush,this.name=ComponentTypeEnum.brush,this.specKey="brush",this.layoutZIndex=LayoutZIndex.Brush,this._linkedSeries=[],this._itemMap={},this._linkedItemMap={},this._inBrushElementsMap={},this._outOfBrushElementsMap={},this._linkedInBrushElementsMap={},this._linkedOutOfBrushElementsMap={},this._needInitOutState=!0,this._cacheInteractiveRangeAttrs=[],this._needDisablePickable=!1,this._releatedAxes=[],this._regionAxisMap={},this._axisDataZoomMap={},this._zoomRecord=[]}init(){const e=this._transformBrushedMarkAttr(this._spec.inBrush),i=this._transformBrushedMarkAttr(this._spec.outOfBrush);this._option.getAllSeries().forEach(n=>{n.getActiveMarks().forEach(o=>{o&&(n.setMarkStyle(o,Object.assign({},e),"inBrush",AttributeLevel.Series),n.setMarkStyle(o,Object.assign({},i),"outOfBrush",AttributeLevel.Series))})})}static getSpecInfo(e){return getSpecInfo(e,this.specKey,this.type,i=>i.visible!==!1)}created(){super.created(),this.initEvent(),this._bindRegions(),this._bindLinkedSeries(),this._initRegionAxisMap(),this._initAxisDataZoomMap(),this._initNeedOperatedItem()}_extendDataInBrush(e){var i,n;const o=[];for(const l in e)for(const d in e[l])o.push(Object.assign({},(n=(i=e[l][d])===null||i===void 0?void 0:i.data)===null||n===void 0?void 0:n[0]));return o}_extendDatumOutOfBrush(e){var i;const n=[];for(const o in e)n.push((i=e[o].data)===null||i===void 0?void 0:i[0]);return n}_getBrushInteractiveAttr(e){const i=e.getLayoutStartPoint(),n=e.getLayoutRect(),o=i.x,l=o+n.width,d=i.y,u=d+n.height;return{interactiveRange:{minY:d,maxY:u,minX:o,maxX:l},xRange:[o,l],yRange:[d,u]}}_updateBrushComponent(e,i){const n=this._getBrushInteractiveAttr(e),o=this._brushComponents[i];o.setAttributes(n),this._initMarkBrushState(i,""),o.children[0].removeAllChild(),this._needInitOutState=!0}_createBrushComponent(e,i){var n,o;const l=this._getBrushInteractiveAttr(e),d=new Brush$1(Object.assign(Object.assign(Object.assign({zIndex:this.layoutZIndex,brushStyle:transformToGraphic((n=this._spec)===null||n===void 0?void 0:n.style)},l),this._spec),{disableTriggerEvent:this._option.disableTriggerEvent}));d.id=(o=this._spec.id)!==null&&o!==void 0?o:`brush-${this.id}`,this.getContainer().add(d);const{brushMode:u="single"}=this._spec;this._brushComponents.push(d),this._cacheInteractiveRangeAttrs.push(l),d.addEventListener(IOperateType.drawStart,f=>{this._emitEvent(ChartEvent.brushStart,e)}),d.addEventListener(IOperateType.moveStart,f=>{this._emitEvent(ChartEvent.brushStart,e)}),d.addEventListener(IOperateType.drawing,f=>{this._needInitOutState&&u==="single"&&this._initMarkBrushState(i,"outOfBrush"),this._needInitOutState=!1,this._needDisablePickable=!0,this._handleBrushChange(ChartEvent.brushChange,e,f),this._emitEvent(ChartEvent.brushChange,e)}),d.addEventListener(IOperateType.moving,f=>{this._handleBrushChange(ChartEvent.brushChange,e,f),this._emitEvent(ChartEvent.brushChange,e)}),d.addEventListener(IOperateType.brushClear,f=>{this._initMarkBrushState(i,""),this._needInitOutState=!0,this._needDisablePickable=!1,this._handleBrushChange(ChartEvent.brushChange,e,f),this._handleBrushChange(ChartEvent.brushClear,e,f),this._emitEvent(ChartEvent.brushChange,e),this._emitEvent(ChartEvent.brushClear,e)}),d.addEventListener(IOperateType.drawEnd,f=>{this._needInitOutState=!0,this._needDisablePickable=!1;const{operateMask:g}=f.detail;this._handleBrushChange(ChartEvent.brushEnd,e,f);const _=this._extendDataInBrush(this._inBrushElementsMap);!this._spec.zoomWhenEmpty&&_.length>0&&this._setAxisAndDataZoom(g,e),this._emitEvent(ChartEvent.brushEnd,e)}),d.addEventListener(IOperateType.moveEnd,f=>{const{operateMask:g}=f.detail;this._handleBrushChange(ChartEvent.brushEnd,e,f);const _=this._extendDataInBrush(this._inBrushElementsMap);!this._spec.zoomWhenEmpty&&_.length>0&&this._setAxisAndDataZoom(g,e),this._emitEvent(ChartEvent.brushEnd,e)})}_handleBrushChange(e,i,n){const{operateMask:o}=n.detail;this._reconfigItem(o,i),this._reconfigLinkedItem(o,i)}_emitEvent(e,i){this.event.emit(e,{model:this,value:{operateType:e,operateRegion:i,inBrushData:this._extendDataInBrush(this._inBrushElementsMap),outOfBrushData:this._extendDatumOutOfBrush(this._outOfBrushElementsMap),linkInBrushData:this._extendDataInBrush(this._linkedInBrushElementsMap),linkOutOfBrushData:this._extendDatumOutOfBrush(this._linkedOutOfBrushElementsMap),inBrushElementsMap:this._inBrushElementsMap,outOfBrushElementsMap:this._outOfBrushElementsMap,linkedInBrushElementsMap:this._linkedInBrushElementsMap,linkedOutOfBrushElementsMap:this._linkedOutOfBrushElementsMap,zoomRecord:this._zoomRecord}})}_transformBrushedMarkAttr(e){const i={};return e!=null&&e.symbol&&(i.symbolType=e.symbol),e!=null&&e.symbolSize&&(i.size=e.symbolSize),e!=null&&e.color&&(i.fill=e.color),e!=null&&e.colorAlpha&&(i.fillOpacity=e.colorAlpha),Object.assign(Object.assign({},transformToGraphic(e)),i)}_reconfigItem(e,i){this._itemMap[i.id].forEach(n=>{const o=n.getProduct();!o||!o.elements||!o.elements.length||o.elements.forEach(l=>{var d,u,f;const g=l.getGraphicItem(),_=n.id+"_"+l.key;!((d=this._outOfBrushElementsMap)===null||d===void 0)&&d[_]&&this._isBrushContainItem(e,g)?(l.addState("inBrush"),this._inBrushElementsMap[e==null?void 0:e.name]||(this._inBrushElementsMap[e==null?void 0:e.name]={}),this._inBrushElementsMap[e==null?void 0:e.name][_]=l,delete this._outOfBrushElementsMap[_]):!((f=(u=this._inBrushElementsMap)===null||u===void 0?void 0:u[e==null?void 0:e.name])===null||f===void 0)&&f[_]&&!this._isBrushContainItem(e,g)&&(l.removeState("inBrush"),l.addState("outOfBrush"),this._outOfBrushElementsMap[_]=l,delete this._inBrushElementsMap[e.name][_]),g.setAttribute("pickable",!this._needDisablePickable)})})}_reconfigLinkedItem(e,i){const n=i.getLayoutStartPoint(),o=i.getSeries().map(l=>l.id);this._linkedSeries.forEach(l=>{if(!o.includes(l.id)){const d=l.getRegion().getLayoutStartPoint(),u=d.x-n.x,f=d.y-n.y;this._linkedItemMap[l.id].forEach(g=>{const _=g.getProduct();!_||!_.elements||!_.elements.length||_.elements.forEach(y=>{var b,S,v;const A=y.getGraphicItem(),x=g.id+"_"+y.key;!((b=this._linkedOutOfBrushElementsMap)===null||b===void 0)&&b[x]&&this._isBrushContainItem(e,A,{dx:u,dy:f})?(y.addState("inBrush"),this._linkedInBrushElementsMap[e==null?void 0:e.name]||(this._linkedInBrushElementsMap[e==null?void 0:e.name]={}),this._linkedInBrushElementsMap[e==null?void 0:e.name][x]=y,delete this._linkedOutOfBrushElementsMap[x]):!((v=(S=this._linkedInBrushElementsMap)===null||S===void 0?void 0:S[e==null?void 0:e.name])===null||v===void 0)&&v[x]&&!this._isBrushContainItem(e,A,{dx:u,dy:f})&&(y.removeState("inBrush"),y.addState("outOfBrush"),this._linkedOutOfBrushElementsMap[x]=y),A.setAttribute("pickable",!this._needDisablePickable)})})}})}_isBrushContainItem(e,i,n){var o,l,d;if(!(e!=null&&e.globalTransMatrix)||!(!((o=e==null?void 0:e.attribute)===null||o===void 0)&&o.points))return!1;const u=(d=(l=e==null?void 0:e.attribute)===null||l===void 0?void 0:l.points)!==null&&d!==void 0?d:[],{a:f,b:g,c:_,d:y,e:b,f:S}=e.globalTransMatrix,v=(n==null?void 0:n.dx)||0,A=(n==null?void 0:n.dy)||0,x=u.map(P=>({x:f*P.x+_*P.y+b+v,y:g*P.x+y*P.y+S+A}));e.globalAABBBounds.clone().set(e.globalAABBBounds.x1+v,e.globalAABBBounds.y1+A,e.globalAABBBounds.x2+v,e.globalAABBBounds.y2+A);const T=i.globalTransMatrix.e,C=i.globalTransMatrix.f;let E=[];if(i.type==="symbol"){const{size:P=0}=i==null?void 0:i.attribute,R=array(P)[0]/2;return E=[{x:T-R,y:C-R},{x:T+R,y:C-R},{x:T+R,y:C+R},{x:T-R,y:C+R}],polygonIntersectPolygon(x,E)}if(i.type==="rect"){const{x1:P,x2:R,y1:L,y2:w}=i==null?void 0:i.AABBBounds,B=Math.abs(P-R),I=Math.abs(L-w);return E=[{x:T,y:C},{x:T+B,y:C},{x:T+B,y:C+I},{x:T,y:C+I}],polygonIntersectPolygon(x,E)}return e.globalAABBBounds.intersects(i.globalAABBBounds)}_stateClamp(e){return Math.min(Math.max(0,e),1)}_setAxisAndDataZoom(e,i){var n;if(this._zoomRecord=[],this._spec.zoomAfterBrush){const o=e.AABBBounds;(n=this._regionAxisMap["region_"+i.id])===null||n===void 0||n.forEach(l=>{var d,u;const f=l.layoutOrient==="bottom"||l.layoutOrient==="top",g=(d=this._spec.axisRangeExpand)!==null&&d!==void 0?d:0,{x1:_,x2:y,y1:b,y2:S}=o,v=f?"x":"y",A=f?_:b,x=f?y:S;if(this._axisDataZoomMap[l.id]){const T=this._axisDataZoomMap[l.id],C=T.relatedAxisComponent,E=C.getScale().invert(A-i.getLayoutStartPoint()[v]),P=C.getScale().invert(x-i.getLayoutStartPoint()[v]),R=T.dataToStatePoint(E),L=T.dataToStatePoint(P),w=this._stateClamp(R-g),B=this._stateClamp(L+g);T.setStartAndEnd(Math.min(w,B),Math.max(w,B),["percent","percent"]),this._zoomRecord.push({operateComponent:T,start:w,end:B})}else{const T=l.getScale().range(),C=(u=l.getScale().rangeFactor())!==null&&u!==void 0?u:[0,1],E=last(T)<T[0],P=A-i.getLayoutStartPoint()[v],R=x-i.getLayoutStartPoint()[v],L=E?Math.min(P,R):Math.max(P,R),w=((E?Math.max(P,R):Math.min(P,R))-T[0])/(last(T)-T[0])*(C[1]-C[0])+C[0],B=(L-T[0])/(last(T)-T[0])*(C[1]-C[0])+C[0],I=this._stateClamp(w-g),D=this._stateClamp(B+g);l.getScale().rangeFactor([I,D]),l.effect.scaleUpdate(),this._zoomRecord.push({operateComponent:l,start:I,end:D})}})}}_bindRegions(){isValid(this._spec.regionId)&&isValid(this._spec.regionIndex)&&(this._relativeRegions=this._option.getAllRegions()),this._relativeRegions=this._option.getRegionsInUserIdOrIndex(array(this._spec.regionId),array(this._spec.regionIndex))}_bindLinkedSeries(){isValid(this._spec.brushLinkSeriesId)&&isValid(this._spec.brushLinkSeriesIndex)||(this._linkedSeries=this._option.getSeriesInUserIdOrIndex(array(this._spec.brushLinkSeriesId),array(this._spec.brushLinkSeriesIndex)))}_initRegionAxisMap(){isValid(this._spec.axisId)?array(this._spec.axisId).forEach(e=>{this._releatedAxes.push(this._option.getComponentByUserId(e))}):isValid(this._spec.axisIndex)?array(this._spec.axisIndex).forEach(e=>{this._releatedAxes.push(this._option.getComponentByIndex("axes",e))}):this._releatedAxes=this._option.getComponentsByKey("axes"),this._releatedAxes.forEach(e=>{e==null||e.getRegions().forEach(i=>{this._regionAxisMap["region_"+i.id]?this._regionAxisMap["region_"+i.id].push(e):this._regionAxisMap["region_"+i.id]=[e]})})}_initAxisDataZoomMap(){this._option.getComponentsByKey("dataZoom").forEach(e=>{e.relatedAxisComponent&&(this._axisDataZoomMap[e.relatedAxisComponent.id]=e)})}_initNeedOperatedItem(){const e=this._spec.seriesId,i=this._spec.seriesIndex;this._relativeRegions.forEach(n=>{const o=[];n.getSeries().forEach(l=>{(e&&array(e).includes(l.userId.toString())||i&&array(i).includes(l.getSpecIndex())||!i&&!e)&&o.push(...l.getMarksWithoutRoot()),this._itemMap[n.id]=o})}),this._linkedSeries.forEach(n=>{this._linkedItemMap[n.id]=n.getMarksWithoutRoot()})}_initMarkBrushState(e,i){this._brushComponents.forEach((n,o)=>{o!==e&&n.children[0].removeAllChild()}),this._inBrushElementsMap={},this._outOfBrushElementsMap={},this._linkedInBrushElementsMap={},this._linkedOutOfBrushElementsMap={},this._option.getAllSeries().forEach(n=>{n.getMarksWithoutRoot().forEach(o=>{const l=o.getProduct();!l||!l.elements||!l.elements.length||l.elements.forEach(d=>{const u=o.id+"_"+d.key;d.removeState("inBrush"),d.removeState("outOfBrush"),d.addState(i),this._outOfBrushElementsMap[u]=d,this._linkedOutOfBrushElementsMap[u]=d})})})}initEvent(){}onRender(e){}changeRegions(e){}_getNeedClearVRenderComponents(){return this._brushComponents}_compareSpec(e,i){this._brushComponents&&this._relativeRegions.forEach((o,l)=>{this._updateBrushComponent(o,l)});const n=super._compareSpec(e,i);return isEqual(i,e)||(n.reRender=!0,n.reMake=!0),n}onLayoutEnd(e){var i;super.onLayoutEnd(e),!this._option.disableTriggerEvent&&((i=this._spec.visible)===null||i===void 0||i)&&(this._brushComponents?this._relativeRegions.forEach((n,o)=>{this._updateBrushComponent(n,o)}):(this._brushComponents=[],this._relativeRegions.forEach((n,o)=>{this._createBrushComponent(n,o)})))}clearGraphic(){this._brushComponents&&this._brushComponents.forEach(e=>{e._container.incrementalClearChild()})}clear(){if(this._brushComponents){const e=this.getContainer();this._brushComponents.forEach(i=>{i.removeAllChild(),i.releaseBrushEvents(),e&&e.removeChild(i)}),this._brushComponents=null}}}Brush.type=ComponentTypeEnum.brush,Brush.specKey="brush";const registerBrush=()=>{Factory$1.registerComponent(Brush.type,Brush)};class CustomMark extends BaseComponent{constructor(){super(...arguments),this.type=ComponentTypeEnum.customMark,this.specKey="customMark",this.layoutType="none",this.layoutZIndex=LayoutZIndex.CustomMark,this.layoutLevel=LayoutLevel.CustomMark}created(){super.created(),this.initMarks(),this.initEvent()}getMarkAttributeContext(){return this._markAttributeContext}_buildMarkAttributeContext(){this._markAttributeContext={vchart:this._option.globalInstance,globalScale:(e,i)=>{var n;return(n=this._option.globalScale.getScale(e))===null||n===void 0?void 0:n.scale(i)}}}initMarks(){if(!this._spec)return;const e=this._option&&this._option.getAllSeries(),i=this._option.animation!==!1,n=[];e&&e.length&&e.forEach(l=>{const d=l&&l.getMarksWithoutRoot();d&&d.length&&d.forEach(u=>{n.push(u)})});let o=null;if(this._spec.parent){const l=this.getChart().getAllMarks().find(d=>d.getUserId()===this._spec.parent);l.type==="group"&&(o=l)}this._createExtensionMark(this._spec,o,`${PREFIX}_series_${this.id}_extensionMark`,0,{depend:n,hasAnimation:i})}_createExtensionMark(e,i,n,o=0,l){var d;const u=this._createMark({type:e.type,name:isValid(e.name)?`${e.name}`:`${n}_${o}`},{skipBeforeLayouted:!0,attributeContext:this._getMarkAttributeContext(),componentType:e.componentType,key:e.dataKey});if(u){if(isValid(e.id)&&u.setUserId(e.id),l.hasAnimation&&e.animation){const f=animationConfig({},userAnimationConfig(e.type,e,this._markAttributeContext));u.setAnimationConfig(f)}if(l.depend&&l.depend.length&&u.setDepend(...l.depend),isNil(i)?this._marks.addMark(u):i&&i.addMark(u),this.initMarkStyleWithSpec(u,e),e.type==="group"&&(n=`${n}_${o}`,(d=e.children)===null||d===void 0||d.forEach((f,g)=>{this._createExtensionMark(f,u,n,g,l)})),isValid(e.dataId)||isValidNumber(e.dataIndex)){const f=this.getChart().getSeriesData(e.dataId,e.dataIndex);f&&(f.target.addListener("change",()=>{u.getData().updateData()}),u.setDataView(f))}}}initEvent(){}_compareSpec(e,i){const n=super._compareSpec(e,i);return isEqual(i,e)||(n.reMake=!0),n.change=!0,n.reRender=!0,n}changeRegions(e){}_getNeedClearVRenderComponents(){return[]}onRender(e){}_getMarkAttributeContext(){return{vchart:this._option.globalInstance,chart:this.getChart(),globalScale:(e,i)=>{var n;return(n=this._option.globalScale.getScale(e))===null||n===void 0?void 0:n.scale(i)},getLayoutBounds:()=>{const{x:e,y:i}=this.getLayoutStartPoint(),{width:n,height:o}=this.getLayoutRect();return new Bounds().set(e,i,e+n,i+o)}}}_getLayoutRect(){const e=new Bounds;return this.getMarks().forEach(i=>{const n=i.getProduct();n&&e.union(n.getBounds())}),e.empty()?{width:0,height:0}:{width:e.width(),height:e.height()}}getBoundsInRect(e){this.setLayoutRect(e);const i=this._getLayoutRect(),{x:n,y:o}=this.getLayoutStartPoint();return{x1:n,y1:o,x2:n+i.width,y2:o+i.height}}}CustomMark.type=ComponentTypeEnum.customMark,CustomMark.specKey="customMark";const registerCustomMark=()=>{Factory$1.registerComponent(CustomMark.type,CustomMark)};function overlap(r,e,i=0){return i>Math.max(e.x1-r.x2,r.x1-e.x2,e.y1-r.y2,r.y1-e.y2)}function bound(r){return{x1:r.x,x2:r.x+r.width,y1:r.y,y2:r.y+r.height}}function toRect(r){return{x:r.x1,y:r.y1,width:r.x2-r.x1,height:r.y2-r.y1}}function layoutByPosition(r){var e;if(!r||r.length===0)return[];if(r.length===1)return[r[0].rect];const i=r.map(o=>{var l;return Object.assign(Object.assign({},o),{bound:bound(o.rect),anchorCandidates:candidatesByOrient((l=o.anchors)!==null&&l!==void 0?l:[],o.point,o.rect,o.offset)})}),n=[];n.push(i[0].bound);for(let o=1;o<=i.length-1;o++){const l=i[o],d=l.bound;let u=n.some(f=>overlap(f,d));if(l.anchorCandidates)if(u&&((e=l.anchorCandidates)===null||e===void 0?void 0:e.length)>0){for(let f=0;f<l.anchorCandidates.length;f++){const g=l.anchorCandidates[f],_={x1:g.x,y1:g.y,x2:g.x+d.x2-d.x1,y2:g.y+d.y2-d.y1,anchor:g};if(!n.some(y=>overlap(y,_))){n.push(_),u=!1;break}}u&&n.push(l.bound)}else n.push(l.bound)}return n.map(o=>toRect(o))}function layoutOuter(r,e,i){const n=r.map(g=>g.pointCoord),{x1:o,x2:l,y1:d,y2:u}=getAABBFromPoints(n),f=i([(o+l)/2,(d+u)/2]);return f?layoutByPosition(r.map(g=>{const _=g.rect,y=isPointWithinFeatures(e,g.pointCoord)?i(nearestPoint(e,[g.pointCoord.x,g.pointCoord.y],uniformDegree(lineDegree(g.point,f)))):g.point;y&&(_.x=y.x,_.y=y.y);const b=uniformDegree(lineDegree(g.point,f));let S;const v=[];return b>=-45&&b<45?(S="top",v.push("left","right")):b>=45&&b<135?S="right":b>=-135&&b<-45?(S="left",v.push("left")):(S="bottom",v.push("left","right")),g.anchors=v,g.offset=20,g.rect=placeRectByOrient(g.rect,S,0),g})):[]}function uniformDegree(r){return r>180?r-360:r}function lineDegree(r,e){return 180*Math.atan2(r.y-e.y,r.x-e.x)/Math.PI+90}function nearestPoint(r,e,i,n=200){const o=5621/n;let l=e;for(let d=1;d<=o;d++){const u=destination(l,n,i);if(!isPointWithinFeatures(r,u))return[u.x,u.y];l=[u.x,u.y]}return e}function isPointWithinFeatures(r,e){for(let i=0;i<r.length;i++)if(isPointInPolygon(e,r[i]))return!0;return!1}function placeRectByOrient(r,e,i=0){const n=Object.assign({},r);return e==="top"?(n.x-=r.width/2,n.y-=i+r.height/2):e==="bottom"?(n.x-=r.width/2,n.y+=i-r.height/2):e==="left"?(n.x-=i+r.width,n.y-=r.height/2):e==="right"&&(n.x+=i,n.y-=r.height/2),n}function candidatesByOrient(r,e,i,n=0){const o=[];return r.forEach(l=>{const{x:d,y:u}=placeRectByOrient(Object.assign(Object.assign({},e),{width:i.width,height:i.height}),l,n);o.push({x:d,y:u})}),o}class MapLabelComponent extends BaseComponent{constructor(){super(...arguments),this.type=ComponentTypeEnum.mapLabel,this.name=ComponentTypeEnum.mapLabel,this.specKey="mapLabel",this.layoutType="none",this.layoutZIndex=LayoutZIndex.MarkPoint,this._activeDatum=[]}static getSpecInfo(e){return getSpecInfo(e,this.specKey,this.type,i=>i.visible&&isValid(i.seriesId))}setAttrFromSpec(){var e,i,n,o;this.nameField=(e=this._spec.nameField)!==null&&e!==void 0?e:(i=this._series)===null||i===void 0?void 0:i.getDimensionField()[0],this.valueField=(n=this._spec.valueField)!==null&&n!==void 0?n:(o=this._series)===null||o===void 0?void 0:o.getMeasureField()[0]}created(){super.created(),this._spec.visible&&(this.initRelatedInfo(),this.initData(),this.initEvent())}initRelatedInfo(){var e,i,n,o,l,d,u,f;this._series=this._option.getSeriesInUserIdOrIndex([this._spec.seriesId])[0],this._spec.position==="outer"&&(this._map=(i=(e=this._regions[0].getSeriesInType("map")[0])===null||e===void 0?void 0:e.getMapViewData())===null||i===void 0?void 0:i.latestData,this._longitudeField=(l=(o=(n=this._regions[0]).getSpec)===null||o===void 0?void 0:o.call(n))===null||l===void 0?void 0:l.longitudeField,this._latitudeField=(f=(u=(d=this._regions[0]).getSpec)===null||u===void 0?void 0:u.call(d))===null||f===void 0?void 0:f.latitudeField)}initData(){const e=this._series;if(!e)return;const i=e.getViewData();if(i){const n=new DataView(this._option.dataSet,{name:`${this.name}_data`});n.parse([i],{type:"dataview"}),n.transform({type:"copyDataView",level:TransformLevel.copyDataView},!1),this._data=new CompilableData(this._option,n),n.target.addListener("change",()=>{this._spec.trigger!=="hover"&&this._spec.trigger!=="click"&&(this._activeDatum=this._data.getLatestData())})}}initEvent(){var e;this.event.on("zoom",{filter:o=>this._isRelativeModel(o.model)},o=>(this.handleZoom(o),!0)),this.event.on("panmove",{filter:o=>this._isRelativeModel(o.model)},o=>(this.handlePan(o),!0));const i=this._spec.trigger;if(i==="none")return;const n=(e=this.getCompiler())===null||e===void 0?void 0:e.getVGrammarView();n&&(i==="hover"?(n.addEventListener("element-highlight:start",o=>{this._isRelativeSeries(o.options.seriesId)&&this._updateDatum(o.elements[0].getDatum())}),n.addEventListener("element-highlight:reset",o=>{this._isRelativeSeries(o.options.seriesId)&&this._updateDatum(null)})):i==="click"&&(n.addEventListener("element-select:start",o=>{this._isRelativeSeries(o.options.seriesId)&&this._updateDatum(o.elements[0].getDatum())}),n.addEventListener("elementSelectReset",o=>{this._isRelativeSeries(o.options.seriesId)&&this._updateDatum([])})))}handlePan(e){const{delta:i}=e;this._markerComponents.forEach(n=>{n.translate(i[0],i[1])})}handleZoom(e){this._updateMarkerLayoutAttribute()}_updateDatum(e){this._activeDatum=e,this._markerComponents.forEach((i,n)=>{var o;const l=(o=this._data)===null||o===void 0?void 0:o.getLatestData()[n];this._activeDatum.includes(l)?i.setAttribute("visible",!0):i.setAttribute("visible",!1)})}dataToPosition(e){return this._series.dataToPosition(e)}updateLayoutAttribute(){var e;const i=(e=this._data)===null||e===void 0?void 0:e.getLatestData();i&&i.length!==0&&(super.updateLayoutAttribute(),this._updateMarkerLayoutAttribute())}_updateMarkerLayoutAttribute(){var e;const i=[],n=[];this._markerComponents||(this._markerComponents=(e=this._data)===null||e===void 0?void 0:e.getLatestData().map((l,d)=>{var u;const f=new MarkPoint({position:void 0,animation:!1});return f&&(f.name=`${this.name}_marker_${d}`,f.id=(u=this._spec.id)!==null&&u!==void 0?u:`${this.name}_marker_${this.id}`,f.setAttribute("zIndex",this.layoutZIndex)),f})),this._markerComponents.forEach((l,d)=>{l.removeAllChild();const{pairInfo:u,contentMarks:f}=this._evaluateMarker(this._data.getLatestData()[d],d);u&&i.push(u),f&&n.push(f)});const o=this._layoutLabels(i);this._layoutMarkers(o,n),this._renderMarkers()}_evaluateMarker(e,i){var n,o,l,d,u,f,g,_,y,b,S,v;let A=0,x=0,T=0,C=0,E=0;const P=this._spec.position||"top",R=this._spec.offset,L=normalizeLayoutPaddingSpec((n=this._spec.background)===null||n===void 0?void 0:n.padding),w=this._spec.space||0;x+=((L==null?void 0:L.left)||0)+((L==null?void 0:L.right)||0),T+=((L==null?void 0:L.top)||0)+((L==null?void 0:L.bottom)||0);const B={},I=this.dataToPosition(e),D=createGroup({});if(D.name=`${this.name}_marker_itemContainer_${i}`,B.container=D,(o=this._spec.background)===null||o===void 0?void 0:o.visible){const F=createRect(transformToGraphic(Object.assign({},this._spec.background.style)));F.setAttributes(I),B.labelBackground=F,D.appendChild(F)}if(!((l=this._spec.icon)===null||l===void 0)&&l.visible){const F=createSymbol(transformToGraphic(Object.assign({},this._spec.icon.style)));F.setAttributes(I),F.setAttribute("symbolType",(d=this._spec.icon.style)===null||d===void 0?void 0:d.shape);const $=F.AABBBounds,G=(u=($==null?void 0:$.y2)-($==null?void 0:$.y1))!==null&&u!==void 0?u:0,Y=(f=($==null?void 0:$.x2)-($==null?void 0:$.x1))!==null&&f!==void 0?f:0;B.icon=F,D.appendChild(F),E=G,C+=Y,A++}if(!((g=this._spec.nameLabel)===null||g===void 0)&&g.visible){const F=createText(transformToGraphic(Object.assign({},this._spec.nameLabel.style)));F.setAttributes(I),F.setAttribute("text",e[this.nameField]);const $=F.AABBBounds,G=(_=($==null?void 0:$.y2)-($==null?void 0:$.y1))!==null&&_!==void 0?_:0,Y=(y=($==null?void 0:$.x2)-($==null?void 0:$.x1))!==null&&y!==void 0?y:0;B.nameLabel=F,D.appendChild(F),E=Math.max(E,G),C+=Y,A++}if(!((b=this._spec.valueLabel)===null||b===void 0)&&b.visible&&isValid(e[this.valueField])){const F=createText(transformToGraphic(Object.assign({},this._spec.valueLabel.style)));F.setAttributes(I),F.setAttribute("text",e[this.valueField]);const $=F.AABBBounds,G=(S=($==null?void 0:$.y2)-($==null?void 0:$.y1))!==null&&S!==void 0?S:0,Y=(v=($==null?void 0:$.x2)-($==null?void 0:$.x1))!==null&&v!==void 0?v:0;B.valueLabel=F,D.appendChild(F),E=Math.max(E,G),C+=Y,A++}const O=Object.values(B).find(F=>!!F&&F.type!=="group"),N={x:O==null?void 0:O.getComputedAttribute("x"),y:O==null?void 0:O.getComputedAttribute("y")},V={x:N.x,y:N.y,width:0,height:0};V.width=x+C+(A-1)*w,V.height=T+E;const H={rect:V,point:N,index:i};if(P!=="outer"){const F=["top","right","left","bottom"].filter($=>$!==P);H.rect=placeRectByOrient(V,P,R),H.anchors=F,H.offset=R}else H.pointCoord={x:+(e==null?void 0:e[this._longitudeField]),y:+(e==null?void 0:e[this._latitudeField])};return{pairInfo:H,contentMarks:B}}_layoutMarkers(e,i){var n,o,l;for(let d=0;d<i.length;d++){if(!e[d]||!i[d])return;const{icon:u,nameLabel:f,valueLabel:g,labelBackground:_,container:y}=i[d],b=e[d],S=normalizeLayoutPaddingSpec((n=this._spec.background)===null||n===void 0?void 0:n.padding),v=this._spec.space||0,A=b.height/2;let x=(S==null?void 0:S.left)||0;[u,f,g].forEach((R,L)=>{var w,B;if(R){const I=R.AABBBounds;let D=0;R.type==="symbol"&&(D+=((w=I.x2-I.x1)!==null&&w!==void 0?w:0)/2),R.setAttributes({x:x+D,y:A}),x+=(B=I.x2-I.x1)!==null&&B!==void 0?B:0,L!==2&&(x+=v)}}),_==null||_.setAttributes({x:0,y:0,width:b.width,height:b.height}),y==null||y.setAttributes({dx:-b.width/2,dy:-b.height/2});const T=this._data.getLatestData()[d],C=this.dataToPosition(T),E=this.getRegions()[0].getLayoutStartPoint(),P=!(!(!((o=this._spec.leader)===null||o===void 0)&&o.visible)||!(u||f||g));this._markerComponents[d].setAttributes({x:E.x,y:E.y,position:C,visible:this._activeDatum.includes(T),itemContent:{refX:0,type:"custom",renderCustomCallback:()=>y,autoRotate:!1,offsetX:b.x+b.width/2-C.x,offsetY:b.y+b.height/2-C.y},itemLine:{visible:P,type:"type-po",lineStyle:transformToGraphic(Object.assign({},(l=this._spec.leader)===null||l===void 0?void 0:l.style)),startSymbol:{visible:!1}}})}}_renderMarkers(){if(this._markerComponents&&this._markerComponents.length)for(let e=0;e<this._markerComponents.length;e++)this.getContainer().add(this._markerComponents[e])}_layoutLabels(e){return this._spec.position==="outer"&&this._map?layoutOuter(e,this._map,i=>this._series.dataToPosition({[this._longitudeField]:i[0],[this._latitudeField]:i[1]})):layoutByPosition(e)}_isRelativeModel(e){var i,n,o;const l=(n=(i=this._series.getXAxisHelper())===null||i===void 0?void 0:i.getAxisId())!==null&&n!==void 0?n:(o=this._series.getCoordinateHelper())===null||o===void 0?void 0:o.getCoordinateId();return(e==null?void 0:e.id)===l}_isRelativeSeries(e){return(e==null?void 0:e.id)===this._series.id}onRender(e){}changeRegions(){}_getNeedClearVRenderComponents(){return this._markerComponents}}MapLabelComponent.type=ComponentTypeEnum.mapLabel,MapLabelComponent.specKey="mapLabel";const registerMapLabel=()=>{Factory$1.registerComponent(MapLabelComponent.type,MapLabelComponent)};class GridLayout{constructor(e,i){this._chartLayoutRect={x:0,y:0,width:1,height:1},this._col=1,this._row=1,this._elementMap=new Map,this.standardizationSpec(e),this._gridInfo=e,this._col=e.col,this._row=e.row,this._colSize=new Array(this._col).fill(null),this._rowSize=new Array(this._row).fill(null),this._colElements=new Array(this._col).fill([]),this._rowElements=new Array(this._row).fill([]),this._onError=i==null?void 0:i.onError,this.initUserSetting()}standardizationSpec(e){var i,n,o;e.col=(i=e.col)!==null&&i!==void 0?i:1,e.row=(n=e.row)!==null&&n!==void 0?n:1,e.elements=(o=e.elements)!==null&&o!==void 0?o:[]}initUserSetting(){this._gridInfo.colWidth&&this.setSizeFromUserSetting(this._gridInfo.colWidth,this._colSize,this._col,this._chartLayoutRect.width),this._gridInfo.rowHeight&&this.setSizeFromUserSetting(this._gridInfo.rowHeight,this._rowSize,this._row,this._chartLayoutRect.height),this._colSize.forEach((e,i)=>{e||(this._colSize[i]={value:0,isUserSetting:!1,isLayoutSetting:!1})}),this._rowSize.forEach((e,i)=>{e||(this._rowSize[i]={value:0,isUserSetting:!1,isLayoutSetting:!1})})}setSizeFromUserSetting(e,i,n,o){e.forEach(l=>{l.index<0&&l.index>=n||(isValidNumber(l.size)?i[l.index]={value:+l.size,isUserSetting:!0,isLayoutSetting:!1}:isFunction(l.size)&&(i[l.index]={value:l.size(o),isUserSetting:!0,isLayoutSetting:!1}))})}clearLayoutSize(){this._colSize.forEach(e=>{e.isLayoutSetting=!1,e.isUserSetting||(e.value=0)}),this._rowSize.forEach(e=>{e.isLayoutSetting=!1,e.isUserSetting||(e.value=0)})}getItemGridInfo(e){var i;const n=this._elementMap.get(e);if(n)return n;let o;return o=(i=this._gridInfo.elements)===null||i===void 0?void 0:i.find(l=>{var d;if("modelId"in l&&isValid(l.modelId)){if(isValid(e.model.userId)&&e.model.userId===l.modelId)return!0}else if("modelKey"in l&&isValid(l.modelKey)&&"modelIndex"in l&&isValid(l.modelIndex)&&((d=e.model.specKey)!==null&&d!==void 0?d:e.model.type)===l.modelKey&&e.model.getSpecIndex()===l.modelIndex)return!0;return!1}),o||(o={col:0,colSpan:1,row:0,rowSpan:1}),this._elementMap.set(e,o),o}getSizeFromGrid(e,i){var n;const o=i==="col"?this._colSize:this._rowSize;let l=0;for(let d=e[i];d<e[i]+((n=e[`${i}Span`])!==null&&n!==void 0?n:1);d++)l+=o[d].value;return l}getSizeFromUser(e,i){var n,o;const l=i==="col"?this._colSize:this._rowSize;if(!(!((n=l[e[i]])===null||n===void 0)&&n.isUserSetting))return;let d=0;for(let u=e[i];u<e[i]+((o=e[`${i}Span`])!==null&&o!==void 0?o:1);u++){if(!l[u].isUserSetting)return;d+=l[u].value}return d}setItemLayoutSizeToGrid(e,i){if(isColItem(e)){if(i.colSpan&&i.colSpan>1||this._colSize[i.col].isUserSetting)return;this._colSize[i.col].value=Math.max(this._colSize[i.col].value,e.getLayoutRect().width+e.layoutPaddingLeft+e.layoutPaddingRight),this._colSize[i.col].isLayoutSetting=!0}else{if(i.rowSpan&&i.rowSpan>1||this._rowSize[i.row].isUserSetting)return;this._rowSize[i.row].value=Math.max(this._rowSize[i.row].value,e.getLayoutRect().height+e.layoutPaddingTop+e.layoutPaddingBottom),this._rowSize[i.row].isLayoutSetting=!0}}layoutGrid(e){const i=e==="col"?this._colSize:this._rowSize;let n=e==="col"?this._chartLayoutRect.width:this._chartLayoutRect.height;const o=[];i.forEach(l=>{l.isUserSetting||l.isLayoutSetting?n-=l.value:o.push(l)}),n<0&&console.warn(`layout content ${e} size bigger than chart`),o.forEach(l=>l.value=n/o.length)}getItemPosition(e){const i=this.getItemGridInfo(e),n={x:this._chartLayoutRect.x,y:this._chartLayoutRect.y};for(let o=0;o<i.col;o++)n.x+=this._colSize[o].value;for(let o=0;o<i.row;o++)n.y+=this._rowSize[o].value;return n.x+=e.layoutPaddingLeft+e.layoutOffsetX,n.y+=e.layoutPaddingTop+e.layoutOffsetY,n}getItemLayoutRect(e){var i,n;const o=this.getItemGridInfo(e);return{width:((i=this.getSizeFromGrid(o,"col"))!==null&&i!==void 0?i:this._chartLayoutRect.width)-e.layoutPaddingLeft-e.layoutPaddingRight,height:((n=this.getSizeFromGrid(o,"row"))!==null&&n!==void 0?n:this._chartLayoutRect.height)-e.layoutPaddingTop-e.layoutPaddingBottom}}layoutItems(e,i,n,o){this._chartLayoutRect=n,this._chartViewBox=o,this.clearLayoutSize(),i.sort((y,b)=>b.layoutLevel-y.layoutLevel);const l=i.filter(y=>y.layoutType==="normal"&&y.getModelVisible()!==!1),d=l.filter(y=>isColItem(y)),u=l.filter(y=>!isColItem(y));l.forEach(y=>{this.layoutOneItem(y,"user",!1)});const f=i.filter(y=>y.layoutType==="region-relative"),g=f.filter(y=>isColItem(y)),_=f.filter(y=>!isColItem(y));g.forEach(y=>this.layoutOneItem(y,"user",!1)),this.layoutGrid("col"),u.forEach(y=>this.layoutOneItem(y,"colGrid",!1)),_.forEach(y=>{this.layoutOneItem(y,"colGrid",!1)}),this.layoutGrid("row"),_.forEach(y=>{this.layoutOneItem(y,"grid",!1)}),d.forEach(y=>this.layoutOneItem(y,"grid",!1)),g.forEach(y=>{this.layoutOneItem(y,"grid",!0)}),this.layoutGrid("col"),i.filter(y=>y.layoutType==="region").forEach(y=>this.layoutOneItem(y,"grid",!1)),this.layoutAbsoluteItems(i.filter(y=>y.layoutType==="absolute")),i.filter(y=>y.layoutType!=="absolute").forEach(y=>{y.setLayoutStartPosition(this.getItemPosition(y))})}layoutAbsoluteItems(e){e.forEach(i=>{i.absoluteLayoutInRect(this._chartLayoutRect)})}layoutOneItem(e,i,n){var o,l;const d=i==="rowGrid"||i==="grid"?this.getSizeFromGrid.bind(this):this.getSizeFromUser.bind(this),u=i==="colGrid"||i==="grid"?this.getSizeFromGrid.bind(this):this.getSizeFromUser.bind(this),f=this.getItemGridInfo(e),g={width:((o=u(f,"col"))!==null&&o!==void 0?o:this._chartLayoutRect.width)-e.layoutPaddingLeft-e.layoutPaddingRight,height:((l=d(f,"row"))!==null&&l!==void 0?l:this._chartLayoutRect.height)-e.layoutPaddingTop-e.layoutPaddingBottom},_=e.computeBoundsInRect(g);isValidNumber(_.width)||(_.width=g.width),isValidNumber(_.height)||(_.height=g.height),e.setLayoutRect(i!=="grid"?_:g),this.setItemLayoutSizeToGrid(e,f)}}function isColItem(r){return r.layoutOrient==="left"||r.layoutOrient==="right"}GridLayout.type="grid";const registerGridLayout=()=>{Factory$1.registerLayout(GridLayout.type,GridLayout)};class Layout3d extends Layout$1{layoutItems(e,i,n,o){this._layoutInit(e,i,n,o),this._layoutNormalItems(i);const l={left:this.leftCurrent,top:this.topCurrent,right:this.rightCurrent,bottom:this.bottomCurrent},d=i.filter(T=>T.layoutType==="absolute"),u=d.filter(T=>T.layoutOrient==="z");let f={width:0,height:0};u.length&&(f=u[0].getLayoutRect()),this.leftCurrent+=f.width/8,this.rightCurrent-=f.width/8,this.topCurrent+=f.height/8,this.bottomCurrent-=f.height/8;const{regionItems:g,relativeItems:_,relativeOverlapItems:y,allRelatives:b,overlapItems:S}=this._groupItems(i);this.layoutRegionItems(g,_,y,S),this._processAutoIndent(g,_,y,S,b,l);const v=d.filter(T=>T.layoutOrient!=="z");this.layoutAbsoluteItems(v);const A=_.filter(T=>T.model.specKey==="axes"&&isXAxis(T.layoutOrient))[0],x=_.filter(T=>T.model.specKey==="axes"&&isYAxis(T.layoutOrient))[0];if(A&&u.length){const T=A.getLayoutStartPoint(),C=A.getLayoutRect(),E={x:x.layoutOrient==="left"?T.x+C.width:T.x,y:T.y,width:this._chartLayoutRect.width,height:this._chartLayoutRect.height};u[0].model.directionStr=x.layoutOrient==="left"?"r2l":"l2r";const P=A.getLayoutRect(),R=x.getLayoutRect(),L={length:u[0].getLayoutRect().width,width:P.width,height:R.height};A.model.setLayout3dBox&&A.model.setLayout3dBox(L),x.model.setLayout3dBox&&x.model.setLayout3dBox(L),u[0].model.setLayout3dBox&&u[0].model.setLayout3dBox(L),this.layoutZAxisItems(u,E)}}layoutZAxisItems(e,i){e.forEach(n=>{n.absoluteLayoutInRect(i)})}getItemComputeLayoutRect(e,i){return i||(i={offsetLeft:0,offsetRight:0,offsetTop:0,offsetBottom:0}),{width:this.rightCurrent-this.leftCurrent-e.layoutPaddingLeft-e.layoutPaddingRight-(i.offsetLeft+i.offsetRight),height:this.bottomCurrent-this.topCurrent-e.layoutPaddingTop-e.layoutPaddingBottom-(i.offsetTop+i.offsetBottom)}}_checkAutoIndent(e){const i={top:0,left:0,bottom:0,right:0},n=this._chartViewBox.x2-this._chartViewBox.x1-this.rightCurrent,o=this._chartViewBox.y2-this._chartViewBox.y1-this.bottomCurrent;return e.forEach(l=>{if(!l.getModelVisible()||!l.autoIndent)return;const d=l.layoutOrient==="left"||l.layoutOrient==="right",u=l.getLastComputeOutBounds();d?(i.top=Math.max(i.top,u.y1-this.topCurrent),i.bottom=Math.max(i.bottom,u.y2-o)):(i.left=Math.max(i.left,u.x1-this.leftCurrent),i.right=Math.max(i.right,u.x2-n))}),i}}Layout3d.type="layout3d";const registerLayout3d=()=>{Factory$1.registerLayout(Layout3d.type,Layout3d)},registerPoptip=()=>{loadPoptip()},TOOLTIP_PREFIX="vchart-tooltip",TOOLTIP_CONTAINER_EL_CLASS_NAME=`${TOOLTIP_PREFIX}-container`,TOOLTIP_TITLE_CLASS_NAME=`${TOOLTIP_PREFIX}-title`,TOOLTIP_CONTENT_BOX_CLASS_NAME=`${TOOLTIP_PREFIX}-content-box`,TOOLTIP_EMPTY_STRING="",DEFAULT_OPTIONS={offsetX:10,offsetY:10},DEFAULT_TOOLTIP_Z_INDEX="99999999999999";function escapeHTML(r){return String(r).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\(/g,"&#40;").replace(/  /g," &nbsp;")}const getScale=(r,e)=>r?(e||(e=r.getBoundingClientRect()),r.offsetWidth>0?e.width/r.offsetWidth:r.offsetHeight>0?e.height/r.offsetHeight:1):1,formatContent=r=>isString(r)&&(r==null?void 0:r.trim())!==""||isNumber(r)?escapeHTML(r):TOOLTIP_EMPTY_STRING,getActualTooltipPositionValue=(r,e)=>{let i;if(isValid(r)){if(isNumber(r))i=r;else if(isFunction(r)){const n=r(e);isNumber(n)&&(i=n)}}return i},positionType={left:[-2,0],right:[2,0],top:[0,-2],lt:[-2,-2],tl:[-2,-2],rt:[2,-2],tr:[2,-2],bottom:[0,2],bl:[-2,2],lb:[-2,2],br:[2,2],rb:[2,2],inside:[0,0],center:[0,0],centerBottom:[0,1],centerTop:[0,-1],centerLeft:[-1,0],centerRight:[1,0]},getPositionType=(r,e,i=2)=>{var n,o;return(o=(n=positionType[r])===null||n===void 0?void 0:n[e==="x"?0:1])!==null&&o!==void 0?o:i},getCartesianCrosshairRect=(r,e)=>{var i;const n=new Map,o=new Map,{series:l,datum:d}=r,u=l.direction==="horizontal",f=(u?l.getYAxisHelper():l.getXAxisHelper()).getAxisId(),g=l.getChart().getComponentsByKey("axes").find(C=>C.id===f);if(!g)return;(u?o:n).set(g.getSpecIndex(),{value:(i=l.getDatumPositionValues(d[0],l.getDimensionField()))===null||i===void 0?void 0:i[0],axis:g});const _={visible:!!n.size,type:"rect"},y={visible:!!o.size,type:"rect"},{x:b,y:S,offsetWidth:v,offsetHeight:A,bandWidth:x,bandHeight:T}=layoutByValue$1(3,l,e,n,o,_,y);return b?layoutVerticalCrosshair(_,b,x,v):S?layoutHorizontalCrosshair(y,S,T,A):void 0},isGlobalTooltipPositionPattern=r=>isObject$1(r)&&(isValid(r.left)||isValid(r.right)||isValid(r.top)||isValid(r.bottom)),isFixedTooltipPositionPattern=r=>isObject$1(r)&&(isValid(r.x)||isValid(r.y));class BaseTooltipHandler extends BasePlugin{constructor(){super(...arguments),this._visible=!0,this._isReleased=!1,this.showTooltip=(e,i,n)=>{const{changePositionOnly:o}=n;return o?this.changeTooltipPosition(n,i):this.changeTooltip(!0,n,i)},this.changeTooltip=(e,i,n)=>this._isReleased?1:e?this.changeTooltipPosition(i,n):(this._updateTooltip(!1,i),0),this.changeTooltipPosition=(e,i)=>{var n,o,l,d,u;if(this._isReleased)return 1;const f=e.event,{tooltipSpec:g,activeTooltipSpec:_,changePositionOnly:y}=e;if(!_)return 1;const b=_.activeType;if(_.handler)return(l=(o=(n=_.handler).showTooltip)===null||o===void 0?void 0:o.call(n,b,i,e))!==null&&l!==void 0?l:0;const S=_,v=this._getActualTooltipPosition(_,e,this._getTooltipBoxSize(_,y));_.position=v;const A=(d=_.updatePosition)!==null&&d!==void 0?d:(u=g[b])===null||u===void 0?void 0:u.updatePosition;A&&(_.position=A(_.position,i,e));let x=(S==null?void 0:S.visible)!==!1;return i&&f.type!=="pointerout"&&_.visible&&(_.title||_.content)||(x=!1),this._updateTooltip(x,Object.assign(Object.assign({},e),{changePositionOnly:y})),0},this._getActualTooltipPosition=(e,i,n)=>{var o,l,d,u,f,g,_,y,b;const{tooltipSpec:S}=i,v={x:1/0,y:1/0};if(!S)return v;const A=i.event,{activeType:x,data:T}=e,C=x==="dimension"?(l=(o=T[0])===null||o===void 0?void 0:o.data)===null||l===void 0?void 0:l[0]:T==null?void 0:T[0],{offsetX:E,offsetY:P}=this._option,R=S[x],L=getTooltipPatternValue(R==null?void 0:R.position,T,i),w=(d=getTooltipPatternValue(R==null?void 0:R.positionMode,T,i))!==null&&d!==void 0?d:x==="mark"?"mark":"pointer",{width:B=0,height:I=0}=n??{},D=S.renderMode==="canvas",O=(u=i==null?void 0:i.chart)===null||u===void 0?void 0:u.getCanvasRect(),N=(f=O==null?void 0:O.width)!==null&&f!==void 0?f:DEFAULT_CHART_WIDTH,V=(g=O==null?void 0:O.height)!==null&&g!==void 0?g:DEFAULT_CHART_HEIGHT;let H=!1;const F={width:0,height:0};let $,G={x:0,y:0},Y={x:0,y:0},Q=1,q=1;const te=isTrueBrowser(this._env);if(te&&!S.confine?(F.width=window.innerWidth,F.height=window.innerHeight):(F.width=N,F.height=V),te&&!D){const ie=this._getParentElement(S);Y=(y=(_=ie==null?void 0:ie.getBoundingClientRect)===null||_===void 0?void 0:_.call(ie))!==null&&y!==void 0?y:v;const le=(b=this._compiler.getCanvas())!==null&&b!==void 0?b:this._chartContainer;$=le==null?void 0:le.getBoundingClientRect(),G={x:$.x-Y.x,y:$.y-Y.y},Q=getScale(le,$),q=getScale(ie,Y)}const ue=q/Q,he={},fe={x:L,y:L},pe={x:["left","right"],y:["top","bottom"]},me=({orient:ie,mode:le,offset:ce},j)=>{var W;let K,ne;const re=i.model,ae=re==null?void 0:re.getLayoutStartPoint(),z=ce??(j==="x"?E:P);if(le==="mark"){H=!0;const U=i.item,X=U==null?void 0:U.getBounds();X&&ae&&(K=(j==="x"?X.x1:X.y1)+ae[j],ne=(j==="x"?X.x2:X.y2)+ae[j])}else if(le==="crosshair"&&((W=C==null?void 0:C.series)===null||W===void 0?void 0:W.coordinate)==="cartesian"&&C.datum&&C.datum.length){H=!0;const U=getCartesianCrosshairRect(C,ae);U&&(K=U.start[j],ne=U.end[j])}else fe[j]=ie;if(H){const U=pe[j][0],X=j==="x"?B:I;switch(getPositionType(ie,j)){case-2:he[U]=K-X*ue-z;break;case 0:he[U]=(K+ne)/2-X*ue/2;break;case-1:he[U]=(K+ne)/2-X*ue-z;break;case 1:he[U]=(K+ne)/2+z;break;case 2:he[U]=ne+z}}},ee=["x","y"];if(isObject$1(L))if(isGlobalTooltipPositionPattern(L)){const{left:ie,right:le,top:ce,bottom:j}=L;he.left=getActualTooltipPositionValue(ie,A),he.top=getActualTooltipPositionValue(ce,A),he.right=getActualTooltipPositionValue(le,A),he.bottom=getActualTooltipPositionValue(j,A)}else isFixedTooltipPositionPattern(L)&&ee.forEach(ie=>{const le=L[ie];isNumber(le)||isFunction(le)?he[pe[ie][0]]=getActualTooltipPositionValue(le,A):me(le,ie)});else isValid(L)&&(me({orient:L,mode:w},"x"),me({orient:L,mode:w},"y"));const J={x:null,y:null};return ee.forEach(ie=>{var le;const ce=ie==="x"?B:I,j=ie==="x"?N:V,W=ie==="x"?E:P,K=getPositionType(fe[ie],ie);if(isValidNumber(he[pe[ie][0]]))J[ie]=he[pe[ie][0]];else if(isValidNumber(he[pe[ie][1]]))J[ie]=j-ce*ue-he[pe[ie][1]];else{const z=ie==="x"?A.canvasX:A.canvasY;J[ie]=K>0?z+W:K===0?z-ce*ue/2:z-ce*ue-W}J[ie]*=Q,te&&(J[ie]+=G[ie]),J[ie]/=q;const ne=ie==="x"?F.width:F.height,re=S.confine?-(Y[ie]-((le=$==null?void 0:$[ie])!==null&&le!==void 0?le:0)/Q)/q:-Y[ie]/q,ae=ne/q+re-ce;K!==2&&J[ie]<re?H?J[ie]=re:(J[ie]+=K===0?W+ce/2:2*W+ce,J[ie]>ae&&(J[ie]=ae)):K!==-2&&J[ie]>ae&&(H?J[ie]=ae:(J[ie]-=K===0?W+ce/2:2*W+ce,J[ie]<re&&(J[ie]=re)))}),J}}get env(){return this._env}onAdd(e){super.onAdd(e);const i=e.component;this._component=i,this._chartOption=i.getOption(),this._env=this._chartOption.mode,this._chartContainer=this._chartOption.globalInstance.getContainer(),this._compiler=i.getCompiler(),this._initFromSpec()}hideTooltip(e){return this.changeTooltip(!1,e)}release(){var e,i,n;const o=(e=this._component.getSpec())!==null&&e!==void 0?e:{};o.handler?(n=(i=o.handler).release)===null||n===void 0||n.call(i):(this._removeTooltip(),this._isReleased=!0)}_getDefaultOption(){var e,i;const{offset:n}=this._component.getSpec();return n?{offsetX:(e=n.x)!==null&&e!==void 0?e:DEFAULT_OPTIONS.offsetX,offsetY:(i=n.y)!==null&&i!==void 0?i:DEFAULT_OPTIONS.offsetY}:DEFAULT_OPTIONS}_getParentElement(e){return e.parentElement}getTooltipContainer(){return this._container}_initFromSpec(){this._option=this._getDefaultOption()}reInit(){this._initFromSpec()}}BaseTooltipHandler.specKey="tooltip";const getPixelPropertyStr=(r,e)=>isValid(r)?isArray(r)?r.map(i=>`${i}px`).join(" "):`${r}px`:e??"initial",getTextStyle=(r={},e={})=>{var i,n;isValid(r.fontFamily)&&(e.fontFamily=r.fontFamily);const o=(i=r.fill)!==null&&i!==void 0?i:r.fontColor;return isValid(o)&&(e.color=o),isValid(r.fontWeight)&&(e.fontWeight=r.fontWeight),isValid(r.textAlign)&&(e.textAlign=r.textAlign),isValid(r.fontSize)&&(e.fontSize=getPixelPropertyStr(r.fontSize)),isValid(r.maxWidth)&&(e.maxWidth=getPixelPropertyStr(r.maxWidth)),r.multiLine?(e.whiteSpace="initial",e.wordBreak=(n=r.wordBreak)!==null&&n!==void 0?n:"break-word"):(e.wordBreak="normal",e.whiteSpace="nowrap"),e},getLineHeight=(r={})=>{const{lineHeight:e}=r;return r.fontSize?calcLayoutNumber(e,r.fontSize):0},getDomStyle=(r={})=>{var e,i,n,o;const{style:l={},enterable:d,transitionDuration:u}=r,{panel:f={},titleLabel:g,shape:_,keyLabel:y,valueLabel:b,spaceRow:S,align:v}=l,{panelStyle:A,panelPadding:x}=getPanelStyle(f),T={marginTop:"0px",marginBottom:"0px"};A.pointerEvents=d?"auto":"none",u&&(A.transitionDuration=u?`${u}ms`:"initial",A.transitionProperty=u?"transform":"initial",A.transitionTimingFunction=u?"ease-out":"initial"),isValidNumber(S)&&(T.marginBottom=`${S}px`);const C={width:getPixelPropertyStr((e=_==null?void 0:_.size)!==null&&e!==void 0?e:8)},E=getTextStyle(g),P=getTextStyle(y),R=getTextStyle(b),L=v==="right"?"marginLeft":"marginRight";v==="right"?(A.direction="rtl",E.textAlign="right",P.textAlign="right",R.textAlign="left"):(E.textAlign="left",P.textAlign="left",R.textAlign="right"),C[L]=getPixelPropertyStr((i=_.spacing)!==null&&i!==void 0?i:8),P[L]=getPixelPropertyStr((n=y.spacing)!==null&&n!==void 0?n:26),R[L]=getPixelPropertyStr((o=b.spacing)!==null&&o!==void 0?o:0);const w=Math.max(getLineHeight(b),getLineHeight(y));return T.lineHeight=w>0?`${w}px`:"20px",{panelPadding:x,row:T,panel:A,title:E,shape:C,key:P,value:R}},getPanelStyle=r=>{var e;const{backgroundColor:i,border:n,shadow:o,padding:l}=r,d={borderWidth:`${(e=n==null?void 0:n.width)!==null&&e!==void 0?e:0}px`};let u=null;n!=null&&n.color&&(d.borderColor=n.color),i&&(d.backgroundColor=i),d.boxShadow=o?`${o.x}px ${o.y}px ${o.blur}px ${o.spread}px ${o.color}`:"initial";const{radius:f}=n??{};return isValid(f)&&(d.borderRadius=isValidNumber(f)?`${f}px`:`${f}`),l&&(u=normalizePadding$1(l),d.padding=getPixelPropertyStr(u)),{panelStyle:d,panelPadding:u}};function setStyleToDom(r,e){r&&r.style&&e&&Object.keys(e).forEach(i=>{r.style[i]=e[i]})}const registerComponentPlugin=r=>{Factory$1.registerComponentPlugin(r.type,r)};function getSvgHtml(r,e){var i,n,o,l,d,u;if(!r||!r.hasShape||!r.shapeType)return"";const f='style="display:inline-block;vertical-align:middle;"',{shapeType:g,shapeFill:_,shapeStroke:y,shapeHollow:b=!1}=r,S=(i=r.shapeSize)!==null&&i!==void 0?i:8,v=r.shapeLineWidth?escapeHTML(r.shapeLineWidth)+"px":"0px";let A="currentColor";const x=()=>y?escapeHTML(y):A,T=S,C=B=>new Symbol$1({symbolType:B,size:T,fill:!0});let E=C(g);const P=E.getParsedPath();let R,L;if(!P.path&&P.pathStr&&(E=C(P.pathStr)),E.getParsedPath().path){const B=E.getParsedPath().path;L=B.toString(),R=B.bounds}else P.isSvg&&P.svgCache&&(L=P.svgCache.map(B=>B.path.toString()).join(),R=P.svgCache.reduce((B,I)=>B.union(I.path.bounds),new Bounds));let w=`${R.x1} ${R.y1} ${R.width()} ${R.height()}`;if(v!=="0px"){const[B,I,D,O]=w.split(" ").map(V=>Number(V)),N=Number(v.slice(0,-2));w=`${B-N/2} ${I-N/2} ${D+N} ${O+N}`}if(!_||isString(_)||b)return A=b?"none":_?escapeHTML(_):"currentColor",`
    <svg ${f} width="${S}" height="${S}" viewBox="${w}">
      <path
        d="${L}"
        style="fill: ${A}; stroke: ${x()}; stroke-width: ${v}"
      >
      </path>
    </svg>`;if(isObject$1(_)){A="gradientColor"+(e??"");let B="";const I=((n=_.stops)!==null&&n!==void 0?n:[]).map(D=>`<stop offset="${escapeHTML(D.offset.toString())}" stop-color="${escapeHTML(D.color)}"/>`).join("");return _.gradient==="radial"?B=`<radialGradient id="${A}" cx="50%" cy="50%" r="50%" fx="0%" fy="0%">
      ${I}
      </radialGradient>`:_.gradient==="linear"&&(B=`<linearGradient id="${A}" x1="${100*((o=_.x0)!==null&&o!==void 0?o:0)}%" y1="${100*((l=_.y0)!==null&&l!==void 0?l:0)}%" x2="${100*((d=_.x1)!==null&&d!==void 0?d:0)}%" y2="${100*((u=_.y1)!==null&&u!==void 0?u:0)}%">
      ${I}
      </linearGradient>`),`
    <svg ${f} width="${S}" height="${S}" viewBox="-0.5 -0.5 1 1">
      ${B}
      <path
        d="${L}"
        style="fill: url(#${A}); stroke: ${x()}; stroke-width: ${v}"
      >
      </path>
    </svg>`}return""}class DomTooltipHandler extends BaseTooltipHandler{getVisibility(){return!!this._rootDom&&this._rootDom.style.visibility==="visible"}setVisibility(e){e!==this.getVisibility()&&this._rootDom&&(this._rootDom.style.visibility=e?"visible":"hidden")}constructor(){super(DomTooltipHandler.type),this.type=TooltipHandlerType.dom,this._tooltipContainer=domDocument==null?void 0:domDocument.body}onAdd(e){super.onAdd(e),this._initStyle(),this.initEl()}initEl(){const e=this._component.getSpec().parentElement;if(domDocument&&e&&e.children&&e.children.length){for(let i=0;i<e.children.length;i++)if(e.children[i].classList.contains(TOOLTIP_CONTAINER_EL_CLASS_NAME)){this._container=e.children[i];break}this._container||(this._container=domDocument.createElement("div"),this._container.style.position="relative",this._container.style.zIndex=DEFAULT_TOOLTIP_Z_INDEX,this._container.classList.add(TOOLTIP_CONTAINER_EL_CLASS_NAME),e.appendChild(this._container))}}initRootDom(){var e,i,n;const o=this._component.getSpec(),l=document.createElement("div"),d=(i=(e=this._chartOption)===null||e===void 0?void 0:e.getTheme())!==null&&i!==void 0?i:{};setStyleToDom(l,Object.assign({left:"0",top:"0",pointerEvents:"none",padding:"12px",position:"absolute",zIndex:DEFAULT_TOOLTIP_Z_INDEX,fontFamily:(n=d==null?void 0:d.fontFamily)!==null&&n!==void 0?n:token.fontFamily,fontSize:"11px",borderRadius:"3px",borderStyle:"solid",lineHeight:"initial",background:"#fff",boxShadow:"2px 2px 4px rgba(0, 0, 0, 0.1)",maxWidth:"100wh",maxHeight:"100vh",visibility:"hidden"},this._domStyle.panel)),l.classList.add(o.className),l.setAttribute("vchart-tooltip-id",`${this.id}`),this._container.appendChild(l),this._rootDom=l}_getTooltipBoxSize(e,i){var n;this._rootDom||this.initRootDom(),i||this._updateDomStringByCol(e),this._updateDomStyle("height");const o=(n=this._rootDom)===null||n===void 0?void 0:n.getBoundingClientRect();return{width:o==null?void 0:o.width,height:o==null?void 0:o.height}}_removeTooltip(){this._rootDom&&this._rootDom.parentNode&&(this._rootDom.parentNode.removeChild(this._rootDom),this._rootDom=null),this._container=null}_updateTooltip(e,i){var n,o,l;if(e&&this._rootDom){const{tooltipSpec:d,activeTooltipSpec:u}=i;i.changePositionOnly||(this._tooltipActual=u);const f=this.getVisibility(),g=this._rootDom;if(g){const{x:_=0,y=0}=(n=u.position)!==null&&n!==void 0?n:{};if(d.updateElement){this._updatePosition((o=this._cacheCustomTooltipPosition)!==null&&o!==void 0?o:{x:_,y}),d.updateElement(g,u,i);const b=this._getActualTooltipPosition(u,i,{width:g.offsetWidth,height:g.offsetHeight});this._updatePosition(b),this._cacheCustomTooltipPosition=b}else this._rootDom.style.transitionDuration=f?(l=this._domStyle.panel.transitionDuration)!==null&&l!==void 0?l:"initial":"0ms",this._updatePosition({x:_,y})}this.setVisibility(e)}else this.setVisibility(e),this._cacheCustomTooltipPosition=void 0}_initStyle(){const e=this._component.getSpec();this._domStyle=getDomStyle(e)}_updateDomStringByCol(e){var i;const{title:n={},content:o}=e,l=o&&o.length,d=this._domStyle.row,u=[...this._rootDom.children];let f=u.find(y=>y.className.includes(TOOLTIP_TITLE_CLASS_NAME));if(!f&&n.visible!==!1){f=document.createElement("h2");const y=document.createElement("span");f.appendChild(y),f.classList.add(TOOLTIP_TITLE_CLASS_NAME),this._rootDom.appendChild(f)}f&&n.visible!==!1?(setStyleToDom(f,Object.assign(Object.assign(Object.assign({},this._domStyle.title),l?d:{marginBottom:"0px"}),{marginTop:"0px"})),f.firstChild.innerHTML=`${(i=n.value)!==null&&i!==void 0?i:""}`):f&&n.visible===!1&&f.parentNode.removeChild(f);let g=u.find(y=>y.className.includes(TOOLTIP_CONTENT_BOX_CLASS_NAME));const _=["shape","key","value"];if(!g&&l&&(g=document.createElement("div"),_.forEach(y=>{const b=document.createElement("div");b.classList.add(`${TOOLTIP_PREFIX}-column`),b.classList.add(`${TOOLTIP_PREFIX}-${y}-column`),b.setAttribute("data-col",y),g.appendChild(b)}),g.classList.add(TOOLTIP_CONTENT_BOX_CLASS_NAME),this._rootDom.appendChild(g)),g&&l){const y=[...g.children];setStyleToDom(g,{whiteSpace:"nowrap"}),y.forEach((b,S)=>{const v=b.getAttribute("data-col");if(v&&_.includes(v)){const A=v==="shape"&&o.every(T=>!T.hasShape||!T.shapeType);setStyleToDom(b,Object.assign(Object.assign({},this._domStyle[v]),{display:A?"none":"inline-block",verticalAlign:"top"}));const x=[...b.children];x.slice(o.length).forEach(T=>{T.parentNode.removeChild(T)}),o.forEach((T,C)=>{let E=x[C];E||(E=document.createElement("div"),E.classList.add(`${TOOLTIP_PREFIX}-${v}`),b.appendChild(E));const P=Object.assign({},d);C===o.length-1&&(P.marginBottom="0px"),P.display=T.visible===!1?"none":"block",P.height="initial",v==="key"?(E.innerHTML=formatContent(T.key),T.keyStyle&&getTextStyle(T.keyStyle,P)):v==="value"?(E.innerHTML=formatContent(T.value),T.valueStyle&&getTextStyle(T.valueStyle,P)):v==="shape"&&(E.innerHTML=getSvgHtml(T,`${this.id}_${C}`)),setStyleToDom(E,P)})}})}else g&&!l&&g.parentNode.removeChild(g)}_updateDomStyle(e="width"){var i,n,o,l;const d=this._rootDom,u=[...d.children].find(f=>f.className.includes(TOOLTIP_CONTENT_BOX_CLASS_NAME));if(u){const f=this._component.getSpec(),g={};if(isValid((i=f==null?void 0:f.style)===null||i===void 0?void 0:i.maxContentHeight)){const b=d.children[0],S=b&&b.className.includes(TOOLTIP_TITLE_CLASS_NAME)?b.getBoundingClientRect().height+((n=f.style.spaceRow)!==null&&n!==void 0?n:0):0,v=this._chartOption.getChartViewRect(),A=calcLayoutNumber(f.style.maxContentHeight,Math.min(v.height,document.body.clientHeight)-S-(this._domStyle.panelPadding?this._domStyle.panelPadding[0]+this._domStyle.panelPadding[1]:0));A>0&&(g.maxHeight=`${A}px`,g.overflowY="auto",g.width=`calc(100% + ${this._domStyle.panelPadding?this._domStyle.panelPadding[1]+"px":"10px"})`,setStyleToDom(u,g))}const _=u.children,y=[];if(_){for(let b=0;b<_.length;b++){const S=(o=_[b].children)!==null&&o!==void 0?o:[];for(let v=0;v<S.length;v++){const A=S[v].getBoundingClientRect()[e];(y[v]===void 0||y[v]<A)&&(y[v]=A)}}for(let b=0;b<_.length;b++){const S=(l=_[b].children)!==null&&l!==void 0?l:[];for(let v=0;v<S.length;v++)S[v].style[e]=`${y[v]}px`}}}}_getParentElement(e){var i;return(i=this._container)!==null&&i!==void 0?i:super._getParentElement(e)}isTooltipShown(){return this.getVisibility()}reInit(){super.reInit(),this._initStyle(),this._rootDom&&setStyleToDom(this._rootDom,this._domStyle.panel),this.getVisibility()&&(this._updateDomStringByCol(this._tooltipActual),this._updateDomStyle("height"))}_updatePosition({x:e,y:i}){this._rootDom&&(this._rootDom.style.transform=`translate3d(${e}px, ${i}px, 0)`)}}DomTooltipHandler.type=TooltipHandlerType.dom;const registerDomTooltipHandler=()=>{registerComponentPlugin(DomTooltipHandler)},DEFAULT_TEXT_ATTRIBUTES={fontFamily:token.fontFamily,spacing:10,wordBreak:"break-word"},measureTooltipText=(r,e)=>{var i;let n,o;(r==null?void 0:r.type)!=="rich"&&(r==null?void 0:r.type)!=="html"?(r=(r??"").toString(),e.multiLine?(n=r.split(`
`),n=n.map((d,u)=>u<n.length-1?d+`
`:d)):n=[r],o=n.map(d=>Object.assign(Object.assign({},e),{text:d}))):(o=r.text,n=r);const l=getRichTextBounds({wordBreak:(i=e.wordBreak)!==null&&i!==void 0?i:"break-word",maxWidth:e.maxWidth?e.maxWidth:void 0,width:0,height:0,textConfig:o});return{width:l.width(),height:l.height(),text:n}};function getTextAttributes(r={},e,i){var n,o;return Object.assign(Object.assign({},i??DEFAULT_TEXT_ATTRIBUTES),{fill:(n=r.fill)!==null&&n!==void 0?n:r.fontColor,textAlign:r.textAlign,textBaseline:r.textBaseline,fontFamily:(o=r.fontFamily)!==null&&o!==void 0?o:e==null?void 0:e.fontFamily,fontSize:r.fontSize,fontWeight:r.fontWeight,lineHeight:r.lineHeight,spacing:r.spacing,multiLine:r.multiLine,maxWidth:r.maxWidth,wordBreak:r.wordBreak,autoWidth:r.autoWidth})}const getPanelAttributes=r=>{var e;const{backgroundColor:i,border:n,shadow:o}=r,l={lineWidth:(e=n==null?void 0:n.width)!==null&&e!==void 0?e:0,shadow:!!o};n!=null&&n.color&&(l.stroke=n.color),i&&(l.fill=i),o&&(l.shadowColor=o.color,l.shadowBlur=o.blur,l.shadowOffsetX=o.x,l.shadowOffsetY=o.y,l.shadowSpread=o.spread);const{radius:d}=n??{};return isValid(d)&&(l.cornerRadius=[d,d,d,d]),l},getTooltipAttributes=(r,e,i)=>{var n,o,l,d,u;const{style:f={},enterable:g,transitionDuration:_}=e,{panel:y={},titleLabel:b,shape:S,keyLabel:v,valueLabel:A,spaceRow:x,align:T}=f,C=normalizePadding$1(y.padding),E=normalizeLayoutPaddingSpec(y.padding),P=getTextAttributes(Object.assign({textAlign:T==="right"?"right":"left"},b),i),R=getTextAttributes(Object.assign({textAlign:T==="right"?"right":"left"},v),i),L=getTextAttributes(A,i),w={fill:!0,size:(n=S==null?void 0:S.size)!==null&&n!==void 0?n:8,spacing:(o=S==null?void 0:S.spacing)!==null&&o!==void 0?o:6},B={panel:getPanelAttributes(y),padding:C,title:{},content:[],titleStyle:{value:P,spaceRow:x},contentStyle:{shape:w,key:R,value:L,spaceRow:x},hasContentShape:!1,keyWidth:0,valueWidth:0,enterable:g,transitionDuration:_,align:T},{title:I={},content:D=[]}=r;let O=E.left+E.right,N=E.top+E.bottom,V=0;const H=!!D.length;let F=0,$=0,G=0,Y=0;if(H){const J=[],ie=[],le=[],ce=[];let j=0;B.content=D.map((W,K)=>{let ne=0;const{hasShape:re,key:ae,shapeType:z="",shapeFill:U,shapeStroke:X,shapeLineWidth:se,shapeSize:ge,value:de,isKeyAdaptive:Z,spaceRow:oe,keyStyle:_e,valueStyle:ye,shapeHollow:Se}=W,Ae={height:0,spaceRow:oe??x};if(isValid(ae)){const ve=mergeSpec({},R,getTextAttributes(_e,void 0,{})),{width:xe,height:Te,text:Me}=measureTooltipText(ae,ve);Ae.key=Object.assign(Object.assign({width:xe,height:Te},ve),{text:Me}),Z?ie.push(xe):J.push(xe),ne=Math.max(ne,Te)}if(isValid(de)){const ve=mergeSpec({},L,getTextAttributes(ye,void 0,{})),{width:xe,height:Te,text:Me}=measureTooltipText(de,ve);Ae.value=Object.assign(Object.assign({width:xe,height:Te},ve),{text:Me}),le.push(xe),ne=Math.max(ne,Te)}if(re){const ve={visible:!0,symbolType:z};Se?ve.stroke=U:ve.fill=U,ve.stroke=X??U,ve.lineWidth=se,Ae.shape=ve;const xe=ge??w.size;ne=Math.max(xe,ne),ce.push(xe)}else Ae.shape={visible:!1};return Ae.height=ne,j+=ne,K<D.length-1&&(j+=Ae.spaceRow),Ae}),N+=j,F=J.length?maxInArray(J):0,$=ie.length?maxInArray(ie):0,G=le.length?maxInArray(le):0,Y=ce.length?maxInArray(ce)+w.spacing:0,V=Math.max(Y+F+R.spacing+G+L.spacing,Y+$,V),B.hasContentShape=!!ce.length,B.keyWidth=F,B.valueWidth=G}let Q=0,q=0,te=0;const{visible:ue=!0,value:he="",valueStyle:fe,spaceRow:pe}=I;B.title.visible=ue,B.title.spaceRow=pe??x;let me={};const ee=()=>me.autoWidth&&me.multiLine!==!1;if(ue){me=mergeSpec({},P,getTextAttributes(fe,void 0,{})),ee()&&(me.multiLine=(l=me.multiLine)===null||l===void 0||l,me.maxWidth=(d=me.maxWidth)!==null&&d!==void 0?d:H?Math.ceil(V):void 0);const{text:J,width:ie,height:le}=measureTooltipText(he,me);B.title.value=Object.assign(Object.assign({width:ee()?Math.min(ie,(u=me.maxWidth)!==null&&u!==void 0?u:Number.MAX_VALUE):ie,height:le},me),{text:J}),Q=B.title.value.width,q=B.title.value.height,te=q+(H?B.title.spaceRow:0)}return N+=te,B.title.width=Q,B.title.height=q,ee()?O+=V||Q:O+=Math.max(Q,V),H&&B.content.forEach(J=>{var ie;const le=J.value;le&&((ie=le.autoWidth)===null||ie===void 0||ie)&&(le.width=O-E.left-E.right-Y-F-R.spacing-L.spacing,le.maxWidth||(le.maxWidth=Math.ceil(le.width)),B.valueWidth=Math.max(B.valueWidth,le.width))}),B.panel.width=O,B.panel.height=N,B};class CanvasTooltipHandler extends BaseTooltipHandler{constructor(){super(CanvasTooltipHandler.type),this.type=TooltipHandlerType.canvas,this._attributes=null}onAdd(e){var i;super.onAdd(e),this._tooltipCanvasId=(i=this._chartOption.modeParams)===null||i===void 0?void 0:i.tooltipCanvasId}_initTooltipComponent(e){const i=this._getLayer(e);this._tooltipComponent=new Tooltip$1({autoCalculatePosition:!1,autoMeasure:!1}),i.add(this._tooltipComponent)}_getLayer(e){if(this._layer)return this._layer;this._layer=e.createLayer(this._tooltipCanvasId);const i=this._layer.layerHandler.canvas.nativeCanvas;return i&&i.style&&(i.style.touchAction="none",i.style.pointerEvents="none"),this._layer}_getTooltipBoxSize(e,i){var n,o,l;if(!i||isNil(this._attributes)){const u=(o=(n=this._chartOption)===null||n===void 0?void 0:n.getTheme())!==null&&o!==void 0?o:{};this._attributes=getTooltipAttributes(e,this._component.getSpec(),u)}const{panel:d}=(l=this._attributes)!==null&&l!==void 0?l:{};return{width:d.width+d.lineWidth,height:d.height+d.lineWidth}}_removeTooltip(){this._layer&&this._layer.removeAllChild(),this._attributes=null}_updateTooltip(e,i){this._visible=e;const n=this._compiler.getStage();if(!n)return;if(!e)return void(this._tooltipComponent&&this._tooltipComponent.attribute.visible&&(this._tooltipComponent.hideAll(),this._tooltipComponent.setAttributes({visibleAll:!1})));this._tooltipComponent||this._initTooltipComponent(n);const{activeTooltipSpec:o}=i,l=o.position;i.changePositionOnly?isValid(l)&&this._tooltipComponent.setAttributes(l):this._tooltipComponent.setAttributes(Object.assign(Object.assign({},this._attributes),l)),this._tooltipComponent.attribute.visible||(this._tooltipComponent.showAll(),this._tooltipComponent.setAttributes({visibleAll:!0}))}isTooltipShown(){var e;return(e=this._tooltipComponent)===null||e===void 0?void 0:e.attribute.visibleAll}release(){var e;super.release(),(e=this._layer)===null||e===void 0||e.release()}}CanvasTooltipHandler.type=TooltipHandlerType.canvas;const registerCanvasTooltipHandler=()=>{registerComponentPlugin(CanvasTooltipHandler)},registerChartPlugin=r=>{Factory$1.registerChartPlugin(r.type,r)},bracketReg=/\{([^}]+)\}/,bracketGReg=/\{([^}]+)\}/g,semicolonReg=/:/;class FormatterPlugin extends BasePlugin{constructor(){super(FormatterPlugin.type),this.type="formatterPlugin",this._timeModeFormat={utc:TimeUtil.getInstance().timeUTCFormat,local:TimeUtil.getInstance().timeFormat},this._formatter=this._format,this._timeFormatter=this._timeModeFormat.local,this._numericFormatter=NumberUtil.getInstance().format,this._numericSpecifier=NumberUtil.getInstance().formatter,this._numericFormatterCache=new Map,this._isNumericFormatterCache=new Map}onInit(e,i){var n;const{globalInstance:o}=e;if(!o)return;this._spec=(n=i==null?void 0:i[FormatterPlugin.specKey])!==null&&n!==void 0?n:{};const{timeMode:l,customFormatter:d,numericFormatter:u,timeFormatter:f}=this._spec;isFunction(d)?this._formatter=d:(this._formatter=this._format.bind(this),isFunction(f)?this._timeFormatter=f:l&&this._timeModeFormat[l]&&(this._timeFormatter=this._timeModeFormat[l]),u&&(this._numericFormatter=u,this._numericSpecifier=null,this._numericFormatterCache=null)),Factory$1.registerFormatter(this._formatter)}_format(e,i,n){return isArray(e)?e.map((o,l)=>{const d=isArray(n)?n[l]:n;return d?this._formatSingleLine(o,i,d):o}):isArray(n)?n.map(o=>this._formatSingleLine(e,i,o)):this._formatSingleLine(e,i,n)}_formatSingleLine(e,i,n){let o;return this._isNumericFormatterCache&&(this._isNumericFormatterCache.get(n)?o=this._isNumericFormatterCache.get(n):(o=bracketReg.test(n),this._isNumericFormatterCache.set(n,o))),o?n.replace(bracketGReg,(l,d)=>{if(!semicolonReg.test(d)){const _=i[d.trim()];return _!==void 0?_:l}const u=d.split(":"),f=i[u.shift()],g=u.join(":");return this._formatSingleText(f,g)}):this._formatSingleText(e,n)}_formatSingleText(e,i){if(numberSpecifierReg.test(i)&&this._numericFormatter){let n;return this._numericFormatterCache&&this._numericSpecifier?(this._numericFormatterCache.get(i)?n=this._numericFormatterCache.get(i):(n=this._numericSpecifier(i),this._numericFormatterCache.set(i,n)),n(Number(e))):this._numericFormatter(i,Number(e))}return i.includes("%")&&this._timeFormatter?this._timeFormatter(i,e):e}release(){super.release(),this._format=null,this._timeFormatter=null,this._numericFormatter=null,this._numericSpecifier=null,this._numericFormatterCache=null,this._isNumericFormatterCache=null}}FormatterPlugin.pluginType="chart",FormatterPlugin.specKey="formatter",FormatterPlugin.type="formatterPlugin";const registerFormatPlugin=()=>{registerChartPlugin(FormatterPlugin)};class ImageMark extends BaseMark{constructor(){super(...arguments),this.type=ImageMark.type}_getDefaultStyle(){return Object.assign(Object.assign({},super._getDefaultStyle()),{width:void 0,height:void 0,lineWidth:0})}}ImageMark.type="image";const registerImageMark=()=>{Factory$1.registerMark(ImageMark.type,ImageMark),registerImageGraphic()},registerAllMarks=()=>{registerGroupMark(),registerLineMark(),registerSymbolMark(),registerRuleMark(),registerTextMark(),registerAreaMark(),registerRectMark(),registerPathMark(),registerArcMark(),registerPolygonMark(),registerImageMark(),registerRippleMark(),registerComponentMark(),registerArc3dMark(),registerRect3dMark(),registerPyramid3dMark()};VChart.useRegisters([registerLineChart,registerAreaChart,registerBarChart,registerScatterChart,registerPieChart,registerRoseChart,registerRadarChart,registerHistogramChart,registerMapChart,registerGaugeChart,registerWordCloudChart,registerWordCloudShapeChart,registerFunnelChart,registerWaterfallChart,registerBoxplotChart,registerCircularProgressChart,registerLinearProgressChart,registerRangeColumnChart,registerRangeAreaChart,registerSunburstChart,registerCirclePackingChart,registerTreemapChart,registerSankeyChart,registerHeatmapChart,registerSequenceChart,registerCorrelationChart,registerCommonChart,registerBar3dChart,registerPie3dChart,registerHistogram3dChart,registerFunnel3dChart,registerRangeColumn3dChart,registerWordCloud3dChart,registerWordCloudShape3dChart,registerCartesianLinearAxis,registerCartesianBandAxis,registerCartesianTimeAxis,registerCartesianLogAxis,registerCartesianSymlogAxis,registerPolarBandAxis,registerPolarLinearAxis,registerDiscreteLegend,registerContinuousLegend,registerTooltip,registerCartesianCrossHair,registerPolarCrossHair,registerDataZoom,registerScrollBar,registerIndicator,registerGeoCoordinate,registerMarkLine,registerMarkArea,registerMarkPoint,registerPolarMarkLine,registerPolarMarkArea,registerPolarMarkPoint,registerGeoMarkPoint,registerTitle,registerPlayer,registerLabel,registerTotalLabel,registerBrush,registerCustomMark,registerMapLabel,registerPoptip,registerGridLayout,registerLayout3d,registerAllMarks,registerDomTooltipHandler,registerCanvasTooltipHandler,registerFormatPlugin,registerElementActive,registerElementActiveByLegend,registerElementHighlightByLegend,registerElementHighlightByName,registerElementHighlightByGroup,registerElementHighlightByKey,registerAnimate,registerReactAttributePlugin,registerHtmlAttributePlugin]);const _hoisted_1$1={class:"service_banner_1"},_hoisted_2$1={class:"service_title_1"},_hoisted_3$1={class:"service_title_2"},_hoisted_4$1={class:"trapezoidal-horizintal",style:{position:"relative",bottom:"0px",width:"100%",height:"10vw"},xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100",preserveAspectRatio:"none"},_hoisted_5$1={class:"service_banner_2"},_hoisted_6$1={class:"abbbox"},_hoisted_7$1={class:"abb_2",ref:"parentElement"},_hoisted_8$1={class:"abb_1"},_hoisted_9={class:"abb_1txt1"},_hoisted_10={class:"abb_1txt2"},_hoisted_11={class:"abbbox"},_hoisted_12={class:"abb_1"},_hoisted_13={class:"abb_1txt1"},_hoisted_14={class:"abb_1txt2"},_hoisted_15={class:"abbbox"},_hoisted_16={class:"abb_1"},_hoisted_17={class:"abb_1txt1"},_hoisted_18={class:"abb_1txt2"},_hoisted_19={class:"abbbox"},_hoisted_20={class:"abb_1"},_hoisted_21={class:"abb_1txt1"},_hoisted_22={class:"abb_1txt2"},_hoisted_23={class:"trapezoidal-horizintal",style:{width:"100%",height:"10vw",display:"block"},xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100",preserveAspectRatio:"none"},_hoisted_24={class:"service_banner_3"},_hoisted_25={class:"left3box"},_hoisted_26={class:"left3left"},_hoisted_27={class:"eras"},_hoisted_28={class:"rtyg"},_hoisted_29={class:"rtyg"},_hoisted_30={class:"left3right"},_hoisted_31={class:"imgbox2"},_hoisted_32={class:"animate__animated animate__bounce animated-text"},_hoisted_33={class:"left3box"},_hoisted_34={class:"left3left",style:{"background-color":"#103169"}},_hoisted_35={class:"eras"},_hoisted_36={class:"rtyg"},_hoisted_37={class:"rtyg"},_hoisted_38={class:"rtyg"},_hoisted_39={class:"rtyg"},_hoisted_40={class:"left3right"},_hoisted_41={class:"imgbox2"},_hoisted_42={class:"animate__animated animate__bounce animated-text"},_hoisted_43={class:"left3box"},_hoisted_44={class:"left3left",style:{"background-color":"#103169"}},_hoisted_45={class:"eras"},_hoisted_46={style:{display:"flex","align-items":"center",margin:"3px 0"}},_hoisted_47={style:{display:"flex","align-items":"center",margin:"3px 0"}},_hoisted_48={style:{display:"flex","align-items":"center",margin:"3px 0"}},_hoisted_49={style:{display:"flex","align-items":"center",margin:"3px 0"}},_hoisted_50={style:{display:"flex","align-items":"center",margin:"3px 0"}},_hoisted_51={style:{display:"flex","align-items":"center",margin:"3px 0"}},_hoisted_52={class:"left3right"},_hoisted_53={class:"imgbox2"},_hoisted_54={class:"animate__animated animate__bounce animated-text"},_hoisted_55={class:"left3box"},_hoisted_56={class:"left3left",style:{"background-color":"#103169"}},_hoisted_57={class:"eras"},_hoisted_58={class:"rtyg"},_hoisted_59={class:"rtyg"},_hoisted_60={class:"rtyg"},_hoisted_61={class:"rtyg"},_hoisted_62={class:"left3right"},_hoisted_63={class:"imgbox2"},_hoisted_64={class:"animate__animated animate__bounce animated-text"},_hoisted_65={class:"left3box"},_hoisted_66={class:"left3left",style:{"background-color":"#103169"}},_hoisted_67={class:"eras"},_hoisted_68={class:"rtyg"},_hoisted_69={class:"rtyg"},_hoisted_70={class:"rtyg"},_hoisted_71={class:"rtyg"},_hoisted_72={class:"rtyg"},_hoisted_73={class:"left3right"},_hoisted_74={class:"imgbox2"},_hoisted_75={class:"animate__animated animate__bounce animated-text"},_sfc_main$2={__name:"Service",setup(__props){const{t,locale}=useI18n();let numx=!0;const box1=ref(null),box2=ref(null),box3=ref(null),box4=ref(null),box5=ref(null),box6=ref(null),box7=ref(null),box8=ref(null),onMouseEnter=box=>{if(numx)if(numx=!1,box=="box3"){const el=eval(box).value;el.classList.remove("animate__bounce"),el.offsetWidth,el.classList.add("animate__bounce"),setTimeout(()=>{numx=!0},500)}else if(box=="box4"||box=="box5"||box=="box6"||box=="box7"||box=="box8"){console.log(eval(box),"el");const el=eval(box).value;el.classList.remove("animate__headShake"),el.offsetWidth,el.classList.add("animate__headShake"),setTimeout(()=>{numx=!0},500)}else{const el=eval(box).value;el.classList.remove("animate__flipInX"),el.offsetWidth,el.classList.add("animate__flipInX"),setTimeout(()=>{numx=!0},500)}},updateBeforeContent=()=>{const r=document.createElement("style");r.textContent=`
    .service_banner_2 .abbbox .abb_2::before {
      content: "${t("honetitle3")}";
    }
  `,document.head.appendChild(r)};watch(()=>t("honetitle3"),updateBeforeContent);const data=[{type:t("tb1"),value:"20",formula:"Formation",texture:"circle"},{type:t("tb2"),value:"20",formula:"Implementation",texture:"horizontal-line"},{type:t("tb3"),value:"20",formula:"Provision",texture:"vertical-line"},{type:t("tb4"),value:"20",formula:"Identification",texture:"rect"},{type:t("tb5"),value:"20",formula:"Expansion",texture:"grid"}],spec={type:"pie",data:[{id:"id0",values:data}],outerRadius:.8,innerRadius:.5,padAngle:.6,valueField:"value",categoryField:"type",background:{visible:!0,fill:"#1e232b"},pie:{style:{cornerRadius:10,texture:r=>r.texture},state:{hover:{outerRadius:.85,stroke:"#000",lineWidth:1},selected:{outerRadius:.85,stroke:"#000",lineWidth:1}}},indicator:{visible:!0,trigger:"hover",limitRatio:.5,title:{visible:!0,autoFit:!0,fitStrategy:"inscribed",style:{fontWeight:"bolder",fontFamily:"Times New Roman",fill:"#888",text:r=>(r??data[0]).formula}},content:[{visible:!0,autoFit:!0,fitStrategy:"inscribed",style:{fill:"orange",fontWeight:"bolder",fontFamily:"Times New Roman",text:r=>(r??data[0].type).type}}]},legends:{visible:!0,orient:"left",item:{shape:{style:{symbolType:"circle",texture:r=>r.texture}}}},tooltip:{mark:{content:[{key:r=>r.type}]}}},chartContainer=ref(null);let vchart=null;return onMounted(()=>{updateBeforeContent(),vchart=new VChart(spec,{dom:chartContainer.value}),vchart.renderSync()}),onBeforeUnmount(()=>{vchart&&(vchart=null)}),(r,e)=>(openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",_hoisted_1$1,[createBaseVNode("div",_hoisted_2$1,[createBaseVNode("div",{ref_key:"box1",ref:box1,class:"animate__animated animate__flipInX txt_1",onMouseover:e[0]||(e[0]=i=>onMouseEnter("box1"))},toDisplayString$1(r.$t("service1")),545),createBaseVNode("div",{ref_key:"box2",ref:box2,class:"animate__animated animate__flipInX txt_2",onMouseover:e[1]||(e[1]=i=>onMouseEnter("box2"))},toDisplayString$1(r.$t("service2")),545)]),createBaseVNode("div",_hoisted_3$1,[createBaseVNode("div",{ref_key:"chartContainer",ref:chartContainer,class:"chart-container"},null,512)])]),createBaseVNode("div",null,[(openBlock(),createElementBlock("svg",_hoisted_4$1,e[8]||(e[8]=[createBaseVNode("polygon",{fill:"#212428",points:"100,0 0,50 0,0"},null,-1)])))]),createBaseVNode("div",_hoisted_5$1,[createBaseVNode("h2",{ref_key:"box3",ref:box3,class:"animate__animated animate__bounce txt_2",onMouseover:e[2]||(e[2]=i=>onMouseEnter("box3"))},toDisplayString$1(r.$t("choose1")),545),createBaseVNode("div",_hoisted_6$1,[createBaseVNode("div",_hoisted_7$1,e[9]||(e[9]=[createBaseVNode("img",{src:_imports_0$2,alt:""},null,-1)]),512),createBaseVNode("div",_hoisted_8$1,[createBaseVNode("div",_hoisted_9,toDisplayString$1(r.$t("choose2")),1),createBaseVNode("div",_hoisted_10,toDisplayString$1(r.$t("choose3")),1)])]),createBaseVNode("div",_hoisted_11,[e[10]||(e[10]=createBaseVNode("div",{class:"abb_2"},[createBaseVNode("img",{src:_imports_1$1,alt:""})],-1)),createBaseVNode("div",_hoisted_12,[createBaseVNode("div",_hoisted_13,toDisplayString$1(r.$t("choose4")),1),createBaseVNode("div",_hoisted_14,toDisplayString$1(r.$t("choose5")),1)])]),createBaseVNode("div",_hoisted_15,[e[11]||(e[11]=createBaseVNode("div",{class:"abb_2"},[createBaseVNode("img",{src:_imports_2$1,alt:""})],-1)),createBaseVNode("div",_hoisted_16,[createBaseVNode("div",_hoisted_17,toDisplayString$1(r.$t("choose6")),1),createBaseVNode("div",_hoisted_18,toDisplayString$1(r.$t("choose7")),1)])]),createBaseVNode("div",_hoisted_19,[e[12]||(e[12]=createBaseVNode("div",{class:"abb_2"},[createBaseVNode("img",{src:_imports_2$1,alt:""})],-1)),createBaseVNode("div",_hoisted_20,[createBaseVNode("div",_hoisted_21,toDisplayString$1(r.$t("choose8")),1),createBaseVNode("div",_hoisted_22,toDisplayString$1(r.$t("choose9")),1)])])]),(openBlock(),createElementBlock("svg",_hoisted_23,e[13]||(e[13]=[createBaseVNode("polygon",{fill:"#1578d4",points:"0,100 100,50 100,100"},null,-1)]))),createBaseVNode("div",_hoisted_24,[createBaseVNode("div",_hoisted_25,[createBaseVNode("div",_hoisted_26,[createBaseVNode("h2",{ref_key:"box4",ref:box4,class:"animate__animated animate__headShake zxzxcc",onMouseover:e[3]||(e[3]=i=>onMouseEnter("box4"))},toDisplayString$1(r.$t("service3")),545),createBaseVNode("div",_hoisted_27,toDisplayString$1(r.$t("service3_0")),1),createBaseVNode("div",_hoisted_28,[e[14]||(e[14]=createBaseVNode("span",{style:{"padding-right":"10px"}},[createBaseVNode("svg",{viewBox:"0 0 1024 1024",class:"icon",version:"1.1",xmlns:"http://www.w3.org/2000/svg",fill:"#000000",winth:"30",height:"30"},[createBaseVNode("g",{id:"SVGRepo_bgCarrier","stroke-width":"0"}),createBaseVNode("g",{id:"SVGRepo_tracerCarrier","stroke-linecap":"round","stroke-linejoin":"round"}),createBaseVNode("g",{id:"SVGRepo_iconCarrier"},[createBaseVNode("path",{d:"M512 192m-128 0a128 128 0 1 0 256 0 128 128 0 1 0-256 0Z",fill:"#fff"}),createBaseVNode("path",{d:"M110.021808 743.473457a128 128 0 1 0 221.702503-128 128 128 0 1 0-221.702503 128Z",fill:"#fff"}),createBaseVNode("path",{d:"M739.582127 791.504295a128 128 0 1 0 128-221.702504 128 128 0 1 0-128 221.702504Z",fill:"#fff"}),createBaseVNode("path",{d:"M181.7 509.3c-4.2 0-8.4-0.4-12.7-1.3-34.7-7-57.1-40.7-50.2-75.3 9.1-45.2 25.4-87.6 48.6-125.8 22.9-37.7 51.9-70.7 86.3-98.1 34.3-27.3 73.2-48.5 115.6-62.9C412.2 131.4 457.8 124 505 124c35.3 0 64 28.7 64 64s-28.7 64-64 64c-133.2 0-235.5 80.8-260.7 205.9-6.1 30.4-32.8 51.4-62.6 51.4zM512 913c-71.5 0-140.8-18.3-200.5-53.1-58.2-33.8-107.2-83.2-141.9-142.8-17.8-30.6-7.4-69.7 23.1-87.5 30.6-17.8 69.7-7.4 87.5 23.1C329.2 736.8 413.6 785 512 785c27.7 0 54.9-4.1 81-12.2 33.8-10.5 69.6 8.4 80.1 42.2 10.5 33.8-8.4 69.6-42.2 80.1C592.5 907 552.5 913 512 913zM807.9 738c-10.9 0-21.9-2.8-32-8.6-30.6-17.7-41-56.9-23.3-87.5C775 603.3 785 563.2 785 512c0-72.9-28.4-141.5-80-193-25-25-25-65.5 0-90.5s65.5-25 90.5 0c36.8 36.8 65.7 79.7 85.9 127.4 20.9 49.5 31.5 102 31.5 156.1 0 74-15.8 135.7-49.6 194.1-11.8 20.5-33.3 31.9-55.4 31.9z",fill:"#fff"})])])],-1)),createBaseVNode("span",null,toDisplayString$1(r.$t("service3_1")),1)]),createBaseVNode("div",_hoisted_29,[e[15]||(e[15]=createBaseVNode("span",{style:{"padding-right":"10px"}},[createBaseVNode("svg",{viewBox:"0 0 1024 1024",class:"icon",version:"1.1",xmlns:"http://www.w3.org/2000/svg",fill:"#000000",winth:"30",height:"30"},[createBaseVNode("g",{id:"SVGRepo_bgCarrier","stroke-width":"0"}),createBaseVNode("g",{id:"SVGRepo_tracerCarrier","stroke-linecap":"round","stroke-linejoin":"round"}),createBaseVNode("g",{id:"SVGRepo_iconCarrier"},[createBaseVNode("path",{d:"M344.1664 235.1872c31.744 0 61.3888 12.16 83.712 33.9968l4.608 4.736 0.256-0.256a119.168 119.168 0 0 1 75.4944-37.8368l6.2208-0.4864 6.3232-0.1536h154.624c28.5952 0 52.1216 22.4256 54.0928 50.688l0.1536 3.8912 2.9696 199.424-50.9952-14.8992-2.816-177.0752a11.4688 11.4688 0 0 0-9.1392-11.0592l-1.9456-0.1792h-141.952c-32.9728 0-65.1776 26.0352-67.6864 56.8832l-0.1536 3.8656v386.6112l3.4048-1.5616 2.4064-1.3312 2.3296-1.408 4.5568-3.1744a5.4272 5.4272 0 0 1 7.936 1.28 6.912 6.912 0 0 1 1.1264 3.7376c0.1024 1.5104-0.0512 3.5584-0.4096 6.1696l-1.024 6.3232c-0.6144 3.4816-1.4336 7.424-2.3808 11.52l-2.1504 9.0368c-3.4304 13.696-6.272 20.7104-10.368 21.76a123.648 123.648 0 0 1-112.9984-26.3936l-3.2-2.9184H188.9024a54.4512 54.4512 0 0 1-53.6832-46.7456l-0.4352-3.9936-0.128-3.8912v-411.904c0-28.8256 22.272-52.5056 50.3808-54.528l3.8656-0.128h155.264z m-5.632 50.4576H196.5568a11.392 11.392 0 0 0-10.9056 9.2672l-0.1792 1.9968v395.4176c0 5.376 4.0704 10.0864 9.1392 11.0592l1.9456 0.2048h160.3584c8.5504 0 16.8704 3.4304 22.8864 9.3184l2.432 2.6624c5.9392 6.9632 13.0816 12.5696 20.992 16.5632l3.1232 1.408V346.4192c0-31.232-30.848-58.496-63.6928-60.6464l-4.1216-0.128z",fill:"#FFFFFF"}),createBaseVNode("path",{d:"M331.3408 502.4256h-80.64a20.1728 20.1728 0 0 1 0-40.32h80.64a20.1472 20.1472 0 1 1 0 40.32z m0-100.8128h-80.64a20.1728 20.1728 0 0 1 0-40.32h80.64a20.1472 20.1472 0 1 1 0 40.32z m-80.64 161.3056h80.64a20.1472 20.1472 0 1 1 0 40.3456h-80.64a20.1472 20.1472 0 1 1 0-40.3456zM613.632 401.6128H512.768a20.1728 20.1728 0 0 1 0-40.32h100.8384a20.1472 20.1472 0 1 1 0 40.32z",fill:"#FFFFFF"}),createBaseVNode("path",{d:"M645.4784 482.9696a112.256 112.256 0 0 1 74.0864 196.5824l1.024-0.9984 3.072 1.792a164.5824 164.5824 0 0 1 48.6912 44.1088l4.7616 6.8096 1.8688 2.9696 54.016-77.312a25.1904 25.1904 0 0 1 29.5424-9.1392l2.8928 1.28 2.6368 1.5872c11.264 7.8848 14.1312 23.3472 6.4 34.8416l-73.3184 104.9856 0.3328 1.6896c0.8704 4.7872 1.536 9.6256 1.9456 14.5152l0.512 7.424 0.1536 7.2448a25.1904 25.1904 0 0 1-50.3808 0.384l-0.1024-5.4272a113.4336 113.4336 0 0 0-226.7648 3.072v1.9712a25.1904 25.1904 0 0 1-50.3808 0 163.84 163.84 0 0 1 89.6256-146.0736l0.4864-0.2304-3.3536-3.4304a112 112 0 0 1-29.3376-64.2816l-0.512-6.0672-0.1536-6.0416a112.256 112.256 0 0 1 112.256-112.256z m0 39.04a73.216 73.216 0 1 0 0 146.432 73.216 73.216 0 0 0 0-146.432z m211.84 36.2496a20.0704 20.0704 0 0 1 0.2304 40.1408h-52.224a20.0704 20.0704 0 0 1-0.2304-40.1152z",fill:"#FFFFFF"}),createBaseVNode("path",{d:"M857.3184 497.2032h-88.6016a20.096 20.096 0 0 0 0.2304 40.1152h88.576a20.096 20.096 0 0 0-0.2048-40.1152z",fill:"#FFF"})])])],-1)),createBaseVNode("span",null,toDisplayString$1(r.$t("service3_2")),1)])]),createBaseVNode("div",_hoisted_30,[e[16]||(e[16]=createBaseVNode("div",{class:"imgbox1"},[createBaseVNode("img",{src:_imports_3,alt:""})],-1)),createBaseVNode("div",_hoisted_31,[createBaseVNode("div",_hoisted_32,toDisplayString$1(r.$t("honetitle3")),1)])])]),createBaseVNode("div",_hoisted_33,[createBaseVNode("div",_hoisted_34,[createBaseVNode("h2",{ref_key:"box5",ref:box5,class:"animate__animated animate__headShake zxzxcc",onMouseover:e[4]||(e[4]=i=>onMouseEnter("box5"))},toDisplayString$1(r.$t("service4")),545),createBaseVNode("div",_hoisted_35,toDisplayString$1(r.$t("service4_0")),1),createBaseVNode("div",_hoisted_36,[e[17]||(e[17]=createBaseVNode("span",{style:{"padding-right":"10px"}},[createBaseVNode("svg",{winth:"30",height:"30",viewBox:"0 0 1024 1024",class:"icon",version:"1.1",xmlns:"http://www.w3.org/2000/svg",fill:"#000000",stroke:"#000000"},[createBaseVNode("g",{id:"SVGRepo_bgCarrier","stroke-width":"0"}),createBaseVNode("g",{id:"SVGRepo_tracerCarrier","stroke-linecap":"round","stroke-linejoin":"round"}),createBaseVNode("g",{id:"SVGRepo_iconCarrier"},[createBaseVNode("path",{d:"M523.9 788.3H166.4V169c0-4.3 3.4-7.7 7.6-7.7h490.8c4.2 0 7.6 3.5 7.6 7.7v190h45.8V169c0-29.9-24-54.2-53.4-54.2H174c-29.5 0-53.4 24.3-53.4 54.2v689c0 29.9 24 54.2 53.4 54.2h359.1c-5.9-11.6-9.3-24.8-9.3-38.7v-85.2z m-102.6 96.2c-17 0-30.9-14-30.9-31.3s13.8-31.3 30.9-31.3c17 0 30.9 14 30.9 31.3-0.1 17.3-13.9 31.3-30.9 31.3z m442.9-479H607.9c-21.1 0-38.2 17.4-38.2 38.7v429.3c0 21.3 17.1 38.7 38.2 38.7h256.3c21.1 0 38.2-17.4 38.2-38.7V444.2c0-21.4-17.1-38.7-38.2-38.7zM736.1 888.9c-12.7 0-22.9-10.4-22.9-23.2 0-12.8 10.3-23.2 22.9-23.2 12.6 0 22.9 10.4 22.9 23.2 0 12.8-10.3 23.2-22.9 23.2z m120.5-69.7H615.5V451.9h241.1v367.3z",fill:"#FFF"})])])],-1)),createBaseVNode("span",null,toDisplayString$1(r.$t("service4_1")),1)]),createBaseVNode("div",_hoisted_37,[e[18]||(e[18]=createStaticVNode('<span style="padding-right:10px;" data-v-6d761444><svg fill="#fff" height="30" width="30" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" xml:space="preserve" data-v-6d761444><g id="SVGRepo_bgCarrier" stroke-width="0" data-v-6d761444></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></g><g id="SVGRepo_iconCarrier" data-v-6d761444><g data-v-6d761444><g data-v-6d761444><path d="M401.819,206.077c-8.33-8.331-21.838-8.331-30.17,0l-85.48,85.481l-45.254-45.257c-4.001-4.001-9.426-6.249-15.086-6.249 c-5.658,0-11.083,2.247-15.084,6.249L110.18,346.869c-8.331,8.33-8.331,21.838,0,30.17c4.166,4.166,9.626,6.248,15.084,6.248 c5.46,0,10.92-2.084,15.084-6.248l85.481-85.478l45.254,45.254c4.001,4.001,9.427,6.248,15.086,6.248 c5.658,0,11.083-2.247,15.084-6.248l100.567-100.567C410.15,227.917,410.15,214.409,401.819,206.077z" data-v-6d761444></path></g></g><g data-v-6d761444><g data-v-6d761444><path d="M469.333,42.667H334.222V21.333C334.222,9.552,324.671,0,312.889,0H199.111c-11.782,0-21.333,9.552-21.333,21.333v21.333 H42.667c-11.782,0-21.333,9.552-21.333,21.333v426.667c0,11.782,9.552,21.333,21.333,21.333h426.667 c11.782,0,21.333-9.552,21.333-21.333V64C490.667,52.218,481.115,42.667,469.333,42.667z M220.444,42.667h71.111v21.249 c0,0.028-0.004,0.055-0.004,0.084s0.004,0.055,0.004,0.084v21.249h-71.111V42.667z M448,469.333H64v-384h113.778v21.333 c0,11.782,9.552,21.333,21.333,21.333h113.778c11.782,0,21.333-9.552,21.333-21.333V85.333H448V469.333z" data-v-6d761444></path></g></g></g></svg></span>',1)),createBaseVNode("span",null,toDisplayString$1(r.$t("service4_2")),1)]),createBaseVNode("div",_hoisted_38,[e[19]||(e[19]=createStaticVNode('<span style="padding-right:10px;" data-v-6d761444><svg width="30" height="30" viewBox="0 0 1024 1024" class="icon" version="1.1" xmlns="http://www.w3.org/2000/svg" fill="#000000" data-v-6d761444><g id="SVGRepo_bgCarrier" stroke-width="0" data-v-6d761444></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></g><g id="SVGRepo_iconCarrier" data-v-6d761444><path d="M206.613915 531.8173m-47.488825 0a47.488825 47.488825 0 1 0 94.97765 0 47.488825 47.488825 0 1 0-94.97765 0Z" fill="#ffffff" data-v-6d761444></path><path d="M420.314141 531.8173m-47.488825 0a47.488825 47.488825 0 1 0 94.97765 0 47.488825 47.488825 0 1 0-94.97765 0Z" fill="#ffffff" data-v-6d761444></path><path d="M634.013343 531.8173m-47.488826 0a47.488825 47.488825 0 1 0 94.977651 0 47.488825 47.488825 0 1 0-94.977651 0Z" fill="#ffffff" data-v-6d761444></path><path d="M800.224743 341.861999m-47.488825 0a47.488825 47.488825 0 1 0 94.97765 0 47.488825 47.488825 0 1 0-94.97765 0Z" fill="#ffffff" data-v-6d761444></path><path d="M956.638584 591.804694c-3.744349-17.228918-4.451853-34.375926-4.451853-59.987394V189.900011c0-34.040092-27.698146-61.738237-61.738237-61.738237H434.562529c-34.040092 0-61.738237 27.698146-61.738237 61.738237v80.728239H135.380165c-39.280337 0-71.23375 31.953413-71.233749 71.233749v379.910602c0 39.280337 31.953413 71.23375 71.233749 71.23375H626.569696c8.208489 0 15.837458 4.429328 20.417297 11.849425 20.799206 33.71552 47.001456 59.279889 87.592366 85.458589 5.959013 3.861072 12.649079 5.762427 19.32686 5.762426 7.60542 0 15.188315-2.469611 21.657222-7.385284 12.046011-9.147391 16.950422-24.346969 12.486281-38.712081-8.115315-26.132625-11.570928-50.271746-11.570928-80.716975V555.561201h51.036588c4.846049 0 9.425888 2.562785 11.941575 6.67778 16.718 27.280401 35.732574 47.697698 61.656326 66.201354 6.237509 4.451853 13.46102 6.690067 20.707057 6.690066 6.794503 0 13.587982-1.970979 19.581807-5.912937 12.418705-8.172653 18.401267-22.862335 15.236437-37.41277zM734.579359 832.147439c-20.208425-15.987969-34.990257-32.474571-47.175516-52.230438-13.298223-21.541523-36.045883-34.399475-60.833123-34.399475H135.380165c-13.08935 0-23.744925-10.654551-23.744924-23.743901V341.861999c0-13.08935 10.654551-23.743901 23.744924-23.7439h569.865903c13.08935 0 23.744925 10.654551 23.744925 23.7439v427.400452c0 23.093734 1.739581 43.151647 5.588366 62.884988z m145.376358-294.718223c-11.095845-18.10946-31.187547-29.355816-52.439311-29.355816h-51.036588V341.861999c0-39.280337-31.953413-71.23375-71.23375-71.233749H420.314141v-80.728239c0-7.860368 6.388021-14.249412 14.249412-14.249412h455.885965c7.860368 0 14.249412 6.388021 14.249412 14.249412v341.917289c0 13.032012 0.127986 25.923753 1.112963 38.82778-9.705409-9.657286-17.983522-20.358936-25.856176-33.215864z" fill="#ffffff" data-v-6d761444></path></g></svg></span>',1)),createBaseVNode("span",null,toDisplayString$1(r.$t("service4_3")),1)]),createBaseVNode("div",_hoisted_39,[e[20]||(e[20]=createStaticVNode('<span style="padding-right:10px;" data-v-6d761444><svg width="30" height="30" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-6d761444><g id="SVGRepo_bgCarrier" stroke-width="0" data-v-6d761444></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></g><g id="SVGRepo_iconCarrier" data-v-6d761444><path opacity="0.4" d="M22 15C22 18.87 18.87 22 15 22L16.05 20.25" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></path><path opacity="0.4" d="M2 9C2 5.13 5.13 2 9 2L7.95 3.75" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></path><path d="M13.6992 4.4502L17.6792 6.75018L21.6192 4.46021" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></path><path d="M17.6797 10.8203V6.74023" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></path><path d="M16.7396 2.21L14.3396 3.53996C13.7996 3.83996 13.3496 4.59995 13.3496 5.21995V7.75999C13.3496 8.37999 13.7896 9.13998 14.3396 9.43998L16.7396 10.77C17.2496 11.06 18.0896 11.06 18.6096 10.77L21.0096 9.43998C21.5496 9.13998 21.9996 8.37999 21.9996 7.75999V5.21995C21.9996 4.59995 21.5596 3.83996 21.0096 3.53996L18.6096 2.21C18.0996 1.93 17.2596 1.93 16.7396 2.21Z" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></path><path d="M2.34961 15.4502L6.31961 17.7502L10.2696 15.4602" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></path><path d="M6.32031 21.8203V17.7402" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></path><path d="M5.39 13.21L2.99001 14.54C2.45001 14.84 2 15.5999 2 16.2199V18.76C2 19.38 2.44001 20.14 2.99001 20.44L5.39 21.77C5.9 22.06 6.73999 22.06 7.25999 21.77L9.66 20.44C10.2 20.14 10.65 19.38 10.65 18.76V16.2199C10.65 15.5999 10.21 14.84 9.66 14.54L7.25999 13.21C6.73999 12.93 5.9 12.93 5.39 13.21Z" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></path></g></svg></span>',1)),createBaseVNode("span",null,toDisplayString$1(r.$t("service4_4")),1)])]),createBaseVNode("div",_hoisted_40,[e[21]||(e[21]=createBaseVNode("div",{class:"imgbox1"},[createBaseVNode("img",{src:_imports_4,alt:""})],-1)),createBaseVNode("div",_hoisted_41,[createBaseVNode("div",_hoisted_42,toDisplayString$1(r.$t("honetitle3")),1)])])]),createBaseVNode("div",_hoisted_43,[createBaseVNode("div",_hoisted_44,[createBaseVNode("h2",{ref_key:"box6",ref:box6,class:"animate__animated animate__headShake zxzxcc",onMouseover:e[5]||(e[5]=i=>onMouseEnter("box6"))},toDisplayString$1(r.$t("service5")),545),createBaseVNode("div",_hoisted_45,toDisplayString$1(r.$t("service5_0")),1),createBaseVNode("div",_hoisted_46,[e[22]||(e[22]=createStaticVNode('<span style="padding-right:10px;" data-v-6d761444><svg width="30" height="30" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000000" data-v-6d761444><g id="SVGRepo_bgCarrier" stroke-width="0" data-v-6d761444></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></g><g id="SVGRepo_iconCarrier" data-v-6d761444><title data-v-6d761444>/svg/ic-shuffle</title><desc data-v-6d761444>Created with Sketch.</desc><defs data-v-6d761444></defs><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" data-v-6d761444><g id="ic-shuffle" stroke="#ffffff" stroke-width="2" data-v-6d761444><path d="M2,17.9999998 C2,19.1082887 2.89479504,19.9999998 4.0093689,19.9999998 L5.9906311,19.9999998 C6.8646376,19.9999998 7.8774291,19.4961382 8.39914483,18.7962726 L10.5549209,15.9043651 L11.0034256,15.3027099 L10.5510882,14.7039309 L9.28791415,13.0318115 L8.48166843,11.9645484 L7.68611114,13.0398025 L5.78620656,15.607663 C5.64814673,15.794261 5.23905036,15.9999998 5.00104344,15.9999998 L3.99895656,15.9999998 C2.8939935,15.9999998 2,16.8925469 2,17.9999998 Z M17,7.99999982 L17,9.00104326 C17,10.4426117 18.3902669,11.0239464 19.4130188,10.0011945 L22.0011947,7.41301865 C22.7819993,6.6322141 22.7833444,5.36913063 22.0011947,4.58698098 L19.4130188,1.99880509 C18.393426,0.979212222 17,1.5514083 17,2.99895638 L17,3.99999982 L15.9989566,3.99999982 C15.1354804,3.99999982 14.1173241,4.51067434 13.6048397,5.19673291 L11.4612982,8.06627426 L11.0137506,8.66540254 L11.4619396,9.26405117 L12.6968029,10.9134652 L13.4938682,11.97811 L14.2953367,10.916776 L16.1921918,8.40489069 C16.3390468,8.2104199 16.7595316,7.99999982 17,7.99999982 Z M17.0007853,20 C17.0004763,20.0002262 17,20.0014156 17,20.0066442 L17,21.4736462 C17,22.9303154 18.4207045,23.510591 19.4064778,22.4064533 L22.0854405,19.4058206 C22.8003941,18.6050206 22.7640332,17.3498197 22.0011947,16.5869812 L19.4130188,13.9988053 C18.3902669,12.9760534 17,13.5573881 17,14.9989566 L17,16 C16.760894,16 16.3418715,15.789162 16.1955096,15.5940128 L8.40449038,5.20598718 C7.88075638,4.50767518 6.86328205,4 5.9906311,4 L4.0093689,4 C2.89479504,4 2,4.89171112 2,6 C2,7.1074529 2.8939935,8 3.99895656,8 L5.00104344,8 C5.23990997,8 5.65788701,8.21051601 5.80449038,8.40598718 L13.5955096,18.7940128 C14.1186685,19.4915579 15.1311017,20 15.9989566,20 L17.0004762,20 L17.0007853,20 Z" id="Combined-Shape" data-v-6d761444></path></g></g></g></svg></span>',1)),createBaseVNode("span",null,toDisplayString$1(r.$t("service5_1")),1)]),createBaseVNode("div",_hoisted_47,[e[23]||(e[23]=createStaticVNode('<span style="padding-right:10px;" data-v-6d761444><svg version="1.1" id="_x32_" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="30" height="30" viewBox="0 0 512 512" xml:space="preserve" fill="#fff" data-v-6d761444><g id="SVGRepo_bgCarrier" stroke-width="0" data-v-6d761444></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></g><g id="SVGRepo_iconCarrier" data-v-6d761444><g data-v-6d761444><polygon class="st0" points="204.344,155.188 249.469,200.297 409.344,40.422 268.031,40.422 316.063,88.453 249.469,155.031 204.953,110.516 41.906,264.969 63.906,288.219 " data-v-6d761444></polygon><polygon class="st0" points="512,102.313 276.031,330.281 212.656,266.906 0,471.578 512,471.578 " data-v-6d761444></polygon></g></g></svg></span>',1)),createBaseVNode("span",null,toDisplayString$1(r.$t("service5_2")),1)]),createBaseVNode("div",_hoisted_48,[e[24]||(e[24]=createStaticVNode('<span style="padding-right:10px;" data-v-6d761444><svg width="30" height="30" viewBox="0 0 512 512" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000000" data-v-6d761444><g id="SVGRepo_bgCarrier" stroke-width="0" data-v-6d761444></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></g><g id="SVGRepo_iconCarrier" data-v-6d761444><title data-v-6d761444>report-text</title><g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" data-v-6d761444><g id="add" fill="#ffffff" transform="translate(42.666667, 85.333333)" data-v-6d761444><path d="M341.333333,1.42108547e-14 L426.666667,85.3333333 L426.666667,341.333333 L3.55271368e-14,341.333333 L3.55271368e-14,1.42108547e-14 L341.333333,1.42108547e-14 Z M330.666667,42.6666667 L42.6666667,42.6666667 L42.6666667,298.666667 L384,298.666667 L384,96 L330.666667,42.6666667 Z M149.333333,234.666667 L149.333333,266.666667 L85.3333333,266.666667 L85.3333333,234.666667 L149.333333,234.666667 Z M341.333333,234.666667 L341.333333,266.666667 L192,266.666667 L192,234.666667 L341.333333,234.666667 Z M149.333333,170.666667 L149.333333,202.666667 L85.3333333,202.666667 L85.3333333,170.666667 L149.333333,170.666667 Z M341.333333,170.666667 L341.333333,202.666667 L192,202.666667 L192,170.666667 L341.333333,170.666667 Z M149.333333,106.666667 L149.333333,138.666667 L85.3333333,138.666667 L85.3333333,106.666667 L149.333333,106.666667 Z M341.333333,106.666667 L341.333333,138.666667 L192,138.666667 L192,106.666667 L341.333333,106.666667 Z" id="Combined-Shape" data-v-6d761444></path></g></g></g></svg></span>',1)),createBaseVNode("span",null,toDisplayString$1(r.$t("service5_3")),1)]),createBaseVNode("div",_hoisted_49,[e[25]||(e[25]=createStaticVNode('<span style="padding-right:10px;" data-v-6d761444><svg width="30" height="30" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-6d761444><g id="SVGRepo_bgCarrier" stroke-width="0" data-v-6d761444></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></g><g id="SVGRepo_iconCarrier" data-v-6d761444><path d="M18 13H16M18 8H10M18 16H16M10.2 20H17.8C18.9201 20 19.4802 20 19.908 19.782C20.2843 19.5903 20.5903 19.2843 20.782 18.908C21 18.4802 21 17.9201 21 16.8V7.2C21 6.0799 21 5.51984 20.782 5.09202C20.5903 4.71569 20.2843 4.40973 19.908 4.21799C19.4802 4 18.9201 4 17.8 4H10.2C9.07989 4 8.51984 4 8.09202 4.21799C7.71569 4.40973 7.40973 4.71569 7.21799 5.09202C7 5.51984 7 6.07989 7 7.2V16.8C7 17.9201 7 18.4802 7.21799 18.908C7.40973 19.2843 7.71569 19.5903 8.09202 19.782C8.51984 20 9.07989 20 10.2 20ZM13 14.5C13 15.3284 12.3284 16 11.5 16C10.6716 16 10 15.3284 10 14.5C10 13.6716 10.6716 13 11.5 13C12.3284 13 13 13.6716 13 14.5ZM5 20C3.89543 20 3 19.1046 3 18V6C3 4.89543 3.89543 4 5 4C6.10457 4 7 4.89543 7 6V18C7 19.1046 6.10457 20 5 20Z" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></path></g></svg></span>',1)),createBaseVNode("span",null,toDisplayString$1(r.$t("service5_4")),1)]),createBaseVNode("div",_hoisted_50,[e[26]||(e[26]=createStaticVNode('<span style="padding-right:10px;" data-v-6d761444><svg height="30" width="30" version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 367.509 367.509" xml:space="preserve" fill="#000000" data-v-6d761444><g id="SVGRepo_bgCarrier" stroke-width="0" data-v-6d761444></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></g><g id="SVGRepo_iconCarrier" data-v-6d761444><g data-v-6d761444><path style="fill:#ffffff;" d="M329.451,166.652h38.058c-2.292-24.808-9.51-48.194-20.671-69.199l-20.59,11.9l-6.852-11.851 l20.476-11.827c-14.656-23.231-34.286-42.951-57.469-57.68l-12.063,20.72l-11.827-6.885l12.144-20.85 C249.507,9.64,225.909,2.341,200.873,0.024V38.66H166.66V0.016c-25.036,2.317-48.633,9.616-69.784,20.947l12.144,20.85 l-11.827,6.885l-12.063-20.72c-23.183,14.729-42.813,34.449-57.469,57.68l20.476,11.827l-6.852,11.851l-20.59-11.9 c-11.161,21.004-18.379,44.39-20.671,69.207h38.058v34.213H0c2.292,24.808,9.51,48.194,20.671,69.207l20.598-11.9l6.852,11.851 L27.645,281.85c14.656,23.231,34.286,42.951,57.469,57.68l12.063-20.72l11.827,6.885l-12.144,20.85 c21.151,11.331,44.748,18.639,69.784,20.947v-38.635h34.213v38.635c25.036-2.317,48.633-9.616,69.784-20.947l-12.144-20.85 l11.827-6.885l12.063,20.72c23.183-14.729,42.813-34.441,57.469-57.68l-20.476-11.827l6.852-11.851l20.59,11.9 c11.161-21.004,18.379-44.39,20.671-69.207h-38.058v-34.213H329.451z M179.739,234.152c0,7.681-6.251,13.932-13.932,13.932H82.936 c-4.056,0-7.933-1.813-10.364-4.845c-2.26-2.821-3.105-6.462-2.325-10.014c1.219-5.487,3.333-10.722,6.275-15.558 c4.463-8.535,14.68-17.379,31.084-26.759c13.111-7.527,21.646-12.933,25.369-16.07c4.999-4.276,7.446-8.698,7.446-13.485 c0-3.739-1.236-6.747-3.78-9.177c-2.601-2.495-6.422-3.707-11.705-3.707c-7.178,0-11.786,1.87-14.111,5.706 c-0.764,1.276-1.39,3.146-1.845,5.552c-1.211,6.43-7.527,11.274-14.68,11.274h-9.73c-4.024,0-7.755-1.707-10.234-4.69 c-2.309-2.78-3.251-6.43-2.585-10.023c1.219-6.552,3.398-12.258,6.495-16.981c8.657-13.185,23.898-19.874,45.309-19.874 c16.639,0,30.181,3.829,40.22,11.38c10.461,7.836,15.769,18.395,15.769,31.352c0,10.006-3.739,18.964-11.12,26.654 c-4.682,4.918-11.965,10.144-22.24,15.973l-11.681,6.633c-4.934,2.812-8.803,5.088-11.575,6.812h42.895 c7.682,0,13.932,6.251,13.932,13.932v1.983H179.739z M284.516,222.528c-2.057,0-3.731,2.089-3.731,4.641v6.982 c0,7.681-6.251,13.932-13.932,13.932h-9.933c-7.682,0-13.932-6.251-13.932-13.932v-6.982c0-2.56-2.081-4.641-4.641-4.641h-40.074 c-7.681,0-13.932-6.251-13.932-13.932v-1.829c0-6.17,2.804-14.55,6.527-19.492l43.268-57.282c3.983-5.267,11.973-9.25,18.59-9.25 h14.119c7.682,0,13.932,6.251,13.932,13.932v55.648c0,2.561,1.674,4.641,3.731,4.641c7.186,0,13.022,6.178,13.022,13.778 C297.538,216.342,291.702,222.528,284.516,222.528z" data-v-6d761444></path><path style="fill:#ffffff;" d="M219.74,194.964c0.065,0,0.13,0,0.203,0h18.411c2.56,0,4.641-2.089,4.641-4.641v-27.531 l-23.142,32.01C219.813,194.858,219.78,194.915,219.74,194.964z" data-v-6d761444></path></g></g></svg></span>',1)),createBaseVNode("span",null,toDisplayString$1(r.$t("service5_5")),1)]),createBaseVNode("div",_hoisted_51,[e[27]||(e[27]=createStaticVNode('<span style="padding-right:10px;" data-v-6d761444><svg width="30" height="30" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-6d761444><g id="SVGRepo_bgCarrier" stroke-width="0" data-v-6d761444></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></g><g id="SVGRepo_iconCarrier" data-v-6d761444><path fill-rule="evenodd" clip-rule="evenodd" d="M19.186 2.09c.521.25 1.136.612 1.625 1.101.49.49.852 1.104 1.1 1.625.313.654.11 1.408-.401 1.92l-7.214 7.213c-.31.31-.688.541-1.105.675l-4.222 1.353a.75.75 0 0 1-.943-.944l1.353-4.221a2.75 2.75 0 0 1 .674-1.105l7.214-7.214c.512-.512 1.266-.714 1.92-.402zm.211 2.516a3.608 3.608 0 0 0-.828-.586l-6.994 6.994a1.002 1.002 0 0 0-.178.241L9.9 14.102l2.846-1.496c.09-.047.171-.107.242-.178l6.994-6.994a3.61 3.61 0 0 0-.586-.828zM4.999 5.5A.5.5 0 0 1 5.47 5l5.53.005a1 1 0 0 0 0-2L5.5 3A2.5 2.5 0 0 0 3 5.5v12.577c0 .76.082 1.185.319 1.627.224.419.558.754.977.978.442.236.866.318 1.627.318h12.154c.76 0 1.185-.082 1.627-.318.42-.224.754-.559.978-.978.236-.442.318-.866.318-1.627V13a1 1 0 1 0-2 0v5.077c0 .459-.021.571-.082.684a.364.364 0 0 1-.157.157c-.113.06-.225.082-.684.082H5.923c-.459 0-.57-.022-.684-.082a.363.363 0 0 1-.157-.157c-.06-.113-.082-.225-.082-.684V5.5z" fill="#ffffff" data-v-6d761444></path></g></svg></span>',1)),createBaseVNode("span",null,toDisplayString$1(r.$t("service5_6")),1)])]),createBaseVNode("div",_hoisted_52,[e[28]||(e[28]=createBaseVNode("div",{class:"imgbox1"},[createBaseVNode("img",{src:_imports_5,alt:""})],-1)),createBaseVNode("div",_hoisted_53,[createBaseVNode("div",_hoisted_54,toDisplayString$1(r.$t("honetitle3")),1)])])]),createBaseVNode("div",_hoisted_55,[createBaseVNode("div",_hoisted_56,[createBaseVNode("h2",{ref_key:"box7",ref:box7,class:"animate__animated animate__headShake zxzxcc",onMouseover:e[6]||(e[6]=i=>onMouseEnter("box7"))},toDisplayString$1(r.$t("service6")),545),createBaseVNode("div",_hoisted_57,toDisplayString$1(r.$t("service6_0")),1),createBaseVNode("div",_hoisted_58,[e[29]||(e[29]=createStaticVNode('<span style="padding-right:10px;" data-v-6d761444><svg fill="#fff" width="30" height="30" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-v-6d761444><g id="SVGRepo_bgCarrier" stroke-width="0" data-v-6d761444></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></g><g id="SVGRepo_iconCarrier" data-v-6d761444><path d="M11,3a1,1,0,0,0-1-1H3A1,1,0,0,0,2,3V22h9ZM9,18H4V16H9Zm0-4H4V12H9Zm0-4H4V8H9ZM9,6H4V4H9ZM21,8H14a1,1,0,0,0-1,1V22h9V9A1,1,0,0,0,21,8ZM17,20H15V18h2Zm0-4H15V14h2Zm0-4H15V10h2Zm3,8H18V18h2Zm0-4H18V14h2Zm0-4H18V10h2Z" data-v-6d761444></path></g></svg></span>',1)),createBaseVNode("span",null,toDisplayString$1(r.$t("service6_1")),1)]),createBaseVNode("div",_hoisted_59,[e[30]||(e[30]=createStaticVNode('<span style="padding-right:10px;" data-v-6d761444><svg width="30" height="30" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-6d761444><g id="SVGRepo_bgCarrier" stroke-width="0" data-v-6d761444></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></g><g id="SVGRepo_iconCarrier" data-v-6d761444><rect width="48" height="48" fill="white" fill-opacity="0.01" data-v-6d761444></rect><rect width="48" height="48" fill="white" fill-opacity="0.01" data-v-6d761444></rect><path d="M9 15V9.56389C9 8.67237 9.08702 8.34908 9.25044 8.02315C9.41385 7.69723 9.65365 7.44144 9.95921 7.26713C10.2648 7.09283 10.5678 7 11.4036 7H36.5964C37.4322 7 37.7352 7.09283 38.0408 7.26713C38.3463 7.44144 38.5862 7.69723 38.7496 8.02315C38.913 8.34908 39 8.67237 39 9.56389V15" stroke="#ffffff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></path><path d="M5 15H43V41H5V15Z" stroke="#ffffff" stroke-width="4" stroke-linejoin="round" data-v-6d761444></path><path fill-rule="evenodd" clip-rule="evenodd" d="M13 26C14.6569 26 16 24.6569 16 23C16 21.3431 14.6569 20 13 20C11.3431 20 10 21.3431 10 23C10 24.6569 11.3431 26 13 26Z" fill="#ffffff" data-v-6d761444></path><path d="M5.56885 40.39L14.9999 30L19.9999 34L25.9999 27L42.3937 40.39" stroke="#ffffff" stroke-width="4" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></path></g></svg></span>',1)),createBaseVNode("span",null,toDisplayString$1(r.$t("service6_2")),1)]),createBaseVNode("div",_hoisted_60,[e[31]||(e[31]=createStaticVNode('<span style="padding-right:10px;" data-v-6d761444><svg width="30" height="30" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-6d761444><g id="SVGRepo_bgCarrier" stroke-width="0" data-v-6d761444></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></g><g id="SVGRepo_iconCarrier" data-v-6d761444><path d="M5 19V6.2C5 5.0799 5 4.51984 5.21799 4.09202C5.40973 3.71569 5.71569 3.40973 6.09202 3.21799C6.51984 3 7.0799 3 8.2 3H15.8C16.9201 3 17.4802 3 17.908 3.21799C18.2843 3.40973 18.5903 3.71569 18.782 4.09202C19 4.51984 19 5.0799 19 6.2V17H7C5.89543 17 5 17.8954 5 19ZM5 19C5 20.1046 5.89543 21 7 21H19M18 17V21M14.5 8V7.91667C14.5 6.85812 13.6419 6 12.5833 6H11.5C10.3954 6 9.5 6.89543 9.5 8C9.5 9.10457 10.3954 10 11.5 10H12.5C13.6046 10 14.5 10.8954 14.5 12C14.5 13.1046 13.6046 14 12.5 14H11.4583C10.3768 14 9.5 13.1232 9.5 12.0417V12" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></path></g></svg></span>',1)),createBaseVNode("span",null,toDisplayString$1(r.$t("service6_3")),1)]),createBaseVNode("div",_hoisted_61,[e[32]||(e[32]=createStaticVNode('<span style="padding-right:10px;" data-v-6d761444><svg fill="#fff" width="30" height="30" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg" data-v-6d761444><g id="SVGRepo_bgCarrier" stroke-width="0" data-v-6d761444></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></g><g id="SVGRepo_iconCarrier" data-v-6d761444><title data-v-6d761444>book</title><path d="M0 23.008v-17.984q0-1.024 0.48-1.888t1.28-1.44q1.024-0.672 2.24-0.672 0.736 0 1.472 0.256l10.016 4q0.064 0.032 0.512 0.32 0.448-0.288 0.512-0.32l10.016-4q0.736-0.256 1.472-0.256 1.248 0 2.24 0.672 0.832 0.576 1.312 1.44t0.448 1.888v17.984q0 1.248-0.672 2.24t-1.856 1.472l-9.984 4q-0.736 0.288-1.472 0.288-1.024 0-2.016-0.576-0.992 0.576-1.984 0.576-0.768 0-1.504-0.288l-9.984-4q-1.152-0.448-1.824-1.472t-0.704-2.24zM4 23.008l10.016 4v-17.984l-10.016-4v17.984zM6.016 21.824v-2.016l5.984 2.4v2.016zM6.016 17.824v-2.016l5.984 2.4v2.016zM6.016 13.824v-2.016l5.984 2.4v2.016zM6.016 9.824v-2.016l5.984 2.4v2.016zM18.016 27.008l9.984-4v-17.984l-9.984 4v17.984zM20 24.224v-2.016l6.016-2.4v2.016zM20 20.224v-2.016l6.016-2.4v2.016zM20 16.224v-2.016l6.016-2.4v2.016zM20 12.224v-2.016l6.016-2.4v2.016z" data-v-6d761444></path></g></svg></span>',1)),createBaseVNode("span",null,toDisplayString$1(r.$t("service6_4")),1)])]),createBaseVNode("div",_hoisted_62,[e[33]||(e[33]=createBaseVNode("div",{class:"imgbox1"},[createBaseVNode("img",{src:_imports_6,alt:""})],-1)),createBaseVNode("div",_hoisted_63,[createBaseVNode("div",_hoisted_64,toDisplayString$1(r.$t("honetitle3")),1)])])]),createBaseVNode("div",_hoisted_65,[createBaseVNode("div",_hoisted_66,[createBaseVNode("h2",{ref_key:"box8",ref:box8,class:"animate__animated animate__headShake zxzxcc",onMouseover:e[7]||(e[7]=i=>onMouseEnter("box8"))},toDisplayString$1(r.$t("service7")),545),createBaseVNode("div",_hoisted_67,toDisplayString$1(r.$t("service7_0")),1),createBaseVNode("div",_hoisted_68,[e[34]||(e[34]=createStaticVNode('<span style="padding-right:10px;" data-v-6d761444><svg width="30" height="30" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-6d761444><g id="SVGRepo_bgCarrier" stroke-width="0" data-v-6d761444></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></g><g id="SVGRepo_iconCarrier" data-v-6d761444><path d="M4 19L4 5M20 19L20 5M19 12H14M14 12L16 10M14 12L16 14M5 12H10M10 12L8 14M10 12L8 10" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></path></g></svg></span>',1)),createBaseVNode("span",null,toDisplayString$1(r.$t("service7_1")),1)]),createBaseVNode("div",_hoisted_69,[e[35]||(e[35]=createStaticVNode('<span style="padding-right:10px;" data-v-6d761444><svg width="30" height="30" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-6d761444><g id="SVGRepo_bgCarrier" stroke-width="0" data-v-6d761444></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></g><g id="SVGRepo_iconCarrier" data-v-6d761444><path d="M5 6H19M5 10H15M5 14H19M5 18H15" stroke="#ffffff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></path></g></svg></span>',1)),createBaseVNode("span",null,toDisplayString$1(r.$t("service7_2")),1)]),createBaseVNode("div",_hoisted_70,[e[36]||(e[36]=createStaticVNode('<span style="padding-right:10px;" data-v-6d761444><svg fill="#fff" width="30" height="30" viewBox="0 0 1000 1000" xmlns="http://www.w3.org/2000/svg" data-v-6d761444><g id="SVGRepo_bgCarrier" stroke-width="0" data-v-6d761444></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></g><g id="SVGRepo_iconCarrier" data-v-6d761444><path d="M408 242q0 38 27 64.5t65 26.5 65-26.5 27-64.5-27-65-65-27-65 27-27 65zM58 559q20 19 47 24.5t53-5 41.5-33.5 15.5-51-15.5-51-41-34-53-5.5T58 429q-27 27-27 65t27 65zm442-171q-29 0-55-11-10-4-18 2l-45 30q-5 4-7.5 10t-.5 12l107 385q3 10 11 13.5t16.5 0T519 816l107-385q2-6-.5-12t-7.5-10l-45-30q-8-6-18-2-26 11-55 11zM328 526l-57 11q-8 2-11 9-11 28-32 50t-49 33q-6 3-8 9l-11 58q-1 5 1.5 9.5t6.5 6.5l233 117q9 5 16.5-1.5T422 812l-76-275q-2-6-7-9t-11-2zm614 33q-20 19-47 24.5t-53-5-41.5-33.5-15.5-51 15.5-51 41-34 53-5.5T942 429q27 27 27 65t-27 65zm-270-33l57 11q8 2 11 9 11 28 32 49.5t48 33.5q8 3 9 11l11 58q1 4-1 7.5t-5 5.5L599 829q-9 5-16.5-1.5T578 812l76-275q2-6 7-9t11-2z" data-v-6d761444></path></g></svg></span>',1)),createBaseVNode("span",null,toDisplayString$1(r.$t("service7_3")),1)]),createBaseVNode("div",_hoisted_71,[e[37]||(e[37]=createStaticVNode('<span style="padding-right:10px;" data-v-6d761444><svg width="30" height="30" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-6d761444><g id="SVGRepo_bgCarrier" stroke-width="0" data-v-6d761444></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></g><g id="SVGRepo_iconCarrier" data-v-6d761444><path d="M12 3L12.4892 2.12785C12.1854 1.95738 11.8146 1.95738 11.5108 2.12785L12 3ZM13.3976 3.784L12.9084 4.65615C13.0542 4.73792 13.2181 4.78185 13.3852 4.78392L13.3976 3.784ZM15 3.80385L15.8598 3.29316C15.6818 2.99359 15.3608 2.80824 15.0124 2.80392L15 3.80385ZM15.8184 5.18162L14.9586 5.69231C15.044 5.83601 15.164 5.95603 15.3077 6.04139L15.8184 5.18162ZM17.1962 6L18.1961 5.98761C18.1918 5.63921 18.0064 5.31817 17.7068 5.14023L17.1962 6ZM17.216 7.60238L16.2161 7.61476C16.2181 7.78189 16.2621 7.94584 16.3438 8.09161L17.216 7.60238ZM18 9L18.8722 9.48924C19.0426 9.18535 19.0426 8.81465 18.8722 8.51076L18 9ZM17.216 10.3976L16.3438 9.90839C16.2621 10.0542 16.2181 10.2181 16.2161 10.3852L17.216 10.3976ZM17.1962 12L17.7068 12.8598C18.0064 12.6818 18.1918 12.3608 18.1961 12.0124L17.1962 12ZM15.8184 12.8184L15.3077 11.9586C15.164 12.044 15.044 12.164 14.9586 12.3077L15.8184 12.8184ZM15 14.1962L15.0124 15.1961C15.3608 15.1918 15.6818 15.0064 15.8598 14.7068L15 14.1962ZM13.3976 14.216L13.3852 13.2161C13.2181 13.2181 13.0542 13.2621 12.9084 13.3438L13.3976 14.216ZM12 15L11.5108 15.8722C11.8146 16.0426 12.1854 16.0426 12.4892 15.8722L12 15ZM10.6024 14.216L11.0916 13.3438C10.9458 13.2621 10.7819 13.2181 10.6148 13.2161L10.6024 14.216ZM9 14.1962L8.14023 14.7068C8.31817 15.0064 8.63921 15.1918 8.98761 15.1961L9 14.1962ZM8.18162 12.8184L9.04139 12.3077C8.95603 12.164 8.83602 12.044 8.69231 11.9586L8.18162 12.8184ZM6.80385 12L5.80392 12.0124C5.80824 12.3608 5.99359 12.6818 6.29316 12.8598L6.80385 12ZM6.784 10.3976L7.78392 10.3852C7.78185 10.2181 7.73792 10.0542 7.65615 9.90839L6.784 10.3976ZM6 9L5.12785 8.51076C4.95738 8.81465 4.95738 9.18535 5.12785 9.48924L6 9ZM6.784 7.60238L7.65615 8.09161C7.73792 7.94584 7.78185 7.78189 7.78392 7.61476L6.784 7.60238ZM6.80385 6L6.29316 5.14023C5.99359 5.31817 5.80824 5.63921 5.80392 5.98762L6.80385 6ZM8.18162 5.18162L8.69231 6.04139C8.83602 5.95603 8.95603 5.83602 9.04139 5.69231L8.18162 5.18162ZM9 3.80385L8.98762 2.80392C8.63921 2.80824 8.31817 2.99359 8.14023 3.29316L9 3.80385ZM10.6024 3.784L10.6148 4.78392C10.7819 4.78185 10.9458 4.73792 11.0916 4.65615L10.6024 3.784ZM8.5 21H7.5C7.5 21.3565 7.68976 21.686 7.99807 21.8649C8.30639 22.0438 8.68664 22.0451 8.99614 21.8682L8.5 21ZM12 19L12.4961 18.1318C12.1887 17.9561 11.8113 17.9561 11.5039 18.1318L12 19ZM15.5 21L15.0039 21.8682C15.3134 22.0451 15.6936 22.0438 16.0019 21.8649C16.3102 21.686 16.5 21.3565 16.5 21H15.5ZM11.5108 3.87215L12.9084 4.65615L13.8869 2.91185L12.4892 2.12785L11.5108 3.87215ZM13.3852 4.78392L14.9876 4.80377L15.0124 2.80392L13.41 2.78408L13.3852 4.78392ZM14.1402 4.31454L14.9586 5.69231L16.6781 4.67094L15.8598 3.29316L14.1402 4.31454ZM15.3077 6.04139L16.6855 6.85977L17.7068 5.14023L16.3291 4.32186L15.3077 6.04139ZM16.1962 6.01239L16.2161 7.61476L18.2159 7.58999L18.1961 5.98761L16.1962 6.01239ZM16.3438 8.09161L17.1278 9.48924L18.8722 8.51076L18.0882 7.11314L16.3438 8.09161ZM17.1278 8.51076L16.3438 9.90839L18.0882 10.8869L18.8722 9.48924L17.1278 8.51076ZM16.2161 10.3852L16.1962 11.9876L18.1961 12.0124L18.2159 10.41L16.2161 10.3852ZM14.9876 13.1962L13.3852 13.2161L13.41 15.2159L15.0124 15.1961L14.9876 13.1962ZM10.6148 13.2161L9.01239 13.1962L8.98761 15.1961L10.59 15.2159L10.6148 13.2161ZM7.80377 11.9876L7.78392 10.3852L5.78408 10.41L5.80392 12.0124L7.80377 11.9876ZM7.65615 9.90839L6.87215 8.51076L5.12785 9.48924L5.91185 10.8869L7.65615 9.90839ZM6.87215 9.48924L7.65615 8.09161L5.91185 7.11314L5.12785 8.51076L6.87215 9.48924ZM7.78392 7.61476L7.80377 6.01238L5.80392 5.98762L5.78408 7.58999L7.78392 7.61476ZM7.31454 6.85977L8.69231 6.04139L7.67094 4.32186L6.29316 5.14023L7.31454 6.85977ZM9.04139 5.69231L9.85977 4.31454L8.14023 3.29316L7.32186 4.67094L9.04139 5.69231ZM9.01238 4.80377L10.6148 4.78392L10.59 2.78408L8.98762 2.80392L9.01238 4.80377ZM11.0916 4.65615L12.4892 3.87215L11.5108 2.12785L10.1131 2.91185L11.0916 4.65615ZM16.6855 11.1402L15.3077 11.9586L16.3291 13.6781L17.7068 12.8598L16.6855 11.1402ZM8.69231 11.9586L7.31454 11.1402L6.29316 12.8598L7.67094 13.6781L8.69231 11.9586ZM12.9084 13.3438L11.5108 14.1278L12.4892 15.8722L13.8869 15.0882L12.9084 13.3438ZM12.4892 14.1278L11.0916 13.3438L10.1131 15.0882L11.5108 15.8722L12.4892 14.1278ZM8.99614 21.8682L12.4961 19.8682L11.5039 18.1318L8.00386 20.1318L8.99614 21.8682ZM11.5039 19.8682L15.0039 21.8682L15.9961 20.1318L12.4961 18.1318L11.5039 19.8682ZM16.5 21V13.3544H14.5V21H16.5ZM14.9586 12.3077L14.6402 12.8437L16.3598 13.8651L16.6781 13.3291L14.9586 12.3077ZM14.6402 12.8437L14.1402 13.6855L15.8598 14.7068L16.3598 13.8651L14.6402 12.8437ZM7.5 13.3544V21H9.5V13.3544H7.5ZM9.85977 13.6855L9.35977 12.8437L7.64023 13.8651L8.14023 14.7068L9.85977 13.6855ZM9.35977 12.8437L9.04139 12.3077L7.32186 13.3291L7.64023 13.8651L9.35977 12.8437ZM13 9C13 9.55228 12.5523 10 12 10V12C13.6569 12 15 10.6569 15 9H13ZM12 10C11.4477 10 11 9.55228 11 9H9C9 10.6569 10.3431 12 12 12V10ZM11 9C11 8.44772 11.4477 8 12 8V6C10.3431 6 9 7.34315 9 9H11ZM12 8C12.5523 8 13 8.44772 13 9H15C15 7.34315 13.6569 6 12 6V8Z" fill="#ffffff" data-v-6d761444></path></g></svg></span>',1)),createBaseVNode("span",null,toDisplayString$1(r.$t("service7_4")),1)]),createBaseVNode("div",_hoisted_72,[e[38]||(e[38]=createStaticVNode('<span style="padding-right:10px;" data-v-6d761444><svg width="30" height="30" viewBox="0 0 24 24" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000000" data-v-6d761444><g id="SVGRepo_bgCarrier" stroke-width="0" data-v-6d761444></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round" data-v-6d761444></g><g id="SVGRepo_iconCarrier" data-v-6d761444><title data-v-6d761444>earth_fill</title><g id="-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" data-v-6d761444><g id="Map" transform="translate(-96.000000, -48.000000)" data-v-6d761444><g id="earth_fill" transform="translate(96.000000, 48.000000)" data-v-6d761444><path d="M24,0 L24,24 L0,24 L0,0 L24,0 Z M12.5934901,23.257841 L12.5819402,23.2595131 L12.5108777,23.2950439 L12.4918791,23.2987469 L12.4918791,23.2987469 L12.4767152,23.2950439 L12.4056548,23.2595131 C12.3958229,23.2563662 12.3870493,23.2590235 12.3821421,23.2649074 L12.3780323,23.275831 L12.360941,23.7031097 L12.3658947,23.7234994 L12.3769048,23.7357139 L12.4804777,23.8096931 L12.4953491,23.8136134 L12.4953491,23.8136134 L12.5071152,23.8096931 L12.6106902,23.7357139 L12.6232938,23.7196733 L12.6232938,23.7196733 L12.6266527,23.7031097 L12.609561,23.275831 C12.6075724,23.2657013 12.6010112,23.2592993 12.5934901,23.257841 L12.5934901,23.257841 Z M12.8583906,23.1452862 L12.8445485,23.1473072 L12.6598443,23.2396597 L12.6498822,23.2499052 L12.6498822,23.2499052 L12.6471943,23.2611114 L12.6650943,23.6906389 L12.6699349,23.7034178 L12.6699349,23.7034178 L12.678386,23.7104931 L12.8793402,23.8032389 C12.8914285,23.8068999 12.9022333,23.8029875 12.9078286,23.7952264 L12.9118235,23.7811639 L12.8776777,23.1665331 C12.8752882,23.1545897 12.8674102,23.1470016 12.8583906,23.1452862 L12.8583906,23.1452862 Z M12.1430473,23.1473072 C12.1332178,23.1423925 12.1221763,23.1452606 12.1156365,23.1525954 L12.1099173,23.1665331 L12.0757714,23.7811639 C12.0751323,23.7926639 12.0828099,23.8018602 12.0926481,23.8045676 L12.108256,23.8032389 L12.3092106,23.7104931 L12.3186497,23.7024347 L12.3186497,23.7024347 L12.3225043,23.6906389 L12.340401,23.2611114 L12.337245,23.2485176 L12.337245,23.2485176 L12.3277531,23.2396597 L12.1430473,23.1473072 Z" id="MingCute" fill-rule="nonzero" data-v-6d761444></path><path d="M11.9999,3.00008 C12.1107,3.00008 12.3642,3.06519 12.7351,3.4655 C13.0971,3.85632 13.4788,4.47391 13.8261,5.31188 C14.0485,5.84857 14.2493,6.45733 14.4193,7.12446 C13.6398,7.04338 12.8298,7.00008 11.9999,7.00008 C11.17,7.00008 10.36,7.04338 9.58057,7.12446 C9.75056,6.45733 9.95129,5.84857 10.1737,5.31188 C10.521,4.47391 10.9028,3.85632 11.2648,3.4655 C11.6356,3.06519 11.8891,3.00008 11.9999,3.00008 Z M9.18526,9.18543 C10.0701,9.0665 11.0153,9.00008 11.9999,9.00008 C12.9845,9.00008 13.9297,9.0665 14.8146,9.18543 C14.9335,10.0703 14.9999,11.0155 14.9999,12.0001 C14.9999,12.9847 14.9335,13.9299 14.8146,14.8147 C13.9297,14.9337 12.9845,15.0001 11.9999,15.0001 C11.0153,15.0001 10.0701,14.9337 9.18526,14.8147 C9.06634,13.9299 8.99992,12.9847 8.99992,12.0001 C8.99992,11.0155 9.06634,10.0703 9.18526,9.18543 Z M7.12429,14.4194 C7.04321,13.64 6.99992,12.83 6.99992,12.0001 C6.99992,11.1702 7.04321,10.3602 7.12429,9.58073 C6.45716,9.75073 5.84841,9.95145 5.31171,10.1739 C4.47374,10.5212 3.85615,10.9029 3.46533,11.2649 C3.06503,11.6358 2.99992,11.8893 2.99992,12.0001 C2.99992,12.1109 3.06503,12.3644 3.46533,12.7352 C3.85615,13.0972 4.47374,13.479 5.31171,13.8263 C5.84841,14.0487 6.45716,14.2494 7.12429,14.4194 Z M9.58057,16.8757 C10.36,16.9568 11.17,17.0001 11.9999,17.0001 C12.8298,17.0001 13.6398,16.9568 14.4193,16.8757 C14.2493,17.5428 14.0485,18.1516 13.8261,18.6883 C13.4788,19.5263 13.0971,20.1438 12.7351,20.5347 C12.3642,20.935 12.1107,21.0001 11.9999,21.0001 C11.8891,21.0001 11.6356,20.935 11.2648,20.5347 C10.9028,20.1438 10.521,19.5263 10.1737,18.6883 C9.95129,18.1516 9.75056,17.5428 9.58057,16.8757 Z M16.8755,14.4194 C16.9566,13.64 16.9999,12.83 16.9999,12.0001 C16.9999,11.1702 16.9566,10.3602 16.8755,9.58073 C17.5427,9.75073 18.1514,9.95145 18.6881,10.1739 C19.5261,10.5212 20.1437,10.9029 20.5345,11.2649 C20.9348,11.6358 20.9999,11.8893 20.9999,12.0001 C20.9999,12.1109 20.9348,12.3644 20.5345,12.7352 C20.1437,13.0972 19.5261,13.479 18.6881,13.8263 C18.1514,14.0487 17.5427,14.2494 16.8755,14.4194 Z M16.5472,7.45285 C16.3239,6.37847 16.0264,5.3972 15.6737,4.54615 C15.3072,3.6617 14.8656,2.88066 14.3553,2.27905 C17.9862,3.15569 20.8443,6.01376 21.7209,9.64473 C21.1193,9.13442 20.3383,8.69283 19.4539,8.32628 C18.6028,7.97356 17.6215,7.6761 16.5472,7.45285 Z M16.5472,16.5473 C16.3239,17.6217 16.0264,18.603 15.6737,19.454 C15.3072,20.3385 14.8656,21.1195 14.3553,21.7211 C17.9862,20.8445 20.8443,17.9864 21.7209,14.3554 C21.1193,14.8657 20.3383,15.3073 19.4539,15.6739 C18.6028,16.0266 17.6215,16.3241 16.5472,16.5473 Z M9.64456,21.7211 C9.13425,21.1195 8.69267,20.3385 8.32611,19.454 C7.9734,18.603 7.67593,17.6217 7.45268,16.5473 C6.3783,16.3241 5.39704,16.0266 4.54598,15.6739 C3.66154,15.3073 2.88049,14.8657 2.27888,14.3554 C3.15552,17.9864 6.01359,20.8445 9.64456,21.7211 Z M7.45268,7.45285 C7.67593,6.37846 7.9734,5.3972 8.32611,4.54615 C8.69267,3.6617 9.13425,2.88066 9.64457,2.27905 C6.01359,3.15569 3.15552,6.01376 2.27888,9.64473 C2.88049,9.13442 3.66154,8.69283 4.54598,8.32628 C5.39704,7.97356 6.3783,7.6761 7.45268,7.45285 Z" id="" fill="#ffffff" data-v-6d761444></path></g></g></g></g></svg></span>',1)),createBaseVNode("span",null,toDisplayString$1(r.$t("service7_5")),1)])]),createBaseVNode("div",_hoisted_73,[e[39]||(e[39]=createBaseVNode("div",{class:"imgbox1"},[createBaseVNode("img",{src:_imports_7,alt:""})],-1)),createBaseVNode("div",_hoisted_74,[createBaseVNode("div",_hoisted_75,toDisplayString$1(r.$t("honetitle3")),1)])])])])],64))}},Service=_export_sfc(_sfc_main$2,[["__scopeId","data-v-6d761444"]]),_imports_0=""+new URL("manager-CRYQHmK3.jpg",import.meta.url).href,_hoisted_1={class:"Manager_banner_1"},_hoisted_2={class:"title_1"},_hoisted_3={class:"txt_1"},_hoisted_4={class:"vfverq32"},_hoisted_5={class:"h2"},_hoisted_6={class:"txt"},_hoisted_7={class:"mbox"},_hoisted_8={class:"mt"},_sfc_main$1={__name:"Manager",setup(r){const{t:e,locale:i}=useI18n();return(n,o)=>(openBlock(),createElementBlock(Fragment,null,[createBaseVNode("div",_hoisted_1,[createBaseVNode("div",_hoisted_2,[createBaseVNode("div",_hoisted_3,toDisplayString$1(n.$t("m1")),1)]),createBaseVNode("div",_hoisted_4,[createBaseVNode("h2",_hoisted_5,toDisplayString$1(n.$t("Man1")),1),createBaseVNode("div",_hoisted_6,toDisplayString$1(n.$t("Man2")),1)])]),createBaseVNode("div",_hoisted_7,[createBaseVNode("div",_hoisted_8,[createBaseVNode("h2",null,toDisplayString$1(n.$t("Man3")),1)]),o[0]||(o[0]=createStaticVNode('<div class="mc" data-v-11211771><div class="cbox" data-v-11211771><div class="name" data-v-11211771>  </div><div class="position" data-v-11211771>  </div><div class="photo" data-v-11211771><img src="'+_imports_0+'" alt="" data-v-11211771></div><div class="resume" data-v-11211771><ul data-v-11211771><li data-v-11211771> 7 </li><li data-v-11211771>2023  9  [*] </li><li data-v-11211771>2021 </li><li data-v-11211771>2016  2021 </li><li data-v-11211771>2022  8  2023  6 572</li><li data-v-11211771>2015 </li></ul></div></div><div class="cbox" data-v-11211771><div class="name" data-v-11211771>  </div><div class="position" data-v-11211771>  </div><div class="photo" data-v-11211771><img src="'+_imports_0+'" alt="" data-v-11211771></div><div class="resume" data-v-11211771><ul data-v-11211771><li data-v-11211771> 7 </li><li data-v-11211771>2023  9  [*] </li><li data-v-11211771>2021 </li><li data-v-11211771>2016  2021 </li><li data-v-11211771>2022  8  2023  6 572</li><li data-v-11211771>2015 </li></ul></div></div><div class="cbox" data-v-11211771><div class="name" data-v-11211771>  </div><div class="position" data-v-11211771>  </div><div class="photo" data-v-11211771><img src="'+_imports_0+'" alt="" data-v-11211771></div><div class="resume" data-v-11211771><ul data-v-11211771><li data-v-11211771> 7 </li><li data-v-11211771>2023  9  [*] </li><li data-v-11211771>2021 </li><li data-v-11211771>2016  2021 </li><li data-v-11211771>2022  8  2023  6 572</li><li data-v-11211771>2015 </li></ul></div></div></div>',1))])],64))}},Manager=_export_sfc(_sfc_main$1,[["__scopeId","data-v-11211771"]]),_sfc_main={__name:"NotFound",setup(r){return(e,i)=>(openBlock(),createElementBlock("div",null,i[0]||(i[0]=[createBaseVNode("h1",null,"404 - ",-1),createBaseVNode("p",null,"",-1)])))}},NotFound=_export_sfc(_sfc_main,[["__scopeId","data-v-a9765eda"]]),routes=[{path:"/",name:"Home",component:Home},{path:"/about",name:"About",component:About},{path:"/choose",name:"Choose",component:Choose},{path:"/service",name:"Service",component:Service},{path:"/manager",name:"Manager",component:Manager},{path:"/:pathMatch(.*)*",name:"NotFound",component:NotFound}],router=createRouter({history:createWebHashHistory(),routes}),i18n=createI18n({legacy:!1,locale:"en",messages:{en:{qswl:"securities firm network",about_Us:"About us",about_t1:"A capital market financial services firm composed of professionals proficient in the Hong Kong and US stock markets",honetitle1:"Global Vision, Worldwide Insight",honetitle2:"Financial Expertise, Professional Stewardship",honetitle3:"Chengxin Investment",abouttitle1:"Etoiles Financial Group Limited is a financial services firm specializing in capital markets, led by a team of seasoned professionals with deep expertise in the Hong Kong and U.S. stock markets. With over a decade of industry experience.",abouttitle2:"our founding team is committed to delivering tailored solutions that drive success.",abouttitle3:"We provide one-stop financial services for listed companies, including fundraising advisory, strategic planning, value enhancement, and financial communications. Our strong connections with domestic and international institutional investors.",abouttitle4:"high-net-worth individuals, and an extensive media network allow us to offer a wide range of services, such as value-driven communication strategies, targeted roadshows, media and investor relations, in-depth research, brand promotion, crisis management, and event planning.",abouttitle5:"At Etoiles, we excel in matching the right investors and maximizing capital efficiency. From IPO success to post-listing growth, we deliver strategic capital operations and comprehensive public relations and investor relations services.",abouttitle6:"ensuring businesses achieve their full potential in the global market.",ppt1:"Global Investor Resource Library",ppt2:"Securities Firm Partners",ppt3:"Media Cooperation Channels",ppt4:"Work Experience in Hong Kong Stock Market",service1:"Capital Market Value Operations Expert",service2:"We specialize in analyzing and showcasing the full investment potential of enterprises. Through diverse platforms across public and private domains, we amplify visibility, highlight unique strengths, and showcase comprehensive capabilities. This approach attracts attention, fosters collaboration, and enhances market position and brand image.",service3:"Establishing a Professional Financial IR/PR Team",service3_0:" Build efficient IR & PR systems to drive business growth:",service3_1:"Develop a comprehensive IR + PR structure",service3_2:"Offer specialized training",service4:"Digitized Investor Relations",service4_0:" Modernizing investor relations management:",service4_1:"Set up a tailored IR digital platform",service4_2:"Create investor profiles",service4_3:"Digitally track investor communications",service4_4:"Measure conversion rates",service5:"Professional Financial PR Services",service5_0:" Targeted marketing and service enhancements to all stakeholders",service5_1:"Match investors with tailored roadshow services",service5_2:"Analyze stock price movements",service5_3:"Provide shareholder verification reports",service5_4:"Manage trading terminal services",service5_5:"Monitor media sentiment and handle crisis PR",service5_6:"Develop communication strategies and write press releases",service6:"Value Proposition",service6_0:" Provide a solid foundation for decision-making and external communications:",service6_1:"Assess the companys capital market value",service6_2:"Build a comprehensive communications materials library",service6_3:"Produce detailed research reports and coverage",service6_4:"Develop investor pitch decks and performance presentations",service6_5:"Create investor Q&A lists",service7:"Other Professional Services",service7_0:" Boost brand visibility and market presence:",service7_1:"Fundraising and M&A advisory",service7_2:"ESG reporting",service7_3:"Organize large-scale events",service7_4:"Coordinate forums, summits, and award submissions",service7_5:"Facilitate international roadshows",choose1:"How We Differentiate from Our Peers",choose2:"Unveiling Corporate Value, Redefining Capital Narratives",choose3:"We cut through market noise to uncover hidden potential, weaving compelling value stories through the lens of seasoned capital market expertise.",choose4:"Addressing Client Pain Points with Tailored Precision",choose5:"We identify both explicit and latent client needs with pinpoint accuracy. Backed by a team of financial thought leaders, we reject cookie-cutter approaches, crafting unique, bespoke solutions for each client.",choose6:"Winning Through Cross-Boundary Communication and Amplified Branding",choose7:"Leveraging a global media network and capital market connections, we design strategies to maximize brand visibility and investment appeal. By integrating public and private domains, we enhance corporate influence and ignite investor enthusiasm.",choose8:"Trailblazing Financial Expertise with Professional Guidance",choose9:"Our team of dynamic young professionals, seasoned in navigating financial markets, combines fearless innovation with exceptional execution to chart new paths for growth and success.",touyzi1:"Strategic Insights for Global Financial Excellence",touyzi2:"Connecting Value, Amplifying Growth",nav1:"Home Page",nav2:"About Us",nav3:"Services",nav4:"Investor Relations",nav5:"manager",m1:"Manager",tb1:"Financial IR/PR Team",tb2:"Digitized IR",tb3:"Professional PR Services",tb4:"Value Proposition",tb5:"Other Services",xc:"Etoiles Financial Group Limited",pptzt1:"Capital Value Operation Service Provider",pptzt2:"Customized Solutions",pptzt3:"Elite Professional Team",pptzt4:"Innovative Strategic Planning",h2:"Xincheng Finance is composed of professionals in the Hong Kong and U.S. stock markets, with over 10 years of experience in the Hong Kong stock market.",h21:"It is committed to providing one - stop financial services for listed companies.",Man1:"We have an experienced and highly capable management team and professional employees.",Man2:"We possess an experienced and outstanding management team responsible for guiding and managing daily operations, formulating business strategies, and leading project execution. Leveraging their experience and networks in the financial public relations industry, we have successfully expanded our customer base and sources of transactions.",Man3:"Directors",hz0:"Business Partner",hz1:"Huatai Securities",hz2:"CICC Group",hz3:"Tonghuashun iFinD",hz4:"Eastmoney",hz5:"CITIC Securities",hz6:"Wind Information",hz7:"Discovery Report",hz8:"Insight Research Report",hz9:"Qingke Private Equity",hz10:"Gelonghui",hz11:"Forward-looking Economics",hz12:"Roadshow Center",hz13:"Enterprise Card",hz14:"China Venture",hz15:"China EPA",hzb1:" Financial Terminal ",hzb2:" Research Reports / Think Tanks/Databases ",hzb3:" Tools / Roadshows ",hzb4:" Media / Associations / KOLs ",choosein1:"Providing customized solutions to global clients",choosein2:"We have an experienced professional team offering precise investment research, roadshow, and report services. We provide tailored solutions based on the unique needs of our clients.",choosein3:"In-depth investment research services",choosein3_1:"In-depth research reports / Company event reports / Roadshow PPT creation / Company issue lists",choosein4:"In-depth roadshow services",choosein4_1:"Earnings roadshows/Regular roadshows/Transaction roadshows/Reverse roadshows/Brokerage events /Investor maintenance",choosein5:"Company information organization",choosein5_1:"Value organization / IR database / PR database",choosein6:"Other services",choosein6_1:"Report consultation / Investor private domain setup",choosein7:"Investor private domain group setup",choosein8:"Maintaining good interaction with investors",choosein9:"Company investor group",choosein10:"Industry chat group - Retail Investors -",choosein11:"Hong Kong Stock Research Group",choosein12:"Industry investor chat group - Institutions -",choosein13:"Individual investor chat group",choosein14:"The in-depth investment research services we provide include: precise research reports, company event analysis, key issue identification, and roadshow PPT creation. Through comprehensive data analysis and industry insights, we help clients better understand the companys situation and make more valuable investment decisions.",choosein15:"In a competitive market, roadshows are key for firms to attract investment. A pro team offers one - stop services: highlight mining, biz materials making, exec training, online/offline roadshow planning (venue pick & detail check offline, live - stream platform building online), investor inviting & profiling via the resource database. This helps firms connect with investors, gain investment intents and boost competitiveness.",choosein16:"Professional and systematic integration of corporate data, in - depth analysis of industry context, precise extraction of core competitiveness, and forward - looking planning of development paths.",bbox1:"Domestic/Overseas",bbox2:"1. Hong Kong / Domestic Institutional Investors",bbox3:" Interested in Hong Kong stocks, often cornerstone or anchor investors in IPOs.",bbox4:" Play a key role in pricing.",bbox5:" Includes long-term Hong Kong and Mainland institutional investors, high-net-worth individuals.",bboxlj:"Listed institutions:",bbox6:"Value Partners, Gaocheng Capital, Gaoling Capital, Tianfeng International, Southern Eastern Asset Management, ICBC Asset Management, Chunhua, Chunjiang, Ridao, etc.",bbox7:"2. Industry Investors",bbox8:" Focus on industry interaction and synergies.",bbox9:" Inspire confidence in future business growth.",bbox10:"Yuexiu Industrial Fund, Shango Fund, Fosun Pharma, Beijing Innovation, CITIC Industry Fund, CIMC Group Fund, etc.",bbox11:"3. Qualified Domestic Institutional Investors",bbox12:" Focus on industry interaction and synergies.",bbox13:" Inspire confidence in future business growth.",bbox14:"Harvest Fund, E Fund, Hua Xia Fund, Penghua Fund, Guohai Franklin Fund, Southern Fund, Hua Bao Fund, Boshi Fund, Huatai-PineBridge Fund, ICBC AXA Fund, Minmetals Trust, etc.",bbox15:"Overseas",bbox16:"1. Overseas Institutional Investors",bbox17:" Experienced with Hong Kong IPOs, focused on investment stories and valuations.",bbox18:"Jefferies, UBS, Morgan Stanley, Fidelity, Citadel, Blackstone, KKR, EQT, Bain Capital, Point72, Silver Lake, Apollo, TPG, Carlyle, Warburg, CVC, etc.",bbox19:"2. Sovereign Wealth Funds",bbox20:" Large capital, flexible on price range, early subscription commitments.",bbox21:"GIC, Temasek, China Investment Corp, ADIA, APG, PIF, etc.",bbox22:"Individual",bbox23:"Individual Investors",bbox24:" Reach via Dongfang Financial, Tonghuashun, FUTU, mainstream brokers.",bbox25:"High-net-worth clients from internet brokers, traditional brokers, niche communities.",bbox2_1:"Process",bbox2_2:"PART 1: Full set of roadshow materials preparation",bbox2_3:"PART 2: Executive training",bbox2_4:"PART 3: Online/Offline event preparation",bbox2_5:"PART 4: Investor invitation",bbox2_6:"PART 5: Investor statistics",bbox2_7:"Type",bbox2_8:"Offline Roadshow",bbox2_9:"Close interaction with investors and media, high communication efficiency",bbox2_10:"Online Roadshow",bbox2_11:"Wide reach to investors, high flexibility",bbox2_12:"Including but not limited to",bbox2_13:" Earnings roadshow",bbox2_15:" Regular roadshow",bbox2_16:" Reverse roadshow",bbox2_17:" Investor open day",bbox2_18:" NDR (Non-Deal Roadshow)",bbox2_19:" External brokerage strategy meeting",bbox3_1:"Corporate Overview",bbox3_2:"1.1 Basic Introduction",bbox3_3:"Covers company name, founding date, registration location, IPO date, main business, and key milestones",bbox3_4:"1.2 Financial Analysis",bbox3_5:"Summarizes financial status and key changes, analyzes critical indicators",bbox3_6:"1.3 Business Structure Review",bbox3_7:"Details business architecture, models, and profit mechanisms",bbox3_8:"Sub-Industry Analysis",bbox3_9:"2.1 Macro Industry Analysis",bbox3_10:"Industry definition and classification / Identifies the specific industry",bbox3_11:"Industry development history and policies / Timeline of milestones and key policies (national to local)",bbox3_12:"Industry market size / Estimates industry size based on research data and models",bbox3_13:"Industry trends / Analyzes technology, supply-demand shifts, and growth potential",bbox3_14:"Competitive landscape / Divides competitive tiers and analyzes key players",bbox3_15:"2.2 Sub-Industry Analysis",bbox3_16:"Same as 2.1 / Similar content",bbox3_17:"2.2 Sub-Industry Analysis",bbox3_18:"Focuses on 1-2 segments, emphasizing sustainability through technology, market space, and downstream applications",bbox3_19:"Core Business Advantages",bbox3_20:"3.1 Core Business Strengths",bbox3_21:"Product/Business strengths / Highlights product and business advantages and future potential",bbox3_22:"Technology strengths / Focuses on R&D and technological advantages",bbox3_23:"Channel/Market strengths / Analyzes marketing strategies and market share",bbox3_24:"Other advantages / Includes team, ecosystem, and special qualifications",bbox3_25:"Future Development Plans / Investment Highlights",bbox3_26:"4.1 Potential New Business Directions",bbox3_27:"Details potential new business areas (if any)",bbox3_28:"4.2 Financial Analysis and Profit Forecast",bbox3_29:"Provides revenue estimates, financial models, and future growth projections",bbox3_30:"4.3 Investment Highlights",bbox3_31:"Analyzes investment value based on core strengths and competitive barriers (industry position, R&D, market, etc.)",bbox3_32:"4.4 Future Strategic Plans",bbox3_33:"Summarizes short-term, medium-term, and long-term strategies based on management insights"},zh:{qswl:"",about_Us:"",about_t1:"",honetitle1:"",honetitle2:"",honetitle3:"",abouttitle1:"",abouttitle2:"10",abouttitle3:"",abouttitle4:"",abouttitle5:"IPO",abouttitle6:"",ppt1:"",ppt2:"",ppt3:"",ppt4:"",service1:"",service2:"",service3:"/",service3_0:" &",service3_1:"IR+PR",service3_2:"",service4:"IR",service4_0:" ",service4_1:"IR",service4_2:"",service4_3:"",service4_4:"",service5:"",service5_0:" ",service5_1:"",service5_2:"",service5_3:"",service5_4:"",service5_5:"",service5_6:"",service6:"",service6_0:" /",service6_1:"",service6_2:"",service6_3:"/",service6_4:"",service6_5:"",service7:"",service7_0:"",service7_1:"",service7_2:"ESG ",service7_3:"",service7_4:"",service7_5:"",choose1:"",choose2:" ",choose3:"",choose4:" ",choose5:"",choose6:" ",choose7:"",choose8:" ",choose9:"",touyzi1:"",touyzi2:"",nav1:"",nav2:"",nav3:"",nav4:"",nav5:"",m1:"",tb1:"",tb2:"IR",tb3:"",tb4:"",tb5:"",xc:"",pptzt1:"",pptzt2:"",pptzt3:"",pptzt4:"",h2:" 10  + ",h21:"",Man1:"",Man2:"",Man3:"",hz0:"",hz1:"",hz2:"",hz3:"iFinD",hz4:"",hz5:"",hz6:"",hz7:"",hz8:"",hz9:"",hz10:"",hz11:"",hz12:"",hz13:"",hz14:"",hz15:"",hzb1:"",hzb2:" /  / ",hzb3:" / ",hzb4:" /  / KOL",choosein1:"",choosein2:"",choosein3:"",choosein3_1:"//PPT/",choosein4:"",choosein4_1:"/////",choosein5:"",choosein5_1:"/IR/PR",choosein6:"",choosein6_1:"/",choosein7:"",choosein8:"",choosein9:"",choosein10:"--",choosein11:"",choosein12:"--",choosein13:"",choosein14:"PPT",choosein15:"",choosein16:"",bbox1:"/",bbox2:"1./",bbox3:" ",bbox4:" ",bbox5:" ",bboxlj:"",bbox6:"",bbox7:"2.",bbox8:" ",bbox9:" ",bbox10:"",bbox11:"3.",bbox12:" ",bbox13:" ",bbox14:"",bbox15:"",bbox16:"1.",bbox17:" ",bbox18:"JefferiesUBSMorgan StanleyFidelityCitadelBlackstoneKKREQTBain CapitalPoint72Silver LakeApollo Global ManagementTPGCarlyleWarburgCVC",bbox19:"2.",bbox20:"",bbox21:"GICADIAAPGPIF",bbox22:"",bbox23:"",bbox24:" FUTU",bbox25:"",bbox2_1:"",bbox2_2:"PART 1 ",bbox2_3:"PART 2 ",bbox2_4:"PART 3 /",bbox2_5:"PART 4 ",bbox2_6:"PART 5 ",bbox2_7:"",bbox2_8:"",bbox2_9:"",bbox2_10:"",bbox2_11:"",bbox2_12:"",bbox2_13:" ",bbox2_15:" ",bbox2_16:" ",bbox2_17:" ",bbox2_18:" NDR",bbox2_19:" ",bbox3_1:"",bbox3_2:"1.1 ",bbox3_3:"",bbox3_4:"1.2 ",bbox3_5:"",bbox3_6:"1.3 ",bbox3_7:"",bbox3_8:"",bbox3_9:"2.1 ",bbox3_10:" / ",bbox3_11:" / ",bbox3_12:" / ",bbox3_13:" / ",bbox3_14:" / ",bbox3_15:"2.2 ",bbox3_16:"2.1 / ",bbox3_17:"2.2 ",bbox3_18:"1-2",bbox3_19:"",bbox3_20:"3.1 ",bbox3_21:" / ",bbox3_22:" / ",bbox3_23:" / ",bbox3_24:" / ",bbox3_25:"/",bbox3_26:"4.1 ",bbox3_27:"",bbox3_28:"4.2 ",bbox3_29:"",bbox3_30:"4.3 ",bbox3_31:"",bbox3_32:"4.4 ",bbox3_33:""}}}),app=createApp(_sfc_main$6);app.use(router);app.use(i18n);app.mount("#app");
